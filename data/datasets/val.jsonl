{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# This fixture depends on a github repo at:\n#     https://github.com/hashicorp/terraform-aws-module-installer-acctest\n# ...and expects its v0.0.1 tag to be pointing at the following commit:\n#     d676ab2559d4e0621d59e3c3c4cbb33958ac4608\n\nvariable \"v\" {\n  description = \"in local caller for go-getter-modules\"\n  default     = \"\"\n}\n\nmodule \"acctest_root\" {\n  source = \"github.com/hashicorp/terraform-aws-module-installer-acctest?ref=v0.0.1\"\n}\n\nmodule \"acctest_child_a\" {\n  source = \"github.com/hashicorp/terraform-aws-module-installer-acctest//modules/child_a?ref=v0.0.1\"\n}\n\nmodule \"acctest_child_b\" {\n  source = \"github.com/hashicorp/terraform-aws-module-installer-acctest//modules/child_b?ref=v0.0.1\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/camptocamp__terraboard__internal__terraform__configs__configload__testdata__go-getter-modules__root.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/camptocamp__terraboard__internal__terraform__configs__configload__testdata__go-getter-modules__root.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/camptocamp__terraboard__internal__terraform__configs__configload__testdata__go-getter-modules__root.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/camptocamp__terraboard__internal__terraform__configs__configload__testdata__go-getter-modules__root.tf", "start_line": 19}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Example for using Cloud Armor https://cloud.google.com/armor/\n#\n\nresource \"random_id\" \"instance_id\" {\n  byte_length = 4\n}\n\n# Configure the Google Cloud provider\nprovider \"google\" {\n  credentials = file(var.credentials_file_path)\n  project     = var.project_name\n  region      = var.region\n  zone        = var.region_zone\n}\n\n# Set up a backend to be proxied to:\n# A single instance in a pool running nginx with port 80 open will allow end to end network testing\nresource \"google_compute_instance\" \"cluster1\" {\n  name         = \"armor-gce-${random_id.instance_id.hex}\"\n  machine_type = \"f1-micro\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  network_interface {\n    network = \"default\"\n    access_config {\n      # Ephemeral IP\n    }\n  }\n\n  metadata_startup_script = \"sudo apt-get update; sudo apt-get install -yq nginx; sudo service nginx restart\"\n}\n\nresource \"google_compute_firewall\" \"cluster1\" {\n  name    = \"armor-firewall\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"80\", \"43\"]\n  }\n}\n\nresource \"google_compute_instance_group\" \"webservers\" {\n  name        = \"instance-group-all\"\n  description = \"An instance group for the single GCE instance\"\n\n  instances = [\n    google_compute_instance.cluster1.self_link,\n  ]\n\n  named_port {\n    name = \"http\"\n    port = \"80\"\n  }\n}\n\nresource \"google_compute_target_pool\" \"example\" {\n  name = \"armor-pool\"\n\n  instances = [\n    google_compute_instance.cluster1.self_link,\n  ]\n\n  health_checks = [\n    google_compute_http_health_check.health.name,\n  ]\n}\n\nresource \"google_compute_http_health_check\" \"health\" {\n  name               = \"armor-healthcheck\"\n  request_path       = \"/\"\n  check_interval_sec = 1\n  timeout_sec        = 1\n}\n\nresource \"google_compute_backend_service\" \"website\" {\n  name        = \"armor-backend\"\n  description = \"Our company website\"\n  port_name   = \"http\"\n  protocol    = \"HTTP\"\n  timeout_sec = 10\n  enable_cdn  = false\n\n  backend {\n    group = google_compute_instance_group.webservers.self_link\n  }\n\n  security_policy = google_compute_security_policy.security-policy-1.self_link\n\n  health_checks = [google_compute_http_health_check.health.self_link]\n}\n\n# Cloud Armor Security policies\nresource \"google_compute_security_policy\" \"security-policy-1\" {\n  name        = \"armor-security-policy\"\n  description = \"example security policy\"\n\n  # Reject all traffic that hasn't been whitelisted.\n  rule {\n    action   = \"deny(403)\"\n    priority = \"2147483647\"\n\n    match {\n      versioned_expr = \"SRC_IPS_V1\"\n\n      config {\n        src_ip_ranges = [\"*\"]\n      }\n    }\n\n    description = \"Default rule, higher priority overrides it\"\n  }\n\n  # Whitelist traffic from certain ip address\n  rule {\n    action   = \"allow\"\n    priority = \"1000\"\n\n    match {\n      versioned_expr = \"SRC_IPS_V1\"\n\n      config {\n        src_ip_ranges = var.ip_white_list\n      }\n    }\n\n    description = \"allow traffic from 192.0.2.0/24\"\n  }\n}\n\n# Front end of the load balancer\nresource \"google_compute_global_forwarding_rule\" \"default\" {\n  name       = \"armor-rule\"\n  target     = google_compute_target_http_proxy.default.self_link\n  port_range = \"80\"\n}\n\nresource \"google_compute_target_http_proxy\" \"default\" {\n  name    = \"armor-proxy\"\n  url_map = google_compute_url_map.default.self_link\n}\n\nresource \"google_compute_url_map\" \"default\" {\n  name            = \"armor-url-map\"\n  default_service = google_compute_backend_service.website.self_link\n\n  host_rule {\n    hosts        = [\"mysite.com\"]\n    path_matcher = \"allpaths\"\n  }\n\n  path_matcher {\n    name            = \"allpaths\"\n    default_service = google_compute_backend_service.website.self_link\n\n    path_rule {\n      paths   = [\"/*\"]\n      service = google_compute_backend_service.website.self_link\n    }\n  }\n}\n\noutput \"ip\" {\n  value = google_compute_global_forwarding_rule.default.ip_address\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__cloud-armor__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__cloud-armor__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__cloud-armor__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__cloud-armor__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__cloud-armor__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_GCP_73", "severity": "HIGH", "message": "Ensure Cloud Armor prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__cloud-armor__main.tf", "start_line": 99}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#####################################################################\n# Block-1: Terraform Settings Block\nterraform {\n  required_version = \">= 1.6.0\"\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \">= 5.31\"\n    }\n  }\n  # Adding Backend as S3 for Remote State Storage with State Locking\n  backend \"s3\" {\n    bucket = \"terraform-stacksimplify\"\n    key    = \"dev2/terraform.tfstate\"\n    region = \"us-east-1\"  \n\n    # For State Locking\n    dynamodb_table = \"terraform-dev-state-table\"\n  }\n}\n#####################################################################\n# Block-2: Provider Block\nprovider \"aws\" {\n  profile = \"default\" # AWS Credentials Profile configured on your local desktop terminal  $HOME/.aws/credentials\n  region  = \"us-east-1\"\n}\n#####################################################################\n# Block-3: Resource Block\nresource \"aws_instance\" \"ec2demo\" {\n  ami           = \"ami-04d29b6f966df1537\" # Amazon Linux\n  instance_type = var.instance_type\n}\n#####################################################################\n# Block-4: Input Variables Block\nvariable \"instance_type\" {\n  default = \"t2.micro\"\n  description = \"EC2 Instance Type\"\n  type = string\n}\n#####################################################################\n# Block-5: Output Values Block\noutput \"ec2_instance_publicip\" {\n  description = \"EC2 Instance Public IP\"\n  value = aws_instance.my-ec2-vm.public_ip\n}\n#####################################################################\n# Block-6: Local Values Block\n# Create S3 Bucket - with Input Variables & Local Values\nlocals {\n  bucket-name-prefix = \"${var.app_name}-${var.environment_name}\"\n}\n#####################################################################\n# Block-7: Data sources Block\n# Get latest AMI ID for Amazon Linux2 OS\ndata \"aws_ami\" \"amzlinux\" {\n  most_recent      = true\n  owners           = [\"amazon\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"amzn2-ami-hvm-*\"]\n  }\n\n  filter {\n    name   = \"root-device-type\"\n    values = [\"ebs\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  filter {\n    name   = \"architecture\"\n    values = [\"x86_64\"]\n  }\n\n}\n#####################################################################\n# Block-8: Modules Block\n# AWS EC2 Instance Module\n\nmodule \"ec2_cluster\" {\n  source                 = \"terraform-aws-modules/ec2-instance/aws\"\n  #version                = \"~> 2.0\"\n  version = \"5.5.0\"\n\n  name                   = \"my-modules-demo\"\n  #instance_count         = 2\n\n  ami                    = data.aws_ami.amzlinux.id\n  instance_type          = \"t2.micro\"\n  key_name               = \"terraform-key\"\n  monitoring             = true\n  vpc_security_group_ids = [\"sg-08b25c5a5bf489ffa\"]  # Get Default VPC Security Group ID and replace\n  subnet_id              = \"subnet-4ee95470\" # Get one public subnet id from default vpc and replace\n  user_data               = file(\"apache-install.sh\")\n\n  tags = {\n    Terraform   = \"true\"\n    Environment = \"dev\"\n  }\n}\n#####################################################################", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 84}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 29}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"blah\" \"something\" {", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__badhcl__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__badhcl__main.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__badhcl__main.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#====================#\n# vCenter connection #\n#====================#\n\nvariable \"vsphere_user\" {\n  description = \"vSphere user name\"\n}\n\nvariable \"vsphere_password\" {\n  description = \"vSphere password\"\n}\n\nvariable \"vsphere_vcenter\" {\n  description = \"vCenter server FQDN or IP\"\n}\n\nvariable \"vsphere_unverified_ssl\" {\n  description = \"Is the vCenter using a self signed certificate (true/false)\"\n}\n\nvariable \"vsphere_datacenter\" {\n  description = \"vSphere datacenter\"\n}\n\nvariable \"vsphere_drs_cluster\" {\n  description = \"vSphere cluster\"\n  default     = \"\"\n}\n\nvariable \"vsphere_resource_pool\" {\n  description = \"vSphere resource pool\"\n}\n\nvariable \"vsphere_enable_anti_affinity\" {\n  description = \"Enable anti affinity between master VMs and between worker VMs (DRS need to be enable on the cluster)\"\n  default     = \"false\"\n}\n\nvariable \"vsphere_vcp_user\" {\n  description = \"vSphere user name for the Kubernetes vSphere Cloud Provider plugin\"\n}\n\nvariable \"vsphere_vcp_password\" {\n  description = \"vSphere password for the Kubernetes vSphere Cloud Provider plugin\"\n}\n\nvariable \"vsphere_vcp_datastore\" {\n  description = \"vSphere default datastore for the Kubernetes vSphere Cloud Provider plugin\"\n}\n\n#===========================#\n# Kubernetes infrastructure #\n#===========================#\n\nvariable \"action\" {\n  description = \"Which action have to be done on the cluster (create, add_worker, remove_worker, or upgrade)\"\n  default     = \"create\"\n}\n\nvariable \"worker\" {\n  type        = \"list\"\n  description = \"List of worker IPs to remove\"\n\n  default = [\"\"]\n}\n\nvariable \"vm_user\" {\n  description = \"SSH user for the vSphere virtual machines\"\n}\n\nvariable \"vm_password\" {\n  description = \"SSH password for the vSphere virtual machines\"\n}\n\nvariable \"vm_privilege_password\" {\n  description = \"Sudo or su password for the vSphere virtual machines\"\n}\n\nvariable \"vm_distro\" {\n  description = \"Linux distribution of the vSphere virtual machines (ubuntu/centos/debian/rhel)\"\n}\n\nvariable \"vm_datastore\" {\n  description = \"Datastore used for the vSphere virtual machines\"\n}\n\nvariable \"vm_network\" {\n  description = \"Network used for the vSphere virtual machines\"\n}\n\nvariable \"vm_template\" {\n  description = \"Template used to create the vSphere virtual machines (linked clone)\"\n}\n\nvariable \"vm_folder\" {\n  description = \"vSphere Virtual machines folder\"\n}\n\nvariable \"vm_linked_clone\" {\n  description = \"Use linked clone to create the vSphere virtual machines from the template (true/false). If you would like to use the linked clone feature, your template need to have one and only one snapshot\"\n  default     = \"false\"\n}\n\nvariable \"k8s_kubespray_url\" {\n  description = \"Kubespray git repository\"\n  default     = \"https://github.com/kubernetes-incubator/kubespray.git\"\n}\n\nvariable \"k8s_kubespray_version\" {\n  description = \"Kubespray version\"\n  default     = \"2.8.2\"\n}\n\nvariable \"k8s_version\" {\n  description = \"Version of Kubernetes that will be deployed\"\n  default     = \"1.12.5\"\n}\n\nvariable \"vm_master_ips\" {\n  type        = \"map\"\n  description = \"IPs used for the Kubernetes master nodes\"\n}\n\nvariable \"vm_worker_ips\" {\n  type        = \"map\"\n  description = \"IPs used for the Kubernetes worker nodes\"\n}\n\nvariable \"vm_haproxy_vip\" {\n  description = \"IP used for the HAProxy floating VIP\"\n}\n\nvariable \"vm_haproxy_ips\" {\n  type        = \"map\"\n  description = \"IP used for two HAProxy virtual machine\"\n}\n\nvariable \"vm_netmask\" {\n  description = \"Netmask used for the Kubernetes nodes and HAProxy (example: 24)\"\n}\n\nvariable \"vm_gateway\" {\n  description = \"Gateway for the Kubernetes nodes\"\n}\n\nvariable \"vm_dns\" {\n  description = \"DNS for the Kubernetes nodes\"\n}\n\nvariable \"vm_domain\" {\n  description = \"Domain for the Kubernetes nodes\"\n}\n\nvariable \"k8s_network_plugin\" {\n  description = \"Kubernetes network plugin (calico/canal/flannel/weave/cilium/contiv/kube-router)\"\n  default     = \"flannel\"\n}\n\nvariable \"k8s_weave_encryption_password\" {\n  description = \"Weave network encyption password \"\n  default     = \"\"\n}\n\nvariable \"k8s_dns_mode\" {\n  description = \"Which DNS to use for the internal Kubernetes cluster name resolution (example: kubedns, coredns, etc.)\"\n  default     = \"coredns\"\n}\n\nvariable \"vm_master_cpu\" {\n  description = \"Number of vCPU for the Kubernetes master virtual machines\"\n}\n\nvariable \"vm_master_ram\" {\n  description = \"Amount of RAM for the Kubernetes master virtual machines (example: 2048)\"\n}\n\nvariable \"vm_worker_cpu\" {\n  description = \"Number of vCPU for the Kubernetes worker virtual machines\"\n}\n\nvariable \"vm_worker_ram\" {\n  description = \"Amount of RAM for the Kubernetes worker virtual machines (example: 2048)\"\n}\n\nvariable \"vm_haproxy_cpu\" {\n  description = \"Number of vCPU for the HAProxy virtual machine\"\n}\n\nvariable \"vm_haproxy_ram\" {\n  description = \"Amount of RAM for the HAProxy virtual machine (example: 1024)\"\n}\n\nvariable \"vm_name_prefix\" {\n  description = \"Prefix for the name of the virtual machines and the hostname of the Kubernetes nodes\"\n}\n\n#================#\n# Redhat account #\n#================#\n\nvariable \"rh_subscription_server\" {\n  description = \"Address of the Redhat subscription server\"\n  default     = \"subscription.rhsm.redhat.com\"\n}\n\nvariable \"rh_unverified_ssl\" {\n  description = \"Disable the Redhat subscription server certificate verification\"\n  default     = \"false\"\n}\n\nvariable \"rh_username\" {\n  description = \"Username of your Redhat account\"\n  default     = \"none\"\n}\n\nvariable \"rh_password\" {\n  description = \"Password of your Redhat account\"\n  default     = \"none\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sguyennet__terraform-vsphere-kubespray__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Backend Variables\nvariable \"state_bucket_name\" {\n    default = \"terraweek-demo-state-bucket\"\n}\n\nvariable \"state_table_name\" {\n    default = \"terraweek-demo-state-table\"\n}\n\nvariable \"aws_region\" {\n    default = \"us-east-1\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TerraWeek__day04__backend_infra__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"aws_region\" {\n  description = \"Details about selected AWS region\"\n  value       = data.aws_region.selected\n}\n\noutput \"available_aws_availability_zones_names\" {\n  description = \"A list of the Availability Zone names available to the account\"\n  value       = data.aws_availability_zones.available.names\n}\n\noutput \"available_aws_availability_zones_zone_ids\" {\n  description = \"A list of the Availability Zone IDs available to the account\"\n  value       = data.aws_availability_zones.available.zone_ids\n}\n\noutput \"amazon_linux2_aws_ami_id\" {\n  description = \"AMI ID of Amazon Linux 2\"\n  value       = data.aws_ami.amazon_linux2.id\n}\n\noutput \"ubuntu_1804_aws_ami_id\" {\n  description = \"AMI ID of Ubuntu 18.04\"\n  value       = data.aws_ami.ubuntu_1804.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Genaker__TerraformMagentoCloud__modules__aws-data__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 0.14\"\n  required_providers {\n    proxmox = {\n        source = \"telmate/proxmox\"\n    }\n  }\n}\n\n# Using proxmox from a vagrant e.g. https://github.com/rgl/proxmox-ve\nprovider \"proxmox\" {\n    pm_tls_insecure = true\n    pm_api_url = \"https://10.10.10.2:8006/api2/json\"\n    pm_user = \"root@pam\"\n    pm_password = \"vagrant\"\n}\n\nresource \"proxmox_vm_qemu\" \"example\" {\n    name        = \"servy-mcserverface\"\n    description = \"A test for using terraform and vagrant\"\n    target_node = \"pve\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Telmate__terraform-provider-proxmox__docs__examples__vagrant_example.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# //////////////////////////////\n# PROVIDERS\n# //////////////////////////////\nprovider \"aws\" {\n  access_key = var.aws_access_key\n  secret_key = var.aws_secret_key\n  region     = var.region\n}\n\nmodule \"node_instance\" {\n    source = \"./modules/nodejs-instance\"\n    instance_count = 2\n    environment_tags = {\n        \"environment_id\" = \"development\"\n    }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rajakumarguptatechie__terraform__03_04_custom-module__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"snowflake_database\" \"this\" {\n  name = \"DEMO_DB\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snowflakedb__terraform-provider-snowflake__examples__data-sources__snowflake_database__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 0.13\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \">= 4.0.0, < 5.0.0\"\n    }\n  }\n}\n\n/**\n * main.tf\n * The main entry point for Terraform run\n * See variables.tf for common variables\n * See ecr.tf for creation of Elastic Container Registry for all environments\n * See state.tf for creation of S3 bucket for remote state\n */\n\n# Using the AWS Provider\n# https://www.terraform.io/docs/providers/\nprovider \"aws\" {\n  region  = var.region\n  profile = var.aws_profile\n}\n\n/*\n * Outputs\n * Results from a successful Terraform run (terraform apply)\n * To see results after a successful run, use `terraform output [name]`\n */\n\n# Returns the name of the ECR registry, this will be used later in various scripts\noutput \"docker_registry\" {\n  value = aws_ecr_repository.app.repository_url\n}\n\n# Returns the name of the S3 bucket that will be used in later Terraform files\noutput \"bucket\" {\n  value = module.tf_remote_state.bucket\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/turnerlabs__terraform-ecs-fargate__base__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"bastion\" {\n  ami = \"${ var.ami-id }\"\n  associate_public_ip_address = true\n  iam_instance_profile = \"${ var.instance-profile-name }\"\n  instance_type = \"${ var.instance-type }\"\n  key_name = \"${ var.key-name }\"\n\n  source_dest_check = true\n  subnet_id = \"${ var.subnet-id }\"\n\n  tags  {\n    builtWith = \"terraform\"\n    kz8s = \"${ var.name }\"\n    depends-id = \"${ var.depends-id }\"\n    Name = \"kz8s-bastion\"\n    role = \"bastion\"\n  }\n\n  user_data = \"${ data.template_file.cloud-config.rendered }\"\n\n  vpc_security_group_ids = [\n    \"${ var.security-group-id }\",\n  ]\n}\n\nresource \"null_resource\" \"dummy_dependency\" {\n  depends_on = [ \"aws_instance.bastion\" ]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kz8s__tack__modules__bastion__ec2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kz8s__tack__modules__bastion__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kz8s__tack__modules__bastion__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kz8s__tack__modules__bastion__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kz8s__tack__modules__bastion__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kz8s__tack__modules__bastion__ec2.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"server_port\" {\n  description = \"The port the server will use for HTTP requests\"\n  type        = number\n  default     = 8080\n}\nvariable \"number_example\" {\n  description = \"An example of a number variable in Terraform\"\n  type        = number\n  default     = 42\n}\n\nvariable \"list_example\" {\n  description = \"An example of a list in Terraform\"\n  type        = list\n  default     = [\"a\", \"b\", \"c\"]\n}\n\nvariable \"list_numeric_example\" {\n  description = \"An example of a numeric list in Terraform\"\n  type        = list(number)\n  default     = [1, 2, 3]\n}\n\nvariable \"map_example\" {\n  description = \"An example of a map in Terraform\"\n  type        = map(string)\n\n  default = {\n    key1 = \"value1\"\n    key2 = \"value2\"\n    key3 = \"value3\"\n  }\n}\n\nvariable \"object_example\" {\n  description = \"An example of a structural type in Terraform\"\n  type        = object({\n    name    = string\n    age     = number\n    tags    = list(string)\n    enabled = bool\n  })\n\n  default = {\n    name    = \"value1\"\n    age     = 42\n    tags    = [\"a\", \"b\", \"c\"]\n    enabled = true\n  }\n}\n\nvariable \"security_group_name\" {\n  description = \"The name of the security group\"\n  type        = string\n  default     = \"terraform-example-instance\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Devops-Techstack__Terraform__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright Amazon.com, Inc. or its affiliates. All rights reserved.\n# SPDX-License-Identifier: Apache-2.0\n#\nmodule \"packaging\" {\n  source = \"./modules/aft-archives\"\n}\n\nmodule \"aft_account_provisioning_framework\" {\n  providers = {\n    aws = aws.aft_management\n  }\n  source                                           = \"./modules/aft-account-provisioning-framework\"\n  aft_account_provisioning_framework_sfn_name      = local.aft_account_provisioning_framework_sfn_name\n  aft_account_provisioning_customizations_sfn_name = local.aft_account_provisioning_customizations_sfn_name\n  trigger_customizations_sfn_name                  = local.trigger_customizations_sfn_name\n  aft_features_sfn_name                            = local.aft_features_sfn_name\n  aft_sns_topic_arn                                = module.aft_account_request_framework.aft_sns_topic_arn\n  aft_failure_sns_topic_arn                        = module.aft_account_request_framework.aft_failure_sns_topic_arn\n  aft_common_layer_arn                             = module.aft_lambda_layer.layer_version_arn\n  aft_kms_key_arn                                  = module.aft_account_request_framework.aft_kms_key_arn\n  aft_enable_vpc                                   = module.aft_account_request_framework.vpc_deployment\n  aft_vpc_private_subnets                          = module.aft_account_request_framework.aft_vpc_private_subnets\n  aft_vpc_default_sg                               = module.aft_account_request_framework.aft_vpc_default_sg\n  cloudwatch_log_group_retention                   = var.cloudwatch_log_group_retention\n  cloudwatch_log_group_enable_cmk_encryption       = var.cloudwatch_log_group_enable_cmk_encryption\n  provisioning_framework_archive_path              = module.packaging.provisioning_framework_archive_path\n  provisioning_framework_archive_hash              = module.packaging.provisioning_framework_archive_hash\n  create_role_lambda_function_name                 = local.create_role_lambda_function_name\n  tag_account_lambda_function_name                 = local.tag_account_lambda_function_name\n  persist_metadata_lambda_function_name            = local.persist_metadata_lambda_function_name\n  account_metadata_ssm_lambda_function_name        = local.account_metadata_ssm_lambda_function_name\n  delete_default_vpc_lambda_function_name          = local.delete_default_vpc_lambda_function_name\n  enroll_support_lambda_function_name              = local.enroll_support_lambda_function_name\n  enable_cloudtrail_lambda_function_name           = local.enable_cloudtrail_lambda_function_name\n  lambda_runtime_python_version                    = local.lambda_runtime_python_version\n  sns_topic_enable_cmk_encryption                  = var.sns_topic_enable_cmk_encryption\n}\n\nmodule \"aft_account_request_framework\" {\n  providers = {\n    aws               = aws.aft_management\n    aws.ct_management = aws.ct_management\n  }\n  source                                      = \"./modules/aft-account-request-framework\"\n  account_factory_product_name                = local.account_factory_product_name\n  aft_account_provisioning_framework_sfn_name = local.aft_account_provisioning_framework_sfn_name\n  aft_common_layer_arn                        = module.aft_lambda_layer.layer_version_arn\n  cloudwatch_log_group_retention              = var.cloudwatch_log_group_retention\n  cloudwatch_log_group_enable_cmk_encryption  = var.cloudwatch_log_group_enable_cmk_encryption\n  aft_enable_vpc                              = var.aft_enable_vpc\n  aft_vpc_cidr                                = var.aft_vpc_cidr\n  aft_vpc_private_subnet_01_cidr              = var.aft_vpc_private_subnet_01_cidr\n  aft_vpc_private_subnet_02_cidr              = var.aft_vpc_private_subnet_02_cidr\n  aft_vpc_public_subnet_01_cidr               = var.aft_vpc_public_subnet_01_cidr\n  aft_vpc_public_subnet_02_cidr               = var.aft_vpc_public_subnet_02_cidr\n  aft_vpc_endpoints                           = var.aft_vpc_endpoints\n  concurrent_account_factory_actions          = var.concurrent_account_factory_actions\n  request_framework_archive_path              = module.packaging.request_framework_archive_path\n  request_framework_archive_hash              = module.packaging.request_framework_archive_hash\n  lambda_runtime_python_version               = local.lambda_runtime_python_version\n  backup_recovery_point_retention             = var.backup_recovery_point_retention\n  aft_customer_vpc_id                         = var.aft_customer_vpc_id\n  aft_customer_private_subnets                = var.aft_customer_private_subnets\n  sns_topic_enable_cmk_encryption             = var.sns_topic_enable_cmk_encryption\n}\n\nmodule \"aft_backend\" {\n  providers = {\n    aws.primary_region   = aws.aft_management\n    aws.secondary_region = aws.tf_backend_secondary_region\n  }\n  source                                                = \"./modules/aft-backend\"\n  primary_region                                        = var.ct_home_region\n  secondary_region                                      = var.tf_backend_secondary_region\n  aft_management_account_id                             = var.aft_management_account_id\n  aft_backend_bucket_access_logs_object_expiration_days = var.aft_backend_bucket_access_logs_object_expiration_days\n}\n\nmodule \"aft_code_repositories\" {\n  providers = {\n    aws = aws.aft_management\n  }\n  source                                          = \"./modules/aft-code-repositories\"\n  vpc_id                                          = module.aft_account_request_framework.aft_vpc_id\n  aft_config_backend_bucket_id                    = module.aft_backend.bucket_id\n  aft_config_backend_table_id                     = module.aft_backend.table_id\n  aft_config_backend_kms_key_id                   = module.aft_backend.kms_key_id\n  account_request_table_name                      = module.aft_account_request_framework.request_table_name\n  codepipeline_s3_bucket_arn                      = module.aft_customizations.aft_codepipeline_customizations_bucket_arn\n  codepipeline_s3_bucket_name                     = module.aft_customizations.aft_codepipeline_customizations_bucket_name\n  security_group_ids                              = module.aft_account_request_framework.aft_vpc_default_sg\n  subnet_ids                                      = module.aft_account_request_framework.aft_vpc_private_subnets\n  aft_kms_key_arn                                 = module.aft_account_request_framework.aft_kms_key_arn\n  account_request_repo_branch                     = var.account_request_repo_branch\n  account_request_repo_name                       = var.account_request_repo_name\n  account_customizations_repo_name                = var.account_customizations_repo_name\n  global_customizations_repo_name                 = var.global_customizations_repo_name\n  github_enterprise_url                           = var.github_enterprise_url\n  gitlab_selfmanaged_url                          = var.gitlab_selfmanaged_url\n  vcs_provider                                    = var.vcs_provider\n  terraform_distribution                          = var.terraform_distribution\n  account_provisioning_customizations_repo_name   = var.account_provisioning_customizations_repo_name\n  account_provisioning_customizations_repo_branch = var.account_provisioning_customizations_repo_branch\n  account_customizations_repo_branch              = var.account_customizations_repo_branch\n  global_customizations_repo_branch               = var.global_customizations_repo_branch\n  cloudwatch_log_group_retention                  = var.cloudwatch_log_group_retention\n  cloudwatch_log_group_enable_cmk_encryption      = var.cloudwatch_log_group_enable_cmk_encryption\n  global_codebuild_timeout                        = var.global_codebuild_timeout\n  aft_enable_vpc                                  = module.aft_account_request_framework.vpc_deployment\n  codebuild_compute_type                          = var.aft_codebuild_compute_type\n}\n\nmodule \"aft_customizations\" {\n  providers = {\n    aws = aws.aft_management\n  }\n  source                                            = \"./modules/aft-customizations\"\n  aft_tf_aws_customizations_module_git_ref_ssm_path = local.ssm_paths.aft_tf_aws_customizations_module_git_ref_ssm_path\n  aft_tf_aws_customizations_module_url_ssm_path     = local.ssm_paths.aft_tf_aws_customizations_module_url_ssm_path\n  aft_tf_backend_region_ssm_path                    = local.ssm_paths.aft_tf_backend_region_ssm_path\n  aft_tf_ddb_table_ssm_path                         = local.ssm_paths.aft_tf_ddb_table_ssm_path\n  aft_tf_kms_key_id_ssm_path                        = local.ssm_paths.aft_tf_kms_key_id_ssm_path\n  aft_tf_s3_bucket_ssm_path                         = local.ssm_paths.aft_tf_s3_bucket_ssm_path\n  aft_tf_version_ssm_path                           = local.ssm_paths.aft_tf_version_ssm_path\n  aft_kms_key_id                                    = module.aft_account_request_framework.aft_kms_key_id\n  aft_kms_key_arn                                   = module.aft_account_request_framework.aft_kms_key_arn\n  aft_common_layer_arn                              = module.aft_lambda_layer.layer_version_arn\n  aft_sns_topic_arn                                 = module.aft_account_request_framework.sns_topic_arn\n  aft_failure_sns_topic_arn                         = module.aft_account_request_framework.failure_sns_topic_arn\n  request_metadata_table_name                       = module.aft_account_request_framework.request_metadata_table_name\n  aft_vpc_id                                        = module.aft_account_request_framework.aft_vpc_id\n  aft_vpc_private_subnets                           = module.aft_account_request_framework.aft_vpc_private_subnets\n  aft_vpc_default_sg                                = module.aft_account_request_framework.aft_vpc_default_sg\n  aft_config_backend_bucket_id                      = module.aft_backend.bucket_id\n  aft_config_backend_table_id                       = module.aft_backend.table_id\n  aft_config_backend_kms_key_id                     = module.aft_backend.kms_key_id\n  invoke_account_provisioning_sfn_arn               = module.aft_account_provisioning_framework.state_machine_arn\n  account_request_table_name                        = module.aft_account_request_framework.request_table_name\n  terraform_distribution                            = var.terraform_distribution\n  cloudwatch_log_group_retention                    = var.cloudwatch_log_group_retention\n  cloudwatch_log_group_enable_cmk_encryption        = var.cloudwatch_log_group_enable_cmk_encryption\n  maximum_concurrent_customizations                 = var.maximum_concurrent_customizations\n  customizations_archive_path                       = module.packaging.customizations_archive_path\n  customizations_archive_hash                       = module.packaging.customizations_archive_hash\n  global_codebuild_timeout                          = var.global_codebuild_timeout\n  lambda_runtime_python_version                     = local.lambda_runtime_python_version\n  aft_enable_vpc                                    = module.aft_account_request_framework.vpc_deployment\n  codebuild_compute_type                            = var.aft_codebuild_compute_type\n  sns_topic_enable_cmk_encryption                   = var.sns_topic_enable_cmk_encryption\n  sfn_s3_bucket_object_expiration_days              = var.sfn_s3_bucket_object_expiration_days\n}\n\nmodule \"aft_feature_options\" {\n  providers = {\n    aws.ct_management  = aws.ct_management\n    aws.audit          = aws.audit\n    aws.log_archive    = aws.log_archive\n    aws.aft_management = aws.aft_management\n  }\n  source                                     = \"./modules/aft-feature-options\"\n  log_archive_access_logs_bucket_name        = local.log_archive_access_logs_bucket_name\n  log_archive_bucket_name                    = local.log_archive_bucket_name\n  log_archive_bucket_object_expiration_days  = var.log_archive_bucket_object_expiration_days\n  aft_features_sfn_name                      = local.aft_features_sfn_name\n  aft_kms_key_arn                            = module.aft_account_request_framework.aft_kms_key_arn\n  aft_kms_key_id                             = module.aft_account_request_framework.aft_kms_key_id\n  aft_common_layer_arn                       = module.aft_lambda_layer.layer_version_arn\n  aft_sns_topic_arn                          = module.aft_account_request_framework.sns_topic_arn\n  aft_failure_sns_topic_arn                  = module.aft_account_request_framework.failure_sns_topic_arn\n  aft_vpc_private_subnets                    = module.aft_account_request_framework.aft_vpc_private_subnets\n  aft_vpc_default_sg                         = module.aft_account_request_framework.aft_vpc_default_sg\n  log_archive_account_id                     = var.log_archive_account_id\n  cloudwatch_log_group_retention             = var.cloudwatch_log_group_retention\n  feature_options_archive_path               = module.packaging.feature_options_archive_path\n  feature_options_archive_hash               = module.packaging.feature_options_archive_hash\n  delete_default_vpc_lambda_function_name    = local.delete_default_vpc_lambda_function_name\n  enroll_support_lambda_function_name        = local.enroll_support_lambda_function_name\n  enable_cloudtrail_lambda_function_name     = local.enable_cloudtrail_lambda_function_name\n  lambda_runtime_python_version              = local.lambda_runtime_python_version\n  aft_enable_vpc                             = module.aft_account_request_framework.vpc_deployment\n  cloudwatch_log_group_enable_cmk_encryption = var.cloudwatch_log_group_enable_cmk_encryption\n  sns_topic_enable_cmk_encryption            = var.sns_topic_enable_cmk_encryption\n}\n\nmodule \"aft_iam_roles\" {\n  source = \"./modules/aft-iam-roles\"\n  providers = {\n    aws.ct_management  = aws.ct_management\n    aws.audit          = aws.audit\n    aws.log_archive    = aws.log_archive\n    aws.aft_management = aws.aft_management\n  }\n}\n\nmodule \"aft_lambda_layer\" {\n  providers = {\n    aws = aws.aft_management\n  }\n  source                                            = \"./modules/aft-lambda-layer\"\n  aft_version                                       = local.aft_version\n  lambda_layer_name                                 = local.lambda_layer_name\n  lambda_layer_codebuild_delay                      = local.lambda_layer_codebuild_delay\n  lambda_layer_python_version                       = local.lambda_layer_python_version\n  lambda_runtime_python_version                     = local.lambda_runtime_python_version\n  aft_tf_aws_customizations_module_git_ref_ssm_path = local.ssm_paths.aft_tf_aws_customizations_module_git_ref_ssm_path\n  aft_tf_aws_customizations_module_url_ssm_path     = local.ssm_paths.aft_tf_aws_customizations_module_url_ssm_path\n  aws_region                                        = var.ct_home_region\n  aft_kms_key_arn                                   = module.aft_account_request_framework.aft_kms_key_arn\n  aft_vpc_id                                        = module.aft_account_request_framework.aft_vpc_id\n  aft_vpc_private_subnets                           = module.aft_account_request_framework.aft_vpc_private_subnets\n  aft_vpc_default_sg                                = module.aft_account_request_framework.aft_vpc_default_sg\n  s3_bucket_name                                    = module.aft_customizations.aft_codepipeline_customizations_bucket_name\n  builder_archive_path                              = module.packaging.builder_archive_path\n  builder_archive_hash                              = module.packaging.builder_archive_hash\n  cloudwatch_log_group_retention                    = var.cloudwatch_log_group_retention\n  aft_enable_vpc                                    = module.aft_account_request_framework.vpc_deployment\n  codebuild_compute_type                            = var.aft_codebuild_compute_type\n  cloudwatch_log_group_enable_cmk_encryption        = var.cloudwatch_log_group_enable_cmk_encryption\n}\n\nmodule \"aft_ssm_parameters\" {\n  providers = {\n    aws = aws.aft_management\n  }\n  source                                                      = \"./modules/aft-ssm-parameters\"\n  aft_request_queue_name                                      = module.aft_account_request_framework.request_queue_name\n  aft_request_table_name                                      = module.aft_account_request_framework.request_table_name\n  aft_request_audit_table_name                                = module.aft_account_request_framework.request_audit_table_name\n  aft_request_metadata_table_name                             = module.aft_account_request_framework.request_metadata_table_name\n  aft_controltower_events_table_name                          = module.aft_account_request_framework.controltower_events_table_name\n  account_factory_product_name                                = module.aft_account_request_framework.account_factory_product_name\n  aft_invoke_aft_account_provisioning_framework_function_name = module.aft_account_request_framework.invoke_aft_account_provisioning_framework_lambda_function_name\n  aft_cleanup_resources_function_name                         = module.aft_account_request_framework.aft_cleanup_resources_function_name\n  aft_account_provisioning_framework_sfn_name                 = module.aft_account_request_framework.aft_account_provisioning_framework_sfn_name\n  aft_sns_topic_arn                                           = module.aft_account_request_framework.sns_topic_arn\n  aft_failure_sns_topic_arn                                   = module.aft_account_request_framework.failure_sns_topic_arn\n  request_action_trigger_function_arn                         = module.aft_account_request_framework.request_action_trigger_function_arn\n  request_audit_trigger_function_arn                          = module.aft_account_request_framework.request_audit_trigger_function_arn\n  request_processor_function_arn                              = module.aft_account_request_framework.request_processor_function_arn\n  control_tower_event_logger_function_arn                     = module.aft_account_request_framework.control_tower_event_logger_function_arn\n  invoke_aft_account_provisioning_framework_function_arn      = module.aft_account_request_framework.invoke_aft_account_provisioning_framework_function_arn\n  create_role_function_arn                                    = module.aft_account_provisioning_framework.create_role_function_arn\n  tag_account_function_arn                                    = module.aft_account_provisioning_framework.tag_account_function_arn\n  persist_metadata_function_arn                               = module.aft_account_provisioning_framework.persist_metadata_function_arn\n  aft_customizations_identify_targets_function_arn            = module.aft_customizations.aft_customizations_identify_targets_function_arn\n  aft_customizations_execute_pipeline_function_arn            = module.aft_customizations.aft_customizations_execute_pipeline_function_arn\n  aft_customizations_get_pipeline_executions_function_arn     = module.aft_customizations.aft_customizations_get_pipeline_executions_function_arn\n  codeconnections_connection_arn                              = module.aft_code_repositories.codeconnections_connection_arn\n  aft_log_key_arn                                             = module.aft_feature_options.aws_aft_log_key_arn\n  aft_logging_bucket_arn                                      = module.aft_feature_options.aws_aft_logs_s3_bucket_arn\n  aft_config_backend_bucket_id                                = module.aft_backend.bucket_id\n  aft_config_backend_table_id                                 = module.aft_backend.table_id\n  aft_config_backend_kms_key_id                               = module.aft_backend.kms_key_id\n  aft_administrator_role_name                                 = local.aft_administrator_role_name\n  aft_execution_role_name                                     = local.aft_execution_role_name\n  aft_session_name                                            = local.aft_session_name\n  aft_version                                                 = local.aft_version\n  ct_management_account_id                                    = var.ct_management_account_id\n  ct_audit_account_id                                         = var.audit_account_id\n  ct_log_archive_account_id                                   = var.log_archive_account_id\n  aft_management_account_id                                   = var.aft_management_account_id\n  ct_primary_region                                           = var.ct_home_region\n  tf_version                                                  = var.terraform_version\n  tf_distribution                                             = var.terraform_distribution\n  terraform_api_endpoint                                      = var.terraform_api_endpoint\n  account_request_repo_branch                                 = var.account_request_repo_branch\n  account_request_repo_name                                   = var.account_request_repo_name\n  vcs_provider                                                = var.vcs_provider\n  aft_config_backend_primary_region                           = var.ct_home_region\n  aft_config_backend_secondary_region                         = var.tf_backend_secondary_region\n  aft_framework_repo_url                                      = var.aft_framework_repo_url\n  aft_framework_repo_git_ref                                  = local.aft_framework_repo_git_ref\n  terraform_token                                             = var.terraform_token # Null default value #tfsec:ignore:general-secrets-no-plaintext-exposure\n  terraform_version                                           = var.terraform_version\n  terraform_org_name                                          = var.terraform_org_name\n  terraform_project_name                                      = var.terraform_project_name\n  aft_feature_cloudtrail_data_events                          = var.aft_feature_cloudtrail_data_events\n  aft_feature_enterprise_support                              = var.aft_feature_enterprise_support\n  aft_feature_delete_default_vpcs_enabled                     = var.aft_feature_delete_default_vpcs_enabled\n  account_customizations_repo_name                            = var.account_customizations_repo_name\n  account_customizations_repo_branch                          = var.account_customizations_repo_branch\n  global_customizations_repo_name                             = var.global_customizations_repo_name\n  global_customizations_repo_branch                           = var.global_customizations_repo_branch\n  account_provisioning_customizations_repo_name               = var.account_provisioning_customizations_repo_name\n  account_provisioning_customizations_repo_branch             = var.account_provisioning_customizations_repo_branch\n  maximum_concurrent_customizations                           = var.maximum_concurrent_customizations\n  github_enterprise_url                                       = var.github_enterprise_url\n  gitlab_selfmanaged_url                                      = var.gitlab_selfmanaged_url\n  aft_codepipeline_customizations_bucket_id                   = module.aft_customizations.aft_codepipeline_customizations_bucket_name\n  aft_metrics_reporting                                       = var.aft_metrics_reporting\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-control_tower_account_factory__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_SECRET_6", "severity": "CRITICAL", "message": "Base64 High Entropy String", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-control_tower_account_factory__main.tf", "start_line": 273}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"wrapper\" {\n  description = \"Map of outputs of a wrapper.\"\n  value       = module.wrapper\n  # sensitive = false # No sensitive module output found\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-ecs__wrappers__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region  = \"us-west-2\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__learning-terraform-3087701__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"vpc_id\" {\n  value = aws_vpc.this.id\n}\n\noutput \"igw_id\" {\n  value = aws_internet_gateway.this.id\n}\n\noutput \"subnet_ids\" {\n  value = local.subnet_ids\n}\n\noutput \"public_route_table_id\" {\n  value = aws_route_table.public.id\n}\n\noutput \"private_route_table_id\" {\n  value = aws_route_table.private.id\n}\n\noutput \"route_table_assossiation_ids\" {\n  value = [for k, v in aws_route_table_association.this : v.id]\n}\n\noutput \"sg_web_id\" {\n  value = aws_security_group.web.id\n}\n\noutput \"sg_db_id\" {\n  value = aws_security_group.db.id\n}\n\noutput \"sg_alb_id\" {\n  value = aws_security_group.alb.id\n}\n\noutput \"alb_id\" {\n  value = aws_lb.this.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.region\n}\n\nmodule \"acm\" {\n  source = \"../../../modules/acm\"\n  region = var.region\n\n  domain_name                                 = var.domain_name\n  validation_method                           = var.validation_method\n  key_algorithm                               = var.key_algorithm\n  certificate_transparency_logging_preference = var.certificate_transparency_logging_preference\n  dns_domain_name = var.dns_domain_name\n  \n  name        = var.name\n  environment = var.environment\n  owner       = var.owner\n  cost_center = var.cost_center\n  application = var.application\n}  ", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__terraform-aws__environments__dev__acm__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"cloudflare_access_identity_provider\" \"terraform_managed_resource\" {\n  name    = \"GitHub OAuth\"\n  type    = \"github\"\n  zone_id = \"0da42c8d2132a9ddaf714f9e7c920711\"\n  config {\n    client_id = \"example-id\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudflare__cf-terraforming__testdata__terraform__v4__cloudflare_access_identity_provider_oauth_zone__test.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# SYNTAX TEST \"Terraform.sublime-syntax\"\n\n/////////////////////////////////////////////////////////////////////\n// INLINE COMMENTS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Start of line inline comments with `#`.\n/////\n\n# inline comment\n# ^ source.terraform comment.line.terraform\n\n/////\n// Start of line inline comments with `//`.\n/////\n\n// foo\n# ^ source.terraform comment.line.terraform\n\n/////\n// Matches at random place in line + punctuation for `#`.\n/////\n\n        # bar\n#     ^ - comment - punctuation\n#       ^ punctuation.definition.comment.terraform\n#       ^^^^^ comment.line.terraform\n\n/////\n// Matches at random place in line + punctuation for `//`.\n/////\n\n    // baz # blah\n# ^ - comment - punctuation\n#   ^^ punctuation.definition.comment.terraform\n#   ^^^^^^^^^^^^^ comment.line.terraform\n\n/////////////////////////////////////////////////////////////////////\n// BLOCK COMMENTS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Matches for a single line.\n/////\n\n    /* foo */\n# ^ - comment - punctuation\n#   ^^ punctuation.definition.comment.terraform\n#   ^^^^^^^^ comment.block.terraform\n#          ^^ punctuation.definition.comment.terraform\n\n/////\n// Matches over multiple lines.\n/////\n\n    /*\n# ^ - comment - punctuation\n#   ^^ punctuation.definition.comment.terraform\n#   ^^^^ comment.block.terraform\n\n  foo\n# ^^^^ comment.block.terraform\n\n    */\n# ^^^^ comment.block.terraform\n#   ^^ punctuation.definition.comment.terraform\n\n/////\n// Matches inline comments after block ends.\n/////\n\n     /* comment */    // inline\n# ^ - comment - punctuation\n#    ^^ punctuation.definition.comment.terraform\n#    ^^^^^^^^^^^^ comment.block.terraform\n#               ^^ punctuation.definition.comment.terraform\n#                 ^^^ - comment - punctuation\n#                     ^^ punctuation.definition.comment.terraform\n#                     ^^^^^^^^ comment.line.terraform\n\n/////////////////////////////////////////////////////////////////////\n// LANGUAGE CONSTANTS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Matches `true`.\n/////\n\n    true\n# ^ - constant\n#   ^^^^ constant.language.boolean.true.terraform\n#         ^ - constant\n\n/////\n// Matches `false`.\n/////\n\n    false\n# ^ - constant\n#   ^^^^^ constant.language.boolean.false.terraform\n#         ^ - constant\n\n\n/////\n// Matches `null`.\n/////\n\n    null\n# ^ - constant\n#   ^^^^ constant.language.null.terraform\n#         ^ - constant\n\n/////////////////////////////////////////////////////////////////////\n// INTEGER CONSTANTS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Matches integers.\n/////\n\n    444\n#  ^ - meta.number - constant\n#   ^^^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#      ^ - meta.number - constant\n\n/////\n// Matches zero.\n/////\n\n      0\n#    ^ - meta.number - constant\n#     ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#      ^ - meta.number - constant\n\n/////\n// Matches one.\n/////\n\n      1\n#    ^ - meta.number - constant\n#     ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#      ^ - meta.number - constant\n\n/////\n// Matches large integers.\n/////\n\n      26345645634561\n#    ^ - meta.number - constant\n#     ^^^^^^^^^^^^^^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                   ^ - meta.number - constant\n\n/////\n// Ignores integers inside identifiers.\n/////\n\n    aws_route53_zone.main.zone_id\n#   ^^^^^^^^^^^^^^^^ - numeric - constant\n#                   ^ punctuation.accessor.dot.terraform\n#                    ^^^^ variable.other.member.terraform\n#                        ^ punctuation.accessor.dot.terraform\n#                         ^^^^^^^ variable.other.member.terraform\n\n/////////////////////////////////////////////////////////////////////\n// FLOATING-POINT CONSTANTS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Matches floating-point numbers.\n/////\n\n      1.2\n#    ^ - meta.number - constant\n#     ^^^ meta.number.float.decimal.terraform constant.numeric.value.terraform\n#      ^ punctuation.separator.decimal.terraform\n#        ^ - meta.number - constant\n\n/////\n// Matches large floating-point numbers.\n/////\n\n      61.28888888888\n#    ^ - meta.number - constant\n#     ^^^^^^^^^^^^^^ meta.number.float.decimal.terraform constant.numeric.value.terraform\n#       ^ punctuation.separator.decimal.terraform\n#                   ^ - meta.number - constant\n\n/////\n// Matches integers with exponents.\n/////\n\n      1e12\n#    ^ - meta.number - constant\n#     ^^^^ meta.number.float.decimal.terraform constant.numeric.value.terraform\n#         ^ - meta.number - constant\n\n/////\n// Matches floats with exponents.\n/////\n\n      1.4E12\n#    ^ - meta.number - constant\n#     ^^^^^^ meta.number.float.decimal.terraform constant.numeric.value.terraform\n#      ^ punctuation.separator.decimal.terraform\n#           ^ - meta.number - constant\n\n/////\n// Matches floats with postive signed exponents.\n/////\n\n      1.4e+12\n#    ^ - meta.number - constant\n#     ^^^^^^^ meta.number.float.decimal.terraform constant.numeric.value.terraform\n#      ^ punctuation.separator.decimal.terraform\n#            ^ - meta.number - constant\n\n/////\n// Matches floats with negative signed exponents.\n/////\n\n      1.4E-12\n#    ^ - meta.number - constant\n#     ^^^^^^^ meta.number.float.decimal.terraform constant.numeric.value.terraform\n#      ^ punctuation.separator.decimal.terraform\n#            ^ - meta.number - constant\n\n/////////////////////////////////////////////////////////////////////\n// STRINGS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Matches punctuation and assigns meta_scope.\n/////\n\n      \"a string\"\n#   ^ - punctuation - string\n#     ^ punctuation.definition.string.begin.terraform\n#     ^^^^^^^^^^ string.quoted.double.terraform\n#              ^ punctuation.definition.string.end.terraform\n#                 ^ - punctuation - string\n\n/////\n// Matches character escapes.\n/////\n\n      \"a \\n b \\r c \\t d \\\" e \\udead f \\udeadbeef\"\n#   ^ - punctuation - string\n#     ^ punctuation.definition.string.begin.terraform\n#     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ string.quoted.double.terraform\n#        ^^ constant.character.escape.terraform\n#             ^^ constant.character.escape.terraform\n#                  ^^ constant.character.escape.terraform\n#                       ^^ constant.character.escape.terraform\n#                            ^^^^^ constant.character.escape.terraform\n#                                     ^^^^^^^^^^ constant.character.escape.terraform\n#                                               ^ punctuation.definition.string.end.terraform\n\n/////\n// Unclosed strings\n/////\n\n  \"\n# ^ meta.string.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#  ^ invalid.illegal.unclosed-string.terraform\n\n/////////////////////////////////////////////////////////////////////\n// Identifiers\n/////////////////////////////////////////////////////////////////////\n\n      this_is_an_identifier\n#     ^^^^^^^^^^^^^^^^^^^^^ variable.other.readwrite.terraform\n\n      identifier.member_access\n#     ^^^^^^^^^^ variable.other.readwrite.terraform\n#               ^ punctuation.accessor.dot.terraform\n#                ^^^^^^^^^^^^^ variable.other.member.terraform\n\n      identifier-with-hyphens\n#     ^^^^^^^^^^^^^^^^^^^^^^^ variable.other.readwrite.terraform\n\n      __EOF__\n#     ^^^^^^^ variable.other.readwrite.terraform\n\n      identifier.\n// comment\n# <- comment\n\n/////////////////////////////////////////////////////////////////////\n// STRING INTERPOLATION\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Correct scopes during interpolation.\n/////\n\n      \"some ${interpolation} string\"\n#   ^ - punctuation - string\n#     ^ punctuation.definition.string.begin.terraform\n#     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.string.terraform\n#      ^^^^^ string.quoted.double.terraform\n#           ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#             ^^^^^^^^^^^^^^ meta.interpolation.terraform\n#              ^^^^^^^^^^^^ source.terraform\n#                          ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                            ^^^^^^^ string.quoted.double.terraform\n#                                  ^ punctuation.definition.string.end.terraform\n#                                   ^ - punctuation - string\n\n/////\n// Matches left-trim and right-trim.\n/////\n\n      \"%{~ fff ~}\"\n#     ^^^^^^^^^^^^ meta.string.terraform\n#      ^^^^^^^^^^ meta.interpolation.terraform\n#     ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#      ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#        ^ meta.interpolation.terraform keyword.operator.template.trim.left.terraform\n#         ^^^^^ source.terraform\n#              ^ keyword.operator.template.trim.right.terraform\n#               ^ punctuation.section.interpolation.end.terraform\n#                ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n\n/////\n// Matches operators\n/////\n\n    \"${ something ? true : false }\"\n#   ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#    ^^ punctuation.section.interpolation.begin.terraform\n#     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.interpolation.terraform\n#      ^^^^^^^^^^^^^^^^^^^^^^^^^^ source.terraform\n#                 ^ keyword.operator.ternary.terraform\n#                   ^^^^ meta.interpolation.terraform constant.language.boolean.true.terraform\n#                        ^ meta.interpolation.terraform keyword.operator.ternary.terraform\n#                          ^^^^^ meta.interpolation.terraform constant.language.boolean.false.terraform\n#                                ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                 ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n\n/////\n// Dot-access attributes in string interpolation\n/////\n\n    \"hello ${aws_instance.ubuntu}\"\n#   ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#   ^^^^^^^ string.quoted.double.terraform\n#          ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#            ^^^^^^^^^^^^^^^^^^^^ meta.interpolation.terraform\n#                        ^ meta.interpolation.terraform punctuation.accessor.dot.terraform\n#                         ^^^^^^ meta.interpolation.terraform variable.other.member.terraform\n#                               ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n\n/////\n// Handles function calls\n/////\n\n      \"${formatdate(\"DD MMM YYYY hh:mm ZZZ\", \"2018-01-02T23:12:01Z\")}\"\n#     ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#      ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#        ^^^^^^^^^^ meta.interpolation.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                  ^ meta.interpolation.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                   ^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                    ^^^^^^^^^^^^^^^^^^^^^^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                          ^ meta.interpolation.terraform meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                            ^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                             ^^^^^^^^^^^^^^^^^^^^^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                                  ^ meta.interpolation.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                                                   ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                                                    ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n\n/////\n// Handles nested function calls.\n/////\n\n    id = \"db-final-snapshot-${md5(timestamp())}\"\n#   ^^ variable.declaration.terraform variable.other.readwrite.terraform\n#      ^ keyword.operator.assignment.terraform\n#        ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#         ^^^^^^^^^^^^^^^^^^ string.quoted.double.terraform\n#                           ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                             ^^^ meta.interpolation.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                                ^ meta.interpolation.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                                 ^^^^^^^^^ meta.interpolation.terraform meta.function-call.arguments.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                                          ^ meta.interpolation.terraform meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                                           ^ meta.interpolation.terraform meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                            ^ meta.interpolation.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                             ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                              ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n\n/////\n// Includes objects.\n////\n\n    \"something ${{test = 3}}\"\n#   ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#    ^^^^^^^^^^ string.quoted.double.terraform\n#              ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                ^ meta.interpolation.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n#                 ^^^^ meta.interpolation.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                      ^ meta.interpolation.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                        ^ meta.interpolation.terraform source.terraform meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                         ^ meta.interpolation.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n#                          ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                           ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n\n/////\n// Includes tuples.\n////\n\n    \"something ${[1, 2, 3]}\"\n#   ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#    ^^^^^^^^^^ string.quoted.double.terraform\n#              ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                ^ meta.interpolation.terraform punctuation.section.brackets.begin.terraform\n#                 ^ meta.interpolation.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                  ^ meta.interpolation.terraform punctuation.separator.terraform\n#                    ^ meta.interpolation.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                     ^ meta.interpolation.terraform punctuation.separator.terraform\n#                       ^ meta.interpolation.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                        ^ meta.interpolation.terraform punctuation.section.brackets.end.terraform\n#                         ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                          ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n\n/////\n// Includes named values.\n/////\n\n    \"${var.something}\"\n#   ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#    ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#      ^^^ meta.interpolation.terraform variable.language.terraform\n#         ^ meta.interpolation.terraform punctuation.accessor.dot.terraform\n#          ^^^^^^^^^ meta.interpolation.terraform variable.other.member.terraform\n#                   ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                    ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n\n/////\n// Handles regexes (various punctuation).\n/////\n\n    records = [\"${replace(\"hostname.domain.com:1234\", \"/(.*):[0-9]{0,26}/\", \"$1\")}\"]\n#   ^^^^^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#           ^ keyword.operator.assignment.terraform\n#             ^ punctuation.section.brackets.begin.terraform\n#              ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#               ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                 ^^^^^^^ meta.interpolation.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                        ^ meta.interpolation.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                         ^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                          ^^^^^^^^^^^^^^^^^^^^^^^^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                  ^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                                                   ^ meta.interpolation.terraform meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                                     ^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                                      ^^^^^^^^^^^^^^^^^^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                                        ^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                                                                         ^ meta.interpolation.terraform meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                                                           ^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                                                            ^^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                                              ^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                                                                               ^ meta.interpolation.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                                                                ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                                                                 ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                                                                                  ^ punctuation.section.brackets.end.terraform\n#                                                                                   ^ - meta - string - variable - punctuation\n\n/////\n// Handles nested interpolation.\n/////\n\n    \"${file(\"${path.module}/text_files/ecs_app\")}\"\n#   ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#    ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#      ^^^^ meta.interpolation.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.interpolation.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#            ^^ meta.interpolation.terraform meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#              ^^^^ meta.interpolation.terraform meta.function-call.arguments.terraform meta.interpolation.terraform variable.language.terraform\n#                  ^ meta.interpolation.terraform meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.accessor.dot.terraform\n#                   ^^^^^^ meta.interpolation.terraform meta.function-call.arguments.terraform meta.interpolation.terraform variable.other.member.terraform\n#                         ^ meta.interpolation.terraform meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                          ^^^^^^^^^^^^^^^^^^^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                             ^ meta.interpolation.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                                              ^ meta.interpolation.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                               ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                                ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n\n/////////////////////////////////////////////////////////////////////\n// Template If Directives\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Matches if/endif directives.\n/////\n\n      \"${ if name == \"Mary\" }${name}${ endif ~}\"\n#    ^ - string - punctuation\n#     ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#      ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.interpolation.terraform\n#         ^^ meta.interpolation.terraform keyword.control.conditional.if.terraform\n#                 ^^ meta.interpolation.terraform keyword.operator.comparison.terraform\n#                    ^ source.terraform meta.interpolation.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                    ^^^^^^ source.terraform meta.interpolation.terraform string.quoted.double.terraform\n#                         ^ source.terraform meta.interpolation.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                           ^ punctuation.section.interpolation.end.terraform\n#                            ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                                  ^ punctuation.section.interpolation.end.terraform\n#                                   ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                                      ^^^^^ meta.interpolation.terraform keyword.control.conditional.end.terraform\n#                                            ^ meta.interpolation.terraform keyword.operator.template.trim.right.terraform\n#                                             ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                              ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                                               ^ - string - punctuation\n\n/////\n// Matches if/else/endif directives.\n/////\n\n      \"%{ if name == \"Mary\" }${name}%{ else }${ \"Mary\" }%{ endif ~}\"\n#    ^ - string - punctuation\n#     ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#      ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.interpolation.terraform\n#         ^^ meta.interpolation.terraform keyword.control.conditional.if.terraform\n#                 ^^ meta.interpolation.terraform keyword.operator.comparison.terraform\n#                    ^ source.terraform meta.interpolation.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                    ^^^^^^ source.terraform meta.interpolation.terraform string.quoted.double.terraform\n#                         ^ source.terraform meta.interpolation.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                           ^ punctuation.section.interpolation.end.terraform\n#                            ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                                  ^ punctuation.section.interpolation.end.terraform\n#                                   ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                                      ^^^^ meta.interpolation.terraform keyword.control.conditional.else.terraform\n#                                           ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                            ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                                               ^ meta.interpolation.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                                ^^^^^ meta.interpolation.terraform string.quoted.double.terraform\n#                                                      ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                                      ^ punctuation.section.interpolation.end.terraform\n#                                                       ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                                                          ^^^^^ meta.interpolation.terraform keyword.control.conditional.end.terraform\n#                                                                ^ meta.interpolation.terraform keyword.operator.template.trim.right.terraform\n#                                                                 ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                                                  ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                                                                   ^ - string - punctuation\n\n/////\n// Matches for/in/endfor directives.\n/////\n\n      \"%{ for name in var.names ~}${name}%{ endfor ~}\"\n#   ^ - string - punctuation\n#     ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#      ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#         ^^^ keyword.control.loop.for.terraform\n#      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.interpolation.terraform\n#                  ^^ keyword.control.loop.in.terraform\n#                     ^^^ meta.interpolation.terraform variable.language.terraform\n#                        ^ meta.interpolation.terraform punctuation.accessor.dot.terraform\n#                         ^^^^^ meta.interpolation.terraform variable.other.member.terraform\n#                               ^ keyword.operator.template.trim.right.terraform\n#                                ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                 ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                                       ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                        ^^ meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                                           ^^^^^^ keyword.control.loop.end.terraform\n#                                                  ^ meta.interpolation.terraform keyword.operator.template.trim.right.terraform\n#                                                   ^ meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                                    ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                                                     ^ - string - punctuation\n\n/////////////////////////////////////////////////////////////////////\n// TEMPLATE LITERALS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Template literal using `$` character\n/////\n\n      \"some $${interpolation} string\"\n#     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#     ^ punctuation.definition.string.begin.terraform\n#           ^^^ constant.character.escape.terraform\n#                                   ^ punctuation.definition.string.end.terraform\n\n/////\n// Template literal using `%` character\n/////\n\n      \"some %%{interpolation} string\"\n#     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#     ^ punctuation.definition.string.begin.terraform\n#           ^^^ constant.character.escape.terraform\n#                                   ^ punctuation.definition.string.end.terraform\n\n/////////////////////////////////////////////////////////////////////\n// Operators\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Comparison\n/////\n\n    a == b\n#   ^ - keyword - operator\n#     ^^ keyword.operator.comparison.terraform\n#         ^ - keyword - operator\n\n    a != b\n#   ^ - keyword - operator\n#     ^^ keyword.operator.comparison.terraform\n#         ^ - keyword - operator\n\n    a < b\n#    ^ - keyword - operator\n#     ^ keyword.operator.comparison.terraform\n#      ^ - keyword - operator\n\n    a <= b\n#    ^ - keyword - operator\n#     ^^ keyword.operator.comparison.terraform\n#       ^ - keyword - operator\n\n    a > b\n#    ^ - keyword - operator\n#     ^ keyword.operator.comparison.terraform\n#      ^ - keyword - operator\n\n    a >= b\n#    ^ - keyword - operator\n#     ^^ keyword.operator.comparison.terraform\n#       ^ - keyword - operator\n\n/////\n// Arithmetic\n/////\n\n    a + b\n#    ^ - keyword - operator\n#     ^ keyword.operator.arithmetic.terraform\n#      ^ - keyword - operator\n\n    a - b\n#    ^ - keyword - operator\n#     ^ keyword.operator.arithmetic.terraform\n#      ^ - keyword - operator\n\n    a * b\n#    ^ - keyword - operator\n#     ^ keyword.operator.arithmetic.terraform\n#      ^ - keyword - operator\n\n    a / b\n#    ^ - keyword - operator\n#     ^ keyword.operator.arithmetic.terraform\n#      ^ - keyword - operator\n\n    a % b\n#    ^ - keyword - operator\n#     ^ keyword.operator.arithmetic.terraform\n#      ^ - keyword - operator\n\n    - a\n#  ^ - keyword - operator\n#   ^ keyword.operator.arithmetic.terraform\n#    ^ - keyword - operator\n\n/////\n// Logic\n/////\n\n    a && b\n#   ^^ - keyword - operator\n#     ^^ keyword.operator.logical.terraform\n#       ^^ - keyword - operator\n\n    a || b\n#   ^^ - keyword - operator\n#     ^^ keyword.operator.logical.terraform\n#       ^^ - keyword - operator\n\n    !a\n# ^^ - keyword - operator\n#   ^ keyword.operator.logical.terraform\n#    ^^ - keyword - operator\n\n/////\n// Conditional\n/////\n\n    length(some_list) > 0 ? some_list[0] : default\n#   ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#         ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#          ^^^^^^^^^ meta.function-call.arguments.terraform\n#                   ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                     ^ keyword.operator.comparison.terraform\n#                       ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                         ^ keyword.operator.ternary.terraform\n#                                    ^ punctuation.section.brackets.begin.terraform\n#                                     ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                      ^ punctuation.section.brackets.end.terraform\n#                                        ^ keyword.operator.ternary.terraform\n\n/////\n// Ellipsis\n/////\n\n    hhh([55, 2453, 2]...)\n#   ^^^ meta.function-call.identifier.terraform variable.function.terraform\n#      ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#       ^ punctuation.section.brackets.begin.terraform\n#        ^^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#          ^ punctuation.separator.terraform\n#            ^^^^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                ^ punctuation.separator.terraform\n#                  ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                   ^ punctuation.section.brackets.end.terraform\n#                    ^^^ keyword.operator.terraform\n#                       ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////////////////////////////////////////////////////////////////////\n// Brackets: Index Operations and Arrays\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Index Operations\n/////\n\n    thing[1]\n#       ^ - punctuation\n#        ^ punctuation.section.brackets.begin.terraform\n#         ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#          ^ punctuation.section.brackets.end.terraform\n#           ^ - punctuation\n\n/////\n// Arrays of literals\n/////\n\n    [\"a\", \"b\", \"c\"]\n#   ^^^^^^^^^^^^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.begin.terraform\n#    ^ punctuation.definition.string.begin.terraform\n#    ^^^ string.quoted.double.terraform\n#      ^ punctuation.definition.string.end.terraform\n#       ^ punctuation.separator.terraform\n#         ^ punctuation.definition.string.begin.terraform\n#         ^^^ string.quoted.double.terraform\n#           ^ punctuation.definition.string.end.terraform\n#            ^ punctuation.separator.terraform\n#              ^ punctuation.definition.string.begin.terraform\n#              ^^^ string.quoted.double.terraform\n#                ^ punctuation.definition.string.end.terraform\n#                 ^ punctuation.section.brackets.end.terraform\n\n/////\n// Allows inline comments\n/////\n\n    [1, /* inline */ 2]\n#   ^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.begin.terraform\n#    ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#     ^ punctuation.separator.terraform\n#       ^^ punctuation.definition.comment.terraform\n#       ^^^^^^^^^^^^ comment.block.terraform\n#                 ^^ punctuation.definition.comment.terraform\n#                    ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                     ^ punctuation.section.brackets.end.terraform\n\n/////\n// Allows expression over multiple lines\n/////\n\n    [\n#   ^ punctuation.section.brackets.begin.terraform\n      1,\n#     ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#      ^ punctuation.separator.terraform\n      2\n#     ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n    ]\n#   ^ punctuation.section.brackets.end.terraform\n\n/////\n// Allows operators\n/////\n\n    [ 1 + 2 ]\n#   ^^^^^^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.begin.terraform\n#     ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#       ^ keyword.operator.arithmetic.terraform\n#         ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#           ^ punctuation.section.brackets.end.terraform\n\n/////\n// Splat operator\n/////\n\n    tuple[*].foo.bar[0]\n#        ^ punctuation.section.brackets.begin.terraform\n#         ^ punctuation.section.brackets.end.terraform keyword.operator.splat.terraform\n#          ^ punctuation.section.brackets.end.terraform\n#           ^ punctuation.accessor.dot.terraform\n#            ^^^ variable.other.member.terraform\n#               ^ punctuation.accessor.dot.terraform\n#                ^^^ variable.other.member.terraform\n#                   ^ punctuation.section.brackets.begin.terraform\n#                    ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                     ^ punctuation.section.brackets.end.terraform\n\n/////\n// Handle nested arrays\n/////\n\n    counts = [\n#   ^^^^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#          ^ keyword.operator.assignment.terraform\n#            ^ punctuation.section.brackets.begin.terraform\n      [ 1, 2],\n#     ^ punctuation.section.brackets.begin.terraform\n#       ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#        ^ punctuation.separator.terraform\n#          ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#           ^ punctuation.section.brackets.end.terraform\n#            ^ punctuation.separator.terraform\n      [ 6, 7]\n#     ^ punctuation.section.brackets.begin.terraform\n#       ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#        ^ punctuation.separator.terraform\n#          ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#           ^ punctuation.section.brackets.end.terraform\n    ]\n#   ^ punctuation.section.brackets.end.terraform\n#    ^ - punctuation\n\n/////\n// Attribute-access inside arrays\n/////\n\n    [ aws_instance.ubuntu, aws_instance.freebsd ]\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.begin.terraform\n#                 ^ punctuation.accessor.dot.terraform\n#                  ^^^^^^ variable.other.member.terraform\n#                        ^ punctuation.separator.terraform\n#                                      ^ punctuation.accessor.dot.terraform\n#                                       ^^^^^^^ variable.other.member.terraform\n#                                               ^ punctuation.section.brackets.end.terraform\n\n/////\n// Includes functions.\n/////\n\n    [ upper(\"ggh\") ]\n#   ^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.begin.terraform\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#            ^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                  ^ punctuation.section.brackets.end.terraform\n\n/////\n// Include objects.\n/////\n\n    [{a = 1}, {g = 2}]\n#   ^ meta.brackets.terraform - meta.braces\n#    ^^^^^^^ meta.brackets.terraform meta.braces.terraform\n#           ^^ meta.brackets.terraform - meta.braces\n#             ^^^^^^^ meta.brackets.terraform meta.braces.terraform\n#                    ^ meta.brackets.terraform - meta.braces\n#   ^ punctuation.section.brackets.begin.terraform\n#    ^ meta.braces.terraform punctuation.section.braces.begin.terraform\n#     ^ meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#       ^ meta.braces.terraform keyword.operator.assignment.terraform\n#         ^ meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#          ^ meta.braces.terraform punctuation.section.braces.end.terraform\n#           ^ punctuation.separator.terraform\n#             ^ meta.braces.terraform punctuation.section.braces.begin.terraform\n#              ^ meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                ^ meta.braces.terraform keyword.operator.assignment.terraform\n#                  ^ meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                   ^ meta.braces.terraform punctuation.section.braces.end.terraform\n#                    ^ punctuation.section.brackets.end.terraform\n\n/////\n// Includes named values\n/////\n\n    [local.thing1, local.thing2]\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.begin.terraform\n#    ^^^^^ variable.language.terraform\n#         ^ punctuation.accessor.dot.terraform\n#          ^^^^^^ variable.other.member.terraform\n#                ^ punctuation.separator.terraform\n#                  ^^^^^ variable.language.terraform\n#                       ^ punctuation.accessor.dot.terraform\n#                        ^^^^^^ variable.other.member.terraform\n#                              ^ punctuation.section.brackets.end.terraform\n\n/////////////////////////////////////////////////////////////////////\n// Collections: Objects\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Key/value pairs separated by newlines.\n/////\n\n    {\n#   ^ meta.braces.terraform punctuation.section.braces.begin.terraform\n      name = \"John\"\n#     ^^^^ meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#          ^ meta.braces.terraform keyword.operator.assignment.terraform\n#            ^ meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#             ^^^^^ meta.braces.terraform string.quoted.double.terraform\n      age = 52\n#     ^^^ meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#         ^ meta.braces.terraform keyword.operator.assignment.terraform\n#           ^^ meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n    }\n#   ^ meta.braces.terraform punctuation.section.braces.end.terraform\n\n/////\n// Key/value pairs separated by commas.\n/////\n\n    {name = \"John\", age = 52}\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^ meta.braces.terraform\n#   ^ punctuation.section.braces.begin.terraform\n#    ^^^^ meta.mapping.key.terraform string.unquoted.terraform\n#         ^ keyword.operator.assignment.terraform\n#           ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#            ^^^^^ string.quoted.double.terraform\n#                 ^ punctuation.separator.terraform\n#                   ^^^ meta.mapping.key.terraform string.unquoted.terraform\n#                           ^ punctuation.section.braces.end.terraform\n\n/////\n// Allows operators in key values.\n/////\n\n    { name = 1 + 1 }\n#   ^^^^^^^^^^^^^^^^ meta.braces.terraform\n#   ^ punctuation.section.braces.begin.terraform\n#     ^^^^ meta.mapping.key.terraform string.unquoted.terraform\n#          ^ keyword.operator.assignment.terraform\n#            ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#              ^ keyword.operator.arithmetic.terraform\n#                ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                  ^ punctuation.section.braces.end.terraform\n#                   ^ - meta\n\n/////\n// Allows tuples as key values.\n/////\n\n    { list = [ 1, 2, 3 ]}\n#   ^^^^^^^^^ meta.braces.terraform - meta.brackets\n#            ^^^^^^^^^^^ meta.braces.terraform meta.brackets.terraform\n#                       ^ meta.braces.terraform - meta.brackets\n#   ^ punctuation.section.braces.begin.terraform\n#     ^^^^ meta.mapping.key.terraform string.unquoted.terraform\n#          ^ keyword.operator.assignment.terraform\n#            ^ punctuation.section.brackets.begin.terraform\n#              ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#               ^ punctuation.separator.terraform\n#                 ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                  ^ punctuation.separator.terraform\n#                    ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                      ^ punctuation.section.brackets.end.terraform\n#                       ^ punctuation.section.braces.end.terraform\n#                        ^ - meta\n\n/////\n// Allows function calls as values.\n/////\n\n    {\n#   ^ meta.braces.terraform punctuation.section.braces.begin.terraform\n      a = upper(\"l\"),\n#     ^ meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#       ^ meta.braces.terraform keyword.operator.assignment.terraform\n#         ^^^^^ meta.braces.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#              ^ meta.braces.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#               ^ meta.braces.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                ^^ meta.braces.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                  ^ meta.braces.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                   ^ meta.braces.terraform punctuation.separator.terraform\n    }\n#   ^ meta.braces.terraform punctuation.section.braces.end.terraform\n\n/////\n// Allows nested collection literals.\n/////\n\n    {\n#   ^ meta.braces.terraform punctuation.section.braces.begin.terraform\n      obj1 = {\n#     ^^^^ meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#          ^ meta.braces.terraform keyword.operator.assignment.terraform\n#            ^ meta.braces.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n        obj2 = {\n#       ^^^^ meta.braces.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#            ^ meta.braces.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#              ^ meta.braces.terraform meta.braces.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n          value = 5\n#         ^^^^^ meta.braces.terraform meta.braces.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#               ^ meta.braces.terraform meta.braces.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                 ^ meta.braces.terraform meta.braces.terraform meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n        }\n#       ^ meta.braces.terraform meta.braces.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n      }\n#     ^ meta.braces.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n    }\n#   ^ meta.braces.terraform punctuation.section.braces.end.terraform\n#    ^ - meta\n\n/////\n// Allows attribute-access as rvalue, including named values.\n/////\n\n    { lvalue = var.rvalue }\n#   ^^^^^^^^^^^^^^^^^^^^^^^ meta.braces.terraform\n#   ^ punctuation.section.braces.begin.terraform\n#     ^^^^^^ meta.mapping.key.terraform string.unquoted.terraform\n#            ^ keyword.operator.assignment.terraform\n#              ^^^ variable.language.terraform\n#                 ^ punctuation.accessor.dot.terraform\n#                  ^^^^^^ variable.other.member.terraform\n#                         ^ punctuation.section.braces.end.terraform\n#                          ^ - meta\n\n/////\n// Allows strings as keys.\n/////\n\n    {\"gggg\" = \"gggg\"}\n#   ^^^^^^^^^^^^^^^^^ meta.braces.terraform\n#   ^ punctuation.section.braces.begin.terraform\n#    ^ meta.mapping.key.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#     ^^^^ meta.mapping.key.terraform string.quoted.double.terraform\n#         ^ meta.mapping.key.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform\n#           ^ keyword.operator.assignment.terraform\n#             ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#              ^^^^ string.quoted.double.terraform\n#                  ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                   ^ punctuation.section.braces.end.terraform\n\n/////\n// Allows expressions + operators as keys.\n/////\n\n    {(1 + 2) = \"gggg\"}\n#   ^ meta.braces.terraform - meta.parens\n#    ^^^^^^^ meta.braces.terraform meta.mapping.key.terraform meta.parens.terraform\n#           ^^^^^^^^^^ meta.braces.terraform - meta.parens\n#   ^ punctuation.section.braces.begin.terraform\n#    ^ punctuation.section.parens.begin.terraform\n#     ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#       ^ keyword.operator.arithmetic.terraform\n#         ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#          ^ punctuation.section.parens.end.terraform\n#            ^ keyword.operator.assignment.terraform\n#              ^^^^^^ string.quoted.double.terraform\n#                    ^ punctuation.section.braces.end.terraform\n\n/////\n// Allows function calls as keys.\n/////\n\n    {(func()) = 1}\n#   ^ meta.braces.terraform - meta.parens\n#    ^^^^^^^^ meta.braces.terraform meta.mapping.key.terraform meta.parens.terraform\n#            ^^^^^ meta.braces.terraform - meta.parens\n#   ^ punctuation.section.braces.begin.terraform\n#    ^ punctuation.section.parens.begin.terraform\n#     ^^^^ meta.function-call.identifier.terraform variable.function.terraform\n#         ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#           ^ punctuation.section.parens.end.terraform\n#             ^ keyword.operator.assignment.terraform\n#               ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                ^ punctuation.section.braces.end.terraform\n\n/////\n// Allows attribute-access as keys.\n////\n\n    {(var.path) = 1}\n#   ^ meta.braces.terraform - meta.parens\n#    ^^^^^^^^^^ meta.braces.terraform meta.mapping.key.terraform meta.parens.terraform\n#              ^^^^^ meta.braces.terraform - meta.parens\n#   ^ punctuation.section.braces.begin.terraform\n#    ^ punctuation.section.parens.begin.terraform\n#     ^^^ variable.language.terraform\n#        ^ punctuation.accessor.dot.terraform\n#         ^^^^ variable.other.member.terraform\n#             ^ punctuation.section.parens.end.terraform\n#               ^ keyword.operator.assignment.terraform\n#                 ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                  ^ punctuation.section.braces.end.terraform\n\n/////////////////////////////////////////////////////////////////////\n// Attribute Access\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Matches dot-access\n/////\n\n    aws_instance.ubuntu[*].private_dns\n#               ^ punctuation.accessor.dot.terraform\n#                ^^^^^^ variable.other.member.terraform\n#                      ^ punctuation.section.brackets.begin.terraform\n#                       ^ punctuation.section.brackets.end.terraform keyword.operator.splat.terraform\n#                        ^ punctuation.section.brackets.end.terraform\n#                         ^ punctuation.accessor.dot.terraform\n#                          ^^^^^^^^^^^ variable.other.member.terraform\n#                                     ^ - variable - punctuation\n\n/////\n// Ignores dot-access in string literals\n/////\n\n    \"aws_instance.ubuntu\"\n#   ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                ^ - variable\n#   ^^^^^^^^^^^^^^^^^^^^^ string.quoted.double.terraform\n\n/////\n// Matches inside for-expressions\n/////\n\n   [for l in var.letters: upper(l)]\n#  ^ punctuation.section.brackets.begin.terraform\n#   ^^^ keyword.control.loop.for.terraform\n#       ^ variable.other.readwrite.terraform\n#         ^^ keyword.operator.iteration.in.terraform\n#            ^^^ variable.language.terraform\n#               ^ punctuation.accessor.dot.terraform\n#                ^^^^^^^ variable.other.member.terraform\n#                       ^ punctuation.section.block.loop.for.terraform\n#                         ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                              ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                               ^ meta.function-call.arguments.terraform\n#                                ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                 ^ punctuation.section.brackets.end.terraform\n\n/////\n// Attribute-only splat\n/////\n\n    tuple.*.foo.bar[0]\n#        ^ punctuation.accessor.dot.terraform\n#         ^ keyword.operator.splat.terraform\n#          ^ punctuation.accessor.dot.terraform\n#           ^^^ variable.other.member.terraform\n#              ^ punctuation.accessor.dot.terraform\n#               ^^^ variable.other.member.terraform\n#                  ^ punctuation.section.brackets.begin.terraform\n#                   ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                    ^ punctuation.section.brackets.end.terraform\n\n/////\n// Matches subscript indexes\n/////\n\n    aws_route53_zone.project.name_servers.1\n#                   ^ punctuation.accessor.dot.terraform\n#                    ^^^^^^^ variable.other.member.terraform\n#                           ^ punctuation.accessor.dot.terraform\n#                            ^^^^^^^^^^^^ variable.other.member.terraform\n#                                        ^ punctuation.accessor.dot.terraform\n#                                         ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                          ^ - constant - punctuation - variable\n\n/////////////////////////////////////////////////////////////////////\n// Attribute Definition\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Basic definition\n/////\n\n    attribute = \"string\"\n#   ^^^^^^^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#             ^ keyword.operator.assignment.terraform\n#               ^^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#               ^ punctuation.definition.string.begin.terraform\n#                      ^ punctuation.definition.string.end.terraform\n\n    provider = google-beta.impersonated\n#   ^^^^^^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#            ^ keyword.operator.assignment.terraform\n#              ^^^^^^^^^^^ variable.other.readwrite.terraform\n#                         ^ punctuation.accessor.dot.terraform\n#                          ^^^^^^^^^^^^ variable.other.member.terraform\n\n\n/////\n// Meta-arguments\n////\n\n    for_each = toset([])\n#   ^^^^^^^^ keyword.control.loop.for.terraform\n#            ^ keyword.operator.assignment.terraform\n#              ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                   ^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#                   ^ punctuation.section.parens.begin.terraform\n#                    ^ punctuation.section.brackets.begin.terraform\n#                     ^ punctuation.section.brackets.end.terraform\n#                      ^ punctuation.section.parens.end.terraform\n\n    count = length(var.availability_zones)\n#   ^^^^^ variable.declaration.terraform keyword.control.conditional.terraform\n#         ^ keyword.operator.assignment.terraform\n#           ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                 ^^^^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#                 ^ punctuation.section.parens.begin.terraform\n#                  ^^^ variable.language.terraform\n#                     ^ punctuation.accessor.dot.terraform\n#                      ^^^^^^^^^^^^^^^^^^ variable.other.member.terraform\n#                                        ^ punctuation.section.parens.end.terraform\n\n/////\n// Populate an attribute from a variable value\n/////\n\n    (foo) = \"baz\"\n#   ^ punctuation.section.parens.begin.terraform\n#    ^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#       ^ punctuation.section.parens.end.terraform\n#         ^ keyword.operator.assignment.terraform\n#           ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#           ^^^^^ string.quoted.double.terraform\n#               ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n\n/////////////////////////////////////////////////////////////////////\n// Function Calls\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Basic call.\n/////\n\n    thing(l)\n#   ^^^^^ meta.function-call.identifier.terraform variable.function.terraform\n#        ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#         ^ meta.function-call.arguments.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// Matches parameters, attribute-access, literals, operators, commas.\n/////\n\n    cidrthingy(aws_vpc.main.cidr_block, 4, count.index+1)\n#   ^^^^^^^^^^ meta.function-call.identifier.terraform variable.function.terraform\n#             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#             ^ punctuation.section.parens.begin.terraform\n#                     ^ punctuation.accessor.dot.terraform\n#                      ^^^^ variable.other.member.terraform\n#                          ^ punctuation.accessor.dot.terraform\n#                           ^^^^^^^^^^ variable.other.member.terraform\n#                                     ^ punctuation.separator.terraform\n#                                       ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                        ^ punctuation.separator.terraform\n#                                          ^^^^^ variable.language.terraform\n#                                               ^ punctuation.accessor.dot.terraform\n#                                                ^^^^^ variable.other.member.terraform\n#                                                     ^ keyword.operator.arithmetic.terraform\n#                                                      ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                                       ^ punctuation.section.parens.end.terraform\n#                                                        ^ - meta - function-call - variable\n\n/////\n// Matches arrays and splat as parameters.\n/////\n\n      y6y([55, 2453, 2]..., [55555555])\n#     ^^^ meta.function-call.identifier.terraform variable.function.terraform\n#        ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#         ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#          ^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#              ^^^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                    ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                      ^^^ meta.function-call.arguments.terraform keyword.operator.terraform\n#                         ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                           ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                            ^^^^^^^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                    ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                                     ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// Matches objects as parameters.\n/////\n\n    some({a = 1, b = \"2\"})\n#   ^^^^ meta.function-call.identifier.terraform variable.function.terraform\n#       ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#        ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n#         ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#           ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#             ^ meta.function-call.arguments.terraform meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#              ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.separator.terraform\n#                ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                  ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                    ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                     ^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                       ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n#                        ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// Nested function calls.\n/////\n\n    func(thing(yep(1)))\n#   ^^^^ meta.function-call.identifier.terraform variable.function.terraform\n#       ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#        ^^^^^ meta.function-call.arguments.terraform meta.function-call.identifier.terraform variable.function.terraform\n#             ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#              ^^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform meta.function-call.identifier.terraform variable.function.terraform\n#                 ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                  ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                   ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                    ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                      ^ - function\n\n/////\n// Parameters spanning multiple lines.\n/////\n\n    func(\n#   ^^^^ meta.function-call.identifier.terraform variable.function.terraform\n#       ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n      1,\n#     ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#      ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n      2\n#     ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n    )\n#   ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// Allow object for-expressions.\n////\n\n    thing({for i, v in [\"a\"]: v => i...})\n#   ^^^^^ meta.function-call.identifier.terraform variable.function.terraform\n#        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#        ^ punctuation.section.parens.begin.terraform\n#         ^ meta.braces.terraform punctuation.section.braces.begin.terraform\n#          ^^^ meta.braces.terraform keyword.control.loop.for.terraform\n#              ^ variable.other.readwrite.terraform\n#               ^ punctuation.separator.terraform\n#                 ^ variable.other.readwrite.terraform\n#                   ^^ keyword.operator.iteration.in.terraform\n#                      ^ punctuation.section.brackets.begin.terraform\n#                       ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                        ^^ string.quoted.double.terraform\n#                          ^ punctuation.section.brackets.end.terraform\n#                           ^ punctuation.section.block.loop.for.terraform\n#                             ^ variable.other.readwrite.terraform\n#                               ^^ punctuation.separator.key-value.terraform\n#                                  ^ variable.other.readwrite.terraform\n#                                   ^^^ keyword.operator.terraform\n#                                      ^ punctuation.section.braces.end.terraform\n#                                       ^ punctuation.section.parens.end.terraform\n\n/////\n// Allow tuple for-expressions.\n/////\n\n    func([for v in [\"a\", \"b\"]: v])\n#   ^^^^ meta.function-call.identifier.terraform variable.function.terraform\n#       ^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#       ^ punctuation.section.parens.begin.terraform\n#        ^ punctuation.section.brackets.begin.terraform\n#         ^^^ keyword.control.loop.for.terraform\n#             ^ variable.other.readwrite.terraform\n#               ^^ keyword.operator.iteration.in.terraform\n#                  ^ punctuation.section.brackets.begin.terraform\n#                   ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                    ^^ string.quoted.double.terraform\n#                      ^ punctuation.separator.terraform\n#                        ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                         ^^ string.quoted.double.terraform\n#                           ^ punctuation.section.brackets.end.terraform\n#                            ^ punctuation.section.block.loop.for.terraform\n#                              ^ variable.other.readwrite.terraform\n#                               ^ punctuation.section.brackets.end.terraform\n#                                ^ punctuation.section.parens.end.terraform\n\n/////////////////////////////////////////////////////////////////////\n// Built-in Terraform Functions\n// TODO: match % placeholders in format()-family first parameters\n// TODO: match regexs in regex()-family first parameters\n////////////////////////`/////////////////////////////////////////////\n\n/////\n// Numeric Functions\n/////\n\n      abs(23)\n#     ^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#        ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#         ^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      ceil(5.1)\n#     ^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#         ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#          ^^^ meta.function-call.arguments.terraform meta.number.float.decimal.terraform constant.numeric.value.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      floor(5)\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      log(50, 10)\n#     ^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#        ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#         ^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#             ^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      max(12, 54, 3)\n#     ^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#        ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#         ^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#             ^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                 ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      min(12, 54, 3)\n#     ^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#        ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#         ^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#             ^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                 ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      pow(3, 2)\n#     ^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#        ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#         ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#            ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      signum(-13)\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform keyword.operator.arithmetic.terraform\n#             ^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// String Functions\n/////\n\n      chomp(\"hello\\n\")\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#            ^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                 ^^ meta.function-call.arguments.terraform string.quoted.double.terraform constant.character.escape.terraform\n#                   ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                    ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      format(\"Hello, %s!\", \"Ander\")\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#             ^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                       ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                        ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                          ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                           ^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                                 ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      formatlist(\"Hello, %s!\", [\"Valentina\", \"Ander\"])\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                 ^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                            ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                              ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                ^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                          ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                             ^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                   ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                                                    ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      indent(2, \"[\\n  foo,\\n  bar,\\n]\\n\")\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                ^^^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                       ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      join(\", \", [\"foo\", \"bar\", \"baz\"])\n#     ^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#         ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#          ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#           ^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                 ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                  ^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                      ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                        ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                         ^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                             ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                ^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                    ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                                     ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      lower(\"HELLO\")\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#            ^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      regex(\"[a-z]+\", \"53453453.345345aaabbbccc23454\")\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#            ^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                   ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                     ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                    ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      regexall(\"[a-z]+\", \"1234abcd5678efgh9\")\n#     ^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#              ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#               ^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                      ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                        ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                         ^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                           ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      replace(\"1 + 2 + 3\", \"+\", \"-\")\n#     ^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#             ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#              ^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                        ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                          ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                           ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                             ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                  ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      split(\",\", \"foo\")\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#            ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                 ^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      strrev(\"hello\")\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#             ^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                   ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      substr(\"\", 0, 1)\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#             ^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                  ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                   ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                     ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                      ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      title(\"hello world\")\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#            ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                        ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      trimspace(\"  hello\\n\\n\")\n#     ^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                  ^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                            ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      upper(\"hello\")\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#            ^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// Collection Functions\n/////\n\n      chunklist([\"a\", \"b\"], 2)\n#     ^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                ^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                   ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                     ^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                        ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                         ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                           ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                            ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      coalesce(\"a\", \"b\")\n#     ^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#              ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#               ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                   ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                    ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                      ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      coalescelist([], [\"c\", \"d\"])\n#     ^^^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                   ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                    ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                      ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                       ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                        ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                          ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                             ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                               ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                                ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      compact([\"a\", \"\", \"b\"])\n#     ^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#              ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#               ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                   ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                    ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                       ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                        ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                          ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                           ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      concat([\"a\"], [\"c\"])\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#             ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#              ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                   ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                    ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                     ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                       ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                        ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      contains([\"a\"], \"a\")\n#     ^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                   ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                     ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                      ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                        ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      distinct([\"a\", \"b\", \"a\"])\n#     ^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                    ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                     ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                       ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                         ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                          ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                            ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                             ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      element([\"a\", \"b\"], 1)\n#     ^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#              ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#               ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                   ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                    ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                      ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                       ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                         ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                          ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      flatten([[[\"a\", \"b\"]], [\"c\"]])\n#     ^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#             ^^^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                 ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                   ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                     ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                      ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                        ^^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                          ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                            ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                             ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                              ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                ^^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                                  ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      index([\"a\"], \"b\")\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#             ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                  ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                   ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      keys({a=1, c=2})\n#     ^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#         ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#          ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n#           ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#            ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#             ^ meta.function-call.arguments.terraform meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#              ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.separator.terraform\n#                ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                 ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                  ^ meta.function-call.arguments.terraform meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                   ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n#                    ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      length([])\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      list(\"a\", \"b\", \"c\")\n#     ^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#         ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#          ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#           ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                    ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                     ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                       ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      lookup({a=\"ay\", b=\"bee\"}, \"a\", \"what?\")\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n#             ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#              ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#               ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                ^^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                   ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.separator.terraform\n#                     ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                      ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                       ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                        ^^^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                            ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n#                             ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                  ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                    ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                     ^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                           ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      map(\"a\", \"b\")\n#     ^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#        ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#         ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#          ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#              ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#               ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      matchkeys([\"i-123\", \"i-abc\"], [\"us-west\", \"us-east\"], [\"us-east\"])\n#     ^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                 ^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                       ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                         ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                          ^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                                 ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                   ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                                    ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                     ^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                             ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                                ^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                        ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                                                         ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                                           ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                                                            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                                             ^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                                     ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                                                                      ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      merge({a=\"b\"}, {e=\"f\"})\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n#            ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#             ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#              ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#               ^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                 ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                    ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n#                     ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                      ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                       ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                        ^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                          ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n#                           ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      range(1, 4)\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#              ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      reverse([1, 2, 3])\n#     ^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#              ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                 ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                    ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                      ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      setintersection([\"a\", \"b\"], [\"b\", \"c\"])\n#     ^^^^^^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                    ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                      ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                       ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                         ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                           ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                            ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                              ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                               ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                 ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                                  ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                   ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                     ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                       ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                        ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                          ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                                           ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      setproduct([\"development\"], [\"app1\", \"app2\"])\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                 ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                  ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                              ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                               ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                 ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                                  ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                   ^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                        ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                          ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                           ^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                                                 ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      setunion([\"a\"], [\"b\"], [\"d\"])\n#     ^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                  ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                   ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                      ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                       ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                         ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                          ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                            ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                             ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                              ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                                 ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      slice([\"a\", \"b\"], 1, 1)\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#             ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                 ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                  ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                    ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                       ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                        ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                          ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                           ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n      sort([\"e\", \"d\"])\n#     ^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#         ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#           ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#            ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                 ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                   ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                    ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      transpose({a = [\"1\", \"2\"], b = [\"2\", \"3\"]})\n#     ^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#               ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n#                ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                  ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                    ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.brackets.begin.terraform\n#                     ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                      ^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                        ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.separator.terraform\n#                          ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                           ^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                             ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.brackets.end.terraform\n#                              ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.separator.terraform\n#                                ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                                  ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                                    ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.brackets.begin.terraform\n#                                     ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                      ^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                                        ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.separator.terraform\n#                                          ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                           ^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                                             ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.brackets.end.terraform\n#                                              ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n#                                               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      values({a=3, c=2, d=1})\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n#             ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#              ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#               ^ meta.function-call.arguments.terraform meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.separator.terraform\n#                  ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                   ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                    ^ meta.function-call.arguments.terraform meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                     ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.separator.terraform\n#                       ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                        ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                         ^ meta.function-call.arguments.terraform meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                          ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n#                           ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      zipmap([\"a\", \"b\"], [1, 2])\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#             ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#              ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                  ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                   ^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                      ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                        ^ meta.function-call.arguments.terraform punctuation.section.brackets.begin.terraform\n#                         ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                          ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                            ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                             ^ meta.function-call.arguments.terraform punctuation.section.brackets.end.terraform\n#                              ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// Encoding Functions\n/////\n\n      base64decode(\"SGVsbG8gV29ybGQ=\")\n#     ^^^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                  ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                   ^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                    ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      base64encode(\"Hello World\")\n#     ^^^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                  ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                   ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      base64gzip(\"Hello World\")\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                 ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                             ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      csvdecode(\"a,b,c\\n1,2,3\\n4,5,6\")\n#     ^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                ^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                    ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      jsondecode(\"{\\\"hello\\\": \\\"world\\\"}\")\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                 ^^^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                        ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      jsonencode({hello=\"world\"})\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n#                 ^^^^^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                      ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                       ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                        ^^^^^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                              ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n#                               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      urlencode(\"Hello World\")\n#     ^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#               ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                            ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      yamldecode(\"true\")\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform - constant\n#                 ^^^^ meta.function-call.arguments.terraform meta.string.terraform string.quoted.double.terraform\n#                     ^ meta.function-call.arguments.terraform meta.string.terraform string.quoted.double.terraform punctuation.definition.string.end.terraform - constant\n#                      ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      yamlencode({a = \"b\", c = \"d\"})\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n#                 ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                   ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                     ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                      ^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                        ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.separator.terraform\n#                          ^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                            ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                              ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                               ^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                                  ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// Filesystem Functions\n/////\n\n      abspath(path.root)\n#     ^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#            ^ punctuation.section.parens.begin.terraform\n#             ^^^^ variable.language.terraform\n#                 ^ punctuation.accessor.dot.terraform\n#                  ^^^^ variable.other.member.terraform\n#                      ^ punctuation.section.parens.end.terraform\n\n      dirname(\"foo/bar/baz.txt\")\n#     ^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#            ^ punctuation.section.parens.begin.terraform\n#             ^^^^^^^^^^^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#             ^ punctuation.definition.string.begin.terraform\n#                             ^ punctuation.definition.string.end.terraform\n#                              ^ punctuation.section.parens.end.terraform\n\n      pathexpand(\"~/.ssh/id_rsa\")\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#               ^ punctuation.section.parens.begin.terraform\n#                ^^^^^^^^^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#                ^ punctuation.definition.string.begin.terraform\n#                              ^ punctuation.definition.string.end.terraform\n#                               ^ punctuation.section.parens.end.terraform\n\n      basename(\"foo/bar/baz.txt\")\n#     ^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#             ^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#             ^ punctuation.section.parens.begin.terraform\n#              ^^^^^^^^^^^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#              ^ punctuation.definition.string.begin.terraform\n#                              ^ punctuation.definition.string.end.terraform\n#                               ^ punctuation.section.parens.end.terraform\n\n      file(\"${path.module}/hello.txt\")\n#     ^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#         ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#          ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#           ^^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#             ^^^^ meta.function-call.arguments.terraform meta.interpolation.terraform variable.language.terraform\n#                 ^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.accessor.dot.terraform\n#                  ^^^^^^ meta.function-call.arguments.terraform meta.interpolation.terraform variable.other.member.terraform\n#                        ^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                         ^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                    ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      fileexists(\"${path.module}/hello.txt\")\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                 ^^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                   ^^^^ meta.function-call.arguments.terraform meta.interpolation.terraform variable.language.terraform\n#                       ^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.accessor.dot.terraform\n#                        ^^^^^^ meta.function-call.arguments.terraform meta.interpolation.terraform variable.other.member.terraform\n#                              ^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                               ^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                          ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      fileset(path.module, \"files/*.txt\")\n#     ^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#            ^ punctuation.section.parens.begin.terraform\n#             ^^^^ variable.language.terraform\n#                 ^ punctuation.accessor.dot.terraform\n#                  ^^^^^^ variable.other.member.terraform\n#                        ^ punctuation.separator.terraform\n#                          ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                           ^^^^^^^^^^^^ string.quoted.double.terraform\n#                                       ^ punctuation.section.parens.end.terraform\n\n      filebase64(\"${path.module}/hello.txt\")\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                 ^^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                   ^^^^ meta.function-call.arguments.terraform meta.interpolation.terraform variable.language.terraform\n#                       ^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.accessor.dot.terraform\n#                        ^^^^^^ meta.function-call.arguments.terraform meta.interpolation.terraform variable.other.member.terraform\n#                              ^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                               ^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                          ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      templatefile(\"${path.module}/backends.tmpl\", {\n#     ^^^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                  ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                   ^^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                     ^^^^ meta.function-call.arguments.terraform meta.interpolation.terraform variable.language.terraform\n#                         ^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.accessor.dot.terraform\n#                          ^^^^^^ meta.function-call.arguments.terraform meta.interpolation.terraform variable.other.member.terraform\n#                                ^ meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                 ^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                                  ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.begin.terraform\n        port = 8080,\n#       ^^^^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#            ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#              ^^^^ meta.function-call.arguments.terraform meta.braces.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                  ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.separator.terraform\n#                   ^ meta.function-call.arguments.terraform meta.braces.terraform\n        ip_addrs = [\"10.0.0.1\", \"10.0.0.2\"]\n#       ^^^^^^^^ meta.function-call.arguments.terraform meta.braces.terraform meta.mapping.key.terraform string.unquoted.terraform\n#                ^ meta.function-call.arguments.terraform meta.braces.terraform keyword.operator.assignment.terraform\n#                  ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.brackets.begin.terraform\n#                   ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                    ^^^^^^^^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                             ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.separator.terraform\n#                               ^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                ^^^^^^^^^ meta.function-call.arguments.terraform meta.braces.terraform string.quoted.double.terraform\n#                                         ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.brackets.end.terraform\n      })\n#     ^ meta.function-call.arguments.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n#      ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// Date & Time Functions\n/////\n\n      formatdate(\"DD MMM YYYY hh:mm ZZZ\", \"2018-01-02T23:12:01Z\")\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                 ^^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                       ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                         ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                          ^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      timeadd(\"2017-11-22T00:00:00Z\", \"10m\")\n#     ^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#             ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#              ^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                   ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                     ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                      ^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                          ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      timestamp()\n#     ^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// Hash & Crypto Functions\n/////\n\n      base64sha256(\"hello world\")\n#     ^^^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                  ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                   ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      base64sha512(\"hello world\")\n#     ^^^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                  ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                   ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      bcrypt(\"hello world\")\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#             ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                         ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      filebase64sha256(file(\"filename\"))\n#     ^^^^^^^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                      ^^^^ meta.function-call.arguments.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                          ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                           ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                            ^^^^^^^^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                     ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                      ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                       ^ - function\n\n      filebase64sha512(file(\"filename\"))\n#     ^^^^^^^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                     ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                      ^^^^ meta.function-call.arguments.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                          ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                           ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                            ^^^^^^^^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                     ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                      ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                       ^ - function\n\n      filemd5(file(\"filename\"))\n#     ^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#             ^^^^ meta.function-call.arguments.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                 ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                  ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                   ^^^^^^^^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                            ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                             ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      filemd1(file(\"filename\"))\n#     ^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#             ^^^^ meta.function-call.arguments.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                 ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                  ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                   ^^^^^^^^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                            ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                             ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                              ^ - function\n\n      filesha256(file(\"filename\"))\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^^^^ meta.function-call.arguments.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                    ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                     ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                      ^^^^^^^^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                               ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                 ^ - function\n\n      filesha512(file(\"filename\"))\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^^^^ meta.function-call.arguments.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                    ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                     ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                      ^^^^^^^^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                               ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                 ^ - function\n\n      md5(\"hello world\")\n#     ^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#        ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#         ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#          ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                      ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      rsadecrypt(filebase64(\"${path.module}/ciphertext\"), file(\"privatekey.pem\"))\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^^^^^^^^^^ meta.function-call.arguments.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                          ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                           ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                            ^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.begin.terraform\n#                              ^^^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform meta.interpolation.terraform variable.language.terraform\n#                                  ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.accessor.dot.terraform\n#                                   ^^^^^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform meta.interpolation.terraform variable.other.member.terraform\n#                                         ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform meta.interpolation.terraform punctuation.section.interpolation.end.terraform\n#                                          ^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                      ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                                       ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                                         ^^^^ meta.function-call.arguments.terraform meta.function-call.identifier.terraform support.function.builtin.terraform\n#                                                             ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                                                              ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                                               ^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                                                              ^ meta.function-call.arguments.terraform meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                                                               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                                                                ^ - function\n\n      sha1(\"hello world\")\n#     ^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#         ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#          ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#           ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                       ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      sha256(\"hello world\")\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#             ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                         ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      sha512(\"hello world\")\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#             ^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                         ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      uuid()\n#     ^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#         ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#          ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      uuidv5(\"dns\", \"www.terraform.io\")\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#            ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#             ^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                 ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                   ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                    ^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                     ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// IP Network Functions\n/////\n\n      cidrhost(\"10.12.127.0/20\", 16)\n#     ^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#             ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#              ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#               ^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                              ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                ^^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                  ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      cidrnetmask(\"172.16.0.0/12\")\n#     ^^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                 ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                  ^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                                ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n      cidrsubnet(\"172.16.0.0/12\", 4, 2)\n#     ^^^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#               ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                ^ meta.function-call.arguments.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                 ^^^^^^^^^^^^^^ meta.function-call.arguments.terraform string.quoted.double.terraform\n#                               ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                 ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                  ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                    ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                     ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n\n/////\n// Type Conversions Functions\n/////\n\n      tobool(true)\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#           ^ punctuation.section.parens.begin.terraform\n#            ^^^^ constant.language.boolean.true.terraform\n#                ^ punctuation.section.parens.end.terraform\n\n      tobool(\"true\")\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#           ^ punctuation.section.parens.begin.terraform\n#            ^^^^^^ meta.string.terraform string.quoted.double.terraform\n#            ^ punctuation.definition.string.begin.terraform\n#                 ^ punctuation.definition.string.end.terraform\n#                  ^ punctuation.section.parens.end.terraform\n\n      tolist([\"a\", \"b\", \"c\"])\n#     ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#           ^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#           ^ punctuation.section.parens.begin.terraform\n#            ^ punctuation.section.brackets.begin.terraform\n#             ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#              ^^ string.quoted.double.terraform\n#                ^ punctuation.separator.terraform\n#                  ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                   ^^ string.quoted.double.terraform\n#                     ^ punctuation.separator.terraform\n#                       ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                        ^^ string.quoted.double.terraform\n#                          ^ punctuation.section.brackets.end.terraform\n#                           ^ punctuation.section.parens.end.terraform\n\n      tomap({a = 1, b = 2})\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform meta.parens.terraform - meta.brackets\n#           ^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform meta.braces.terraform\n#                         ^ meta.function-call.arguments.terraform meta.parens.terraform - meta.brackets\n#          ^ punctuation.section.parens.begin.terraform\n#           ^ punctuation.section.braces.begin.terraform\n#            ^ meta.mapping.key.terraform string.unquoted.terraform\n#              ^ keyword.operator.assignment.terraform\n#                ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                 ^ punctuation.separator.terraform\n#                   ^ meta.mapping.key.terraform string.unquoted.terraform\n#                     ^ keyword.operator.assignment.terraform\n#                       ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                        ^ punctuation.section.braces.end.terraform\n#                         ^ punctuation.section.parens.end.terraform\n\n      tonumber(1)\n#     ^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#             ^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#             ^ punctuation.section.parens.begin.terraform\n#              ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#               ^ punctuation.section.parens.end.terraform\n\n      toset([\"a\", \"b\", \"c\"])\n#     ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#          ^ meta.function-call.arguments.terraform meta.parens.terraform - meta.brackets\n#           ^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform meta.brackets.terraform\n#                          ^ meta.function-call.arguments.terraform meta.parens.terraform - meta.brackets\n#          ^ punctuation.section.parens.begin.terraform\n#           ^ punctuation.section.brackets.begin.terraform\n#            ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#             ^^ string.quoted.double.terraform\n#               ^ punctuation.separator.terraform\n#                 ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                  ^^ string.quoted.double.terraform\n#                    ^ punctuation.separator.terraform\n#                      ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                       ^^ string.quoted.double.terraform\n#                         ^ punctuation.section.brackets.end.terraform\n#                          ^ punctuation.section.parens.end.terraform\n\n      tostring(\"hello\")\n#     ^^^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#             ^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#             ^ punctuation.section.parens.begin.terraform\n#              ^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#                     ^ punctuation.section.parens.end.terraform\n\n    provider::terraform::encode_tfvars({\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.function-call.identifier.terraform\n#                                     ^ meta.function-call.arguments.terraform meta.parens.terraform - meta.braces\n#                                      ^ meta.function-call.arguments.terraform meta.parens.terraform meta.braces.terraform\n#   ^^^^^^^^ variable.namespace.terraform\n#           ^^ punctuation.accessor.double-colon.terraform\n#             ^^^^^^^^^ variable.namespace.terraform\n#                      ^^ punctuation.accessor.double-colon.terraform\n#                        ^^^^^^^^^^^^^ support.function.builtin.terraform\n#                                     ^ punctuation.section.parens.begin.terraform\n#                                      ^ punctuation.section.braces.begin.terraform\n      example = \"Hello!\"\n    })\n#^^^^ meta.function-call.arguments.terraform meta.parens.terraform meta.braces.terraform\n#    ^ meta.function-call.arguments.terraform meta.parens.terraform - meta.braces\n#   ^ punctuation.section.braces.end.terraform\n#    ^ punctuation.section.parens.end.terraform\n\n    my::namespace::func(\"args\")\n#   ^^^^^^^^^^^^^^^^^^^ meta.function-call.identifier.terraform\n#   ^^ variable.namespace.terraform\n#     ^^ punctuation.accessor.double-colon.terraform\n#       ^^^^^^^^^ variable.namespace.terraform\n#                ^^ punctuation.accessor.double-colon.terraform\n#                  ^^^^ variable.function.terraform\n#                      ^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#                      ^ punctuation.section.parens.begin.terraform\n#                       ^^^^^^ meta.string.terraform string.quoted.double.terraform\n#                             ^ punctuation.section.parens.end.terraform\n\n/////////////////////////////////////////////////////////////////////\n// TUPLE FOR-EXPRESSIONS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Basic expression.\n/////\n\n    [for s in var.list : upper(s)]\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.begin.terraform\n#    ^^^ keyword.control.loop.for.terraform\n#        ^ variable.other.readwrite.terraform\n#          ^^ keyword.operator.iteration.in.terraform\n#             ^^^ variable.language.terraform\n#                ^ punctuation.accessor.dot.terraform\n#                 ^^^^ variable.other.member.terraform\n#                      ^ punctuation.section.block.loop.for.terraform\n#                        ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                             ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                              ^ meta.function-call.arguments.terraform\n#                               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                ^ punctuation.section.brackets.end.terraform\n\n/////\n// Object or map source value.\n////\n\n    [for k, v in var.map : length(k) + length(v)]\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.begin.terraform\n#    ^^^ keyword.control.loop.for.terraform\n#        ^ variable.other.readwrite.terraform\n#         ^ punctuation.separator.terraform\n#           ^ variable.other.readwrite.terraform\n#             ^^ keyword.operator.iteration.in.terraform\n#                ^^^ variable.language.terraform\n#                   ^ punctuation.accessor.dot.terraform\n#                    ^^^ variable.other.member.terraform\n#                        ^ punctuation.section.block.loop.for.terraform\n#                          ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                                ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                                 ^ meta.function-call.arguments.terraform\n#                                  ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                    ^ keyword.operator.arithmetic.terraform\n#                                      ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                                            ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                                             ^ meta.function-call.arguments.terraform\n#                                              ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                               ^ punctuation.section.brackets.end.terraform\n\n/////\n// Complex right-side expressions.\n////\n\n    [for o in var.list : o.interfaces[0].name]\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.begin.terraform\n#    ^^^ keyword.control.loop.for.terraform\n#        ^ variable.other.readwrite.terraform\n#          ^^ keyword.operator.iteration.in.terraform\n#             ^^^ variable.language.terraform\n#                ^ punctuation.accessor.dot.terraform\n#                 ^^^^ variable.other.member.terraform\n#                      ^ punctuation.section.block.loop.for.terraform\n#                        ^ variable.other.readwrite.terraform\n#                         ^ punctuation.accessor.dot.terraform\n#                          ^^^^^^^^^^ variable.other.member.terraform\n#                                    ^ punctuation.section.brackets.begin.terraform\n#                                     ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                      ^ punctuation.section.brackets.end.terraform\n#                                       ^ punctuation.accessor.dot.terraform\n#                                        ^^^^ variable.other.member.terraform\n#                                            ^ punctuation.section.brackets.end.terraform\n\n/////\n// Legacy splat expression attribute access.\n/////\n\n    [for o in var.list : o.interfaces][0].name\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.begin.terraform\n#    ^^^ keyword.control.loop.for.terraform\n#        ^ variable.other.readwrite.terraform\n#          ^^ keyword.operator.iteration.in.terraform\n#             ^^^ variable.language.terraform\n#                ^ punctuation.accessor.dot.terraform\n#                 ^^^^ variable.other.member.terraform\n#                      ^ punctuation.section.block.loop.for.terraform\n#                        ^ variable.other.readwrite.terraform\n#                         ^ punctuation.accessor.dot.terraform\n#                          ^^^^^^^^^^ variable.other.member.terraform\n#                                    ^ punctuation.section.brackets.end.terraform\n#                                     ^ punctuation.section.brackets.begin.terraform\n#                                      ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                       ^ punctuation.section.brackets.end.terraform\n#                                        ^ punctuation.accessor.dot.terraform\n#                                         ^^^^ variable.other.member.terraform\n\n/////\n// Multi-line for-expressions.\n/////\n\n    value = [\n#          ^ - meta.brackets\n#           ^^ meta.brackets.terraform\n#   ^^^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#         ^ keyword.operator.assignment.terraform\n#           ^ punctuation.section.brackets.begin.terraform\n      for instance in aws_instance.ubuntu:\n#    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#     ^^^ keyword.control.loop.for.terraform\n#         ^^^^^^^^ variable.other.readwrite.terraform\n#                  ^^ keyword.operator.iteration.in.terraform\n#                     ^^^^^^^^^^^^ variable.other.readwrite.terraform\n#                                 ^ punctuation.accessor.dot.terraform\n#                                  ^^^^^^ variable.other.member.terraform\n#                                        ^ punctuation.section.block.loop.for.terraform\n      instance.private_dns\n#    ^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#     ^^^^^^^^ variable.other.readwrite.terraform\n#             ^ punctuation.accessor.dot.terraform\n#              ^^^^^^^^^^^ variable.other.member.terraform\n    ]\n#^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.end.terraform\n#    ^ - meta.brackets\n\n/////\n// Match conditional on right-side expression.\n/////\n\n    value = [\n#          ^ - meta.brackets\n#           ^^ meta.brackets.terraform\n#   ^^^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#         ^ keyword.operator.assignment.terraform\n#           ^ punctuation.section.brackets.begin.terraform\n      for instance in aws_instance.ubuntu:\n#    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#     ^^^ keyword.control.loop.for.terraform\n#         ^^^^^^^^ variable.other.readwrite.terraform\n#                  ^^ keyword.operator.iteration.in.terraform\n#                     ^^^^^^^^^^^^ variable.other.readwrite.terraform\n#                                 ^ punctuation.accessor.dot.terraform\n#                                  ^^^^^^ variable.other.member.terraform\n#                                        ^ punctuation.section.block.loop.for.terraform\n      (instance.public_ip != \"\" ? list(instance.private_ip, instance.public_ip) : list(instance.private_ip))\n#    ^ meta.brackets.terraform - meta.parens\n#     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform meta.parens.terraform\n#                                                                                                           ^ meta.brackets.terraform - meta.parens\n#     ^ punctuation.section.parens.begin.terraform\n#      ^^^^^^^^ variable.other.readwrite.terraform\n#              ^ punctuation.accessor.dot.terraform\n#               ^^^^^^^^^ variable.other.member.terraform\n#                         ^^ keyword.operator.comparison.terraform\n#                            ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                             ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                               ^ keyword.operator.ternary.terraform\n#                                 ^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#                                     ^ punctuation.section.parens.begin.terraform\n#                                      ^^^^^^^^ variable.other.readwrite.terraform\n#                                              ^ punctuation.accessor.dot.terraform\n#                                               ^^^^^^^^^^ variable.other.member.terraform\n#                                                         ^ punctuation.separator.terraform\n#                                                           ^^^^^^^^ variable.other.readwrite.terraform\n#                                                                   ^ punctuation.accessor.dot.terraform\n#                                                                    ^^^^^^^^^ variable.other.member.terraform\n#                                                                             ^ punctuation.section.parens.end.terraform\n#                                                                               ^ keyword.operator.ternary.terraform\n#                                                                                 ^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                                                                                     ^^^^^^^^^^^^^^^^^^^^^ meta.function-call.arguments.terraform meta.parens.terraform\n#                                                                                     ^ punctuation.section.parens.begin.terraform\n#                                                                                      ^^^^^^^^ variable.other.readwrite.terraform\n#                                                                                              ^ punctuation.accessor.dot.terraform\n#                                                                                               ^^^^^^^^^^ variable.other.member.terraform\n#                                                                                                         ^ punctuation.section.parens.end.terraform\n#                                                                                                          ^ punctuation.section.parens.end.terraform\n    ]\n#^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.end.terraform\n#    ^ - meta.brackets\n\n/////\n// Match brackets on right-side expression.\n/////\n\n    value = [\n#   ^^^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#         ^ keyword.operator.assignment.terraform\n#           ^ punctuation.section.brackets.begin.terraform\n      for instance in aws_instance.ubuntu:\n#    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform\n#     ^^^ keyword.control.loop.for.terraform\n#         ^^^^^^^^ variable.other.readwrite.terraform\n#                  ^^ keyword.operator.iteration.in.terraform\n#                     ^^^^^^^^^^^^ variable.other.readwrite.terraform\n#                                 ^ punctuation.accessor.dot.terraform\n#                                  ^^^^^^ variable.other.member.terraform\n#                                        ^ punctuation.section.block.loop.for.terraform\n      (instance.public_ip != \"\" ? [instance.private_ip, instance.public_ip] : [instance.private_ip])\n#     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform meta.parens.terraform - meta.parens meta.brackets\n#                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform meta.parens.terraform meta.brackets.terraform\n#                                                                          ^^^ meta.brackets.terraform meta.parens.terraform - meta.parens meta.brackets\n#                                                                             ^^^^^^^^^^^^^^^^^^^^^ meta.brackets.terraform meta.parens.terraform meta.brackets.terraform\n#                                                                                                  ^ meta.brackets.terraform meta.parens.terraform - meta.parens meta.brackets\n#                                                                                                   ^ meta.brackets.terraform - meta.parens\n#     ^ punctuation.section.parens.begin.terraform\n#      ^^^^^^^^ variable.other.readwrite.terraform\n#              ^ punctuation.accessor.dot.terraform\n#               ^^^^^^^^^ variable.other.member.terraform\n#                         ^^ keyword.operator.comparison.terraform\n#                            ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                             ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                               ^ keyword.operator.ternary.terraform\n#                                 ^ punctuation.section.brackets.begin.terraform\n#                                          ^ punctuation.accessor.dot.terraform\n#                                           ^^^^^^^^^^ variable.other.member.terraform\n#                                                     ^ punctuation.separator.terraform\n#                                                               ^ punctuation.accessor.dot.terraform\n#                                                                ^^^^^^^^^ variable.other.member.terraform\n#                                                                         ^ punctuation.section.brackets.end.terraform\n#                                                                           ^ keyword.operator.ternary.terraform\n#                                                                             ^ punctuation.section.brackets.begin.terraform\n#                                                                                      ^ punctuation.accessor.dot.terraform\n#                                                                                       ^^^^^^^^^^ variable.other.member.terraform\n#                                                                                                 ^ punctuation.section.brackets.end.terraform\n#                                                                                                  ^ punctuation.section.parens.end.terraform\n    ]\n# <- meta.brackets.terraform\n#^^^^ meta.brackets.terraform\n#   ^ punctuation.section.brackets.end.terraform\n#    ^ - meta.brackets\n\n/////\n// Match if-conditionals on right-side.\n/////\n\n    [for s in var.list : upper(s) if s != \"\"]\n#   ^ punctuation.section.brackets.begin.terraform\n#    ^^^ keyword.control.loop.for.terraform\n#        ^ variable.other.readwrite.terraform\n#          ^^ keyword.operator.iteration.in.terraform\n#             ^^^ variable.language.terraform\n#                ^ punctuation.accessor.dot.terraform\n#                 ^^^^ variable.other.member.terraform\n#                      ^ punctuation.section.block.loop.for.terraform\n#                        ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                             ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                              ^ meta.function-call.arguments.terraform\n#                               ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                 ^^ keyword.control.conditional.terraform\n#                                    ^ variable.other.readwrite.terraform\n#                                      ^^ keyword.operator.comparison.terraform\n#                                         ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                          ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                                           ^ punctuation.section.brackets.end.terraform\n\n/////\n// Matches bracket-literals as range expression.\n/////\n\n    [for i, v in [\"a\", \"b\", \"c\"]: v if i < 2]\n#   ^^^^^^^^^^^^^ meta.brackets.terraform - meta.brackets meta.brackets\n#                ^^^^^^^^^^^^^^^ meta.brackets.terraform meta.brackets.terraform\n#                               ^^^^^^^^^^^^^ meta.brackets.terraform - meta.brackets meta.brackets\n#   ^ punctuation.section.brackets.begin.terraform\n#    ^^^ keyword.control.loop.for.terraform\n#        ^ variable.other.readwrite.terraform\n#         ^ punctuation.separator.terraform\n#           ^ variable.other.readwrite.terraform\n#             ^^ keyword.operator.iteration.in.terraform\n#                ^ punctuation.section.brackets.begin.terraform\n#                 ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                  ^^ string.quoted.double.terraform\n#                    ^ punctuation.separator.terraform\n#                      ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                       ^^ string.quoted.double.terraform\n#                         ^ punctuation.separator.terraform\n#                           ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                            ^^ string.quoted.double.terraform\n#                              ^ punctuation.section.brackets.end.terraform\n#                               ^ punctuation.section.block.loop.for.terraform\n#                                 ^ variable.other.readwrite.terraform\n#                                   ^^ keyword.control.conditional.terraform\n#                                      ^ variable.other.readwrite.terraform\n#                                        ^ keyword.operator.comparison.terraform\n#                                          ^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                           ^ punctuation.section.brackets.end.terraform\n\n/////////////////////////////////////////////////////////////////////\n// OBJECT FOR-EXPRESSIONS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Matches basic syntax.\n/////\n\n    {for i, v in [\"a\", \"b\"]: v => i}\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.braces.terraform\n#   ^ punctuation.section.braces.begin.terraform\n#    ^^^ keyword.control.loop.for.terraform\n#        ^ variable.other.readwrite.terraform\n#         ^ punctuation.separator.terraform\n#           ^ variable.other.readwrite.terraform\n#             ^^ keyword.operator.iteration.in.terraform\n#                ^ punctuation.section.brackets.begin.terraform\n#                 ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                  ^^ string.quoted.double.terraform\n#                    ^ punctuation.separator.terraform\n#                      ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                       ^^ string.quoted.double.terraform\n#                         ^ punctuation.section.brackets.end.terraform\n#                          ^ punctuation.section.block.loop.for.terraform\n#                            ^ variable.other.readwrite.terraform\n#                              ^^ punctuation.separator.key-value.terraform\n#                                 ^ variable.other.readwrite.terraform\n#                                  ^ punctuation.section.braces.end.terraform\n#                                   ^ - meta\n\n/////\n// Matches ellipsis.\n/////\n\n    {for i, v in [\"a\"]: v => i...}\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.braces.terraform\n#   ^ punctuation.section.braces.begin.terraform\n#    ^^^ keyword.control.loop.for.terraform\n#        ^ variable.other.readwrite.terraform\n#         ^ punctuation.separator.terraform\n#           ^ variable.other.readwrite.terraform\n#             ^^ keyword.operator.iteration.in.terraform\n#                ^ punctuation.section.brackets.begin.terraform\n#                 ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                  ^^ string.quoted.double.terraform\n#                    ^ punctuation.section.brackets.end.terraform\n#                     ^ punctuation.section.block.loop.for.terraform\n#                       ^ variable.other.readwrite.terraform\n#                         ^^ punctuation.separator.key-value.terraform\n#                            ^ variable.other.readwrite.terraform\n#                             ^^^ keyword.operator.terraform\n#                                ^ punctuation.section.braces.end.terraform\n\n/////\n// Matches if-conditional.\n/////\n\n    {for s in var.list : substr(s, 0, 1) => s... if s != \"\"}\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.braces.terraform\n#   ^ punctuation.section.braces.begin.terraform\n#    ^^^ keyword.control.loop.for.terraform\n#        ^ variable.other.readwrite.terraform\n#          ^^ keyword.operator.iteration.in.terraform\n#             ^^^ variable.language.terraform\n#                ^ punctuation.accessor.dot.terraform\n#                 ^^^^ variable.other.member.terraform\n#                      ^ punctuation.section.block.loop.for.terraform\n#                        ^^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#                              ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                               ^ meta.function-call.arguments.terraform\n#                                ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                  ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                   ^ meta.function-call.arguments.terraform punctuation.separator.terraform\n#                                     ^ meta.function-call.arguments.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                                      ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n#                                        ^^ punctuation.separator.key-value.terraform\n#                                           ^ variable.other.readwrite.terraform\n#                                            ^^^ keyword.operator.terraform\n#                                                ^^ keyword.control.conditional.terraform\n#                                                   ^ variable.other.readwrite.terraform\n#                                                     ^^ keyword.operator.comparison.terraform\n#                                                        ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                                                         ^ string.quoted.double.terraform punctuation.definition.string.end.terraform\n#                                                          ^ punctuation.section.braces.end.terraform\n\n/////\n// Matches over multiple-lines.\n/////\n\n    value = {\n#   ^^^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#         ^ keyword.operator.assignment.terraform\n#          ^ - meta.braces\n#           ^ meta.braces.terraform punctuation.section.braces.begin.terraform\n      for l in var.letters: l =>\n#    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.braces.terraform\n#     ^^^ meta.braces.terraform keyword.control.loop.for.terraform\n#         ^ variable.other.readwrite.terraform\n#           ^^ keyword.operator.iteration.in.terraform\n#              ^^^ variable.language.terraform\n#                 ^ punctuation.accessor.dot.terraform\n#                  ^^^^^^^ variable.other.member.terraform\n#                         ^ punctuation.section.block.loop.for.terraform\n#                           ^ variable.other.readwrite.terraform\n#                             ^^ punctuation.separator.key-value.terraform\n        upper(l)\n#      ^^^^^^^^^^ meta.braces.terraform\n#       ^^^^^ meta.function-call.identifier.terraform support.function.builtin.terraform\n#            ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#             ^ meta.function-call.arguments.terraform\n#              ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n    }\n# <- meta.braces.terraform\n#^^^^ meta.braces.terraform\n#   ^ punctuation.section.braces.end.terraform\n#    ^ - meta.braces\n\n/////////////////////////////////////////////////////////////////////\n// BLOCKS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Inline block with no labels.\n////\n\n    thing  {}\n#   ^^^^^^^ meta.block.head.terraform\n#   ^^^^^ keyword.declaration.terraform\n#          ^^ meta.block.body.terraform\n#          ^ punctuation.section.block.begin.terraform\n#           ^ punctuation.section.block.end.terraform\n\n/////\n// Inline block with string labels.\n/////\n\n    thing \"label1\"   \"label2\\\"\" {}\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^^ keyword.declaration.terraform\n#         ^^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#         ^ punctuation.definition.string.begin.terraform\n#                ^ punctuation.definition.string.end.terraform\n#                    ^^^^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#                    ^ punctuation.definition.string.begin.terraform\n#                           ^^ constant.character.escape.terraform\n#                             ^ punctuation.definition.string.end.terraform\n#                               ^^ meta.block.body.terraform\n#                               ^ punctuation.section.block.begin.terraform\n#                                ^ punctuation.section.block.end.terraform\n\n/////\n// Inline block with identifier labels.\n/////\n\n    thing thing1 thing2 thing3 {}\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^^ keyword.declaration.terraform\n#         ^^^^^^ string.unquoted.double.terraform\n#                ^^^^^^ string.unquoted.double.terraform\n#                       ^^^^^^ string.unquoted.double.terraform\n#                              ^^ meta.block.body.terraform\n#                              ^ punctuation.section.block.begin.terraform\n#                               ^ punctuation.section.block.end.terraform\n\n//////\n// Nested multi-line blocks with expressions.\n/////\n\n    resource \"aws_security_group\" \"example\" {\n#   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^^^^^ keyword.declaration.terraform\n#            ^^^^^^^^^^^^^^^^^^^^ meta.string.terraform\n#            ^ punctuation.definition.string.begin.terraform\n#             ^^^^^^^^^^^^^^^^^^ support.type.terraform\n#                               ^ punctuation.definition.string.end.terraform\n#                                 ^^^^^^^^^ meta.string.terraform\n#                                 ^ punctuation.definition.string.begin.terraform\n#                                  ^^^^^^^ entity.name.label.terraform\n#                                         ^ punctuation.definition.string.end.terraform\n#                                           ^ meta.block.body.terraform punctuation.section.block.begin.terraform\n\n      name = \"example\"\n#     ^^^^^^^^^^^^^^^^ meta.block.body.terraform\n#     ^^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#          ^ keyword.operator.assignment.terraform\n#            ^^^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#            ^ punctuation.definition.string.begin.terraform\n#                    ^ punctuation.definition.string.end.terraform\n\n      dynamic \"ingress\" {\n#^^^^^^^^^^^^^^^^^^^^^^^^ meta.block.body.terraform - meta.block meta.block meta.block\n#     ^^^^^^^^^^^^^^^^^^ meta.block.body.terraform meta.block.head.terraform\n#     ^^^^^^^ keyword.declaration.terraform\n#             ^^^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#             ^ punctuation.definition.string.begin.terraform\n#                     ^ punctuation.definition.string.end.terraform\n#                       ^ meta.block.body.terraform meta.block.body.terraform punctuation.section.block.begin.terraform\n\n        for_each = var.service_ports\n#       ^^^^^^^^ variable.declaration.terraform keyword.control.loop.for.terraform\n#                ^ keyword.operator.assignment.terraform\n#                  ^^^ variable.language.terraform\n#                     ^ punctuation.accessor.dot.terraform\n#                      ^^^^^^^^^^^^^ variable.other.member.terraform\n        content {\n#       ^^^^^^^ meta.block.body.terraform meta.block.body.terraform meta.block.head.terraform\n#              ^ meta.block.body.terraform meta.block.body.terraform - meta.type\n#               ^^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform - meta.type\n#       ^^^^^^^ keyword.declaration.terraform\n#               ^ punctuation.section.block.begin.terraform\n          from_port = ingress.value\n#         ^^^^^^^^^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform variable.declaration.terraform variable.other.readwrite.terraform\n#                   ^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform keyword.operator.assignment.terraform\n#                            ^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform punctuation.accessor.dot.terraform\n#                             ^^^^^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform variable.other.member.terraform\n          to_port   = ingress.value\n#         ^^^^^^^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform variable.declaration.terraform variable.other.readwrite.terraform\n#                   ^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform keyword.operator.assignment.terraform\n#                            ^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform punctuation.accessor.dot.terraform\n          protocol  = \"tcp\" + \"IP\"\n#         ^^^^^^^^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform variable.declaration.terraform variable.other.readwrite.terraform\n#                   ^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform keyword.operator.assignment.terraform\n#                     ^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                      ^^^^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform string.quoted.double.terraform\n#                           ^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform keyword.operator.arithmetic.terraform\n#                             ^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform string.quoted.double.terraform punctuation.definition.string.begin.terraform\n#                              ^^^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform string.quoted.double.terraform\n        }\n#       ^ meta.block.body.terraform meta.block.body.terraform meta.block.body.terraform punctuation.section.block.end.terraform\n      }\n#     ^ meta.block.body.terraform meta.block.body.terraform punctuation.section.block.end.terraform\n    }\n#   ^ meta.block.body.terraform punctuation.section.block.end.terraform\n#    ^ - meta\n\n/////\n// Matches blocks with functions, objects, tuples.\n/////\n\n    thing label1 {\n#   ^^^^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^^ keyword.declaration.terraform\n#         ^^^^^^ string.unquoted.double.terraform\n#                ^ meta.block.body.terraform punctuation.section.block.begin.terraform\n\n      func = function(param1)\n#    ^^^^^^^^^^^^^^^^^^^^^^^^^ meta.block.body.terraform\n#     ^^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#          ^ keyword.operator.assignment.terraform\n#            ^^^^^^^^ meta.function-call.identifier.terraform variable.function.terraform\n#                    ^ meta.function-call.arguments.terraform punctuation.section.parens.begin.terraform\n#                     ^^^^^^ meta.function-call.arguments.terraform\n#                           ^ meta.function-call.arguments.terraform punctuation.section.parens.end.terraform\n      obj = {\n#    ^^^^^^^ meta.block.body.terraform - meta.braces\n#           ^^ meta.block.body.terraform meta.braces.terraform\n#     ^^^ variable.declaration.terraform variable.other.readwrite.terraform\n#         ^ keyword.operator.assignment.terraform\n        key = \"value\"\n#      ^^^^^^^^^^^^^^^ meta.block.body.terraform meta.braces.terraform\n#       ^^^ meta.mapping.key.terraform string.unquoted.terraform\n#           ^ keyword.operator.assignment.terraform\n#             ^^^^^^^ meta.string.terraform string.quoted.double.terraform\n      }\n#     ^ meta.block.body.terraform meta.braces.terraform punctuation.section.braces.end.terraform\n      tuple = [1, 2]\n#     ^^^^^ meta.block.body.terraform variable.declaration.terraform variable.other.readwrite.terraform\n#           ^ meta.block.body.terraform keyword.operator.assignment.terraform\n#             ^ meta.block.body.terraform punctuation.section.brackets.begin.terraform\n#              ^ meta.block.body.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#               ^ meta.block.body.terraform punctuation.separator.terraform\n#                 ^ meta.block.body.terraform meta.number.integer.decimal.terraform constant.numeric.value.terraform\n#                  ^ meta.block.body.terraform punctuation.section.brackets.end.terraform\n    }\n#   ^ meta.block.body.terraform punctuation.section.block.end.terraform\n#    ^ - meta - block\n\n/////////////////////////////////////////////////////////////////////\n// TERRAFORM NAMED VALUES\n/////////////////////////////////////////////////////////////////////\n\n    var.something\n#   ^^^ variable.language.terraform\n#      ^ punctuation.accessor.dot.terraform\n#       ^^^^^^^^^ variable.other.member.terraform\n\n    local.something\n#   ^^^^^ variable.language.terraform\n#        ^ punctuation.accessor.dot.terraform\n#         ^^^^^^^^^ variable.other.member.terraform\n\n    module.name.output_name\n#   ^^^^^^ variable.language.terraform\n#         ^ punctuation.accessor.dot.terraform\n#          ^^^^ variable.other.member.terraform\n#              ^ punctuation.accessor.dot.terraform\n#               ^^^^^^^^^^^ variable.other.member.terraform\n\n    data.data_type.name\n#   ^^^^ variable.language.terraform\n#       ^ punctuation.accessor.dot.terraform\n#        ^^^^^^^^^ variable.other.member.terraform\n#                 ^ punctuation.accessor.dot.terraform\n#                  ^^^^ variable.other.member.terraform\n\n    path.module\n#   ^^^^ variable.language.terraform\n#       ^ punctuation.accessor.dot.terraform\n#        ^^^^^^ variable.other.member.terraform\n\n    terraform.workspace\n#   ^^^^^^^^^ variable.language.terraform\n#            ^ punctuation.accessor.dot.terraform\n#             ^^^^^^^^^ variable.other.member.terraform\n\n    count.index\n#   ^^^^^ variable.language.terraform\n#        ^ punctuation.accessor.dot.terraform\n#         ^^^^^ variable.other.member.terraform\n\n    each.key\n#   ^^^^ variable.language.terraform\n#       ^ punctuation.accessor.dot.terraform\n#        ^^^ variable.other.member.terraform\n\n    self.private_ip\n#   ^^^^ variable.language.terraform\n#       ^ punctuation.accessor.dot.terraform\n#        ^^^^^^^^^^ variable.other.member.terraform\n\n/////////////////////////////////////////////////////////////////////\n// TERRAFORM TOP-LEVEL BLOCK TYPES\n/////////////////////////////////////////////////////////////////////\n\n    resource \"type\" \"name\" {}\n#   ^^^^^^^^^^^^^^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^^^^^ keyword.declaration.terraform\n#            ^^^^^^ meta.string.terraform\n#            ^ punctuation.definition.string.begin.terraform\n#             ^^^^ support.type.terraform\n#                 ^ punctuation.definition.string.end.terraform\n#                   ^^^^^^ meta.string.terraform\n#                   ^ punctuation.definition.string.begin.terraform\n#                    ^^^^ entity.name.label.terraform\n#                        ^ punctuation.definition.string.end.terraform\n#                          ^^ meta.block.body.terraform\n#                          ^ punctuation.section.block.begin.terraform\n#                           ^ punctuation.section.block.end.terraform\n\n    ephemeral \"type\" \"name\" {}\n#   ^^^^^^^^^^^^^^^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^^^^^^ keyword.declaration.terraform\n#             ^^^^^^ meta.string.terraform\n#             ^ punctuation.definition.string.begin.terraform\n#              ^^^^ support.type.terraform\n#                  ^ punctuation.definition.string.end.terraform\n#                    ^^^^^^ meta.string.terraform\n#                    ^ punctuation.definition.string.begin.terraform\n#                     ^^^^ entity.name.label.terraform\n#                         ^ punctuation.definition.string.end.terraform\n#                           ^^ meta.block.body.terraform\n#                           ^ punctuation.section.block.begin.terraform\n#                            ^ punctuation.section.block.end.terraform\n\n    data \"type\" name {}\n#   ^^^^^^^^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^ keyword.declaration.terraform\n#        ^^^^^^ meta.string.terraform\n#        ^ punctuation.definition.string.begin.terraform\n#         ^^^^ support.type.terraform\n#             ^ punctuation.definition.string.end.terraform\n#               ^^^^ entity.name.label.terraform\n#                    ^^ meta.block.body.terraform\n#                    ^ punctuation.section.block.begin.terraform\n#                     ^ punctuation.section.block.end.terraform\n\n    provider \"name\" {}\n#   ^^^^^^^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^^^^^ keyword.declaration.terraform\n#            ^^^^^^ meta.string.terraform\n#            ^ punctuation.definition.string.begin.terraform\n#             ^^^^ entity.name.label.terraform\n#                 ^ punctuation.definition.string.end.terraform\n#                   ^^ meta.block.body.terraform\n#                   ^ punctuation.section.block.begin.terraform\n#                    ^ punctuation.section.block.end.terraform\n\n    module name {}\n#   ^^^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^^^ keyword.declaration.terraform\n#          ^^^^ entity.name.label.terraform\n#               ^^ meta.block.body.terraform\n#               ^ punctuation.section.block.begin.terraform\n#                ^ punctuation.section.block.end.terraform\n\n    variable \"name\" {}\n#   ^^^^^^^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^^^^^ keyword.declaration.terraform\n#            ^^^^^^ meta.string.terraform\n#            ^ punctuation.definition.string.begin.terraform\n#             ^^^^ entity.name.label.terraform\n#                 ^ punctuation.definition.string.end.terraform\n#                   ^^ meta.block.body.terraform\n#                   ^ punctuation.section.block.begin.terraform\n#                    ^ punctuation.section.block.end.terraform\n\n    output \"name\"{}\n#   ^^^^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^^^ keyword.declaration.terraform\n#          ^^^^^^ meta.string.terraform\n#          ^ punctuation.definition.string.begin.terraform\n#           ^^^^ entity.name.label.terraform\n#               ^ punctuation.definition.string.end.terraform\n#                ^^ meta.block.body.terraform\n#                ^ punctuation.section.block.begin.terraform\n#                 ^ punctuation.section.block.end.terraform\n\n    locals {}\n#   ^^^^^^^ meta.block.head.terraform\n#   ^^^^^^ keyword.declaration.terraform\n#          ^^ meta.block.body.terraform\n#          ^ punctuation.section.block.begin.terraform\n#           ^ punctuation.section.block.end.terraform\n\n    terraform {}\n#   ^^^^^^^^^^ meta.block.head.terraform\n#   ^^^^^^^^^ keyword.declaration.terraform\n#             ^^ meta.block.body.terraform\n#             ^ punctuation.section.block.begin.terraform\n#              ^ punctuation.section.block.end.terraform\n\n/////////////////////////////////////////////////////////////////////\n// TERRAFORM TYPE KEYWORDS\n/////////////////////////////////////////////////////////////////////\n\n    string\n#   ^^^^^^ storage.type.terraform\n\n    any\n#   ^^^ storage.type.terraform\n\n    number\n#   ^^^^^^ storage.type.terraform\n\n    bool\n#   ^^^^ storage.type.terraform\n\n/////////////////////////////////////////////////////////////////////\n// HEREDOCS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Basic example.\n/////\n    << EOF\n#   ^^ keyword.operator.heredoc.terraform\n#      ^^^ keyword.control.heredoc.terraform\n    sdfdfsd\n#   ^^^^^^^^ string.unquoted.heredoc.terraform\n    EOF\n#   ^^^^ keyword.control.heredoc.terraform\n\n/////\n// With leading-spaces-operator.\n/////\n\n    <<- END\n#   ^^^ keyword.operator.heredoc.terraform\n#       ^^^ keyword.control.heredoc.terraform\n    heredoc\n#   ^^^^^^^^ string.unquoted.heredoc.terraform\n    EOF\n#   ^^^^ string.unquoted.heredoc.terraform\n    END\n#   ^^^^ keyword.control.heredoc.terraform\n\n/////\n// Includes string interpolation.\n/////\n\n    <<- END\n#   ^^^ keyword.operator.heredoc.terraform\n#       ^^^ keyword.control.heredoc.terraform\n    Hello, %{var.name}\n#^^^^^^^^^^^^^^^^^^^^^ meta.string.terraform\n#^^^^^^^^^^ string.unquoted.heredoc.terraform\n#          ^^^^^^^^^^^ meta.interpolation.terraform\n#          ^^ punctuation.section.interpolation.begin.terraform\n#            ^^^^^^^^ source.terraform\n#            ^^^ variable.language.terraform\n#               ^ punctuation.accessor.dot.terraform\n#                ^^^^ variable.other.member.terraform\n#                    ^ punctuation.section.interpolation.end.terraform\n    END\n#   ^^^^ keyword.control.heredoc.terraform\n\n    <<__EOF__\n#   ^^ keyword.operator.heredoc.terraform\n#     ^^^^^^^ keyword.control.heredoc.terraform\n    aaa\n    __EOF__\n#   ^^^^^^^^ keyword.control.heredoc.terraform\n/////////////////////////////////////////////////////////////////////\n// IMPORTS\n/////////////////////////////////////////////////////////////////////\n\n/////\n// Import with attribute access.\n/////\n\n    terraform import aws_instance.example i-abcd1234\n#   ^^^^^^^^^ support.constant.terraform\n#             ^^^^^^ keyword.control.import.terraform\n#                    ^^^^^^^^^^^^ entity.name.label.terraform\n#                                ^ punctuation.accessor.dot.terraform\n#                                 ^^^^^^^ variable.other.member.terraform\n#                                         ^^^^^^^^^^ entity.name.label.terraform\n\n/////\n// Import with numeric literals.\n/////\n\n    terraform import digitalocean_ssh_key.mykey 263654\n#   ^^^^^^^^^ support.constant.terraform\n#             ^^^^^^ keyword.control.import.terraform\n#                    ^^^^^^^^^^^^^^^^^^^^ entity.name.label.terraform\n#                                        ^ punctuation.accessor.dot.terraform\n#                                         ^^^^^ variable.other.member.terraform\n#                                               ^^^^^^ meta.number.integer.decimal.terraform constant.numeric.value.terraform\n\n\nresource \"aws_iam_role_policy\" \"attach-inline-policy-1\" {\n    name = \"xxx\"\n    role = aws_iam_role.execution-role.name\n\n    res_arn = \"arn:aws:lambda:*:*:function:${var.environment}-xxx\"\n#             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.block.body.terraform meta.string.terraform\n#             ^ string.quoted.double.terraform punctuation.definition.string.begin.terraform - variable\n#              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ variable.language.acl.terraform\n#                                          ^^ punctuation.section.interpolation.begin.terraform\n#                                            ^^^^^^^^^^^^^^^ source.terraform source.terraform\n#                                            ^^^ variable.language.terraform\n#                                               ^ punctuation.accessor.dot.terraform\n#                                                ^^^^^^^^^^^ variable.other.member.terraform\n#                                                           ^ punctuation.section.interpolation.end.terraform\n#                                                                ^ string.quoted.double.terraform punctuation.definition.string.end.terraform - variable\n\n    policy = jsonencode({\n        Version = \"2012-10-17\"\n#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.block.body.terraform meta.function-call.arguments.terraform meta.braces.terraform\n#       ^^^^^^^ meta.mapping.key.terraform string.unquoted.terraform\n#               ^ keyword.operator.assignment.terraform\n#                 ^^^^^^^^^^^^ meta.string.terraform string.quoted.double.terraform\n#                 ^ punctuation.definition.string.begin.terraform\n#                            ^ punctuation.definition.string.end.terraform\n        # comment\n#       ^^^^^^^^^^ comment.line.terraform\n        \"Statement\": [\n#^^^^^^^^^^^^^^^^^^^^^ meta.block.body.terraform meta.function-call.arguments.terraform\n#^^^^^^^ meta.braces.terraform\n#       ^^^^^^^^^^^ meta.mapping.key.json string.quoted.double.json\n#       ^ punctuation.definition.string.begin.json\n#                 ^ punctuation.definition.string.end.json\n#                  ^^ meta.braces.terraform\n#                  ^ punctuation.separator.key-value.json\n#                    ^ meta.mapping.value.json meta.sequence.json punctuation.section.sequence.begin.json\n            # comment\n#           ^^^^^^^^^^ comment.line.terraform\n            {\n                \"Action\": [\n                    \"lambda:InvokeFunction\",\n                    \"lambda:InvokeAsync\"\n                ],\n                \"Resource\": \"arn:aws:lambda:*:*:function:${var.environment}-xxx\",\n#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.block.body.terraform meta.function-call.arguments.terraform meta.mapping.value.json meta.sequence.json\n#^^^^^^^^^^^^^^^ meta.mapping.json\n#               ^^^^^^^^^^ meta.mapping.key.json string.quoted.double.json\n#                         ^^ meta.mapping.json\n#                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.mapping.value.json meta.string.json - meta.interpolation\n#                                                        ^^^^^^^^^^^^^^^^^^ meta.mapping.value.json meta.string.json meta.interpolation.terraform - string\n#                                                                          ^^^^^ meta.mapping.value.json meta.string.json - meta.interpolation\n#                                                                               ^ meta.mapping.json\n#               ^ punctuation.definition.string.begin.json\n#                        ^ punctuation.definition.string.end.json\n#                         ^ punctuation.separator.key-value.json\n#                           ^ string.quoted.double.json punctuation.definition.string.begin.json - variable\n#                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ variable.language.acl.terraform\n#                                                        ^^ punctuation.section.interpolation.begin.terraform\n#                                                          ^^^^^^^^^^^^^^^ source.terraform source.terraform\n#                                                          ^^^ variable.language.terraform\n#                                                             ^ punctuation.accessor.dot.terraform\n#                                                              ^^^^^^^^^^^ variable.other.member.terraform\n#                                                                         ^ punctuation.section.interpolation.end.terraform\n#                                                                              ^ string.quoted.double.json  punctuation.definition.string.end.json - variable\n#                                                                               ^ punctuation.separator.sequence.json\n                \"Effect\": \"Allow\"\n            }\n        ]\n    })\n}\n\n]\n# <- invalid.illegal.stray.terraform\n\n}\n# <- invalid.illegal.stray.terraform\n\n)\n# <- invalid.illegal.stray.terraform\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/SublimeText__Terraform__tests__syntax_test_scope.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/SublimeText__Terraform__tests__syntax_test_scope.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/SublimeText__Terraform__tests__syntax_test_scope.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n# SPDX-License-Identifier: MIT-0\n\n/*===========================\n          Root file\n============================*/\n\n# ------- Providers -------\nprovider \"aws\" {\n  profile = var.aws_profile\n  region  = var.aws_region\n\n  # provider level tags - yet inconsistent when executing \n  # default_tags {\n  #   tags = {\n  #     Created_by = \"Terraform\"\n  #     Project    = \"AWS_demo_fullstack_devops\"\n  #   }\n  # }\n}\n\n# ------- Random numbers intended to be used as unique identifiers for resources -------\nresource \"random_id\" \"RANDOM_ID\" {\n  byte_length = \"2\"\n}\n\n# ------- Account ID -------\ndata \"aws_caller_identity\" \"id_current_account\" {}\n\n# ------- Networking -------\nmodule \"networking\" {\n  source = \"./Modules/Networking\"\n  cidr   = [\"10.120.0.0/16\"]\n  name   = var.environment_name\n}\n\n# ------- Creating Target Group for the server ALB blue environment -------\nmodule \"target_group_server_blue\" {\n  source              = \"./Modules/ALB\"\n  create_target_group = true\n  name                = \"tg-${var.environment_name}-s-b\"\n  port                = 80\n  protocol            = \"HTTP\"\n  vpc                 = module.networking.aws_vpc\n  tg_type             = \"ip\"\n  health_check_path   = \"/status\"\n  health_check_port   = var.port_app_server\n}\n\n# ------- Creating Target Group for the server ALB green environment -------\nmodule \"target_group_server_green\" {\n  source              = \"./Modules/ALB\"\n  create_target_group = true\n  name                = \"tg-${var.environment_name}-s-g\"\n  port                = 80\n  protocol            = \"HTTP\"\n  vpc                 = module.networking.aws_vpc\n  tg_type             = \"ip\"\n  health_check_path   = \"/status\"\n  health_check_port   = var.port_app_server\n}\n\n# ------- Creating Target Group for the client ALB blue environment -------\nmodule \"target_group_client_blue\" {\n  source              = \"./Modules/ALB\"\n  create_target_group = true\n  name                = \"tg-${var.environment_name}-c-b\"\n  port                = 80\n  protocol            = \"HTTP\"\n  vpc                 = module.networking.aws_vpc\n  tg_type             = \"ip\"\n  health_check_path   = \"/\"\n  health_check_port   = var.port_app_client\n}\n\n# ------- Creating Target Group for the client ALB green environment -------\nmodule \"target_group_client_green\" {\n  source              = \"./Modules/ALB\"\n  create_target_group = true\n  name                = \"tg-${var.environment_name}-c-g\"\n  port                = 80\n  protocol            = \"HTTP\"\n  vpc                 = module.networking.aws_vpc\n  tg_type             = \"ip\"\n  health_check_path   = \"/\"\n  health_check_port   = var.port_app_client\n}\n\n# ------- Creating Security Group for the server ALB -------\nmodule \"security_group_alb_server\" {\n  source              = \"./Modules/SecurityGroup\"\n  name                = \"alb-${var.environment_name}-server\"\n  description         = \"Controls access to the server ALB\"\n  vpc_id              = module.networking.aws_vpc\n  cidr_blocks_ingress = [\"0.0.0.0/0\"]\n  ingress_port        = 80\n}\n\n# ------- Creating Security Group for the client ALB -------\nmodule \"security_group_alb_client\" {\n  source              = \"./Modules/SecurityGroup\"\n  name                = \"alb-${var.environment_name}-client\"\n  description         = \"Controls access to the client ALB\"\n  vpc_id              = module.networking.aws_vpc\n  cidr_blocks_ingress = [\"0.0.0.0/0\"]\n  ingress_port        = 80\n}\n\n# ------- Creating Server Application ALB -------\nmodule \"alb_server\" {\n  source         = \"./Modules/ALB\"\n  create_alb     = true\n  name           = \"${var.environment_name}-ser\"\n  subnets        = [module.networking.public_subnets[0], module.networking.public_subnets[1]]\n  security_group = module.security_group_alb_server.sg_id\n  target_group   = module.target_group_server_blue.arn_tg\n}\n\n# ------- Creating Client Application ALB -------\nmodule \"alb_client\" {\n  source         = \"./Modules/ALB\"\n  create_alb     = true\n  name           = \"${var.environment_name}-cli\"\n  subnets        = [module.networking.public_subnets[0], module.networking.public_subnets[1]]\n  security_group = module.security_group_alb_client.sg_id\n  target_group   = module.target_group_client_blue.arn_tg\n}\n\n# ------- ECS Role -------\nmodule \"ecs_role\" {\n  source             = \"./Modules/IAM\"\n  create_ecs_role    = true\n  name               = var.iam_role_name[\"ecs\"]\n  name_ecs_task_role = var.iam_role_name[\"ecs_task_role\"]\n  dynamodb_table     = [module.dynamodb_table.dynamodb_table_arn]\n}\n\n# ------- Creating a IAM Policy for role -------\nmodule \"ecs_role_policy\" {\n  source        = \"./Modules/IAM\"\n  name          = \"ecs-ecr-${var.environment_name}\"\n  create_policy = true\n  attach_to     = module.ecs_role.name_role\n}\n\n# ------- Creating server ECR Repository to store Docker Images -------\nmodule \"ecr_server\" {\n  source = \"./Modules/ECR\"\n  name   = \"repo-server\"\n}\n\n# ------- Creating client ECR Repository to store Docker Images -------\nmodule \"ecr_client\" {\n  source = \"./Modules/ECR\"\n  name   = \"repo-client\"\n}\n\n# ------- Creating ECS Task Definition for the server -------\nmodule \"ecs_taks_definition_server\" {\n  source             = \"./Modules/ECS/TaskDefinition\"\n  name               = \"${var.environment_name}-server\"\n  container_name     = var.container_name[\"server\"]\n  execution_role_arn = module.ecs_role.arn_role\n  task_role_arn      = module.ecs_role.arn_role_ecs_task_role\n  cpu                = 256\n  memory             = \"512\"\n  docker_repo        = module.ecr_server.ecr_repository_url\n  region             = var.aws_region\n  container_port     = var.port_app_server\n}\n\n# ------- Creating ECS Task Definition for the client -------\nmodule \"ecs_taks_definition_client\" {\n  source             = \"./Modules/ECS/TaskDefinition\"\n  name               = \"${var.environment_name}-client\"\n  container_name     = var.container_name[\"client\"]\n  execution_role_arn = module.ecs_role.arn_role\n  task_role_arn      = module.ecs_role.arn_role_ecs_task_role\n  cpu                = 256\n  memory             = \"512\"\n  docker_repo        = module.ecr_client.ecr_repository_url\n  region             = var.aws_region\n  container_port     = var.port_app_client\n}\n\n# ------- Creating a server Security Group for ECS TASKS -------\nmodule \"security_group_ecs_task_server\" {\n  source          = \"./Modules/SecurityGroup\"\n  name            = \"ecs-task-${var.environment_name}-server\"\n  description     = \"Controls access to the server ECS task\"\n  vpc_id          = module.networking.aws_vpc\n  ingress_port    = var.port_app_server\n  security_groups = [module.security_group_alb_server.sg_id]\n}\n# ------- Creating a client Security Group for ECS TASKS -------\nmodule \"security_group_ecs_task_client\" {\n  source          = \"./Modules/SecurityGroup\"\n  name            = \"ecs-task-${var.environment_name}-client\"\n  description     = \"Controls access to the client ECS task\"\n  vpc_id          = module.networking.aws_vpc\n  ingress_port    = var.port_app_client\n  security_groups = [module.security_group_alb_client.sg_id]\n}\n\n# ------- Creating ECS Cluster -------\nmodule \"ecs_cluster\" {\n  source = \"./Modules/ECS/Cluster\"\n  name   = var.environment_name\n}\n\n# ------- Creating ECS Service server -------\nmodule \"ecs_service_server\" {\n  depends_on          = [module.alb_server]\n  source              = \"./Modules/ECS/Service\"\n  name                = \"${var.environment_name}-server\"\n  desired_tasks       = 1\n  arn_security_group  = module.security_group_ecs_task_server.sg_id\n  ecs_cluster_id      = module.ecs_cluster.ecs_cluster_id\n  arn_target_group    = module.target_group_server_blue.arn_tg\n  arn_task_definition = module.ecs_taks_definition_server.arn_task_definition\n  subnets_id          = [module.networking.private_subnets_server[0], module.networking.private_subnets_server[1]]\n  container_port      = var.port_app_server\n  container_name      = var.container_name[\"server\"]\n}\n\n# ------- Creating ECS Service client -------\nmodule \"ecs_service_client\" {\n  depends_on          = [module.alb_client]\n  source              = \"./Modules/ECS/Service\"\n  name                = \"${var.environment_name}-client\"\n  desired_tasks       = 1\n  arn_security_group  = module.security_group_ecs_task_client.sg_id\n  ecs_cluster_id      = module.ecs_cluster.ecs_cluster_id\n  arn_target_group    = module.target_group_client_blue.arn_tg\n  arn_task_definition = module.ecs_taks_definition_client.arn_task_definition\n  subnets_id          = [module.networking.private_subnets_client[0], module.networking.private_subnets_client[1]]\n  container_port      = var.port_app_client\n  container_name      = var.container_name[\"client\"]\n}\n\n# ------- Creating ECS Autoscaling policies for the server application -------\nmodule \"ecs_autoscaling_server\" {\n  depends_on   = [module.ecs_service_server]\n  source       = \"./Modules/ECS/Autoscaling\"\n  name         = \"${var.environment_name}-server\"\n  cluster_name = module.ecs_cluster.ecs_cluster_name\n  min_capacity = 1\n  max_capacity = 4\n}\n\n# ------- Creating ECS Autoscaling policies for the client application -------\nmodule \"ecs_autoscaling_client\" {\n  depends_on   = [module.ecs_service_client]\n  source       = \"./Modules/ECS/Autoscaling\"\n  name         = \"${var.environment_name}-client\"\n  cluster_name = module.ecs_cluster.ecs_cluster_name\n  min_capacity = 1\n  max_capacity = 4\n}\n\n# ------- CodePipeline -------\n\n# ------- Creating Bucket to store CodePipeline artifacts -------\nmodule \"s3_codepipeline\" {\n  source      = \"./Modules/S3\"\n  bucket_name = \"codepipeline-${var.aws_region}-${random_id.RANDOM_ID.hex}\"\n}\n\n# ------- Creating IAM roles used during the pipeline excecution -------\nmodule \"devops_role\" {\n  source             = \"./Modules/IAM\"\n  create_devops_role = true\n  name               = var.iam_role_name[\"devops\"]\n}\n\nmodule \"codedeploy_role\" {\n  source                 = \"./Modules/IAM\"\n  create_codedeploy_role = true\n  name                   = var.iam_role_name[\"codedeploy\"]\n}\n\n# ------- Creating an IAM Policy for role ------- \nmodule \"policy_devops_role\" {\n  source                = \"./Modules/IAM\"\n  name                  = \"devops-${var.environment_name}\"\n  create_policy         = true\n  attach_to             = module.devops_role.name_role\n  create_devops_policy  = true\n  ecr_repositories      = [module.ecr_server.ecr_repository_arn, module.ecr_client.ecr_repository_arn]\n  code_build_projects   = [module.codebuild_client.project_arn, module.codebuild_server.project_arn]\n  code_deploy_resources = [module.codedeploy_server.application_arn, module.codedeploy_server.deployment_group_arn, module.codedeploy_client.application_arn, module.codedeploy_client.deployment_group_arn]\n}\n\n# ------- Creating a SNS topic -------\nmodule \"sns\" {\n  source   = \"./Modules/SNS\"\n  sns_name = \"sns-${var.environment_name}\"\n}\n\n# ------- Creating the server CodeBuild project -------\nmodule \"codebuild_server\" {\n  source                 = \"./Modules/CodeBuild\"\n  name                   = \"codebuild-${var.environment_name}-server\"\n  iam_role               = module.devops_role.arn_role\n  region                 = var.aws_region\n  account_id             = data.aws_caller_identity.id_current_account.account_id\n  ecr_repo_url           = module.ecr_server.ecr_repository_url\n  folder_path            = var.folder_path_server\n  buildspec_path         = var.buildspec_path\n  task_definition_family = module.ecs_taks_definition_server.task_definition_family\n  container_name         = var.container_name[\"server\"]\n  service_port           = var.port_app_server\n  ecs_role               = var.iam_role_name[\"ecs\"]\n  ecs_task_role          = var.iam_role_name[\"ecs_task_role\"]\n  dynamodb_table_name    = module.dynamodb_table.dynamodb_table_name\n}\n\n# ------- Creating the client CodeBuild project -------\nmodule \"codebuild_client\" {\n  source                 = \"./Modules/CodeBuild\"\n  name                   = \"codebuild-${var.environment_name}-client\"\n  iam_role               = module.devops_role.arn_role\n  region                 = var.aws_region\n  account_id             = data.aws_caller_identity.id_current_account.account_id\n  ecr_repo_url           = module.ecr_client.ecr_repository_url\n  folder_path            = var.folder_path_client\n  buildspec_path         = var.buildspec_path\n  task_definition_family = module.ecs_taks_definition_client.task_definition_family\n  container_name         = var.container_name[\"client\"]\n  service_port           = var.port_app_client\n  ecs_role               = var.iam_role_name[\"ecs\"]\n  server_alb_url         = module.alb_server.dns_alb\n}\n\n# ------- Creating the server CodeDeploy project -------\nmodule \"codedeploy_server\" {\n  source          = \"./Modules/CodeDeploy\"\n  name            = \"Deploy-${var.environment_name}-server\"\n  ecs_cluster     = module.ecs_cluster.ecs_cluster_name\n  ecs_service     = module.ecs_service_server.ecs_service_name\n  alb_listener    = module.alb_server.arn_listener\n  tg_blue         = module.target_group_server_blue.tg_name\n  tg_green        = module.target_group_server_green.tg_name\n  sns_topic_arn   = module.sns.sns_arn\n  codedeploy_role = module.codedeploy_role.arn_role_codedeploy\n}\n\n# ------- Creating the client CodeDeploy project -------\nmodule \"codedeploy_client\" {\n  source          = \"./Modules/CodeDeploy\"\n  name            = \"Deploy-${var.environment_name}-client\"\n  ecs_cluster     = module.ecs_cluster.ecs_cluster_name\n  ecs_service     = module.ecs_service_client.ecs_service_name\n  alb_listener    = module.alb_client.arn_listener\n  tg_blue         = module.target_group_client_blue.tg_name\n  tg_green        = module.target_group_client_green.tg_name\n  sns_topic_arn   = module.sns.sns_arn\n  codedeploy_role = module.codedeploy_role.arn_role_codedeploy\n}\n\n# ------- Creating CodePipeline -------\nmodule \"codepipeline\" {\n  source                   = \"./Modules/CodePipeline\"\n  name                     = \"pipeline-${var.environment_name}\"\n  pipe_role                = module.devops_role.arn_role\n  s3_bucket                = module.s3_codepipeline.s3_bucket_id\n  github_token             = var.github_token\n  repo_owner               = var.repository_owner\n  repo_name                = var.repository_name\n  branch                   = var.repository_branch\n  codebuild_project_server = module.codebuild_server.project_id\n  codebuild_project_client = module.codebuild_client.project_id\n  app_name_server          = module.codedeploy_server.application_name\n  app_name_client          = module.codedeploy_client.application_name\n  deployment_group_server  = module.codedeploy_server.deployment_group_name\n  deployment_group_client  = module.codedeploy_client.deployment_group_name\n\n  depends_on = [module.policy_devops_role]\n}\n\n# ------- Creating Bucket to store assets accessed by the Back-end -------\nmodule \"s3_assets\" {\n  source      = \"./Modules/S3\"\n  bucket_name = \"assets-${var.aws_region}-${random_id.RANDOM_ID.hex}\"\n}\n\n# ------- Creating Dynamodb table by the Back-end -------\nmodule \"dynamodb_table\" {\n  source = \"./Modules/Dynamodb\"\n  name   = \"assets-table-${var.environment_name}\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__amazon-ecs-fullstack-app-terraform__Infrastructure__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  # ssh_agent_identity is not set if the private key is passed directly, but if ssh agent is used, the public key tells ssh agent which private key to use.\n  # For terraforms provisioner.connection.agent_identity, we need the public key as a string.\n  ssh_agent_identity = var.ssh_private_key == null ? var.ssh_public_key : null\n\n  # If passed, a key already registered within hetzner is used.\n  # Otherwise, a new one will be created by the module.\n  hcloud_ssh_key_id = var.hcloud_ssh_key_id == null ? hcloud_ssh_key.k3s[0].id : var.hcloud_ssh_key_id\n\n  # if given as a variable, we want to use the given token. This is needed to restore the cluster\n  k3s_token = var.k3s_token == null ? random_password.k3s_token.result : var.k3s_token\n\n  ccm_version    = var.hetzner_ccm_version != null ? var.hetzner_ccm_version : data.github_release.hetzner_ccm[0].release_tag\n  csi_version    = length(data.github_release.hetzner_csi) == 0 ? var.hetzner_csi_version : data.github_release.hetzner_csi[0].release_tag\n  kured_version  = var.kured_version != null ? var.kured_version : data.github_release.kured[0].release_tag\n  calico_version = length(data.github_release.calico) == 0 ? var.calico_version : data.github_release.calico[0].release_tag\n\n  # Determine kured YAML suffix based on version (>= 1.20.0 uses -combined.yaml, < 1.20.0 uses -dockerhub.yaml)\n  kured_yaml_suffix = provider::semvers::compare(local.kured_version, \"1.20.0\") >= 0 ? \"combined\" : \"dockerhub\"\n\n  cilium_ipv4_native_routing_cidr = coalesce(var.cilium_ipv4_native_routing_cidr, var.cluster_ipv4_cidr)\n\n  # Check if the user has set custom DNS servers.\n  has_dns_servers = length(var.dns_servers) > 0\n\n  # Separate out IPv4 and IPv6 DNS hosts.\n  dns_servers_ipv4 = [for ip in var.dns_servers : ip if provider::assert::ipv4(ip)]\n  dns_servers_ipv6 = [for ip in var.dns_servers : ip if provider::assert::ipv6(ip)]\n\n  additional_k3s_environment = join(\"\\n\",\n    [\n      for var_name, var_value in var.additional_k3s_environment :\n      \"${var_name}=\\\"${var_value}\\\"\"\n    ]\n  )\n  install_additional_k3s_environment = <<-EOT\n  cat >> /etc/environment <<EOF\n  ${local.additional_k3s_environment}\n  EOF\n  set -a; source /etc/environment; set +a;\n  EOT\n\n  install_system_alias = <<-EOT\n  cat > /etc/profile.d/00-alias.sh <<EOF\n  alias k=kubectl\n  EOF\n  EOT\n\n  install_kubectl_bash_completion = <<-EOT\n  cat > /etc/bash_completion.d/kubectl <<EOF\n  if command -v kubectl >/dev/null; then\n    source <(kubectl completion bash)\n    complete -o default -F __start_kubectl k\n  fi\n  EOF\n  EOT\n\n  common_pre_install_k3s_commands = concat(\n    [\n      \"set -ex\",\n      # rename the private network interface to eth1\n      \"/etc/cloud/rename_interface.sh\",\n      # prepare the k3s config directory\n      \"mkdir -p /etc/rancher/k3s\",\n      # move the config file into place and adjust permissions\n      \"[ -f /tmp/config.yaml ] && mv /tmp/config.yaml /etc/rancher/k3s/config.yaml\",\n      \"chmod 0600 /etc/rancher/k3s/config.yaml\",\n      # if the server has already been initialized just stop here\n      \"[ -e /etc/rancher/k3s/k3s.yaml ] && exit 0\",\n      local.install_additional_k3s_environment,\n      local.install_system_alias,\n      local.install_kubectl_bash_completion,\n    ],\n    local.has_dns_servers ? [\n      join(\"\\n\", compact([\n        \"# Wait for NetworkManager to be ready\",\n        \"if ! timeout 60 bash -c 'until systemctl is-active --quiet NetworkManager; do echo \\\"Waiting for NetworkManager to be ready...\\\"; sleep 2; done'; then\",\n        \"  echo \\\"ERROR: NetworkManager is not active after timeout\\\" >&2\",\n        \"  exit 0  # Don't fail cloud-init\",\n        \"fi\",\n        \"# Get the default interface\",\n        \"IFACE=$(ip route show default 2>/dev/null | awk '/^default/ && /dev/ {for(i=1;i<=NF;i++) if($i==\\\"dev\\\") {print $(i+1); exit}}')\",\n        \"if [ -z \\\"$IFACE\\\" ]; then\",\n        \"  # Fallback: try to get any interface that's up and has an IP\",\n        \"  IFACE=$(ip route show 2>/dev/null | awk '!/^default/ && /dev/ {for(i=1;i<=NF;i++) if($i==\\\"dev\\\") {print $(i+1); exit}}')\",\n        \"fi\",\n        \"if [ -n \\\"$IFACE\\\" ]; then\",\n        \"  CONNECTION=$(nmcli -g GENERAL.CONNECTION device show \\\"$IFACE\\\" 2>/dev/null | head -1)\",\n        \"  if [ -n \\\"$CONNECTION\\\" ]; then\",\n        \"    # Disable auto-DNS for both protocols when custom DNS servers are provided\",\n        \"    nmcli con mod \\\"$CONNECTION\\\" ipv4.ignore-auto-dns yes ipv6.ignore-auto-dns yes\",\n        length(local.dns_servers_ipv4) > 0 ? \"    nmcli con mod \\\"$CONNECTION\\\" ipv4.dns ${join(\",\", local.dns_servers_ipv4)}\" : \"\",\n        length(local.dns_servers_ipv6) > 0 ? \"    nmcli con mod \\\"$CONNECTION\\\" ipv6.dns ${join(\",\", local.dns_servers_ipv6)}\" : \"\",\n        \"  fi\",\n        \"fi\"\n      ]))\n    ] : [],\n    local.has_dns_servers ? [\"systemctl restart NetworkManager\"] : [],\n    [\n      join(\"\\n\", [\n        \"# Ensure persistent private-network default route (Hetzner DHCP change Aug 11, 2025)\",\n        \"set +e  # Allow idempotent network adjustments\",\n        \"METRIC=30000\",\n        \"\",\n        \"# Determine the private interface dynamically (no hardcoded eth1)\",\n        \"PRIV_IF=$(ip -4 route show ${var.network_ipv4_cidr} 2>/dev/null | awk '{for(i=1;i<=NF;i++) if($i==\\\"dev\\\"){print $(i+1); exit}}' | head -n 1)\",\n        \"if [ -z \\\"$PRIV_IF\\\" ]; then\",\n        \"  ROUTE_LINE=$(ip -4 route get ${local.network_gw_ipv4} 2>/dev/null)\",\n        \"  if [ -n \\\"$ROUTE_LINE\\\" ] && ! echo \\\"$ROUTE_LINE\\\" | grep -q ' via '; then\",\n        \"    PRIV_IF=$(echo \\\"$ROUTE_LINE\\\" | awk '{for(i=1;i<=NF;i++) if($i==\\\"dev\\\"){print $(i+1); exit}}' | head -n 1)\",\n        \"  fi\",\n        \"fi\",\n        \"if [ -n \\\"$PRIV_IF\\\" ]; then\",\n        \"  if systemctl is-active --quiet NetworkManager; then\",\n        \"    NM_CONN=$(nmcli -g GENERAL.CONNECTION device show \\\"$PRIV_IF\\\" 2>/dev/null | head -1)\",\n        \"    if [ -n \\\"$NM_CONN\\\" ]; then\",\n        \"      # Persist a default route via the private gateway with higher metric than public NICs\",\n        \"      ROUTE_READY=0\",\n        \"      ROUTE_LINE=$(nmcli -g ipv4.routes connection show \\\"$NM_CONN\\\" | tr ',' '\\\\n' | awk '$1==\\\"0.0.0.0/0\\\" && $2==\\\"${local.network_gw_ipv4}\\\"{print $0; exit}')\",\n        \"      if [ -n \\\"$ROUTE_LINE\\\" ]; then\",\n        \"        CUR_ROUTE_METRIC=$(echo \\\"$ROUTE_LINE\\\" | awk '{print $3}')\",\n        \"        if [ -z \\\"$CUR_ROUTE_METRIC\\\" ] || [ \\\"$CUR_ROUTE_METRIC\\\" != \\\"$METRIC\\\" ]; then\",\n        \"          nmcli connection modify \\\"$NM_CONN\\\" -ipv4.routes \\\"$ROUTE_LINE\\\" >/dev/null 2>&1 || true\",\n        \"          if nmcli connection modify \\\"$NM_CONN\\\" +ipv4.routes \\\"0.0.0.0/0 ${local.network_gw_ipv4} $METRIC\\\" >/dev/null 2>&1; then\",\n        \"            ROUTE_READY=1\",\n        \"          else\",\n        \"            echo \\\"Warning: Failed to update default route metric on $PRIV_IF. Node may be affected by Hetzner DHCP changes.\\\" >&2\",\n        \"          fi\",\n        \"        else\",\n        \"          ROUTE_READY=1\",\n        \"        fi\",\n        \"      else\",\n        \"        if nmcli connection modify \\\"$NM_CONN\\\" +ipv4.routes \\\"0.0.0.0/0 ${local.network_gw_ipv4} $METRIC\\\" >/dev/null 2>&1; then\",\n        \"          ROUTE_READY=1\",\n        \"        else\",\n        \"          echo \\\"Warning: Failed to persist default route on $PRIV_IF. Node may be affected by Hetzner DHCP changes.\\\" >&2\",\n        \"        fi\",\n        \"      fi\",\n        \"      if [ \\\"$ROUTE_READY\\\" -eq 1 ]; then\",\n        \"        nmcli connection modify \\\"$NM_CONN\\\" ipv4.never-default yes >/dev/null 2>&1 || true\",\n        \"        nmcli connection modify \\\"$NM_CONN\\\" ipv6.never-default yes >/dev/null 2>&1 || true\",\n        \"        nmcli connection modify \\\"$NM_CONN\\\" ipv4.route-metric $METRIC >/dev/null 2>&1 || true\",\n        \"        nmcli connection up \\\"$NM_CONN\\\" >/dev/null 2>&1 || true\",\n        \"      fi\",\n        \"    fi\",\n        \"  fi\",\n        \"  # Runtime guard to cover current leases before dispatcher hooks fire\",\n        \"  EXISTING_RT=$(ip -4 route show default dev \\\"$PRIV_IF\\\" | awk '$3==\\\"${local.network_gw_ipv4}\\\"{print $0; exit}')\",\n        \"  if [ -n \\\"$EXISTING_RT\\\" ]; then\",\n        \"    CUR_RT_METRIC=$(echo \\\"$EXISTING_RT\\\" | awk 'match($0,/metric ([0-9]+)/,m){print m[1]}')\",\n        \"    if [ -z \\\"$CUR_RT_METRIC\\\" ] || [ \\\"$CUR_RT_METRIC\\\" != \\\"$METRIC\\\" ]; then\",\n        \"      ip -4 route change default via ${local.network_gw_ipv4} dev \\\"$PRIV_IF\\\" metric $METRIC 2>/dev/null || true\",\n        \"    fi\",\n        \"  else\",\n        \"    ip -4 route add default via ${local.network_gw_ipv4} dev \\\"$PRIV_IF\\\" metric $METRIC 2>/dev/null || true\",\n        \"  fi\",\n        \"else\",\n        \"  echo \\\"Info: Unable to identify interface that reaches ${local.network_gw_ipv4}; skipping private default route setup.\\\"\",\n        \"fi\",\n        \"\",\n        \"set -e\"\n      ])\n    ],\n    # User-defined commands to execute just before installing k3s.\n    var.preinstall_exec,\n    # Wait for a successful connection to the internet.\n    [\"timeout 180s /bin/sh -c 'while ! ping -c 1 ${var.address_for_connectivity_test} >/dev/null 2>&1; do echo \\\"Ready for k3s installation, waiting for a successful connection to the internet...\\\"; sleep 5; done; echo Connected'\"]\n  )\n\n  common_post_install_k3s_commands = concat(var.postinstall_exec, [\"restorecon -v /usr/local/bin/k3s\"])\n\n  kustomization_backup_yaml = yamlencode({\n    apiVersion = \"kustomize.config.k8s.io/v1beta1\"\n    kind       = \"Kustomization\"\n    resources = concat(\n      [\n        \"https://github.com/kubereboot/kured/releases/download/${local.kured_version}/kured-${local.kured_version}-${local.kured_yaml_suffix}.yaml\",\n        \"https://github.com/rancher/system-upgrade-controller/releases/download/${var.sys_upgrade_controller_version}/system-upgrade-controller.yaml\",\n        \"https://github.com/rancher/system-upgrade-controller/releases/download/${var.sys_upgrade_controller_version}/crd.yaml\"\n      ],\n      var.hetzner_ccm_use_helm ? [\"hcloud-ccm-helm.yaml\"] : [\"https://github.com/hetznercloud/hcloud-cloud-controller-manager/releases/download/${local.ccm_version}/ccm-networks.yaml\"],\n      var.disable_hetzner_csi ? [] : [\"hcloud-csi.yaml\"],\n      lookup(local.ingress_controller_install_resources, var.ingress_controller, []),\n      lookup(local.cni_install_resources, var.cni_plugin, []),\n      var.cni_plugin == \"flannel\" ? [\"flannel-rbac.yaml\"] : [],\n      var.enable_longhorn ? [\"longhorn.yaml\"] : [],\n      var.enable_csi_driver_smb ? [\"csi-driver-smb.yaml\"] : [],\n      var.enable_cert_manager || var.enable_rancher ? [\"cert_manager.yaml\"] : [],\n      var.enable_rancher ? [\"rancher.yaml\"] : [],\n      var.rancher_registration_manifest_url != \"\" ? [var.rancher_registration_manifest_url] : []\n    ),\n    patches = concat([\n      {\n        target = {\n          group     = \"apps\"\n          version   = \"v1\"\n          kind      = \"Deployment\"\n          name      = \"system-upgrade-controller\"\n          namespace = \"system-upgrade\"\n        }\n        patch = file(\"${path.module}/kustomize/system-upgrade-controller.yaml\")\n      },\n      {\n        path = \"kured.yaml\"\n      }\n      ],\n      var.hetzner_ccm_use_helm ? [] : [{ path = \"ccm.yaml\" }]\n    )\n  })\n\n  apply_k3s_selinux = [\"/sbin/semodule -v -i /usr/share/selinux/packages/k3s.pp\"]\n  swap_node_label   = [\"node.kubernetes.io/server-swap=enabled\"]\n\n  k3s_install_command = \"curl -sfL https://get.k3s.io | INSTALL_K3S_SKIP_START=true INSTALL_K3S_SKIP_SELINUX_RPM=true %{if var.install_k3s_version == \"\"}INSTALL_K3S_CHANNEL=${var.initial_k3s_channel}%{else}INSTALL_K3S_VERSION=${var.install_k3s_version}%{endif} INSTALL_K3S_EXEC='%s' sh -\"\n\n  install_k3s_server = concat(\n    local.common_pre_install_k3s_commands,\n    [format(local.k3s_install_command, \"server ${var.k3s_exec_server_args}\")],\n    var.disable_selinux ? [] : local.apply_k3s_selinux,\n    local.common_post_install_k3s_commands\n  )\n\n  install_k3s_agent = concat(\n    local.common_pre_install_k3s_commands,\n    [format(local.k3s_install_command, \"agent ${var.k3s_exec_agent_args}\")],\n    var.disable_selinux ? [] : local.apply_k3s_selinux,\n    local.common_post_install_k3s_commands\n  )\n\n  control_plane_nodes = merge([\n    for pool_index, nodepool_obj in var.control_plane_nodepools : {\n      for node_index in range(nodepool_obj.count) :\n      format(\"%s-%s-%s\", pool_index, node_index, nodepool_obj.name) => {\n        nodepool_name : nodepool_obj.name,\n        server_type : nodepool_obj.server_type,\n        location : nodepool_obj.location,\n        labels : concat(local.default_control_plane_labels, nodepool_obj.swap_size != \"\" ? local.swap_node_label : [], nodepool_obj.labels),\n        taints : concat(local.default_control_plane_taints, nodepool_obj.taints),\n        kubelet_args : nodepool_obj.kubelet_args,\n        backups : nodepool_obj.backups,\n        swap_size : nodepool_obj.swap_size,\n        zram_size : nodepool_obj.zram_size,\n        index : node_index\n        selinux : nodepool_obj.selinux\n        placement_group_compat_idx : nodepool_obj.placement_group_compat_idx,\n        placement_group : nodepool_obj.placement_group,\n        disable_ipv4 : nodepool_obj.disable_ipv4 || local.use_nat_router,\n        disable_ipv6 : nodepool_obj.disable_ipv6 || local.use_nat_router,\n        network_id : nodepool_obj.network_id,\n      }\n    }\n  ]...)\n\n  agent_nodes_from_integer_counts = merge([\n    for pool_index, nodepool_obj in var.agent_nodepools : {\n      # coalesce(nodepool_obj.count, 0) means we select those nodepools who's size is set by an integer count.\n      for node_index in range(coalesce(nodepool_obj.count, 0)) :\n      format(\"%s-%s-%s\", pool_index, node_index, nodepool_obj.name) => {\n        nodepool_name : nodepool_obj.name,\n        server_type : nodepool_obj.server_type,\n        longhorn_volume_size : coalesce(nodepool_obj.longhorn_volume_size, 0),\n        floating_ip : lookup(nodepool_obj, \"floating_ip\", false),\n        floating_ip_rdns : lookup(nodepool_obj, \"floating_ip_rdns\", false),\n        location : nodepool_obj.location,\n        labels : concat(local.default_agent_labels, nodepool_obj.swap_size != \"\" ? local.swap_node_label : [], nodepool_obj.labels),\n        taints : concat(local.default_agent_taints, nodepool_obj.taints),\n        kubelet_args : nodepool_obj.kubelet_args,\n        backups : lookup(nodepool_obj, \"backups\", false),\n        swap_size : nodepool_obj.swap_size,\n        zram_size : nodepool_obj.zram_size,\n        index : node_index\n        selinux : nodepool_obj.selinux\n        placement_group_compat_idx : nodepool_obj.placement_group_compat_idx,\n        placement_group : nodepool_obj.placement_group,\n        disable_ipv4 : nodepool_obj.disable_ipv4 || local.use_nat_router,\n        disable_ipv6 : nodepool_obj.disable_ipv6 || local.use_nat_router,\n        network_id : nodepool_obj.network_id,\n      }\n    }\n  ]...)\n\n  agent_nodes_from_maps_for_counts = merge([\n    for pool_index, nodepool_obj in var.agent_nodepools : {\n      # coalesce(nodepool_obj.nodes, {}) means we select those nodepools who's size is set by an integer count.\n      for node_key, node_obj in coalesce(nodepool_obj.nodes, {}) :\n      format(\"%s-%s-%s\", pool_index, node_key, nodepool_obj.name) => merge(\n        {\n          nodepool_name : nodepool_obj.name,\n          server_type : nodepool_obj.server_type,\n          longhorn_volume_size : coalesce(nodepool_obj.longhorn_volume_size, 0),\n          floating_ip : lookup(nodepool_obj, \"floating_ip\", false),\n          floating_ip_rdns : lookup(nodepool_obj, \"floating_ip_rdns\", false),\n          location : nodepool_obj.location,\n          labels : concat(local.default_agent_labels, nodepool_obj.swap_size != \"\" ? local.swap_node_label : [], nodepool_obj.labels),\n          taints : concat(local.default_agent_taints, nodepool_obj.taints),\n          kubelet_args : nodepool_obj.kubelet_args,\n          backups : lookup(nodepool_obj, \"backups\", false),\n          swap_size : nodepool_obj.swap_size,\n          zram_size : nodepool_obj.zram_size,\n          selinux : nodepool_obj.selinux,\n          placement_group_compat_idx : nodepool_obj.placement_group_compat_idx,\n          placement_group : nodepool_obj.placement_group,\n          index : floor(tonumber(node_key)),\n          disable_ipv4 : nodepool_obj.disable_ipv4 || local.use_nat_router,\n          disable_ipv6 : nodepool_obj.disable_ipv6 || local.use_nat_router,\n          network_id : nodepool_obj.network_id,\n        },\n        { for key, value in node_obj : key => value if value != null },\n        {\n          labels : concat(local.default_agent_labels, nodepool_obj.swap_size != \"\" ? local.swap_node_label : [], nodepool_obj.labels, coalesce(node_obj.labels, [])),\n          taints : concat(local.default_agent_taints, nodepool_obj.taints, coalesce(node_obj.taints, [])),\n        },\n        (\n          node_obj.append_index_to_node_name ? { node_name_suffix : \"-${floor(tonumber(node_key))}\" } : {}\n        )\n      )\n    }\n  ]...)\n\n\n  agent_nodes = merge(\n    local.agent_nodes_from_integer_counts,\n    local.agent_nodes_from_maps_for_counts,\n  )\n\n  use_existing_network = length(var.existing_network_id) > 0\n\n  use_nat_router = var.nat_router != null\n\n  ssh_bastion = local.use_nat_router ? {\n    bastion_host        = hcloud_server.nat_router[0].ipv4_address\n    bastion_port        = var.ssh_port\n    bastion_user        = \"nat-router\"\n    bastion_private_key = var.ssh_private_key\n    } : {\n    bastion_host        = null\n    bastion_port        = null\n    bastion_user        = null\n    bastion_private_key = null\n  }\n\n  # Create 256 /24 subnets from the base network CIDR.\n  # Control planes allocate from the end (255, 254, 253...) and agents from the start (0, 1, 2...)\n  network_ipv4_subnets = [for index in range(256) : cidrsubnet(var.network_ipv4_cidr, 8, index)]\n\n  # By convention the DNS service (usually core-dns) is assigned the 10th IP address in the service CIDR block\n  cluster_dns_ipv4 = var.cluster_dns_ipv4 != null ? var.cluster_dns_ipv4 : cidrhost(var.service_ipv4_cidr, 10)\n\n  # The gateway's IP address is always the first IP address of the subnet's IP range\n  network_gw_ipv4 = cidrhost(var.network_ipv4_cidr, 1)\n\n  # if we are in a single cluster config, we use the default klipper lb instead of Hetzner LB\n  control_plane_count    = sum([for v in var.control_plane_nodepools : v.count])\n  agent_count            = length(var.agent_nodepools) > 0 ? sum([for v in var.agent_nodepools : length(coalesce(v.nodes, {})) + coalesce(v.count, 0)]) : 0\n  autoscaler_max_count   = length(var.autoscaler_nodepools) > 0 ? sum([for v in var.autoscaler_nodepools : v.max_nodes]) : 0\n  is_single_node_cluster = (local.control_plane_count + local.agent_count + local.autoscaler_max_count) == 1\n\n  using_klipper_lb = var.enable_klipper_metal_lb || local.is_single_node_cluster\n\n  has_external_load_balancer = local.using_klipper_lb || var.ingress_controller == \"none\"\n  load_balancer_name         = \"${var.cluster_name}-${var.ingress_controller}\"\n\n  ingress_controller_service_names = {\n    \"traefik\" = \"traefik\"\n    \"nginx\"   = \"nginx-ingress-nginx-controller\"\n    \"haproxy\" = \"haproxy-kubernetes-ingress\"\n  }\n\n  ingress_controller_install_resources = {\n    \"traefik\" = [\"traefik_ingress.yaml\"]\n    \"nginx\"   = [\"nginx_ingress.yaml\"]\n    \"haproxy\" = [\"haproxy_ingress.yaml\"]\n  }\n\n  default_ingress_namespace_mapping = {\n    \"traefik\" = \"traefik\"\n    \"nginx\"   = \"nginx\"\n    \"haproxy\" = \"haproxy\"\n  }\n\n  ingress_controller_namespace = var.ingress_target_namespace != \"\" ? var.ingress_target_namespace : lookup(local.default_ingress_namespace_mapping, var.ingress_controller, \"\")\n  ingress_replica_count        = (var.ingress_replica_count > 0) ? var.ingress_replica_count : (local.agent_count > 2) ? 3 : (local.agent_count == 2) ? 2 : 1\n  ingress_max_replica_count    = (var.ingress_max_replica_count > local.ingress_replica_count) ? var.ingress_max_replica_count : local.ingress_replica_count\n\n  # disable k3s extras\n  disable_extras = concat(var.enable_local_storage ? [] : [\"local-storage\"], local.using_klipper_lb ? [] : [\"servicelb\"], [\"traefik\"], var.enable_metrics_server ? [] : [\"metrics-server\"])\n\n  # Determine if scheduling should be allowed on control plane nodes, which will be always true for single node clusters and clusters or if scheduling is allowed on control plane nodes\n  allow_scheduling_on_control_plane = local.is_single_node_cluster ? true : var.allow_scheduling_on_control_plane\n  # Determine if loadbalancer target should be allowed on control plane nodes, which will be always true for single node clusters or if scheduling is allowed on control plane nodes\n  allow_loadbalancer_target_on_control_plane = local.is_single_node_cluster ? true : var.allow_scheduling_on_control_plane\n\n  # Default k3s node labels\n  default_agent_labels         = concat([], var.automatically_upgrade_k3s ? [\"k3s_upgrade=true\"] : [])\n  default_control_plane_labels = concat(local.allow_loadbalancer_target_on_control_plane ? [] : [\"node.kubernetes.io/exclude-from-external-load-balancers=true\"], var.automatically_upgrade_k3s ? [\"k3s_upgrade=true\"] : [])\n\n  # Default k3s node taints\n  default_control_plane_taints = concat([], local.allow_scheduling_on_control_plane ? [] : [\"node-role.kubernetes.io/control-plane:NoSchedule\"])\n  default_agent_taints         = concat([], var.cni_plugin == \"cilium\" ? [\"node.cilium.io/agent-not-ready:NoExecute\"] : [])\n\n  base_firewall_rules = concat(\n    var.firewall_ssh_source == null ? [] : [\n      # Allow all traffic to the ssh port\n      {\n        description = \"Allow Incoming SSH Traffic\"\n        direction   = \"in\"\n        protocol    = \"tcp\"\n        port        = var.ssh_port\n        source_ips  = var.firewall_ssh_source\n      },\n    ],\n    var.firewall_kube_api_source == null ? [] : [\n      {\n        description = \"Allow Incoming Requests to Kube API Server\"\n        direction   = \"in\"\n        protocol    = \"tcp\"\n        port        = \"6443\"\n        source_ips  = var.firewall_kube_api_source\n      }\n    ],\n    !var.restrict_outbound_traffic ? [] : [\n      # Allow basic out traffic\n      # ICMP to ping outside services\n      {\n        description     = \"Allow Outbound ICMP Ping Requests\"\n        direction       = \"out\"\n        protocol        = \"icmp\"\n        port            = \"\"\n        destination_ips = [\"0.0.0.0/0\", \"::/0\"]\n      },\n\n      # DNS\n      {\n        description     = \"Allow Outbound TCP DNS Requests\"\n        direction       = \"out\"\n        protocol        = \"tcp\"\n        port            = \"53\"\n        destination_ips = [\"0.0.0.0/0\", \"::/0\"]\n      },\n      {\n        description     = \"Allow Outbound UDP DNS Requests\"\n        direction       = \"out\"\n        protocol        = \"udp\"\n        port            = \"53\"\n        destination_ips = [\"0.0.0.0/0\", \"::/0\"]\n      },\n\n      # HTTP(s)\n      {\n        description     = \"Allow Outbound HTTP Requests\"\n        direction       = \"out\"\n        protocol        = \"tcp\"\n        port            = \"80\"\n        destination_ips = [\"0.0.0.0/0\", \"::/0\"]\n      },\n      {\n        description     = \"Allow Outbound HTTPS Requests\"\n        direction       = \"out\"\n        protocol        = \"tcp\"\n        port            = \"443\"\n        destination_ips = [\"0.0.0.0/0\", \"::/0\"]\n      },\n\n      #NTP\n      {\n        description     = \"Allow Outbound UDP NTP Requests\"\n        direction       = \"out\"\n        protocol        = \"udp\"\n        port            = \"123\"\n        destination_ips = [\"0.0.0.0/0\", \"::/0\"]\n      }\n    ],\n    !local.using_klipper_lb ? [] : [\n      # Allow incoming web traffic for single node clusters, because we are using k3s servicelb there,\n      # not an external load-balancer.\n      {\n        description = \"Allow Incoming HTTP Connections\"\n        direction   = \"in\"\n        protocol    = \"tcp\"\n        port        = \"80\"\n        source_ips  = [\"0.0.0.0/0\", \"::/0\"]\n      },\n      {\n        description = \"Allow Incoming HTTPS Connections\"\n        direction   = \"in\"\n        protocol    = \"tcp\"\n        port        = \"443\"\n        source_ips  = [\"0.0.0.0/0\", \"::/0\"]\n      }\n    ],\n    var.block_icmp_ping_in ? [] : [\n      {\n        description = \"Allow Incoming ICMP Ping Requests\"\n        direction   = \"in\"\n        protocol    = \"icmp\"\n        port        = \"\"\n        source_ips  = [\"0.0.0.0/0\", \"::/0\"]\n      }\n    ]\n  )\n\n  # create a new firewall list based on base_firewall_rules but with direction-protocol-port as key\n  # this is needed to avoid duplicate rules\n  firewall_rules = { for rule in local.base_firewall_rules : format(\"%s-%s-%s\", lookup(rule, \"direction\", \"null\"), lookup(rule, \"protocol\", \"null\"), lookup(rule, \"port\", \"null\")) => rule }\n\n  # do the same for var.extra_firewall_rules\n  extra_firewall_rules = { for rule in var.extra_firewall_rules : format(\"%s-%s-%s\", lookup(rule, \"direction\", \"null\"), lookup(rule, \"protocol\", \"null\"), lookup(rule, \"port\", \"null\")) => rule }\n\n  # merge the two lists\n  firewall_rules_merged = merge(local.firewall_rules, local.extra_firewall_rules)\n\n  # convert the merged list back to a list\n  firewall_rules_list = values(local.firewall_rules_merged)\n\n  labels = {\n    \"provisioner\" = \"terraform\",\n    \"engine\"      = \"k3s\"\n    \"cluster\"     = var.cluster_name\n  }\n\n  labels_control_plane_node = {\n    role = \"control_plane_node\"\n  }\n  labels_control_plane_lb = {\n    role = \"control_plane_lb\"\n  }\n\n  labels_agent_node = {\n    role = \"agent_node\"\n  }\n\n  cni_install_resources = {\n    \"calico\" = [\"https://raw.githubusercontent.com/projectcalico/calico/${coalesce(local.calico_version, \"v3.27.2\")}/manifests/calico.yaml\"]\n    \"cilium\" = [\"cilium.yaml\"]\n  }\n\n  prefer_bundled_bin_config = var.k3s_prefer_bundled_bin ? { \"prefer-bundled-bin\" = true } : {}\n\n  cni_install_resource_patches = {\n    \"calico\" = [\"calico.yaml\"]\n  }\n\n  cni_k3s_settings = {\n    \"flannel\" = {\n      disable-network-policy = var.disable_network_policy\n      flannel-backend        = var.enable_wireguard ? \"wireguard-native\" : \"vxlan\"\n    }\n    \"calico\" = {\n      disable-network-policy = true\n      flannel-backend        = \"none\"\n    }\n    \"cilium\" = {\n      disable-network-policy = true\n      flannel-backend        = \"none\"\n    }\n  }\n\n  etcd_s3_snapshots = length(keys(var.etcd_s3_backup)) > 0 ? merge(\n    {\n      \"etcd-s3\" = true\n    },\n  var.etcd_s3_backup) : {}\n\n  kubelet_arg                 = [\"cloud-provider=external\", \"volume-plugin-dir=/var/lib/kubelet/volumeplugins\"]\n  kube_controller_manager_arg = \"flex-volume-plugin-dir=/var/lib/kubelet/volumeplugins\"\n  flannel_iface               = \"eth1\"\n\n  kube_apiserver_arg = var.authentication_config != \"\" ? [\"authentication-config=/etc/rancher/k3s/authentication_config.yaml\"] : []\n\n  cilium_values = var.cilium_values != \"\" ? var.cilium_values : <<EOT\n# Enable Kubernetes host-scope IPAM mode (required for K3s + Hetzner CCM)\nipam:\n  mode: kubernetes\nk8s:\n  requireIPv4PodCIDR: true\n\n# Replace kube-proxy with Cilium\nkubeProxyReplacement: true\n%{if var.disable_kube_proxy}\n# Enable health check server (healthz) for the kube-proxy replacement\nkubeProxyReplacementHealthzBindAddr: \"0.0.0.0:10256\"\n%{endif~}\n\n# Access to Kube API Server (mandatory if kube-proxy is disabled)\nk8sServiceHost: \"127.0.0.1\"\nk8sServicePort: \"6444\"\n\n# Set Tunnel Mode or Native Routing Mode (supported by Hetzner CCM Route Controller)\nroutingMode: \"${var.cilium_routing_mode}\"\n%{if var.cilium_routing_mode == \"native\"~}\n# Set the native routable CIDR\nipv4NativeRoutingCIDR: \"${local.cilium_ipv4_native_routing_cidr}\"\n\n# Bypass iptables Connection Tracking for Pod traffic (only works in Native Routing Mode)\ninstallNoConntrackIptablesRules: true\n%{endif~}\n\n# Perform a gradual roll out on config update.\nrollOutCiliumPods: true\n\nendpointRoutes:\n  # Enable use of per endpoint routes instead of routing via the cilium_host interface.\n  enabled: true\n\nloadBalancer:\n  # Enable LoadBalancer & NodePort XDP Acceleration (direct routing (routingMode=native) is recommended to achieve optimal performance)\n  acceleration: native\n\nbpf:\n  # Enable eBPF-based Masquerading (\"The eBPF-based implementation is the most efficient implementation\")\n  masquerade: true\n%{if var.enable_wireguard}\nencryption:\n  enabled: true\n  # Enable node encryption for node-to-node traffic\n  nodeEncryption: true\n  type: wireguard\n%{endif~}\n%{if var.cilium_egress_gateway_enabled}\negressGateway:\n  enabled: true\n%{endif~}\n\n%{if var.cilium_hubble_enabled}\nhubble:\n  relay:\n    enabled: true\n  ui:\n    enabled: true\n  metrics:\n    enabled:\n%{for metric in var.cilium_hubble_metrics_enabled~}\n      - \"${metric}\"\n%{endfor~}\n%{endif~}\n\n\nMTU: 1450\n  EOT\n\n  # Not to be confused with the other helm values, this is used for the calico.yaml kustomize patch\n  # It also serves as a stub for a potential future use via helm values\n  calico_values = var.calico_values != \"\" ? var.calico_values : <<EOT\nkind: DaemonSet\napiVersion: apps/v1\nmetadata:\n  name: calico-node\n  namespace: kube-system\n  labels:\n    k8s-app: calico-node\nspec:\n  template:\n    spec:\n      volumes:\n        - name: flexvol-driver-host\n          hostPath:\n            type: DirectoryOrCreate\n            path: /var/lib/kubelet/volumeplugins/nodeagent~uds\n      containers:\n        - name: calico-node\n          env:\n            - name: CALICO_IPV4POOL_CIDR\n              value: \"${var.cluster_ipv4_cidr}\"\n            - name: FELIX_WIREGUARDENABLED\n              value: \"${var.enable_wireguard}\"\n\n  EOT\n\n  longhorn_values = var.longhorn_values != \"\" ? var.longhorn_values : <<EOT\ndefaultSettings:\n%{if length(var.autoscaler_nodepools) != 0~}\n  kubernetesClusterAutoscalerEnabled: true\n%{endif~}\n  defaultDataPath: /var/longhorn\npersistence:\n  defaultFsType: ${var.longhorn_fstype}\n  defaultClassReplicaCount: ${var.longhorn_replica_count}\n  %{if var.disable_hetzner_csi~}defaultClass: true%{else~}defaultClass: false%{endif~}\n  EOT\n\n  csi_driver_smb_values = var.csi_driver_smb_values != \"\" ? var.csi_driver_smb_values : <<EOT\n  EOT\n\n  hetzner_csi_values = var.hetzner_csi_values != \"\" ? var.hetzner_csi_values : (!local.allow_scheduling_on_control_plane ? <<-EOT\nnode:\n  affinity:\n    nodeAffinity:\n      requiredDuringSchedulingIgnoredDuringExecution:\n        nodeSelectorTerms:\n          - matchExpressions:\n              - key: \"node-role.kubernetes.io/control-plane\"\n                operator: DoesNotExist\nEOT\n  : \"\")\n\n  nginx_values = var.nginx_values != \"\" ? var.nginx_values : <<EOT\ncontroller:\n  watchIngressWithoutClass: \"true\"\n  kind: \"Deployment\"\n  replicaCount: ${local.ingress_replica_count}\n  config:\n    \"use-forwarded-headers\": \"true\"\n    \"compute-full-forwarded-for\": \"true\"\n    \"use-proxy-protocol\": \"${!local.using_klipper_lb}\"\n%{if !local.using_klipper_lb~}\n  service:\n    annotations:\n      \"load-balancer.hetzner.cloud/name\": \"${local.load_balancer_name}\"\n      \"load-balancer.hetzner.cloud/use-private-ip\": \"true\"\n      \"load-balancer.hetzner.cloud/disable-private-ingress\": \"true\"\n      \"load-balancer.hetzner.cloud/disable-public-network\": \"${var.load_balancer_disable_public_network}\"\n      \"load-balancer.hetzner.cloud/ipv6-disabled\": \"${var.load_balancer_disable_ipv6}\"\n      \"load-balancer.hetzner.cloud/location\": \"${var.load_balancer_location}\"\n      \"load-balancer.hetzner.cloud/type\": \"${var.load_balancer_type}\"\n      \"load-balancer.hetzner.cloud/uses-proxyprotocol\": \"${!local.using_klipper_lb}\"\n      \"load-balancer.hetzner.cloud/algorithm-type\": \"${var.load_balancer_algorithm_type}\"\n      \"load-balancer.hetzner.cloud/health-check-interval\": \"${var.load_balancer_health_check_interval}\"\n      \"load-balancer.hetzner.cloud/health-check-timeout\": \"${var.load_balancer_health_check_timeout}\"\n      \"load-balancer.hetzner.cloud/health-check-retries\": \"${var.load_balancer_health_check_retries}\"\n%{if var.lb_hostname != \"\"~}\n      \"load-balancer.hetzner.cloud/hostname\": \"${var.lb_hostname}\"\n%{endif~}\n%{endif~}\n  EOT\n\n  hetzner_ccm_values = var.hetzner_ccm_values != \"\" ? var.hetzner_ccm_values : <<EOT\nnetworking:\n  enabled: true\n  clusterCIDR: \"${var.cluster_ipv4_cidr}\"\nargs:\n  cloud-provider: hcloud\n  allow-untagged-cloud: \"\"\n  route-reconciliation-period: 30s\n  webhook-secure-port: \"0\"\n%{if local.using_klipper_lb~}\n  secure-port: \"10288\"\n%{endif~}\nenv:\n  HCLOUD_LOAD_BALANCERS_LOCATION:\n    value: \"${var.load_balancer_location}\"\n  HCLOUD_LOAD_BALANCERS_USE_PRIVATE_IP:\n    value: \"true\"\n  HCLOUD_LOAD_BALANCERS_ENABLED:\n    value: \"${!local.using_klipper_lb}\"\n  HCLOUD_LOAD_BALANCERS_DISABLE_PRIVATE_INGRESS:\n    value: \"true\"\n# Use host network to avoid circular dependency with CNI\nhostNetwork: true\n  EOT\n\n  haproxy_values = var.haproxy_values != \"\" ? var.haproxy_values : <<EOT\ncontroller:\n  kind: \"Deployment\"\n  replicaCount: ${local.ingress_replica_count}\n  ingressClass: null\n  resources:\n    requests:\n      cpu: \"${var.haproxy_requests_cpu}\"\n      memory: \"${var.haproxy_requests_memory}\"\n  config:\n    ssl-redirect: \"false\"\n    forwarded-for: \"true\"\n%{if !local.using_klipper_lb~}\n    proxy-protocol: \"${join(\n  \", \",\n  concat(\n    [\"127.0.0.1/32\", \"10.0.0.0/8\"],\n    var.haproxy_additional_proxy_protocol_ips\n  )\n)}\"\n%{endif~}\n  service:\n    type: LoadBalancer\n    enablePorts:\n      quic: false\n      stat: false\n      prometheus: false\n%{if !local.using_klipper_lb~}\n    annotations:\n      \"load-balancer.hetzner.cloud/name\": \"${local.load_balancer_name}\"\n      \"load-balancer.hetzner.cloud/use-private-ip\": \"true\"\n      \"load-balancer.hetzner.cloud/disable-private-ingress\": \"true\"\n      \"load-balancer.hetzner.cloud/disable-public-network\": \"${var.load_balancer_disable_public_network}\"\n      \"load-balancer.hetzner.cloud/ipv6-disabled\": \"${var.load_balancer_disable_ipv6}\"\n      \"load-balancer.hetzner.cloud/location\": \"${var.load_balancer_location}\"\n      \"load-balancer.hetzner.cloud/type\": \"${var.load_balancer_type}\"\n      \"load-balancer.hetzner.cloud/uses-proxyprotocol\": \"${!local.using_klipper_lb}\"\n      \"load-balancer.hetzner.cloud/algorithm-type\": \"${var.load_balancer_algorithm_type}\"\n      \"load-balancer.hetzner.cloud/health-check-interval\": \"${var.load_balancer_health_check_interval}\"\n      \"load-balancer.hetzner.cloud/health-check-timeout\": \"${var.load_balancer_health_check_timeout}\"\n      \"load-balancer.hetzner.cloud/health-check-retries\": \"${var.load_balancer_health_check_retries}\"\n%{if var.lb_hostname != \"\"~}\n      \"load-balancer.hetzner.cloud/hostname\": \"${var.lb_hostname}\"\n%{endif~}\n%{endif~}\n  EOT\n\ntraefik_values = var.traefik_values != \"\" ? var.traefik_values : <<EOT\nimage:\n  tag: ${var.traefik_image_tag}\ndeployment:\n  replicas: ${local.ingress_replica_count}\nglobalArguments: []\nservice:\n  enabled: true\n  type: LoadBalancer\n%{if !local.using_klipper_lb~}\n  annotations:\n    \"load-balancer.hetzner.cloud/name\": \"${local.load_balancer_name}\"\n    \"load-balancer.hetzner.cloud/use-private-ip\": \"true\"\n    \"load-balancer.hetzner.cloud/disable-private-ingress\": \"true\"\n    \"load-balancer.hetzner.cloud/disable-public-network\": \"${var.load_balancer_disable_public_network}\"\n    \"load-balancer.hetzner.cloud/ipv6-disabled\": \"${var.load_balancer_disable_ipv6}\"\n    \"load-balancer.hetzner.cloud/location\": \"${var.load_balancer_location}\"\n    \"load-balancer.hetzner.cloud/type\": \"${var.load_balancer_type}\"\n    \"load-balancer.hetzner.cloud/uses-proxyprotocol\": \"${!local.using_klipper_lb}\"\n    \"load-balancer.hetzner.cloud/algorithm-type\": \"${var.load_balancer_algorithm_type}\"\n    \"load-balancer.hetzner.cloud/health-check-interval\": \"${var.load_balancer_health_check_interval}\"\n    \"load-balancer.hetzner.cloud/health-check-timeout\": \"${var.load_balancer_health_check_timeout}\"\n    \"load-balancer.hetzner.cloud/health-check-retries\": \"${var.load_balancer_health_check_retries}\"\n%{if var.lb_hostname != \"\"~}\n    \"load-balancer.hetzner.cloud/hostname\": \"${var.lb_hostname}\"\n%{endif~}\n%{endif~}\nports:\n%{if var.traefik_redirect_to_https || !local.using_klipper_lb~}\n  web:\n%{if var.traefik_redirect_to_https~}\n    redirections:\n      entryPoint:\n        to: websecure\n        scheme: https\n        permanent: true\n%{endif~}\n%{if !local.using_klipper_lb~}\n    proxyProtocol:\n      trustedIPs:\n        - 127.0.0.1/32\n        - 10.0.0.0/8\n%{for ip in var.traefik_additional_trusted_ips~}\n        - \"${ip}\"\n%{endfor~}\n    forwardedHeaders:\n      trustedIPs:\n        - 127.0.0.1/32\n        - 10.0.0.0/8\n%{for ip in var.traefik_additional_trusted_ips~}\n        - \"${ip}\"\n%{endfor~}\n%{endif~}\n%{endif~}\n%{if !local.using_klipper_lb~}\n  websecure:\n    proxyProtocol:\n      trustedIPs:\n        - 127.0.0.1/32\n        - 10.0.0.0/8\n%{for ip in var.traefik_additional_trusted_ips~}\n        - \"${ip}\"\n%{endfor~}\n    forwardedHeaders:\n      trustedIPs:\n        - 127.0.0.1/32\n        - 10.0.0.0/8\n%{for ip in var.traefik_additional_trusted_ips~}\n        - \"${ip}\"\n%{endfor~}\n%{endif~}\n%{if var.traefik_additional_ports != \"\"~}\n%{for option in var.traefik_additional_ports~}\n  ${option.name}:\n    port: ${option.port}\n    expose:\n      default: true\n    exposedPort: ${option.exposedPort}\n    protocol: TCP\n%{if !local.using_klipper_lb~}\n    proxyProtocol:\n      trustedIPs:\n        - 127.0.0.1/32\n        - 10.0.0.0/8\n%{for ip in var.traefik_additional_trusted_ips~}\n        - \"${ip}\"\n%{endfor~}\n    forwardedHeaders:\n      trustedIPs:\n        - 127.0.0.1/32\n        - 10.0.0.0/8\n%{for ip in var.traefik_additional_trusted_ips~}\n        - \"${ip}\"\n%{endfor~}\n%{endif~}\n%{endfor~}\n%{endif~}\n%{if var.traefik_pod_disruption_budget~}\npodDisruptionBudget:\n  enabled: true\n  maxUnavailable: 33%\n%{endif~}\n%{if var.traefik_provider_kubernetes_gateway_enabled~}\nproviders:\n  kubernetesGateway:\n    enabled: true\n%{endif~}\nadditionalArguments:\n  - \"--providers.kubernetesingress.ingressendpoint.publishedservice=${local.ingress_controller_namespace}/traefik\"\n%{for option in var.traefik_additional_options~}\n  - \"${option}\"\n%{endfor~}\n%{if var.traefik_resource_limits~}\nresources:\n  requests:\n    cpu: \"${var.traefik_resource_values.requests.cpu}\"\n    memory: \"${var.traefik_resource_values.requests.memory}\"\n  limits:\n    cpu: \"${var.traefik_resource_values.limits.cpu}\"\n    memory: \"${var.traefik_resource_values.limits.memory}\"\n%{endif~}\n%{if var.traefik_autoscaling~}\nautoscaling:\n  enabled: true\n  minReplicas: ${local.ingress_replica_count}\n  maxReplicas: ${local.ingress_max_replica_count}\n%{endif~}\n  EOT\n\nrancher_values = var.rancher_values != \"\" ? var.rancher_values : <<EOT\nhostname: \"${var.rancher_hostname != \"\" ? var.rancher_hostname : var.lb_hostname}\"\nreplicas: ${length(local.control_plane_nodes)}\nbootstrapPassword: \"${length(var.rancher_bootstrap_password) == 0 ? resource.random_password.rancher_bootstrap[0].result : var.rancher_bootstrap_password}\"\nglobal:\n  cattle:\n    psp:\n      enabled: false\n  EOT\n\ncert_manager_values = var.cert_manager_values != \"\" ? var.cert_manager_values : <<EOT\ncrds:\n  enabled: true\n  keep: true\n%{if var.traefik_provider_kubernetes_gateway_enabled~}\nconfig:\n  apiVersion: controller.config.cert-manager.io/v1alpha1\n  kind: ControllerConfiguration\n  enableGatewayAPI: true\n%{endif~}\n%{if var.ingress_controller == \"nginx\"~}\nextraArgs:\n  - --feature-gates=ACMEHTTP01IngressPathTypeExact=false\n%{endif~}\n  EOT\n\nkured_options = merge({\n  \"reboot-command\" : \"/usr/bin/systemctl reboot\",\n  \"pre-reboot-node-labels\" : \"kured=rebooting\",\n  \"post-reboot-node-labels\" : \"kured=done\",\n  \"period\" : \"5m\",\n  \"reboot-sentinel\" : \"/sentinel/reboot-required\"\n}, var.kured_options)\n\nk3s_registries_update_script = <<EOF\nDATE=`date +%Y-%m-%d_%H-%M-%S`\nif cmp -s /tmp/registries.yaml /etc/rancher/k3s/registries.yaml; then\n  echo \"No update required to the registries.yaml file\"\nelse\n  echo \"Backing up /etc/rancher/k3s/registries.yaml to /tmp/registries_$DATE.yaml\"\n  cp /etc/rancher/k3s/registries.yaml /tmp/registries_$DATE.yaml\n  echo \"Updated registries.yaml detected, restart of k3s service required\"\n  cp /tmp/registries.yaml /etc/rancher/k3s/registries.yaml\n  if systemctl is-active --quiet k3s; then\n    systemctl restart k3s || (echo \"Error: Failed to restart k3s. Restoring /etc/rancher/k3s/registries.yaml from backup\" && cp /tmp/registries_$DATE.yaml /etc/rancher/k3s/registries.yaml && systemctl restart k3s)\n  elif systemctl is-active --quiet k3s-agent; then\n    systemctl restart k3s-agent || (echo \"Error: Failed to restart k3s-agent. Restoring /etc/rancher/k3s/registries.yaml from backup\" && cp /tmp/registries_$DATE.yaml /etc/rancher/k3s/registries.yaml && systemctl restart k3s-agent)\n  else\n    echo \"No active k3s or k3s-agent service found\"\n  fi\n  echo \"k3s service or k3s-agent service restarted successfully\"\nfi\nEOF\n\nk3s_config_update_script = <<EOF\nDATE=`date +%Y-%m-%d_%H-%M-%S`\nif cmp -s /tmp/config.yaml /etc/rancher/k3s/config.yaml; then\n  echo \"No update required to the config.yaml file\"\nelse\n  if [ -f \"/etc/rancher/k3s/config.yaml\" ]; then\n    echo \"Backing up /etc/rancher/k3s/config.yaml to /tmp/config_$DATE.yaml\"\n    cp /etc/rancher/k3s/config.yaml /tmp/config_$DATE.yaml\n  fi\n  echo \"Updated config.yaml detected, restart of k3s service required\"\n  cp /tmp/config.yaml /etc/rancher/k3s/config.yaml\n  if systemctl is-active --quiet k3s; then\n    systemctl restart k3s || (echo \"Error: Failed to restart k3s. Restoring /etc/rancher/k3s/config.yaml from backup\" && cp /tmp/config_$DATE.yaml /etc/rancher/k3s/config.yaml && systemctl restart k3s)\n  elif systemctl is-active --quiet k3s-agent; then\n    systemctl restart k3s-agent || (echo \"Error: Failed to restart k3s-agent. Restoring /etc/rancher/k3s/config.yaml from backup\" && cp /tmp/config_$DATE.yaml /etc/rancher/k3s/config.yaml && systemctl restart k3s-agent)\n  else\n    echo \"No active k3s or k3s-agent service found\"\n  fi\n  echo \"k3s service or k3s-agent service (re)started successfully\"\nfi\nEOF\n\nk3s_authentication_config_update_script = <<EOF\nDATE=`date +%Y-%m-%d_%H-%M-%S`\nif cmp -s /tmp/authentication_config.yaml /etc/rancher/k3s/authentication_config.yaml; then\n  echo \"No update required to the authentication_config.yaml file\"\nelse\n  if [ -f \"/etc/rancher/k3s/authentication_config.yaml\" ]; then\n    echo \"Backing up /etc/rancher/k3s/authentication_config.yaml to /tmp/authentication_config_$DATE.yaml\"\n    cp /etc/rancher/k3s/authentication_config.yaml /tmp/authentication_config_$DATE.yaml\n  fi\n  echo \"Updated authentication_config.yaml detected, restart of k3s service required\"\n  cp /tmp/authentication_config.yaml /etc/rancher/k3s/authentication_config.yaml\n  if systemctl is-active --quiet k3s; then\n    systemctl restart k3s || (echo \"Error: Failed to restart k3s. Restoring /etc/rancher/k3s/authentication_config.yaml from backup\" && cp /tmp/authentication_config_$DATE.yaml /etc/rancher/k3s/authentication_config.yaml && systemctl restart k3s)\n  elif systemctl is-active --quiet k3s-agent; then\n    systemctl restart k3s-agent || (echo \"Error: Failed to restart k3s-agent. Restoring /etc/rancher/k3s/authentication_config.yaml from backup\" && cp /tmp/authentication_config_$DATE.yaml /etc/rancher/k3s/authentication_config.yaml && systemctl restart k3s-agent)\n  else\n    echo \"No active k3s or k3s-agent service found\"\n  fi\n  echo \"k3s service or k3s-agent service (re)started successfully\"\nfi\nEOF\n\ncloudinit_write_files_common = <<EOT\n# Script to rename the private interface to eth1 and unify NetworkManager connection naming\n- path: /etc/cloud/rename_interface.sh\n  content: |\n    #!/bin/bash\n    set -euo pipefail\n\n    sleep 11\n\n    # Somehow sometimes on private-ip only setups, the \n    # interface may already be correctly names, and this\n    # block should be skipped.\n    if ! ip link show eth1 >/dev/null 2>&1; then\n      # Find the private network interface by name, falling back to original logic.\n      # The output of 'ip link show' is stored to avoid multiple calls.\n      # Use '|| true' to prevent grep from causing script failure when no matches found\n      IP_LINK_NO_FLANNEL=$(ip link show | grep -v 'flannel' || true)\n\n      # Try to find an interface with a predictable name, e.g., enp1s0\n      # Anchor pattern to second field to avoid false matches\n      INTERFACE=$(awk '$2 ~ /^enp[0-9]+s[0-9]+:$/{sub(/:/,\"\",$2); print $2; exit}' <<< \"$IP_LINK_NO_FLANNEL\")\n\n      # If no predictable name is found, use original logic as fallback\n      if [ -z \"$INTERFACE\" ]; then\n        INTERFACE=$(awk '/^3:/{p=$2} /^2:/{s=$2} END{iface=p?p:s; sub(/:/,\"\",iface); print iface}' <<< \"$IP_LINK_NO_FLANNEL\")\n      fi\n\n      # Ensure an interface was found\n      if [ -z \"$INTERFACE\" ]; then\n        echo \"ERROR: Failed to detect network interface for renaming to eth1\" >&2\n        echo \"Available interfaces:\" >&2\n        echo \"$IP_LINK_NO_FLANNEL\" >&2\n        exit 1\n      fi\n\n      MAC=$(cat \"/sys/class/net/$INTERFACE/address\")\n\n      cat <<EOF > /etc/udev/rules.d/70-persistent-net.rules\n      SUBSYSTEM==\"net\", ACTION==\"add\", DRIVERS==\"?*\", ATTR{address}==\"$MAC\", NAME=\"eth1\"\n    EOF\n\n      ip link set $INTERFACE down\n      ip link set $INTERFACE name eth1\n      ip link set eth1 up\n    fi\n\n    myrepeat () {\n        # Current time + 300 seconds (5 minutes)\n        local END_SECONDS=$((SECONDS + 300))\n        while true; do\n            >&2 echo \"loop\"\n            if (( \"$SECONDS\" > \"$END_SECONDS\" )); then\n                >&2 echo \"timeout reached\"\n                exit 1\n            fi\n            # run command and check return code\n            if $@ ; then\n                >&2 echo \"break\"\n                break\n            else\n                >&2 echo \"got failure exit code, repeating\"\n                sleep 0.5\n            fi\n        done\n    }\n\n    myrename () {\n        local eth=\"$1\"\n        local eth_connection\n\n        # In case of a private-only network, eth0 may not exist\n        if ip link show \"$eth\" &>/dev/null; then\n            eth_connection=$(nmcli -g GENERAL.CONNECTION device show \"$eth\" || echo '')\n            nmcli connection modify \"$eth_connection\" \\\n              con-name \"$eth\" \\\n              connection.interface-name \"$eth\"\n        fi\n    }\n\n    myrepeat myrename eth0\n    myrepeat myrename eth1\n\n    systemctl restart NetworkManager\n  permissions: \"0744\"\n\n# Disable ssh password authentication\n- content: |\n    Port ${var.ssh_port}\n    PasswordAuthentication no\n    X11Forwarding no\n    MaxAuthTries ${var.ssh_max_auth_tries}\n    AllowTcpForwarding no\n    AllowAgentForwarding no\n    AuthorizedKeysFile .ssh/authorized_keys\n  path: /etc/ssh/sshd_config.d/kube-hetzner.conf\n\n# Set reboot method as \"kured\"\n- content: |\n    REBOOT_METHOD=kured\n  path: /etc/transactional-update.conf\n\n# Create Rancher repo config\n- content: |\n    [rancher-k3s-common-stable]\n    name=Rancher K3s Common (stable)\n    baseurl=https://rpm.rancher.io/k3s/stable/common/microos/noarch\n    enabled=1\n    gpgcheck=1\n    repo_gpgcheck=0\n    gpgkey=https://rpm.rancher.io/public.key\n  path: /etc/zypp/repos.d/rancher-k3s-common.repo\n\n# Create the kube_hetzner_selinux.te file, that allows in SELinux to not interfere with various needed services\n- path: /root/kube_hetzner_selinux.te\n  content: |\n    module kube_hetzner_selinux 1.0;\n\n    require {\n        type kernel_t, bin_t, kernel_generic_helper_t, iscsid_t, iscsid_exec_t, var_run_t, var_lib_t,\n            init_t, unlabeled_t, systemd_logind_t, systemd_hostnamed_t, container_t,\n            cert_t, container_var_lib_t, etc_t, usr_t, container_file_t, container_log_t,\n            container_share_t, container_runtime_exec_t, container_runtime_t, var_log_t, proc_t, io_uring_t, fuse_device_t, http_port_t,\n            container_var_run_t;\n        class key { read view };\n        class file { open read execute execute_no_trans create link lock rename write append setattr unlink getattr watch };\n        class sock_file { watch write create unlink };\n        class unix_dgram_socket create;\n        class unix_stream_socket { connectto read write };\n        class dir { add_name create getattr link lock read rename remove_name reparent rmdir setattr unlink search write watch };\n        class lnk_file { read create };\n        class system module_request;\n        class filesystem associate;\n        class bpf map_create;\n        class io_uring sqpoll;\n        class anon_inode { create map read write };\n        class tcp_socket name_connect;\n        class chr_file { open read write };\n    }\n\n    #============= kernel_generic_helper_t ==============\n    allow kernel_generic_helper_t bin_t:file execute_no_trans;\n    allow kernel_generic_helper_t kernel_t:key { read view };\n    allow kernel_generic_helper_t self:unix_dgram_socket create;\n\n    #============= iscsid_t ==============\n    allow iscsid_t iscsid_exec_t:file execute;\n    allow iscsid_t var_run_t:sock_file write;\n    allow iscsid_t var_run_t:unix_stream_socket connectto;\n\n    #============= init_t ==============\n    allow init_t unlabeled_t:dir { add_name remove_name rmdir search };\n    allow init_t unlabeled_t:lnk_file create;\n    allow init_t container_t:file { open read };\n    allow init_t container_file_t:file { execute execute_no_trans };\n    allow init_t fuse_device_t:chr_file { open read write };\n    allow init_t http_port_t:tcp_socket name_connect;\n\n    #============= systemd_logind_t ==============\n    allow systemd_logind_t unlabeled_t:dir search;\n\n    #============= systemd_hostnamed_t ==============\n    allow systemd_hostnamed_t unlabeled_t:dir search;\n\n    #============= container_t ==============\n    allow container_t { cert_t container_log_t }:dir read;\n    allow container_t { cert_t container_log_t }:lnk_file read;\n    allow container_t cert_t:file { read open };\n    allow container_t container_var_lib_t:dir { add_name remove_name write read create };\n    allow container_t container_var_lib_t:file { append create open read write rename lock setattr getattr unlink };\n    allow container_t etc_t:dir { add_name remove_name write create setattr watch };\n    allow container_t etc_t:file { create setattr unlink write };\n    allow container_t etc_t:sock_file { create unlink };\n    allow container_t usr_t:dir { add_name create getattr link lock read rename remove_name reparent rmdir setattr unlink search write };\n    allow container_t usr_t:file { append create execute getattr link lock read rename setattr unlink write };\n    allow container_t container_file_t:file { open read write append getattr setattr lock };\n    allow container_t container_file_t:sock_file watch;\n    allow container_t container_log_t:file { open read write append getattr setattr watch };\n    allow container_t container_share_t:dir { read write add_name remove_name };\n    allow container_t container_share_t:file { read write create unlink };\n    allow container_t container_runtime_exec_t:file { read execute execute_no_trans open };\n    allow container_t container_runtime_t:unix_stream_socket { connectto read write };\n    allow container_t kernel_t:system module_request;\n    allow container_t var_log_t:dir { add_name write remove_name watch read };\n    allow container_t var_log_t:file { create lock open read setattr write unlink getattr };\n    allow container_t var_lib_t:dir { add_name remove_name write read create };\n    allow container_t var_lib_t:file { append create open read write rename lock setattr getattr unlink };\n    allow container_t proc_t:filesystem associate;\n    allow container_t self:bpf map_create;\n    allow container_t self:io_uring sqpoll;\n    allow container_t io_uring_t:anon_inode { create map read write };\n    allow container_t container_var_run_t:dir { add_name remove_name write };\n    allow container_t container_var_run_t:file { create open read rename unlink write };\n\n# Create the k3s registries file if needed\n%{if var.k3s_registries != \"\"}\n# Create k3s registries file\n- content: ${base64encode(var.k3s_registries)}\n  encoding: base64\n  path: /etc/rancher/k3s/registries.yaml\n%{endif}\nEOT\n\ncloudinit_runcmd_common = <<EOT\n# ensure that /var uses full available disk size, thanks to btrfs this is easy\n- [btrfs, 'filesystem', 'resize', 'max', '/var']\n\n# SELinux permission for the SSH alternative port\n%{if var.ssh_port != 22}\n# SELinux permission for the SSH alternative port.\n- [semanage, port, '-a', '-t', ssh_port_t, '-p', tcp, '${var.ssh_port}']\n%{endif}\n\n# Create and apply the necessary SELinux module for kube-hetzner\n- [checkmodule, '-M', '-m', '-o', '/root/kube_hetzner_selinux.mod', '/root/kube_hetzner_selinux.te']\n- ['semodule_package', '-o', '/root/kube_hetzner_selinux.pp', '-m', '/root/kube_hetzner_selinux.mod']\n- [semodule, '-i', '/root/kube_hetzner_selinux.pp']\n- [setsebool, '-P', 'virt_use_samba', '1']\n- [setsebool, '-P', 'domain_kernel_load_modules', '1']\n\n# Disable rebootmgr service as we use kured instead\n- [systemctl, disable, '--now', 'rebootmgr.service']\n\n# Bounds the amount of logs that can survive on the system\n- [sed, '-i', 's/#SystemMaxUse=/SystemMaxUse=3G/g', /etc/systemd/journald.conf]\n- [sed, '-i', 's/#MaxRetentionSec=/MaxRetentionSec=1week/g', /etc/systemd/journald.conf]\n\n# Reduces the default number of snapshots from 2-10 number limit, to 4 and from 4-10 number limit important, to 2\n- [sed, '-i', 's/NUMBER_LIMIT=\"2-10\"/NUMBER_LIMIT=\"4\"/g', /etc/snapper/configs/root]\n- [sed, '-i', 's/NUMBER_LIMIT_IMPORTANT=\"4-10\"/NUMBER_LIMIT_IMPORTANT=\"3\"/g', /etc/snapper/configs/root]\n\n# Allow network interface\n- [chmod, '+x', '/etc/cloud/rename_interface.sh']\n\n# Restart the sshd service to apply the new config\n- [systemctl, 'restart', 'sshd']\n\n# Make sure the network is up\n- [systemctl, restart, NetworkManager]\n- [systemctl, status, NetworkManager]\n\n# Cleanup some logs\n- [truncate, '-s', '0', '/var/log/audit/audit.log']\n\n# Add logic to truly disable SELinux if disable_selinux = true.\n# We'll do it by appending to cloudinit_runcmd_common.\n%{if var.disable_selinux}\n- [sed, '-i', '-E', 's/^SELINUX=[a-z]+/SELINUX=disabled/', '/etc/selinux/config']\n- [setenforce, '0']\n%{endif}\n\nEOT\n\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mysticaltech__terraform-hcloud-kube-hetzner__locals.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mysticaltech__terraform-hcloud-kube-hetzner__locals.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mysticaltech__terraform-hcloud-kube-hetzner__locals.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n    region = \"us-east-1\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TerraWeek__day04__backend_infra__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.aws_region\n}\n\nresource \"random_string\" \"vm-login-password\" {\n  length  = 16\n  special = false\n}\n\nresource \"random_string\" \"security-encryption-key\" {\n  length  = 32\n  special = false\n}\nresource \"random_string\" \"reporting-encryption-key\" {\n  length  = 32\n  special = false\n}\n\nlocals {\n\n  all_availability_zones = compact(tolist(setunion(\n    keys(var.masters_count),\n    keys(var.datas_count),\n    keys(var.clients_count),\n    keys(var.data_voters_count),\n    toset([var.singlenode_az])\n  )))\n\n  cluster_subnet_ids = {\n    for i, az in local.all_availability_zones : az => lookup(var.cluster_subnet_ids, az, element(data.aws_subnets.subnets-per-az.*.ids, i))\n  }\n\n  clients_subnet_ids = {\n    for i, az in local.all_availability_zones : az => lookup(var.clients_subnet_ids, az, element(data.aws_subnets.subnets-per-az.*.ids, i))\n  }\n\n  flat_cluster_subnet_ids = flatten(values(local.cluster_subnet_ids))\n  flat_clients_subnet_ids = flatten(values(local.clients_subnet_ids))\n\n  bootstrap_node_subnet_id = var.bootstrap_node_subnet_id != \"\" ? var.bootstrap_node_subnet_id : coalescelist(local.flat_cluster_subnet_ids, [\"\"])[0]\n\n  singlenode_mode      = (length(keys(var.masters_count)) + length(keys(var.datas_count)) + length(keys(var.data_voters_count)) + length(keys(var.clients_count))) == 0\n  singlenode_subnet_id = local.singlenode_mode ? local.cluster_subnet_ids[var.singlenode_az][0] : \"\"\n\n  masters_count = local.singlenode_mode ? 0 : sum(concat(values(var.masters_count), values(var.data_voters_count)))\n  is_cluster_bootstrapped = data.local_file.cluster_bootstrap_state.content == \"1\" || !var.requires_bootstrapping\n\n  user_data_common = {\n    cloud_provider           = \"aws\"\n    elasticsearch_data_dir   = var.elasticsearch_data_dir\n    elasticsearch_logs_dir   = var.elasticsearch_logs_dir\n    es_cluster               = var.es_cluster\n    es_environment           = \"${var.environment}-${var.es_cluster}\"\n    security_groups          = aws_security_group.elasticsearch_security_group.id\n    aws_region               = var.aws_region\n    security_enabled         = var.security_enabled\n    monitoring_enabled       = var.monitoring_enabled\n    masters_count            = local.masters_count\n    client_user              = var.client_user\n    xpack_monitoring_host    = var.xpack_monitoring_host\n    filebeat_monitoring_host = var.filebeat_monitoring_host\n    s3_backup_bucket         = var.s3_backup_bucket\n    use_g1gc                 = var.use_g1gc\n    client_pwd               = random_string.vm-login-password.result\n    master                   = false\n    data                     = false\n    bootstrap_node           = false\n    log_level                = var.log_level\n    log_size                 = var.log_size\n    is_voting_only           = false\n\n    ca_cert   = var.security_enabled ? join(\"\", tls_self_signed_cert.ca[*].cert_pem) : \"\"\n    node_cert = var.security_enabled ? join(\"\", tls_locally_signed_cert.node[*].cert_pem) : \"\"\n    node_key  = var.security_enabled ? join(\"\", tls_private_key.node[*].private_key_pem) : \"\"\n\n    DEV_MODE_scripts_s3_bucket = var.DEV_MODE_scripts_s3_bucket\n\n    security_encryption_key               = random_string.security-encryption-key.result\n    reporting_encryption_key              = random_string.reporting-encryption-key.result\n    auto_shut_down_bootstrap_node = var.auto_shut_down_bootstrap_node\n  }\n}\n\n##############################################################################\n# Elasticsearch\n##############################################################################\n\nresource \"aws_security_group\" \"elasticsearch_security_group\" {\n  name        = \"elasticsearch-${var.es_cluster}-security-group\"\n  description = \"Elasticsearch ports with ssh\"\n  vpc_id      = var.vpc_id\n\n  tags = {\n    Name    = \"${var.es_cluster}-elasticsearch\"\n    cluster = var.es_cluster\n  }\n\n  # ssh access from everywhere\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  # inter-cluster communication over ports 9200-9400\n  ingress {\n    from_port = 9200\n    to_port   = 9400\n    protocol  = \"tcp\"\n    self      = true\n  }\n\n  # allow inter-cluster ping\n  ingress {\n    from_port = 8\n    to_port   = 0\n    protocol  = \"icmp\"\n    self      = true\n  }\n\n  # allow alb sg access\n  ingress {\n    from_port       = 9200\n    to_port         = 9200\n    protocol        = \"tcp\"\n    security_groups = [aws_security_group.elasticsearch-alb-sg.id]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\nresource \"aws_security_group\" \"elasticsearch_clients_security_group\" {\n  name        = \"elasticsearch-${var.es_cluster}-clients-security-group\"\n  description = \"Kibana HTTP access from outside\"\n  vpc_id      = var.vpc_id\n\n  tags = {\n    Name    = \"${var.es_cluster}-kibana\"\n    cluster = var.es_cluster\n  }\n\n  # allow alb sg access\n  ingress {\n    from_port       = 9200\n    to_port         = 9200\n    protocol        = \"tcp\"\n    security_groups = [aws_security_group.elasticsearch-alb-sg.id]\n  }\n  ingress {\n    from_port       = 5601\n    to_port         = 5601\n    protocol        = \"tcp\"\n    security_groups = [aws_security_group.elasticsearch-alb-sg.id]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__main.tf", "start_line": 88}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__main.tf", "start_line": 88}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__main.tf", "start_line": 88}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__main.tf", "start_line": 138}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__main.tf", "start_line": 138}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__main.tf", "start_line": 88}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__main.tf", "start_line": 138}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\noutput \"names\" {\n  description = \"Bucket names.\"\n  value       = module.cloud_storage.names\n}\n\noutput \"names_list\" {\n  description = \"List of bucket names.\"\n  value       = module.cloud_storage.names_list\n}\n\noutput \"project_id\" {\n  description = \"The ID of the project in which resources are provisioned.\"\n  value       = var.project_id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-cloud-storage__examples__multiple_buckets__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"state_bucket\" {\n  description = \"The name of the S3 bucket to store the Terraform state file\"\n  type        = string\n  default     = \"terraform-state-devopsthehardway\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AdminTurnedDevOps__DevOps-The-Hard-Way-AWS__terraform-state-s3-bucket__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_internet_gateway\" \"dev-igw\" {\n    vpc_id = \"${aws_vpc.dev-vpc.id}\"\n    tags = {\n        Name = \"dev-igw\"\n    }\n}\n\nresource \"aws_route_table\" \"dev-public-crt\" {\n    vpc_id = \"${aws_vpc.dev-vpc.id}\"\n\n    route {\n        //associated subnet can reach everywhere\n        cidr_block = \"0.0.0.0/0\"\n        //CRT uses this IGW to reach internet\n        gateway_id = \"${aws_internet_gateway.dev-igw.id}\"\n    }\n\n    tags = {\n        Name = \"dev-public-crt\"\n    }\n}\n\nresource \"aws_route_table_association\" \"dev-crta-public-subnet-1\"{\n    subnet_id = \"${aws_subnet.dev-subnet-public-1.id}\"\n    route_table_id = \"${aws_route_table.dev-public-crt.id}\"\n}\n\nresource \"aws_security_group\" \"ssh-allowed\" {\n    vpc_id = \"${aws_vpc.dev-vpc.id}\"\n\n    egress {\n        from_port = 0\n        to_port = 0\n        protocol = -1\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    ingress {\n        from_port = 22\n        to_port = 22\n        protocol = \"tcp\"\n        // This means, all ip address are allowed to ssh !\n        // Do not do it in the production.\n        // Put your office or home address in it!\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    //If you do not add this rule, you can not reach the NGIX\n    ingress {\n        from_port = 80\n        to_port = 80\n        protocol = \"tcp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    tags = {\n        Name = \"ssh-allowed\"\n    }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/praveen1994dec__Terraform_wc__network.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/praveen1994dec__Terraform_wc__network.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/praveen1994dec__Terraform_wc__network.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/praveen1994dec__Terraform_wc__network.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/praveen1994dec__Terraform_wc__network.tf", "start_line": 28}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  org = \"ap-medium\"\n  env = var.env\n}\n\nmodule \"eks\" {\n  source = \"../module\"\n\n  env                   = var.env\n  cluster-name          = \"${local.env}-${local.org}-${var.cluster-name}\"\n  cidr-block            = var.vpc-cidr-block\n  vpc-name              = \"${local.env}-${local.org}-${var.vpc-name}\"\n  igw-name              = \"${local.env}-${local.org}-${var.igw-name}\"\n  pub-subnet-count      = var.pub-subnet-count\n  pub-cidr-block        = var.pub-cidr-block\n  pub-availability-zone = var.pub-availability-zone\n  pub-sub-name          = \"${local.env}-${local.org}-${var.pub-sub-name}\"\n  pri-subnet-count      = var.pri-subnet-count\n  pri-cidr-block        = var.pri-cidr-block\n  pri-availability-zone = var.pri-availability-zone\n  pri-sub-name          = \"${local.env}-${local.org}-${var.pri-sub-name}\"\n  public-rt-name        = \"${local.env}-${local.org}-${var.public-rt-name}\"\n  private-rt-name       = \"${local.env}-${local.org}-${var.private-rt-name}\"\n  eip-name              = \"${local.env}-${local.org}-${var.eip-name}\"\n  ngw-name              = \"${local.env}-${local.org}-${var.ngw-name}\"\n  eks-sg                = var.eks-sg\n\n  is_eks_role_enabled           = true\n  is_eks_nodegroup_role_enabled = true\n  ondemand_instance_types       = var.ondemand_instance_types\n  spot_instance_types           = var.spot_instance_types\n  desired_capacity_on_demand    = var.desired_capacity_on_demand\n  min_capacity_on_demand        = var.min_capacity_on_demand\n  max_capacity_on_demand        = var.max_capacity_on_demand\n  desired_capacity_spot         = var.desired_capacity_spot\n  min_capacity_spot             = var.min_capacity_spot\n  max_capacity_spot             = var.max_capacity_spot\n  is-eks-cluster-enabled        = var.is-eks-cluster-enabled\n  cluster-version               = var.cluster-version\n  endpoint-private-access       = var.endpoint-private-access\n  endpoint-public-access        = var.endpoint-public-access\n\n  addons = var.addons\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__EKS-Terraform-GitHub-Actions__eks__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n    region = var.aws_region\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"dynamic_keyvault_secrets\" {\n  source  = \"aztfmod/caf/azurerm//modules/security/dynamic_keyvault_secrets\"\n  version = \"5.7.11\"\n\n  for_each = {\n    for keyvault_key, secrets in try(var.dynamic_keyvault_secrets, {}) : keyvault_key => {\n      for key, value in secrets : key => value\n      if try(value.value, null) == null\n    }\n  }\n\n  settings = each.value\n  keyvault = module.solution.keyvaults[each.key]\n  objects  = module.solution\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__caf-terraform-landingzones__caf_solution__dynamic_secrets.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__caf-terraform-landingzones__caf_solution__dynamic_secrets.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"vpc_id\" {\n  description = \"Existing VPC to use (specify this, if you don't want to create new VPC)\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"cidr\" {\n  description = \"The CIDR block for the VPC. Default value is a valid CIDR, but not acceptable by AWS and should be overriden\"\n  type        = string\n  default     = \"0.0.0.0/0\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices__examples__small-terraform__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"keycloak_realm\" \"source_realm\" {\n  realm   = \"source_realm\"\n  enabled = true\n}\n\nresource \"keycloak_openid_client\" \"destination_client\" {\n  realm_id                 = keycloak_realm.source_realm.id\n  name                     = \"destination_client\"\n  client_id                = \"destination_client\"\n  client_secret            = \"secret\"\n  description              = \"a client used by the destination realm\"\n  access_type              = \"CONFIDENTIAL\"\n  standard_flow_enabled    = true\n  valid_redirect_uris = [\n    \"http://localhost:8080/*\",\n  ]\n}\n\n//do not get confused this just to have multiple federate idps on the destination realm\nresource \"keycloak_openid_client\" \"destination_double_client\" {\n  realm_id                 = keycloak_realm.source_realm.id\n  name                     = \"destination_double_client\"\n  client_id                = \"destination_double_client\"\n  client_secret            = \"secret2\"\n  description              = \"a second client used by the destination realm\"\n  access_type              = \"CONFIDENTIAL\"\n  standard_flow_enabled    = true\n  valid_redirect_uris = [\n    \"http://localhost:8080/*\",\n  ]\n}\n\nresource \"keycloak_user\" \"source_user\" {\n  realm_id   = keycloak_realm.source_realm.id\n  username   = \"source\"\n  email      = \"source@fakedomain.com\"\n  first_name = \"source\"\n  last_name  = \"source\"\n  initial_password {\n    value     = \"source\"\n    temporary = false\n  }\n}\n\nresource \"keycloak_realm\" \"destination_realm\" {\n  realm   = \"destination_realm\"\n  enabled = true\n}\n\nresource keycloak_oidc_identity_provider source_oidc_idp {\n  realm              = keycloak_realm.destination_realm.id\n  alias              = \"source\"\n  authorization_url  = \"http://localhost:8080/auth/realms/${keycloak_realm.source_realm.id}/protocol/openid-connect/auth\"\n  token_url          = \"http://localhost:8080/auth/realms/${keycloak_realm.source_realm.id}/protocol/openid-connect/token\"\n  user_info_url      = \"http://localhost:8080/auth/realms/${keycloak_realm.source_realm.id}/protocol/openid-connect/userinfo\"\n  jwks_url           = \"http://localhost:8080/auth/realms/${keycloak_realm.source_realm.id}/protocol/openid-connect/certs\"\n  validate_signature = true\n  client_id          = keycloak_openid_client.destination_client.client_id\n  client_secret      = keycloak_openid_client.destination_client.client_secret\n  default_scopes     = \"openid\"\n}\n\n//do not get confused this second idp towards source_realm, this could a completly different idp\nresource keycloak_oidc_identity_provider second_source_oidc_idp {\n  realm              = keycloak_realm.destination_realm.id\n  alias              = \"source2\"\n  authorization_url  = \"http://localhost:8080/auth/realms/${keycloak_realm.source_realm.id}/protocol/openid-connect/auth\"\n  token_url          = \"http://localhost:8080/auth/realms/${keycloak_realm.source_realm.id}/protocol/openid-connect/token\"\n  user_info_url      = \"http://localhost:8080/auth/realms/${keycloak_realm.source_realm.id}/protocol/openid-connect/userinfo\"\n  jwks_url           = \"http://localhost:8080/auth/realms/${keycloak_realm.source_realm.id}/protocol/openid-connect/certs\"\n  validate_signature = true\n  client_id          = keycloak_openid_client.destination_double_client.client_id\n  client_secret      = keycloak_openid_client.destination_double_client.client_secret\n  default_scopes     = \"openid\"\n}\n\nresource \"keycloak_user\" \"destination_user\" {\n  realm_id   = keycloak_realm.destination_realm.id\n  username   = \"my_destination_username\"\n  email      = \"source@otherdomain.be\"\n  first_name = \"Destination_source\"\n  last_name  = \"Destination_source\"\n  //federated link through source idp\n  federated_identity {\n    identity_provider = keycloak_oidc_identity_provider.source_oidc_idp.alias\n    user_id           = keycloak_user.source_user.id\n    user_name         = keycloak_user.source_user.username\n  }\n  //federated link through second source idp\n  federated_identity {\n    identity_provider = keycloak_oidc_identity_provider.second_source_oidc_idp.alias\n    user_id           = keycloak_user.source_user.id\n    user_name         = keycloak_user.source_user.username\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keycloak__terraform-provider-keycloak__example__federated_user_example.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"ap-south-1\"\n}\n\ndata \"aws_eks_cluster\" \"cluster\" {\n  name = module.eks.cluster_id\n}\n\ndata \"aws_eks_cluster_auth\" \"cluster\" {\n  name = module.eks.cluster_id\n}\n\ndata \"aws_availability_zones\" \"available\" {}\n\nvariable \"cluster_name\" {\n  default = \"learnk8s\"\n}\n\nvariable \"instance_type\" {\n  default = \"m5.large\"\n}\n\nprovider \"kubernetes\" {\n  host                   = data.aws_eks_cluster.cluster.endpoint\n  cluster_ca_certificate = base64decode(data.aws_eks_cluster.cluster.certificate_authority.0.data)\n  token                  = data.aws_eks_cluster_auth.cluster.token\n\n}\n\nmodule \"eks-kubeconfig\" {\n  source     = \"hyperbadger/eks-kubeconfig/aws\"\n  version    = \"1.0.0\"\n\n  depends_on = [module.eks]\n  cluster_id =  module.eks.cluster_id\n  }\n\nresource \"local_file\" \"kubeconfig\" {\n  content  = module.eks-kubeconfig.kubeconfig\n  filename = \"kubeconfig_${var.cluster_name}\"\n}\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"3.18.1\"\n\n  name                 = \"k8s-${var.cluster_name}-vpc\"\n  cidr                 = \"172.16.0.0/16\"\n  azs                  = data.aws_availability_zones.available.names\n  private_subnets      = [\"172.16.1.0/24\", \"172.16.2.0/24\", \"172.16.3.0/24\"]\n  public_subnets       = [\"172.16.4.0/24\", \"172.16.5.0/24\", \"172.16.6.0/24\"]\n  enable_nat_gateway   = true\n  single_nat_gateway   = true\n  enable_dns_hostnames = true\n\n  public_subnet_tags = {\n    \"kubernetes.io/cluster/${var.cluster_name}\" = \"shared\"\n    \"kubernetes.io/role/elb\"                    = \"1\"\n  }\n\n  private_subnet_tags = {\n    \"kubernetes.io/cluster/${var.cluster_name}\" = \"shared\"\n    \"kubernetes.io/role/internal-elb\"           = \"1\"\n  }\n}\n\nmodule \"eks\" {\n  source  = \"terraform-aws-modules/eks/aws\"\n  version = \"18.30.3\"\n\n  cluster_name    = \"eks-${var.cluster_name}\"\n  cluster_version = \"1.24\"\n  subnet_ids        = module.vpc.private_subnets\n  vpc_id = module.vpc.vpc_id\n\n  eks_managed_node_groups = {\n    first = {\n      desired_capacity = 1\n      max_capacity     = 10\n      min_capacity     = 1\n\n      instance_type = var.instance_type\n    }\n  }\n  node_security_group_additional_rules = {\n    ingress_allow_access_from_control_plane = {\n      type                          = \"ingress\"\n      protocol                      = \"tcp\"\n      from_port                     = 9443\n      to_port                       = 9443\n      source_cluster_security_group = true\n      description                   = \"Allow access from control plane to webhook port of AWS load balancer controller\"\n    }\n  }\n}\n\nresource \"aws_iam_policy\" \"worker_policy\" {\n  name        = \"worker-policy-${var.cluster_name}\"\n  description = \"Worker policy for the ALB Ingress\"\n\n  policy = file(\"iam-policy.json\")\n}\n\nresource \"aws_iam_role_policy_attachment\" \"additional\" {\n  for_each = module.eks.eks_managed_node_groups\n\n  policy_arn = aws_iam_policy.worker_policy.arn\n  role       = each.value.iam_role_name\n}\n\nprovider \"helm\" {\n  kubernetes {\n    host                   = data.aws_eks_cluster.cluster.endpoint\n    cluster_ca_certificate = base64decode(data.aws_eks_cluster.cluster.certificate_authority.0.data)\n    token                  = data.aws_eks_cluster_auth.cluster.token\n    }\n}\n\nresource \"helm_release\" \"ingress\" {\n  name       = \"ingress\"\n  chart      = \"aws-load-balancer-controller\"\n  repository = \"https://aws.github.io/eks-charts\"\n  version    = \"1.4.6\"\n\n  set {\n    name  = \"autoDiscoverAwsRegion\"\n    value = \"true\"\n  }\n  set {\n    name  = \"autoDiscoverAwsVpcID\"\n    value = \"true\"\n  }\n  set {\n    name  = \"clusterName\"\n    value = var.cluster_name\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__06_terraform_envs_customised__cluster__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__06_terraform_envs_customised__cluster__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__06_terraform_envs_customised__cluster__main.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__06_terraform_envs_customised__cluster__main.tf", "start_line": 67}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\noutput \"cluster_dns_service_ip\" {\n  value = cidrhost(var.service_cidr, 10)\n}\n\n// Generated kubeconfig for Kubelets (i.e. lower privilege than admin)\noutput \"kubeconfig-kubelet\" {\n  value     = local.kubeconfig-bootstrap\n  sensitive = true\n}\n\n// Generated kubeconfig for admins (i.e. human super-user)\noutput \"kubeconfig-admin\" {\n  value     = local.kubeconfig-admin\n  sensitive = true\n}\n\n# assets to distribute to controllers\n# { some/path => content }\noutput \"assets_dist\" {\n  # combine maps of assets\n  value = merge(\n    local.auth_kubeconfigs,\n    local.etcd_tls,\n    local.kubernetes_tls,\n    local.aggregation_tls,\n    local.static_manifests,\n    local.manifests,\n    local.flannel_manifests,\n    local.cilium_manifests,\n  )\n  sensitive = true\n}\n\n# etcd TLS assets\n\noutput \"etcd_ca_cert\" {\n  value     = tls_self_signed_cert.etcd-ca.cert_pem\n  sensitive = true\n}\n\noutput \"etcd_client_cert\" {\n  value     = tls_locally_signed_cert.client.cert_pem\n  sensitive = true\n}\n\noutput \"etcd_client_key\" {\n  value     = tls_private_key.client.private_key_pem\n  sensitive = true\n}\n\noutput \"etcd_server_cert\" {\n  value     = tls_locally_signed_cert.server.cert_pem\n  sensitive = true\n}\n\noutput \"etcd_server_key\" {\n  value     = tls_private_key.server.private_key_pem\n  sensitive = true\n}\n\noutput \"etcd_peer_cert\" {\n  value     = tls_locally_signed_cert.peer.cert_pem\n  sensitive = true\n}\n\noutput \"etcd_peer_key\" {\n  value     = tls_private_key.peer.private_key_pem\n  sensitive = true\n}\n\n# Kubernetes TLS assets\n\noutput \"service_account_public_key\" {\n  value = tls_private_key.service-account.public_key_pem\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__terraform-render-bootstrap__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.region\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shubhamm45__Terraform__eks-creation__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n################################################################################\n# Load Balancer\n################################################################################\n\noutput \"id\" {\n  description = \"The ID and ARN of the load balancer we created\"\n  value       = module.nlb.id\n}\n\noutput \"arn\" {\n  description = \"The ID and ARN of the load balancer we created\"\n  value       = module.nlb.arn\n}\n\noutput \"arn_suffix\" {\n  description = \"ARN suffix of our load balancer - can be used with CloudWatch\"\n  value       = module.nlb.arn_suffix\n}\n\noutput \"dns_name\" {\n  description = \"The DNS name of the load balancer\"\n  value       = module.nlb.dns_name\n}\n\noutput \"zone_id\" {\n  description = \"The zone_id of the load balancer to assist with creating DNS records\"\n  value       = module.nlb.zone_id\n}\n\n################################################################################\n# Listener(s)\n################################################################################\n\noutput \"listeners\" {\n  description = \"Map of listeners created and their attributes\"\n  value       = module.nlb.listeners\n}\n\noutput \"listener_rules\" {\n  description = \"Map of listeners rules created and their attributes\"\n  value       = module.nlb.listener_rules\n}\n\n################################################################################\n# Target Group(s)\n################################################################################\n\noutput \"target_groups\" {\n  description = \"Map of target groups created and their attributes\"\n  value       = module.nlb.target_groups\n}\n\n################################################################################\n# Security Group\n################################################################################\n\noutput \"security_group_arn\" {\n  description = \"Amazon Resource Name (ARN) of the security group\"\n  value       = module.nlb.security_group_arn\n}\n\noutput \"security_group_id\" {\n  description = \"ID of the security group\"\n  value       = module.nlb.security_group_id\n}\n\n################################################################################\n# Route53 Record(s)\n################################################################################\n\noutput \"route53_records\" {\n  description = \"The Route53 records created and attached to the load balancer\"\n  value       = module.nlb.route53_records\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__examples__complete-nlb__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"name\" {\n  type        = string\n  description = \"Name of the Onyx resources. Example: 'onyx'\"\n  default     = \"onyx\"\n}\n\nvariable \"region\" {\n  type        = string\n  description = \"AWS region for all resources\"\n  default     = \"us-west-2\"\n}\n\nvariable \"create_vpc\" {\n  type        = bool\n  description = \"Whether to create a new VPC\"\n  default     = true\n}\n\nvariable \"vpc_id\" {\n  type        = string\n  description = \"ID of the VPC. Required if create_vpc is false.\"\n  default     = null\n}\n\nvariable \"private_subnets\" {\n  type        = list(string)\n  description = \"Private subnets. Required if create_vpc is false.\"\n  default     = [] # This will default to 0.0.0.0/0 if not provided\n}\n\nvariable \"public_subnets\" {\n  type        = list(string)\n  description = \"Public subnets. Required if create_vpc is false.\"\n  default     = []\n}\n\nvariable \"vpc_cidr_block\" {\n  type        = string\n  description = \"VPC CIDR block. Required if create_vpc is false.\"\n  default     = null\n}\n\nvariable \"tags\" {\n  type        = map(string)\n  description = \"Base tags applied to all AWS resources\"\n  default = {\n    \"project\" = \"onyx\"\n  }\n}\n\nvariable \"postgres_username\" {\n  type        = string\n  description = \"Username for the postgres database\"\n  default     = \"postgres\"\n  sensitive   = true\n}\n\nvariable \"postgres_password\" {\n  type        = string\n  description = \"Password for the postgres database\"\n  default     = null\n  sensitive   = true\n}\n\nvariable \"public_cluster_enabled\" {\n  type        = bool\n  description = \"Whether to enable public cluster access\"\n  default     = true\n}\n\nvariable \"private_cluster_enabled\" {\n  type        = bool\n  description = \"Whether to enable private cluster access\"\n  default     = false # Should be true for production, false for dev/staging\n}\n\nvariable \"cluster_endpoint_public_access_cidrs\" {\n  type        = list(string)\n  description = \"CIDR blocks allowed to access the public EKS API endpoint\"\n  default     = []\n}\n\nvariable \"redis_auth_token\" {\n  type        = string\n  description = \"Authentication token for the Redis cluster\"\n  default     = null\n  sensitive   = true\n}\n\nvariable \"enable_iam_auth\" {\n  type        = bool\n  description = \"Enable AWS IAM authentication for the RDS Postgres instance and wire IRSA policies\"\n  default     = false\n}\n\nvariable \"rds_db_connect_arn\" {\n  type        = string\n  description = \"Full rds-db:connect ARN to pass to the EKS module. Required when enable_rds_iam_auth is true.\"\n  default     = null\n}\n\n# WAF Configuration Variables\nvariable \"waf_rate_limit_requests_per_5_minutes\" {\n  type        = number\n  description = \"Rate limit for requests per 5 minutes per IP address\"\n  default     = 2000\n}\n\nvariable \"waf_api_rate_limit_requests_per_5_minutes\" {\n  type        = number\n  description = \"Rate limit for API requests per 5 minutes per IP address\"\n  default     = 1000\n}\n\nvariable \"waf_geo_restriction_countries\" {\n  type        = list(string)\n  description = \"List of country codes to block. Leave empty to disable geo restrictions\"\n  default     = []\n}\n\nvariable \"waf_enable_logging\" {\n  type        = bool\n  description = \"Enable WAF logging to CloudWatch\"\n  default     = true\n}\n\nvariable \"waf_log_retention_days\" {\n  type        = number\n  description = \"Number of days to retain WAF logs\"\n  default     = 90\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/onyx-dot-app__onyx__deployment__terraform__modules__aws__onyx__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#output \"instance_ami\" {\n#  value = aws_instance.web.ami\n#}\n\n#output \"instance_arn\" {\n#  value = aws_instance.web.arn\n#}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__learning-terraform-3087701__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"archive_file\" \"backup\" {\n  type        = \"zip\"\n  source_file = \"../mytextfile.txt\"\n  output_path = \"${path.module}/archives/backup.zip\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__archive__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"instance_type\" {\n  type = string\n}\n\nvariable \"key_name\" {\n  type = string\n}\n\nvariable \"availability_zones\" {\n  type = list(string)\n}\n\nvariable \"cidr_block\" {\n  type        = string\n  description = \"VPC cidr block. Example: 10.10.0.0/16\"\n}\n\nvariable \"workstation_ip\" {\n  type = string\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudacademy__terraform-aws__exercises__exercise3__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\nThis Terraform configuration sets up a basic web application on AWS using an EC2 instance running Nginx.\nIt includes the necessary networking components such as a VPC, subnet, internet gateway, and security groups.\nAWS credentials are required to apply this configuration and can be set using environment variables or the AWS CLI.\n*/\n\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.0\"\n    }\n  }\n}\n\n##################################################################################\n# PROVIDERS\n##################################################################################\n\nprovider \"aws\" {\n  region = var.aws_region\n}\n\n##################################################################################\n# DATA\n##################################################################################\n\ndata \"aws_ssm_parameter\" \"amzn2_linux\" {\n  name = \"/aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2\"\n}\n\n##################################################################################\n# RESOURCES\n##################################################################################\n\n# NETWORKING #\nresource \"aws_vpc\" \"app\" {\n  cidr_block           = var.vpc_cidr_block\n  enable_dns_hostnames = var.vpc_enable_dns_hostnames\n\n  tags = merge(local.common_tags, { Name = lower(\"${local.naming_prefix}-vpc\") })\n}\n\nresource \"aws_internet_gateway\" \"app\" {\n  vpc_id = aws_vpc.app.id\n  tags   = local.common_tags\n}\n\nresource \"aws_subnet\" \"public_subnet1\" {\n  cidr_block              = var.vpc_subnet_cidr\n  vpc_id                  = aws_vpc.app.id\n  map_public_ip_on_launch = var.map_public_ip_on_launch\n  tags                    = merge(local.common_tags, { Name = lower(\"${local.naming_prefix}-public-subnet1\") })\n}\n\n# ROUTING #\nresource \"aws_route_table\" \"app\" {\n  vpc_id = aws_vpc.app.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.app.id\n  }\n\n  tags = merge(local.common_tags, { Name = lower(\"${local.naming_prefix}-rtb\") })\n}\n\nresource \"aws_route_table_association\" \"app_subnet1\" {\n  subnet_id      = aws_subnet.public_subnet1.id\n  route_table_id = aws_route_table.app.id\n}\n\n# SECURITY GROUPS #\n# Nginx security group \nresource \"aws_security_group\" \"nginx_sg\" {\n  name   = lower(\"${local.naming_prefix}-nginx_sg\")\n  vpc_id = aws_vpc.app.id\n\n  # HTTP access from anywhere\n  ingress {\n    from_port   = var.http_port\n    to_port     = var.http_port\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  # outbound internet access\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = local.common_tags\n}\n\n# INSTANCES #\nresource \"aws_instance\" \"nginx1\" {\n  ami                         = nonsensitive(data.aws_ssm_parameter.amzn2_linux.value)\n  instance_type               = var.ec2_instance_type\n  subnet_id                   = aws_subnet.public_subnet1.id\n  vpc_security_group_ids      = [aws_security_group.nginx_sg.id]\n  user_data_replace_on_change = true\n  tags                        = merge(local.common_tags, { Name = lower(\"${local.naming_prefix}-nginx1\") })\n\n  user_data = templatefile(\"./templates/startup_script.tpl\", {\n    environment = var.environment\n  })\n\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m5_solution__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m5_solution__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m5_solution__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m5_solution__main.tf", "start_line": 99}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m5_solution__main.tf", "start_line": 99}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m5_solution__main.tf", "start_line": 99}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m5_solution__main.tf", "start_line": 99}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m5_solution__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m5_solution__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m5_solution__main.tf", "start_line": 99}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#----------------------------------------------------------\n#  Terraform - From Zero to Certified Professional\n#\n# Build WebServer during Bootstrap with External TEMPLATE File\n#\n# Made by Denis Astahov\n#----------------------------------------------------------\n\nprovider \"aws\" {\n  region = \"ca-central-1\"\n}\n\nresource \"aws_default_vpc\" \"default\" {} # This need to be added since AWS Provider v4.29+ to get VPC id\n\nresource \"aws_instance\" \"web\" {\n  ami                    = \"ami-0c9bfc21ac5bf10eb\" // Amazon Linux2\n  instance_type          = \"t3.micro\"\n  vpc_security_group_ids = [aws_security_group.web.id]\n  user_data = templatefile(\"user_data.sh.tpl\", { // Template File\n    f_name = \"Denis\"\n    l_name = \"Astahov\"\n    names  = [\"John\", \"Angel\", \"David\", \"Victor\", \"Frank\", \"Melissa\", \"Kitana\"]\n  })\n\n  tags = {\n    Name  = \"WebServer Built by Terraform\"\n    Owner = \"Denis Astahov\"\n  }\n}\n\nresource \"aws_security_group\" \"web\" {\n  name        = \"WebServer-SG\"\n  description = \"Security Group for my WebServer\"\n  vpc_id      = aws_default_vpc.default.id # This need to be added since AWS Provider v4.29+ to set VPC id\n\n  ingress {\n    description = \"Allow port HTTP\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    description = \"Allow port HTTPS\"\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    description = \"Allow ALL ports\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name  = \"WebServer SG by Terraform\"\n    Owner = \"Denis Astahov\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-04__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_148", "severity": "HIGH", "message": "Ensure no default VPC is planned to be provisioned", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-04__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-04__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-04__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-04__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-04__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-04__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-04__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-04__main.tf", "start_line": 15}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"google\" {\n  credentials = file(\"<NAME>.json\")\n\n  project = \"<PROJECT_ID>\"\n  region  = \"us-central1\"\n  zone    = \"us-central1-c\"\n}\n\nresource \"google_compute_network\" \"vpc_network\" {\n  name = \"terraform-network\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__demo-terraform-101__getting-started__gcp__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_GCP_18", "severity": "CRITICAL", "message": "Ensure GCP network defines a firewall and does not use the default firewall", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__demo-terraform-101__getting-started__gcp__main.tf", "start_line": 9}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#  vim:ts=2:sts=2:sw=2:et\n#\n#  Author: Hari Sekhon\n#  Date: 2022-09-02 09:54:20 +0100 (Fri, 02 Sep 2022)\n#\n#  https://github.com/HariSekhon/Terraform\n#\n#  License: see accompanying Hari Sekhon LICENSE file\n#\n#  If you're using my code you're welcome to connect with me on LinkedIn and optionally send me feedback to help steer this or other code I publish\n#\n#  https://www.linkedin.com/in/HariSekhon\n#\n\n# ============================================================================ #\n#                                 A W S   S S O\n# ============================================================================ #\n\n# https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ssoadmin_account_assignment\n\n# Data source to get the SSO ARN + IDP ID\ndata \"aws_ssoadmin_instances\" \"my\" {}\n\n# ====================\n\nlocals {\n  # Convenience variables for shortness - would use var instead of local if this wasn't really tied to the specific account, modules across accounts won't add much here\n  sso_arn = tolist(data.aws_ssoadmin_instances.my.arns)[0]\n  sso_idp = tolist(data.aws_ssoadmin_instances.my.identity_store_ids)[0]\n\n  # get the IDP ID from:\n  #\n  #  https://eu-west-2.console.aws.amazon.com/singlesignon/identity/home?region=eu-west-2#!/settings\n  #\n  # get the group list via this AWS CLI command:\n  #\n  #   aws identitystore list-groups --identity-store-id d-1a234567b8 | jq -r '.Groups[].DisplayName' | sort | sed 's/^/  \"/; s/$/\",/'\n  #\n  groups = [\n    \"admins\",\n  ]\n}\n\n# ====================\n# Output all available SSO + IDP\n#\noutput \"aws-sso-arns\" {\n  value = data.aws_ssoadmin_instances.my.arns # a set\n}\n\noutput \"aws-sso-identity_store_ids\" {\n  value = data.aws_ssoadmin_instances.my.identity_store_ids # a set\n}\n\n# ====================\n# Show the SSO + IDP we're working on\n#\noutput \"aws-sso-arn\" {\n  value = local.sso_arn\n}\n\noutput \"aws-sso-idp\" {\n  value = local.sso_idp\n}\n\n# =======================\n# Create a Permission Set\n\nresource \"aws_ssoadmin_permission_set\" \"admin\" {\n  name         = \"AWSAdministratorAccess\"\n  description  = \"Provides full access to AWS services and resources\"\n  instance_arn = local.sso_arn\n  #relay_state      = \"https://s3.console.aws.amazon.com/s3/home?region=us-east-1#\"\n  session_duration = \"PT12H\" # valid duration, default: PT1H\n}\n\nresource \"aws_ssoadmin_permission_set\" \"poweruser\" {\n  name         = \"AWSPowerUserAccess\"\n  description  = \"Provides full access to AWS services and resources, but does not allow management of Users and groups\"\n  instance_arn = local.sso_arn\n  #relay_state      = \"https://s3.console.aws.amazon.com/s3/home?region=us-east-1#\"\n  session_duration = \"PT12H\" # valid duration, default: PT1H\n}\n\nresource \"aws_ssoadmin_permission_set\" \"readonly\" {\n  name         = \"AWSReadOnlyAccess\"\n  description  = \"This policy grants permissions to view resources and basic metadata across all AWS services\"\n  instance_arn = local.sso_arn\n  #relay_state      = \"https://s3.console.aws.amazon.com/s3/home?region=us-east-1#\"\n  session_duration = \"PT12H\" # valid duration, default: PT1H\n}\n\nresource \"aws_ssoadmin_permission_set\" \"org-admin\" {\n  name         = \"AWSOrganizationsFullAccess\"\n  instance_arn = local.sso_arn\n  #relay_state      = \"https://s3.console.aws.amazon.com/s3/home?region=us-east-1#\"\n  session_duration = \"PT12H\" # valid duration, default: PT1H\n}\n\nresource \"aws_ssoadmin_permission_set\" \"catalog-admin\" {\n  name         = \"AWSServiceCatalogAdminFullAccess\"\n  instance_arn = local.sso_arn\n  #relay_state      = \"https://s3.console.aws.amazon.com/s3/home?region=us-east-1#\"\n  session_duration = \"PT12H\" # valid duration, default: PT1H\n}\n\nresource \"aws_ssoadmin_permission_set\" \"catalog-user\" {\n  name         = \"AWSServiceCatalogEndUserAccess\"\n  instance_arn = local.sso_arn\n  #relay_state      = \"https://s3.console.aws.amazon.com/s3/home?region=us-east-1#\"\n  session_duration = \"PT12H\" # valid duration, default: PT1H\n}\n\nresource \"aws_ssoadmin_permission_set\" \"billing\" {\n  name         = \"Billing\"\n  description  = \"Grants Billing access\"\n  instance_arn = local.sso_arn\n  #relay_state      = \"https://s3.console.aws.amazon.com/s3/home?region=us-east-1#\"\n  session_duration = \"PT12H\" # valid duration, default: PT1H\n}\n\n# ===================\n# Get the permission set's arn\n\n#data \"aws_ssoadmin_permission_set\" \"admin\" {\n#  instance_arn = local.sso_arn\n#  name         = \"AWSAdministratorAccess\"\n#}\n#\n#data \"aws_ssoadmin_permission_set\" \"poweruser\" {\n#  instance_arn = local.sso_arn\n#  name         = \"AWSPowerUserAccess\"\n#}\n#\n#data \"aws_ssoadmin_permission_set\" \"readonly\" {\n#  instance_arn = local.sso_arn\n#  name         = \"AWSReadOnlyAccess\"\n#}\n\ndata \"aws_ssoadmin_permission_set\" \"org-admin\" {\n  instance_arn = local.sso_arn\n  name         = \"AWSOrganizationsFullAccess\"\n}\n\ndata \"aws_ssoadmin_permission_set\" \"catalog-admin\" {\n  instance_arn = local.sso_arn\n  name         = \"AWSServiceCatalogAdminFullAccess\"\n}\n\ndata \"aws_ssoadmin_permission_set\" \"catalog-user\" {\n  instance_arn = local.sso_arn\n  name         = \"AWSServiceCatalogEndUserAccess\"\n}\n\n# =====================\n# Get the group's ID by name filter\n#\n# aws identitystore list-groups --identity-store-id d-1a234567b8 | jq -r '.Groups[].DisplayName' | sort\ndata \"aws_identitystore_group\" \"my-group\" { # XXX: Edit\n  identity_store_id = local.sso_idp\n\n  filter {\n    attribute_path  = \"DisplayName\"\n    attribute_value = \"My Group\" # XXX: Edit\n  }\n}\n\n# =========================================\n# Assign\n\nresource \"aws_ssoadmin_account_assignment\" \"admins\" {\n  #instance_arn       = data.aws_ssoadmin_permission_set.my-permset.instance_arn # should be same as local.sso_arn\n  instance_arn       = local.sso_arn\n  permission_set_arn = data.aws_ssoadmin_permission_set.my-permset.arn\n\n  principal_id   = data.aws_identitystore_group.my-group.group_id\n  principal_type = \"GROUP\" # should always be group - don't assign things on a per user basis - that is against best practice and maintainability\n\n  target_id   = \"012347678910\" # Required: AWS Account ID\n  target_type = \"AWS_ACCOUNT\"  # Optional: AWS_ACCOUNT is the only valid value, but if you omit this and then later backport eg. using terraform_import_aws_sso_account_assignment.sh in DevOps Bash tools repo, then this missing field will force replacement unless you add it back in\n}\n\n# ==============================\n# Attach AWS Managed Policy\n\nresource \"aws_ssoadmin_managed_policy_attachment\" \"my-policy-attachment\" {\n  instance_arn       = local.sso_arn\n  managed_policy_arn = \"arn:aws:iam::aws:policy/AWSAdministratorAccess\"\n  permission_set_arn = aws_ssoadmin_permission_set.my-permset.arn\n}\n\n# ==============================\n# Attach Customer Managed Policy - must already be created in each AWS account where you want this applied\n\nresource \"aws_ssoadmin_customer_managed_policy_attachment\" \"my-customer-policy-attachment\" {\n  instance_arn       = local.sso_arn\n  permission_set_arn = aws_ssoadmin_permission_set.my-permset.arn\n  customer_managed_policy_reference {\n    name = aws_iam_policy.my-policy.name # define this aws_iam_policy elsewhere\n    path = \"/\"\n  }\n}\n\n# =============================\n# Inline Policy on a Permissions Set - can only be 1 per permission set\ndata \"aws_iam_policy_document\" \"my-inline-policy-document\" {\n  statement {\n    sid = \"1\"\n\n    actions = [\n      \"s3:ListAllMyBuckets\",\n      \"s3:GetBucketLocation\",\n    ]\n\n    resources = [\n      \"arn:aws:s3:::*\",\n    ]\n  }\n}\n\nresource \"aws_ssoadmin_permission_set_inline_policy\" \"my-inline-policy\" {\n  inline_policy = data.aws_iam_policy_document.my-inline-policy-document.json\n  #inline_policy      = file(\"${path.module}/sso_poweruser_policy.json\") # for example to lock out access to Secrets Manager\n  instance_arn       = local.sso_arn\n  permission_set_arn = aws_ssoadmin_permission_set.my-permset.arn\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HariSekhon__Terraform__aws_sso.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#NGFW ALB\n\nresource \"aws_lb\" \"ngfw-alb\" {\n  name                       = \"ngfw-alb\"\n  internal                   = false\n  security_groups            = [\"${aws_security_group.blue_team_open.id}\"]\n  subnets                    = [\"${aws_subnet.blue_team_az1_untrust.id}\", \"${aws_subnet.blue_team_az2_untrust.id}\"]\n  enable_deletion_protection = false\n  load_balancer_type         = \"application\"\n  tags = {\n    Name = \"blue_team_ngfw\"\n  }\n}\n\nresource \"aws_lb_target_group\" \"ngfw\" {\n  name        = \"blue-team-ngfw\"\n  port        = 80\n  protocol    = \"HTTP\"\n  vpc_id      = \"${aws_vpc.main.id}\"\n  target_type = \"ip\"\n\n  health_check {\n    healthy_threshold   = 2\n    unhealthy_threshold = 2\n    timeout             = 3\n    path                = \"/login\"\n    port                = 80\n    interval            = 30\n  }\n}\n\nresource \"aws_lb_target_group_attachment\" \"fw1\" {\n  target_group_arn = \"${aws_lb_target_group.ngfw.arn}\"\n  target_id        = \"${aws_network_interface.blue_team_ngfw_untrust.private_ip}\"\n  port             = 80\n}\n\nresource \"aws_lb_listener\" \"ngfw-alb\" {\n  load_balancer_arn = \"${aws_lb.ngfw-alb.arn}\"\n  port              = \"80\"\n  protocol          = \"HTTP\"\n\n  default_action {\n    target_group_arn = \"${aws_lb_target_group.ngfw.arn}\"\n    type             = \"forward\"\n  }\n}\n\nresource \"aws_lb_listener_rule\" \"static\" {\n  listener_arn = \"${aws_lb_listener.ngfw-alb.arn}\"\n  priority     = 100\n\n  action {\n    type             = \"forward\"\n    target_group_arn = \"${aws_lb_target_group.ngfw.arn}\"\n  }\n  condition {\n    path_pattern {\n      values = [\"/*\"]\n    }\n  }\n}\n\n#Native ALB\n\nresource \"aws_lb\" \"native-alb\" {\n  name                       = \"native-alb\"\n  internal                   = false\n  security_groups            = [\"${aws_security_group.blue_team_open.id}\"]\n  subnets                    = [\"${aws_subnet.blue_team_az1_untrust.id}\", \"${aws_subnet.blue_team_az2_untrust.id}\"]\n  enable_deletion_protection = false\n  load_balancer_type         = \"application\"\n\n  tags = {\n    Name = \"blue_team_native\"\n  }\n}\n\nresource \"aws_lb_target_group\" \"blue_team_native\" {\n  name        = \"blue-team-native\"\n  port        = 8080\n  protocol    = \"HTTP\"\n  vpc_id      = \"${aws_vpc.main.id}\"\n  target_type = \"ip\"\n\n  health_check {\n    healthy_threshold   = 2\n    unhealthy_threshold = 2\n    timeout             = 3\n    path                = \"/login\"\n    port                = 8080\n    interval            = 30\n  }\n}\n\nresource \"aws_lb_target_group_attachment\" \"server-native\" {\n  target_group_arn = \"${aws_lb_target_group.blue_team_native.arn}\"\n  target_id        = \"${aws_network_interface.blue_team_server.private_ip}\"\n  port             = 8080\n}\n\nresource \"aws_lb_listener\" \"native-alb\" {\n  load_balancer_arn = \"${aws_lb.native-alb.arn}\"\n  port              = \"80\"\n  protocol          = \"HTTP\"\n\n  default_action {\n    target_group_arn = \"${aws_lb_target_group.blue_team_native.arn}\"\n    type             = \"forward\"\n  }\n}\n\nresource \"aws_lb_listener_rule\" \"static2\" {\n  listener_arn = \"${aws_lb_listener.native-alb.arn}\"\n  priority     = 100\n\n  action {\n    type             = \"forward\"\n    target_group_arn = \"${aws_lb_target_group.blue_team_native.arn}\"\n  }\n  condition {\n    path_pattern {\n      values = [\"/*\"]\n    }\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_131", "severity": "HIGH", "message": "Ensure that ALB drops HTTP headers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_91", "severity": "HIGH", "message": "Ensure the ELBv2 (Application/Network) has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_150", "severity": "HIGH", "message": "Ensure that Load Balancer has deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_2", "severity": "HIGH", "message": "Ensure ALB protocol is HTTPS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 38}, {"tool": "checkov", "rule_id": "CKV_AWS_131", "severity": "HIGH", "message": "Ensure that ALB drops HTTP headers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_91", "severity": "HIGH", "message": "Ensure the ELBv2 (Application/Network) has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_150", "severity": "HIGH", "message": "Ensure that Load Balancer has deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_2", "severity": "HIGH", "message": "Ensure ALB protocol is HTTPS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 102}, {"tool": "checkov", "rule_id": "CKV2_AWS_20", "severity": "CRITICAL", "message": "Ensure that ALB redirects HTTP requests into HTTPS ones", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV2_AWS_20", "severity": "CRITICAL", "message": "Ensure that ALB redirects HTTP requests into HTTPS ones", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV2_AWS_28", "severity": "CRITICAL", "message": "Ensure public facing ALB are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV2_AWS_28", "severity": "CRITICAL", "message": "Ensure public facing ALB are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_103", "severity": "HIGH", "message": "Ensure that load balancer is using at least TLS 1.2", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 38}, {"tool": "checkov", "rule_id": "CKV_AWS_103", "severity": "HIGH", "message": "Ensure that load balancer is using at least TLS 1.2", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 102}, {"tool": "checkov", "rule_id": "CKV_AWS_378", "severity": "HIGH", "message": "Ensure AWS Load Balancer doesn't use HTTP protocol", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_378", "severity": "HIGH", "message": "Ensure AWS Load Balancer doesn't use HTTP protocol", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__blue-team-loadbalancers.tf", "start_line": 79}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_vpc\" \"default\" {\n  cidr_block = \"${var.vpc_cidr}\"\n  enable_dns_hostnames = true\n\n  tags {\n    Name = \"testing\"\n  }\n}\n\nresource \"aws_subnet\" \"us-east-1a-public\" {\n  vpc_id = \"${aws_vpc.default.id}\"\n  cidr_block = \"${var.us_east_1a_public_cidr}\"\n  availability_zone = \"${lookup(var.availability_zones, var.us_east_1a_public_cidr)}\"\n\n  tags {\n    Name = \"us-east-1a-public\"\n  }\n}\n\nresource \"aws_subnet\" \"us-east-1b-public\" {\n  vpc_id = \"${aws_vpc.default.id}\"\n  cidr_block = \"${var.us_east_1b_public_cidr}\"\n  availability_zone = \"${lookup(var.availability_zones, var.us_east_1b_public_cidr)}\"\n\n  tags {\n    Name = \"us-east-1b-public\"\n  }\n}\n\nresource \"aws_subnet\" \"us-east-1a-private\" {\n  vpc_id = \"${aws_vpc.default.id}\"\n  cidr_block = \"${var.us_east_1a_private_cidr}\"\n  availability_zone = \"${lookup(var.availability_zones, var.us_east_1a_private_cidr)}\"\n\n  tags {\n    Name = \"us-east-1a-private\"\n  }\n}\n\nresource \"aws_internet_gateway\" \"default\" {\n  vpc_id = \"${aws_vpc.default.id}\"\n\n  tags {\n    Name = \"igw\"\n  }\n}\n\nresource \"aws_route_table\" \"default\" {\n  vpc_id = \"${aws_vpc.default.id}\"\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = \"${aws_internet_gateway.default.id}\"\n  }\n\n  tags {\n    Name = \"public-rt\"\n  }\n}\n\nresource \"aws_route_table_association\" \"1a-public-rt\" {\n  subnet_id = \"${aws_subnet.us-east-1a-public.id}\"\n  route_table_id = \"${aws_route_table.default.id}\"\n}\n\nresource \"aws_route_table_association\" \"1b-public-rt\" {\n  subnet_id = \"${aws_subnet.us-east-1b-public.id}\"\n  route_table_id = \"${aws_route_table.default.id}\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__bastion-highavailability__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__bastion-highavailability__vpc.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__bastion-highavailability__vpc.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.0\"\n\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"~>3.0\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"~>3.0\"\n    }\n  }\n}\n\nprovider \"azurerm\" {\n  features {\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform__quickstart__101-aks-cluster-windows__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    netbox = {\n      source  = \"e-breuninger/netbox\"\n      version = \"~> 3.2.1\"\n    }\n  }\n}\n\n# example provider configuration for https://demo.netbox.dev\nprovider \"netbox\" {\n  server_url = \"https://demo.netbox.dev\"\n  api_token  = \"<your api key>\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/e-breuninger__terraform-provider-netbox__examples__provider__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    azuread = {\n      source = \"hashicorp/azuread\"\n      version = \"3.3.0\"\n    }\n  }\n}\n\nvar \"client_certificate_path\" {\n  description = \"To pass client_certificate_path with terraform command line arguments\"\n}\n\nvar \"client_certificate_password\" {\n  description = \"To pass client_certificate_password with terraform command line arguments\"\n}\n\nvar \"client_id\" {\n  description = \"To pass client_id with terraform command line arguments\"\n}\n\nvar \"tenant_id\" {\n  description = \"To pass tenant_id with terraform command line arguments\"\n}\n\nprovider \"azuread\" {\n  client_certificate_path = var.client_certificate_path\n  client_id = var.client_id\n  tenant_id = var.tenant_id\n  client_certificate_password = var.client_certificate_password\n}\n\nresource \"azuread_user\" \"example\" {\n  user_principal_name = \"userid@domainname\"\n  display_name        = \"Test User\"\n  mail_nickname       = \"userid\"\n  password            = \"SecretP@sswd99!\"\n}\n\n#To run use below command\n#terraform init\n#terraform apply --var=client_certificate_path=\"pfx_file_path\" --var=client_certificate_password=\"client_cert_pass\" --var=client_id=\"CLIENT_ID\" --var=tenant_id=\"TENANT_ID\"\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sagarhere4u__terraform__azure_ad_user__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"aws_region\" {\n  type    = string\n  default = \"us-east-1\"\n}\n\nvariable \"vpc_name\" {\n  type    = string\n  default = \"demo_vpc\"\n}\n\nvariable \"vpc_cidr\" {\n  type    = string\n  default = \"10.0.0.0/16\"\n}\n\nvariable \"private_subnets\" {\n  default = {\n    \"private_subnet_1\" = 1\n    \"private_subnet_2\" = 2\n    \"private_subnet_3\" = 3\n  }\n}\n\nvariable \"public_subnets\" {\n  default = {\n    \"public_subnet_1\" = 1\n    \"public_subnet_2\" = 2\n    \"public_subnet_3\" = 3\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__hashicorp__terraform__Lab Prerequisites__Section 04 - Understand Terraform Basics__HashiCorp Configuration Language__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_ecrpublic_authorization_token\" \"token\" {\n  provider = aws.ecr\n}\n\n################################################################################\n# Helm charts\n################################################################################\n\nresource \"helm_release\" \"neuron\" {\n  name             = \"neuron\"\n  repository       = \"oci://public.ecr.aws/neuron\"\n  chart            = \"neuron-helm-chart\"\n  version          = \"1.1.1\"\n  namespace        = \"neuron\"\n  create_namespace = true\n  wait             = false\n\n  # Public ECR\n  repository_username = data.aws_ecrpublic_authorization_token.token.user_name\n  repository_password = data.aws_ecrpublic_authorization_token.token.password\n\n  values = [\n    <<-EOT\n      nodeSelector:\n        aws.amazon.com/neuron.present: 'true'\n      npd:\n        enabled: false\n    EOT\n  ]\n}\n\nresource \"helm_release\" \"aws_efa_device_plugin\" {\n  name       = \"aws-efa-k8s-device-plugin\"\n  repository = \"https://aws.github.io/eks-charts\"\n  chart      = \"aws-efa-k8s-device-plugin\"\n  version    = \"v0.5.7\"\n  namespace  = \"kube-system\"\n  wait       = false\n\n  values = [\n    <<-EOT\n      nodeSelector:\n        vpc.amazonaws.com/efa.present: 'true'\n      tolerations:\n        - key: aws.amazon.com/neuron\n          operator: Exists\n          effect: NoSchedule\n    EOT\n  ]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-eks-blueprints__patterns__aws-neuron-efa__helm.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Terraform configurations for creating lambda functions to help manage\n# your ec2 instance lifecycles. The data_collectors.tf and iam_roles.tf\n# files are required. You may also use one or more of the following:\n#\n# notify_instance_usage.tf - Notify slack with instance usage #s\n# notify_untagged.tf - Checks for mandatory tags, notifies slack.\n# instance_reaper.tf - Terminates instances that have passed their TTL.\n# untagged_janitor.tf - Cleans up untagged instances.\n\nprovider \"aws\" {                                             \n  region     = \"${var.region}\"                                    \n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"ec2\" {\n  ami                    = data.aws_ami.ami.image_id\n  instance_type          = \"t2.2xlarge\"\n  key_name               = var.key-name\n  subnet_id              = aws_subnet.public-subnet.id\n  vpc_security_group_ids = [aws_security_group.security-group.id]\n  iam_instance_profile   = aws_iam_instance_profile.instance-profile.name\n  root_block_device {\n    volume_size = 30\n  }\n  user_data = templatefile(\"./tools-install.sh\", {})\n\n  tags = {\n    Name = var.instance-name\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__ec2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__ec2.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"PrivateIP\" {\n  description = \"Private IP of EC2 instance\"\n  value       = aws_instance.two-tier-instance1.private_ip\n}\n\noutput \"PrivateIP2\" {\n  description = \"Private IP of EC2 instance\"\n  value       = aws_instance.two-tier-instance2.private_ip\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Michael-Cassidy-88__Terraform__Two-Tier-Architecture__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_security_group\" \"alb_sg\" {\n  name_prefix = \"alb-sg\"\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"jenkins-alb-sg\"\n  }\n}\n\nresource \"aws_lb\" \"jenkins\" {\n  name               = \"jenkins-alb\"\n  internal           = false\n  load_balancer_type = \"application\"\n\n  subnets         = var.subnets\n  security_groups = [aws_security_group.alb_sg.id]\n\n  tags = {\n    Environment = var.environment\n    Terraform   = \"true\"\n  }\n}\n\nresource \"aws_security_group\" \"instance_sg\" {\n  name_prefix = \"jenkins-controller-sg\"\n\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 8080\n    to_port     = 8080\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"jenkins-controller-sg\"\n  }\n}\n\n\nresource \"aws_lb_target_group\" \"jenkins\" {\n  name_prefix = \"jks-lb\"\n  port        = 8080\n  protocol    = \"HTTP\"\n  vpc_id      = var.vpc_id\n  target_type = \"instance\"\n\n  health_check {\n    path                = \"/login\"\n    port                = 8080\n    protocol            = \"HTTP\"\n    interval            = 30\n    timeout             = 5\n    healthy_threshold   = 2\n    unhealthy_threshold = 2\n  }\n\n  tags = {\n    Environment = var.environment\n    Terraform   = \"true\"\n  }\n}\n\nresource \"aws_lb_listener\" \"jenkins\" {\n  load_balancer_arn = aws_lb.jenkins.arn\n  port              = 80\n  protocol          = \"HTTP\"\n\n  default_action {\n    target_group_arn = aws_lb_target_group.jenkins.arn\n    type             = \"forward\"\n  }\n}\n\nresource \"aws_launch_template\" \"jenkins\" {\n  name_prefix   = \"jenkins-controller-lt\"\n  image_id      = var.ami_id\n  instance_type = var.instance_type\n  key_name      = var.key_name\n\n  network_interfaces {\n    associate_public_ip_address = true\n    security_groups             = [aws_security_group.instance_sg.id]\n  }\n}\n\nresource \"aws_autoscaling_group\" \"jenkins\" {\n  name                = \"jenkins-controller-asg\"\n  max_size            = 1\n  min_size            = 1\n  desired_capacity    = 1\n  vpc_zone_identifier = var.subnets\n  launch_template {\n    id      = aws_launch_template.jenkins.id\n    version = aws_launch_template.jenkins.latest_version\n  }\n\n  tag {\n    key                 = \"Name\"\n    value               = \"jenkins-controller\"\n    propagate_at_launch = true\n  }\n\n  lifecycle {\n    create_before_destroy = true\n    ignore_changes        = [load_balancers, target_group_arns]\n  }\n\n  # instance_refresh {\n  #   strategy = \"Rolling\"\n  #   triggers = [\"launch_template\"]\n  # }\n}\n\n\nresource \"aws_autoscaling_attachment\" \"jenkins\" {\n  autoscaling_group_name = aws_autoscaling_group.jenkins.name\n  lb_target_group_arn    = aws_lb_target_group.jenkins.arn\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_131", "severity": "HIGH", "message": "Ensure that ALB drops HTTP headers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_91", "severity": "HIGH", "message": "Ensure the ELBv2 (Application/Network) has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_150", "severity": "HIGH", "message": "Ensure that Load Balancer has deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_2", "severity": "HIGH", "message": "Ensure ALB protocol is HTTPS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 90}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 101}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 101}, {"tool": "checkov", "rule_id": "CKV2_AWS_20", "severity": "CRITICAL", "message": "Ensure that ALB redirects HTTP requests into HTTPS ones", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV2_AWS_28", "severity": "CRITICAL", "message": "Ensure public facing ALB are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_103", "severity": "HIGH", "message": "Ensure that load balancer is using at least TLS 1.2", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 90}, {"tool": "checkov", "rule_id": "CKV2_AWS_15", "severity": "CRITICAL", "message": "Ensure that auto Scaling groups that are associated with a load balancer are using Elastic Load Balancing health checks.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 142}, {"tool": "checkov", "rule_id": "CKV_AWS_378", "severity": "HIGH", "message": "Ensure AWS Load Balancer doesn't use HTTP protocol", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__lb-asg__main.tf", "start_line": 67}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"myawsserver1\" {\n  ami = var.ami[\"us-east-1\"]\n  instance_type = var.instance_type\n  provider = aws.useast1\n  tags = {\n    Name = \"Techlanders-aws-ec2-instance1\"\n    Env = \"Prod\"\n  }\n}\n\noutput \"myawsserver1-ip\" {\n  value = aws_instance.myawsserver1.public_ip\n}\n\nresource \"aws_instance\" \"myawsserver2\" {\n  ami = var.ami[\"us-east-2\"]\n  provider = aws.useast2\n  instance_type = var.instance_type\n\n  tags = {\n    Name = \"Techlanders-aws-ec2-instance2\"\n    Env = \"Prod\"\n  }\n}\n\noutput \"myawsserver2-ip\" {\n  value = aws_instance.myawsserver2.public_ip\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__3_variables__resource.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__3_variables__resource.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__3_variables__resource.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__3_variables__resource.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__3_variables__resource.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__3_variables__resource.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__3_variables__resource.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__3_variables__resource.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__3_variables__resource.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__3_variables__resource.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__3_variables__resource.tf", "start_line": 15}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.AWS_REGION\n}\n\ndata \"aws_availability_zones\" \"available\" {\n}\n\ndata \"aws_caller_identity\" \"current\" {\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wardviaene__terraform-course__codepipeline-demo__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// Terraform code featuring resources covered by https://github.com/antonbabenko/terraform-cost-estimation\n//\n// aws_instance\n// aws_ec2_fleet\n// aws_ebs_volume\n// aws_ebs_snapshot\n// aws_ebs_snapshot_copy\n\n// aws_autoscaling_group\n// aws_launch_template\n// aws_launch_tconfiguration\n\n// aws_lb / aws_alb\n// aws_elb\n// aws_nat_gateway\n\n#################\n# EC2 instance\n#################\nresource \"aws_instance\" \"this_1\" {\n  ami           = data.aws_ami.amazon_linux2.id #\"ami-06ce3edf0cff21f07\"\n  instance_type = \"t3.nano\"\n\n  ebs_block_device { # \"standard\", \"gp2\", \"io1\", \"sc1\", or \"st1\". (Default: \"gp2\").\n    device_name = \"xvfs\"\n    volume_size = 10\n  }\n\n  ebs_block_device {\n    device_name = \"xvfa\"\n    volume_size = 20\n    volume_type = \"sc1\"\n  }\n\n  ebs_block_device {\n    device_name = \"xvfb\"\n    volume_size = 30\n    volume_type = \"io1\"\n    iops        = 2000\n  }\n\n  root_block_device {\n    volume_type = \"io1\" # \"standard\", \"gp2\", \"io1\", \"sc1\", or \"st1\". (Default: \"standard\").\n    iops        = 220\n  }\n}\n\n#################\n# EBS Volume - standard\n#################\nresource \"aws_ebs_volume\" \"volume_standard\" {\n  availability_zone = data.aws_availability_zones.available.names[0] #\"eu-west-1a\"\n  size              = 7\n  type              = \"standard\" # \"gp2\", \"io1\", \"sc1\" or \"st1\" (Default: \"gp2\").\n}\n\n#################\n# EBS Volume - io1\n#################\nresource \"aws_ebs_volume\" \"volume_io1\" {\n  availability_zone = data.aws_availability_zones.available.names[0]\n  size              = 8\n  iops              = 300\n  type              = \"io1\"\n}\n\n#################\n# EBS Snapshot\n#################\nresource \"aws_ebs_snapshot\" \"standard\" {\n  volume_id = aws_ebs_volume.volume_standard.id\n}\n\n#################\n# EBS Snapshot copy\n#################\nresource \"aws_ebs_snapshot_copy\" \"copied\" {\n  source_region      = data.aws_region.selected.name\n  source_snapshot_id = aws_ebs_snapshot.standard.id\n}\n\n##############################################\n# Autoscaling group with Launch Configuration\n##############################################\nresource \"aws_autoscaling_group\" \"lc\" {\n  desired_capacity    = 1\n  max_size            = 2\n  min_size            = 0\n  vpc_zone_identifier = tolist(data.aws_subnet_ids.all.ids)\n\n  launch_configuration = aws_launch_configuration.lc.id\n}\n\nresource \"aws_launch_configuration\" \"lc\" {\n  image_id      = data.aws_ami.amazon_linux2.id\n  instance_type = \"t2.micro\"\n}\n\n#########################################\n# Autoscaling group with Launch Template\n#########################################\nresource \"aws_autoscaling_group\" \"lt\" {\n  desired_capacity    = 1\n  max_size            = 2\n  min_size            = 0\n  vpc_zone_identifier = tolist(data.aws_subnet_ids.all.ids)\n\n  launch_template {\n    id      = aws_launch_template.lt.id\n    version = \"$Latest\"\n  }\n}\n\n#########################################\n# EC2 fleet with Launch Template\n#########################################\nresource \"aws_ec2_fleet\" \"lt\" {\n  launch_template_config {\n    launch_template_specification {\n      launch_template_id = aws_launch_template.lt.id\n      version            = aws_launch_template.lt.latest_version\n    }\n    //    // For internal tests\n    //    launch_template_specification {\n    //      launch_template_id = element(aws_launch_template.lt.*.id, 0)\n    //      version            = aws_launch_template.lt[0].latest_version\n    //    }\n  }\n\n  target_capacity_specification {\n    default_target_capacity_type = \"on-demand\"\n    total_target_capacity        = 1\n  }\n}\n\nresource \"aws_launch_template\" \"lt\" {\n  image_id      = data.aws_ami.amazon_linux2.id\n  instance_type = \"t2.nano\"\n\n  elastic_gpu_specifications {\n    type = \"eg1.medium\"\n  }\n\n  elastic_gpu_specifications {\n    type = \"eg1.large\"\n  }\n\n  elastic_inference_accelerator { // this is not part of EC2 pricing\n    type = \"eia1.medium\"\n  }\n\n  block_device_mappings { # \"standard\", \"gp2\", \"io1\", \"sc1\", or \"st1\". (Default: \"gp2\").\n    device_name = \"xvfs\"\n\n    ebs {\n      volume_size = 11\n    }\n  }\n\n  block_device_mappings { # \"standard\", \"gp2\", \"io1\", \"sc1\", or \"st1\". (Default: \"gp2\").\n    device_name = \"xvfa\"\n\n    ebs {\n      volume_size = 21\n      volume_type = \"sc1\"\n    }\n  }\n\n  block_device_mappings { # \"standard\", \"gp2\", \"io1\", \"sc1\", or \"st1\". (Default: \"gp2\").\n    device_name = \"xvfb\"\n\n    ebs {\n      volume_size = 31\n      volume_type = \"io1\"\n      iops        = 2001\n    }\n  }\n}\n\n#########################################\n# Application and Network Load Balancers\n#########################################\nresource \"aws_alb\" \"alb\" {\n  load_balancer_type = \"application\"\n  subnets            = data.aws_subnet_ids.all.ids\n}\n\nresource \"aws_lb\" \"nlb\" {\n  load_balancer_type = \"network\"\n  subnets            = data.aws_subnet_ids.all.ids\n}\n\n##########################\n# ELB\n##########################\nresource \"aws_elb\" \"elb\" {\n  listener {\n    instance_port     = 80\n    instance_protocol = \"HTTP\"\n    lb_port           = 80\n    lb_protocol       = \"HTTP\"\n  }\n\n  subnets = data.aws_subnet_ids.all.ids\n}\n\n##########################\n# NAT Gateway\n##########################\nresource \"aws_eip\" \"nat\" {\n  vpc = true\n}\n\nresource \"aws_nat_gateway\" \"nat\" {\n  allocation_id = aws_eip.nat.id\n  subnet_id     = tolist(data.aws_subnet_ids.all.ids)[0]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 20}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 20}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 20}, {"tool": "checkov", "rule_id": "CKV_AWS_3", "severity": "HIGH", "message": "Ensure all data stored in the EBS is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 51}, {"tool": "checkov", "rule_id": "CKV_AWS_189", "severity": "HIGH", "message": "Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 51}, {"tool": "checkov", "rule_id": "CKV_AWS_3", "severity": "HIGH", "message": "Ensure all data stored in the EBS is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_189", "severity": "HIGH", "message": "Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_183", "severity": "HIGH", "message": "Ensure EBS Snapshot Copy is encrypted by KMS using a customer managed Key (CMK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV_AWS_315", "severity": "HIGH", "message": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 85}, {"tool": "checkov", "rule_id": "CKV_AWS_153", "severity": "HIGH", "message": "Autoscaling groups should supply tags to launch configurations", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 85}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 94}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 94}, {"tool": "checkov", "rule_id": "CKV_AWS_153", "severity": "HIGH", "message": "Autoscaling groups should supply tags to launch configurations", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 102}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 136}, {"tool": "checkov", "rule_id": "CKV_AWS_131", "severity": "HIGH", "message": "Ensure that ALB drops HTTP headers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 183}, {"tool": "checkov", "rule_id": "CKV_AWS_91", "severity": "HIGH", "message": "Ensure the ELBv2 (Application/Network) has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 183}, {"tool": "checkov", "rule_id": "CKV_AWS_150", "severity": "HIGH", "message": "Ensure that Load Balancer has deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 183}, {"tool": "checkov", "rule_id": "CKV_AWS_91", "severity": "HIGH", "message": "Ensure the ELBv2 (Application/Network) has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 188}, {"tool": "checkov", "rule_id": "CKV_AWS_152", "severity": "HIGH", "message": "Ensure that Load Balancer (Network/Gateway) has cross-zone load balancing enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 188}, {"tool": "checkov", "rule_id": "CKV_AWS_150", "severity": "HIGH", "message": "Ensure that Load Balancer has deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 188}, {"tool": "checkov", "rule_id": "CKV_AWS_92", "severity": "HIGH", "message": "Ensure the ELB has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 196}, {"tool": "checkov", "rule_id": "CKV_AWS_127", "severity": "HIGH", "message": "Ensure that Elastic Load Balancer(s) uses SSL certificates provided by AWS Certificate Manager", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 196}, {"tool": "checkov", "rule_id": "CKV_AWS_376", "severity": "HIGH", "message": "Ensure AWS Elastic Load Balancer listener uses TLS/SSL", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 196}, {"tool": "checkov", "rule_id": "CKV2_AWS_28", "severity": "CRITICAL", "message": "Ensure public facing ALB are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 183}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-cost-estimation__samples__terraform-code__main.tf", "start_line": 20}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n    region = \"${var.AWS_REGION}\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/praveen1994dec__Terraform_wc__config.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"aws-region\" {}\nvariable \"env\" {}\nvariable \"cluster-name\" {}\nvariable \"vpc-cidr-block\" {}\nvariable \"vpc-name\" {}\nvariable \"igw-name\" {}\nvariable \"pub-subnet-count\" {}\nvariable \"pub-cidr-block\" {\n  type = list(string)\n}\nvariable \"pub-availability-zone\" {\n  type = list(string)\n}\nvariable \"pub-sub-name\" {}\nvariable \"pri-subnet-count\" {}\nvariable \"pri-cidr-block\" {\n  type = list(string)\n}\nvariable \"pri-availability-zone\" {\n  type = list(string)\n}\nvariable \"pri-sub-name\" {}\nvariable \"public-rt-name\" {}\nvariable \"private-rt-name\" {}\nvariable \"eip-name\" {}\nvariable \"ngw-name\" {}\nvariable \"eks-sg\" {}\n\n\n# EKS\nvariable \"is-eks-cluster-enabled\" {}\nvariable \"cluster-version\" {}\nvariable \"endpoint-private-access\" {}\nvariable \"endpoint-public-access\" {}\nvariable \"ondemand_instance_types\" {\n  default = [\"t3a.medium\"]\n}\n\nvariable \"spot_instance_types\" {}\nvariable \"desired_capacity_on_demand\" {}\nvariable \"min_capacity_on_demand\" {}\nvariable \"max_capacity_on_demand\" {}\nvariable \"desired_capacity_spot\" {}\nvariable \"min_capacity_spot\" {}\nvariable \"max_capacity_spot\" {}\nvariable \"addons\" {\n  type = list(object({\n    name    = string\n    version = string\n  }))\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__EKS-Terraform-GitHub-Actions__eks__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"oci_identity_compartment\" \"_\" {\n  name          = var.name\n  description   = var.name\n  enable_delete = true\n}\n\nlocals {\n  compartment_id = oci_identity_compartment._.id\n}\n\ndata \"oci_identity_availability_domains\" \"_\" {\n  compartment_id = local.compartment_id\n}\n\ndata \"oci_core_images\" \"_\" {\n  compartment_id           = local.compartment_id\n  shape                    = var.shape\n  operating_system         = \"Canonical Ubuntu\"\n  operating_system_version = \"22.04\"\n  #operating_system         = \"Oracle Linux\"\n  #operating_system_version = \"7.9\"\n}\n\nresource \"oci_core_instance\" \"_\" {\n  for_each            = local.nodes\n  display_name        = each.value.node_name\n  availability_domain = data.oci_identity_availability_domains._.availability_domains[var.availability_domain].name\n  compartment_id      = local.compartment_id\n  shape               = var.shape\n  shape_config {\n    memory_in_gbs = var.memory_in_gbs_per_node\n    ocpus         = var.ocpus_per_node\n  }\n  source_details {\n    source_id   = data.oci_core_images._.images[0].id\n    source_type = \"image\"\n  }\n  create_vnic_details {\n    subnet_id  = oci_core_subnet._.id\n    private_ip = each.value.ip_address\n  }\n  metadata = {\n    ssh_authorized_keys = join(\"\\n\", local.authorized_keys)\n    user_data           = data.cloudinit_config._[each.key].rendered\n  }\n  connection {\n    host        = self.public_ip\n    user        = \"ubuntu\"\n    private_key = tls_private_key.ssh.private_key_pem\n  }\n  provisioner \"remote-exec\" {\n    inline = [\n      \"tail -f /var/log/cloud-init-output.log &\",\n      \"cloud-init status --wait >/dev/null\",\n    ]\n  }\n}\n\nlocals {\n  nodes = {\n    for i in range(1, 1 + var.how_many_nodes) :\n    i => {\n      node_name  = format(\"node%d\", i)\n      ip_address = format(\"10.0.0.%d\", 10 + i)\n      role       = i == 1 ? \"controlplane\" : \"worker\"\n    }\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jpetazzo__ampernetacle__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_OCI_4", "severity": "HIGH", "message": "Ensure OCI Compute Instance boot volume has in-transit data encryption enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jpetazzo__ampernetacle__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_OCI_5", "severity": "HIGH", "message": "Ensure OCI Compute Instance has Legacy MetaData service endpoint disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jpetazzo__ampernetacle__main.tf", "start_line": 24}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region                      = \"us-east-1\"\n  skip_credentials_validation = true\n  skip_requesting_account_id  = true\n  access_key                  = \"mock_access_key\"\n  secret_key                  = \"mock_secret_key\"\n}\n\nlocals {\n  files = [\n    { name = \"cd\", file = \"instance.json\", },\n    { name = \"sym\", file = \"sym-instance.json\", },\n    { name = \"pd\", file = \"../../../testdata/instance.json\", },\n    {\n      name = \"abs\",\n      file = \"/home/runner/work/infracost/infracost/cmd/infracost/testdata/breakdown_terraform_file_funcs/instance.json\",\n    },\n    { name = \"pdabs\", file = \"/home/runner/work/infracost/infracost/cmd/testdata/instance.json\", },\n  ]\n  dirs = [\n    { name = \"cd\", dir = \".\" },\n    { name = \"pd\", dir = \"../../../testdata\" },\n    { name = \"abs\", dir = \"/home/runner/work/infracost/infracost/cmd/infracost/testdata/breakdown_terraform_file_funcs/\" },\n    { name = \"pdabs\", dir = \"/home/runner/work/infracost/infracost/cmd/testdata/\" },\n\n  ]\n  template_files = [\n    { name = \"cd\", file = \"templ.tftpl\", },\n    { name = \"pd\", file = \"../../../testdata/templ.tftpl\", },\n    {\n      name = \"abs\", file = \"/home/runner/work/infracost/infracost/cmd/infracost/testdata/breakdown_terraform_file_funcs/templ.tftpl\",\n    },\n    { name = \"pdabs\", file = \"/home/runner/work/infracost/infracost/cmd/testdata/templ.tftpl\", }\n  ]\n}\n\nresource \"aws_instance\" \"file\" {\n  for_each = { for f in local.files : f.name => f.file }\n\n  ami           = \"ami-674cbc1e\"\n  instance_type = jsondecode(file(each.value)).instance_type\n}\n\nmodule \"mod_files\" {\n  source = \"./modules/test\"\n}\n\nresource \"aws_instance\" \"fileexists\" {\n  for_each      = { for f in local.files : f.name => f.file }\n  ami           = \"ami-674cbc1e\"\n  instance_type = fileexists(each.value) ? \"e\" : \"ne\"\n}\n\nresource \"aws_instance\" \"fileset\" {\n  for_each      = { for f in local.dirs : f.name => f.dir }\n  ami           = \"ami-674cbc1e\"\n  instance_type = length(fileset(each.value, \"*.json\"))\n}\n\nresource \"aws_instance\" \"filemd5\" {\n  for_each      = { for f in local.files : f.name => f.file }\n  ami           = \"ami-674cbc1e\"\n  instance_type = filemd5(each.value)\n}\n\nresource \"aws_instance\" \"template_file\" {\n  for_each      = { for f in local.template_files : f.name => f.file }\n  ami           = \"ami-674cbc1e\"\n  instance_type = jsondecode(templatefile(each.value, {})).instance_type\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_file_funcs__main.tf", "start_line": 66}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource-1: Azure Resource Group\nresource \"azurerm_resource_group\" \"myrg\" {\n  name = \"myrg-1\"\n  location = \"East US\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__09-Resource-Syntax-and-Behavior__terraform-manifests__c2-resource-group.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n################################################################################\n# Zone\n################################################################################\n\noutput \"id\" {\n  description = \"Zone ID of Route53 zone\"\n  value       = local.zone_id\n}\n\noutput \"arn\" {\n  description = \"Zone ARN of Route53 zone\"\n  value       = try(aws_route53_zone.this[0].arn, aws_route53_zone.ignore_vpc[0].arn, data.aws_route53_zone.this[0].arn, null)\n}\n\noutput \"name_servers\" {\n  description = \"Name servers of Route53 zone\"\n  value       = try(aws_route53_zone.this[0].name_servers, aws_route53_zone.ignore_vpc[0].name_servers, data.aws_route53_zone.this[0].name_servers, null)\n}\n\noutput \"primary_name_server\" {\n  description = \"The Route 53 name server that created the SOA record.\"\n  value       = try(aws_route53_zone.this[0].primary_name_server, aws_route53_zone.ignore_vpc[0].primary_name_server, data.aws_route53_zone.this[0].primary_name_server, null)\n}\n\noutput \"name\" {\n  description = \"Name of Route53 zone\"\n  value       = local.zone_name\n}\n\n################################################################################\n# DNSSEC\n################################################################################\n\noutput \"dnssec_signing_key_digest_value\" {\n  description = \"A cryptographic digest of a DNSKEY resource record (RR). DNSKEY records are used to publish the public key that resolvers can use to verify DNSSEC signatures that are used to secure certain kinds of information provided by the DNS system\"\n  value       = try(aws_route53_key_signing_key.this[0].digest_value, null)\n}\n\noutput \"dnssec_signing_key_dnskey_record\" {\n  description = \"A string that represents a DNSKEY record\"\n  value       = try(aws_route53_key_signing_key.this[0].dnskey_record, null)\n}\n\noutput \"dnssec_signing_key_ds_record\" {\n  description = \"A string that represents a delegation signer (DS) record\"\n  value       = try(aws_route53_key_signing_key.this[0].ds_record, null)\n}\n\noutput \"dnssec_signing_key_id\" {\n  description = \"Route 53 Hosted Zone identifier and KMS Key identifier, separated by a comma (`,`)\"\n  value       = try(aws_route53_key_signing_key.this[0].id, null)\n}\n\noutput \"dnssec_signing_key_tag\" {\n  description = \"An integer used to identify the DNSSEC record for the domain name. The process used to calculate the value is described in RFC-4034 Appendix B\"\n  value       = try(aws_route53_key_signing_key.this[0].key_tag, null)\n}\n\noutput \"dnssec_signing_key_public_key\" {\n  description = \"The public key, represented as a Base64 encoding, as required by RFC-4034 Page 5\"\n  value       = try(aws_route53_key_signing_key.this[0].public_key, null)\n}\n\n# KMS key\noutput \"dnssec_kms_key_arn\" {\n  description = \"The Amazon Resource Name (ARN) of the key\"\n  value       = module.route53_dnssec_kms.key_arn\n}\n\noutput \"dnssec_kms_key_id\" {\n  description = \"The globally unique identifier for the key\"\n  value       = module.route53_dnssec_kms.key_id\n}\n\noutput \"dnssec_kms_key_region\" {\n  description = \"The region for the key\"\n  value       = module.route53_dnssec_kms.key_region\n}\n\noutput \"dnssec_kms_key_policy\" {\n  description = \"The IAM resource policy set on the key\"\n  value       = module.route53_dnssec_kms.key_policy\n}\n\n################################################################################\n# Records\n################################################################################\n\noutput \"records\" {\n  description = \"Records created in the Route53 zone\"\n  value       = aws_route53_record.this\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-route53__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# You will need to customize these variables to suit your environment\nvariable \"target_node\" { default = \"larry\" }\nvariable \"ip_address\" { default = \"192.168.73.57\" }\nvariable \"cidr\" { default = \"24\" }\nvariable \"gateway\" { default = \"192.168.73.1\" }\nvariable \"nameservers\" { default = \"192.168.73.100 192.168.73.200\" }\nvariable \"name\" { default = \"test.example.com\" }\nvariable \"storage_backend\" { default = \"local-zfs\" }\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Telmate__terraform-provider-proxmox__docs__examples__bug_reporting__vars.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"instance_type\" {\n  type = string\n}\nvariable \"key_name\" {\n  type = string\n}\n\nvariable \"availability_zones\" {\n  type = list(string)\n}\n\nvariable \"cidr_block\" {\n  type        = string\n  description = \"VPC cidr block. Example: 10.10.0.0/16\"\n}\n\nvariable \"webserver_sg_rules\" {\n  type = object({\n    ingress_rules = list(object({\n      description = string\n      from_port   = number\n      to_port     = number\n      protocol    = string\n      cidr_blocks = list(string)\n    }))\n    egress_rules = list(object({\n      description = string\n      from_port   = number\n      to_port     = number\n      protocol    = string\n      cidr_blocks = list(string)\n    }))\n  })\n  default = {\n    ingress_rules = [\n      {\n        description = \"SSH from management workstation\"\n        from_port   = 22\n        to_port     = 22\n        protocol    = \"tcp\"\n        cidr_blocks = [\"1.1.1.1/32\"] # <- replace with your own workstation IP\n      },\n      {\n        description = \"80 from public subnets (ALB)\"\n        from_port   = 80\n        to_port     = 80\n        protocol    = \"tcp\"\n        cidr_blocks = [\"10.0.1.0/24\", \"10.0.2.0/24\"]\n      },\n    ]\n    egress_rules = [\n      {\n        description = \"All outbound internet traffic\"\n        from_port   = 0\n        to_port     = 0\n        protocol    = \"-1\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n      }\n    ]\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudacademy__terraform-aws__exercises__exercise2__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_region\" \"current\" {\n}\n\nmodule \"cluster_metadata\" {\n  source = \"../../common/metadata\"\n\n  name_prefix = local.name_prefix\n  base_domain = local.base_domain\n\n  provider_name   = \"aws\"\n  provider_region = data.aws_region.current.name\n}\n\nmodule \"cluster\" {\n  source = \"../_modules/eks\"\n\n  metadata_name   = module.cluster_metadata.name\n  metadata_fqdn   = module.cluster_metadata.fqdn\n  metadata_labels = module.cluster_metadata.labels\n\n  availability_zones = local.cluster_availability_zones\n\n  vpc_cidr                      = local.cluster_vpc_cidr\n  vpc_control_subnet_newbits    = local.cluster_vpc_control_subnet_newbits\n  vpc_dns_hostnames             = local.cluster_vpc_dns_hostnames\n  vpc_dns_support               = local.cluster_vpc_dns_support\n  vpc_node_subnet_newbits       = local.cluster_vpc_node_subnet_newbits\n  vpc_node_subnet_number_offset = local.cluster_vpc_node_subnet_number_offset\n  vpc_legacy_node_subnets       = local.cluster_vpc_legacy_node_subnets\n  vpc_subnet_map_public_ip      = local.cluster_vpc_subnet_map_public_ip\n\n  instance_types   = local.cluster_instance_types\n  desired_capacity = local.cluster_desired_capacity\n  max_size         = local.cluster_max_size\n  min_size         = local.cluster_min_size\n  cluster_version  = local.cluster_version\n\n  metadata_options = local.metadata_options\n\n  root_device_encrypted   = local.worker_root_device_encrypted\n  root_device_volume_size = local.worker_root_device_volume_size\n\n  additional_node_tags = local.cluster_additional_node_tags\n\n  aws_auth_map_roles    = local.cluster_aws_auth_map_roles\n  aws_auth_map_users    = local.cluster_aws_auth_map_users\n  aws_auth_map_accounts = local.cluster_aws_auth_map_accounts\n\n  disable_default_ingress = local.disable_default_ingress\n\n  enabled_cluster_log_types = local.enabled_cluster_log_types\n\n  disable_openid_connect_provider = local.disable_openid_connect_provider\n\n  cluster_endpoint_private_access = local.cluster_endpoint_private_access\n  cluster_endpoint_public_access  = local.cluster_endpoint_public_access\n  cluster_public_access_cidrs     = local.cluster_public_access_cidrs\n  cluster_service_cidr            = local.cluster_service_cidr\n\n  cluster_encryption_key_arn = local.cluster_encryption_key_arn\n\n  worker_ami_type            = local.worker_ami_type\n  worker_ami_release_version = local.worker_ami_release_version\n\n  # cluster module configuration is still map(string)\n  # once module_variable_optional_attrs isn't experimental anymore\n  # we can migrate cluster module configuration to map(object(...))\n  taints = toset([])\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kbst__terraform-kubestack__aws__cluster__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// The below define a custom directory user schema. For additional details on\n// possible types of fields, their values, etc see Google's reference documentation:\n//     https://developers.google.com/admin-sdk/directory/v1/reference/schemas\nresource \"gsuite_user_schema\" \"details\" {\n  schema_name  = \"additional-details\" // Required\n  display_name = \"Additional Details\" // Optional (default: value of `schema_name`)\n\n  // Defines the schema of a specific field. The `field` element may be\n  // repeated multiple times to define more than a single custom field.\n  field {\n    field_type       = \"PHONE\"            // Required (valid values: BOOL, DATE, DOUBLE, EMAIL, INT64, PHONE, STRING)\n    field_name       = \"internal-phone\"   // Required\n    display_name     = \"Internal Phone\"   // Optional (default: value of `field_name`)\n    indexed          = true               // Optional (default: true)\n    read_access_type = \"ALL_DOMAIN_USERS\" // Optional (default: ADMINS_AND_SELF)\n    multi_valued     = false              // Optional (default: false)\n  }\n}\n\ndata \"gsuite_user_attributes\" \"details\" {\n  phone {\n    name  = \"internal-phone\"\n    value = \"555-555-5555\"\n  }\n}\n\n// A data resource that defines full schema that contains all field types mentioned above. Not very\n// interesting but can be used for testing changes to the terraform provider. Note,\n// the reason we\nresource \"gsuite_user_schema\" \"test\" {\n  schema_name  = \"test-schema\"\n  display_name = \"test-schema\"\n\n  field {\n    field_type = \"STRING\"\n    field_name = \"string\"\n  }\n\n  field {\n    field_type   = \"STRING\"\n    field_name   = \"strings\"\n    multi_valued = true\n  }\n\n  field {\n    field_type = \"BOOL\"\n    field_name = \"bool\"\n  }\n\n  field {\n    field_type   = \"BOOL\"\n    field_name   = \"bools\"\n    multi_valued = true\n  }\n\n  field {\n    field_type = \"INT64\"\n    field_name = \"integer\"\n  }\n\n  field {\n    field_type   = \"INT64\"\n    field_name   = \"integers\"\n    multi_valued = true\n  }\n\n  field {\n    field_type = \"DOUBLE\"\n    field_name = \"double\"\n  }\n\n  field {\n    field_type   = \"DOUBLE\"\n    field_name   = \"doubles\"\n    multi_valued = true\n  }\n\n  field {\n    field_type = \"DATE\"\n    field_name = \"date\"\n  }\n\n  field {\n    field_type   = \"DATE\"\n    field_name   = \"dates\"\n    multi_valued = true\n  }\n\n  field {\n    field_type = \"EMAIL\"\n    field_name = \"email\"\n  }\n\n  field {\n    field_type   = \"EMAIL\"\n    field_name   = \"emails\"\n    multi_valued = true\n  }\n\n  field {\n    field_type = \"PHONE\"\n    field_name = \"phone\"\n  }\n\n  field {\n    field_type   = \"PHONE\"\n    field_name   = \"phones\"\n    multi_valued = true\n  }\n}\n\n// This data resource is used to fill in the `test-schema` defined above. Useful\n// for testing changes to the terraform provider. Note, passing in a value that\n// has the wrong type (ex. a non-date to a DATE type filed) results in\n// the following error:\n//   * gsuite_user.user: Error updating user: {\"error\":{\"errors\":[{\"domain\":\"global\",\"reason\":\"invalid\",\"message\":\"Invalid Input\"}],\"code\":400,\"message\":\"Invalid Input\"}}: googleapi: Error 400: Invalid Input, invalid\n// The reason a data source is provided is that this allows the GSuite provider\n// to properly handle the construction of the json payload to Google's directory\n// API. If you choose not to use this data source you'll need to construct it\n// yourself according to the SDK documentation:\n//   https://developers.google.com/admin-sdk/directory/v1/guides/manage-schemas#set_fields\ndata \"gsuite_user_attributes\" \"test\" {\n  string {\n    name  = \"string\"\n    value = \"some-string\"\n  }\n\n  strings {\n    name  = \"strings\"\n    value = [\"string1\", \"string2\", \"string3\"]\n  }\n\n  bool {\n    name  = \"bool\"\n    value = false\n  }\n\n  bools {\n    name  = \"bools\"\n    value = [true, false, true, true, true]\n  }\n\n  integer {\n    name  = \"integer\"\n    value = 1001\n  }\n\n  integers {\n    name  = \"integers\"\n    value = [1001, 1002, 1003]\n  }\n\n  double {\n    name  = \"double\"\n    value = 3.1415926\n  }\n\n  doubles {\n    name  = \"doubles\"\n    value = [3.1415926, 1.2e-8]\n  }\n\n  date {\n    name  = \"date\"\n    value = \"1970\"\n  }\n\n  dates {\n    name  = \"dates\"\n    value = [\"1970\", \"1970-01-01\"]\n  }\n\n  email {\n    name  = \"email\"\n    value = \"test@example.com\"\n  }\n\n  emails {\n    name  = \"emails\"\n    value = [\"test1@example.com\", \"test2@example.com\"]\n  }\n\n  phone {\n    name  = \"phone\"\n    value = \"1-555-555-5555\"\n  }\n\n  phones {\n    name  = \"phones\"\n    value = [\"1-555-555-5555\", \"1-555-555-5556\"]\n  }\n}\n\nresource \"gsuite_user\" \"user\" {\n  // depends_on is required. Otherwise changes to the schema won't be applied\n  // before we update this resource.\n  depends_on = [\"gsuite_user_schema.test\", \"gsuite_user_schema.details\"]\n\n  primary_email = \"flast@example.com\"\n\n  name {\n    given_name  = \"First\"\n    family_name = \"Last\"\n  }\n\n  //\n  //                         NOTICE\n  // If you get an error when applying schema changes such as:\n  //\n  //   `googleapi: Error 400: Invalid Input: custom_schema, invalid\n  //\n  // The most likely cause is you are attemping to update a schema\n  // with value(s) it does not support. For example if you apply\n  // data.gsuite_user_attributes.test to the `additional-details`\n  // custom_schema below you'll get the error above as a result.\n  //\n\n  // Set attributes on the user for the `test-schema` custom schema.\n  custom_schema {\n    name  = \"test-schema\"\n    value = \"${data.gsuite_user_attributes.test.json}\"\n  }\n  // Set attributes on the user for the `additional-details` custom schema.\n  custom_schema {\n    name  = \"additional-details\"\n    value = \"${data.gsuite_user_attributes.details.json}\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeviaVir__terraform-provider-gsuite__examples__user-with-custom-schemas__user-with-custom-schemas.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeviaVir__terraform-provider-gsuite__examples__user-with-custom-schemas__user-with-custom-schemas.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeviaVir__terraform-provider-gsuite__examples__user-with-custom-schemas__user-with-custom-schemas.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Variables definitions for authorization\nvariable \"region_name\" {\n  description = \"The region where the resources are located\"\n  type        = string\n}\n\nvariable \"access_key\" {\n  description = \"The access key of the IAM user\"\n  type        = string\n  sensitive   = true\n}\n\nvariable \"secret_key\" {\n  description = \"The secret key of the IAM user\"\n  type        = string\n  sensitive   = true\n}\n\n# Variables definitions for resource/data source\nvariable \"instance_flavor_id\" {\n  description = \"The flavor ID of the AS instance\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"instance_flavor_performance_type\" {\n  description = \"The performance type of the AS instance flavor\"\n  type        = string\n  default     = \"normal\"\n}\n\nvariable \"instance_flavor_cpu_core_count\" {\n  description = \"The CPU core count of the AS instance flavor\"\n  type        = number\n  default     = 2\n}\n\nvariable \"instance_flavor_memory_size\" {\n  description = \"The memory size of the AS instance flavor\"\n  type        = number\n  default     = 4\n}\n\nvariable \"instance_image_id\" {\n  description = \"The image ID of the AS instance\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"vpc_name\" {\n  description = \"The name of the VPC\"\n  type        = string\n}\n\nvariable \"vpc_cidr\" {\n  description = \"The CIDR block of the VPC\"\n  type        = string\n  default     = \"192.168.0.0/16\"\n}\n\nvariable \"subnet_name\" {\n  description = \"The name of the subnet\"\n  type        = string\n}\n\nvariable \"subnet_cidr\" {\n  description = \"The CIDR block of the subnet\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"subnet_gateway_ip\" {\n  description = \"The gateway IP of the subnet\"\n  type        = string\n  default     = \"\"\n\n  validation {\n    condition     = (var.subnet_cidr != \"\" && var.subnet_gateway_ip != \"\") || (var.subnet_cidr == \"\" && var.subnet_gateway_ip == \"\")\n    error_message = \"The 'subnet_cidr' and 'subnet_gateway_ip' is not allowed for only one of them to be empty\"\n  }\n}\n\nvariable \"security_group_name\" {\n  description = \"The name of the security group\"\n  type        = string\n}\n\nvariable \"keypair_name\" {\n  description = \"The name of the key pair that is used to access the AS instance\"\n  type        = string\n}\n\nvariable \"keypair_public_key\" {\n  description = \"The public key of the key pair that is used to access the AS instance\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"configuration_name\" {\n  description = \"The name of the AS configuration\"\n  type        = string\n}\n\nvariable \"disk_configurations\" {\n  description = \"The disk configurations for the AS instance\"\n  type        = list(object({\n    disk_type   = string\n    volume_type = string\n    volume_size = number\n  }))\n\n  nullable = false\n\n  validation {\n    condition     = length(var.disk_configurations) > 0 && length([for v in var.disk_configurations : v if v.disk_type == \"SYS\"]) == 1\n    error_message = \"The 'disk_configurations' is not allowed to be empty and only one system disk is allowed\"\n  }\n}\n\nvariable \"group_name\" {\n  description = \"The name of the AS group\"\n  type        = string\n}\n\nvariable \"desire_instance_number\" {\n  description = \"The desired number of scaling instances in the AS group\"\n  type        = number\n  default     = 2\n}\n\nvariable \"min_instance_number\" {\n  description = \"The minimum number of scaling instances in the AS group\"\n  type        = number\n  default     = 0\n}\n\nvariable \"max_instance_number\" {\n  description = \"The maximum number of scaling instances in the AS group\"\n  type        = number\n  default     = 10\n}\n\nvariable \"is_delete_publicip\" {\n  description = \"Whether to delete the public IP address of the scaling instances when the AS group is deleted\"\n  type        = bool\n  default     = true\n}\n\nvariable \"is_delete_instances\" {\n  description = \"Whether to delete the scaling instances when the AS group is deleted\"\n  type        = bool\n  default     = true\n}\n\nvariable \"topic_name\" {\n  description = \"The name of the SMN topic\"\n  type        = string\n}\n\nvariable \"alarm_rule_name\" {\n  description = \"The name of the CES alarm rule\"\n  type        = string\n}\n\nvariable \"rule_conditions\" {\n  description = \"The conditions of the alarm rule\"\n  type        = list(object({\n    alarm_level         = optional(number, 2)\n    metric_name         = string\n    period              = number\n    filter              = string\n    comparison_operator = string\n    suppress_duration   = optional(number, 0)\n    value               = number\n    count               = number\n  }))\n\n  nullable = false\n\n  validation {\n    condition     = length(var.rule_conditions) > 0\n    error_message = \"The 'rule_conditions' is not allowed to be empty\"\n  }\n}\n\nvariable \"scaling_up_policy_name\" {\n  description = \"The name of the scaling up policy\"\n  type        = string\n}\n\nvariable \"scaling_up_cool_down_time\" {\n  description = \"The cool down time of the scaling up policy\"\n  type        = number\n  default     = 300\n}\n\nvariable \"scaling_up_instance_number\" {\n  description = \"The number of instances to add when the scaling up policy is triggered\"\n  type        = number\n  default     = 1\n}\n\nvariable \"scaling_down_policy_name\" {\n  description = \"The name of the scaling down policy\"\n  type        = string\n}\n\nvariable \"scaling_down_cool_down_time\" {\n  description = \"The cool down time of the scaling down policy\"\n  type        = number\n  default     = 300\n}\n\nvariable \"scaling_down_instance_number\" {\n  description = \"The number of instances to remove when the scaling down policy is triggered\"\n  type        = number\n  default     = 1\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/huaweicloud__terraform-provider-huaweicloud__examples__as__alarm-policy__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_vpc\" \"mod\" {\n  cidr_block           = \"${var.cidr}\"\n  instance_tenancy     = \"${var.instance_tenancy}\"\n  enable_dns_hostnames = \"${var.enable_dns_hostnames}\"\n  enable_dns_support   = \"${var.enable_dns_support}\"\n\n  enable_classiclink              = \"${var.enable_classiclink}\"\n  enable_classiclink_dns_support  = \"${var.enable_classiclink_dns_support}\"\n\n  tags = \"${merge(var.tags, map(\"Name\", format(\"%s\", var.name)))}\"\n}\n\nresource \"aws_internet_gateway\" \"mod\" {\n  count = \"${length(var.public_subnets) > 0 ? 1 : 0}\"\n\n  vpc_id = \"${aws_vpc.mod.id}\"\n\n  tags = \"${merge(var.tags, map(\"Name\", format(\"%s-igw\", var.name)))}\"\n}\n\nresource \"aws_route_table\" \"public\" {\n  count = \"${length(var.public_subnets) > 0 ? 1 : 0}\"\n\n  vpc_id           = \"${aws_vpc.mod.id}\"\n  propagating_vgws = [\"${var.public_propagating_vgws}\"]\n\n  tags = \"${merge(var.tags, map(\"Name\", format(\"%s-rt-public\", var.name)))}\"\n}\n\nresource \"aws_route\" \"public_internet_gateway\" {\n  count = \"${length(var.public_subnets) > 0 ? 1 : 0}\"\n\n  route_table_id         = \"${aws_route_table.public.id}\"\n  destination_cidr_block = \"0.0.0.0/0\"\n  gateway_id             = \"${aws_internet_gateway.mod.id}\"\n}\n\nresource \"aws_route\" \"private_nat_gateway\" {\n  count = \"${var.enable_nat_gateway ? length(var.azs) : 0}\"\n\n  route_table_id         = \"${element(aws_route_table.private.*.id, count.index)}\"\n  destination_cidr_block = \"0.0.0.0/0\"\n  nat_gateway_id         = \"${element(aws_nat_gateway.natgw.*.id, count.index)}\"\n}\n\nresource \"aws_route_table\" \"private\" {\n  count = \"${length(var.azs)}\"\n\n  vpc_id           = \"${aws_vpc.mod.id}\"\n  propagating_vgws = [\"${var.private_propagating_vgws}\"]\n\n  tags = \"${merge(var.tags, map(\"Name\", format(\"%s-rt-private-%s\", var.name, element(var.azs, count.index))))}\"\n}\n\nresource \"aws_subnet\" \"private\" {\n  count = \"${length(var.private_subnets)}\"\n\n  vpc_id            = \"${aws_vpc.mod.id}\"\n  cidr_block        = \"${var.private_subnets[count.index]}\"\n  availability_zone = \"${element(var.azs, count.index)}\"\n\n  tags = \"${merge(var.tags, var.private_subnet_tags, map(\"Name\", format(\"%s-subnet-private-%s\", var.name, element(var.azs, count.index))))}\"\n}\n\nresource \"aws_subnet\" \"database\" {\n  count = \"${length(var.database_subnets)}\"\n\n  vpc_id            = \"${aws_vpc.mod.id}\"\n  cidr_block        = \"${var.database_subnets[count.index]}\"\n  availability_zone = \"${element(var.azs, count.index)}\"\n\n  tags = \"${merge(var.tags, var.database_subnet_tags, map(\"Name\", format(\"%s-subnet-database-%s\", var.name, element(var.azs, count.index))))}\"\n}\n\nresource \"aws_db_subnet_group\" \"database\" {\n  count = \"${length(var.database_subnets) > 0 && var.create_database_subnet_group ? 1 : 0}\"\n\n  name        = \"${var.name}-rds-subnet-group\"\n  description = \"Database subnet groups for ${var.name}\"\n  subnet_ids  = [\"${aws_subnet.database.*.id}\"]\n\n  tags = \"${merge(var.tags, map(\"Name\", format(\"%s-database-subnet-group\", var.name)))}\"\n}\n\nresource \"aws_subnet\" \"elasticache\" {\n  count = \"${length(var.elasticache_subnets)}\"\n\n  vpc_id            = \"${aws_vpc.mod.id}\"\n  cidr_block        = \"${var.elasticache_subnets[count.index]}\"\n  availability_zone = \"${element(var.azs, count.index)}\"\n\n  tags = \"${merge(var.tags, var.elasticache_subnet_tags, map(\"Name\", format(\"%s-subnet-elasticache-%s\", var.name, element(var.azs, count.index))))}\"\n}\n\nresource \"aws_elasticache_subnet_group\" \"elasticache\" {\n  count = \"${length(var.elasticache_subnets) > 0 ? 1 : 0}\"\n\n  name        = \"${var.name}-elasticache-subnet-group\"\n  description = \"Elasticache subnet groups for ${var.name}\"\n  subnet_ids  = [\"${aws_subnet.elasticache.*.id}\"]\n}\n\nresource \"aws_subnet\" \"public\" {\n  count = \"${length(var.public_subnets)}\"\n\n  vpc_id                  = \"${aws_vpc.mod.id}\"\n  cidr_block              = \"${var.public_subnets[count.index]}\"\n  availability_zone       = \"${element(var.azs, count.index)}\"\n  map_public_ip_on_launch = \"${var.map_public_ip_on_launch}\"\n\n  tags = \"${merge(var.tags, var.public_subnet_tags, map(\"Name\", format(\"%s-subnet-public-%s\", var.name, element(var.azs, count.index))))}\"\n}\n\nresource \"aws_eip\" \"nateip\" {\n  count = \"${var.enable_nat_gateway ? (var.single_nat_gateway ? 1 : length(var.azs)) : 0}\"\n\n  vpc = true\n}\n\nresource \"aws_nat_gateway\" \"natgw\" {\n  count = \"${var.enable_nat_gateway ? (var.single_nat_gateway ? 1 : length(var.azs)) : 0}\"\n\n  allocation_id = \"${element(aws_eip.nateip.*.id, (var.single_nat_gateway ? 0 : count.index))}\"\n  subnet_id     = \"${element(aws_subnet.public.*.id, (var.single_nat_gateway ? 0 : count.index))}\"\n\n  depends_on = [\"aws_internet_gateway.mod\"]\n}\n\ndata \"aws_vpc_endpoint_service\" \"s3\" {\n  service = \"s3\"\n}\n\nresource \"aws_vpc_endpoint\" \"s3\" {\n  count = \"${var.enable_s3_endpoint}\"\n\n  vpc_id       = \"${aws_vpc.mod.id}\"\n  service_name = \"${data.aws_vpc_endpoint_service.s3.service_name}\"\n}\n\nresource \"aws_vpc_endpoint_route_table_association\" \"private_s3\" {\n  count = \"${var.enable_s3_endpoint ? length(var.private_subnets) : 0}\"\n\n  vpc_endpoint_id = \"${aws_vpc_endpoint.s3.id}\"\n  route_table_id  = \"${element(aws_route_table.private.*.id, count.index)}\"\n}\n\nresource \"aws_vpc_endpoint_route_table_association\" \"public_s3\" {\n  count = \"${var.enable_s3_endpoint ? length(var.public_subnets) : 0}\"\n\n  vpc_endpoint_id = \"${aws_vpc_endpoint.s3.id}\"\n  route_table_id  = \"${aws_route_table.public.id}\"\n}\n\ndata \"aws_vpc_endpoint_service\" \"dynamodb\" {\n  service = \"dynamodb\"\n}\n\nresource \"aws_vpc_endpoint\" \"dynamodb\" {\n  count = \"${var.enable_dynamodb_endpoint}\"\n\n  vpc_id       = \"${aws_vpc.mod.id}\"\n  service_name = \"${data.aws_vpc_endpoint_service.dynamodb.service_name}\"\n}\n\nresource \"aws_vpc_endpoint_route_table_association\" \"private_dynamodb\" {\n  count = \"${var.enable_dynamodb_endpoint ? length(var.private_subnets) : 0}\"\n\n  vpc_endpoint_id = \"${aws_vpc_endpoint.dynamodb.id}\"\n  route_table_id  = \"${element(aws_route_table.private.*.id, count.index)}\"\n}\n\nresource \"aws_vpc_endpoint_route_table_association\" \"public_dynamodb\" {\n  count = \"${var.enable_dynamodb_endpoint ? length(var.public_subnets) : 0}\"\n\n  vpc_endpoint_id = \"${aws_vpc_endpoint.dynamodb.id}\"\n  route_table_id  = \"${aws_route_table.public.id}\"\n}\n\nresource \"aws_route_table_association\" \"private\" {\n  count = \"${length(var.private_subnets)}\"\n\n  subnet_id      = \"${element(aws_subnet.private.*.id, count.index)}\"\n  route_table_id = \"${element(aws_route_table.private.*.id, count.index)}\"\n}\n\nresource \"aws_route_table_association\" \"database\" {\n  count = \"${length(var.database_subnets)}\"\n\n  subnet_id      = \"${element(aws_subnet.database.*.id, count.index)}\"\n  route_table_id = \"${element(aws_route_table.private.*.id, count.index)}\"\n}\n\nresource \"aws_route_table_association\" \"elasticache\" {\n  count = \"${length(var.elasticache_subnets)}\"\n\n  subnet_id      = \"${element(aws_subnet.elasticache.*.id, count.index)}\"\n  route_table_id = \"${element(aws_route_table.private.*.id, count.index)}\"\n}\n\nresource \"aws_route_table_association\" \"public\" {\n  count = \"${length(var.public_subnets)}\"\n\n  subnet_id      = \"${element(aws_subnet.public.*.id, count.index)}\"\n  route_table_id = \"${aws_route_table.public.id}\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-community-modules__tf_aws_vpc__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-community-modules__tf_aws_vpc__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-community-modules__tf_aws_vpc__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#resource block\nresource \"aws_instance\" \"my_ec2\" {\n  ami           = var.my_ami\n  instance_type = var.my_instance_type\n  key_name      = var.my_key\n\n  tags = {\n    \"Name\" = \"Ec2-Demo\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__1. default-var-example__ec2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__1. default-var-example__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__1. default-var-example__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__1. default-var-example__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__1. default-var-example__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__1. default-var-example__ec2.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n    region = \"us-west-2\"\n}\n\nvariable \"bucket_name\" {\n    type = string\n}\n\nresource \"aws_s3_bucket\" \"website\" {\n  bucket = var.bucket_name\n  acl = \"public-read\"\n  policy = <<-EOF\n    {\n      \"Version\": \"2008-10-17\",\n      \"Statement\": [\n        {\n          \"Sid\": \"PublicReadForGetBucketObjects\",\n          \"Effect\": \"Allow\",\n          \"Principal\": {\n            \"AWS\": \"*\"\n          },\n          \"Action\": \"s3:GetObject\",\n          \"Resource\": \"arn:aws:s3:::${var.bucket_name}/*\"\n        }\n      ]\n    }\n  EOF\n\n  website {\n    index_document = \"index.html\"\n  }\n}\n\nresource \"aws_s3_bucket_object\" \"object\" {\n  bucket = aws_s3_bucket.website.bucket\n  key    = \"index.html\"\n  source = \"index.html\"\n  etag = filemd5(\"${path.module}/index.html\") #A\n  content_type = \"text/html\"\n}\n\noutput \"endpoint\" { #B\n  value = aws_s3_bucket.website.website_endpoint\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.11__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_70", "severity": "HIGH", "message": "Ensure S3 bucket does not allow an action with any Principal", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.11__main.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV_AWS_186", "severity": "HIGH", "message": "Ensure S3 bucket Object is encrypted by KMS using a customer managed Key (CMK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.11__main.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.11__main.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.11__main.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.11__main.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.11__main.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.11__main.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.11__main.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.11__main.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV_AWS_20", "severity": "HIGH", "message": "S3 Bucket has an ACL defined which allows public READ access.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.11__main.tf", "start_line": 9}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"cloud_controller_user\" {\n  value = \"${oci_identity_user.cloud_controller_user.id}\"\n}\n\noutput \"cloud_controller_public_key\" {\n  value = \"${tls_private_key.cloud_controller_user_key.public_key_pem}\"\n}\n\noutput \"cloud_controller_private_key\" {\n  sensitive = true\n  value = \"${tls_private_key.cloud_controller_user_key.private_key_pem}\"\n}\n\noutput \"cloud_controller_user_fingerprint\" {\n  value = \"run 'terraform output cloud_controller_private_key > cc_key && openssl rsa -in cc_key -pubout -outform DER | openssl md5 -c && rm cc_key' determine the fingerprint\"\n}\n\noutput \"flexvolume_driver_user\" {\n  value = \"${oci_identity_user.flexvolume_driver_user.id}\"\n}\n\noutput \"flexvolume_driver_public_key\" {\n  value = \"${tls_private_key.flexvolume_driver_user_key.public_key_pem}\"\n}\n\noutput \"flexvolume_driver_private_key\" {\n  sensitive = true\n  value = \"${tls_private_key.flexvolume_driver_user_key.private_key_pem}\"\n}\n\noutput \"flexvolume_driver_user_fingerprint\" {\n  value = \"run 'terraform output flexvolume_driver_private_key > cc_key && openssl rsa -in cc_key -pubout -outform DER | openssl md5 -c && rm cc_key' determine the fingerprint\"\n}\n\noutput \"volume_provisioner_user\" {\n  value = \"${oci_identity_user.volume_provisioner_user.id}\"\n}\n\noutput \"volume_provisioner_public_key\" {\n  value = \"${tls_private_key.volume_provisioner_user_key.public_key_pem}\"\n}\n\noutput \"volume_provisioner_private_key\" {\n  sensitive = true\n  value = \"${tls_private_key.volume_provisioner_user_key.private_key_pem}\"\n}\n\noutput \"volume_provisioner_user_fingerprint\" {\n  value = \"run 'terraform output volume_provisioner_private_key > cc_key && openssl rsa -in cc_key -pubout -outform DER | openssl md5 -c && rm cc_key' determine the fingerprint\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/oracle__terraform-kubernetes-installer__identity__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"template_file\" \"kms_policy\" {\n  template = \"${file(\"${kms_policy.json.tpl\")}\"\n\n  vars {\n    account_id = \"${var.account_id}\"\n  }\n}\n\nresource \"aws_kms_key\" \"key\" {\n  policy = \"${data.template_file.kms_policy.rendered}\"\n}\n\nresource \"aws_cloudwatch_log_group\" \"yada\" {\n  name = \"vijay\"\n\n  kms_key_id = aws_kms_key.key.arn\n\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_7", "severity": "HIGH", "message": "Ensure rotation for customer created CMKs is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__main.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV_AWS_66", "severity": "HIGH", "message": "Ensure that CloudWatch Log Group specifies retention days", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_338", "severity": "HIGH", "message": "Ensure CloudWatch log groups retains logs for at least 1 year", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__main.tf", "start_line": 13}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"oci_core_vcn\" \"_\" {\n  compartment_id = local.compartment_id\n  cidr_block     = \"10.0.0.0/16\"\n}\n\nresource \"oci_core_internet_gateway\" \"_\" {\n  compartment_id = local.compartment_id\n  vcn_id         = oci_core_vcn._.id\n}\n\nresource \"oci_core_default_route_table\" \"_\" {\n  manage_default_resource_id = oci_core_vcn._.default_route_table_id\n  route_rules {\n    destination       = \"0.0.0.0/0\"\n    destination_type  = \"CIDR_BLOCK\"\n    network_entity_id = oci_core_internet_gateway._.id\n  }\n}\n\nresource \"oci_core_default_security_list\" \"_\" {\n  manage_default_resource_id = oci_core_vcn._.default_security_list_id\n  ingress_security_rules {\n    protocol = \"all\"\n    source   = \"0.0.0.0/0\"\n  }\n  egress_security_rules {\n    protocol    = \"all\"\n    destination = \"0.0.0.0/0\"\n  }\n}\n\nresource \"oci_core_subnet\" \"_\" {\n  compartment_id    = local.compartment_id\n  cidr_block        = \"10.0.0.0/24\"\n  vcn_id            = oci_core_vcn._.id\n  route_table_id    = oci_core_default_route_table._.id\n  security_list_ids = [oci_core_default_security_list._.id]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jpetazzo__ampernetacle__network.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-cloudwatch__examples__cis-alarms__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\nCopyright 2023 The Kubernetes Authors.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n/*\nThis file defines:\n- Required provider versions\n- Storage backend details\n*/\n\nterraform {\n  backend \"s3\" {\n    bucket = \"k8s-aws-root-account-terraform-state\"\n    region = \"us-east-2\"\n    key    = \"audit-account/terraform.state\"\n  }\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.52.0\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubernetes__k8s.io__infra__aws__terraform__audit-account__terraform.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Terraform Block\nterraform {\n  required_version = \"~> 0.14.6\" # which means >= 0.14.6 and < 0.15\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 3.0\"\n    }\n  }\n}\n\n# Provider Block\nprovider \"aws\" {\n  region  = \"us-east-1\"\n  profile = \"default\"\n}\n/*\nNote-1:  AWS Credentials Profile (profile = \"default\") configured on your local desktop terminal  \n$HOME/.aws/credentials\n*/\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__04-Terraform-Resources__04-02-Meta-Argument-depends_on__terraform-manifests__c1-versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"inbound_rules\" {\n    type = list\n    default = [\n        {\n            port = 22,\n            allowed_cidr = [\"0.0.0.0/0\"]\n            protocol         = \"tcp\"\n        },\n        {\n            port = 80,\n            allowed_cidr = [\"0.0.0.0/0\"]\n            protocol         = \"tcp\"\n        },\n        {\n            port = 8080,\n            allowed_cidr = [\"0.0.0.0/0\"]\n            protocol         = \"tcp\"\n        },\n        {\n            port = 3306,\n            allowed_cidr = [\"0.0.0.0/0\"]\n            protocol         = \"tcp\"\n        }\n    ]\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__dynamic__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nterraform {\n  required_providers {\n    google = {\n      source = \"hashicorp/google\"\n      version = \"~> {{.Provider.version}}\"\n    }\n  }\n}\n\nprovider \"google\" {\n  {{if .Provider.credentials }}credentials = \"{{.Provider.credentials}}\"{{end}}\n}\n\nresource \"google_bigquery_dataset\" \"example_dataset\" {\n  dataset_id                  = \"test-dataset\"\n  location                    = \"EU\"\n  project                     = \"{{.Provider.project}}\"\n  default_table_expiration_ms = 3600000\n\n  labels = {\n    env = \"dev\"\n  }\n  \n}\n\nresource \"google_bigquery_dataset_iam_binding\" \"dataset\" {\n  dataset_id = google_bigquery_dataset.example_dataset.dataset_id\n  role       = \"roles/bigquery.dataViewer\"\n\n  members = [\n    \"allUsers\",\"allAuthenticatedUsers\"\n  ]\n}\n\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-validator__testdata__templates__example_bigquery_dataset_iam_binding.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-validator__testdata__templates__example_bigquery_dataset_iam_binding.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-validator__testdata__templates__example_bigquery_dataset_iam_binding.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_region\" \"selected\" {}\n\ndata \"aws_availability_zones\" \"available\" {}\n\ndata \"aws_ami\" \"ubuntu_1804\" {\n  most_recent = true\n  owners      = [\"099720109477\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu-minimal/images/*/ubuntu-bionic-18.04-*\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  filter {\n    name   = \"root-device-type\"\n    values = [\"ebs\"]\n  }\n\n  filter {\n    name   = \"architecture\"\n    values = [\"x86_64\"]\n  }\n}\n\ndata \"aws_ami\" \"amazon_linux2\" {\n  most_recent = true\n  owners = [\"137112412989\"] # Amazon\n\n  filter {\n    name   = \"name\"\n    values = [\"amzn2-ami-hvm-*\"]\n  }\n\n  filter {\n    name   = \"root-device-type\"\n    values = [\"ebs\"]\n  }\n\n  filter {\n    name   = \"architecture\"\n    values = [\"x86_64\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Genaker__TerraformMagentoCloud__modules__aws-data__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Backend Remote Terraform State Configuration\n# bucket: S3 Bucket ID\n# key: file or directory/file path to save ej: testdir/terraform.tfstate\n# dynamodb_table: Table in AWS DynamoDB created with \"LockID\" Main Key\n# To force unlock the state excecute follow command:\n# terraform init -backend-config.yaml=\"access_key=<ID>\" -backend-config.yaml=\"secret_key=<ID>\"\nterraform {\n  backend \"s3\" {\n    bucket         = \"tfstate-tar-testing\"\n    dynamodb_table = \"state-lock-tfstate-tar\"\n    key            = \"environments/testing/aws-s3-bucket.tfstate\"\n    region         = \"eu-central-1\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/TheAutomationRules__terraform__Video_04_Remote_State__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"ap-south-1\" #mumbai region\n}\n\ndata \"aws_ami\" \"example\" {\n  owners = [\"amazon\"]\n  filter {\n    name   = \"image-id\"\n    values = [\"ami-019774e5caffd1685\"] #this is a arm architecture ami\n  }\n}\n\nresource \"aws_instance\" \"example\" {\n  ami = data.aws_ami.example.id\n  instance_type = \"t2.micro\"\n  lifecycle {\n    precondition {\n      condition     = data.aws_ami.example.architecture == \"x86_64\"\n      error_message = \"The selected AMI must be for the x86_64 architecture.\"\n    }\n  }\n  tags = {\n     Name = \"india-server\"\n   }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__custom-condition-checks.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__custom-condition-checks.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__custom-condition-checks.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__custom-condition-checks.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__custom-condition-checks.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__custom-condition-checks.tf", "start_line": 13}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"test_instance\" \"foo\" {\n    ami = \"bar\"\n\n    # This is here because at some point it caused a test failure\n    network_interface {\n      device_index = 0\n      description = \"Main network interface\"\n    }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform__internal__backend__local__testdata__plan__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  access_key = \"\"\n  secret_key = \"\"\n  region     = \"us-east-1\"\n}\n\n## Create VPC ##\nresource \"aws_vpc\" \"terraform-vpc\" {\n  cidr_block           = \"172.16.0.0/16\"\n  enable_dns_hostnames = true\n  tags = {\n    Name = \"terraform-demo-vpc\"\n  }\n}\n\noutput \"aws_vpc_id\" {\n  value = aws_vpc.terraform-vpc.id\n}\n\n## Security Group##\nresource \"aws_security_group\" \"terraform_private_sg\" {\n  description = \"Allow limited inbound external traffic\"\n  vpc_id      = aws_vpc.terraform-vpc.id\n  name        = \"terraform_ec2_private_sg\"\n\n  ingress {\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n    from_port   = 22\n    to_port     = 22\n  }\n\n  ingress {\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n    from_port   = 8080\n    to_port     = 8080\n  }\n\n  ingress {\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n    from_port   = 443\n    to_port     = 443\n  }\n\n  egress {\n    protocol    = -1\n    cidr_blocks = [\"0.0.0.0/0\"]\n    from_port   = 0\n    to_port     = 0\n  }\n\n  tags = {\n    Name = \"ec2-private-sg\"\n  }\n}\n\noutput \"aws_security_gr_id\" {\n  value = aws_security_group.terraform_private_sg.id\n}\n\n## Create Subnets ##\nresource \"aws_subnet\" \"terraform-subnet_1\" {\n  vpc_id            = aws_vpc.terraform-vpc.id\n  cidr_block        = \"172.16.10.0/24\"\n  availability_zone = \"us-east-1a\"\n\n  tags = {\n    Name = \"terraform-subnet_1\"\n  }\n}\n\noutput \"aws_subnet_subnet_1\" {\n  value = aws_subnet.terraform-subnet_1.id\n}\n\nresource \"aws_instance\" \"terraform_wapp\" {\n  ami                         = \"ami-0ed9277fb7eb570c9\"\n  instance_type               = \"t2.micro\"\n  vpc_security_group_ids      = [\"${aws_security_group.terraform_private_sg.id}\"]\n  subnet_id                   = aws_subnet.terraform-subnet_1.id\n  count                       = 1\n  associate_public_ip_address = true\n  tags = {\n    Name        = \"terraform_ec2_wapp_awsdev\"\n    Environment = \"development\"\n    Project     = \"DEMO-TERRAFORM\"\n  }\n}\n\noutput \"instance_id_list\" { value = [\"${aws_instance.terraform_wapp.*.id}\"] }\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-4__demo-ec2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-4__demo-ec2.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-4__demo-ec2.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-4__demo-ec2.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-4__demo-ec2.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-4__demo-ec2.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-4__demo-ec2.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-4__demo-ec2.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-4__demo-ec2.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-4__demo-ec2.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-4__demo-ec2.tf", "start_line": 8}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 0.12.6\"\n\n  required_providers {\n    aws = \">= 2.65\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kserge2001__terraform__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2022-2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nterraform {\n  required_version = \">=1.3\"\n\n  required_providers {\n    google = {\n      source  = \"hashicorp/google\"\n      version = \">= 7.0.0, < 8\"\n    }\n    kubernetes = {\n      source  = \"hashicorp/kubernetes\"\n      version = \"~> 2.10\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \">= 2.1\"\n    }\n  }\n  provider_meta \"google\" {\n    module_name = \"blueprints/terraform/terraform-google-kubernetes-engine/v41.0.2\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-kubernetes-engine__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# postgresql\noutput \"postgres_db_instance_address\" {\n  description = \"The address of the RDS instance\"\n  value       = module.postgres.db_instance_address\n}\n\noutput \"postgres_db_instance_arn\" {\n  description = \"The ARN of the RDS instance\"\n  value       = module.postgres.db_instance_arn\n}\n\noutput \"postgres_db_instance_availability_zone\" {\n  description = \"The availability zone of the RDS instance\"\n  value       = module.postgres.db_instance_availability_zone\n}\n\noutput \"postgres_db_instance_endpoint\" {\n  description = \"The connection endpoint\"\n  value       = module.postgres.db_instance_endpoint\n}\n\noutput \"postgres_db_instance_engine\" {\n  description = \"The database engine\"\n  value       = module.postgres.db_instance_engine\n}\n\noutput \"postgres_db_instance_engine_version_actual\" {\n  description = \"The running version of the database\"\n  value       = module.postgres.db_instance_engine_version_actual\n}\n\noutput \"postgres_db_instance_hosted_zone_id\" {\n  description = \"The canonical hosted zone ID of the DB instance (to be used in a Route 53 Alias record)\"\n  value       = module.postgres.db_instance_hosted_zone_id\n}\n\noutput \"postgres_db_instance_identifier\" {\n  description = \"The RDS instance identifier\"\n  value       = module.postgres.db_instance_identifier\n}\n\noutput \"postgres_db_instance_resource_id\" {\n  description = \"The RDS Resource ID of this instance\"\n  value       = module.postgres.db_instance_resource_id\n}\n\noutput \"postgres_db_instance_status\" {\n  description = \"The RDS instance status\"\n  value       = module.postgres.db_instance_status\n}\n\noutput \"postgres_db_instance_name\" {\n  description = \"The database name\"\n  value       = module.postgres.db_instance_name\n}\n\noutput \"postgres_db_instance_username\" {\n  description = \"The master username for the database\"\n  value       = module.postgres.db_instance_username\n  sensitive   = true\n}\n\noutput \"postgres_db_instance_port\" {\n  description = \"The database port\"\n  value       = module.postgres.db_instance_port\n}\n\noutput \"postgres_db_subnet_group_id\" {\n  description = \"The db subnet group name\"\n  value       = module.postgres.db_subnet_group_id\n}\n\noutput \"postgres_db_subnet_group_arn\" {\n  description = \"The ARN of the db subnet group\"\n  value       = module.postgres.db_subnet_group_arn\n}\n\noutput \"postgres_db_parameter_group_id\" {\n  description = \"The db parameter group id\"\n  value       = module.postgres.db_parameter_group_id\n}\n\noutput \"postgres_db_parameter_group_arn\" {\n  description = \"The ARN of the db parameter group\"\n  value       = module.postgres.db_parameter_group_arn\n}\n\noutput \"postgres_db_instance_cloudwatch_log_groups\" {\n  description = \"Map of CloudWatch log groups created and their attributes\"\n  value       = module.postgres.db_instance_cloudwatch_log_groups\n}\n\n# mysql\noutput \"mysql_db_instance_address\" {\n  description = \"The address of the RDS instance\"\n  value       = module.mysql.db_instance_address\n}\n\noutput \"mysql_db_instance_arn\" {\n  description = \"The ARN of the RDS instance\"\n  value       = module.mysql.db_instance_arn\n}\n\noutput \"mysql_db_instance_availability_zone\" {\n  description = \"The availability zone of the RDS instance\"\n  value       = module.mysql.db_instance_availability_zone\n}\n\noutput \"mysql_db_instance_endpoint\" {\n  description = \"The connection endpoint\"\n  value       = module.mysql.db_instance_endpoint\n}\n\noutput \"mysql_db_instance_engine\" {\n  description = \"The database engine\"\n  value       = module.mysql.db_instance_engine\n}\n\noutput \"mysql_db_instance_engine_version_actual\" {\n  description = \"The running version of the database\"\n  value       = module.mysql.db_instance_engine_version_actual\n}\n\noutput \"mysql_db_instance_hosted_zone_id\" {\n  description = \"The canonical hosted zone ID of the DB instance (to be used in a Route 53 Alias record)\"\n  value       = module.mysql.db_instance_hosted_zone_id\n}\n\noutput \"mysql_db_instance_identifier\" {\n  description = \"The RDS instance identifier\"\n  value       = module.mysql.db_instance_identifier\n}\n\noutput \"mysql_db_instance_resource_id\" {\n  description = \"The RDS Resource ID of this instance\"\n  value       = module.mysql.db_instance_resource_id\n}\n\noutput \"db_instance_status\" {\n  description = \"The RDS instance status\"\n  value       = module.mysql.db_instance_status\n}\n\noutput \"mysql_db_instance_name\" {\n  description = \"The database name\"\n  value       = module.mysql.db_instance_name\n}\n\noutput \"mysql_db_instance_username\" {\n  description = \"The master username for the database\"\n  value       = module.mysql.db_instance_username\n  sensitive   = true\n}\n\noutput \"mysql_db_instance_port\" {\n  description = \"The database port\"\n  value       = module.mysql.db_instance_port\n}\n\noutput \"mysql_db_subnet_group_id\" {\n  description = \"The db subnet group name\"\n  value       = module.mysql.db_subnet_group_id\n}\n\noutput \"mysql_db_subnet_group_arn\" {\n  description = \"The ARN of the db subnet group\"\n  value       = module.mysql.db_subnet_group_arn\n}\n\noutput \"mysql_db_parameter_group_id\" {\n  description = \"The db parameter group id\"\n  value       = module.mysql.db_parameter_group_id\n}\n\noutput \"mysql_db_parameter_group_arn\" {\n  description = \"The ARN of the db parameter group\"\n  value       = module.mysql.db_parameter_group_arn\n}\n\noutput \"mysql_db_instance_cloudwatch_log_groups\" {\n  description = \"Map of CloudWatch log groups created and their attributes\"\n  value       = module.mysql.db_instance_cloudwatch_log_groups\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-rds__examples__blue-green-deployment__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"datadog_application_key\" \"foo\" {\n  name = \"foo-application\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DataDog__terraform-provider-datadog__examples__data-sources__datadog_application_key__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// TERRAMATE: GENERATED AUTOMATICALLY DO NOT EDIT\n\nresource \"local_file\" \"cloudsync\" {\n  content = <<-EOT\npackage cloudsync // import \"github.com/terramate-io/terramate/cloudsync\"\n\nPackage cloudsync provides helper functions for cloud sync operations.\n\nconst ProvisionerTerraform = \"terraform\" ...\nfunc AfterRun(e *engine.Engine, run engine.StackCloudRun, state *CloudRunState, ...)\nfunc BeforeRun(e *engine.Engine, run engine.StackCloudRun, state *CloudRunState)\nfunc CreateCloudDeployment(e *engine.Engine, wd string, deployRuns []engine.StackCloudRun, ...) error\nfunc CreateCloudPreview(e *engine.Engine, gitfilter engine.GitFilter, runs []engine.StackCloudRun, ...) map[string]string\nfunc DetectCloudMetadata(e *engine.Engine, state *CloudRunState)\nfunc Logs(logger *zerolog.Logger, e *engine.Engine, run engine.StackRun, ...)\ntype CloudRunState struct{ ... }\nEOT\n\n  filename = \"${path.module}/mock-cloudsync.ignore\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terramate-io__terramate__cloudsync___test_mock.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/* template files for registry and ecs role policies */\nresource \"template_file\" \"registry_policy\" {\n  template = \"${file(\"policies/registry.json\")}\"\n\n  vars {\n    s3_bucket_name = \"${var.s3_bucket_name}\"\n  }\n}\n\nresource \"template_file\" \"ecs_service_role_policy\" {\n  template = \"${file(\"policies/ecs-service-role-policy.json\")}\"\n\n  vars {\n    s3_bucket_name = \"${var.s3_bucket_name}\"\n  }\n}\n\nresource \"template_file\" \"registry_task\" {\n  template = \"${file(\"task-definitions/registry.json\")}\"\n\n  vars {\n    s3_bucket_name        = \"${aws_s3_bucket.registry.id}\"\n    s3_bucket_region      = \"${aws_s3_bucket.registry.region}\"\n    s3_bucket_access_key  = \"${aws_iam_access_key.registry.id}\"\n    s3_bucket_secret_key  = \"${aws_iam_access_key.registry.secret}\"\n    registry_docker_image = \"${var.registry_docker_image}\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Capgemini__terraform-amazon-ecs__templates.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"kubectl\" {}\n\nresource \"kubectl_manifest\" \"test\" {\n    yaml_body = <<YAML\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: name-here\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: \"/\"\n    azure/frontdoor: enabled\n    azure/sensitive: \"this is a big secret\"\nspec:\n  ingressClassName: \"nginx\"\n  rules:\n  - host: \"*.example.com\"\n    http:\n      paths:\n      - path: \"/testpath\"\n        pathType: \"Prefix\"\n        backend:\n          service:\n            name: test\n            port:\n              number: 80\n    YAML\n\n  sensitive_fields = [\n    \"metadata.annotations.azure/sensitive\",\n  ]\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gavinbunney__terraform-provider-kubectl__test__e2e__ingress_basic__basic_ingress.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#\n# iam roles\n#\nresource \"aws_iam_role\" \"demo-codebuild\" {\n  name = \"demo-codebuild\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"codebuild.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nEOF\n\n}\n\nresource \"aws_iam_role_policy\" \"demo-codebuild\" {\n  role = aws_iam_role.demo-codebuild.name\n\n  policy = <<POLICY\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ]\n    },\n    {\n      \"Sid\": \"CodeCommitPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codecommit:GitPull\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\"\n      ],\n      \"Resource\": [\n        \"${aws_s3_bucket.codebuild-cache.arn}\",\n        \"${aws_s3_bucket.codebuild-cache.arn}/*\"\n      ]\n    },\n    {\n      \"Effect\":\"Allow\",\n      \"Action\": [\n        \"s3:List*\",\n        \"s3:Put*\",\n        \"s3:Get*\"\n      ],\n      \"Resource\": [\n        \"${aws_s3_bucket.demo-artifacts.arn}\",\n        \"${aws_s3_bucket.demo-artifacts.arn}/*\"\n      ]\n    },\n    {\n      \"Sid\": \"ECRPushPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:BatchCheckLayerAvailability\",\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:GetRepositoryPolicy\",\n        \"ecr:DescribeRepositories\",\n        \"ecr:ListImages\",\n        \"ecr:DescribeImages\",\n        \"ecr:BatchGetImage\",\n        \"ecr:InitiateLayerUpload\",\n        \"ecr:UploadLayerPart\",\n        \"ecr:CompleteLayerUpload\",\n        \"ecr:PutImage\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"ECRAuthPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetAuthorizationToken\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }, \n    {\n      \"Sid\": \"ECS\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecs:List*\",\n        \"ecs:Describe*\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }, \n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n         \"kms:DescribeKey\",\n         \"kms:GenerateDataKey*\",\n         \"kms:Encrypt\",\n         \"kms:ReEncrypt*\",\n         \"kms:Decrypt\"\n        ],\n      \"Resource\": [\n         \"${aws_kms_key.demo-artifacts.arn}\"\n        ]\n    }\n  ]\n}\nPOLICY\n\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wardviaene__terraform-course__codepipeline-demo__iam-codebuild.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wardviaene__terraform-course__codepipeline-demo__iam-codebuild.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wardviaene__terraform-course__codepipeline-demo__iam-codebuild.tf", "start_line": 24}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\n# Create an IAM policy\nresource \"aws_iam_policy\" \"jenkins_iam_policy\" {\n  name = var.iam_policy_name\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"ssm:GetParameter\",\n          \"ssm:GetParameters\",\n          \"ssm:GetParametersByPath\"\n        ]\n        Resource = \"*\"\n      }\n    ]\n  })\n}\n\n# Create an IAM role\nresource \"aws_iam_role\" \"jenkins_role\" {\n  name = var.role_name\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"ec2.amazonaws.com\"\n        }\n        Action = \"sts:AssumeRole\"\n      }\n    ]\n  })\n}\n\n# Attach the IAM policy to the IAM role\nresource \"aws_iam_policy_attachment\" \"jenkins_role_policy_attachment\" {\n  name = \"Policy Attachement\"\n  policy_arn = aws_iam_policy.jenkins_iam_policy.arn\n  roles       = [aws_iam_role.jenkins_role.name]\n}\n\n# Create an IAM instance profile\nresource \"aws_iam_instance_profile\" \"jenkins_instance_profile\" {\n  name = var.instance_profile_name\n  role = aws_iam_role.jenkins_role.name\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__iam__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_288", "severity": "HIGH", "message": "Ensure IAM policies does not allow data exfiltration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__iam__main.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__iam__main.tf", "start_line": 3}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_codecommit_repository\" \"demo\" {\n  repository_name = \"demo\"\n  description     = \"This is the demo repository\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__codecommit.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_37", "severity": "CRITICAL", "message": "Ensure CodeCommit associates an approval rule", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__codecommit.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.1\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = var.aws_region\n}\n\nmodule \"s3_bucket\" {\n  source = \"../../modules/s3-bucket\"\n\n  name = var.name\n\n  # Do NOT copy this into product code. We only set this param to true here so that the automated tests can clean up.\n  force_destroy = true\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terragrunt-infrastructure-modules-example__examples__s3-bucket__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nterraform {\n  cloud {\n    workspaces {\n      name = \"go-tfe-examples-run_errors\"\n    }\n  }\n}\n\n# The following example should return an error\ndata \"http\" \"example_head\" {\n  url    = \"https://this-shall-not-exist.hashicorp.com/example\"\n  method = \"GET\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__go-tfe__examples__run_errors__terraform__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"web\"{\n\n    ami =  local.ami_id#AMI ID will be different every region, this is OS\n    instance_type = \"t3.micro\"\n    key_name = aws_key_pair.terraform.key_name\n}\n\nresource \"aws_key_pair\" \"terraform\" {\n    key_name   = \"terraform\"\n    # this file function will read the terraform.pub and fetch the content\n    public_key = file(\"${path.module}/terraform.pub\")\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-04__ec2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-04__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-04__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-04__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-04__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-04__ec2.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nprovider \"aws\" {\n  region = var.aws_region\n}\n\ndata \"aws_availability_zones\" \"available\" {}\n\nlocals {\n  cluster_name = \"abhi-eks-${random_string.suffix.result}\"\n}\n\nresource \"random_string\" \"suffix\" {\n  length  = 8\n  special = false\n}\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"5.7.0\"\n\n  name                 = \"abhi-eks-vpc\"\n  cidr                 = var.vpc_cidr\n  azs                  = data.aws_availability_zones.available.names\n  private_subnets      = [\"10.0.1.0/24\", \"10.0.2.0/24\"]\n  public_subnets       = [\"10.0.4.0/24\", \"10.0.5.0/24\"]\n  enable_nat_gateway   = true\n  single_nat_gateway   = true\n  enable_dns_hostnames = true\n  enable_dns_support   = true\n\n  tags = {\n    \"kubernetes.io/cluster/${local.cluster_name}\" = \"shared\"\n  }\n\n  public_subnet_tags = {\n    \"kubernetes.io/cluster/${local.cluster_name}\" = \"shared\"\n    \"kubernetes.io/role/elb\"                      = \"1\"\n  }\n\n  private_subnet_tags = {\n    \"kubernetes.io/cluster/${local.cluster_name}\" = \"shared\"\n    \"kubernetes.io/role/internal-elb\"             = \"1\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-eks__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-eks__vpc.tf", "start_line": 17}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"kubernetes_deployment\" \"coredns\" {\n  wait_for_rollout = false\n  metadata {\n    name      = \"coredns\"\n    namespace = \"kube-system\"\n    labels = {\n      k8s-app              = \"coredns\"\n      \"kubernetes.io/name\" = \"CoreDNS\"\n    }\n  }\n  spec {\n    replicas = var.replicas\n    strategy {\n      type = \"RollingUpdate\"\n      rolling_update {\n        max_unavailable = \"1\"\n      }\n    }\n    selector {\n      match_labels = {\n        k8s-app = \"coredns\"\n        tier    = \"control-plane\"\n      }\n    }\n    template {\n      metadata {\n        labels = {\n          k8s-app = \"coredns\"\n          tier    = \"control-plane\"\n        }\n      }\n      spec {\n        affinity {\n          node_affinity {\n            preferred_during_scheduling_ignored_during_execution {\n              weight = 100\n              preference {\n                match_expressions {\n                  key      = \"node.kubernetes.io/controller\"\n                  operator = \"Exists\"\n                }\n              }\n            }\n          }\n          pod_anti_affinity {\n            preferred_during_scheduling_ignored_during_execution {\n              weight = 100\n              pod_affinity_term {\n                label_selector {\n                  match_expressions {\n                    key      = \"tier\"\n                    operator = \"In\"\n                    values   = [\"control-plane\"]\n                  }\n                  match_expressions {\n                    key      = \"k8s-app\"\n                    operator = \"In\"\n                    values   = [\"coredns\"]\n                  }\n                }\n                topology_key = \"kubernetes.io/hostname\"\n              }\n            }\n          }\n        }\n        dns_policy          = \"Default\"\n        priority_class_name = \"system-cluster-critical\"\n        security_context {\n          seccomp_profile {\n            type = \"RuntimeDefault\"\n          }\n        }\n        service_account_name = \"coredns\"\n        toleration {\n          key    = \"node-role.kubernetes.io/controller\"\n          effect = \"NoSchedule\"\n        }\n        container {\n          name  = \"coredns\"\n          image = \"registry.k8s.io/coredns/coredns:v1.13.1\"\n          args  = [\"-conf\", \"/etc/coredns/Corefile\"]\n          port {\n            name           = \"dns\"\n            container_port = 53\n            protocol       = \"UDP\"\n          }\n          port {\n            name           = \"dns-tcp\"\n            container_port = 53\n            protocol       = \"TCP\"\n          }\n          port {\n            name           = \"metrics\"\n            container_port = 9153\n            protocol       = \"TCP\"\n          }\n          resources {\n            requests = {\n              cpu    = \"100m\"\n              memory = \"70Mi\"\n            }\n            limits = {\n              memory = \"170Mi\"\n            }\n          }\n          security_context {\n            capabilities {\n              add  = [\"NET_BIND_SERVICE\"]\n              drop = [\"all\"]\n            }\n            read_only_root_filesystem = true\n          }\n          liveness_probe {\n            http_get {\n              path   = \"/health\"\n              port   = \"8080\"\n              scheme = \"HTTP\"\n            }\n            initial_delay_seconds = 60\n            timeout_seconds       = 5\n            success_threshold     = 1\n            failure_threshold     = 5\n          }\n          readiness_probe {\n            http_get {\n              path   = \"/ready\"\n              port   = \"8181\"\n              scheme = \"HTTP\"\n            }\n          }\n          volume_mount {\n            name       = \"config\"\n            mount_path = \"/etc/coredns\"\n            read_only  = true\n          }\n        }\n        volume {\n          name = \"config\"\n          config_map {\n            name = \"coredns\"\n            items {\n              key  = \"Corefile\"\n              path = \"Corefile\"\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__typhoon__addons__coredns__deployment.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_K8S_25", "severity": "HIGH", "message": "Minimize the admission of containers with added capability", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__typhoon__addons__coredns__deployment.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_11", "severity": "HIGH", "message": "CPU Limits should be set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__typhoon__addons__coredns__deployment.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_28", "severity": "HIGH", "message": "Minimize the admission of containers with the NET_RAW capability", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__typhoon__addons__coredns__deployment.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_43", "severity": "HIGH", "message": "Image should use digest", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__typhoon__addons__coredns__deployment.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_15", "severity": "HIGH", "message": "Image Pull Policy should be Always", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__typhoon__addons__coredns__deployment.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.0.0, < 2.0.0\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-east-2\"\n}\n\nresource \"aws_instance\" \"example\" {\n  ami           = \"ami-0fb653ca2d3203ac1\"\n  instance_type = \"t2.micro\"\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__00-preface__hello-world__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__00-preface__hello-world__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__00-preface__hello-world__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__00-preface__hello-world__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__00-preface__hello-world__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__00-preface__hello-world__main.tf", "start_line": 16}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\noutput \"role_id\" {\n  value       = module.custom-role-project.custom_role_id\n  description = \"ID of the custom role created at project level.\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-iam__examples__custom_role_project__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#\n# Provider Configuration\n#\n\nprovider \"aws\" {\n  region  = \"ap-south-1\"\n}\n\n# Using these data sources allows the configuration to be\n# generic for any region.\ndata \"aws_region\" \"current\" {}\n\ndata \"aws_availability_zones\" \"available\" {}\n\n# Not required: currently used in conjuction with using\n# icanhazip.com to determine local workstation external IP\n# to open EC2 Security Group access to the Kubernetes cluster.\n# See workstation-external-ip.tf for additional information.\nprovider \"http\" {}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/MithunTechnologiesDevOps__Terraform_Scripts__EKS__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"template_file\" \"cloud-config\" {\n  template = \"${ file( \"${ path.module }/cloud-config.yml\" )}\"\n\n  vars {\n    internal-tld = \"${ var.internal-tld }\"\n    s3-bucket = \"${ var.s3-bucket }\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kz8s__tack__modules__bastion__cloud-config.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"azure_databricks_demo\" {\n  source       = \"../../modules/databricks-department-clusters\"\n  cluster_name = var.cluster_name\n  department   = var.department\n  user_names   = var.user_names\n  group_name   = var.group_name\n  tags         = var.tags\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-databricks-examples__cicd-pipelines__manual-approve-with-github-actions__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__3-expanding-on-code-suggestions__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nterraform {\n  required_providers {\n    google = {\n      source = \"hashicorp/google\"\n      version = \"~> {{.Provider.version}}\"\n    }\n  }\n}\n\nprovider \"google\" {\n  {{if .Provider.credentials }}credentials = \"{{.Provider.credentials}}\"{{end}}\n}\n\nresource \"google_bigquery_dataset\" \"example-dataset\" {\n  dataset_id                  = \"test-dataset\"\n  location                    = \"EU\"\n  project                     = \"{{.Provider.project}}\"\n  default_table_expiration_ms = 3600000\n\n  labels = {\n    env = \"dev\"\n  }\n  \n}\n\nresource \"google_bigquery_dataset_iam_policy\" \"dataset\" {\n  dataset_id  = google_bigquery_dataset.example-dataset.dataset_id\n  policy_data = \"{\\\"bindings\\\":[{\\\"members\\\":[\\\"serviceAccount:998476993360@cloudservices.gserviceaccount.com\\\",\\\"allAuthenticatedUsers\\\"],\\\"role\\\":\\\"roles/editor\\\"}]}\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-validator__testdata__templates__example_bigquery_dataset_iam_policy.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-validator__testdata__templates__example_bigquery_dataset_iam_policy.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-validator__testdata__templates__example_bigquery_dataset_iam_policy.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region     = \"us-west-2\"\n  access_key = \"****\"\n  secret_key = \"****\"\n}\n\nvariable \"user_name\" {}\n\nresource \"aws_iam_user\" \"admin\" {\n  name = \"${var.user_name}\"\n}\n\nresource \"aws_iam_user_policy\" \"lb_ro\" {\n  name = \"test\"\n  user = \"${aws_iam_user.admin.name}\"\n\n  policy = \"${file(\"admin.json\")}\"\n}\n\nresource \"aws_iam_user_login_profile\" \"u\" {\n  user                    = \"${aws_iam_user.admin.name}\"\n  password_reset_required = true\n  pgp_key                 = \"keybase:deekshithsn\"\n}\n\noutput \"username\" {\n  value = \"${aws_iam_user.admin.name}\"\n}\n\noutput \"password\" {\n  value = \"${aws_iam_user_login_profile.u.encrypted_password}\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__IAM__admin.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__IAM__admin.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV2_AWS_22", "severity": "CRITICAL", "message": "Ensure an IAM User does not have access to the console", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__IAM__admin.tf", "start_line": 9}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"openstack_compute_keypair_v2\" \"terraform\" {\n  name       = \"terraform\"\n  public_key = file(\"${var.ssh_key_file}.pub\")\n}\n\nresource \"openstack_compute_instance_v2\" \"multi\" {\n  count           = var.instance_count\n  name            = format(\"${var.instance_prefix}-%02d\", count.index + 1)\n  image_name      = var.image\n  flavor_name     = var.flavor\n  key_pair        = openstack_compute_keypair_v2.terraform.name\n  security_groups = [\"default\"]\n  network {\n    name = var.network_name\n  }\n}\n\nresource \"openstack_networking_floatingip_v2\" \"fip\" {\n  count = var.instance_count\n  pool  = var.pool\n}\n\ndata \"openstack_networking_port_v2\" \"port\" {\n  count      = var.instance_count\n  device_id  = openstack_compute_instance_v2.multi.*.id[count.index]\n  network_id = openstack_compute_instance_v2.multi.*.network.0.uuid[count.index]\n}\n\nresource \"openstack_networking_floatingip_associate_v2\" \"fip\" {\n  count       = var.instance_count\n  port_id     = data.openstack_networking_port_v2.port.*.id[count.index]\n  floating_ip = openstack_networking_floatingip_v2.fip.*.address[count.index]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-provider-openstack__terraform-provider-openstack__examples__multiple-vm-with-floating-ip__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Generic Input Variables\n# Business Division\nvariable \"business_divsion\" {\n  description = \"Business Division in the large organization this Infrastructure belongs\"\n  type = string\n  default = \"sap\"\n}\n# Environment Variable\nvariable \"environment\" {\n  description = \"Environment Variable used as a prefix\"\n  type = string\n  default = \"dev\"\n}\n\n# Azure Resource Group Name \nvariable \"resource_group_name\" {\n  description = \"Resource Group Name\"\n  type = string\n  default = \"rg-default\"  \n}\n\n# Azure Resources Location\nvariable \"resource_group_location\" {\n  description = \"Region in which Azure Resources to be created\"\n  type = string\n  default = \"eastus2\"  \n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-azure-with-azure-devops__terraform-manifests__c2-generic-input-variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"proxmox\" {}\nprovider \"talos\" {}\n\nterraform {\n  required_providers {\n    proxmox = {\n      source  = \"bpg/proxmox\"\n      version = \"0.81.0\"\n    }\n    talos = {\n      source  = \"siderolabs/talos\"\n      version = \"0.8.1\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/zimmertr__TJs-Kubernetes-Service__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"instance_ip_addr\" {\n  value = aws_instance.ec2_demo.private_ip\n}\n\noutput \"instance_ip_public\" {\n  value = aws_instance.ec2_demo.public_ip\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/avinashmamidi__terraform__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nresource \"google_compute_network\" \"vpc_network\" {\n  name = \"terraform-network\"\n}\n\nresource \"google_compute_instance\" \"vm_instance\" {\n  name         = var.instance_name\n  machine_type = var.machine_type\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-11\"\n    }\n  }\n\n  network_interface {\n    network = google_compute_network.vpc_network.name\n    access_config {\n    }\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vscode-terraform__src__test__fixtures__compute__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vscode-terraform__src__test__fixtures__compute__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vscode-terraform__src__test__fixtures__compute__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vscode-terraform__src__test__fixtures__compute__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vscode-terraform__src__test__fixtures__compute__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_GCP_18", "severity": "CRITICAL", "message": "Ensure GCP network defines a firewall and does not use the default firewall", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vscode-terraform__src__test__fixtures__compute__main.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# EC2 Instance\n# https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance\nresource \"aws_instance\" \"blue\" {\n  count = var.enable_blue_env ? var.blue_instance_count : 0\n\n  ami                    = local.ubuntu_ami\n  instance_type          = \"t2.micro\"\n  subnet_id              = local.private_a_subnet_id\n  vpc_security_group_ids = [aws_security_group.web.id]\n\n  user_data = templatefile(\"./init-script.sh\", {\n    file_content = \"blue version 1.2 - ${count.index}\"\n  })\n\n  tags = {\n    Name = \"blue version 1.2 - ${count.index}\"\n  }\n}\n\n# Load Balancer Target Group\n# https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_target_group\nresource \"aws_lb_target_group\" \"blue\" {\n  name     = \"blue-tg-blue-lb\"\n  port     = 80\n  protocol = \"HTTP\"\n  vpc_id   = local.vpc_id\n\n  health_check {\n    port     = 80\n    protocol = \"HTTP\"\n    timeout  = 5\n    interval = 10\n  }\n}\n\n# Load Balancer Target Group Attachment\n# https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_target_group_attachment\nresource \"aws_lb_target_group_attachment\" \"blue\" {\n  count            = length(aws_instance.blue)\n  target_group_arn = aws_lb_target_group.blue.arn\n  target_id        = aws_instance.blue[count.index].id\n  port             = 80\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__blue.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__blue.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__blue.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__blue.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__blue.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_261", "severity": "HIGH", "message": "Ensure HTTP HTTPS Target group defines Healthcheck", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__blue.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__blue.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_378", "severity": "HIGH", "message": "Ensure AWS Load Balancer doesn't use HTTP protocol", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__blue.tf", "start_line": 22}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Provides internal access to container ports\n */\nresource \"aws_security_group\" \"ecs\" {\n  name = \"ecs-sg\"\n  description = \"Container Instance Allowed Ports\"\n\n  ingress {\n    from_port = 1\n    to_port   = 65535\n    protocol  = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port = 0\n    to_port = 0\n    protocol = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags {\n    Name = \"ecs-sg\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Capgemini__terraform-amazon-ecs__security-groups.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Capgemini__terraform-amazon-ecs__security-groups.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Capgemini__terraform-amazon-ecs__security-groups.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Capgemini__terraform-amazon-ecs__security-groups.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_25", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Capgemini__terraform-amazon-ecs__security-groups.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Capgemini__terraform-amazon-ecs__security-groups.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Capgemini__terraform-amazon-ecs__security-groups.tf", "start_line": 4}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"google_compute_region_backend_service\" \"bs-1\" {\n  backend {\n    balancing_mode = \"CONNECTION\"\n    failover       = false\n    group          = \"projects/myproj/zones/us-central1-a/instanceGroups/ig-1\"\n  }\n\n  connection_draining_timeout_sec = 30\n  description                     = \"bs-1 description\"\n  health_checks                   = [\"projects/myproj/global/healthChecks/hc-1\"]\n  load_balancing_scheme           = \"INTERNAL\"\n\n  log_config {\n    enable      = true\n    sample_rate = 0.2\n  }\n\n  name             = \"bs-1\"\n  network          = \"projects/myproj/global/networks/default\"\n  protocol         = \"TCP\"\n  region           = \"us-central1\"\n  session_affinity = \"NONE\"\n}\n\nresource \"google_compute_region_backend_service\" \"bs-2\" {\n  backend {\n    balancing_mode  = \"CONNECTION\"\n    capacity_scaler = 0.1\n    group           = \"projects/myproj/zones/us-central1-c/networkEndpointGroups/neg-1\"\n    max_connections = 2\n  }\n\n  circuit_breakers {\n    max_retries = 1\n  }\n\n  connection_draining_timeout_sec = 300\n  health_checks                   = [\"projects/myproj/regions/us-central1/healthChecks/hc-1\"]\n  load_balancing_scheme           = \"EXTERNAL_MANAGED\"\n  locality_lb_policy              = \"RING_HASH\"\n\n  log_config {\n    enable = false\n  }\n\n  name = \"bs-2\"\n\n  outlier_detection {\n    base_ejection_time {\n      nanos   = 0\n      seconds = 30\n    }\n\n    consecutive_errors                    = 5\n    consecutive_gateway_failure           = 3\n    enforcing_consecutive_errors          = 0\n    enforcing_consecutive_gateway_failure = 100\n    enforcing_success_rate                = 100\n\n    interval {\n      nanos   = 0\n      seconds = 1\n    }\n\n    max_ejection_percent        = 50\n    success_rate_minimum_hosts  = 5\n    success_rate_request_volume = 100\n    success_rate_stdev_factor   = 1900\n  }\n\n  protocol         = \"TCP\"\n  region           = \"us-central1\"\n  session_affinity = \"CLIENT_IP\"\n  timeout_sec      = 30\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__magic-modules__mmv1__third_party__cai2hcl__services__compute__testdata__compute_region_backend_service.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n* Copyright 2024 Google LLC\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*     http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\noutput \"load-balancer-ip\" {\n  value       = var.use_lb ? module.lb-http[0].external_ip : \"\"\n  description = \"IP Address that should be used for DNS A record for the domain provided.\"\n}\n\noutput \"assets-bucket\" {\n  value       = google_storage_bucket.assets.name\n  description = \"Name of the GCS bucket where assets are stored.\"\n}\n\noutput \"cloud-run-app-url\" {\n  value       = !var.use_lb ? \"https://${google_cloud_run_v2_service.creative_studio.name}-${data.google_project.project.number}.${google_cloud_run_v2_service.creative_studio.location}.run.app\" : \"\"\n  description = \"The Cloud Run URL where the website can be reached.\"\n}\n\noutput \"builds-service-account\" {\n  value       = google_service_account.cloudbuild.email\n  description = \"Service Account used for Cloud Build\"\n}\n\noutput \"application-service-account\" {\n  value       = google_service_account.creative_studio.email\n  description = \"Service Account used by the Creative Studio web application\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__vertex-ai-creative-studio__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"routeros_ip_firewall\" \"fw\" {\n  rules {\n    filter = {\n      chain   = \"input\"\n      comment = \"rule_2\"\n    }\n  }\n\n  rules {\n    filter = {\n      chain = \"forward\"\n    }\n  }\n\n  nat {}\n}\n\noutput \"rules\" {\n  value = [for value in data.routeros_ip_firewall.fw.rules : [value.id, value.src_address]]\n}\n\noutput \"nat\" {\n  value = [for value in data.routeros_ip_firewall.fw.nat : [value.id, value.comment]]\n}\n\nresource \"routeros_ip_firewall\" \"rule_3\" {\n  action       = \"accept\"\n  chain        = \"input\"\n  comment      = \"rule_3\"\n  src_address  = \"192.168.0.5\"\n  place_before = data.routeros_ip_firewall_filter.fw.rules[0].id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-routeros__terraform-provider-routeros__examples__data-sources__routeros_ip_firewall__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# VPC outputs\noutput \"vpc_id\" {\n  description = \"The ID of the VPC\"\n  value       = module.vpc.vpc_id\n}\n\noutput \"vpc_cidr_block\" {\n  description = \"The CIDR block of the VPC\"\n  value       = module.vpc.vpc_cidr_block\n}\n\noutput \"public_subnets\" {\n  description = \"List of IDs of public subnets\"\n  value       = module.vpc.public_subnets\n}\n\noutput \"azs\" {\n  description = \"A list of availability zones\"\n  value       = module.vpc.azs\n}\n\noutput \"default_security_group_id\" {\n  description = \"Default SG ID of VPC\"\n  value       = module.vpc.default_security_group_id\n}\n\noutput \"default_route_table_id\" {\n  description = \"The ID of the default route table\"\n  value       = module.vpc.default_route_table_id\n}\n\noutput \"vpc_igw_id\" {\n  description = \"The ID of the Internet Gateway\"\n  value       = module.vpc.igw_id\n}\n\noutput \"public_igw_route_id\" {\n  description = \"ID of the internet gateway route\"\n  value       = module.vpc.public_internet_gateway_route_id\n}\n\noutput \"public_route_table_ids\" {\n  description = \"List of IDs of public route tables\"\n  value       = module.vpc.public_route_table_ids\n}\n\noutput \"vpc_owner_id\" {\n  description = \"The ID of the AWS account that owns the VPC\"\n  value       = module.vpc.vpc_owner_id\n}\n\noutput \"vpc_main_route_table_id\" {\n  description = \"The ID of the main route table associated with this VPC\"\n  value       = module.vpc.vpc_main_route_table_id\n}\n\n# VPC peering outputs\noutput \"stage_vpc_peering_id\" {\n  description = \"The Id of the VPC peering connection\"\n  value       = aws_vpc_peering_connection.infra_stage.id\n}\n\n# Sg outputs\noutput \"sg_vpc_local_id\" {\n  description = \"The ID of the local security group\"\n  value       = module.sg_vpc_local.this_security_group_id\n}\n\noutput \"sg_vpc_local_name\" {\n  description = \"The Name of the local security group\"\n  value       = module.sg_vpc_local.this_security_group_name\n}\n\noutput \"sg_ssh_global_id\" {\n  description = \"The ID of the global SSH security group\"\n  value       = module.sg_ssh_global.this_security_group_id\n}\n\noutput \"sg_ssh_global_name\" {\n  description = \"The Name of the global SSH security group\"\n  value       = module.sg_ssh_global.this_security_group_name\n}\n\noutput \"sg_web_global_id\" {\n  description = \"The ID of the global WEB security group\"\n  value       = module.sg_web_global.this_security_group_id\n}\n\noutput \"sg_web_global_name\" {\n  description = \"The Name of the global WEB security group\"\n  value       = module.sg_web_global.this_security_group_name\n}\n\noutput \"sg_openvpn_global_id\" {\n  description = \"The ID of the global OpenVPN security group\"\n  value       = module.sg_openvpn_global.this_security_group_id\n}\n\noutput \"sg_openvpn_global_name\" {\n  description = \"The Name of the global OpenVPN security group\"\n  value       = module.sg_openvpn_global.this_security_group_name\n}\n\n### DNS zones outputs\noutput \"dns_zone_id\" {\n  description = \"Zone ID of Route53 zone\"\n  value       = module.dns_zone.this_route53_zone_zone_id\n}\n\noutput \"dns_zone_name_servers\" {\n  description = \"Zone ID of Route53 zone\"\n  value       = module.dns_zone.this_route53_zone_name_servers\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/diggerhq__digger__libs__digger_config__terragrunt__tac__test_examples__no_terraform_blocks__myproject__eu-south-1__infra__network__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/* Static Site Bucket Policy */\n\ndata \"aws_iam_policy_document\" \"s3_static_site\" {\n  statement {\n    actions   = [\"s3:GetObject\"]\n    resources = [\"${aws_s3_bucket.static_site.arn}/*\"]\n\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"${aws_cloudfront_origin_access_identity.npk.iam_arn}\"]\n    }\n  }\n}\n\nresource \"aws_s3_bucket_policy\" \"s3_static_site\" {\n  bucket = \"${aws_s3_bucket.static_site.id}\"\n  policy = \"${data.aws_iam_policy_document.s3_static_site.json}\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Coalfire-Research__npk__terraform__s3_policies.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  profile = \"default\"\n  region  = \"us-east-1\"\n}\n\nresource \"aws_instance\" \"example_terraform\" {\n  instance_type = \"t2.micro\"\n  ami           = \"ami-0b898040803850657\"\n}\n\nresource \"aws_security_group\" \"allow_http\" {\n  name          = \"terraform security group\"\n  description   = \"terraform security group\"\n  vpc_id        = \"vpc-06a5dd7cbb70bcf5e\"\n\n  ingress {\n    description = \"Custom security group\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name        = \"Custom security group\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__instance_security_group.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__instance_security_group.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__instance_security_group.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__instance_security_group.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__instance_security_group.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__instance_security_group.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__instance_security_group.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__instance_security_group.tf", "start_line": 11}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Terraform Output Values\n\n# EC2 Instance Public IP\noutput \"instance_publicip\" {\n  description = \"EC2 Instance Public IP\"\n  value = aws_instance.myec2vm.public_ip\n}\n\n# EC2 Instance Public DNS\noutput \"instance_publicdns\" {\n  description = \"EC2 Instance Public DNS\"\n  value = aws_instance.myec2vm.public_dns\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-ec2__04-Terraform-Variables-and-Datasources__terraform-manifests__c6-outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  cidr_subnets     = [for cidr_block in cidrsubnets(var.cidr, 2, 2, 2, 2) : cidrsubnets(cidr_block, 4, 4, 4, 4)]\n  private_subnets  = chunklist(local.cidr_subnets[0], var.az_count)[0]\n  public_subnets   = chunklist(local.cidr_subnets[1], var.az_count)[0]\n  database_subnets = chunklist(local.cidr_subnets[2], var.az_count)[0]\n  intra_subnets    = chunklist(local.cidr_subnets[3], var.az_count)[0]\n  azs              = data.aws_availability_zones.available.names\n}\n\n# https://github.com/terraform-aws-modules/terraform-aws-vpc/blob/master/examples/complete-vpc/main.tf#L82\ndata \"aws_security_group\" \"default\" {\n  name   = \"default\"\n  vpc_id = module.vpc.vpc_id\n}\n\n#tfsec:ignore:aws-ec2-no-public-ip-subnet\n#tfsec:ignore:aws-ec2-require-vpc-flow-logs-for-all-vpcs\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"4.0.1\"\n\n  name = local.name\n  cidr = var.cidr\n\n  azs              = local.azs\n  private_subnets  = local.private_subnets\n  public_subnets   = local.public_subnets\n  database_subnets = local.database_subnets\n  intra_subnets    = local.intra_subnets\n\n  single_nat_gateway      = var.single_nat_gateway\n  enable_nat_gateway      = true\n  enable_vpn_gateway      = false\n  enable_dns_hostnames    = true\n  enable_dns_support      = true\n  map_public_ip_on_launch = true\n\n  create_database_subnet_group = false\n\n  manage_default_security_group  = true\n  default_security_group_ingress = []\n  default_security_group_egress  = []\n\n  tags = merge(local.tags, {\n    \"kubernetes.io/cluster/${local.name}\" = \"shared\"\n  })\n\n  private_subnet_tags = {\n    Name                              = \"${local.name}-private\"\n    destination                       = \"private\"\n    \"karpenter.sh/discovery\"          = \"private\"\n    \"kubernetes.io/role/internal-elb\" = \"1\"\n  }\n\n  private_route_table_tags = {\n    Name        = \"${local.name}-private\"\n    destination = \"private\"\n  }\n\n  public_subnet_tags = {\n    Name                     = \"${local.name}-public\"\n    destination              = \"public\"\n    \"karpenter.sh/discovery\" = \"public\"\n    \"kubernetes.io/role/elb\" = \"1\"\n  }\n\n  public_route_table_tags = {\n    Name        = \"${local.name}-public\"\n    destination = \"public\"\n  }\n\n  database_subnet_tags = {\n    Name        = \"${local.name}-database\"\n    destination = \"database\"\n  }\n\n  database_route_table_tags = {\n    Name        = \"${local.name}-database\"\n    destination = \"database\"\n  }\n\n  intra_subnet_tags = {\n    Name        = \"${local.name}-intra\"\n    destination = \"intra\"\n  }\n\n  intra_route_table_tags = {\n    Name        = \"${local.name}-intra\"\n    destination = \"intra\"\n  }\n}\n\nmodule \"vpc_gateway_endpoints\" {\n  source  = \"terraform-aws-modules/vpc/aws//modules/vpc-endpoints\"\n  version = \"4.0.1\"\n\n  vpc_id = module.vpc.vpc_id\n\n  endpoints = {\n    s3 = {\n      service      = \"s3\"\n      service_type = \"Gateway\"\n      route_table_ids = flatten([\n        module.vpc.intra_route_table_ids,\n        module.vpc.private_route_table_ids,\n        module.vpc.public_route_table_ids\n      ])\n      tags = {\n        Name = \"${local.name}-s3\"\n      }\n    }\n  }\n\n  tags = local.tags\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/maddevsio__aws-eks-base__terraform__layer1-aws__aws-vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/maddevsio__aws-eks-base__terraform__layer1-aws__aws-vpc.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/maddevsio__aws-eks-base__terraform__layer1-aws__aws-vpc.tf", "start_line": 93}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"proxmox_virtual_environment_sdn_zone_simple\" \"test_zone_1\" {\n  depends_on = [proxmox_virtual_environment_sdn_zone_simple.test_zone_1]\n  id         = proxmox_virtual_environment_sdn_zone_simple.test_zone_1.id\n}\n\ndata \"proxmox_virtual_environment_sdn_zones\" \"simple\" {\n  depends_on = [\n    proxmox_virtual_environment_sdn_zone_simple.test_zone_1,\n    proxmox_virtual_environment_sdn_zone_simple.test_zone_2,\n  ]\n  type = \"simple\"\n}\n\ndata \"proxmox_virtual_environment_sdn_zones\" \"all\" {\n  depends_on = [\n    proxmox_virtual_environment_sdn_zone_simple.test_zone_1,\n    proxmox_virtual_environment_sdn_zone_simple.test_zone_2,\n  ]\n}\n\ndata \"proxmox_virtual_environment_sdn_vnet\" \"test_vnet_1\" {\n  depends_on = [proxmox_virtual_environment_sdn_vnet.test_vnet_1]\n  id = proxmox_virtual_environment_sdn_vnet.test_vnet_1.id\n}\n\ndata \"proxmox_virtual_environment_sdn_vnets\" \"all\" {\n  depends_on = [\n    proxmox_virtual_environment_sdn_vnet.test_vnet_1,\n    proxmox_virtual_environment_sdn_vnet.test_vnet_2,\n  ]\n}\n\ndata \"proxmox_virtual_environment_sdn_subnet\" \"test_subnet_dhcp\" {\n  depends_on = [proxmox_virtual_environment_sdn_subnet.test_subnet_dhcp]\n  cidr = proxmox_virtual_environment_sdn_subnet.test_subnet_dhcp.cidr\n  vnet = proxmox_virtual_environment_sdn_vnet.test_vnet_1.id\n}\n\noutput \"proxmox_virtual_environment_sdn_zone_simple\" {\n  value = data.proxmox_virtual_environment_sdn_zone_simple.test_zone_1\n}\n\noutput \"proxmox_virtual_environment_sdn_zones_simple\" {\n  value = data.proxmox_virtual_environment_sdn_zones.simple.zones\n}\n\noutput \"proxmox_virtual_environment_sdn_zones_all\" {\n  value = data.proxmox_virtual_environment_sdn_zones.all.zones\n}\n\noutput \"proxmox_virtual_environment_sdn_vnet\" {\n  value = data.proxmox_virtual_environment_sdn_vnet.test_vnet_1\n}\n\noutput \"proxmox_virtual_environment_sdn_vnets\" {\n  value = data.proxmox_virtual_environment_sdn_vnets.all\n}\n\noutput \"proxmox_virtual_environment_sdn_subnet\" {\n  value = data.proxmox_virtual_environment_sdn_subnet.test_subnet_dhcp\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bpg__terraform-provider-proxmox__example__data_source_virtual_environment_sdn.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region                      = \"us-east-1\" # <<<<< Try changing this to eu-west-1 to compare the costs\n  skip_credentials_validation = true\n  skip_requesting_account_id  = true\n  access_key                  = \"mock_access_key\"\n  secret_key                  = \"mock_secret_key\"\n\n  default_tags {\n    tags = {\n      DefaultNotOverride = \"defaultnotoverride\"\n      DefaultOverride    = \"defaultoverride\"\n    }\n  }\n}\n\nresource \"aws_sns_topic_subscription\" \"sns_topic_noTags\" {\n  endpoint  = \"some-dummy-endpoint\"\n  protocol  = \"http\"\n  topic_arn = \"arn:aws:sns:us-east-1:123456789123:sns-topic-arn\"\n}\n\nresource \"aws_sns_topic_subscription\" \"sns_topic_withTags\" {\n  endpoint  = \"some-dummy-endpoint\"\n  protocol  = \"http\"\n  topic_arn = \"arn:aws:sns:us-east-1:123456789123:sns-topic-arn\"\n  tags = {\n    DefaultOverride = \"sns-def\"\n    ResourceTag     = \"sns-ghi\"\n  }\n}\n\nresource \"aws_sqs_queue\" \"sqs_noTags\" {\n  name = \"sqs_noTags\"\n}\n\nresource \"aws_sqs_queue\" \"sqs_withTags\" {\n  name = \"sqs_withTags\"\n\n  tags = {\n    DefaultOverride = \"sqs-def\"\n    ResourceTag     = \"sqs-hi\"\n  }\n}\n\nresource \"aws_autoscaling_group\" \"bar\" {\n  name                      = \"foobar3-terraform-test\"\n  max_size                  = 5\n  min_size                  = 2\n  health_check_grace_period = 300\n  health_check_type         = \"ELB\"\n  desired_capacity          = 4\n  force_delete              = true\n\n  tag {\n    key                 = \"foo\"\n    value               = \"bar\"\n    propagate_at_launch = true\n  }\n\n  tag {\n    key                 = \"lorem\"\n    value               = \"ipsum\"\n    propagate_at_launch = false\n  }\n}\n\nresource \"aws_instance\" \"web_app\" {\n  ami           = \"ami-674cbc1e\"\n  instance_type = \"m5.4xlarge\"\n  volume_tags = {\n    \"baz\"           = \"bat\"\n    DefaultOverride = \"volume_tag_overwritten\"\n  }\n\n  root_block_device {\n    volume_size = 50\n  }\n\n  ebs_block_device {\n    device_name = \"my_data\"\n    volume_type = \"io1\"\n    volume_size = 1000\n    iops        = 800\n  }\n\n  tags = {\n    \"foo\" = \"bar\"\n  }\n}\n\nresource \"aws_instance\" \"launch_instance\" {\n  volume_tags = {\n    \"flip\" = \"flop\"\n  }\n  launch_template {\n    id = aws_launch_template.example.id\n  }\n\n  tags = {\n    \"bat\"  = \"ball\"\n    \"fizz\" = \"buzz\"\n  }\n}\n\nresource \"aws_launch_template\" \"example\" {\n  name = \"example-lt\"\n\n  image_id      = \"fake_ami\"\n  instance_type = \"t3.medium\"\n  ebs_optimized = true\n\n  monitoring {\n    enabled = true\n  }\n\n  credit_specification {\n    cpu_credits = \"unlimited\"\n  }\n\n  placement {\n    tenancy = \"dedicated\"\n  }\n\n  block_device_mappings {\n    device_name = \"xvdc\"\n\n    ebs {\n      volume_type = \"io1\"\n      volume_size = 10\n      iops        = 100\n    }\n  }\n\n  tag_specifications {\n    resource_type = \"instance\"\n    tags = {\n      \"fizz\" = \"buzz\"\n    }\n  }\n\n  tag_specifications {\n    resource_type = \"volume\"\n    tags = {\n      \"flip\" = \"flop\"\n    }\n  }\n\n  tag_specifications {\n    resource_type = \"capacity-reservation\"\n    tags = {\n      \"no\" = \"cap\"\n    }\n  }\n}\n\nresource \"aws_autoscaling_group\" \"launch_template\" {\n  name                      = \"foobar3-terraform-test\"\n  max_size                  = 5\n  min_size                  = 2\n  health_check_grace_period = 300\n  health_check_type         = \"ELB\"\n  desired_capacity          = 4\n  force_delete              = true\n\n  launch_template {\n    id = aws_launch_template.example.id\n  }\n\n  tag {\n    key                 = \"foo\"\n    value               = \"bar\"\n    propagate_at_launch = true\n  }\n\n  tag {\n    key                 = \"lorem\"\n    value               = \"ipsum\"\n    propagate_at_launch = false\n  }\n}\n\nresource \"aws_instance\" \"web_app_block_tags\" {\n  ami           = \"ami-674cbc1e\"\n  instance_type = \"m5.4xlarge\"\n\n  root_block_device {\n    volume_size = 50\n    tags = {\n      \"foo\" = \"rbd\"\n    }\n  }\n\n  ebs_block_device {\n    device_name = \"my_data\"\n    volume_type = \"io1\"\n    volume_size = 1000\n    iops        = 800\n\n    tags = {\n      \"foo\" = \"ebd\"\n    }\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_27", "severity": "HIGH", "message": "Ensure all data stored in the SQS queue is encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AWS_27", "severity": "HIGH", "message": "Ensure all data stored in the SQS queue is encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_AWS_315", "severity": "HIGH", "message": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 67}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 67}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 67}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 91}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 91}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 91}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 91}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 105}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 182}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 182}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 182}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 67}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 91}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags__main.tf", "start_line": 182}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"azurerm\" {\n    storage_account_name = \"azurebackendstorageabhi\"\n    container_name = \"backend\"\n    key = \"terraform.tfstate\"\n    access_key = \"\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__Azure-zero-to-hero__Day-23__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"ami\" {\n  default = \"foo\"\n  type    = \"string\"\n}\n\nvariable \"list\" {\n  default = []\n  type    = \"list\"\n}\n\nvariable \"map\" {\n  default = {}\n  type    = \"map\"\n}\n\nresource \"aws_instance\" \"bar\" {\n  foo = \"${var.ami}\"\n  bar = \"${join(\",\", var.list)}\"\n  baz = \"${join(\",\", keys(var.map))}\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/beelit94__python-terraform__test__vars_require_input__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/beelit94__python-terraform__test__vars_require_input__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/beelit94__python-terraform__test__vars_require_input__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/beelit94__python-terraform__test__vars_require_input__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/beelit94__python-terraform__test__vars_require_input__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/beelit94__python-terraform__test__vars_require_input__main.tf", "start_line": 16}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"access_key\" {\ndescription = \"AWS Access key\"\ndefault = \"AKIAVPV5JKOU2TYBIB7T\"\n}\n\nvariable \"secret_key\" {\ndescription = \"AWS Secret Key\"\ndefault = \"i/7KeZHeSUYxnm2AK8U2N2ZZW1adfUA6+H13hrmT\"\n}\n\n\nvariable \"region\" {\ndescription = \"AWS region for hosting our your network\"\ndefault = \"us-east-1\"\n}\n\n\nvariable \"aws_ami\" {\ndescription = \"AWS region for hosting our your network\"\ndefault = \"ami-09d95fab7fff3776c\"\n}\n\n\nvariable \"key_name\" {\ndescription = \"Key name for SSH into EC2\"\ndefault = \"awskey1\"\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__variables.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_SECRET_2", "severity": "CRITICAL", "message": "AWS Access Key", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__variables.tf", "start_line": 3}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# //////////////////////////////\n# EC2 MODULE\n# //////////////////////////////\nmodule \"ec2_cluster\" {\n  source                 = \"terraform-aws-modules/ec2-instance/aws\"\n  version                = \"~> 2.0\"\n\n  name                   = \"frontend-linux\"\n  instance_count         = 1\n\n  ami                    = data.aws_ami.aws-linux.id\n  instance_type          = \"t2.micro\"\n\n  vpc_security_group_ids = [aws_security_group.sg_frontend.id]\n  subnet_id              = module.vpc.public_subnets[1]\n\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rajakumarguptatechie__terraform__03_02_complex__instance.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rajakumarguptatechie__terraform__03_02_complex__instance.tf", "start_line": 4}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: Apache-2.0\n\n##############################################################################\n# Variables File\n# \n# Here is where we store the default values for all the variables used in our\n# Terraform code. If you create a variable with no default, the user will be\n# prompted to enter it (or define it via config file or command line flags.)\n\nvariable \"prefix\" {\n  description = \"This prefix will be included in the name of most resources.\"\n}\n\nvariable \"location\" {\n  description = \"The region where the virtual network is created.\"\n  default     = \"centralus\"\n}\n\nvariable \"address_space\" {\n  description = \"The address space that is used by the virtual network. You can supply more than one address space. Changing this forces a new resource to be created.\"\n  default     = \"10.0.0.0/16\"\n}\n\nvariable \"subnet_prefix\" {\n  description = \"The address prefix to use for the subnet.\"\n  default     = \"10.0.10.0/24\"\n}\n\nvariable \"vm_size\" {\n  description = \"Specifies the size of the virtual machine.\"\n  default     = \"Standard_B1s\"\n}\n\nvariable \"image_publisher\" {\n  description = \"Name of the publisher of the image (az vm image list)\"\n  default     = \"Canonical\"\n}\n\nvariable \"image_offer\" {\n  description = \"Name of the offer (az vm image list)\"\n  default     = \"0001-com-ubuntu-server-jammy\"\n}\n\nvariable \"image_sku\" {\n  description = \"Image SKU to apply (az vm image list)\"\n  default     = \"22_04-LTS-gen2\"\n}\n\nvariable \"image_version\" {\n  description = \"Version of the image to apply (az vm image list)\"\n  default     = \"latest\"\n}\n\nvariable \"admin_username\" {\n  description = \"Administrator user name for linux and mysql\"\n  default     = \"hashicorp\"\n}\n\nvariable \"admin_password\" {\n  description = \"Administrator password for linux and mysql\"\n  default     = \"Password123!\"\n}\n\nvariable \"height\" {\n  default     = \"400\"\n  description = \"Image height in pixels.\"\n}\n\nvariable \"width\" {\n  default     = \"600\"\n  description = \"Image width in pixels.\"\n}\n\nvariable \"placeholder\" {\n  default     = \"placekitten.com\"\n  description = \"Image-as-a-service URL. Some other fun ones to try are fillmurray.com, placecage.com, placebeard.it, loremflickr.com, baconmockup.com, placeimg.com, placebear.com, placeskull.com, stevensegallery.com, placedog.net\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__hashicat-azure__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# codes for pip install and zip packaging\nresource \"null_resource\" \"pip\" {\n  triggers {\n    main         = \"${base64sha256(file(\"${path.module}/source/main.py\"))}\"\n    requirements = \"${base64sha256(file(\"${path.module}/source/requirements.txt\"))}\"\n    execute      = \"${base64sha256(file(\"${path.module}/pip.sh\"))}\"\n  }\n\n  provisioner \"local-exec\" {\n    command = \"${path.module}/pip.sh ${path.module}/source\"\n  }\n}\n\ndata \"archive_file\" \"source\" {\n  type        = \"zip\"\n  source_dir  = \"${path.module}/source\"\n  output_path = \"${path.module}/source.zip\"\n\n  depends_on = [\"null_resource.pip\"]\n}\n\n# codes for lambda functions\nresource \"aws_iam_role\" \"lambda\" {\n  name = \"iam_for_lambda\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n\nresource \"aws_lambda_function\" \"source\" {\n  filename         = \"${path.module}/source.zip\"\n  source_code_hash = \"${data.archive_file.source.output_base64sha256}\"\n  function_name    = \"lamda\"\n  role             = \"${aws_iam_role.lambda.arn}\"\n  handler          = \"main.handler\"\n  runtime          = \"python2.7\"\n  timeout          = 120\n  publish          = true\n\n  environment {\n    variables = {\n      HASH = \"${base64sha256(file(\"source/main.py\"))}-${base64sha256(file(\"source/requirements.txt\"))}\"\n    }\n  }\n\n  lifecycle {\n    ignore_changes = [\"source_code_hash\", \"last_modified\"]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__lambda__lambda.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_363", "severity": "HIGH", "message": "Ensure Lambda Runtime is not deprecated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__lambda__lambda.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__lambda__lambda.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__lambda__lambda.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_AWS_173", "severity": "HIGH", "message": "Check encryption settings for Lambda environmental variable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__lambda__lambda.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__lambda__lambda.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__lambda__lambda.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__lambda__lambda.tf", "start_line": 43}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"${var.region}\"\n}\n\nterraform {\n   backend \"s3\" {\n   bucket = \"rc-tf-remote-state-bucket\"\n   key = \"terraform.tfstate\"\n   region = \"us-east-1\"\n  }\n}\n\nresource \"aws_s3_bucket\" \"tf-root-module-bucket\" {\n  bucket = \"${var.s3_bucket_name}\"\n  acl = \"private\"\n  region = \"${var.s3_bucket_region}\"\n  \n  versioning {\n    enabled = true\n  }\n  \n  tags = {\n    Name        = \"${var.s3_bucket_name}\"\n    Environment = \"${var.tag_env}\"\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_2__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_2__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_2__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_2__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_2__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_2__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_2__main.tf", "start_line": 13}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-acm__examples__complete-dns-validation-with-cloudflare__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_security_group\" \"demo_sg\" {\n  name        = \"sample-sg\"\n\n  ingress {\n    from_port   = 8200\n    to_port     = 8200\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 8201\n    to_port     = 8201\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 8300\n    to_port     = 8300\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 9200\n    to_port     = 9200\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 9500\n    to_port     = 9500\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/JJTechInc__Terraform__17-Dynamic Blocks__before.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/JJTechInc__Terraform__17-Dynamic Blocks__before.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/JJTechInc__Terraform__17-Dynamic Blocks__before.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#\n# ONLY EDIT THIS FILE IN github.com/cloudposse/terraform-null-label\n# All other instances of this file should be a copy of that one\n#\n#\n# Copy this file from https://github.com/cloudposse/terraform-null-label/blob/master/exports/context.tf\n# and then place it in your Terraform module to automatically get\n# Cloud Posse's standard configuration inputs suitable for passing\n# to Cloud Posse modules.\n#\n# curl -sL https://raw.githubusercontent.com/cloudposse/terraform-null-label/master/exports/context.tf -o context.tf\n#\n# Modules should access the whole context as `module.this.context`\n# to get the input variables with nulls for defaults,\n# for example `context = module.this.context`,\n# and access individual variables as `module.this.<var>`,\n# with final values filled in.\n#\n# For example, when using defaults, `module.this.context.delimiter`\n# will be null, and `module.this.delimiter` will be `-` (hyphen).\n#\n\nmodule \"this\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.25.0\" # requires Terraform >= 0.13.0\n\n  enabled             = var.enabled\n  namespace           = var.namespace\n  tenant              = var.tenant\n  environment         = var.environment\n  stage               = var.stage\n  name                = var.name\n  delimiter           = var.delimiter\n  attributes          = var.attributes\n  tags                = var.tags\n  additional_tag_map  = var.additional_tag_map\n  label_order         = var.label_order\n  regex_replace_chars = var.regex_replace_chars\n  id_length_limit     = var.id_length_limit\n  label_key_case      = var.label_key_case\n  label_value_case    = var.label_value_case\n  descriptor_formats  = var.descriptor_formats\n  labels_as_tags      = var.labels_as_tags\n\n  context = var.context\n}\n\n# Copy contents of cloudposse/terraform-null-label/variables.tf here\n\nvariable \"context\" {\n  type = any\n  default = {\n    enabled             = true\n    namespace           = null\n    tenant              = null\n    environment         = null\n    stage               = null\n    name                = null\n    delimiter           = null\n    attributes          = []\n    tags                = {}\n    additional_tag_map  = {}\n    regex_replace_chars = null\n    label_order         = []\n    id_length_limit     = null\n    label_key_case      = null\n    label_value_case    = null\n    descriptor_formats  = {}\n    # Note: we have to use [] instead of null for unset lists due to\n    # https://github.com/hashicorp/terraform/issues/28137\n    # which was not fixed until Terraform 1.0.0,\n    # but we want the default to be all the labels in `label_order`\n    # and we want users to be able to prevent all tag generation\n    # by setting `labels_as_tags` to `[]`, so we need\n    # a different sentinel to indicate \"default\"\n    labels_as_tags = [\"unset\"]\n  }\n  description = <<-EOT\n    Single object for setting entire context at once.\n    See description of individual variables for details.\n    Leave string and numeric variables as `null` to use default value.\n    Individual variable settings (non-null) override settings in context object,\n    except for attributes, tags, and additional_tag_map, which are merged.\n  EOT\n\n  validation {\n    condition     = lookup(var.context, \"label_key_case\", null) == null ? true : contains([\"lower\", \"title\", \"upper\"], var.context[\"label_key_case\"])\n    error_message = \"Allowed values: `lower`, `title`, `upper`.\"\n  }\n\n  validation {\n    condition     = lookup(var.context, \"label_value_case\", null) == null ? true : contains([\"lower\", \"title\", \"upper\", \"none\"], var.context[\"label_value_case\"])\n    error_message = \"Allowed values: `lower`, `title`, `upper`, `none`.\"\n  }\n}\n\nvariable \"enabled\" {\n  type        = bool\n  default     = null\n  description = \"Set to false to prevent the module from creating any resources\"\n}\n\nvariable \"namespace\" {\n  type        = string\n  default     = null\n  description = \"ID element. Usually an abbreviation of your organization name, e.g. 'eg' or 'cp', to help ensure generated IDs are globally unique\"\n}\n\nvariable \"tenant\" {\n  type        = string\n  default     = null\n  description = \"ID element _(Rarely used, not included by default)_. A customer identifier, indicating who this instance of a resource is for\"\n}\n\nvariable \"environment\" {\n  type        = string\n  default     = null\n  description = \"ID element. Usually used for region e.g. 'uw2', 'us-west-2', OR role 'prod', 'staging', 'dev', 'UAT'\"\n}\n\nvariable \"stage\" {\n  type        = string\n  default     = null\n  description = \"ID element. Usually used to indicate role, e.g. 'prod', 'staging', 'source', 'build', 'test', 'deploy', 'release'\"\n}\n\nvariable \"name\" {\n  type        = string\n  default     = null\n  description = <<-EOT\n    ID element. Usually the component or solution name, e.g. 'app' or 'jenkins'.\n    This is the only ID element not also included as a `tag`.\n    The \"name\" tag is set to the full `id` string. There is no tag with the value of the `name` input.\n    EOT\n}\n\nvariable \"delimiter\" {\n  type        = string\n  default     = null\n  description = <<-EOT\n    Delimiter to be used between ID elements.\n    Defaults to `-` (hyphen). Set to `\"\"` to use no delimiter at all.\n  EOT\n}\n\nvariable \"attributes\" {\n  type        = list(string)\n  default     = []\n  description = <<-EOT\n    ID element. Additional attributes (e.g. `workers` or `cluster`) to add to `id`,\n    in the order they appear in the list. New attributes are appended to the\n    end of the list. The elements of the list are joined by the `delimiter`\n    and treated as a single ID element.\n    EOT\n}\n\nvariable \"labels_as_tags\" {\n  type        = set(string)\n  default     = [\"default\"]\n  description = <<-EOT\n    Set of labels (ID elements) to include as tags in the `tags` output.\n    Default is to include all labels.\n    Tags with empty values will not be included in the `tags` output.\n    Set to `[]` to suppress all generated tags.\n    **Notes:**\n      The value of the `name` tag, if included, will be the `id`, not the `name`.\n      Unlike other `null-label` inputs, the initial setting of `labels_as_tags` cannot be\n      changed in later chained modules. Attempts to change it will be silently ignored.\n    EOT\n}\n\nvariable \"tags\" {\n  type        = map(string)\n  default     = {}\n  description = <<-EOT\n    Additional tags (e.g. `{'BusinessUnit': 'XYZ'}`).\n    Neither the tag keys nor the tag values will be modified by this module.\n    EOT\n}\n\nvariable \"additional_tag_map\" {\n  type        = map(string)\n  default     = {}\n  description = <<-EOT\n    Additional key-value pairs to add to each map in `tags_as_list_of_maps`. Not added to `tags` or `id`.\n    This is for some rare cases where resources want additional configuration of tags\n    and therefore take a list of maps with tag key, value, and additional configuration.\n    EOT\n}\n\nvariable \"label_order\" {\n  type        = list(string)\n  default     = null\n  description = <<-EOT\n    The order in which the labels (ID elements) appear in the `id`.\n    Defaults to [\"namespace\", \"environment\", \"stage\", \"name\", \"attributes\"].\n    You can omit any of the 6 labels (\"tenant\" is the 6th), but at least one must be present.\n    EOT\n}\n\nvariable \"regex_replace_chars\" {\n  type        = string\n  default     = null\n  description = <<-EOT\n    Terraform regular expression (regex) string.\n    Characters matching the regex will be removed from the ID elements.\n    If not set, `\"/[^a-zA-Z0-9-]/\"` is used to remove all characters other than hyphens, letters and digits.\n  EOT\n}\n\nvariable \"id_length_limit\" {\n  type        = number\n  default     = null\n  description = <<-EOT\n    Limit `id` to this many characters (minimum 6).\n    Set to `0` for unlimited length.\n    Set to `null` for keep the existing setting, which defaults to `0`.\n    Does not affect `id_full`.\n  EOT\n  validation {\n    condition     = var.id_length_limit == null ? true : var.id_length_limit >= 6 || var.id_length_limit == 0\n    error_message = \"The id_length_limit must be >= 6 if supplied (not null), or 0 for unlimited length.\"\n  }\n}\n\nvariable \"label_key_case\" {\n  type        = string\n  default     = null\n  description = <<-EOT\n    Controls the letter case of the `tags` keys (label names) for tags generated by this module.\n    Does not affect keys of tags passed in via the `tags` input.\n    Possible values: `lower`, `title`, `upper`.\n    Default value: `title`.\n  EOT\n\n  validation {\n    condition     = var.label_key_case == null ? true : contains([\"lower\", \"title\", \"upper\"], var.label_key_case)\n    error_message = \"Allowed values: `lower`, `title`, `upper`.\"\n  }\n}\n\nvariable \"label_value_case\" {\n  type        = string\n  default     = null\n  description = <<-EOT\n    Controls the letter case of ID elements (labels) as included in `id`,\n    set as tag values, and output by this module individually.\n    Does not affect values of tags passed in via the `tags` input.\n    Possible values: `lower`, `title`, `upper` and `none` (no transformation).\n    Set this to `title` and set `delimiter` to `\"\"` to yield Pascal Case IDs.\n    Default value: `lower`.\n  EOT\n\n  validation {\n    condition     = var.label_value_case == null ? true : contains([\"lower\", \"title\", \"upper\", \"none\"], var.label_value_case)\n    error_message = \"Allowed values: `lower`, `title`, `upper`, `none`.\"\n  }\n}\n\nvariable \"descriptor_formats\" {\n  type        = any\n  default     = {}\n  description = <<-EOT\n    Describe additional descriptors to be output in the `descriptors` output map.\n    Map of maps. Keys are names of descriptors. Values are maps of the form\n    `{\n       format = string\n       labels = list(string)\n    }`\n    (Type is `any` so the map values can later be enhanced to provide additional options.)\n    `format` is a Terraform format string to be passed to the `format()` function.\n    `labels` is a list of labels, in order, to pass to `format()` function.\n    Label values will be normalized before being passed to `format()` so they will be\n    identical to how they appear in `id`.\n    Default is `{}` (`descriptors` output will be empty).\n    EOT\n}\n\n#### End of copy of cloudposse/terraform-null-label/variables.tf\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__examples__complete__context.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__examples__complete__context.tf", "start_line": 23}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# tflint-ignore: terraform_unused_declarations\nvariable \"region\" {\n\n  type        = string\n  description = \"OBSOLETE (not needed): AWS Region\"\n  default     = null\n}\n\nvariable \"subnet_ids\" {\n  type        = list(string)\n  description = \"A list of subnet IDs to launch the cluster in\"\n}\n\nvariable \"associated_security_group_ids\" {\n  type        = list(string)\n  default     = []\n  description = <<-EOT\n    A list of IDs of Security Groups to associate the cluster with.\n    These security groups will not be modified.\n    EOT\n}\n\nvariable \"cluster_depends_on\" {\n  type        = any\n  description = <<-EOT\n    If provided, the EKS will depend on this object, and therefore not be created until this object is finalized.\n    This is useful if you want to ensure that the cluster is not created before some other condition is met, e.g. VPNs into the subnet are created.\n    EOT\n  default     = null\n}\n\nvariable \"create_eks_service_role\" {\n  type        = bool\n  description = \"Set `false` to use existing `eks_cluster_service_role_arn` instead of creating one\"\n  default     = true\n}\n\nvariable \"eks_cluster_service_role_arn\" {\n  type        = string\n  description = <<-EOT\n    The ARN of an IAM role for the EKS cluster to use that provides permissions\n    for the Kubernetes control plane to perform needed AWS API operations.\n    Required if `create_eks_service_role` is `false`, ignored otherwise.\n    EOT\n  default     = null\n}\n\n\nvariable \"kubernetes_version\" {\n  type        = string\n  description = \"Desired Kubernetes master version. If you do not specify a value, the latest available version is used\"\n  default     = \"1.21\"\n}\n\nvariable \"oidc_provider_enabled\" {\n  type        = bool\n  description = <<-EOT\n    Create an IAM OIDC identity provider for the cluster, then you can create IAM roles to associate with a\n    service account in the cluster, instead of using kiam or kube2iam. For more information,\n    see [EKS User Guide](https://docs.aws.amazon.com/eks/latest/userguide/enable-iam-roles-for-service-accounts.html).\n    EOT\n  default     = false\n}\n\nvariable \"endpoint_private_access\" {\n  type        = bool\n  description = \"Indicates whether or not the Amazon EKS private API server endpoint is enabled. Default to AWS EKS resource and it is false\"\n  default     = false\n}\n\nvariable \"endpoint_public_access\" {\n  type        = bool\n  description = \"Indicates whether or not the Amazon EKS public API server endpoint is enabled. Default to AWS EKS resource and it is true\"\n  default     = true\n}\n\nvariable \"public_access_cidrs\" {\n  type        = list(string)\n  description = \"Indicates which CIDR blocks can access the Amazon EKS public API server endpoint when enabled. EKS defaults this to a list with 0.0.0.0/0.\"\n  default     = [\"0.0.0.0/0\"]\n}\n\nvariable \"service_ipv4_cidr\" {\n  type        = string\n  description = <<-EOT\n    The CIDR block to assign Kubernetes service IP addresses from.\n    You can only specify a custom CIDR block when you create a cluster, changing this value will force a new cluster to be created.\n    EOT\n  default     = null\n}\n\nvariable \"kubernetes_network_ipv6_enabled\" {\n  type        = bool\n  description = \"Set true to use IPv6 addresses for Kubernetes pods and services\"\n  default     = false\n}\n\nvariable \"enabled_cluster_log_types\" {\n  type        = list(string)\n  description = \"A list of the desired control plane logging to enable. For more information, see https://docs.aws.amazon.com/en_us/eks/latest/userguide/control-plane-logs.html. Possible values [`api`, `audit`, `authenticator`, `controllerManager`, `scheduler`]\"\n  default     = []\n}\n\nvariable \"cluster_log_retention_period\" {\n  type        = number\n  description = \"Number of days to retain cluster logs. Requires `enabled_cluster_log_types` to be set. See https://docs.aws.amazon.com/en_us/eks/latest/userguide/control-plane-logs.html.\"\n  default     = 0\n}\n\nvariable \"cluster_encryption_config_enabled\" {\n  type        = bool\n  description = \"Set to `true` to enable Cluster Encryption Configuration\"\n  default     = true\n}\n\nvariable \"cluster_encryption_config_kms_key_id\" {\n  type        = string\n  description = \"KMS Key ID to use for cluster encryption config\"\n  default     = \"\"\n}\n\nvariable \"cluster_encryption_config_kms_key_enable_key_rotation\" {\n  type        = bool\n  description = \"Cluster Encryption Config KMS Key Resource argument - enable kms key rotation\"\n  default     = true\n}\n\nvariable \"cluster_encryption_config_kms_key_deletion_window_in_days\" {\n  type        = number\n  description = \"Cluster Encryption Config KMS Key Resource argument - key deletion windows in days post destruction\"\n  default     = 10\n}\n\nvariable \"cluster_encryption_config_kms_key_policy\" {\n  type        = string\n  description = \"Cluster Encryption Config KMS Key Resource argument - key policy\"\n  default     = null\n}\n\nvariable \"cluster_encryption_config_resources\" {\n  type        = list(any)\n  description = \"Cluster Encryption Config Resources to encrypt, e.g. ['secrets']\"\n  default     = [\"secrets\"]\n}\n\nvariable \"permissions_boundary\" {\n  type        = string\n  description = \"If provided, all IAM roles will be created with this permissions boundary attached\"\n  default     = null\n}\n\nvariable \"cloudwatch_log_group_kms_key_id\" {\n  type        = string\n  description = \"If provided, the KMS Key ID to use to encrypt AWS CloudWatch logs\"\n  default     = null\n}\n\nvariable \"cloudwatch_log_group_class\" {\n  type        = string\n  description = \"Specified the log class of the log group. Possible values are: `STANDARD` or `INFREQUENT_ACCESS`\"\n  default     = null\n}\n\nvariable \"addons\" {\n  type = list(object({\n    addon_name           = string\n    addon_version        = optional(string, null)\n    configuration_values = optional(string, null)\n    # resolve_conflicts is deprecated, but we keep it for backwards compatibility\n    # and because if not declared, Terraform will silently ignore it.\n    resolve_conflicts           = optional(string, null)\n    resolve_conflicts_on_create = optional(string, null)\n    resolve_conflicts_on_update = optional(string, null)\n    service_account_role_arn    = optional(string, null)\n    pod_identity_association    = optional(map(string), {})\n    create_timeout              = optional(string, null)\n    update_timeout              = optional(string, null)\n    delete_timeout              = optional(string, null)\n    additional_tags             = optional(map(string), {})\n  }))\n  description = <<-EOT\n    Manages [`aws_eks_addon`](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_addon) resources.\n    Note: `resolve_conflicts` is deprecated. If `resolve_conflicts` is set and\n    `resolve_conflicts_on_create` or `resolve_conflicts_on_update` is not set,\n    `resolve_conflicts` will be used instead. If `resolve_conflicts_on_create` is\n    not set and `resolve_conflicts` is `PRESERVE`, `resolve_conflicts_on_create`\n    will be set to `NONE`.\n    If `additional_tags` are specified, they are added to the standard resource tags.\n    EOT\n  default     = []\n}\n\nvariable \"addons_depends_on\" {\n  type        = any\n  description = <<-EOT\n    If provided, all addons will depend on this object, and therefore not be installed until this object is finalized.\n    This is useful if you want to ensure that addons are not applied before some other condition is met, e.g. node groups are created.\n    See [issue #170](https://github.com/cloudposse/terraform-aws-eks-cluster/issues/170) for more details.\n    EOT\n  default     = null\n}\n\nvariable \"bootstrap_self_managed_addons_enabled\" {\n  description = \"Manages bootstrap of default networking addons after cluster has been created\"\n  type        = bool\n  default     = null\n}\n\nvariable \"upgrade_policy\" {\n  type = object({\n    support_type = optional(string, null)\n  })\n  description = \"Configuration block for the support policy to use for the cluster\"\n  default     = null\n}\n\nvariable \"zonal_shift_config\" {\n  type = object({\n    enabled = optional(bool, null)\n  })\n  description = \"Configuration block with zonal shift configuration for the cluster\"\n  default     = null\n}\n\nvariable \"cluster_attributes\" {\n  type        = list(string)\n  description = \"Override label module default cluster attributes\"\n  default     = [\"cluster\"]\n}\n\nvariable \"access_config\" {\n  type = object({\n    authentication_mode                         = optional(string, \"API\")\n    bootstrap_cluster_creator_admin_permissions = optional(bool, false)\n  })\n  description = \"Access configuration for the EKS cluster.\"\n  default     = {}\n  nullable    = false\n\n  validation {\n    condition     = !contains([\"CONFIG_MAP\"], var.access_config.authentication_mode)\n    error_message = \"The CONFIG_MAP authentication_mode is not supported.\"\n  }\n}\n\nvariable \"access_entry_map\" {\n  type = map(object({\n    # key is principal_arn\n    user_name = optional(string)\n    # Cannot assign \"system:*\" groups to IAM users, use ClusterAdmin and Admin instead\n    kubernetes_groups = optional(list(string), [])\n    type              = optional(string, \"STANDARD\")\n    access_policy_associations = optional(map(object({\n      # key is policy_arn or policy_name\n      access_scope = optional(object({\n        type       = optional(string, \"cluster\")\n        namespaces = optional(list(string))\n      }), {}) # access_scope\n    })), {})  # access_policy_associations\n  }))         # access_entry_map\n  description = <<-EOT\n    Map of IAM Principal ARNs to access configuration.\n    Preferred over other inputs as this configuration remains stable\n    when elements are added or removed, but it requires that the Principal ARNs\n    and Policy ARNs are known at plan time.\n    Can be used along with other `access_*` inputs, but do not duplicate entries.\n    Map `access_policy_associations` keys are policy ARNs, policy\n    full name (AmazonEKSViewPolicy), or short name (View).\n    It is recommended to use the default `user_name` because the default includes\n    IAM role or user name and the session name for assumed roles.\n    As a special case in support of backwards compatibility, membership in the\n    `system:masters` group is is translated to an association with the ClusterAdmin policy.\n    In all other cases, including any `system:*` group in `kubernetes_groups` is prohibited.\n    EOT\n  default     = {}\n  nullable    = false\n}\n\nvariable \"access_entries\" {\n  type = list(object({\n    principal_arn     = string\n    user_name         = optional(string, null)\n    kubernetes_groups = optional(list(string), null)\n  }))\n  description = <<-EOT\n    List of IAM principles to allow to access the EKS cluster.\n    It is recommended to use the default `user_name` because the default includes\n    the IAM role or user name and the session name for assumed roles.\n    Use when Principal ARN is not known at plan time.\n    EOT\n  default     = []\n  nullable    = false\n}\n\nvariable \"access_policy_associations\" {\n  type = list(object({\n    principal_arn = string\n    policy_arn    = string\n    access_scope = optional(object({\n      type       = optional(string, \"cluster\")\n      namespaces = optional(list(string))\n    }), {})\n  }))\n  description = <<-EOT\n    List of AWS managed EKS access policies to associate with IAM principles.\n    Use when Principal ARN or Policy ARN is not known at plan time.\n    `policy_arn` can be the full ARN, the full name (AmazonEKSViewPolicy) or short name (View).\n    EOT\n  default     = []\n  nullable    = false\n}\n\nvariable \"access_entries_for_nodes\" {\n  # We use a map instead of an object because if a user supplies\n  # an object with an unexpected key, Terraform simply ignores it,\n  # leaving us with no way to detect the error.\n  type        = map(list(string))\n  description = <<-EOT\n    Map of list of IAM roles for the EKS non-managed worker nodes.\n    The map key is the node type, either `EC2_LINUX` or `EC2_WINDOWS`,\n    and the list contains the IAM roles of the nodes of that type.\n    There is no need for or utility in creating Fargate access entries, as those\n    are always created automatically by AWS, just as with managed nodes.\n    Use when Principal ARN is not known at plan time.\n    EOT\n  default     = {}\n  nullable    = false\n  validation {\n    condition = length([for k in keys(var.access_entries_for_nodes) : k if !contains([\"EC2_LINUX\", \"EC2_WINDOWS\"], k)]) == 0\n    error_message = format(<<-EOS\n      The access_entries_for_nodes object can only contain the EC2_LINUX and EC2_WINDOWS attributes:\n      Keys \"%s\" not allowed.\n      EOS\n    , join(\"\\\", \\\"\", [for k in keys(var.access_entries_for_nodes) : k if !contains([\"EC2_LINUX\", \"EC2_WINDOWS\"], k)]))\n  }\n  validation {\n    condition     = !(contains(keys(var.access_entries_for_nodes), \"FARGATE_LINUX\"))\n    error_message = <<-EOM\n      Access entries of type \"FARGATE_LINUX\" are not supported because they are\n      automatically created by AWS EKS and should not be managed by Terraform.\n      EOM\n  }\n}\n\n## Limited support for modifying the EKS-managed Security Group\n## In the future, even this limited support may be removed\n\nvariable \"managed_security_group_rules_enabled\" {\n  type        = bool\n  description = \"Flag to enable/disable the ingress and egress rules for the EKS managed Security Group\"\n  default     = true\n}\n\nvariable \"allowed_security_group_ids\" {\n  type        = list(string)\n  default     = []\n  description = <<-EOT\n    A list of IDs of Security Groups to allow access to the cluster.\n    EOT\n}\n\nvariable \"allowed_cidr_blocks\" {\n  type        = list(string)\n  default     = []\n  description = <<-EOT\n    A list of IPv4 CIDRs to allow access to the cluster.\n    The length of this list must be known at \"plan\" time.\n    EOT\n}\n\nvariable \"custom_ingress_rules\" {\n  type = list(object({\n    description              = string\n    from_port                = number\n    to_port                  = number\n    protocol                 = string\n    source_security_group_id = string\n  }))\n  default     = []\n  description = <<-EOT\n    A List of Objects, which are custom security group rules that\n    EOT\n}\n\nvariable \"remote_network_config\" {\n  description = \"Configuration block for the cluster remote network configuration\"\n  type = object({\n    remote_node_networks_cidrs = list(string)\n    remote_pod_networks_cidrs  = optional(list(string))\n  })\n  default = null\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-eks-cluster__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#  vim:ts=2:sts=2:sw=2:et\n#\n#  Author: Hari Sekhon\n#  Date: [% DATE  # 2020-02-03 13:37:32 +0000 (Mon, 03 Feb 2020) %]\n#\n#  https://github.com/HariSekhon/Terraform\n#\n#  License: see accompanying Hari Sekhon LICENSE file\n#\n#  If you're using my code you're welcome to connect with me on LinkedIn and optionally send me feedback to help steer this or other code I publish\n#\n#  https://www.linkedin.com/in/HariSekhon\n#\n\n# Create the mynetwork network\nresource \"google_compute_network\" \"mynetwork\" {\n  name                    = \"mynetwork\"\n  auto_create_subnetworks = \"true\"\n}\n\n# Add a firewall rule to allow HTTP, SSH, RDP and ICMP traffic on mynetwork\nresource \"google_compute_firewall\" \"mynetwork-allow-http-ssh-rdp-icmp\" {\n  name    = \"mynetwork-allow-http-ssh-rdp-icmp\"\n  network = google_compute_network.mynetwork.self_link\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\", \"80\", \"3389\"]\n  }\n  allow {\n    protocol = \"icmp\"\n  }\n}\n\n# mynet-us-vm instance\nmodule \"mynet-us-vm\" {\n  source              = \"./instance\"\n  instance_name       = \"mynet-us-vm\"\n  instance_zone       = \"us-central1-a\"\n  instance_subnetwork = google_compute_network.mynetwork.self_link\n}\n\n# mynet-eu-vm instance\nmodule \"mynet-eu-vm\" {\n  source              = \"./instance\"\n  instance_name       = \"mynet-eu-vm\"\n  instance_zone       = \"europe-west1-d\"\n  instance_subnetwork = google_compute_network.mynetwork.self_link\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HariSekhon__Terraform__gcp_network.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#--------------------------------------------------------------\n# This module creates all compute resources\n#--------------------------------------------------------------\n\nvariable \"name\"               { }\nvariable \"region\"             { }\nvariable \"vpc_id\"             { }\nvariable \"vpc_cidr\"           { }\nvariable \"key_name\"           { }\nvariable \"azs\"                { }\nvariable \"private_subnet_ids\" { }\nvariable \"public_subnet_ids\"  { }\nvariable \"site_ssl_cert\"      { }\nvariable \"site_ssl_key\"       { }\nvariable \"vault_ssl_cert\"     { }\nvariable \"atlas_username\"     { }\nvariable \"atlas_environment\"  { }\nvariable \"atlas_aws_global\"   { }\nvariable \"atlas_token\"        { }\nvariable \"sub_domain\"         { }\nvariable \"route_zone_id\"      { }\nvariable \"vault_token\"        { default = \"\" }\n\nvariable \"haproxy_amis\"          { }\nvariable \"haproxy_node_count\"    { }\nvariable \"haproxy_instance_type\" { }\n\nvariable \"nodejs_blue_ami\"            { }\nvariable \"nodejs_blue_node_count\"     { }\nvariable \"nodejs_blue_instance_type\"  { }\nvariable \"nodejs_blue_weight\"         { }\nvariable \"nodejs_green_ami\"           { }\nvariable \"nodejs_green_node_count\"    { }\nvariable \"nodejs_green_instance_type\" { }\nvariable \"nodejs_green_weight\"        { }\n\nmodule \"haproxy\" {\n  source = \"./haproxy\"\n\n  name               = \"${var.name}-haproxy\"\n  vpc_id             = \"${var.vpc_id}\"\n  vpc_cidr           = \"${var.vpc_cidr}\"\n  key_name           = \"${var.key_name}\"\n  subnet_ids         = \"${var.public_subnet_ids}\"\n  atlas_username     = \"${var.atlas_username}\"\n  atlas_environment  = \"${var.atlas_environment}\"\n  atlas_token        = \"${var.atlas_token}\"\n  amis               = \"${var.haproxy_amis}\"\n  nodes              = \"${var.haproxy_node_count}\"\n  instance_type      = \"${var.haproxy_instance_type}\"\n  sub_domain         = \"${var.sub_domain}\"\n  route_zone_id      = \"${var.route_zone_id}\"\n}\n\nmodule \"nodejs\" {\n  source = \"./nodejs\"\n\n  name                = \"${var.name}-nodejs\"\n  region              = \"${var.region}\"\n  vpc_id              = \"${var.vpc_id}\"\n  vpc_cidr            = \"${var.vpc_cidr}\"\n  key_name            = \"${var.key_name}\"\n  azs                 = \"${var.azs}\"\n  private_subnet_ids  = \"${var.private_subnet_ids}\"\n  public_subnet_ids   = \"${var.public_subnet_ids}\"\n  site_ssl_cert       = \"${var.site_ssl_cert}\"\n  site_ssl_key        = \"${var.site_ssl_key}\"\n  vault_ssl_cert      = \"${var.vault_ssl_cert}\"\n  atlas_username      = \"${var.atlas_username}\"\n  atlas_environment   = \"${var.atlas_environment}\"\n  atlas_aws_global    = \"${var.atlas_aws_global}\"\n  atlas_token         = \"${var.atlas_token}\"\n  blue_weight         = \"${var.nodejs_blue_weight}\"\n  blue_ami            = \"${var.nodejs_blue_ami}\"\n  blue_nodes          = \"${var.nodejs_blue_node_count}\"\n  blue_instance_type  = \"${var.nodejs_blue_instance_type}\"\n  green_ami           = \"${var.nodejs_green_ami}\"\n  green_nodes         = \"${var.nodejs_green_node_count}\"\n  green_instance_type = \"${var.nodejs_green_instance_type}\"\n  green_weight        = \"${var.nodejs_green_weight}\"\n  sub_domain          = \"${var.sub_domain}\"\n  route_zone_id       = \"${var.route_zone_id}\"\n  vault_token         = \"${var.vault_token}\"\n}\n\noutput \"haproxy_private_ips\"  { value = \"${module.haproxy.private_ips}\" }\noutput \"haproxy_public_ips\"   { value = \"${module.haproxy.public_ips}\" }\noutput \"haproxy_private_fqdn\" { value = \"${module.haproxy.private_fqdn}\" }\noutput \"haproxy_public_fqdn\"  { value = \"${module.haproxy.public_fqdn}\" }\n\noutput \"nodejs_blue_elb_zone_id\"   { value = \"${module.nodejs.blue_elb_zone_id}\" }\noutput \"nodejs_blue_private_fqdn\"  { value = \"${module.nodejs.blue_private_fqdn}\" }\noutput \"nodejs_blue_elb_dns\"       { value = \"${module.nodejs.blue_elb_dns}\" }\noutput \"nodejs_green_elb_zone_id\"  { value = \"${module.nodejs.green_elb_zone_id}\" }\noutput \"nodejs_green_private_fqdn\" { value = \"${module.nodejs.green_private_fqdn}\" }\noutput \"nodejs_green_elb_dns\"      { value = \"${module.nodejs.green_elb_dns}\" }\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__compute__compute.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\n# ---------------------------------------------------------------------------------------------------------------------\n# MANDATORY PARAMETERS\n# ---------------------------------------------------------------------------------------------------------------------\n\nvariable \"access_key\" {\n  description = \"AWS Access Key\"\n  type = string\n}\n\nvariable \"secret_key\" {\n  description = \"AWS Secret Key\"\n  type = string\n}\n\nvariable \"region\" {\n  description = \"AWS Region\"\n  type = string\n}\n\nvariable \"availability_zones\" {\n  description = \"Availability zones in a region to deploy instances on\"\n  type = list\n}\n\nvariable \"app_stack1_availability_zone\" {\n  description = \"Availability zones in a region to deploy instances\"\n  type = string\n}\n\nvariable \"app_stack2_availability_zone\" {\n  description = \"Availability zones in a region to deploy instances\"\n  type = string\n}\n\nvariable \"vpc_cidr\" {\n  description = \"IP CIDR range for the Security VPC\"\n  type = string\n}\nvariable \"app1_vpc_cidr\" {\n  description = \"IP CIDR range for the App2 VPC\"\n  type = string\n}\n\nvariable \"app2_vpc_cidr\" {\n  description = \"IP CIDR range for the App2 VPC\"\n  type = string\n}\nvariable \"firewall_ami_id\" {\n  description = \"VM-Series AMI ID BYOL/Bundle1/Bundle2 for the specified region\"\n  type = string\n}\n\nvariable \"public_key\" {\n  description = \"Public key string for AWS SSH Key Pair\"\n  type = string\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# OPTIONAL PARAMETERS\n# ---------------------------------------------------------------------------------------------------------------------\n\n\nvariable \"prefix\" {\n  description = \"Deployment ID Prefix\"\n  type = string\n  default = \"PANW\"\n}\n\nvariable \"user_data\" {\n  description = \"User Data for VM Series Bootstrapping. Ex. 'type=dhcp-client\\nhostname=PANW\\nvm-auth-key=0000000000\\npanorama-server=<Panorama Server IP>\\ntplname=<Panorama Template Stack Name>\\ndgname=<Panorama Device Group Name>' or 'vmseries-bootstrap-aws-s3bucket=<s3-bootstrap-bucket-name>'\"\n  type = string\n  default = \"\"\n}\n\nvariable \"fw_mgmt_sg_list\" {\n  description = \"List of IP CIDRs that are allowed to access firewall management interface\"\n  type = list(string)\n  default = [\"0.0.0.0/0\"]\n}\n\nvariable \"instance_type\" {\n  description = \"Instance type of the web server instances in ASG\"\n  type = string\n  default = \"m5.xlarge\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__GWLB-Demo__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n################################################################################\n# IAM Group\n################################################################################\n\noutput \"group_id\" {\n  description = \"The group's ID\"\n  value       = module.iam_group.id\n}\n\noutput \"group_arn\" {\n  description = \"The ARN assigned by AWS for this group\"\n  value       = module.iam_group.arn\n}\n\noutput \"group_name\" {\n  description = \"The group's name\"\n  value       = module.iam_group.name\n}\n\noutput \"group_unique_id\" {\n  description = \"The unique ID assigned by AWS\"\n  value       = module.iam_group.unique_id\n}\n\noutput \"group_users\" {\n  description = \"List of IAM users in IAM group\"\n  value       = module.iam_group.users\n}\n\noutput \"group_policy_arn\" {\n  description = \"The ARN assigned by AWS for this policy\"\n  value       = module.iam_group.policy_arn\n}\n\noutput \"group_policy_name\" {\n  description = \"The policy's name\"\n  value       = module.iam_group.policy_name\n}\n\noutput \"group_policy_id\" {\n  description = \"The policy's ID\"\n  value       = module.iam_group.policy_id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-iam__examples__iam-group__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ---------------------------------------------------------------------------------------------------------------------\n# REQUIRED VARIABLES\n# ---------------------------------------------------------------------------------------------------------------------\n\n\n# ---------------------------------------------------------------------------------------------------------------------\n# OPTIONAL VARIABLES\n# ---------------------------------------------------------------------------------------------------------------------\n\nvariable \"name\" {\n  description = \"The name of the Lambda function\"\n  type        = string\n  default     = \"lambda-service-example\"\n}\n\nvariable \"aws_region\" {\n  description = \"The AWS region to deploy into\"\n  type        = string\n  default     = \"us-east-2\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terragrunt-infrastructure-modules-example__examples__lambda-service__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable unquoted {}\n\nvariable \"bool-3\" {\n  default = true\n}\n\nvariable \"bool-2\" {\n  description = \"It's bool number two.\"\n  default     = false\n}\n\n// It's bool number one.\nvariable \"bool-1\" {\n  default = true\n}\n\n# terraform-docs-ignore\nvariable \"ignored\" {\n  default = \"\"\n}\n\nvariable \"string-3\" {\n  default = \"\"\n}\n\nvariable \"string-2\" {\n  description = \"It's string number two.\"\n  type        = \"string\"\n}\n\n// It's string number one.\nvariable \"string-1\" {\n  default = \"bar\"\n}\n\nvariable \"string-special-chars\" {\n  default = \"\\\\.<>[]{}_-\"\n}\n\nvariable \"number-3\" {\n  type    = number\n  default = \"19\"\n}\n\nvariable \"number-4\" {\n  type    = number\n  default = 15.75\n}\n\nvariable \"number-2\" {\n  description = \"It's number number two.\"\n  type        = \"number\"\n}\n\n// It's number number one.\nvariable \"number-1\" {\n  default = 42\n}\n\nvariable \"map-3\" {\n  default = {}\n}\n\nvariable \"map-2\" {\n  description = \"It's map number two.\"\n  type        = \"map\"\n}\n\n// It's map number one.\nvariable \"map-1\" {\n  default = {\n    a = 1\n    b = 2\n    c = 3\n  }\n\n  type = \"map\"\n}\n\nvariable \"list-3\" {\n  default = []\n}\n\nvariable \"list-2\" {\n  description = \"It's list number two.\"\n  type        = \"list\"\n}\n\n// It's list number one.\nvariable \"list-1\" {\n  default = [\"a\", \"b\", \"c\"]\n  type    = \"list\"\n}\n\n// A variable with underscores.\nvariable \"input_with_underscores\" {}\n\n// A variable with pipe in the description\nvariable \"input-with-pipe\" {\n  description = \"It includes v1 | v2 | v3\"\n  default     = \"v1\"\n}\n\nvariable \"input-with-code-block\" {\n  description = <<EOD\nThis is a complicated one. We need a newline.  \nAnd an example in a code block\n```\ndefault     = [\n  \"machine rack01:neptune\"\n]\n```\nEOD\n  default = [\n    \"name rack:location\"\n  ]\n}\n\nvariable \"long_type\" {\n  type = object({\n    name = string,\n    foo  = object({ foo = string, bar = string }),\n    bar  = object({ foo = string, bar = string }),\n    fizz = list(string),\n    buzz = list(string)\n  })\n  default = {\n    name = \"hello\"\n    foo = {\n      foo = \"foo\"\n      bar = \"foo\"\n    }\n    bar = {\n      foo = \"bar\"\n      bar = \"bar\"\n    },\n    fizz = []\n    buzz = [\"fizz\", \"buzz\"]\n  }\n  description = <<EOF\nThis description is itself markdown.\n\nIt spans over multiple lines.\nEOF\n}\n\nvariable \"no-escape-default-value\" {\n  description = \"The description contains `something_with_underscore`. Defaults to 'VALUE_WITH_UNDERSCORE'.\"\n  default     = \"VALUE_WITH_UNDERSCORE\"\n}\n\nvariable \"with-url\" {\n  description = \"The description contains url. https://www.domain.com/foo/bar_baz.html\"\n  default     = \"\"\n}\n\nvariable \"string_default_empty\" {\n  type    = string\n  default = \"\"\n}\n\nvariable \"string_default_null\" {\n  type    = string\n  default = null\n}\n\nvariable \"string_no_default\" {\n  type = string\n}\n\nvariable \"number_default_zero\" {\n  type    = number\n  default = 0\n}\n\nvariable \"bool_default_false\" {\n  type    = bool\n  default = false\n}\n\nvariable \"list_default_empty\" {\n  type    = list(string)\n  default = []\n}\n\nvariable \"object_default_empty\" {\n  type    = object({})\n  default = {}\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-docs__terraform-docs__examples__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nlocals {\n  name         = \"App_server\"\n  project_name = \"example_project\"\n  owner        = \"team_name\"\n}\n\nlocals {\n  common_tags = {\n    Project = local.project_name\n    Owner   = local.owner\n    Name    = local.name\n  }\n}\n\nresource \"aws_instance\" \"example_instance\" {\n  instance_type = \"t2.micro\"\n  ami           = \"ami-0557a15b87f6559cf\"\n\n  tags          = local.common_tags\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__locals.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__locals.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__locals.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__locals.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__locals.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__locals.tf", "start_line": 19}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#########################################\n#  ESXI Provider host/login details\n#########################################\n#\n#   Use of variables here to hide/move the variables to a separate file\n#\nprovider \"esxi\" {\n  esxi_hostname = var.esxi_hostname\n  esxi_hostport = var.esxi_hostport\n  esxi_username = var.esxi_username\n  esxi_password = var.esxi_password\n}\n\n#########################################\n#  ESXI Guest resource\n#########################################\nresource \"esxi_guest\" \"logger\" {\n  guest_name = \"logger\"\n  disk_store = var.esxi_datastore\n  guestos    = \"ubuntu-64\"\n\n  boot_disk_type = \"thin\"\n\n  memsize            = \"4096\"\n  numvcpus           = \"2\"\n  resource_pool_name = \"/\"\n  power              = \"on\"\n  clone_from_vm = \"Ubuntu2004\"\n\n    provisioner \"remote-exec\" {\n    inline = [\n      \"sudo ifconfig eth0 up && echo 'eth0 up' || echo 'unable to bring eth0 interface up\",\n      \"sudo ifconfig eth1 up && echo 'eth1 up' || echo 'unable to bring eth1 interface up\"\n    ]\n\n    connection {\n      host        = self.ip_address\n      type        = \"ssh\"\n      user        = \"vagrant\"\n      password    = \"vagrant\"\n    }\n  }\n  # This is the network that bridges your host machine with the ESXi VM\n  # If this interface doesn't provide connectivity, you will have to uncomment\n  # the interface below and add a virtual network that does\n  network_interfaces {\n    virtual_network = var.vm_network\n    mac_address     = \"00:50:56:a3:b1:c2\"\n    nic_type        = \"e1000\"\n  }\n  # This is the local network that will be used for 192.168.56.x addressing\n  network_interfaces {\n    virtual_network = var.hostonly_network\n    mac_address     = \"00:50:56:a3:b1:c4\"\n    nic_type        = \"e1000\"\n  }\n  # OPTIONAL: Uncomment out this interface stanza if your vm_network doesn't \n  # provide internet access\n  # network_interfaces {\n  #  virtual_network = var.nat_network\n  #  mac_address     = \"00:50:56:a3:b1:c3\"\n  #  nic_type        = \"e1000\"\n  # }\n  guest_startup_timeout  = 45\n  guest_shutdown_timeout = 30\n}\n\nresource \"esxi_guest\" \"dc\" {\n  guest_name = \"dc\"\n  disk_store = var.esxi_datastore\n  guestos    = \"windows9srv-64\"\n\n  boot_disk_type = \"thin\"\n\n  memsize            = \"4096\"\n  numvcpus           = \"2\"\n  resource_pool_name = \"/\"\n  power              = \"on\"\n  clone_from_vm = \"WindowsServer2016\"\n  # This is the network that bridges your host machine with the ESXi VM\n  network_interfaces {\n    virtual_network = var.vm_network\n    mac_address     = \"00:50:56:a1:b1:c2\"\n    nic_type        = \"e1000\"\n  }\n  # This is the local network that will be used for 192.168.56.x addressing\n  network_interfaces {\n    virtual_network = var.hostonly_network\n    mac_address     = \"00:50:56:a1:b1:c4\"\n    nic_type        = \"e1000\"\n  }\n  guest_startup_timeout  = 45\n  guest_shutdown_timeout = 30\n}\n\nresource \"esxi_guest\" \"wef\" {\n  guest_name = \"wef\"\n  disk_store = var.esxi_datastore\n  guestos    = \"windows9srv-64\"\n\n  boot_disk_type = \"thin\"\n\n  memsize            = \"2048\"\n  numvcpus           = \"2\"\n  resource_pool_name = \"/\"\n  power              = \"on\"\n  clone_from_vm = \"WindowsServer2016\"\n  # This is the network that bridges your host machine with the ESXi VM\n  network_interfaces {\n    virtual_network = var.vm_network\n    mac_address     = \"00:50:56:a1:b2:c2\"\n    nic_type        = \"e1000\"\n  }\n  # This is the local network that will be used for 192.168.56.x addressing\n  network_interfaces {\n    virtual_network = var.hostonly_network\n    mac_address     = \"00:50:56:a1:b4:c4\"\n    nic_type        = \"e1000\"\n  }\n  guest_startup_timeout  = 45\n  guest_shutdown_timeout = 30\n}\n\nresource \"esxi_guest\" \"win10\" {\n  guest_name = \"win10\"\n  disk_store = var.esxi_datastore\n  guestos    = \"windows9-64\"\n\n  boot_disk_type = \"thin\"\n\n  memsize            = \"2048\"\n  numvcpus           = \"2\"\n  resource_pool_name = \"/\"\n  power              = \"on\"\n  clone_from_vm = \"Windows10\"\n  # This is the network that bridges your host machine with the ESXi VM\n  network_interfaces {\n    virtual_network = var.vm_network\n    mac_address     = \"00:50:56:a2:b1:c2\"\n    nic_type        = \"e1000\"\n  }\n  # This is the local network that will be used for 192.168.56.x addressing\n  network_interfaces {\n    virtual_network = var.hostonly_network\n    mac_address     = \"00:50:56:a2:b1:c4\"\n    nic_type        = \"e1000\"\n  }\n  guest_startup_timeout  = 45\n  guest_shutdown_timeout = 30\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/clong__DetectionLab__ESXi__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Terraform Settings Block\nterraform {\n  required_version = \"~> 1.0\"\n  required_providers {\n    aws = {\n        source  = \"hashicorp/aws\"\n        version = \"~> 3.0\"\n        # Optional but recommended in production\n    }\n  }\n}\n\n# Provider Block\nprovider \"aws\" {\n  profile = \"default\"\n  region  = \"us-west-2\"\n}\n\n# Resource Block\n\nresource \"aws_vpc\" \"project1vpc\" {\n    cidr_block = var.cidr\n    tags = {\n        Name = var.vpc_name\n    }\n}\n\nvariable \"cidr\" {\n  type = string\n  default = \"192.168.0.0/24\"\n}\n\nvariable \"vpc_name\" {\n  type = string\n  default = \"FirstVPC\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__03 - Language Syntax__Project-03__vpc-03__vpc-03-solution__vpc.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlocals {\n  internal_encryption = var.internal_encryption_config.create_encryption_key ? { default_kms_key_name = module.encryption_key[0].keys[var.name] } : null\n  encryption          = var.internal_encryption_config.create_encryption_key ? local.internal_encryption : var.encryption\n}\n\nresource \"google_storage_bucket\" \"bucket\" {\n  name                        = var.name\n  project                     = var.project_id\n  location                    = var.location\n  storage_class               = var.storage_class\n  uniform_bucket_level_access = var.bucket_policy_only\n  labels                      = var.labels\n  force_destroy               = var.force_destroy\n  public_access_prevention    = var.public_access_prevention\n\n  versioning {\n    enabled = var.versioning\n  }\n\n  autoclass {\n    enabled = var.autoclass\n  }\n\n  hierarchical_namespace {\n    enabled = var.hierarchical_namespace\n  }\n\n  dynamic \"retention_policy\" {\n    for_each = var.retention_policy == null ? [] : [var.retention_policy]\n    content {\n      is_locked        = var.retention_policy.is_locked\n      retention_period = var.retention_policy.retention_period\n    }\n  }\n\n  dynamic \"encryption\" {\n    for_each = local.encryption == null ? [] : [local.encryption]\n    content {\n      default_kms_key_name = local.encryption.default_kms_key_name\n    }\n  }\n\n  dynamic \"website\" {\n    for_each = (var.website.main_page_suffix == null && var.website.not_found_page == null) ? toset([]) : toset([var.website])\n    content {\n      main_page_suffix = lookup(website.value, \"main_page_suffix\", null)\n      not_found_page   = lookup(website.value, \"not_found_page\", null)\n    }\n  }\n\n  dynamic \"cors\" {\n    for_each = var.cors == null ? [] : var.cors\n    content {\n      origin          = lookup(cors.value, \"origin\", null)\n      method          = lookup(cors.value, \"method\", null)\n      response_header = lookup(cors.value, \"response_header\", null)\n      max_age_seconds = lookup(cors.value, \"max_age_seconds\", null)\n    }\n  }\n\n  dynamic \"custom_placement_config\" {\n    for_each = var.custom_placement_config == null ? [] : [var.custom_placement_config]\n    content {\n      data_locations = var.custom_placement_config.data_locations\n    }\n  }\n\n  dynamic \"lifecycle_rule\" {\n    for_each = var.lifecycle_rules\n    content {\n      action {\n        type          = lifecycle_rule.value.action.type\n        storage_class = lookup(lifecycle_rule.value.action, \"storage_class\", null)\n      }\n      condition {\n        age                        = lookup(lifecycle_rule.value.condition, \"age\", null)\n        send_age_if_zero           = lookup(lifecycle_rule.value.condition, \"send_age_if_zero\", null)\n        created_before             = lookup(lifecycle_rule.value.condition, \"created_before\", null)\n        with_state                 = lookup(lifecycle_rule.value.condition, \"with_state\", contains(keys(lifecycle_rule.value.condition), \"is_live\") ? (lifecycle_rule.value.condition[\"is_live\"] ? \"LIVE\" : null) : null)\n        matches_storage_class      = lifecycle_rule.value.condition[\"matches_storage_class\"] != null ? split(\",\", lifecycle_rule.value.condition[\"matches_storage_class\"]) : null\n        matches_prefix             = lifecycle_rule.value.condition[\"matches_prefix\"] != null ? split(\",\", lifecycle_rule.value.condition[\"matches_prefix\"]) : null\n        matches_suffix             = lifecycle_rule.value.condition[\"matches_suffix\"] != null ? split(\",\", lifecycle_rule.value.condition[\"matches_suffix\"]) : null\n        num_newer_versions         = lookup(lifecycle_rule.value.condition, \"num_newer_versions\", null)\n        custom_time_before         = lookup(lifecycle_rule.value.condition, \"custom_time_before\", null)\n        days_since_custom_time     = lookup(lifecycle_rule.value.condition, \"days_since_custom_time\", null)\n        days_since_noncurrent_time = lookup(lifecycle_rule.value.condition, \"days_since_noncurrent_time\", null)\n        noncurrent_time_before     = lookup(lifecycle_rule.value.condition, \"noncurrent_time_before\", null)\n      }\n    }\n  }\n\n  dynamic \"logging\" {\n    for_each = var.log_bucket == null ? [] : [var.log_bucket]\n    content {\n      log_bucket        = var.log_bucket\n      log_object_prefix = var.log_object_prefix\n    }\n  }\n\n  dynamic \"soft_delete_policy\" {\n    for_each = var.soft_delete_policy == {} ? [] : [var.soft_delete_policy]\n    content {\n      retention_duration_seconds = lookup(soft_delete_policy.value, \"retention_duration_seconds\", null)\n    }\n  }\n\n  dynamic \"ip_filter\" {\n    for_each = var.ip_filter == null ? [] : [var.ip_filter]\n    content {\n      mode                           = ip_filter.value.mode\n      allow_cross_org_vpcs           = ip_filter.value.allow_cross_org_vpcs\n      allow_all_service_agent_access = ip_filter.value.allow_all_service_agent_access\n      dynamic \"public_network_source\" {\n        for_each = ip_filter.value.public_network_source != null ? [ip_filter.value.public_network_source] : []\n        content {\n          allowed_ip_cidr_ranges = public_network_source.value.allowed_ip_cidr_ranges\n        }\n      }\n      dynamic \"vpc_network_sources\" {\n        for_each = ip_filter.value.vpc_network_sources != null ? ip_filter.value.vpc_network_sources : []\n        content {\n          network                = vpc_network_sources.value.network\n          allowed_ip_cidr_ranges = vpc_network_sources.value.allowed_ip_cidr_ranges\n        }\n      }\n    }\n  }\n}\n\nresource \"google_storage_bucket_iam_member\" \"members\" {\n  for_each = {\n    for m in var.iam_members : \"${m.role} ${m.member}\" => m\n  }\n  bucket = google_storage_bucket.bucket.name\n  role   = each.value.role\n  member = each.value.member\n}\n\ndata \"google_storage_project_service_account\" \"gcs_account\" {\n  project = var.project_id\n}\n\nmodule \"encryption_key\" {\n  source  = \"terraform-google-modules/kms/google\"\n  version = \"~> 4.0\"\n  count   = var.internal_encryption_config.create_encryption_key ? 1 : 0\n\n  project_id                     = var.project_id\n  location                       = lower(var.location)\n  keyring                        = var.name\n  prevent_destroy                = var.internal_encryption_config.prevent_destroy\n  key_destroy_scheduled_duration = var.internal_encryption_config.key_destroy_scheduled_duration\n  key_rotation_period            = var.internal_encryption_config.key_rotation_period\n  keys                           = [var.name]\n  set_decrypters_for             = [var.name]\n  set_encrypters_for             = [var.name]\n  decrypters                     = [\"serviceAccount:${data.google_storage_project_service_account.gcs_account.email_address}\"]\n  encrypters                     = [\"serviceAccount:${data.google_storage_project_service_account.gcs_account.email_address}\"]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-cloud-storage__modules__simple_bucket__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-cloud-storage__modules__simple_bucket__main.tf", "start_line": 159}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"kubernetes-api-server\" {\n    value = \"https://${google_compute_instance.kube-apiserver.network_interface.0.access_config.0.nat_ip}:6443\"\n}\n\nresource \"template_file\" \"etcd\" {\n    filename = \"etcd.env\"\n    vars {\n        cluster_token = \"${var.cluster_name}\"\n        discovery_url = \"${var.discovery_url}\"\n    }\n}\n\nresource \"template_file\" \"kubernetes\" {\n    filename = \"kubernetes.env\"\n    vars {\n        api_servers = \"http://${var.cluster_name}-kube-apiserver.c.${var.project}.internal:8080\"\n        etcd_servers = \"${join(\",\", \"${formatlist(\"http://%s:2379\", google_compute_instance.etcd.*.network_interface.0.address)}\")}\"\n        flannel_backend = \"${var.flannel_backend}\"\n        flannel_network = \"${var.flannel_network}\"\n        portal_net = \"${var.portal_net}\"\n    }\n}\n\nprovider \"google\" {\n    account_file = \"${var.account_file}\"\n    project = \"${var.project}\"\n    region = \"${var.region}\"\n}\n\nresource \"google_compute_firewall\" \"kubernetes-api\" {\n    description = \"Kubernetes API\"\n    name = \"secure-kubernetes-api\"\n    network = \"default\"\n\n    allow {\n        protocol = \"tcp\"\n        ports = [\"6443\"]\n    }\n\n    source_ranges = [\"0.0.0.0/0\"]\n}\n\nresource \"google_compute_instance\" \"etcd\" {\n    count = 3\n\n    name = \"${var.cluster_name}-etcd${count.index}\"\n    machine_type = \"n1-standard-1\"\n    can_ip_forward = true\n    zone = \"${var.zone}\"\n    tags = [\"etcd\"]\n\n    disk {\n        image = \"${var.image}\"\n        size = 200\n    }\n\n    network_interface {\n        network = \"default\"\n        access_config {\n            // Ephemeral IP\n        }\n    }\n\n    metadata {\n        \"sshKeys\" = \"${var.sshkey_metadata}\"\n    }\n\n    provisioner \"remote-exec\" {\n        inline = [\n            \"cat <<'EOF' > /tmp/kubernetes.env\\n${template_file.etcd.rendered}\\nEOF\",\n            \"echo 'ETCD_NAME=${self.name}' >> /tmp/kubernetes.env\",\n            \"echo 'ETCD_LISTEN_CLIENT_URLS=http://0.0.0.0:2379' >> /tmp/kubernetes.env\",\n            \"echo 'ETCD_LISTEN_PEER_URLS=http://0.0.0.0:2380' >> /tmp/kubernetes.env\",\n            \"echo 'ETCD_INITIAL_ADVERTISE_PEER_URLS=http://${self.network_interface.0.address}:2380' >> /tmp/kubernetes.env\",\n            \"echo 'ETCD_ADVERTISE_CLIENT_URLS=http://${self.network_interface.0.address}:2379' >> /tmp/kubernetes.env\",\n            \"sudo mv /tmp/kubernetes.env /etc/kubernetes.env\",\n            \"sudo systemctl enable etcd\",\n            \"sudo systemctl start etcd\"\n        ]\n        connection {\n            user = \"core\"\n            agent = true\n        }\n    }\n\n    depends_on = [\n        \"template_file.etcd\",\n    ]\n}\n\nresource \"google_compute_instance\" \"kube-apiserver\" {\n    name = \"${var.cluster_name}-kube-apiserver\"\n    machine_type = \"n1-standard-1\"\n    can_ip_forward = true\n    zone = \"${var.zone}\"\n    tags = [\"kubernetes\"]\n\n    disk {\n        image = \"${var.image}\"\n        size = 200\n    }\n\n    network_interface {\n        network = \"default\"\n        access_config {\n            // Ephemeral IP\n        }\n    }\n\n    metadata {\n        \"sshKeys\" = \"${var.sshkey_metadata}\"\n    }\n\n    provisioner \"file\" {\n        source = \"${var.token_auth_file}\"\n        destination = \"/tmp/tokens.csv\"\n        connection {\n            user = \"core\"\n            agent = true\n        }\n    }\n\n    provisioner \"remote-exec\" {\n        inline = [\n            \"sudo cat <<'EOF' > /tmp/kubernetes.env\\n${template_file.kubernetes.rendered}\\nEOF\",\n            \"sudo mv /tmp/kubernetes.env /etc/kubernetes.env\",\n            \"sudo mkdir -p /etc/kubernetes\",\n            \"sudo mv /tmp/tokens.csv /etc/kubernetes/tokens.csv\",\n            \"sudo systemctl enable flannel\",\n            \"sudo systemctl enable docker\",\n            \"sudo systemctl enable kube-apiserver\",\n            \"sudo systemctl enable kube-controller-manager\",\n            \"sudo systemctl enable kube-scheduler\",\n            \"sudo systemctl start flannel\",\n            \"sudo systemctl start docker\",\n            \"sudo systemctl start kube-apiserver\",\n            \"sudo systemctl start kube-controller-manager\",\n            \"sudo systemctl start kube-scheduler\"\n        ]\n        connection {\n            user = \"core\"\n            agent = true\n        }\n    }\n\n    depends_on = [\n        \"google_compute_instance.etcd\",\n        \"template_file.kubernetes\",\n    ]\n}\n\nresource \"google_compute_instance\" \"kube\" {\n    count = \"${var.worker_count}\"\n\n    name = \"${var.cluster_name}-kube${count.index}\"\n    can_ip_forward = true\n    machine_type = \"n1-standard-1\"\n    zone = \"${var.zone}\"\n    tags = [\"kubelet\", \"kubernetes\"]\n\n    disk {\n        image = \"${var.image}\"\n        size = 200\n    }\n\n    network_interface {\n        network = \"default\"\n        access_config {\n            // Ephemeral IP\n        }\n    }\n\n    metadata {\n        \"sshKeys\" = \"${var.sshkey_metadata}\"\n    }\n\n    provisioner \"remote-exec\" {\n        inline = [\n            \"sudo cat <<'EOF' > /tmp/kubernetes.env\\n${template_file.kubernetes.rendered}\\nEOF\",\n            \"sudo mv /tmp/kubernetes.env /etc/kubernetes.env\",\n            \"sudo systemctl enable flannel\",\n            \"sudo systemctl enable docker\",\n            \"sudo systemctl enable kube-kubelet\",\n            \"sudo systemctl enable kube-proxy\",\n            \"sudo systemctl start flannel\",\n            \"sudo systemctl start docker\",\n            \"sudo systemctl start kube-kubelet\",\n            \"sudo systemctl start kube-proxy\"\n        ]\n        connection {\n            user = \"core\"\n            agent = true\n        }\n    }\n\n    depends_on = [\n        \"google_compute_instance.kube-apiserver\",\n        \"template_file.kubernetes\"\n    ]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kelseyhightower__kubestack__terraform__kubestack.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kelseyhightower__kubestack__terraform__kubestack.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kelseyhightower__kubestack__terraform__kubestack.tf", "start_line": null}], "tfsec": []}}
