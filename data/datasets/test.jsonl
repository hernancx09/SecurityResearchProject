{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#resource block\nresource \"aws_instance\" \"my_ec2\" {\n  ami           = var.my_ami\n  instance_type = var.my_instance_type\n  key_name      = var.my_key\n\n  tags = {\n    \"Name\" = \"Ec2-Demo\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__2. required-var-example__ec2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__2. required-var-example__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__2. required-var-example__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__2. required-var-example__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__2. required-var-example__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__05 - Variables and Data Sources__a) Variables__examples__2. required-var-example__ec2.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudflare__cf-terraforming__testdata__terraform__v4__cloudflare_access_group_account__test.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \"~> 0.13\"\n  required_providers {\n    aws   = \"~> 3.6\"\n    local = \"~> 1.4\"\n  }\n}\n\nprovider \"aws\" {\n    profile = \"<profile>\"\n    region = \"us-west-2\"\n}\n\n\nresource \"local_file\" \"credentials\" { #A\n  filename           = \"credentials\"\n  file_permission    = \"0644\"\n  sensitive_content  = <<-EOF\n    [${aws_iam_user.app1.name}]\n    aws_access_key_id = ${aws_iam_access_key.app1.id}\n    aws_secret_access_key = ${aws_iam_access_key.app1.secret}\n    \n    [${aws_iam_user.app2.name}]\n    aws_access_key_id = ${aws_iam_access_key.app2.id}\n    aws_secret_access_key = ${aws_iam_access_key.app2.secret}\n  EOF\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.3__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  python = (substr(pathexpand(\"~\"), 0, 1) == \"/\") ? \"python3\" : \"python.exe\"\n}\n\n# Generates a filename for the zip archive based on the content of the files\n# in source_path. The filename will change when the source code changes.\ndata \"external\" \"archive_prepare\" {\n  count = var.create && var.create_package ? 1 : 0\n\n  program = [local.python, \"${path.module}/package.py\", \"prepare\"]\n\n  query = {\n    paths = jsonencode({\n      module = path.module\n      root   = path.root\n      cwd    = path.cwd\n    })\n\n    docker = var.build_in_docker ? jsonencode({\n      docker_pip_cache          = var.docker_pip_cache\n      docker_build_root         = var.docker_build_root\n      docker_file               = var.docker_file\n      docker_image              = var.docker_image\n      with_ssh_agent            = var.docker_with_ssh_agent\n      docker_additional_options = var.docker_additional_options\n      docker_entrypoint         = var.docker_entrypoint\n    }) : null\n\n    artifacts_dir = var.artifacts_dir\n    runtime       = var.runtime\n    source_path   = jsonencode(var.source_path)\n    hash_extra    = var.hash_extra\n    hash_extra_paths = jsonencode(\n      [\n        # Temporary fix when building from multiple locations\n        # We should take into account content of package.py when counting hash\n        # Related issue: https://github.com/terraform-aws-modules/terraform-aws-lambda/issues/63\n        # \"${path.module}/package.py\"\n      ]\n    )\n\n    recreate_missing_package = var.recreate_missing_package\n    quiet                    = var.quiet_archive_local_exec\n  }\n}\n\n# This transitive resource used as a bridge between a state stored\n# in a Terraform plan and a call of a build command on the apply stage\n# to transfer a noticeable amount of data\nresource \"local_file\" \"archive_plan\" {\n  count = var.create && var.create_package ? 1 : 0\n\n  content              = var.build_in_docker ? sensitive(data.external.archive_prepare[0].result.build_plan) : data.external.archive_prepare[0].result.build_plan\n  filename             = data.external.archive_prepare[0].result.build_plan_filename\n  directory_permission = \"0755\"\n  file_permission      = \"0644\"\n}\n\n# Build the zip archive whenever the filename changes.\nresource \"null_resource\" \"archive\" {\n  count = var.create && var.create_package ? 1 : 0\n\n  triggers = {\n    filename  = data.external.archive_prepare[0].result.filename\n    timestamp = var.trigger_on_package_timestamp ? data.external.archive_prepare[0].result.timestamp : null\n  }\n\n  provisioner \"local-exec\" {\n    interpreter = [\n      local.python, \"${path.module}/package.py\", \"build\",\n      \"--timestamp\", data.external.archive_prepare[0].result.timestamp\n    ]\n    command = data.external.archive_prepare[0].result.build_plan_filename\n    quiet   = var.quiet_archive_local_exec\n  }\n\n  depends_on = [local_file.archive_plan]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-lambda__package.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Configure the AWS Provider\nprovider \"aws\" {\n   region  = var.region\n}\n\n# Create VPC\nresource \"aws_vpc\" \"main\" {\n  cidr_block = var.vpc_cidr\n\n  tags = {\n    Project = \"demo-assignment\"\n    Name = \"My Demo VPC\"\n }\n}\n\n# Create Public Subnet1\nresource \"aws_subnet\" \"pub_sub1\" {\n  vpc_id                  = aws_vpc.main.id\n  cidr_block              = var.pub_sub1_cidr_block\n  availability_zone       = \"ap-south-1a\"\n  map_public_ip_on_launch = true\n  tags = {\n    Project = \"demo-assignment\"\n     Name = \"public_subnet1\"\n \n }\n}\n\n# Create Public Subnet2\n\nresource \"aws_subnet\" \"pub_sub2\" {\n  vpc_id                  = aws_vpc.main.id\n  cidr_block              = var.pub_sub2_cidr_block\n  availability_zone       = \"ap-south-1b\"\n  map_public_ip_on_launch = true\n  tags = {\n    Project = \"demo-assignment\"\n    Name = \"public_subnet2\" \n }\n}\n\n# Create Private Subnet1\nresource \"aws_subnet\" \"prv_sub1\" {\n  vpc_id                  = aws_vpc.main.id\n  cidr_block              = var.prv_sub1_cidr_block\n  availability_zone       = \"ap-south-1a\"\n  map_public_ip_on_launch = false\n\n  tags = {\n    Project = \"demo-assignment\"\n    Name = \"private_subnet1\" \n }\n}\n\n# Create Private Subnet2\nresource \"aws_subnet\" \"prv_sub2\" {\n  vpc_id                  = aws_vpc.main.id\n  cidr_block              = var.prv_sub2_cidr_block\n  availability_zone       = \"ap-south-1b\"\n  map_public_ip_on_launch = false\n\n  tags = {\n    Project = \"demo-assignment\"\n    Name = \"private_subnet2\"\n  }\n}\n\n# Create Internet Gateway\n\nresource \"aws_internet_gateway\" \"igw\" {\n  vpc_id = aws_vpc.main.id\n\n  tags = {\n    Project = \"demo-assignment\"\n    Name = \"internet gateway\" \n }\n}\n\n# Create Public Route Table\n\nresource \"aws_route_table\" \"pub_sub1_rt\" {\n  vpc_id = aws_vpc.main.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.igw.id\n  }\n\n  tags = {\n    Project = \"demo-assignment\"\n    Name = \"public subnet route table\" \n }\n}\n\n# Create route table association of public subnet1\n\nresource \"aws_route_table_association\" \"internet_for_pub_sub1\" {\n  route_table_id = aws_route_table.pub_sub1_rt.id\n  subnet_id      = aws_subnet.pub_sub1.id\n}\n# Create route table association of public subnet2\n\nresource \"aws_route_table_association\" \"internet_for_pub_sub2\" {\n  route_table_id = aws_route_table.pub_sub1_rt.id\n  subnet_id      = aws_subnet.pub_sub2.id\n}\n\n# Create EIP for NAT GW1\n  resource \"aws_eip\" \"eip_natgw1\" {\n  count = \"1\"\n}\n\n# Create NAT gateway1\n\nresource \"aws_nat_gateway\" \"natgateway_1\" {\n  count         = \"1\"\n  allocation_id = aws_eip.eip_natgw1[count.index].id\n  subnet_id     = aws_subnet.pub_sub1.id\n}\n\n# Create EIP for NAT GW2\n\nresource \"aws_eip\" \"eip_natgw2\" {\n  count = \"1\"\n}\n\n# Create NAT gateway2\n\nresource \"aws_nat_gateway\" \"natgateway_2\" {\n  count         = \"1\"\n  allocation_id = aws_eip.eip_natgw2[count.index].id\n  subnet_id     = aws_subnet.pub_sub2.id\n}\n\n# Create private route table for prv sub1\n\nresource \"aws_route_table\" \"prv_sub1_rt\" {\n  count  = \"1\"\n  vpc_id = aws_vpc.main.id\n  route {\n    cidr_block     = \"0.0.0.0/0\"\n    nat_gateway_id = aws_nat_gateway.natgateway_1[count.index].id\n  }\n  tags = {\n    Project = \"demo-assignment\"\n    Name = \"private subnet1 route table\" \n }\n}\n\n# Create route table association betn prv sub1 & NAT GW1\n\nresource \"aws_route_table_association\" \"pri_sub1_to_natgw1\" {\n  count          = \"1\"\n  route_table_id = aws_route_table.prv_sub1_rt[count.index].id\n  subnet_id      = aws_subnet.prv_sub1.id\n}\n\n# Create private route table for prv sub2\n\nresource \"aws_route_table\" \"prv_sub2_rt\" {\n  count  = \"1\"\n  vpc_id = aws_vpc.main.id\n  route {\n    cidr_block     = \"0.0.0.0/0\"\n    nat_gateway_id = aws_nat_gateway.natgateway_2[count.index].id\n  }\n  tags = {\n    Project = \"demo-assignment\"\n    Name = \"private subnet2 route table\"\n  }\n}\n\n# Create route table association betn prv sub2 & NAT GW2\n\nresource \"aws_route_table_association\" \"pri_sub2_to_natgw1\" {\n  count          = \"1\"\n  route_table_id = aws_route_table.prv_sub2_rt[count.index].id\n  subnet_id      = aws_subnet.prv_sub2.id\n}\n\n\n# Create security group for load balancer\n\nresource \"aws_security_group\" \"elb_sg\" {\n  name        = var.sg_name\n  description = var.sg_description\n  vpc_id      = aws_vpc.main.id\n\ningress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    description = \"HTTP\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\negress {\n    from_port        = 0\n    to_port          = 0\n    protocol         = \"-1\"\n    cidr_blocks      = [\"0.0.0.0/0\"]\n    ipv6_cidr_blocks = [\"::/0\"]\n  }\n \n tags = {\n    Name = var.sg_tagname\n    Project = \"demo-assignment\" \n  }\t\n}\n\n# Create security group for webserver\n\nresource \"aws_security_group\" \"webserver_sg\" {\n  name        = var.sg_ws_name\n  description = var.sg_ws_description\n  vpc_id      = aws_vpc.main.id\n\ningress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    description = \"HTTP\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n\n }\n\ningress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    description = \"HTTP\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\negress {\n    from_port        = 0\n    to_port          = 0\n    protocol         = \"-1\"\n    cidr_blocks      = [\"0.0.0.0/0\"]\n    ipv6_cidr_blocks = [\"::/0\"]\n  }\n\n tags = {\n    Name = var.sg_ws_tagname \n    Project = \"demo-assignment\"\n  }\n}\n\n#Create Launch config\n\nresource \"aws_launch_configuration\" \"webserver-launch-config\" {\n  name_prefix   = \"webserver-launch-config\"\n  image_id      =  var.ami\n  instance_type = \"t2.micro\"\n  key_name\t= var.keyname\n  security_groups = [\"${aws_security_group.webserver_sg.id}\"]\n  \n  root_block_device {\n            volume_type = \"gp2\"\n            volume_size = 10\n            encrypted   = true\n        }\n\n    ebs_block_device {\n            device_name = \"/dev/sdf\"\n            volume_type = \"gp2\"\n            volume_size = 5\n            encrypted   = true\n        }\n       \n\n  lifecycle {\n    create_before_destroy = true\n  }\n  user_data = filebase64(\"${path.module}/init_webserver.sh\")\n}\n\n\n# Create Auto Scaling Group\nresource \"aws_autoscaling_group\" \"Demo-ASG-tf\" {\n  name\t\t     = \"Demo-ASG-tf\"\n  desired_capacity   = 1\n  max_size           = 2\n  min_size           = 1\n  force_delete       = true\n  depends_on \t     = [\"aws_lb.ALB-tf\"]\n  target_group_arns  =  [\"${aws_lb_target_group.TG-tf.arn}\"]\n  health_check_type  = \"EC2\"\n  launch_configuration = aws_launch_configuration.webserver-launch-config.name\n  vpc_zone_identifier = [\"${aws_subnet.prv_sub1.id}\",\"${aws_subnet.prv_sub2.id}\"]\n  \n tag {\n    key                 = \"Name\"\n    value               = \"Demo-ASG-tf\"\n    propagate_at_launch = true\n    }\n} \n\n# Create Target group\n\nresource \"aws_lb_target_group\" \"TG-tf\" {\n  name     = \"Demo-TargetGroup-tf\"\n  depends_on = [\"aws_vpc.main\"]\n  port     = 80\n  protocol = \"HTTP\"\n  vpc_id   = \"${aws_vpc.main.id}\"\n  health_check {\n    interval            = 70\n    path                = \"/index.html\"\n    port                = 80\n    healthy_threshold   = 2\n    unhealthy_threshold = 2\n    timeout             = 60 \n    protocol            = \"HTTP\"\n    matcher             = \"200,202\"\n  }\n}\n\n# Create ALB\n\nresource \"aws_lb\" \"ALB-tf\" {\n   name              = \"Demo-ALG-tf\"\n  internal           = false\n  load_balancer_type = \"application\"\n  security_groups    = [aws_security_group.elb_sg.id]\n  subnets            = [aws_subnet.pub_sub1.id,aws_subnet.pub_sub2.id]\n\n  tags = {\n\tname  = \"Demo-AppLoadBalancer-tf\"\n    \tProject = \"demo-assignment\"\n  }\n}\n\n# Create ALB Listener \n\nresource \"aws_lb_listener\" \"front_end\" {\n  load_balancer_arn = aws_lb.ALB-tf.arn\n  port              = \"80\"\n  protocol          = \"HTTP\"\n  default_action {\n    type             = \"forward\"\n    target_group_arn = aws_lb_target_group.TG-tf.arn\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 184}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 184}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 184}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 213}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 213}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 213}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 213}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 250}, {"tool": "checkov", "rule_id": "CKV_AWS_315", "severity": "HIGH", "message": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 279}, {"tool": "checkov", "rule_id": "CKV_AWS_131", "severity": "HIGH", "message": "Ensure that ALB drops HTTP headers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 320}, {"tool": "checkov", "rule_id": "CKV_AWS_91", "severity": "HIGH", "message": "Ensure the ELBv2 (Application/Network) has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 320}, {"tool": "checkov", "rule_id": "CKV_AWS_150", "severity": "HIGH", "message": "Ensure that Load Balancer has deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 320}, {"tool": "checkov", "rule_id": "CKV_AWS_2", "severity": "HIGH", "message": "Ensure ALB protocol is HTTPS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 335}, {"tool": "checkov", "rule_id": "CKV2_AWS_20", "severity": "CRITICAL", "message": "Ensure that ALB redirects HTTP requests into HTTPS ones", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 320}, {"tool": "checkov", "rule_id": "CKV2_AWS_28", "severity": "CRITICAL", "message": "Ensure public facing ALB are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 320}, {"tool": "checkov", "rule_id": "CKV_AWS_103", "severity": "HIGH", "message": "Ensure that load balancer is using at least TLS 1.2", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 335}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_378", "severity": "HIGH", "message": "Ensure AWS Load Balancer doesn't use HTTP protocol", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 300}, {"tool": "checkov", "rule_id": "CKV2_AWS_19", "severity": "CRITICAL", "message": "Ensure that all EIP addresses allocated to a VPC are attached to EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 109}, {"tool": "checkov", "rule_id": "CKV2_AWS_19", "severity": "CRITICAL", "message": "Ensure that all EIP addresses allocated to a VPC are attached to EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shwetab17__Terraform__main.tf", "start_line": 123}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"local\" {\n    path = \"/etc/.azure/azure.aks.terraform.tfstate\"\n  }\n  required_providers {\n    azurerm = {\n      source = \"hashicorp/azurerm\"\n      version = \"3.61.0\"\n    }\n  }\n}\n\ndata \"template_file\" \"prefix\" {\n  template = file(\"/etc/.azure/prefix\")\n}\n\ndata \"template_file\" \"client_id\" {\n  template = file(\"/etc/.azure/client_id\")\n}\n\ndata \"template_file\" \"tenant_id\" {\n  template = file(\"/etc/.azure/tenant_id\")\n}\n\ndata \"template_file\" \"sub_id\" {\n  template = file(\"/etc/.azure/sub_id\")\n}\n\nprovider \"azurerm\" {\n  features {}\n  client_certificate_path = \"/etc/.azure/mycert.pfx\"\n  subscription_id = \"${trimspace(data.template_file.sub_id.rendered)}\"\n  client_id = \"${trimspace(data.template_file.client_id.rendered)}\"\n  tenant_id = \"${trimspace(data.template_file.tenant_id.rendered)}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sagarhere4u__terraform__azure_aks__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"floating_ip\" {\n  value = openstack_networking_floatingip_v2.fip.address\n}\n\noutput \"volume_devices\" {\n  value = openstack_compute_volume_attach_v2.attached.device\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-provider-openstack__terraform-provider-openstack__examples__attach-format-mount-volume__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.3.0\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \">= 5.77\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"~> 3.0\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/github-aws-runners__terraform-aws-github-runner__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"proxmox_virtual_environment_metrics_server\" \"example\" {\n  name = proxmox_virtual_environment_metrics_server.influxdb_server.name\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bpg__terraform-provider-proxmox__example__data_source_virtual_environment_metrics_server.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">=1.0\"\n  backend \"local\" {}\n  required_providers {\n    google = {\n      source = \"hashicorp/google\"\n    }\n  }\n}\n\nprovider \"google\" {\n  project = var.project\n  region  = var.region\n  zone    = var.zone\n  // credentials = file(var.credentials)  # Use this if you do not want to set env-var GOOGLE_APPLICATION_CREDENTIALS\n}\n\n\nresource \"google_compute_firewall\" \"port_rules\" {\n  project     = var.project\n  name        = \"kafka-broker-port\"\n  network     = var.network\n  description = \"Opens port 9092 in the Kafka VM for Spark cluster to connect\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"9092\"]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]\n  target_tags   = [\"kafka\"]\n\n}\n\nresource \"google_compute_instance\" \"kafka_vm_instance\" {\n  name                      = \"streamify-kafka-instance\"\n  machine_type              = \"e2-standard-4\"\n  tags                      = [\"kafka\"]\n  allow_stopping_for_update = true\n\n  boot_disk {\n    initialize_params {\n      image = var.vm_image\n      size  = 30\n    }\n  }\n\n  network_interface {\n    network = var.network\n    access_config {\n    }\n  }\n}\n\n\nresource \"google_compute_instance\" \"airflow_vm_instance\" {\n  name                      = \"streamify-airflow-instance\"\n  machine_type              = \"e2-standard-4\"\n  allow_stopping_for_update = true\n\n  boot_disk {\n    initialize_params {\n      image = var.vm_image\n      size  = 30\n    }\n  }\n\n  network_interface {\n    network = var.network\n    access_config {\n    }\n  }\n}\n\nresource \"google_storage_bucket\" \"bucket\" {\n  name          = var.bucket\n  location      = var.region\n  force_destroy = true\n\n  uniform_bucket_level_access = true\n\n  lifecycle_rule {\n    action {\n      type = \"Delete\"\n    }\n    condition {\n      age = 30 # days\n    }\n  }\n}\n\n\nresource \"google_dataproc_cluster\" \"mulitnode_spark_cluster\" {\n  name   = \"streamify-multinode-spark-cluster\"\n  region = var.region\n\n  cluster_config {\n\n    staging_bucket = var.bucket\n\n    gce_cluster_config {\n      network = var.network\n      zone    = var.zone\n\n      shielded_instance_config {\n        enable_secure_boot = true\n      }\n    }\n\n    master_config {\n      num_instances = 1\n      machine_type  = \"e2-standard-2\"\n      disk_config {\n        boot_disk_type    = \"pd-ssd\"\n        boot_disk_size_gb = 30\n      }\n    }\n\n    worker_config {\n      num_instances = 2\n      machine_type  = \"e2-medium\"\n      disk_config {\n        boot_disk_size_gb = 30\n      }\n    }\n\n    software_config {\n      image_version = \"2.0-debian10\"\n      override_properties = {\n        \"dataproc:dataproc.allow.zero.workers\" = \"true\"\n      }\n      optional_components = [\"JUPYTER\"]\n    }\n\n  }\n\n}\n\nresource \"google_bigquery_dataset\" \"stg_dataset\" {\n  dataset_id                 = var.stg_bq_dataset\n  project                    = var.project\n  location                   = var.region\n  delete_contents_on_destroy = true\n}\n\nresource \"google_bigquery_dataset\" \"prod_dataset\" {\n  dataset_id                 = var.prod_bq_dataset\n  project                    = var.project\n  location                   = var.region\n  delete_contents_on_destroy = true\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 35}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 35}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 35}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 35}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 56}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 56}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 56}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 56}, {"tool": "checkov", "rule_id": "CKV_GCP_62", "severity": "HIGH", "message": "Bucket should log access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_GCP_78", "severity": "HIGH", "message": "Ensure Cloud storage has versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_GCP_114", "severity": "HIGH", "message": "Ensure public access prevention is enforced on Cloud Storage bucket", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_GCP_91", "severity": "HIGH", "message": "Ensure Dataproc cluster is encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 93}, {"tool": "checkov", "rule_id": "CKV_GCP_103", "severity": "HIGH", "message": "Ensure Dataproc Clusters do not have public IPs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 93}, {"tool": "checkov", "rule_id": "CKV_GCP_81", "severity": "HIGH", "message": "Ensure Big Query Datasets are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 139}, {"tool": "checkov", "rule_id": "CKV_GCP_81", "severity": "HIGH", "message": "Ensure Big Query Datasets are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__main.tf", "start_line": 146}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_partition\" \"current\" {\n  count = local.create ? 1 : 0\n}\ndata \"aws_caller_identity\" \"current\" {\n  count = local.create ? 1 : 0\n}\n\ndata \"aws_iam_session_context\" \"current\" {\n  count = local.create ? 1 : 0\n\n  # This data source provides information on the IAM source role of an STS assumed role\n  # For non-role ARNs, this data source simply passes the ARN through issuer ARN\n  # Ref https://github.com/terraform-aws-modules/terraform-aws-eks/issues/2327#issuecomment-1355581682\n  # Ref https://github.com/hashicorp/terraform-provider-aws/issues/28381\n  arn = try(data.aws_caller_identity.current[0].arn, \"\")\n}\n\nlocals {\n  create = var.create && var.putin_khuylo\n\n  account_id = try(data.aws_caller_identity.current[0].account_id, \"\")\n  partition  = try(data.aws_partition.current[0].partition, \"\")\n\n  role_arn = try(aws_iam_role.this[0].arn, var.iam_role_arn)\n\n  create_outposts_local_cluster = var.outpost_config != null\n  enable_encryption_config      = var.encryption_config != null && !local.create_outposts_local_cluster\n\n  create_auto_mode_iam_resources = try(var.compute_config.enabled, false) == true || var.create_auto_mode_iam_resources\n}\n\n################################################################################\n# Cluster\n################################################################################\n\nresource \"aws_eks_cluster\" \"this\" {\n  count = local.create ? 1 : 0\n\n  region = var.region\n\n  name                          = var.name\n  role_arn                      = local.role_arn\n  version                       = var.kubernetes_version\n  enabled_cluster_log_types     = var.enabled_log_types\n  deletion_protection           = var.deletion_protection\n  bootstrap_self_managed_addons = false\n  force_update_version          = var.force_update_version\n\n  access_config {\n    authentication_mode = var.authentication_mode\n\n    # See access entries below - this is a one time operation from the EKS API.\n    # Instead, we are hardcoding this to false and if users wish to achieve this\n    # same functionality, we will do that through an access entry which can be\n    # enabled or disabled at any time of their choosing using the variable\n    # var.enable_cluster_creator_admin_permissions\n    bootstrap_cluster_creator_admin_permissions = false\n  }\n\n  dynamic \"control_plane_scaling_config\" {\n    for_each = var.control_plane_scaling_config != null ? [var.control_plane_scaling_config] : []\n\n    content {\n      tier = control_plane_scaling_config.value.tier\n    }\n  }\n\n  dynamic \"compute_config\" {\n    for_each = var.compute_config != null ? [var.compute_config] : []\n\n    content {\n      enabled       = compute_config.value.enabled\n      node_pools    = compute_config.value.node_pools\n      node_role_arn = compute_config.value.node_pools != null ? try(aws_iam_role.eks_auto[0].arn, compute_config.value.node_role_arn) : null\n    }\n  }\n\n  vpc_config {\n    security_group_ids      = compact(distinct(concat(var.additional_security_group_ids, [local.security_group_id])))\n    subnet_ids              = coalescelist(var.control_plane_subnet_ids, var.subnet_ids)\n    endpoint_private_access = var.endpoint_private_access\n    endpoint_public_access  = var.endpoint_public_access\n    public_access_cidrs     = var.endpoint_public_access_cidrs\n  }\n\n  dynamic \"kubernetes_network_config\" {\n    # Not valid on Outposts\n    for_each = local.create_outposts_local_cluster ? [] : [1]\n\n    content {\n      dynamic \"elastic_load_balancing\" {\n        for_each = var.compute_config != null ? [var.compute_config] : []\n\n        content {\n          enabled = elastic_load_balancing.value.enabled\n        }\n      }\n\n      ip_family         = var.ip_family\n      service_ipv4_cidr = var.service_ipv4_cidr\n      service_ipv6_cidr = var.service_ipv6_cidr\n    }\n  }\n\n  dynamic \"outpost_config\" {\n    for_each = local.create_outposts_local_cluster ? [var.outpost_config] : []\n\n    content {\n      control_plane_instance_type = outpost_config.value.control_plane_instance_type\n\n      dynamic \"control_plane_placement\" {\n        for_each = outpost_config.value.control_plane_placement != null ? [outpost_config.value.control_plane_placement] : []\n\n        content {\n          group_name = control_plane_placement.value.group_name\n        }\n      }\n\n      outpost_arns = outpost_config.value.outpost_arns\n    }\n  }\n\n  dynamic \"encryption_config\" {\n    # Not available on Outposts\n    for_each = local.enable_encryption_config ? [var.encryption_config] : []\n\n    content {\n      provider {\n        key_arn = var.create_kms_key ? module.kms.key_arn : encryption_config.value.provider_key_arn\n      }\n      resources = encryption_config.value.resources\n    }\n  }\n\n  dynamic \"remote_network_config\" {\n    # Not valid on Outposts\n    for_each = var.remote_network_config != null && !local.create_outposts_local_cluster ? [var.remote_network_config] : []\n\n    content {\n      dynamic \"remote_node_networks\" {\n        for_each = [remote_network_config.value.remote_node_networks]\n\n        content {\n          cidrs = remote_node_networks.value.cidrs\n        }\n      }\n\n      dynamic \"remote_pod_networks\" {\n        for_each = remote_network_config.value.remote_pod_networks != null ? [remote_network_config.value.remote_pod_networks] : []\n\n        content {\n          cidrs = remote_pod_networks.value.cidrs\n        }\n      }\n    }\n  }\n\n  dynamic \"storage_config\" {\n    for_each = var.compute_config != null ? [var.compute_config] : []\n\n    content {\n      block_storage {\n        enabled = storage_config.value.enabled\n      }\n    }\n  }\n\n  dynamic \"upgrade_policy\" {\n    for_each = var.upgrade_policy != null ? [var.upgrade_policy] : []\n\n    content {\n      support_type = upgrade_policy.value.support_type\n    }\n  }\n\n  dynamic \"zonal_shift_config\" {\n    for_each = var.zonal_shift_config != null ? [var.zonal_shift_config] : []\n\n    content {\n      enabled = zonal_shift_config.value.enabled\n    }\n  }\n\n  tags = merge(\n    { terraform-aws-modules = \"eks\" },\n    var.tags,\n    var.cluster_tags,\n  )\n\n  dynamic \"timeouts\" {\n    for_each = var.timeouts != null ? [var.timeouts] : []\n\n    content {\n      create = var.timeouts.create\n      update = var.timeouts.update\n      delete = var.timeouts.delete\n    }\n  }\n\n  depends_on = [\n    aws_iam_role_policy_attachment.this,\n    aws_security_group_rule.cluster,\n    aws_security_group_rule.node,\n    aws_cloudwatch_log_group.this,\n    aws_iam_policy.cni_ipv6_policy,\n  ]\n\n  lifecycle {\n    ignore_changes = [\n      access_config[0].bootstrap_cluster_creator_admin_permissions,\n      bootstrap_self_managed_addons,\n    ]\n  }\n}\n\nresource \"aws_ec2_tag\" \"cluster_primary_security_group\" {\n  # This should not affect the name of the cluster primary security group\n  # Ref: https://github.com/terraform-aws-modules/terraform-aws-eks/pull/2006\n  # Ref: https://github.com/terraform-aws-modules/terraform-aws-eks/pull/2008\n  for_each = { for k, v in merge(var.tags, var.cluster_tags) :\n    k => v if local.create && k != \"Name\" && var.create_primary_security_group_tags\n  }\n\n  region = var.region\n\n  resource_id = aws_eks_cluster.this[0].vpc_config[0].cluster_security_group_id\n  key         = each.key\n  value       = each.value\n}\n\nresource \"aws_cloudwatch_log_group\" \"this\" {\n  count = local.create && var.create_cloudwatch_log_group ? 1 : 0\n\n  region = var.region\n\n  name              = \"/aws/eks/${var.name}/cluster\"\n  retention_in_days = var.cloudwatch_log_group_retention_in_days\n  kms_key_id        = var.cloudwatch_log_group_kms_key_id\n  log_group_class   = var.cloudwatch_log_group_class\n\n  tags = merge(\n    var.tags,\n    var.cloudwatch_log_group_tags,\n    { Name = \"/aws/eks/${var.name}/cluster\" }\n  )\n}\n\n################################################################################\n# Access Entry\n################################################################################\n\nlocals {\n  # This replaces the one time logic from the EKS API with something that can be\n  # better controlled by users through Terraform\n  bootstrap_cluster_creator_admin_permissions = { for k, v in {\n    cluster_creator = {\n      principal_arn = try(data.aws_iam_session_context.current[0].issuer_arn, \"\")\n      type          = \"STANDARD\"\n\n      policy_associations = {\n        admin = {\n          policy_arn = \"arn:${local.partition}:eks::aws:cluster-access-policy/AmazonEKSClusterAdminPolicy\"\n          access_scope = {\n            type = \"cluster\"\n          }\n        }\n      }\n    }\n  } : k => v if var.enable_cluster_creator_admin_permissions }\n\n  # Merge the bootstrap behavior with the entries that users provide\n  merged_access_entries = merge(\n    local.bootstrap_cluster_creator_admin_permissions,\n    var.access_entries,\n  )\n\n  # Flatten out entries and policy associations so users can specify the policy\n  # associations within a single entry\n  flattened_access_entries = flatten([\n    for entry_key, entry_val in local.merged_access_entries : [\n      for pol_key, pol_val in entry_val.policy_associations :\n      merge(\n        {\n          principal_arn = entry_val.principal_arn\n          entry_key     = entry_key\n          pol_key       = pol_key\n        },\n        { for k, v in {\n          association_policy_arn              = pol_val.policy_arn\n          association_access_scope_type       = pol_val.access_scope.type\n          association_access_scope_namespaces = try(pol_val.access_scope.namespaces, null)\n        } : k => v if !contains([\"EC2_LINUX\", \"EC2_WINDOWS\", \"FARGATE_LINUX\", \"HYBRID_LINUX\"], lookup(entry_val, \"type\", \"STANDARD\")) },\n      )\n    ]\n  ])\n}\n\nresource \"aws_eks_access_entry\" \"this\" {\n  for_each = { for k, v in local.merged_access_entries : k => v if local.create }\n\n  region = var.region\n\n  cluster_name      = aws_eks_cluster.this[0].id\n  kubernetes_groups = try(each.value.kubernetes_groups, null)\n  principal_arn     = each.value.principal_arn\n  type              = try(each.value.type, null)\n  user_name         = try(each.value.user_name, null)\n\n  tags = merge(\n    var.tags,\n    try(each.value.tags, {}),\n  )\n}\n\nresource \"aws_eks_access_policy_association\" \"this\" {\n  for_each = { for k, v in local.flattened_access_entries : \"${v.entry_key}_${v.pol_key}\" => v if local.create }\n\n  region = var.region\n\n  access_scope {\n    namespaces = each.value.association_access_scope_namespaces\n    type       = each.value.association_access_scope_type\n  }\n\n  cluster_name = aws_eks_cluster.this[0].id\n\n  policy_arn    = each.value.association_policy_arn\n  principal_arn = each.value.principal_arn\n\n  depends_on = [\n    aws_eks_access_entry.this,\n  ]\n}\n\n################################################################################\n# KMS Key\n################################################################################\n\nmodule \"kms\" {\n  source  = \"terraform-aws-modules/kms/aws\"\n  version = \"4.0.0\" # Note - be mindful of Terraform/provider version compatibility between modules\n\n  create = local.create && var.create_kms_key && local.enable_encryption_config # not valid on Outposts\n\n  region = var.region\n\n  description             = coalesce(var.kms_key_description, \"${var.name} cluster encryption key\")\n  key_usage               = \"ENCRYPT_DECRYPT\"\n  deletion_window_in_days = var.kms_key_deletion_window_in_days\n  enable_key_rotation     = var.enable_kms_key_rotation\n  rotation_period_in_days = var.kms_key_rotation_period_in_days\n\n  # Policy\n  enable_default_policy     = var.kms_key_enable_default_policy\n  key_owners                = var.kms_key_owners\n  key_administrators        = coalescelist(var.kms_key_administrators, [try(data.aws_iam_session_context.current[0].issuer_arn, \"\")])\n  key_users                 = concat([local.role_arn], var.kms_key_users)\n  key_service_users         = var.kms_key_service_users\n  source_policy_documents   = var.kms_key_source_policy_documents\n  override_policy_documents = var.kms_key_override_policy_documents\n\n  # Aliases\n  aliases = var.kms_key_aliases\n  computed_aliases = {\n    # Computed since users can pass in computed values for cluster name such as random provider resources\n    cluster = { name = \"eks/${var.name}\" }\n  }\n\n  tags = merge(\n    { terraform-aws-modules = \"eks\" },\n    var.tags,\n  )\n}\n\n################################################################################\n# Cluster Security Group\n# Defaults follow https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html\n################################################################################\n\nlocals {\n  security_group_name   = coalesce(var.security_group_name, \"${var.name}-cluster\")\n  create_security_group = local.create && var.create_security_group\n\n  security_group_id = local.create_security_group ? aws_security_group.cluster[0].id : var.security_group_id\n\n  # Do not add rules to node security group if the module is not creating it\n  cluster_security_group_rules = { for k, v in {\n    ingress_nodes_443 = {\n      description                = \"Node groups to cluster API\"\n      protocol                   = \"tcp\"\n      from_port                  = 443\n      to_port                    = 443\n      type                       = \"ingress\"\n      source_node_security_group = true\n    }\n  } : k => v if local.create_node_sg }\n}\n\nresource \"aws_security_group\" \"cluster\" {\n  count = local.create_security_group ? 1 : 0\n\n  region = var.region\n\n  name        = var.security_group_use_name_prefix ? null : local.security_group_name\n  name_prefix = var.security_group_use_name_prefix ? \"${local.security_group_name}${var.prefix_separator}\" : null\n  description = var.security_group_description\n  vpc_id      = var.vpc_id\n\n  tags = merge(\n    var.tags,\n    { \"Name\" = local.security_group_name },\n    var.security_group_tags\n  )\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n\nresource \"aws_security_group_rule\" \"cluster\" {\n  for_each = { for k, v in merge(\n    local.cluster_security_group_rules,\n    var.security_group_additional_rules\n  ) : k => v if local.create_security_group }\n\n  region = var.region\n\n  security_group_id        = aws_security_group.cluster[0].id\n  protocol                 = each.value.protocol\n  from_port                = each.value.from_port\n  to_port                  = each.value.to_port\n  type                     = each.value.type\n  description              = try(each.value.description, null)\n  cidr_blocks              = try(each.value.cidr_blocks, null)\n  ipv6_cidr_blocks         = try(each.value.ipv6_cidr_blocks, null)\n  prefix_list_ids          = try(each.value.prefix_list_ids, null)\n  self                     = try(each.value.self, null)\n  source_security_group_id = try(each.value.source_node_security_group, false) ? local.node_security_group_id : try(each.value.source_security_group_id, null)\n}\n\n################################################################################\n# IRSA\n# Note - this is different from EKS identity provider\n################################################################################\n\nlocals {\n  # Not available on outposts\n  create_oidc_provider = local.create && var.enable_irsa && !local.create_outposts_local_cluster\n\n  oidc_root_ca_thumbprint = local.create_oidc_provider && var.include_oidc_root_ca_thumbprint ? [data.tls_certificate.this[0].certificates[0].sha1_fingerprint] : []\n}\n\ndata \"tls_certificate\" \"this\" {\n  # Not available on outposts\n  count = local.create_oidc_provider && var.include_oidc_root_ca_thumbprint ? 1 : 0\n\n  url = aws_eks_cluster.this[0].identity[0].oidc[0].issuer\n}\n\nresource \"aws_iam_openid_connect_provider\" \"oidc_provider\" {\n  # Not available on outposts\n  count = local.create_oidc_provider ? 1 : 0\n\n  client_id_list  = distinct(compact(concat([\"sts.amazonaws.com\"], var.openid_connect_audiences)))\n  thumbprint_list = concat(local.oidc_root_ca_thumbprint, var.custom_oidc_thumbprints)\n  url             = aws_eks_cluster.this[0].identity[0].oidc[0].issuer\n\n  tags = merge(\n    { Name = \"${var.name}-eks-irsa\" },\n    var.tags\n  )\n}\n\n################################################################################\n# IAM Role\n################################################################################\n\nlocals {\n  create_iam_role        = local.create && var.create_iam_role\n  iam_role_name          = coalesce(var.iam_role_name, \"${var.name}-cluster\")\n  iam_role_policy_prefix = \"arn:${local.partition}:iam::aws:policy\"\n\n  cluster_encryption_policy_name = coalesce(var.encryption_policy_name, \"${local.iam_role_name}-ClusterEncryption\")\n\n  # Standard EKS cluster\n  eks_standard_iam_role_policies = { for k, v in {\n    AmazonEKSClusterPolicy = \"${local.iam_role_policy_prefix}/AmazonEKSClusterPolicy\",\n  } : k => v if !local.create_outposts_local_cluster && !local.create_auto_mode_iam_resources }\n\n  # EKS cluster with EKS auto mode enabled\n  eks_auto_mode_iam_role_policies = { for k, v in {\n    AmazonEKSClusterPolicy       = \"${local.iam_role_policy_prefix}/AmazonEKSClusterPolicy\"\n    AmazonEKSComputePolicy       = \"${local.iam_role_policy_prefix}/AmazonEKSComputePolicy\"\n    AmazonEKSBlockStoragePolicy  = \"${local.iam_role_policy_prefix}/AmazonEKSBlockStoragePolicy\"\n    AmazonEKSLoadBalancingPolicy = \"${local.iam_role_policy_prefix}/AmazonEKSLoadBalancingPolicy\"\n    AmazonEKSNetworkingPolicy    = \"${local.iam_role_policy_prefix}/AmazonEKSNetworkingPolicy\"\n  } : k => v if !local.create_outposts_local_cluster && local.create_auto_mode_iam_resources }\n\n  # EKS local cluster on Outposts\n  eks_outpost_iam_role_policies = { for k, v in {\n    AmazonEKSClusterPolicy = \"${local.iam_role_policy_prefix}/AmazonEKSLocalOutpostClusterPolicy\"\n  } : k => v if local.create_outposts_local_cluster && !local.create_auto_mode_iam_resources }\n}\n\ndata \"aws_iam_policy_document\" \"assume_role_policy\" {\n  count = local.create && var.create_iam_role ? 1 : 0\n\n  statement {\n    sid = \"EKSClusterAssumeRole\"\n    actions = [\n      \"sts:AssumeRole\",\n      \"sts:TagSession\",\n    ]\n\n    principals {\n      type        = \"Service\"\n      identifiers = [\"eks.amazonaws.com\"]\n    }\n\n    dynamic \"principals\" {\n      for_each = local.create_outposts_local_cluster ? [1] : []\n\n      content {\n        type        = \"Service\"\n        identifiers = [\"ec2.amazonaws.com\"]\n      }\n    }\n  }\n}\n\nresource \"aws_iam_role\" \"this\" {\n  count = local.create_iam_role ? 1 : 0\n\n  name        = var.iam_role_use_name_prefix ? null : local.iam_role_name\n  name_prefix = var.iam_role_use_name_prefix ? \"${local.iam_role_name}${var.prefix_separator}\" : null\n  path        = var.iam_role_path\n  description = var.iam_role_description\n\n  assume_role_policy    = data.aws_iam_policy_document.assume_role_policy[0].json\n  permissions_boundary  = var.iam_role_permissions_boundary\n  force_detach_policies = true\n\n  tags = merge(var.tags, var.iam_role_tags)\n}\n\n# Policies attached ref https://docs.aws.amazon.com/eks/latest/userguide/service_IAM_role.html\nresource \"aws_iam_role_policy_attachment\" \"this\" {\n  for_each = { for k, v in merge(\n    local.eks_standard_iam_role_policies,\n    local.eks_auto_mode_iam_role_policies,\n    local.eks_outpost_iam_role_policies,\n  ) : k => v if local.create_iam_role }\n\n  policy_arn = each.value\n  role       = aws_iam_role.this[0].name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"additional\" {\n  for_each = { for k, v in var.iam_role_additional_policies : k => v if local.create_iam_role }\n\n  policy_arn = each.value\n  role       = aws_iam_role.this[0].name\n}\n\n# Using separate attachment due to `The \"for_each\" value depends on resource attributes that cannot be determined until apply`\nresource \"aws_iam_role_policy_attachment\" \"cluster_encryption\" {\n  # Encryption config not available on Outposts\n  count = local.create_iam_role && var.attach_encryption_policy && local.enable_encryption_config ? 1 : 0\n\n  policy_arn = aws_iam_policy.cluster_encryption[0].arn\n  role       = aws_iam_role.this[0].name\n}\n\nresource \"aws_iam_policy\" \"cluster_encryption\" {\n  # Encryption config not available on Outposts\n  count = local.create_iam_role && var.attach_encryption_policy && local.enable_encryption_config ? 1 : 0\n\n  name        = var.encryption_policy_use_name_prefix ? null : local.cluster_encryption_policy_name\n  name_prefix = var.encryption_policy_use_name_prefix ? local.cluster_encryption_policy_name : null\n  description = var.encryption_policy_description\n  path        = var.encryption_policy_path\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = [\n          \"kms:Encrypt\",\n          \"kms:Decrypt\",\n          \"kms:ListGrants\",\n          \"kms:DescribeKey\",\n        ]\n        Effect   = \"Allow\"\n        Resource = var.create_kms_key ? module.kms.key_arn : var.encryption_config.provider_key_arn\n      },\n    ]\n  })\n\n  tags = merge(var.tags, var.encryption_policy_tags)\n}\n\ndata \"aws_iam_policy_document\" \"custom\" {\n  count = local.create_iam_role && local.create_auto_mode_iam_resources && var.enable_auto_mode_custom_tags ? 1 : 0\n\n  dynamic \"statement\" {\n    for_each = var.enable_auto_mode_custom_tags ? [1] : []\n\n    content {\n      sid = \"Compute\"\n      actions = [\n        \"ec2:CreateFleet\",\n        \"ec2:RunInstances\",\n        \"ec2:CreateLaunchTemplate\",\n      ]\n      resources = [\"*\"]\n\n      condition {\n        test     = \"StringEquals\"\n        variable = \"aws:RequestTag/eks:eks-cluster-name\"\n        values   = [\"$${aws:PrincipalTag/eks:eks-cluster-name}\"]\n      }\n\n      condition {\n        test     = \"StringLike\"\n        variable = \"aws:RequestTag/eks:kubernetes-node-class-name\"\n        values   = [\"*\"]\n      }\n\n      condition {\n        test     = \"StringLike\"\n        variable = \"aws:RequestTag/eks:kubernetes-node-pool-name\"\n        values   = [\"*\"]\n      }\n    }\n  }\n\n  dynamic \"statement\" {\n    for_each = var.enable_auto_mode_custom_tags ? [1] : []\n\n    content {\n      sid = \"Storage\"\n      actions = [\n        \"ec2:CreateVolume\",\n        \"ec2:CreateSnapshot\",\n      ]\n      resources = [\n        \"arn:${local.partition}:ec2:*:*:volume/*\",\n        \"arn:${local.partition}:ec2:*:*:snapshot/*\",\n      ]\n\n      condition {\n        test     = \"StringEquals\"\n        variable = \"aws:RequestTag/eks:eks-cluster-name\"\n        values   = [\"$${aws:PrincipalTag/eks:eks-cluster-name}\"]\n      }\n    }\n  }\n\n  dynamic \"statement\" {\n    for_each = var.enable_auto_mode_custom_tags ? [1] : []\n\n    content {\n      sid       = \"Networking\"\n      actions   = [\"ec2:CreateNetworkInterface\"]\n      resources = [\"*\"]\n\n      condition {\n        test     = \"StringEquals\"\n        variable = \"aws:RequestTag/eks:eks-cluster-name\"\n        values   = [\"$${aws:PrincipalTag/eks:eks-cluster-name}\"]\n      }\n\n      condition {\n        test     = \"StringEquals\"\n        variable = \"aws:RequestTag/eks:kubernetes-cni-node-name\"\n        values   = [\"*\"]\n      }\n    }\n  }\n\n  dynamic \"statement\" {\n    for_each = var.enable_auto_mode_custom_tags ? [1] : []\n\n    content {\n      sid = \"LoadBalancer\"\n      actions = [\n        \"elasticloadbalancing:CreateLoadBalancer\",\n        \"elasticloadbalancing:CreateTargetGroup\",\n        \"elasticloadbalancing:CreateListener\",\n        \"elasticloadbalancing:CreateRule\",\n        \"ec2:CreateSecurityGroup\",\n      ]\n      resources = [\"*\"]\n\n      condition {\n        test     = \"StringEquals\"\n        variable = \"aws:RequestTag/eks:eks-cluster-name\"\n        values   = [\"$${aws:PrincipalTag/eks:eks-cluster-name}\"]\n      }\n    }\n  }\n\n  dynamic \"statement\" {\n    for_each = var.enable_auto_mode_custom_tags ? [1] : []\n\n    content {\n      sid       = \"ShieldProtection\"\n      actions   = [\"shield:CreateProtection\"]\n      resources = [\"*\"]\n\n      condition {\n        test     = \"StringEquals\"\n        variable = \"aws:RequestTag/eks:eks-cluster-name\"\n        values   = [\"$${aws:PrincipalTag/eks:eks-cluster-name}\"]\n      }\n    }\n  }\n\n  dynamic \"statement\" {\n    for_each = var.enable_auto_mode_custom_tags ? [1] : []\n\n    content {\n      sid       = \"ShieldTagResource\"\n      actions   = [\"shield:TagResource\"]\n      resources = [\"arn:${local.partition}:shield::*:protection/*\"]\n\n      condition {\n        test     = \"StringEquals\"\n        variable = \"aws:RequestTag/eks:eks-cluster-name\"\n        values   = [\"$${aws:PrincipalTag/eks:eks-cluster-name}\"]\n      }\n    }\n  }\n}\n\nresource \"aws_iam_policy\" \"custom\" {\n  count = local.create_iam_role && local.create_auto_mode_iam_resources && var.enable_auto_mode_custom_tags ? 1 : 0\n\n  name        = var.iam_role_use_name_prefix ? null : local.iam_role_name\n  name_prefix = var.iam_role_use_name_prefix ? \"${local.iam_role_name}-\" : null\n  path        = var.iam_role_path\n  description = var.iam_role_description\n\n  policy = data.aws_iam_policy_document.custom[0].json\n\n  tags = merge(var.tags, var.iam_role_tags)\n}\n\nresource \"aws_iam_role_policy_attachment\" \"custom\" {\n  count = local.create_iam_role && local.create_auto_mode_iam_resources && var.enable_auto_mode_custom_tags ? 1 : 0\n\n  policy_arn = aws_iam_policy.custom[0].arn\n  role       = aws_iam_role.this[0].name\n}\n\n################################################################################\n# EKS Addons\n################################################################################\n\ndata \"aws_eks_addon_version\" \"this\" {\n  for_each = var.addons != null && local.create && !local.create_outposts_local_cluster ? var.addons : {}\n\n  region = var.region\n\n  addon_name         = coalesce(each.value.name, each.key)\n  kubernetes_version = coalesce(var.kubernetes_version, aws_eks_cluster.this[0].version)\n  most_recent        = each.value.most_recent\n}\n\nresource \"aws_eks_addon\" \"this\" {\n  # Not supported on outposts\n  for_each = var.addons != null && local.create && !local.create_outposts_local_cluster ? { for k, v in var.addons : k => v if !v.before_compute } : {}\n\n  region = var.region\n\n  cluster_name = aws_eks_cluster.this[0].id\n  addon_name   = coalesce(each.value.name, each.key)\n\n  addon_version        = coalesce(each.value.addon_version, data.aws_eks_addon_version.this[each.key].version)\n  configuration_values = each.value.configuration_values\n\n  dynamic \"pod_identity_association\" {\n    for_each = each.value.pod_identity_association != null ? each.value.pod_identity_association : []\n\n    content {\n      role_arn        = pod_identity_association.value.role_arn\n      service_account = pod_identity_association.value.service_account\n    }\n  }\n\n  preserve                    = each.value.preserve\n  resolve_conflicts_on_create = each.value.resolve_conflicts_on_create\n  resolve_conflicts_on_update = each.value.resolve_conflicts_on_update\n  service_account_role_arn    = each.value.service_account_role_arn\n\n  timeouts {\n    create = each.value.timeouts.create != null ? each.value.timeouts.create : var.addons_timeouts.create\n    update = each.value.timeouts.update != null ? each.value.timeouts.update : var.addons_timeouts.update\n    delete = each.value.timeouts.delete != null ? each.value.timeouts.delete : var.addons_timeouts.delete\n  }\n\n  tags = merge(\n    var.tags,\n    each.value.tags,\n  )\n\n  # before_compute = false\n  depends_on = [\n    module.fargate_profile,\n    module.eks_managed_node_group,\n    module.self_managed_node_group,\n  ]\n}\n\nresource \"aws_eks_addon\" \"before_compute\" {\n  # Not supported on outposts\n  for_each = var.addons != null && local.create && !local.create_outposts_local_cluster ? { for k, v in var.addons : k => v if v.before_compute } : {}\n\n  region = var.region\n\n  cluster_name = aws_eks_cluster.this[0].id\n  addon_name   = coalesce(each.value.name, each.key)\n\n  addon_version        = coalesce(each.value.addon_version, data.aws_eks_addon_version.this[each.key].version)\n  configuration_values = each.value.configuration_values\n\n  dynamic \"pod_identity_association\" {\n    for_each = each.value.pod_identity_association != null ? each.value.pod_identity_association : []\n\n    content {\n      role_arn        = pod_identity_association.value.role_arn\n      service_account = pod_identity_association.value.service_account\n    }\n  }\n\n  preserve                    = each.value.preserve\n  resolve_conflicts_on_create = each.value.resolve_conflicts_on_create\n  resolve_conflicts_on_update = each.value.resolve_conflicts_on_update\n  service_account_role_arn    = each.value.service_account_role_arn\n\n  timeouts {\n    create = each.value.timeouts.create != null ? each.value.timeouts.create : var.addons_timeouts.create\n    update = each.value.timeouts.update != null ? each.value.timeouts.update : var.addons_timeouts.update\n    delete = each.value.timeouts.delete != null ? each.value.timeouts.delete : var.addons_timeouts.delete\n  }\n\n  tags = merge(\n    var.tags,\n    each.value.tags,\n  )\n}\n\n################################################################################\n# EKS Identity Provider\n# Note - this is different from IRSA\n################################################################################\n\nresource \"aws_eks_identity_provider_config\" \"this\" {\n  for_each = var.identity_providers != null && local.create && !local.create_outposts_local_cluster ? var.identity_providers : {}\n\n  region = var.region\n\n  cluster_name = aws_eks_cluster.this[0].id\n\n  oidc {\n    client_id                     = each.value.client_id\n    groups_claim                  = each.value.groups_claim\n    groups_prefix                 = each.value.groups_prefix\n    identity_provider_config_name = coalesce(each.value.identity_provider_config_name, each.key)\n    issuer_url                    = each.value.issuer_url\n    required_claims               = each.value.required_claims\n    username_claim                = each.value.username_claim\n    username_prefix               = each.value.username_prefix\n  }\n\n  tags = merge(\n    var.tags,\n    each.value.tags,\n  )\n}\n\n################################################################################\n# EKS Auto Node IAM Role\n################################################################################\n\nlocals {\n  create_node_iam_role = local.create && var.create_node_iam_role && local.create_auto_mode_iam_resources\n  node_iam_role_name   = coalesce(var.node_iam_role_name, \"${var.name}-eks-auto\")\n}\n\ndata \"aws_iam_policy_document\" \"node_assume_role_policy\" {\n  count = local.create_node_iam_role ? 1 : 0\n\n  statement {\n    sid = \"EKSAutoNodeAssumeRole\"\n    actions = [\n      \"sts:AssumeRole\",\n      \"sts:TagSession\",\n    ]\n\n    principals {\n      type        = \"Service\"\n      identifiers = [\"ec2.amazonaws.com\"]\n    }\n  }\n}\n\nresource \"aws_iam_role\" \"eks_auto\" {\n  count = local.create_node_iam_role ? 1 : 0\n\n  name        = var.node_iam_role_use_name_prefix ? null : local.node_iam_role_name\n  name_prefix = var.node_iam_role_use_name_prefix ? \"${local.node_iam_role_name}-\" : null\n  path        = var.node_iam_role_path\n  description = var.node_iam_role_description\n\n  assume_role_policy    = data.aws_iam_policy_document.node_assume_role_policy[0].json\n  permissions_boundary  = var.node_iam_role_permissions_boundary\n  force_detach_policies = true\n\n  tags = merge(var.tags, var.node_iam_role_tags)\n}\n\n# Policies attached ref https://docs.aws.amazon.com/eks/latest/userguide/service_IAM_role.html\nresource \"aws_iam_role_policy_attachment\" \"eks_auto\" {\n  for_each = { for k, v in {\n    AmazonEKSWorkerNodeMinimalPolicy   = \"${local.iam_role_policy_prefix}/AmazonEKSWorkerNodeMinimalPolicy\",\n    AmazonEC2ContainerRegistryPullOnly = \"${local.iam_role_policy_prefix}/AmazonEC2ContainerRegistryPullOnly\",\n  } : k => v if local.create_node_iam_role }\n\n  policy_arn = each.value\n  role       = aws_iam_role.eks_auto[0].name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"eks_auto_additional\" {\n  for_each = { for k, v in var.node_iam_role_additional_policies : k => v if local.create_node_iam_role }\n\n  policy_arn = each.value\n  role       = aws_iam_role.eks_auto[0].name\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-eks__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_37", "severity": "HIGH", "message": "Ensure Amazon EKS control plane logging is enabled for all log types", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-eks__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-eks__main.tf", "start_line": 339}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_2__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#############################################################################\n# Terraform module which creates Session Manager resources on AWS.\n#############################################################################\n# https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html\n\n######################################\n# SSM Document\n######################################\n# https://docs.aws.amazon.com/systems-manager/latest/userguide/getting-started-configure-preferences-cli.html\n\n# https://www.terraform.io/docs/providers/aws/r/ssm_document.html\nresource \"aws_ssm_document\" \"default\" {\n  name            = var.ssm_document_name\n  document_type   = \"Session\"\n  document_format = \"JSON\"\n  tags            = merge({ \"Name\" = var.ssm_document_name }, var.tags)\n\n  content = jsonencode({\n    schemaVersion = \"1.0\"\n    description   = \"Document to hold regional settings for Session Manager\"\n    sessionType   = \"Standard_Stream\"\n    inputs = {\n      s3BucketName                = var.s3_bucket_name\n      s3KeyPrefix                 = var.s3_key_prefix\n      s3EncryptionEnabled         = var.s3_encryption_enabled\n      cloudWatchLogGroupName      = var.cloudwatch_log_group_name\n      cloudWatchEncryptionEnabled = var.cloudwatch_encryption_enabled\n    }\n  })\n}\n\n######################################\n# Session Manager IAM Instance Profile\n######################################\n# https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-getting-started-instance-profile.html\n\n# https://www.terraform.io/docs/providers/aws/r/iam_instance_profile.html\nresource \"aws_iam_instance_profile\" \"default\" {\n  name = \"ssm-service-role\"\n  role = aws_iam_role.default.name\n  path = var.iam_path\n}\n\n# https://www.terraform.io/docs/providers/aws/r/iam_role.html\nresource \"aws_iam_role\" \"default\" {\n  name               = local.iam_name\n  assume_role_policy = data.aws_iam_policy_document.assume_role_policy.json\n  path               = var.iam_path\n  description        = var.description\n  tags               = merge({ \"Name\" = local.iam_name }, var.tags)\n}\n\ndata \"aws_iam_policy_document\" \"assume_role_policy\" {\n  statement {\n    actions = [\"sts:AssumeRole\"]\n\n    principals {\n      type        = \"Service\"\n      identifiers = [\"ec2.amazonaws.com\"]\n    }\n  }\n}\n\n# https://www.terraform.io/docs/providers/aws/r/iam_policy.html\nresource \"aws_iam_policy\" \"default\" {\n  name        = local.iam_name\n  policy      = local.iam_policy\n  path        = var.iam_path\n  description = var.description\n}\n\n# https://www.terraform.io/docs/providers/aws/r/iam_role_policy_attachment.html\nresource \"aws_iam_role_policy_attachment\" \"default\" {\n  role       = aws_iam_role.default.name\n  policy_arn = aws_iam_policy.default.arn\n}\n\nlocals {\n  iam_name   = \"${var.name}-session-manager\"\n  iam_policy = var.iam_policy == \"\" ? data.aws_iam_policy.default.policy : var.iam_policy\n}\n\ndata \"aws_iam_policy\" \"default\" {\n  arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2RoleforSSM\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Jakeasaurus__terraform__session_manager__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_112", "severity": "HIGH", "message": "Ensure Session Manager data is encrypted in transit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Jakeasaurus__terraform__session_manager__main.tf", "start_line": 12}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"helm_release\" \"cert_manager\" {\n  depends_on = [local_file.kube_config_server_yaml]\n\n  name             = \"cert-manager\"\n  chart            = \"https://charts.jetstack.io/charts/cert-manager-v${var.cert_manager_version}.tgz\"\n  namespace        = \"cert-manager\"\n  create_namespace = true\n  wait             = true\n\n  set {\n    name  = \"installCRDs\"\n    value = \"true\"\n  }\n}\n\nresource \"helm_release\" \"cluster_issuer\" {\n  depends_on = [helm_release.cert_manager]\n\n  name             = \"selfsigned-cluster-issuer\"\n  chart            = \"https://github.com/adfinis-sygroup/helm-charts/releases/download/cert-manager-issuers-0.2.4/cert-manager-issuers-0.2.4.tgz\"\n  namespace        = \"cert-manager\"\n  create_namespace = true\n  wait             = true\n\n  values = [\n    <<EOT\nclusterIssuers:\n- spec:\n    selfSigned: {}\n    EOT\n  ]\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__quickstart__neuvector__aws__cert-manager.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# BEFORE: Original stream instance resource (comment out after migration)\n# resource \"mongodbatlas_stream_instance\" \"example\" {\n#   project_id = var.project_id\n#   instance_name = var.workspace_name\n#   data_process_region = {\n#     region = \"VIRGINIA_USA\"\n#     cloud_provider = \"AWS\"\n#   }\n#   stream_config = {\n#     tier = \"SP30\"\n#   }\n# }\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mongodb__terraform-provider-mongodbatlas__examples__migrate_stream_instance_to_stream_workspace__stream_instance.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"username\" {\n    description = \"Lattice username\"\n}\n\nvariable \"password\" {\n    description = \"Lattice password\"\n}\n\nvariable \"aws_access_key_id\" {\n    description = \"AWS access key ID\"\n}\n\nvariable \"aws_secret_access_key\" {\n    description = \"AWS secret access key\"\n}\n\nvariable \"aws_ssh_private_key_name\" {\n    description = \"AWS SSH private key name\"\n}\n\nvariable \"aws_ssh_private_key_path\" {\n    description = \"AWS SSH private key file path\"\n}\n\nvariable \"aws_region\" {\n    description = \"AWS region\"\n    default = \"us-east-1\"\n}\n\nvariable \"cell_count\" {\n    description = \"Number of Lattice cells to launch\"\n    default = \"3\"\n}\n\nvariable \"brain_instance_type\" {\n    description = \"Machine type for the Lattice brain\"\n    default = \"t2.medium\"\n}\n\nvariable \"cell_instance_type\" {\n    description = \"Machine type for Lattice cells\"\n    default = \"m4.large\"\n}\n\nvariable \"ssh_username\" {\n    description = \"SSH username for base image AMI\"\n    default = \"ubuntu\"\n}\n\nvariable \"vpc_cidr_block\" {\n    description = \"CIDR address range for AWS VPC\"\n    default = \"10.0.0.0/16\"\n}\n\nvariable \"subnet_cidr_block\" {\n    description = \"CIDR address range for AWS subnet\"\n    default = \"10.0.1.0/24\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"github\" {\n  owner = var.owner\n  app_auth {\n    // Empty block to allow the provider configurations to be specified through\n    // environment variables.\n    // See: https://github.com/hashicorp/terraform-plugin-sdk/issues/142\n  }\n}\n\nterraform {\n  required_providers {\n    github = {\n      source = \"integrations/github\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/integrations__terraform-provider-github__examples__app_authentication__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nprovider \"azurerm\" {\n  features {}\n}\n\nresource \"azurerm_resource_group\" \"rg\" {\n  name     = \"${var.prefix}-resources\"\n  location = var.location\n}\n\nresource \"azurerm_api_management\" \"apim_service\" {\n  name                = \"${var.prefix}-apim-service\"\n  location            = var.location\n  resource_group_name = azurerm_resource_group.rg.name\n  publisher_name      = \"Example Publisher\"\n  publisher_email     = \"publisher@example.com\"\n  sku_name            = \"Developer_1\"\n  tags = {\n    Environment = \"Example\"\n  }\n  policy {\n    xml_content = <<XML\n    <policies>\n      <inbound />\n      <backend />\n      <outbound />\n      <on-error />\n    </policies>\nXML\n  }\n}\n\nresource \"azurerm_api_management_api\" \"api\" {\n  name                = \"${var.prefix}-api\"\n  resource_group_name = azurerm_resource_group.rg.name\n  api_management_name = azurerm_api_management.apim_service.name\n  revision            = \"1\"\n  display_name        = \"${var.prefix}-api\"\n  path                = \"example\"\n  protocols           = [\"https\", \"http\"]\n  description         = \"An example API\"\n  import {\n    content_format = var.open_api_spec_content_format\n    content_value  = var.open_api_spec_content_value\n  }\n}\n\nresource \"azurerm_api_management_product\" \"product\" {\n  product_id            = \"${var.prefix}-product\"\n  resource_group_name   = azurerm_resource_group.rg.name\n  api_management_name   = azurerm_api_management.apim_service.name\n  display_name          = \"${var.prefix}-product\"\n  subscription_required = true\n  approval_required     = false\n  published             = true\n  description           = \"An example Product\"\n}\n\nresource \"azurerm_api_management_group\" \"group\" {\n  name                = \"${var.prefix}-group\"\n  resource_group_name = azurerm_resource_group.rg.name\n  api_management_name = azurerm_api_management.apim_service.name\n  display_name        = \"${var.prefix}-group\"\n  description         = \"An example group\"\n}\n\nresource \"azurerm_api_management_product_api\" \"product_api\" {\n  resource_group_name = azurerm_resource_group.rg.name\n  api_management_name = azurerm_api_management.apim_service.name\n  product_id          = azurerm_api_management_product.product.product_id\n  api_name            = azurerm_api_management_api.api.name\n}\n\nresource \"azurerm_api_management_product_group\" \"product_group\" {\n  resource_group_name = azurerm_resource_group.rg.name\n  api_management_name = azurerm_api_management.apim_service.name\n  product_id          = azurerm_api_management_product.product.product_id\n  group_name          = azurerm_api_management_group.group.name\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-azurerm__examples__api-management__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_174", "severity": "HIGH", "message": "Ensure API management public access is disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-azurerm__examples__api-management__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_107", "severity": "HIGH", "message": "Ensure that API management services use virtual networks", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-azurerm__examples__api-management__main.tf", "start_line": 13}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws        = \">= 2.52.0\"\n    kubernetes = \">= 1.11.1\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/warrensbox__terraform-switcher__test-data__skip-integration-tests__test_versiontf_no_version_constraint__version.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// Copyright (c) 2017, 2024, Oracle and/or its affiliates. All rights reserved.\n// Licensed under the Mozilla Public License v2.0\n\nresource \"oci_core_instance\" \"TFInstance\" {\n  availability_domain = data.oci_identity_availability_domain.AD.name\n  compartment_id      = var.compartment_ocid\n  display_name        = \"TFInstanceForInstancePool\"\n  shape               = var.instance_shape\n\n  create_vnic_details {\n    subnet_id        = oci_core_subnet.ExampleSubnet.id\n    display_name     = \"primaryvnic\"\n    assign_public_ip = true\n    hostname_label   = \"tfexampleinstance\"\n  }\n\n  source_details {\n    source_type = \"image\"\n    source_id   = var.instance_image_ocid[var.region]\n  }\n\n  instance_options {\n    are_legacy_imds_endpoints_disabled = true\n  }\n\n  timeouts {\n    create = \"60m\"\n  }\n}\n\nresource \"oci_core_instance_configuration\" \"TFInstanceConfiguration\" {\n  compartment_id = var.compartment_ocid\n  display_name   = \"TFExampleInstanceConfiguration\"\n\n  instance_details {\n    instance_type = \"compute\"\n\n    launch_details {\n      compartment_id = var.compartment_ocid\n      ipxe_script    = \"ipxeScript\"\n      shape          = var.instance_shape\n      display_name   = \"TFExampleInstanceConfigurationLaunchDetails\"\n\n      create_vnic_details {\n        assign_public_ip       = true\n        display_name           = \"TFExampleInstanceConfigurationVNIC\"\n        skip_source_dest_check = false\n      }\n\n      extended_metadata = {\n        some_string   = \"stringA\"\n        nested_object = \"{\\\"some_string\\\": \\\"stringB\\\", \\\"object\\\": {\\\"some_string\\\": \\\"stringC\\\"}}\"\n      }\n\n      source_details {\n        source_type = \"image\"\n        image_id    = var.instance_image_ocid[var.region]\n      }\n    }\n  }\n}\n\nresource \"oci_core_instance_pool\" \"TFInstancePool\" {\n  compartment_id            = var.compartment_ocid\n  instance_configuration_id = oci_core_instance_configuration.TFInstanceConfiguration.id\n  size                      = 1\n  state                     = \"RUNNING\"\n  display_name              = \"TFInstancePool\"\n\n  placement_configurations {\n    availability_domain = data.oci_identity_availability_domain.AD.name\n    primary_subnet_id   = oci_core_subnet.ExampleSubnet.id\n  }\n}\n\nresource \"oci_core_instance_pool\" \"TFInstancePoolForScheduledPolicy\" {\n  compartment_id            = var.compartment_ocid\n  instance_configuration_id = oci_core_instance_configuration.TFInstanceConfiguration.id\n  size                      = 1\n  state                     = \"RUNNING\"\n  display_name              = \"TFInstancePoolForScheduledPolicy\"\n\n  placement_configurations {\n    availability_domain = data.oci_identity_availability_domain.AD.name\n    primary_subnet_id   = oci_core_subnet.ExampleSubnet.id\n  }\n}\n\nresource \"oci_core_instance_pool\" \"TFInstancePoolForScheduledPolicyResourceAction\" {\n  compartment_id            = var.compartment_ocid\n  instance_configuration_id = oci_core_instance_configuration.TFInstanceConfiguration.id\n  size                      = 1\n  state                     = \"RUNNING\"\n  display_name              = \"TFInstancePoolResourceAction\"\n\n  placement_configurations {\n    availability_domain = data.oci_identity_availability_domain.AD.name\n    primary_subnet_id   = oci_core_subnet.ExampleSubnet.id\n  }\n}\n\nresource \"oci_core_instance_pool\" \"TFInstancePoolForCustomMetrics\" {\n  compartment_id = var.compartment_ocid\n  instance_configuration_id = oci_core_instance_configuration.TFInstanceConfiguration.id\n  size = 1\n  state = \"RUNNING\"\n  display_name = \"TFInstancePoolForCustomMetrics\"\n\n  placement_configurations {\n    availability_domain = data.oci_identity_availability_domain.AD.name\n    primary_subnet_id = oci_core_subnet.ExampleSubnet.id\n  }\n}\n\nresource \"oci_autoscaling_auto_scaling_configuration\" \"TFAutoScalingConfiguration\" {\n  compartment_id       = var.compartment_ocid\n  cool_down_in_seconds = \"300\"\n  display_name         = \"TFAutoScalingConfiguration\"\n  is_enabled           = \"true\"\n\n  policies {\n    capacity {\n      initial = \"1\"\n      max     = \"2\"\n      min     = \"1\"\n    }\n\n    display_name = \"TFPolicy\"\n    policy_type  = \"threshold\"\n\n    rules {\n      action {\n        type  = \"CHANGE_COUNT_BY\"\n        value = \"1\"\n      }\n\n      display_name = \"TFScaleOutRule\"\n\n      metric {\n        metric_type = \"CPU_UTILIZATION\"\n\n        threshold {\n          operator = \"GT\"\n          value    = \"90\"\n        }\n      }\n    }\n\n    rules {\n      action {\n        type  = \"CHANGE_COUNT_BY\"\n        value = \"-1\"\n      }\n\n      display_name = \"TFScaleInRule\"\n\n      metric {\n        metric_type = \"CPU_UTILIZATION\"\n\n        threshold {\n          operator = \"LT\"\n          value    = \"1\"\n        }\n      }\n    }\n  }\n\n  auto_scaling_resources {\n    id   = oci_core_instance_pool.TFInstancePool.id\n    type = \"instancePool\"\n  }\n}\n\nresource \"oci_autoscaling_auto_scaling_configuration\" \"TFAutoScalingConfigurationScheduledPolicy\" {\n  compartment_id       = var.compartment_ocid\n  cool_down_in_seconds = \"300\"\n  display_name         = \"TFAutoScalingConfigurationScheduledPolicy\"\n  is_enabled           = \"true\"\n\n  policies {\n    capacity {\n      initial = \"4\"\n      max     = \"4\"\n      min     = \"2\"\n    }\n\n    display_name = \"TFScheduledPolicy\"\n    policy_type  = \"scheduled\"\n\n    execution_schedule {\n      expression = \"0 15 10 ? * *\"\n      timezone   = \"UTC\"\n      type       = \"cron\"\n    }\n  }\n\n  auto_scaling_resources {\n    id   = oci_core_instance_pool.TFInstancePoolForScheduledPolicy.id\n    type = \"instancePool\"\n  }\n}\n\nresource \"oci_autoscaling_auto_scaling_configuration\" \"TFAutoScalingConfigurationScheduledPolicyResourceAction\" {\n  compartment_id       = var.compartment_ocid\n  cool_down_in_seconds = \"300\"\n  display_name         = \"TFAutoScalingConfigurationScheduledPolicyResourceAction\"\n  is_enabled           = \"true\"\n\n  policies {\n    resource_action {\n      action = \"STOP\"\n      action_type = \"power\"\n    }\n    display_name = \"TFScheduledPolicyResourceAction\"\n    policy_type  = \"scheduled\"\n\n    execution_schedule {\n      expression = \"0 15 10 ? * *\"\n      timezone   = \"UTC\"\n      type       = \"cron\"\n    }\n  }\n\n  auto_scaling_resources {\n    id   = oci_core_instance_pool.TFInstancePoolForScheduledPolicyResourceAction.id\n    type = \"instancePool\"\n  }\n}\n\nresource \"oci_autoscaling_auto_scaling_configuration\" \"TFAutoScalingConfigurationCustomMetrics\" {\n  compartment_id = var.compartment_ocid\n  cool_down_in_seconds = \"300\"\n  display_name = \"TFAutoScalingConfigurationCustomMetrics\"\n  is_enabled = \"true\"\n\n  policies {\n    capacity {\n      initial = \"1\"\n      max = \"2\"\n      min = \"1\"\n    }\n\n    display_name = \"TFPolicyCustomMetrics\"\n    policy_type = \"threshold\"\n\n    rules {\n      action {\n        type = \"CHANGE_COUNT_BY\"\n        value = \"1\"\n      }\n\n      display_name = \"TFScaleOutRuleCustomMetrics\"\n\n      metric {\n        metric_source = \"CUSTOM_QUERY\"\n        query = \"CpuUtilization[1m]{instancePoolId=oci_core_instance_pool.rana_instance_pool.id}.groupBy(instancePoolId).mean() > 0\"\n        namespace = \"oci_computeagent\"\n        resource_group = \"resource_group\"\n        metric_compartment_id = var.compartment_ocid\n        pending_duration = \"PT5M\"\n      }\n    }\n\n    rules {\n      action {\n        type = \"CHANGE_COUNT_BY\"\n        value = \"-1\"\n      }\n\n      display_name = \"TFScaleInRuleCustomMetrics\"\n\n      metric {\n        metric_source = \"CUSTOM_QUERY\"\n        query = \"CpuUtilization[1m]{instancePoolId=oci_core_instance_pool.rana_instance_pool.id}.groupBy(instancePoolId).mean() > 0\"\n        namespace = \"oci_computeagent\"\n        resource_group = \"resource_group\"\n        metric_compartment_id = var.compartment_ocid\n        pending_duration = \"PT5M\"\n      }\n    }\n  }\n\n  auto_scaling_resources {\n    id = oci_core_instance_pool.TFInstancePoolForCustomMetrics.id\n    type = \"instancePool\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/oracle__terraform-provider-oci__examples__autoscaling__compute.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_OCI_4", "severity": "HIGH", "message": "Ensure OCI Compute Instance boot volume has in-transit data encryption enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/oracle__terraform-provider-oci__examples__autoscaling__compute.tf", "start_line": 4}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"okta_app_oauth\" \"test\" {\n  label          = \"testAcc_replace_with_uuid\"\n  type           = \"web\"\n  grant_types    = [\"implicit\", \"authorization_code\"]\n  redirect_uris  = [\"http://d.com/\"]\n  response_types = [\"code\", \"token\", \"id_token\"]\n  issuer_mode    = \"ORG_URL\"\n  consent_method = \"TRUSTED\"\n}\n\ndata \"okta_app\" \"test\" {\n  label = okta_app_oauth.test.label\n}\n\ndata \"okta_app\" \"test2\" {\n  id = okta_app_oauth.test.id\n}\n\ndata \"okta_app\" \"test3\" {\n  label_prefix = okta_app_oauth.test.label\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/okta__terraform-provider-okta__examples__data-sources__okta_app__datasource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"null_resource\" \"foo\" {}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mercari__tfnotify__examples__getting-started__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nterraform {\n  required_version = \">= 0.12\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/IBM-Cloud__terraform-provider-ibm__examples__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"sec_sub_id\" {\n  type = string\n}\n\nvariable \"sec_client_id\" {\n  type = string\n}\n\nvariable \"sec_client_secret\" {\n  type = string\n}\n\nvariable \"sec_tenant_id\" {\n  type = string\n}\n\nvariable \"sec_vnet_name\" {\n  type = string\n}\n\nvariable \"sec_vnet_id\" {\n  type = string\n}\n\nvariable \"sec_resource_group\" {\n  type = string\n}\n\nvariable \"sec_principal_id\" {\n  type = string\n}\n\n\ndata \"azurerm_subscription\" \"current\" {}\n\n\nprovider \"azurerm\" {\n  alias                       = \"security\"\n  subscription_id             = var.sec_sub_id\n  client_id                   = var.sec_client_id\n  client_secret               = var.sec_client_secret\n  tenant_id                   = var.sec_tenant_id\n  skip_provider_registration  = true\n  skip_credentials_validation = true\n  features {}\n}\n\nprovider \"azurerm\" {\n  alias                       = \"peering\"\n  subscription_id             = data.azurerm_subscription.current.subscription_id\n  client_id                   = var.sec_client_id\n  client_secret               = var.sec_client_secret\n  tenant_id                   = data.azurerm_subscription.current.tenant_id\n  skip_provider_registration  = true\n  skip_credentials_validation = true\n  features {}\n}\n\nresource \"azurerm_role_definition\" \"vnet-peering\" {\n  name  = \"allow-vnet-peer-main\"\n  scope = data.azurerm_subscription.current.id\n\n  permissions {\n    actions     = [\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/write\", \"Microsoft.Network/virtualNetworks/peer/action\", \"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/read\", \"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/delete\"]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.current.id,\n  ]\n}\n\nresource \"azurerm_role_assignment\" \"vnet\" {\n  scope              = module.vnet-main.vnet_id\n  role_definition_id = azurerm_role_definition.vnet-peering.role_definition_resource_id\n  principal_id       = var.sec_principal_id\n}\n\nresource \"azurerm_virtual_network_peering\" \"main\" {\n  name                      = \"main_2_sec\"\n  resource_group_name       = var.resource_group_name\n  virtual_network_name      = module.vnet-main.vnet_name\n  remote_virtual_network_id = var.sec_vnet_id\n  provider                  = azurerm.peering\n\n  depends_on = [azurerm_role_assignment.vnet]\n}\n\nresource \"azurerm_virtual_network_peering\" \"sec\" {\n  name                      = \"sec_2_main\"\n  resource_group_name       = var.sec_resource_group\n  virtual_network_name      = var.sec_vnet_name\n  remote_virtual_network_id = module.vnet-main.vnet_id\n  provider                  = azurerm.security\n\n  depends_on = [azurerm_role_assignment.vnet]\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__3-vnet-peering__vnet-peering.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"az_a_nat_gateway\"{\n  source    = \"./../../../modules/networking/nat_gateway\"\n  subnet_id = \"${module.subnet_public_a.pub_sub_id_out}\"\n}\n\nmodule \"az_b_nat_gateway\"{\n  source    = \"./../../../modules/networking/nat_gateway\"\n  subnet_id = \"${module.subnet_public_b.pub_sub_id_out}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/contino__terraform-learn__aws__environments__preprod__networking__nat_gateway.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nmodule \"git_repo_connection\" {\n  source  = \"terraform-google-modules/bootstrap/google//modules/cloudbuild_repo_connection\"\n  version = \"~> 11.0\"\n\n  project_id = var.project_id\n  connection_config = {\n    connection_type                             = \"GITLABv2\"\n    gitlab_authorizer_credential_secret_id      = var.gitlab_authorizer_secret_id\n    gitlab_read_authorizer_credential_secret_id = var.gitlab_read_authorizer_secret_id\n    gitlab_webhook_secret_id                    = var.gitlab_webhook_secret_id\n  }\n\n  cloud_build_repositories = {\n    \"test_repo\" = {\n      repository_name = var.repository_name\n      repository_url  = var.repository_url\n    },\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__examples__cloudbuild_repo_connection_gitlab__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__examples__cloudbuild_repo_connection_gitlab__main.tf", "start_line": 17}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"null_resource\" \"enable_firestore\" {\n  provisioner \"local-exec\" {\n    command = \"make firestore\"\n  }\n\n  depends_on = [google_firebase_project_location.default]\n}\n\nresource \"google_firestore_index\" \"trainings_user_time\" {\n  collection = \"trainings\"\n\n  fields {\n    field_path = \"UserUuid\"\n    order      = \"ASCENDING\"\n  }\n\n  fields {\n    field_path = \"Canceled\"\n    order      = \"ASCENDING\"\n  }\n\n  fields {\n    field_path = \"Time\"\n    order      = \"ASCENDING\"\n  }\n\n  fields {\n    field_path = \"__name__\"\n    order      = \"ASCENDING\"\n  }\n\n  depends_on = [null_resource.enable_firestore]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ThreeDotsLabs__wild-workouts-go-ddd-example__terraform__firestore.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"vpc_cidr\" {\n  description = \"VPC CIDR\"\n  type        = string\n  default     = \"10.0.0.0/16\"\n}\nvariable \"region\" {\n  description = \"AWS region\"\n  type        = string\n  default     = \"us-west-2\"\n}\nvariable \"kubernetes_version\" {\n  description = \"Kubernetes version\"\n  type        = string\n  default     = \"1.28\"\n}\nvariable \"addons\" {\n  description = \"Kubernetes addons\"\n  type        = any\n  default = {\n    enable_aws_load_balancer_controller = true\n    enable_metrics_server               = true\n  }\n}\n# Addons Git\nvariable \"gitops_addons_org\" {\n  description = \"Git repository org/user contains for addons\"\n  type        = string\n  default     = \"https://github.com/gitops-bridge-dev\"\n}\nvariable \"gitops_addons_repo\" {\n  description = \"Git repository contains for addons\"\n  type        = string\n  default     = \"gitops-bridge-argocd-control-plane-template\"\n}\nvariable \"gitops_addons_revision\" {\n  description = \"Git repository revision/branch/ref for addons\"\n  type        = string\n  default     = \"main\"\n}\nvariable \"gitops_addons_basepath\" {\n  description = \"Git repository base path for addons\"\n  type        = string\n  default     = \"\"\n}\nvariable \"gitops_addons_path\" {\n  description = \"Git repository path for addons\"\n  type        = string\n  default     = \"bootstrap/control-plane/addons\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gitops-bridge-dev__gitops-bridge__argocd__iac__terraform__examples__eks__aws-secrets-manager__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nresource \"scaffolding_resource\" \"example\" {\n  sample_attribute = \"foo\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-scaffolding__examples__resources__scaffolding_resource__resource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Get latest AMI ID for Amazon Linux2 OS\ndata \"aws_ami\" \"amzlinux\" {\n  most_recent = true\n  owners = [ \"amazon\" ]\n  filter {\n    name = \"name\"\n    values = [ \"amzn2-ami-hvm-*-gp2\" ]\n  }\n  filter {\n    name = \"root-device-type\"\n    values = [ \"ebs\" ]\n  }\n  filter {\n    name = \"virtualization-type\"\n    values = [ \"hvm\" ]\n  }\n  filter {\n    name = \"architecture\"\n    values = [ \"x86_64\" ]\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-cloud-demo1__c6-ami-datasource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nmodule \"im_workspace\" {\n  source  = \"terraform-google-modules/bootstrap/google//modules/im_cloudbuild_workspace\"\n  version = \"~> 11.0\"\n\n  project_id    = var.project_id\n  deployment_id = \"im-example-github-deployment\"\n\n  tf_repo_type           = \"GITHUB\"\n  im_deployment_repo_uri = var.repository_url\n  im_deployment_ref      = \"main\"\n  im_tf_variables        = \"project_id=${var.project_id}\"\n  infra_manager_sa_roles = [\"roles/compute.networkAdmin\"]\n  tf_version             = \"1.5.7\"\n\n  // Found in the URL of your Cloud Build GitHub app configuration settings\n  // https://cloud.google.com/build/docs/automating-builds/github/connect-repo-github?generation=2nd-gen#connecting_a_github_host_programmatically\n  github_app_installation_id   = \"68754904\"\n  github_personal_access_token = var.im_github_pat\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__examples__im_cloudbuild_workspace_github__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__examples__im_cloudbuild_workspace_github__main.tf", "start_line": 17}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"region\" {\n  default = \"us-central1\"\n}\n\nvariable \"region_zone\" {\n  default = \"us-central1-b\"\n}\n\nvariable \"region_zone_2\" {\n  default = \"us-central1-c\"\n}\n\nvariable \"project_name\" {\n  description = \"The ID of the Google Cloud project\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2022 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// This file was automatically generated from a template in ./autogen/main\n\n/******************************************\n  Create ip-masq-agent confimap\n *****************************************/\nresource \"kubernetes_config_map\" \"ip_masq_agent\" {\n  count = var.configure_ip_masq ? 1 : 0\n\n  metadata {\n    name      = \"ip-masq-agent\"\n    namespace = \"kube-system\"\n\n    labels = {\n      maintained_by = \"terraform\"\n    }\n  }\n\n  data = {\n    config = <<EOF\nnonMasqueradeCIDRs:\n  - ${join(\"\\n  - \", var.non_masquerade_cidrs)}\nresyncInterval: ${var.ip_masq_resync_interval}\nmasqLinkLocal: ${var.ip_masq_link_local}\nEOF\n  }\n\n  depends_on = [\n    google_container_cluster.primary,\n    google_container_node_pool.pools,\n  ]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-kubernetes-engine__masq.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Configure the AWS provider\nprovider \"aws\" {\n  region = \"eu-west-1\"\n}\n\n# Data source: query the list of availability zones\ndata \"aws_availability_zones\" \"all\" {}\n\n# Create a Security Group for an EC2 instance\nresource \"aws_security_group\" \"instance\" {\n  name = \"terraform-example-instance\"\n  \n  ingress {\n    from_port\t  = \"${var.server_port}\"\n    to_port\t\t  = \"${var.server_port}\"\n    protocol\t  = \"tcp\"\n    cidr_blocks\t= [\"0.0.0.0/0\"]\n  }\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n\n# Create a Security Group for an ELB\nresource \"aws_security_group\" \"elb\" {\n  name = \"terraform-example-elb\"\n  \n  ingress {\n    from_port\t  = 80\n\t  to_port\t\t  = 80\n\t  protocol\t  = \"tcp\"\n\t  cidr_blocks\t= [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port\t  = 0\n\t  to_port\t\t  = 0\n\t  protocol\t  = \"-1\"\n\t  cidr_blocks\t= [\"0.0.0.0/0\"]\n  }\n}\n\n# Create a Launch Configuration\nresource \"aws_launch_configuration\" \"example\" {\n  image_id\t\t    = \"ami-785db401\"\n  instance_type   = \"t2.micro\"\n  security_groups = [\"${aws_security_group.instance.id}\"]\n  \n  user_data = <<-EOF\n              #!/bin/bash\n              echo \"Hello, World\" > index.html\n              nohup busybox httpd -f -p \"${var.server_port}\" &\n              EOF\n\t\t\t  \n  lifecycle {\n    create_before_destroy = true\n  }\n}\n\n# Create an Autoscaling Group\nresource \"aws_autoscaling_group\" \"example\" {\n  launch_configuration = \"${aws_launch_configuration.example.id}\"\n  availability_zones   = [\"${data.aws_availability_zones.all.names}\"]\n  \n  load_balancers       = [\"${aws_elb.example.name}\"]\n  health_check_type    = \"ELB\"\n  \n  min_size = 2\n  max_size = 10\n  \n  tag {\n    key                 = \"Name\"\n    value               = \"terraform-asg-example\"\n    propagate_at_launch = true\n  }\n}\n\n# Create an ELB\nresource \"aws_elb\" \"example\" {\n  name               = \"terraform-asg-example\"\n  availability_zones = [\"${data.aws_availability_zones.all.names}\"]\n  security_groups    = [\"${aws_security_group.elb.id}\"]\n  \n  listener {\n    lb_port           = 80\n    lb_protocol       = \"http\"\n    instance_port     = \"${var.server_port}\"\n    instance_protocol = \"http\"\n  }\n  \n  health_check {\n    healthy_threshold   = 2\n    unhealthy_threshold = 2\n    timeout             = 3\n    interval            = 30\n    target              = \"HTTP:${var.server_port}/\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__05-cluster-webserver__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__05-cluster-webserver__main.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__05-cluster-webserver__main.tf", "start_line": 26}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__05-cluster-webserver__main.tf", "start_line": 26}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__05-cluster-webserver__main.tf", "start_line": 26}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__05-cluster-webserver__main.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__05-cluster-webserver__main.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_315", "severity": "HIGH", "message": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__05-cluster-webserver__main.tf", "start_line": 62}, {"tool": "checkov", "rule_id": "CKV_AWS_92", "severity": "HIGH", "message": "Ensure the ELB has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__05-cluster-webserver__main.tf", "start_line": 80}, {"tool": "checkov", "rule_id": "CKV_AWS_127", "severity": "HIGH", "message": "Ensure that Elastic Load Balancer(s) uses SSL certificates provided by AWS Certificate Manager", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__05-cluster-webserver__main.tf", "start_line": 80}, {"tool": "checkov", "rule_id": "CKV_AWS_376", "severity": "HIGH", "message": "Ensure AWS Elastic Load Balancer listener uses TLS/SSL", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__05-cluster-webserver__main.tf", "start_line": 80}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Use Copilot to create documentation for the resources in this file\n\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"5.64.0\"\n      # Higlight this version paramenter\n      # Right click, and select the Explain This option under the Copilot menu\n    }\n  }\n}\n\n# Higlight this resource block\n# Right click, and select the Explain This option under the Copilot menu\nresource \"aws_vpc\" \"prd-vpc\" {\n  cidr_block = \"10.0.0.0/16\"\n}\n\n# cretaing a new vpc for development workloads\nresource \"aws_vpc\" \"dev-vpc\" {\n  cidr_block = \"10.10.0.0/16\"\n}\n\nresource \"aws_security_group\" \"dev-web-sg\" {\n  vpc_id = aws_vpc.dev-vpc.id\n\n  ingress {\n    description = \"allow inbound traffic from the internet\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [10.0.0.0/16]\n    # Something is wrong with this parameter\n    # Highlight the cidr_blocks parameter and value, right click, and have Copilot Fix This!\n    # Solution: the value should be a string, so it should be [\"10.0.00/16\"]\n  }\n}\n# Something is wrong with this resource block\n# Highlight this block, right click, and have Copilot Fix This!\n# Solution: the vpc resource block is missing the cidr_block parameter\nresource \"aws_vpc\" \"test-vpc\" {\n}\n\nresource \"aws_subnet\" \"prd-pub-subnet-1\" {\n  vpc_id            = aws_vpc.prd-vpc.id\n  cidr_block        = \"10.0.0.0/24\"\n  availability_zone = \"us-east-1a\"\n\n  tags = {\n    Name = \"prd-pub-subnet-1\"\n  }\n}\n\nresource \"aws_subnet\" \"prd-pub-subnet-2\" {\n  vpc_id            = aws_vpc.prd-vpc.id\n  cidr_block        = \"10.0.1.0/24\"\n  availability_zone = \"us-east-1b\"\n\n  tags = {\n    Name = \"prd-pub-subnet-2\"\n  }\n}\n\nresource \"aws_subnet\" \"prd-pub-subnet-3\" {\n  vpc_id            = aws_vpc.prd-vpc.id\n  cidr_block        = \"10.0.2.0/24\"\n  availability_zone = \"us-east-1c\"\n\n  tags = {\n    Name = \"prd-pub-subnet-3\"\n  }\n}\n\nresource \"aws_subnet\" \"prd-pri-subnet-1\" {\n  vpc_id            = aws_vpc.prd-vpc.id\n  cidr_block        = \"10.0.10.0/24\"\n  availability_zone = \"us-east-1a\"\n\n  tags = {\n    Name = \"prd-pri-subnet-1\"\n  }\n}\n\nresource \"aws_subnet\" \"prd-pri-subnet-2\" {\n  vpc_id            = aws_vpc.prd-vpc.id\n  cidr_block        = \"10.0.11.0/24\"\n  availability_zone = \"us-east-1b\"\n\n  tags = {\n    Name = \"prd-pri-subnet-2\"\n  }\n}\n\nresource \"aws_subnet\" \"prd-pri-subnet-3\" {\n  vpc_id            = aws_vpc.prd-vpc.id\n  cidr_block        = \"10.0.12.0/24\"\n  availability_zone = \"us-east-1c\"\n\n  tags = {\n    Name = \"prd-pri-subnet-3\"\n  }\n}\n\nresource \"aws_internet_gateway\" \"prd-igw\" {\n  vpc_id = aws_vpc.prd-vpc.id\n\n  tags = {\n    Name = \"prd-igw\"\n  }\n}\n\nresource \"aws_route_table\" \"prd-pub-rt\" {\n  vpc_id = aws_vpc.prd-vpc.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.prd-igw.id\n  }\n}\n\nresource \"aws_route_table_association\" \"prd-pub-rt-assoc-1\" {\n  subnet_id      = aws_subnet.prd-pub-subnet-1.id\n  route_table_id = aws_route_table.prd-pub-rt.id\n}\n\nresource \"aws_route_table_association\" \"prd-pub-rt-assoc-2\" {\n  subnet_id      = aws_subnet.prd-pub-subnet-2.id\n  route_table_id = aws_route_table.prd-pub-rt.id\n}\n\nresource \"aws_route_table_association\" \"prd-pub-rt-assoc-3\" {\n  subnet_id      = aws_subnet.prd-pub-subnet-3.id\n  route_table_id = aws_route_table.prd-pub-rt.id\n}\n\nresource \"aws_route_table\" \"prd-pri-rt\" {\n  vpc_id = aws_vpc.prd-vpc.id\n}\n\nresource \"aws_route_table_association\" \"prd-pri-rt-assoc-1\" {\n  subnet_id      = aws_subnet.prd-pri-subnet-1.id\n  route_table_id = aws_route_table.prd-pri-rt.id\n}\n\nresource \"aws_route_table_association\" \"prd-pri-rt-assoc-2\" {\n  subnet_id      = aws_subnet.prd-pri-subnet-2.id\n  route_table_id = aws_route_table.prd-pri-rt.id\n}\n\nresource \"aws_route_table_association\" \"prd-pri-rt-assoc-3\" {\n  subnet_id      = aws_subnet.prd-pri-subnet-3.id\n  route_table_id = aws_route_table.prd-pri-rt.id\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__4-using-copilot-menu__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__4-using-copilot-menu__main.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__4-using-copilot-menu__main.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__4-using-copilot-menu__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__4-using-copilot-menu__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__4-using-copilot-menu__main.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__4-using-copilot-menu__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__4-using-copilot-menu__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__4-using-copilot-menu__main.tf", "start_line": 42}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  # Assumes s3 bucket and dynamo DB table already set up\n  # See /code/03-basics/aws-backend\n  backend \"s3\" {\n    bucket         = \"devops-directive-tf-state\"\n    key            = \"06-organization-and-modules/consul/terraform.tfstate\"\n    region         = \"us-east-1\"\n    dynamodb_table = \"terraform-state-locking\"\n    encrypt        = true\n  }\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 3.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\n############################################################\n##\n## NOTE: if you are deploying this in your production setup\n## follow the instructions in the github repo on how to modify\n## deploying with the defaults here as an example of the power\n## of modules.\n##\n## REPO: https://github.com/hashicorp/terraform-aws-consul\n##\n############################################################\nmodule \"consul\" {\n  source = \"git@github.com:hashicorp/terraform-aws-consul.git\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__06-organization-and-modules__consul__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__06-organization-and-modules__consul__main.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__06-organization-and-modules__consul__main.tf", "start_line": 34}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.1\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = var.aws_region\n}\n\nmodule \"service\" {\n  source = \"../../modules/asg-alb-service\"\n\n  name          = var.name\n  instance_type = \"t3.micro\"\n  min_size      = 2\n  max_size      = 4\n  server_port   = 8080\n  alb_port      = 80\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terragrunt-infrastructure-modules-example__examples__asg-alb-service__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region     = \"us-west-2\"\n  access_key = \"AuonS49ujer8wefi2f4\"\n  secret_key = \"NHFIF3CKe3kfm334d/ehfmo\"\n}\nresource \"aws_instance\" \"murali\" {\n    ami             = \"ami-0m6cb03f730\"\n    instance_type   = \"t2.micro\"\n    key_name        = \"murali\"\n    security_groups = [\"nsg\"]\n}\nresource \"aws_security_group\" \"allow_all\" {\n  name        = \"allow_all\"\n  description = \"Allow all inbound traffic\"\n  vpc_id      = \"vpc-064n9448\"\n\n  ingress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port       = 0\n    to_port         = 0\n    protocol        = \"-1\"\n    cidr_blocks     = [\"0.0.0.0/0\"]\n    \n  }\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__ec2__ec2.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# String type\nvariable \"environment\" {\n    type = string\n    description = \"the environment type\"\n    default = \"dev\"\n}\n\nvariable \"region\" {\n    type = string\n    description = \"the aws region\"\n    default = \"us-east-1\"\n}\n\nvariable \"instance_type\" {\n    type = string\n    description = \"the ec2 instance type\"\n    default = \"t2.micro\"\n}\n\n# Number type\nvariable \"instance_count\" {\n    type = number\n    description = \"the number of ec2 instances to create\"\n    default = 1\n}\n\nvariable \"storage_size\" {\n    type = number\n    description = \"the storage size for ec2 instance in GB\"\n    default = 8\n}\n\n# Bool type\nvariable \"enable_monitoring\" {\n    type = bool\n    description = \"enable detailed monitoring for ec2 instances\"\n    default = false\n}\n\nvariable \"associate_public_ip\" {\n    type = bool\n    description = \"associate public ip to ec2 instance\"\n    default = true\n}\n\n# List type - IMPORTANT: Allows duplicates, maintains order\nvariable \"allowed_cidr_blocks\" {\n    type = list(string)\n    description = \"list of allowed cidr blocks for security group\"\n    default = [\"10.0.0.0/8\", \"172.16.0.0/12\", \"192.168.0.0/16\"]\n    # Access: var.allowed_cidr_blocks[0] = \"10.0.0.0/8\"\n    # Can have duplicates: [\"10.0.0.0/8\", \"10.0.0.0/8\"] is valid\n}\n\nvariable \"allowed_instance_types\" {\n    type = list(string)\n    description = \"list of allowed ec2 instance types\"\n    default = [\"t2.micro\", \"t2.small\", \"t3.micro\"]\n    # Order matters: index 0 = t2.micro, index 1 = t2.small\n}\n\n# Map type - IMPORTANT: Key-value pairs, keys must be unique\nvariable \"instance_tags\" {\n    type = map(string)\n    description = \"tags to apply to the ec2 instances\"\n    default = {\n        \"Environment\" = \"dev\"\n        \"Project\" = \"terraform-course\"\n        \"Owner\" = \"devops-team\"\n    }\n    # Access: var.instance_tags[\"Environment\"] = \"dev\"\n    # Keys are always strings, values must match the declared type\n}\n\n# Set type - IMPORTANT: No duplicates allowed, order doesn't matter\nvariable \"availability_zones\" {\n    type = set(string)\n    description = \"set of availability zones (no duplicates)\"\n    default = [\"us-east-1a\", \"us-east-1b\", \"us-east-1c\"]\n    # KEY DIFFERENCE FROM LIST:\n    # - Automatically removes duplicates\n    # - Order is not guaranteed\n    # - Cannot access by index like set[0] - need to convert to list first\n}\n\n# Tuple type - IMPORTANT: Fixed length, each position has specific type\nvariable \"network_config\" {\n    type = tuple([string, string, number])\n    description = \"Network configuration (VPC CIDR, subnet CIDR, port number)\"\n    default = [\"10.0.0.0/16\", \"10.0.1.0/24\", 80]\n    # CRITICAL RULES:\n    # - Position 0 must be string (VPC CIDR)\n    # - Position 1 must be string (subnet CIDR)  \n    # - Position 2 must be number (port)\n    # - Cannot add/remove elements - length is fixed\n    # Access: var.network_config[0], var.network_config[1], var.network_config[2]\n}\n\n# Object type - IMPORTANT: Named attributes with specific types\nvariable \"server_config\" {\n    type = object({\n        name = string\n        instance_type = string\n        monitoring = bool\n        storage_gb = number\n        backup_enabled = bool\n    })\n    description = \"Complete server configuration object\"\n    default = {\n        name = \"web-server\"\n        instance_type = \"t2.micro\"\n        monitoring = true\n        storage_gb = 20\n        backup_enabled = false\n    }\n    # KEY BENEFITS:\n    # - Self-documenting structure\n    # - Type safety for each attribute\n    # - Access: var.server_config.name, var.server_config.monitoring\n    # - All attributes must be provided (unless optional)\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/piyushsachdeva__Terraform-Full-Course-Aws__lessons__day07__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"output_name\" {\n    value = \"some resource\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#Variables declaration\n\nvariable \"subscription_id\" {\n  description = \"Azure subscription Id.\"\n}\n\nvariable \"tenant_id\" {\n  description = \"Azure tenant Id.\"\n}\n\nvariable \"client_id\" {\n  description = \"Azure service principal application Id\"\n}\n\nvariable \"client_secret\" {\n  description = \"Azure service principal application Secret\"\n}\n\nvariable \"subnets\" {\n  description = \"Subnet list.\"\n  type        = any\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/JamesDLD__terraform__Best-Practice__BestPractice-2__var.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"backend_type\" {\n  default     = \"azurerm\"\n  description = \"Set the terraform remote backend provider.\"\n  validation {\n    condition     = contains([\"azurerm\", \"remote\"], var.backend_type)\n    error_message = \"Only azurerm or remote are supported at that time.\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__caf-terraform-landingzones__caf_launchpad__variables.tfc.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_sns_topic\" \"sns\" {\n  name = \"user-updates-topic\"\n}\n\nlocals {\n  rest_api_id = aws_api_gateway_rest_api.panda.id\n}\n\noutput \"rest_api_id\" {\n    value = local.rest_api_id\n}\n\nresource \"aws_route53_health_check\" \"http\" {\n  fqdn              =     format(\"%s.%s\",aws_api_gateway_rest_api.panda.id,\"execute-api.enter_region.amazonaws.com\")\n  insufficient_data_health_status = \"Healthy\"\n  port              = 443\n  type              = \"HTTPS\"\n  resource_path     = \"/\"\n  failure_threshold = \"3\"\n  request_interval  = \"30\"\n\n  tags = {\n    Name = \"api-health-check\"\n  }\n}\nresource \"aws_cloudwatch_metric_alarm\" \"http1\" {\n  depends_on          = [aws_route53_health_check.http]\n  alarm_name          = \"foobar\"\n  comparison_operator = \"LessThanThreshold\"\n  evaluation_periods  = \"1\"\n  metric_name         = \"HealthCheckStatus\"\n  namespace           = \"AWS/Route53\"\n  period              = \"60\"\n  statistic           = \"Minimum\"\n  alarm_description   = \"This metric monitors ec2 cpu utilization\"\n  actions_enabled     = \"true\"\n  alarm_actions       = [aws_sns_topic.sns.arn]\n  ok_actions          = [aws_sns_topic.sns.arn]\n\n  dimensions = {\n    HealthCheckName = \"api-health-check\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/collabnix__terraform__beginners__aws__modules__API_Gateway & CloudWatch__route53_health_check.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_26", "severity": "HIGH", "message": "Ensure all data stored in the SNS topic is encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/collabnix__terraform__beginners__aws__modules__API_Gateway & CloudWatch__route53_health_check.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region     = \"${var.region}\"\n  access_key = \"${var.accesskey}\"\n  secret_key = \"${var.secretkey}\"\n}\n\nterraform {\n   backend \"s3\" {\n    bucket_name = \"tfstatefile\"\n    key = \"terraform.tfstate\"\n    region = \"${var.region}\"\n    dynamodb_table = \"satya_db\"\n  }\n}\nresource \"aws_instance\" \"murali\" {\n    count = \"${var.count}\"\n    ami             = \"${lookup(var.ami, var.region)}\"\n    instance_type   = \"${var.type}\"\n    key_name        = \"sample\"\n    security_groups = [\"${aws_security_group.allow_all.id}\"]\n\n    #local execution inside the block\n    # provisioner \"local_exec\" {\n    #   command = \"echo ${self.public_ip},${self.private_ip} >> public_private_ip.txt\"\n    # }\n}\nresource \"aws_security_group\" \"allow_all\" {\n  name        = \"allow_all\"\n  description = \"Allow all inbound traffic\"\n  vpc_id      = \"vpc-064n9448\"\n\n  ingress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port       = 0\n    to_port         = 0\n    protocol        = \"-1\"\n    cidr_blocks     = [\"0.0.0.0/0\"]\n    \n  }\n\n  connection {\n    user = \"satya\"\n    private_key = \"${file(var.key_path)}\"\n  }\n  provisioner \"remote-exec\" {\n    inline = [\n      \"apt-get update\",\n      \"apt-get install apache2 -y\"\n    ]\n  }\n\n\n  #local exec out side lock \n\n  resource \"null_resource\" \"file\" {\n    provisioner \"local-exec\" {\n      command = \" echo ${aws_instance.murali.private_ip},${aws.instance.murali.public_ip} >> private_public_ip.txt\"\n    }\n  }\n\n  \n  tags = {\n      name = \"Satya-${count.index + 1}\"\n  }\n  ##for list of tags\n#   tags = {\n#       name = \"${element(var.assign_tags, count.index)}\"\n#   }\n\n\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_25", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_277", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__count__main.tf", "start_line": 15}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"consul_keys\" \"app\" {\n  datacenter = \"nyc1\"\n\n  # Read the launch AMI from Consul\n  key {\n    name    = \"ami\"\n    path    = \"service/app/launch_ami\"\n    default = \"ami-1234\"\n  }\n}\n\n# Start our instance with the dynamic ami value\nresource \"aws_instance\" \"app\" {\n  ami = data.consul_keys.app.var.ami\n\n  # ...\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-consul__examples__data-sources__consul_keys__data-source.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-consul__examples__data-sources__consul_keys__data-source.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-consul__examples__data-sources__consul_keys__data-source.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-consul__examples__data-sources__consul_keys__data-source.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-consul__examples__data-sources__consul_keys__data-source.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-consul__examples__data-sources__consul_keys__data-source.tf", "start_line": 13}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__checkov__tests__common__runners__filter_ignored_directories_by_values__dir33__file2.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"custom_tags\" {\n  description = \"Custom tags to set on the Instances in the ASG\"\n  type        = map(string)\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__loops-with-for-each__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_caller_identity\" \"current\" {}\n\nresource \"aws_s3_bucket\" \"sandbox_bucket\" {\n  bucket = \"aft-sandbox-${data.aws_caller_identity.current.account_id}\"\n  acl    = \"private\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-customizations__sandbox__terraform__s3.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-customizations__sandbox__terraform__s3.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-customizations__sandbox__terraform__s3.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-customizations__sandbox__terraform__s3.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-customizations__sandbox__terraform__s3.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-customizations__sandbox__terraform__s3.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-customizations__sandbox__terraform__s3.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-customizations__sandbox__terraform__s3.tf", "start_line": 3}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"resource_group_name\" {\n  type        = string\n  description = \"Name of the resource group to be imported.\"\n  nullable    = false\n}\n\nvariable \"vnet_location\" {\n  type        = string\n  description = \"The location of the vnet to create.\"\n  nullable    = false\n}\n\nvariable \"address_space\" {\n  type        = list(string)\n  default     = [\"10.0.0.0/16\"]\n  description = \"The address space that is used by the virtual network.\"\n}\n\nvariable \"bgp_community\" {\n  type        = string\n  default     = null\n  description = \"(Optional) The BGP community attribute in format `<as-number>:<community-value>`.\"\n}\n\nvariable \"ddos_protection_plan\" {\n  type = object({\n    enable = bool\n    id     = string\n  })\n  default     = null\n  description = \"The set of DDoS protection plan configuration\"\n}\n\n# If no values specified, this defaults to Azure DNS\nvariable \"dns_servers\" {\n  type        = list(string)\n  default     = []\n  description = \"The DNS servers to be used with vNet.\"\n}\n\nvariable \"enable_telemetry\" {\n  type        = bool\n  default     = true\n  description = <<DESCRIPTION\nThis variable controls whether or not telemetry is enabled for the module.\nFor more information see https://aka.ms/avm/telemetryinfo.\nIf it is set to false, then no telemetry will be collected.\nDESCRIPTION\n  nullable    = false\n}\n\nvariable \"nsg_ids\" {\n  type = map(string)\n  default = {\n  }\n  description = \"A map of subnet name to Network Security Group IDs\"\n}\n\nvariable \"route_tables_ids\" {\n  type        = map(string)\n  default     = {}\n  description = \"A map of subnet name to Route table ids\"\n}\n\nvariable \"subnet_delegation\" {\n  type        = map(map(any))\n  default     = {}\n  description = \"A map of subnet name to delegation block on the subnet\"\n}\n\nvariable \"subnet_enforce_private_link_endpoint_network_policies\" {\n  type        = map(bool)\n  default     = {}\n  description = \"A map of subnet name to enable/disable private link endpoint network policies on the subnet.\"\n}\n\nvariable \"subnet_enforce_private_link_service_network_policies\" {\n  type        = map(bool)\n  default     = {}\n  description = \"A map of subnet name to enable/disable private link service network policies on the subnet.\"\n}\n\nvariable \"subnet_names\" {\n  type        = list(string)\n  default     = [\"subnet1\", \"subnet2\", \"subnet3\"]\n  description = \"A list of public subnets inside the vNet.\"\n}\n\nvariable \"subnet_prefixes\" {\n  type        = list(string)\n  default     = [\"10.0.1.0/24\", \"10.0.2.0/24\", \"10.0.3.0/24\"]\n  description = \"The address prefix to use for the subnet.\"\n}\n\nvariable \"subnet_service_endpoints\" {\n  type        = map(any)\n  default     = {}\n  description = \"A map of subnet name to service endpoints to add to the subnet.\"\n}\n\nvariable \"tags\" {\n  type        = map(string)\n  default     = {}\n  description = \"The tags to associate with your network and subnets.\"\n}\n\n# tflint-ignore: terraform_unused_declarations\nvariable \"tracing_tags_enabled\" {\n  type        = bool\n  default     = false\n  description = \"Whether enable tracing tags that generated by BridgeCrew Yor.\"\n  nullable    = false\n}\n\n# tflint-ignore: terraform_unused_declarations\nvariable \"tracing_tags_prefix\" {\n  type        = string\n  default     = \"avm_\"\n  description = \"Default prefix for generated tracing tags\"\n  nullable    = false\n}\n\nvariable \"use_for_each\" {\n  type        = bool\n  default     = true\n  description = \"Use `for_each` instead of `count` to create multiple resource instances. Defaults to `true`.\"\n  nullable    = false\n}\n\nvariable \"vnet_name\" {\n  type        = string\n  default     = \"acctvnet\"\n  description = \"Name of the vnet to create\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform-azurerm-vnet__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nproviders \"aws\" {\n  region = \"us-east-1\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shubhamm45__Terraform__terraform-backend-configuration__sns-module__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"deployment\" {}\nvariable \"project_id\" {}\n\nprovider \"google\" {\n  project = var.project_id\n  region  = \"us-central1\"\n  zone    = \"us-central1-c\"\n}\n\nlocals{\n    DATASET = replace(format(\"%sdataset\", var.deployment), \"-\", \"_\")\n    TABLE = replace(format(\"%stable\", var.deployment), \"-\", \"_\")\n}\n\nresource \"google_bigquery_dataset\" \"default\" {\n  dataset_id = local.DATASET\n  labels = {\n    goog-dm = var.deployment\n  }\n}\n\nresource \"google_bigquery_table\" \"default\" {\n  dataset_id = google_bigquery_dataset.default.dataset_id\n  table_id   = local.TABLE\n  labels = {\n    goog-dm = var.deployment\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__deploymentmanager-samples__google__resource-snippets__bigquery-v2__alternatives__tf__bigquery.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_81", "severity": "HIGH", "message": "Ensure Big Query Datasets are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__deploymentmanager-samples__google__resource-snippets__bigquery-v2__alternatives__tf__bigquery.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_GCP_121", "severity": "HIGH", "message": "Ensure BigQuery tables have deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__deploymentmanager-samples__google__resource-snippets__bigquery-v2__alternatives__tf__bigquery.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_GCP_80", "severity": "HIGH", "message": "Ensure Big Query Tables are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__deploymentmanager-samples__google__resource-snippets__bigquery-v2__alternatives__tf__bigquery.tf", "start_line": 22}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_vpc\" \"vpc-default\" {\n  default = true\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__terraform-eks-code__c9net__data-defvpc.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"container\" {\n  source          = \"../../\"\n  container_name  = \"name\"\n  container_image = \"cloudposse/geodesic\"\n\n  map_environment = {\n    \"string_var\"        = \"I am a string\"\n    \"true_boolean_var\"  = true\n    \"false_boolean_var\" = false\n    \"integer_var\"       = 42\n  }\n}\n\noutput \"json\" {\n  description = \"Container definition in JSON format\"\n  value       = module.container.json_map_encoded_list\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-ecs-container-definition__examples__map_environment__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"vcenter_username\" {\n  description = \"Username used to authenticate against the vCenter Server\"\n  type        = string\n}\n\nvariable \"vcenter_password\" {\n  description = \"Password used to authenticate against the vCenter Server\"\n  type        = string\n}\n\nvariable \"vcenter_server\" {\n  description = \"FQDN or IP Address of the vCenter Server\"\n  type        = string\n}\n\nvariable \"hosts\" {\n  type = list(object({\n    hostname = string\n    password = string\n    username = string\n  }))\n}\n\nvariable \"nfs_host\" {\n  description = \"Hostname of the NFS server\"\n  type        = string\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vmware__terraform-provider-vsphere__tests__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ncontroller:\n  pod:\n    annotations:\n      status.kubernetes.io/restart-on-failure: {\"timeout\": \"30s\"}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-helm__examples__resources__release__example_10.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-helm__examples__resources__release__example_10.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-helm__examples__resources__release__example_10.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"identifier\" {\n  type        = string\n  description = \"Identifier for the database and related resources\"\n}\n\nvariable \"db_name\" {\n  type        = string\n  description = \"Name of the database\"\n  default     = \"postgres\"\n}\n\nvariable \"instance_type\" {\n  type        = string\n  description = \"Instance type\"\n  default     = \"db.t4g.large\" # 2 vCPU and 8 GB of memory\n}\n\nvariable \"storage_gb\" {\n  type        = number\n  description = \"Storage size in GB\"\n  default     = 20\n}\n\nvariable \"engine_version\" {\n  type        = string\n  description = \"Engine version\"\n  default     = \"17\"\n}\n\nvariable \"vpc_id\" {\n  type        = string\n  description = \"VPC ID\"\n}\n\nvariable \"subnet_ids\" {\n  type        = list(string)\n  description = \"Subnet IDs\"\n}\n\nvariable \"ingress_cidrs\" {\n  type        = list(string)\n  description = \"Ingress CIDR blocks\"\n}\n\nvariable \"username\" {\n  type        = string\n  description = \"Username for the database\"\n  default     = \"postgres\"\n  sensitive   = true\n}\n\nvariable \"password\" {\n  type        = string\n  description = \"Password for the database\"\n  default     = null\n  sensitive   = true\n}\n\nvariable \"tags\" {\n  type        = map(string)\n  description = \"Tags to apply to RDS resources\"\n  default     = {}\n}\n\nvariable \"enable_rds_iam_auth\" {\n  type        = bool\n  description = \"Enable AWS IAM database authentication for this RDS instance\"\n  default     = false\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/onyx-dot-app__onyx__deployment__terraform__modules__aws__postgres__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# SHOW AN EXAMPLE OF USING FOR_EACH EXPRESSIONS TO SET TAGS IN AN AUTO SCALING GROUP (ASG)\n# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\nterraform {\n  # This module is now only being tested with Terraform 1.1.x. However, to make upgrading easier, we are setting 1.0.0 as the minimum version.\n  required_version = \">= 1.0.0\"\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"< 4.0\"\n    }\n  }\n}\n\n# ------------------------------------------------------------------------------\n# CONFIGURE OUR AWS CONNECTION\n# ------------------------------------------------------------------------------\n\nprovider \"aws\" {\n  region = \"us-east-2\"\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# GET THE LIST OF AVAILABILITY ZONES IN THE CURRENT REGION\n# Every AWS accout has slightly different availability zones in each region. For example, one account might have\n# us-east-1a, us-east-1b, and us-east-1c, while another will have us-east-1a, us-east-1b, and us-east-1d. This resource\n# queries AWS to fetch the list for the current account and region.\n# ---------------------------------------------------------------------------------------------------------------------\n\ndata \"aws_availability_zones\" \"all\" {}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE THE AUTO SCALING GROUP\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_autoscaling_group\" \"example\" {\n  launch_configuration = aws_launch_configuration.example.id\n  availability_zones   = data.aws_availability_zones.all.names\n\n  min_size = 2\n  max_size = 2\n\n  # Use for_each to loop over var.custom_tags\n  dynamic \"tag\" {\n    for_each = var.custom_tags\n    content {\n      key                 = tag.key\n      value               = tag.value\n      propagate_at_launch = true\n    }\n  }\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE A LAUNCH CONFIGURATION THAT DEFINES EACH EC2 INSTANCE IN THE ASG\n# To keep this example simple, the Instances are just Ubuntu servers that don't do anything.\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_launch_configuration\" \"example\" {\n  # Ubuntu Server 18.04 LTS (HVM), SSD Volume Type in us-east-2\n  image_id      = \"ami-0c55b159cbfafe1f0\"\n  instance_type = \"t2.micro\"\n\n  # Whenever using a launch configuration with an auto scaling group, you must set create_before_destroy = true.\n  # https://www.terraform.io/docs/providers/aws/r/launch_configuration.html\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__loops-with-for-each__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_315", "severity": "HIGH", "message": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__loops-with-for-each__main.tf", "start_line": 38}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__loops-with-for-each__main.tf", "start_line": 61}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__loops-with-for-each__main.tf", "start_line": 61}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 0.13\"\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"~> 3.11.0\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"~> 3.1.0\"\n    }\n  }\n}\n\nprovider \"azurerm\" {\n  features {}\n}\n\n\nvariable \"resource_group\" {\n  default = \"azuregoat_app\"\n}\n\nvariable \"location\" {\n  type = string\n  default = \"eastus\"\n}\n \n\nresource \"azurerm_cosmosdb_account\" \"db\" {\n  name                = \"ine-cosmos-db-data-${random_id.randomId.dec}\"\n  location            = \"eastus\"\n  resource_group_name = var.resource_group\n  offer_type          = \"Standard\"\n  kind                = \"GlobalDocumentDB\"\n\n  consistency_policy {\n    consistency_level       = \"BoundedStaleness\"\n    max_interval_in_seconds = 300\n    max_staleness_prefix    = 100000\n  }\n\n  capabilities {\n    name = \"EnableServerless\"\n  }\n\n  geo_location {\n    location          = \"eastus\"\n    failover_priority = 0\n  }\n}\n\nresource \"null_resource\" \"file_populate_data\" {\n  provisioner \"local-exec\" {\n    command     = <<EOF\nsed -i 's/AZURE_FUNCTION_URL/${azurerm_storage_account.storage_account.name}\\.blob\\.core\\.windows\\.net\\/${azurerm_storage_container.storage_container_prod.name}/g' modules/module-1/resources/cosmosdb/blog-posts.json\npython3 -m venv azure-goat-environment\nsource azure-goat-environment/bin/activate\npip3 install --pre azure-cosmos\npython3 modules/module-1/resources/cosmosdb/create-table.py\nEOF\n    interpreter = [\"/bin/bash\", \"-c\"]\n  }\n  depends_on = [azurerm_cosmosdb_account.db,azurerm_storage_account.storage_account,azurerm_storage_container.storage_container]\n}\n\n\n\n\nresource \"azurerm_storage_account\" \"storage_account\" {\n  name = \"appazgoat${random_id.randomId.dec}storage\"\n  resource_group_name = var.resource_group\n  location = var.location\n  account_tier = \"Standard\"\n  account_replication_type = \"LRS\"\n  allow_nested_items_to_be_public = true\n\n  blob_properties{\n    cors_rule{\n        allowed_headers = [\"*\"]\n        allowed_methods = [\"GET\",\"HEAD\",\"POST\",\"PUT\"]\n        allowed_origins = [\"*\"]\n        exposed_headers = [\"*\"]\n        max_age_in_seconds = 3600\n        }\n    }\n}\n\nresource \"azurerm_storage_container\" \"storage_container\" {\n    name = \"appazgoat${random_id.randomId.dec}-storage-container\"\n    storage_account_name = azurerm_storage_account.storage_account.name\n    container_access_type = \"blob\"\n}\n\nlocals {\n  now = timestamp()\n  sasExpiry = timeadd(local.now, \"240h\")\n  date_now = formatdate(\"YYYY-MM-DD\", local.now)\n  date_br = formatdate(\"YYYY-MM-DD\", local.sasExpiry)\n}\ndata \"azurerm_storage_account_blob_container_sas\" \"storage_account_blob_container_sas\" {\n  connection_string = azurerm_storage_account.storage_account.primary_connection_string\n  container_name    = azurerm_storage_container.storage_container.name\n  start  = \"${local.date_now}\"\n  expiry = \"${local.date_br}\"\n  permissions {\n    read   = true\n    add    = true\n    create = true\n    write  = true\n    delete = false\n    list   = false\n  }\n}\n\n\nresource \"null_resource\" \"env_replace\" {\n  provisioner \"local-exec\" {\n    command     = <<EOF\npwd\nsed -i 's`AZ_DB_PRIMARYKEY_REPLACE`${azurerm_cosmosdb_account.db.primary_key}`' modules/module-1/resources/azure_function/data/local.settings.json\nsed -i 's`AZ_DB_ENDPOINT_REPLACE`${azurerm_cosmosdb_account.db.endpoint}`' modules/module-1/resources/azure_function/data/local.settings.json\nsed -i 's`CON_STR_REPLACE`${azurerm_storage_account.storage_account.primary_connection_string}`' modules/module-1/resources/azure_function/data/local.settings.json\nsed -i 's`CONTAINER_NAME_REPLACE`${azurerm_storage_container.storage_container.name}`' modules/module-1/resources/azure_function/data/local.settings.json\n\nEOF\n    interpreter = [\"/bin/bash\", \"-c\"]\n  }\n  depends_on = [azurerm_cosmosdb_account.db,azurerm_storage_account.storage_account,azurerm_storage_container.storage_container]\n}\n\n\ndata \"archive_file\" \"file_function_app\" {\n  type        = \"zip\"\n  source_dir  = \"modules/module-1/resources/azure_function/data\"\n  output_path = \"modules/module-1/resources/azure_function/data/data-api.zip\"\n  depends_on = [\n    null_resource.env_replace\n  ]\n}\n\nresource \"azurerm_storage_blob\" \"storage_blob\" {\n  name = \"modules/module-1/resources/azure_function/data/data-api.zip\"\n  storage_account_name = azurerm_storage_account.storage_account.name\n  storage_container_name = azurerm_storage_container.storage_container.name\n  type = \"Block\"\n  source = \"modules/module-1/resources/azure_function/data/data-api.zip\"\n  depends_on = [data.archive_file.file_function_app]\n}\n\n\nresource \"azurerm_app_service_plan\" \"app_service_plan\" {\n  name                = \"appazgoat${random_id.randomId.dec}-app-service-plan\"\n  resource_group_name = var.resource_group\n  location            = var.location\n  kind                = \"FunctionApp\"\n  reserved            = true\n  sku {\n    tier = \"Dynamic\"\n    size = \"Y1\"\n  }\n}\n\nresource \"azurerm_function_app\" \"function_app\" {\n  name                       = \"appazgoat${random_id.randomId.dec}-function\"\n  resource_group_name        = var.resource_group\n  location                   = var.location\n  app_service_plan_id        = azurerm_app_service_plan.app_service_plan.id\n  app_settings = {\n    \"WEBSITE_RUN_FROM_PACKAGE\"    = \"https://${azurerm_storage_account.storage_account.name}.blob.core.windows.net/${azurerm_storage_container.storage_container.name}/${azurerm_storage_blob.storage_blob.name}${data.azurerm_storage_account_blob_container_sas.storage_account_blob_container_sas.sas}\",\n    FUNCTIONS_WORKER_RUNTIME = \"python\",\n    \"JWT_SECRET\" = \"T2BYL6#]zc>Byuzu\",\n    \"AZ_DB_ENDPOINT\" = \"${azurerm_cosmosdb_account.db.endpoint}\",\n    \"AZ_DB_PRIMARYKEY\" = \"${azurerm_cosmosdb_account.db.primary_key}\",\n    \"CON_STR\" = \"${azurerm_storage_account.storage_account.primary_connection_string}\"\n    \"CONTAINER_NAME\" = \"${azurerm_storage_container.storage_container.name}\"\n  }\n  os_type = \"linux\"\n  site_config {\n    linux_fx_version = \"python|3.9\"\n    use_32_bit_worker_process = false\n    cors {\n      allowed_origins = [\"*\"]\n    }\n  }\n  storage_account_name       = azurerm_storage_account.storage_account.name\n  storage_account_access_key = azurerm_storage_account.storage_account.primary_access_key\n  version                    = \"~3\"\n  depends_on = [azurerm_cosmosdb_account.db,azurerm_storage_account.storage_account,null_resource.env_replace]\n}\n\n\n# Generate random text for a unique storage account name\nresource \"random_id\" \"randomId\" {\n  keepers = {\n    # Generate a new ID only when a new resource group is defined\n    resource_group_name = var.resource_group\n  }\n\n  byte_length = 3\n}\n\n\n\n# Storage Accounts Config\n#################################################################################\nlocals {\n  mime_types = {\n    \"css\"  = \"text/css\"\n    \"html\" = \"text/html\"\n    \"ico\"  = \"image/vnd.microsoft.icon\"\n    \"js\"   = \"application/javascript\"\n    \"json\" = \"application/json\"\n    \"map\"  = \"application/json\"\n    \"png\"  = \"image/png\"\n    \"jpg\"  = \"image/jpeg\"\n    \"svg\"  = \"image/svg+xml\"\n    \"txt\"  = \"text/plain\"\n    \"pub\"  = \"text/plain\"\n    \"pem\"  = \"text/plain\"\n    \"sh\" = \"text/x-shellscript\"\n  }\n}\n\n\nresource \"azurerm_storage_container\" \"storage_container_prod\" {\n  name                  = \"prod-appazgoat${random_id.randomId.dec}-storage-container\"\n  storage_account_name  = azurerm_storage_account.storage_account.name\n  container_access_type = \"blob\"\n}\n\n\nresource \"azurerm_storage_container\" \"storage_container_dev\" {\n  name                  = \"dev-appazgoat${random_id.randomId.dec}-storage-container\"\n  storage_account_name  = azurerm_storage_account.storage_account.name\n  container_access_type = \"container\"\n}\n\nresource \"azurerm_storage_container\" \"storage_container_vm\" {\n  name                  = \"vm-appazgoat${random_id.randomId.dec}-storage-container\"\n  storage_account_name  = azurerm_storage_account.storage_account.name\n  container_access_type = \"container\"\n}\n\n\n\nresource \"null_resource\" \"file_replacement_upload\" {\n  provisioner \"local-exec\" {\n    command     = <<EOF\npwd\nsed -i 's/=\"\\//=\"https:\\/\\/${azurerm_storage_account.storage_account.name}\\.blob\\.core\\.windows\\.net\\/${azurerm_storage_container.storage_container_prod.name}\\/webfiles\\/build\\//g' modules/module-1/resources/azure_function/react/webapp/index.html\nsed -i 's/\"\\/static/\"https:\\/\\/${azurerm_storage_account.storage_account.name}\\.blob\\.core\\.windows\\.net\\/${azurerm_storage_container.storage_container_prod.name}\\/webfiles\\/build\\/static/g' modules/module-1/resources/storage_account/webfiles/build/static/js/main.adc6b28e.js\nsed -i 's/\"\\/static/\"https:\\/\\/${azurerm_storage_account.storage_account.name}\\.blob\\.core\\.windows\\.net\\/${azurerm_storage_container.storage_container_prod.name}\\/webfiles\\/build\\/static/g' modules/module-1/resources/storage_account/webfiles/build/static/js/main.adc6b28e.js\nsed -i 's/n.p+\"static/\"https:\\/\\/${azurerm_storage_account.storage_account.name}\\.blob\\.core\\.windows\\.net\\/${azurerm_storage_container.storage_container_prod.name}\\/webfiles\\/build\\/static/g' modules/module-1/resources/storage_account/webfiles/build/static/js/main.adc6b28e.js\nsed -i \"s,AZURE_FUNCTION_URL,https:\\/\\/${azurerm_function_app.function_app.default_hostname},g\" modules/module-1/resources/storage_account/webfiles/build/static/js/main.adc6b28e.js\nEOF \n    interpreter = [\"/bin/bash\", \"-c\"]\n  }\n  depends_on = [data.azurerm_storage_account_blob_container_sas.storage_account_blob_container_sas,azurerm_storage_container.storage_container,azurerm_storage_account.storage_account]\n}\n\nresource \"azurerm_storage_blob\" \"app_files_prod\" {\n  for_each               = fileset(\"./modules/module-1/resources/storage_account/\", \"**\")\n  name                   = each.value\n  storage_account_name   = azurerm_storage_account.storage_account.name\n  storage_container_name = azurerm_storage_container.storage_container_prod.name\n  content_type           = lookup(tomap(local.mime_types), element(split(\".\", each.value), length(split(\".\", each.value)) - 1))\n  type                   = \"Block\"\n  source                 = \"./modules/module-1/resources/storage_account/${each.value}\"\n  depends_on = [null_resource.file_replacement_upload,azurerm_storage_container.storage_container_prod]\n}\n\nresource \"azurerm_storage_blob\" \"app_files_dev\" {\n  for_each               = fileset(\"./modules/module-1/resources/storage_account/\", \"**\")\n  name                   = each.value\n  storage_account_name   = azurerm_storage_account.storage_account.name\n  storage_container_name = azurerm_storage_container.storage_container_dev.name\n  content_type           = lookup(tomap(local.mime_types), element(split(\".\", each.value), length(split(\".\", each.value)) - 1))\n  type                   = \"Block\"\n  source                 = \"./modules/module-1/resources/storage_account/${each.value}\"\n  depends_on = [null_resource.file_replacement_upload,azurerm_storage_container.storage_container_dev]\n}\n\n\n\nresource \"azurerm_storage_blob\" \"app_files_vm\" {\n  for_each               = fileset(\"./modules/module-1/resources/storage_account/\", \"**\")\n  name                   = each.value\n  storage_account_name   = azurerm_storage_account.storage_account.name\n  storage_container_name = azurerm_storage_container.storage_container_vm.name\n  content_type           = lookup(tomap(local.mime_types), element(split(\".\", each.value), length(split(\".\", each.value)) - 1))\n  type                   = \"Block\"\n  source                 = \"./modules/module-1/resources/storage_account/${each.value}\"\n  depends_on = [null_resource.file_replacement_upload,azurerm_storage_container.storage_container_vm]\n}\n\n\n\n\n# VM Config\n#################################################################################\n# Security group\nresource \"azurerm_network_security_group\" \"net_sg\" {\n  name                = \"SecGroupNet${random_id.randomId.dec}\"\n  location            = var.location\n  resource_group_name = var.resource_group\n\n  security_rule {\n    name                       = \"SSH\"\n    priority                   = 1000\n    direction                  = \"Inbound\"\n    access                     = \"Allow\"\n    protocol                   = \"Tcp\"\n    source_port_range          = \"*\"\n    destination_port_range     = \"22\"\n    source_address_prefix      = \"*\"\n    destination_address_prefix = \"*\"\n  }\n}\n\n\n# Virtual network\nresource \"azurerm_virtual_network\" \"vNet\" {\n  name                = \"vNet${random_id.randomId.dec}\"\n  address_space       = [\"10.1.0.0/16\"]\n  location            = var.location\n  resource_group_name = var.resource_group\n}\nresource \"azurerm_subnet\" \"vNet_subnet\" {\n  name                 = \"Subnet${random_id.randomId.dec}\"\n  resource_group_name  = var.resource_group\n  virtual_network_name = azurerm_virtual_network.vNet.name\n  address_prefixes     = [\"10.1.0.0/24\"]\n  depends_on = [\n    azurerm_virtual_network.vNet\n  ]\n}\n\n#public ip\nresource \"azurerm_public_ip\" \"VM_PublicIP\" {\n  name                    = \"developerVMPublicIP${random_id.randomId.dec}\"\n  resource_group_name     = var.resource_group\n  location                = var.location\n  allocation_method       = \"Dynamic\"\n  idle_timeout_in_minutes = 4\n  domain_name_label       = lower(\"developervm-${random_id.randomId.dec}\")\n  sku                     = \"Basic\"\n}\ndata \"azurerm_public_ip\" \"vm_ip\" {\n  name                = azurerm_public_ip.VM_PublicIP.name\n  resource_group_name = var.resource_group\n  depends_on          = [azurerm_virtual_machine.dev-vm]\n}\n#Network interface\nresource \"azurerm_network_interface\" \"net_int\" {\n  name                = \"developerVMNetInt\"\n  location            = var.location\n  resource_group_name = var.resource_group\n\n  ip_configuration {\n    name                          = \"ipconfig1\"\n    subnet_id                     = azurerm_subnet.vNet_subnet.id\n    private_ip_address_allocation = \"Dynamic\"\n    public_ip_address_id          = azurerm_public_ip.VM_PublicIP.id\n  }\n  depends_on = [\n    azurerm_network_security_group.net_sg,\n    azurerm_public_ip.VM_PublicIP,\n    azurerm_subnet.vNet_subnet\n  ]\n}\n\n#Network Interface SG allocation\nresource \"azurerm_network_interface_security_group_association\" \"example\" {\n  network_interface_id      = azurerm_network_interface.net_int.id\n  network_security_group_id = azurerm_network_security_group.net_sg.id\n}\n\n\n#Virtual Machine\nresource \"azurerm_virtual_machine\" \"dev-vm\" {\n\n  name                  = \"developerVM${random_id.randomId.dec}\"\n  location              = var.location\n  resource_group_name   = var.resource_group\n  network_interface_ids = [azurerm_network_interface.net_int.id]\n\n\n  vm_size = \"Standard_B1s\"\n\n  delete_os_disk_on_termination = true\n\n  delete_data_disks_on_termination = true\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n  storage_image_reference {\n    publisher = \"Canonical\"\n    offer     = \"UbuntuServer\"\n    sku       = \"18.04-LTS\"\n    version   = \"latest\"\n  }\n  storage_os_disk {\n    name              = \"developerVMDisk\"\n    create_option     = \"FromImage\"\n    managed_disk_type = \"Standard_LRS\"\n  }\n  os_profile {\n    computer_name  = \"developerVM\"\n    admin_username = \"azureuser\"\n    admin_password = \"St0r95p@$sw0rd@1265463541\"\n  }\n  os_profile_linux_config {\n    disable_password_authentication = false\n  }\n  depends_on = [\n    azurerm_network_interface.net_int\n  ]\n\n}\n\nresource \"azurerm_virtual_machine_extension\" \"test\" {\n  name                 = \"vm-extension\"\n  virtual_machine_id   = azurerm_virtual_machine.dev-vm.id\n  publisher            = \"Microsoft.Azure.Extensions\"\n  type                 = \"CustomScript\"\n  type_handler_version = \"2.0\"\n\n  settings = <<SETTINGS\n    {\n        \"script\": \"${base64encode(templatefile(\"modules/module-1/resources/vm/config.sh\", {\n          URL=\"${azurerm_storage_account.storage_account.name}.blob.core.windows.net/${azurerm_storage_container.storage_container_prod.name}\"\n        }))}\"\n    }\nSETTINGS\ndepends_on = [null_resource.file_replacement_upload,azurerm_storage_blob.app_files_prod]\n}\n\n#Role Assignment\n\ndata \"azurerm_subscription\" \"primary\" {\n}\n\ndata \"azurerm_client_config\" \"example\" {\n}\n\nresource \"azurerm_role_assignment\" \"az_role_assgn_vm\" {\n  scope              = \"${data.azurerm_subscription.primary.id}/resourceGroups/${var.resource_group}\"\n  role_definition_name = \"Contributor\"\n  principal_id       = azurerm_virtual_machine.dev-vm.identity.0.principal_id\n}\n\nresource \"azurerm_role_assignment\" \"az_role_assgn_identity\" {\n  scope              = \"${data.azurerm_subscription.primary.id}/resourceGroups/${var.resource_group}\"\n  role_definition_name = \"Owner\"\n  principal_id       = azurerm_user_assigned_identity.user_id.principal_id\n  depends_on = [\n    azurerm_user_assigned_identity.user_id\n  ]\n}\n\n\nresource \"azurerm_user_assigned_identity\" \"user_id\" {\n  resource_group_name = var.resource_group\n  location              = var.location\n\n  name = \"user-assigned-id${random_id.randomId.dec}\"\n}\n\nresource \"azurerm_automation_account\" \"dev_automation_account_test\" {\n  name                = \"dev-automation-account-appazgoat${random_id.randomId.dec}\"\n  location              = var.location\n  resource_group_name = var.resource_group\n  sku_name            = \"Basic\"\n    identity {\n    type = \"UserAssigned\"\n    identity_ids = [azurerm_user_assigned_identity.user_id.id]\n  }\n\n  tags = {\n    environment = \"development\"\n  }\n}\n\ndata \"local_file\" \"runbook_file\" {\n  filename = \"modules/module-1/resources/vm/listVM.ps1\"\ndepends_on = [\n  null_resource.clientid_replacement\n]\n}\nresource \"null_resource\" \"clientid_replacement\" {\n    provisioner \"local-exec\" {\n    command     = <<EOF\nsed -i 's/REPLACE_CLIENT_ID/${azurerm_user_assigned_identity.user_id.client_id}/g' modules/module-1/resources/vm/listVM.ps1\nsed -i 's/REPLACE_RESOURCE_GROUP_NAME/${var.resource_group}/g' modules/module-1/resources/vm/listVM.ps1\nEOF\n    interpreter = [\"/bin/bash\", \"-c\"]\n  }\n}\n\nresource \"azurerm_automation_runbook\" \"dev_automation_runbook\" {\n  name                    = \"Get-AzureVM\"\n  location              = var.location\n  resource_group_name     = var.resource_group\n  automation_account_name = azurerm_automation_account.dev_automation_account_test.name\n  log_verbose             = \"true\"\n  log_progress            = \"true\"\n  description             = \"This is an example runbook\"\n  runbook_type            = \"PowerShellWorkflow\"\n  content = data.local_file.runbook_file.content\n}\n\n\n###########################frontend########################################\n\ndata \"archive_file\" \"file_function_app_front\" {\n  type        = \"zip\"\n  source_dir  = \"modules/module-1/resources/azure_function/react\"\n  output_path = \"modules/module-1/resources/azure_function/react/func.zip\"\n  depends_on = [null_resource.file_replacement_upload]\n}\n\nresource \"azurerm_storage_blob\" \"storage_blob_front\" {\n  name = \"modules/module-1/resources/azure_function/react/func.zip\"\n  storage_account_name = azurerm_storage_account.storage_account.name\n  storage_container_name = azurerm_storage_container.storage_container.name\n  type = \"Block\"\n  source = \"modules/module-1/resources/azure_function/react/func.zip\"\n  depends_on = [data.archive_file.file_function_app_front,azurerm_storage_container.storage_container]\n}\n\n\nresource \"azurerm_function_app\" \"function_app_front\" {\n  name                       = \"appazgoat${random_id.randomId.dec}-function-app\"\n  resource_group_name        = var.resource_group\n  location                   = var.location\n  app_service_plan_id        = azurerm_app_service_plan.app_service_plan.id\n  app_settings = {\n    \"WEBSITE_RUN_FROM_PACKAGE\"    = \"https://${azurerm_storage_account.storage_account.name}.blob.core.windows.net/${azurerm_storage_container.storage_container.name}/${azurerm_storage_blob.storage_blob_front.name}${data.azurerm_storage_account_blob_container_sas.storage_account_blob_container_sas.sas}\",\n    FUNCTIONS_WORKER_RUNTIME = \"node\",\n    \"AzureWebJobsDisableHomepage\" = \"true\",\n  }\n  os_type = \"linux\"\n  site_config {\n    linux_fx_version = \"node|12\"\n    use_32_bit_worker_process = false\n  }\n  storage_account_name       = azurerm_storage_account.storage_account.name\n  storage_account_access_key = azurerm_storage_account.storage_account.primary_access_key\n  version                    = \"~3\"\n  depends_on = [null_resource.file_replacement_upload]\n}\n\nresource \"null_resource\" \"file_replacement_vm_ip\" {\n  provisioner \"local-exec\" {\n    command     = \"sed -i 's/VM_IP_ADDR/${data.azurerm_public_ip.vm_ip.ip_address}/g' modules/module-1/resources/storage_account/shared/files/.ssh/config.txt\"\n    interpreter = [\"/bin/bash\", \"-c\"]\n  }\n  depends_on = [azurerm_virtual_machine.dev-vm,data.azurerm_public_ip.vm_ip]\n}\nresource \"azurerm_storage_blob\" \"config_update_prod\" {\n  name                   = \"modules/module-1/resources/storage_account/shared/files/.ssh/config.txt\"\n  storage_account_name   = azurerm_storage_account.storage_account.name\n  storage_container_name = azurerm_storage_container.storage_container_prod.name\n  type                   = \"Block\"\n  source                 = \"modules/module-1/resources/storage_account/shared/files/.ssh/config.txt\"\n  depends_on = [null_resource.file_replacement_vm_ip]\n}\n\nresource \"azurerm_storage_blob\" \"config_update_dev\" {\n  name                   = \"modules/module-1/resources/storage_account/shared/files/.ssh/config.txt\"\n  storage_account_name   = azurerm_storage_account.storage_account.name\n  storage_container_name = azurerm_storage_container.storage_container_dev.name\n  type                   = \"Block\"\n  source                 = \"modules/module-1/resources/storage_account/shared/files/.ssh/config.txt\"\n  depends_on = [null_resource.file_replacement_vm_ip]\n}\n\nresource \"azurerm_storage_blob\" \"config_update_vm\" {\n  name                   = \"modules/module-1/resources/storage_account/shared/files/.ssh/config.txt\"\n  storage_account_name   = azurerm_storage_account.storage_account.name\n  storage_container_name = azurerm_storage_container.storage_container_vm.name\n  type                   = \"Block\"\n  source                 = \"modules/module-1/resources/storage_account/shared/files/.ssh/config.txt\"\n  depends_on = [null_resource.file_replacement_vm_ip]\n}\n  \noutput \"Target_URL\"{\n  value = \"https://${azurerm_function_app.function_app_front.name}.azurewebsites.net\"\n}\n    \n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_99", "severity": "HIGH", "message": "Ensure Cosmos DB accounts have restricted access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_132", "severity": "HIGH", "message": "Ensure cosmosdb does not allow privileged escalation by restricting management plane changes", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_101", "severity": "HIGH", "message": "Ensure that Azure Cosmos DB disables public network access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_100", "severity": "HIGH", "message": "Ensure that Cosmos DB accounts have customer-managed keys to encrypt data at rest", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_140", "severity": "HIGH", "message": "Ensure that Local Authentication is disabled on CosmosDB", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_59", "severity": "HIGH", "message": "Ensure that Storage accounts disallow public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 70}, {"tool": "checkov", "rule_id": "CKV_AZURE_33", "severity": "HIGH", "message": "Ensure Storage logging is enabled for Queue service for read, write and delete requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 70}, {"tool": "checkov", "rule_id": "CKV_AZURE_44", "severity": "HIGH", "message": "Ensure Storage Account is using the latest version of TLS encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 70}, {"tool": "checkov", "rule_id": "CKV_AZURE_206", "severity": "HIGH", "message": "Ensure that Storage Accounts use replication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 70}, {"tool": "checkov", "rule_id": "CKV_AZURE_190", "severity": "HIGH", "message": "Ensure that Storage blobs restrict public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 70}, {"tool": "checkov", "rule_id": "CKV_AZURE_34", "severity": "HIGH", "message": "Ensure that 'Public access level' is set to Private for blob containers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 89}, {"tool": "checkov", "rule_id": "CKV_AZURE_62", "severity": "HIGH", "message": "Ensure function apps are not accessible from all regions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 164}, {"tool": "checkov", "rule_id": "CKV_AZURE_67", "severity": "HIGH", "message": "Ensure that 'HTTP Version' is the latest, if used to run the Function app", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 164}, {"tool": "checkov", "rule_id": "CKV_AZURE_70", "severity": "HIGH", "message": "Ensure that Function apps is only accessible over HTTPS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 164}, {"tool": "checkov", "rule_id": "CKV_AZURE_56", "severity": "HIGH", "message": "Ensure that function apps enables Authentication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 164}, {"tool": "checkov", "rule_id": "CKV_AZURE_34", "severity": "HIGH", "message": "Ensure that 'Public access level' is set to Private for blob containers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 226}, {"tool": "checkov", "rule_id": "CKV_AZURE_34", "severity": "HIGH", "message": "Ensure that 'Public access level' is set to Private for blob containers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 233}, {"tool": "checkov", "rule_id": "CKV_AZURE_34", "severity": "HIGH", "message": "Ensure that 'Public access level' is set to Private for blob containers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 239}, {"tool": "checkov", "rule_id": "CKV_AZURE_10", "severity": "HIGH", "message": "Ensure that SSH access is restricted from the internet", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 303}, {"tool": "checkov", "rule_id": "CKV_AZURE_1", "severity": "HIGH", "message": "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 381}, {"tool": "checkov", "rule_id": "CKV_AZURE_67", "severity": "HIGH", "message": "Ensure that 'HTTP Version' is the latest, if used to run the Function app", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 534}, {"tool": "checkov", "rule_id": "CKV_AZURE_70", "severity": "HIGH", "message": "Ensure that Function apps is only accessible over HTTPS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 534}, {"tool": "checkov", "rule_id": "CKV_AZURE_56", "severity": "HIGH", "message": "Ensure that function apps enables Authentication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 534}, {"tool": "checkov", "rule_id": "CKV_AZURE_119", "severity": "HIGH", "message": "Ensure that Network Interfaces don't use public IPs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 355}, {"tool": "checkov", "rule_id": "CKV2_AZURE_40", "severity": "CRITICAL", "message": "Ensure storage account is not configured with Shared Key authorization", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 70}, {"tool": "checkov", "rule_id": "CKV2_AZURE_47", "severity": "CRITICAL", "message": "Ensure storage account is configured without blob anonymous access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 70}, {"tool": "checkov", "rule_id": "CKV2_AZURE_33", "severity": "CRITICAL", "message": "Ensure storage account is configured with private endpoint", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 70}, {"tool": "checkov", "rule_id": "CKV2_AZURE_41", "severity": "CRITICAL", "message": "Ensure storage account is configured with SAS expiration policy", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 70}, {"tool": "checkov", "rule_id": "CKV2_AZURE_38", "severity": "CRITICAL", "message": "Ensure soft-delete is enabled on Azure storage account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 70}, {"tool": "checkov", "rule_id": "CKV2_AZURE_24", "severity": "CRITICAL", "message": "Ensure Azure automation account does NOT have overly permissive network access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 471}, {"tool": "checkov", "rule_id": "CKV2_AZURE_12", "severity": "CRITICAL", "message": "Ensure that virtual machines are backed up using Azure Backup", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 381}, {"tool": "checkov", "rule_id": "CKV2_AZURE_1", "severity": "CRITICAL", "message": "Ensure storage for critical data are encrypted with Customer Managed Key", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 70}, {"tool": "checkov", "rule_id": "CKV2_AZURE_21", "severity": "CRITICAL", "message": "Ensure Storage logging is enabled for Blob service for read requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 233}, {"tool": "checkov", "rule_id": "CKV2_AZURE_21", "severity": "CRITICAL", "message": "Ensure Storage logging is enabled for Blob service for read requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 239}, {"tool": "checkov", "rule_id": "CKV2_AZURE_21", "severity": "CRITICAL", "message": "Ensure Storage logging is enabled for Blob service for read requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 89}, {"tool": "checkov", "rule_id": "CKV2_AZURE_21", "severity": "CRITICAL", "message": "Ensure Storage logging is enabled for Blob service for read requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 226}, {"tool": "checkov", "rule_id": "CKV2_AZURE_10", "severity": "CRITICAL", "message": "Ensure that Microsoft Antimalware is configured to automatically updates for Virtual Machines", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AzureGoat__main.tf", "start_line": 381}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ---------------------------------------------------------------------------------------------------------------------\n# DEPLOY A VAULT SERVER CLUSTER, AN ELB, AND A CONSUL SERVER CLUSTER IN AWS\n# This is an example of how to use the vault-cluster and vault-elb modules to deploy a Vault cluster in AWS with an\n# Elastic Load Balancer (ELB) in front of it. This cluster uses Consul, running in a separate cluster, as its storage\n# backend.\n# ---------------------------------------------------------------------------------------------------------------------\n\n# ----------------------------------------------------------------------------------------------------------------------\n# REQUIRE A SPECIFIC TERRAFORM VERSION OR HIGHER\n# ----------------------------------------------------------------------------------------------------------------------\nterraform {\n  # This module is now only being tested with Terraform 1.0.x. However, to make upgrading easier, we are setting\n  # 0.12.26 as the minimum version, as that version added support for required_providers with source URLs, making it\n  # forwards compatible with 1.0.x code.\n  required_version = \">= 0.12.26\"\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# AUTOMATICALLY LOOK UP THE LATEST PRE-BUILT AMI\n# This repo contains a CircleCI job that automatically builds and publishes the latest AMI by building the Packer\n# template at /examples/vault-consul-ami upon every new release. The Terraform data source below automatically looks up\n# the latest AMI so that a simple \"terraform apply\" will just work without the user needing to manually build an AMI and\n# fill in the right value.\n#\n# !! WARNING !! These example AMIs are meant only convenience when initially testing this repo. Do NOT use these example\n# AMIs in a production setting as those TLS certificate files are publicly available from the Module repo containing\n# this code.\n#\n# NOTE: This Terraform data source must return at least one AMI result or the entire template will fail. See\n# /_ci/publish-amis-in-new-account.md for more information.\n# ---------------------------------------------------------------------------------------------------------------------\ndata \"aws_ami\" \"vault_consul\" {\n  most_recent = true\n\n  # If we change the AWS Account in which test are run, update this value.\n  owners = [\"562637147889\"]\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  filter {\n    name   = \"is-public\"\n    values = [\"true\"]\n  }\n\n  filter {\n    name   = \"name\"\n    values = [\"vault-consul-ubuntu-*\"]\n  }\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# DEPLOY THE VAULT SERVER CLUSTER\n# ---------------------------------------------------------------------------------------------------------------------\n\nmodule \"vault_cluster\" {\n  # When using these modules in your own templates, you will need to use a Git URL with a ref attribute that pins you\n  # to a specific version of the modules, such as the following example:\n  # source = \"github.com/hashicorp/terraform-aws-vault//modules/vault-cluster?ref=v0.0.1\"\n  source = \"./modules/vault-cluster\"\n\n  cluster_name  = var.vault_cluster_name\n  cluster_size  = var.vault_cluster_size\n  instance_type = var.vault_instance_type\n\n  ami_id    = var.ami_id == null ? data.aws_ami.vault_consul.image_id : var.ami_id\n  user_data = data.template_file.user_data_vault_cluster.rendered\n\n  vpc_id     = data.aws_vpc.default.id\n  subnet_ids = data.aws_subnet_ids.default.ids\n\n  # Do NOT use the ELB for the ASG health check, or the ASG will assume all sealed instances are unhealthy and\n  # repeatedly try to redeploy them.\n  health_check_type = \"EC2\"\n\n  # To make testing easier, we allow requests from any IP address here but in a production deployment, we *strongly*\n  # recommend you limit this to the IP address ranges of known, trusted servers inside your VPC.\n\n  allowed_ssh_cidr_blocks              = [\"0.0.0.0/0\"]\n  allowed_inbound_cidr_blocks          = [\"0.0.0.0/0\"]\n  allowed_inbound_security_group_ids   = []\n  allowed_inbound_security_group_count = 0\n  ssh_key_name                         = var.ssh_key_name\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# ATTACH IAM POLICIES FOR CONSUL\n# To allow our Vault servers to automatically discover the Consul servers, we need to give them the IAM permissions from\n# the Consul AWS Module's consul-iam-policies module.\n# ---------------------------------------------------------------------------------------------------------------------\n\nmodule \"consul_iam_policies_servers\" {\n  source = \"github.com/hashicorp/terraform-aws-consul.git//modules/consul-iam-policies?ref=v0.8.0\"\n\n  iam_role_id = module.vault_cluster.iam_role_id\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# THE USER DATA SCRIPT THAT WILL RUN ON EACH VAULT SERVER WHEN IT'S BOOTING\n# This script will configure and start Vault\n# ---------------------------------------------------------------------------------------------------------------------\n\ndata \"template_file\" \"user_data_vault_cluster\" {\n  template = file(\"${path.module}/examples/root-example/user-data-vault.sh\")\n\n  vars = {\n    aws_region               = data.aws_region.current.name\n    consul_cluster_tag_key   = var.consul_cluster_tag_key\n    consul_cluster_tag_value = var.consul_cluster_name\n  }\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# PERMIT CONSUL SPECIFIC TRAFFIC IN VAULT CLUSTER\n# To allow our Vault servers consul agents to communicate with other consul agents and participate in the LAN gossip,\n# we open up the consul specific protocols and ports for consul traffic\n# ---------------------------------------------------------------------------------------------------------------------\n\nmodule \"security_group_rules\" {\n  source = \"github.com/hashicorp/terraform-aws-consul.git//modules/consul-client-security-group-rules?ref=v0.8.0\"\n\n  security_group_id = module.vault_cluster.security_group_id\n\n  # To make testing easier, we allow requests from any IP address here but in a production deployment, we *strongly*\n  # recommend you limit this to the IP address ranges of known, trusted servers inside your VPC.\n\n  allowed_inbound_cidr_blocks = [\"0.0.0.0/0\"]\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# DEPLOY THE ELB\n# ---------------------------------------------------------------------------------------------------------------------\n\nmodule \"vault_elb\" {\n  # When using these modules in your own templates, you will need to use a Git URL with a ref attribute that pins you\n  # to a specific version of the modules, such as the following example:\n  # source = \"github.com/hashicorp/terraform-aws-vault//modules/vault-elb?ref=v0.0.1\"\n  source = \"./modules/vault-elb\"\n\n  name = var.vault_cluster_name\n\n  vpc_id     = data.aws_vpc.default.id\n  subnet_ids = data.aws_subnet_ids.default.ids\n\n  # Associate the ELB with the instances created by the Vault Autoscaling group\n  vault_asg_name = module.vault_cluster.asg_name\n\n  # To make testing easier, we allow requests from any IP address here but in a production deployment, we *strongly*\n  # recommend you limit this to the IP address ranges of known, trusted servers inside your VPC.\n  allowed_inbound_cidr_blocks = [\"0.0.0.0/0\"]\n\n  # In order to access Vault over HTTPS, we need a domain name that matches the TLS cert\n  create_dns_entry = var.create_dns_entry\n\n  # Terraform conditionals are not short-circuiting, so we use join as a workaround to avoid errors when the\n  # aws_route53_zone data source isn't actually set: https://github.com/hashicorp/hil/issues/50\n  hosted_zone_id = var.create_dns_entry ? join(\"\", data.aws_route53_zone.selected.*.zone_id) : \"\"\n\n  domain_name = var.vault_domain_name\n}\n\n# Look up the Route 53 Hosted Zone by domain name\ndata \"aws_route53_zone\" \"selected\" {\n  count = var.create_dns_entry ? 1 : 0\n  name  = \"${var.hosted_zone_domain_name}.\"\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# DEPLOY THE CONSUL SERVER CLUSTER\n# ---------------------------------------------------------------------------------------------------------------------\n\nmodule \"consul_cluster\" {\n  source = \"github.com/hashicorp/terraform-aws-consul.git//modules/consul-cluster?ref=v0.8.0\"\n\n  cluster_name  = var.consul_cluster_name\n  cluster_size  = var.consul_cluster_size\n  instance_type = var.consul_instance_type\n\n  # The EC2 Instances will use these tags to automatically discover each other and form a cluster\n  cluster_tag_key   = var.consul_cluster_tag_key\n  cluster_tag_value = var.consul_cluster_name\n\n  ami_id    = var.ami_id == null ? data.aws_ami.vault_consul.image_id : var.ami_id\n  user_data = data.template_file.user_data_consul.rendered\n\n  vpc_id     = data.aws_vpc.default.id\n  subnet_ids = data.aws_subnet_ids.default.ids\n\n  # To make testing easier, we allow Consul and SSH requests from any IP address here but in a production\n  # deployment, we strongly recommend you limit this to the IP address ranges of known, trusted servers inside your VPC.\n\n  allowed_ssh_cidr_blocks     = [\"0.0.0.0/0\"]\n  allowed_inbound_cidr_blocks = [\"0.0.0.0/0\"]\n  ssh_key_name                = var.ssh_key_name\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# THE USER DATA SCRIPT THAT WILL RUN ON EACH CONSUL SERVER WHEN IT'S BOOTING\n# This script will configure and start Consul\n# ---------------------------------------------------------------------------------------------------------------------\n\ndata \"template_file\" \"user_data_consul\" {\n  template = file(\"${path.module}/examples/root-example/user-data-consul.sh\")\n\n  vars = {\n    consul_cluster_tag_key   = var.consul_cluster_tag_key\n    consul_cluster_tag_value = var.consul_cluster_name\n  }\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# DEPLOY THE CLUSTERS IN THE DEFAULT VPC AND AVAILABILITY ZONES\n# Using the default VPC and subnets makes this example easy to run and test, but it means Consul and Vault are\n# accessible from the public Internet. In a production deployment, we strongly recommend deploying into a custom VPC\n# and private subnets. Only the ELB should run in the public subnets.\n# ---------------------------------------------------------------------------------------------------------------------\n\ndata \"aws_vpc\" \"default\" {\n  default = var.use_default_vpc\n  tags    = var.vpc_tags\n}\n\ndata \"aws_subnet_ids\" \"default\" {\n  vpc_id = data.aws_vpc.default.id\n  tags   = var.subnet_tags\n}\n\ndata \"aws_region\" \"current\" {\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-aws-vault__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-aws-vault__main.tf", "start_line": 94}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-aws-vault__main.tf", "start_line": 121}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-aws-vault__main.tf", "start_line": 174}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    vsphere = {\n      source = \"hashicorp/vsphere\"\n    }\n  }\n}\n\nprovider \"vsphere\" {\n  user                 = var.vcenter_username\n  password             = var.vcenter_password\n  vsphere_server       = var.vcenter_server\n  allow_unverified_ssl = true\n}\n\ndata \"vsphere_host_thumbprint\" \"thumbprint1\" {\n  address  = var.hosts[0].hostname\n  insecure = true\n}\n\ndata \"vsphere_host_thumbprint\" \"thumbprint2\" {\n  address  = var.hosts[1].hostname\n  insecure = true\n}\n\ndata \"vsphere_host_thumbprint\" \"thumbprint3\" {\n  address  = var.hosts[2].hostname\n  insecure = true\n}\n\nresource \"vsphere_datacenter\" \"dc\" {\n  name = \"acc-test-dc\"\n}\n\nresource \"vsphere_host\" \"host1\" {\n  datacenter = vsphere_datacenter.dc.moid\n  hostname   = var.hosts[0].hostname\n  username   = var.hosts[0].username\n  password   = var.hosts[0].password\n  thumbprint = data.vsphere_host_thumbprint.thumbprint1.id\n}\n\nresource \"vsphere_host\" \"host2\" {\n  datacenter = vsphere_datacenter.dc.moid\n  hostname   = var.hosts[1].hostname\n  username   = var.hosts[1].username\n  password   = var.hosts[1].password\n  thumbprint = data.vsphere_host_thumbprint.thumbprint2.id\n}\n\nresource \"vsphere_host\" \"host3\" {\n  datacenter = vsphere_datacenter.dc.moid\n  hostname   = var.hosts[2].hostname\n  username   = var.hosts[2].username\n  password   = var.hosts[2].password\n  thumbprint = data.vsphere_host_thumbprint.thumbprint3.id\n}\n\nresource \"vsphere_compute_cluster\" \"cluster\" {\n  datacenter_id = vsphere_datacenter.dc.moid\n  name          = \"acc-test-cluster\"\n\n  ha_enabled = true\n  drs_enabled = true\n\n  host_system_ids = [\n    vsphere_host.host1.id,\n    vsphere_host.host2.id,\n  ]\n}\n\nresource \"vsphere_nas_datastore\" \"nfs\" {\n  name            = \"acc-test-nfs\"\n  host_system_ids = [vsphere_host.host1.id, vsphere_host.host2.id]\n  type            = \"NFS\"\n  remote_hosts    = [var.nfs_host]\n  remote_path     = \"/store\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vmware__terraform-provider-vsphere__tests__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"ibmcloud_api_key\" {\n  description = \"IBM Cloud API key\"\n  type        = string\n}\n\n// Resource arguments for backup_recovery_connection_registration_token\nvariable \"backup_recovery_connection_registration_token_connection_id\" {\n  description = \"Specifies the ID of the connection, connectors belonging to which are to be fetched.\"\n  type        = string\n  default     = \"connection_id\"\n}\nvariable \"backup_recovery_connection_registration_token_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\n\n// Resource arguments for backup_recovery_protection_group_run_request\nvariable \"backup_recovery_protection_group_run_request_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_protection_group_run_request_run_type\" {\n  description = \"Type of protection run. 'kRegular' indicates an incremental (CBT) backup. Incremental backups utilizing CBT (if supported) are captured of the target protection objects. The first run of a kRegular schedule captures all the blocks. 'kFull' indicates a full (no CBT) backup. A complete backup (all blocks) of the target protection objects are always captured and Change Block Tracking (CBT) is not utilized. 'kLog' indicates a Database Log backup. Capture the database transaction logs to allow rolling back to a specific point in time. 'kSystem' indicates system volume backup. It produces an image for bare metal recovery.\"\n  type        = string\n  default     = \"kRegular\"\n}\n\n// Resource arguments for backup_recovery_data_source_connection\nvariable \"backup_recovery_data_source_connection_x_ibm_tenant_id\" {\n  description = \"Id of the tenant accessing the cluster.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_data_source_connection_connection_name\" {\n  description = \"Specifies the name of the connection. For a given tenant, different connections can't have the same name. However, two (or more) different tenants can each have a connection with the same name.\"\n  type        = string\n  default     = \"connection_name\"\n}\n\n// Resource arguments for backup_recovery_download_files_folders\nvariable \"backup_recovery_download_files_folders_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_download_files_folders_name\" {\n  description = \"Specifies the name of the recovery task. This field must be set and must be a unique name.\"\n  type        = string\n  default     = \"name\"\n}\nvariable \"backup_recovery_download_files_folders_parent_recovery_id\" {\n  description = \"If current recovery is child task triggered through another parent recovery operation, then this field will specify the id of the parent recovery.\"\n  type        = string\n  default     = \"parent_recovery_id\"\n}\nvariable \"backup_recovery_download_files_folders_glacier_retrieval_type\" {\n  description = \"Specifies the glacier retrieval type when restoring or downloding files or folders from a Glacier-based cloud snapshot.\"\n  type        = string\n  default     = \"kStandard\"\n}\n\n// Resource arguments for backup_recovery_restore_points\nvariable \"backup_recovery_restore_points_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_restore_points_end_time_usecs\" {\n  description = \"Specifies the end time specified as a Unix epoch Timestamp in microseconds.\"\n  type        = number\n  default     = 12\n}\nvariable \"backup_recovery_restore_points_environment\" {\n  description = \"Specifies the protection source environment type.\"\n  type        = string\n  default     = \"kVMware\"\n}\nvariable \"backup_recovery_restore_points_protection_group_ids\" {\n  description = \"Specifies the jobs for which to get the full snapshot information.\"\n  type        = list(string)\n  default     = [ \"protectionGroupIds\" ]\n}\nvariable \"backup_recovery_restore_points_source_id\" {\n  description = \"Specifies the id of the Protection Source which is to be restored.\"\n  type        = number\n  default     = 1\n}\nvariable \"backup_recovery_restore_points_start_time_usecs\" {\n  description = \"Specifies the start time specified as a Unix epoch Timestamp in microseconds.\"\n  type        = number\n  default     = 14\n}\n\n// Resource arguments for backup_recovery_perform_action_on_protection_group_run_request\nvariable \"backup_recovery_perform_action_on_protection_group_run_request_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_perform_action_on_protection_group_run_request_action\" {\n  description = \"Specifies the type of the action which will be performed on protection runs.\"\n  type        = string\n  default     = \"Pause\"\n}\n\n// Resource arguments for backup_recovery_protection_group\nvariable \"backup_recovery_protection_group_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_protection_group_name\" {\n  description = \"Specifies the name of the Protection Group.\"\n  type        = string\n  default     = \"name\"\n}\nvariable \"backup_recovery_protection_group_policy_id\" {\n  description = \"Specifies the unique id of the Protection Policy associated with the Protection Group. The Policy provides retry settings Protection Schedules, Priority, SLA, etc.\"\n  type        = string\n  default     = \"policy_id\"\n}\nvariable \"backup_recovery_protection_group_priority\" {\n  description = \"Specifies the priority of the Protection Group.\"\n  type        = string\n  default     = \"kLow\"\n}\nvariable \"backup_recovery_protection_group_description\" {\n  description = \"Specifies a description of the Protection Group.\"\n  type        = string\n  default     = \"description\"\n}\nvariable \"backup_recovery_protection_group_end_time_usecs\" {\n  description = \"Specifies the end time in micro seconds for this Protection Group. If this is not specified, the Protection Group won't be ended.\"\n  type        = number\n  default     = 1\n}\nvariable \"backup_recovery_protection_group_last_modified_timestamp_usecs\" {\n  description = \"Specifies the last time this protection group was updated. If this is passed into a PUT request, then the backend will validate that the timestamp passed in matches the time that the protection group was actually last modified. If the two timestamps do not match, then the request will be rejected with a stale error.\"\n  type        = number\n  default     = 1\n}\nvariable \"backup_recovery_protection_group_qos_policy\" {\n  description = \"Specifies whether the Protection Group will be written to HDD or SSD.\"\n  type        = string\n  default     = \"kBackupHDD\"\n}\nvariable \"backup_recovery_protection_group_abort_in_blackouts\" {\n  description = \"Specifies whether currently executing jobs should abort if a blackout period specified by a policy starts. Available only if the selected policy has at least one blackout period. Default value is false.\"\n  type        = bool\n  default     = true\n}\nvariable \"backup_recovery_protection_group_pause_in_blackouts\" {\n  description = \"Specifies whether currently executing jobs should be paused if a blackout period specified by a policy starts. Available only if the selected policy has at least one blackout period. Default value is false. This field should not be set to true if 'abortInBlackouts' is sent as true.\"\n  type        = bool\n  default     = true\n}\nvariable \"backup_recovery_protection_group_is_paused\" {\n  description = \"Specifies if the the Protection Group is paused. New runs are not scheduled for the paused Protection Groups. Active run if any is not impacted.\"\n  type        = bool\n  default     = true\n}\nvariable \"backup_recovery_protection_group_environment\" {\n  description = \"Specifies the environment of the Protection Group.\"\n  type        = string\n  default     = \"kPhysical\"\n}\n\n// Resource arguments for backup_recovery_protection_policy\nvariable \"backup_recovery_protection_policy_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_protection_policy_name\" {\n  description = \"Specifies the name of the Protection Policy.\"\n  type        = string\n  default     = \"name\"\n}\nvariable \"backup_recovery_protection_policy_description\" {\n  description = \"Specifies the description of the Protection Policy.\"\n  type        = string\n  default     = \"description\"\n}\nvariable \"backup_recovery_protection_policy_data_lock\" {\n  description = \"This field is now deprecated. Please use the DataLockConfig in the backup retention.\"\n  type        = string\n  default     = \"Compliance\"\n}\nvariable \"backup_recovery_protection_policy_version\" {\n  description = \"Specifies the current policy verison. Policy version is incremented for optionally supporting new features and differentialting across releases.\"\n  type        = number\n  default     = 1\n}\nvariable \"backup_recovery_protection_policy_is_cbs_enabled\" {\n  description = \"Specifies true if Calender Based Schedule is supported by client. Default value is assumed as false for this feature.\"\n  type        = bool\n  default     = true\n}\nvariable \"backup_recovery_protection_policy_last_modification_time_usecs\" {\n  description = \"Specifies the last time this Policy was updated. If this is passed into a PUT request, then the backend will validate that the timestamp passed in matches the time that the policy was actually last modified. If the two timestamps do not match, then the request will be rejected with a stale error.\"\n  type        = number\n  default     = 1\n}\nvariable \"backup_recovery_protection_policy_template_id\" {\n  description = \"Specifies the parent policy template id to which the policy is linked to. This field is set only when policy is created from template.\"\n  type        = string\n  default     = \"template_id\"\n}\n\n// Resource arguments for backup_recovery\nvariable \"backup_recovery_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_request_initiator_type\" {\n  description = \"Specifies the type of request from UI, which is used for services like magneto to determine the priority of requests.\"\n  type        = string\n  default     = \"UIUser\"\n}\nvariable \"backup_recovery_name\" {\n  description = \"Specifies the name of the Recovery.\"\n  type        = string\n  default     = \"name\"\n}\nvariable \"backup_recovery_snapshot_environment\" {\n  description = \"Specifies the type of snapshot environment for which the Recovery was performed.\"\n  type        = string\n  default     = \"kPhysical\"\n}\n\n// Resource arguments for backup_recovery_search_indexed_object\nvariable \"backup_recovery_search_indexed_object_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_search_indexed_object_protection_group_ids\" {\n  description = \"Specifies a list of Protection Group ids to filter the indexed objects. If specified, the objects indexed by specified Protection Group ids will be returned.\"\n  type        = list(string)\n  default     = [ \"protectionGroupIds\" ]\n}\nvariable \"backup_recovery_search_indexed_object_storage_domain_ids\" {\n  description = \"Specifies the Storage Domain ids to filter indexed objects for which Protection Groups are writing data to Cohesity Views on the specified Storage Domains.\"\n  type        = list(number)\n  default     = [ 1 ]\n}\nvariable \"backup_recovery_search_indexed_object_tenant_id\" {\n  description = \"TenantId contains id of the tenant for which objects are to be returned.\"\n  type        = string\n  default     = \"tenant_id\"\n}\nvariable \"backup_recovery_search_indexed_object_include_tenants\" {\n  description = \"If true, the response will include objects which belongs to all tenants which the current user has permission to see. Default value is false.\"\n  type        = bool\n  default     = true\n}\nvariable \"backup_recovery_search_indexed_object_tags\" {\n  description = \"\\\"This field is deprecated. Please use mightHaveTagIds.\\\".\"\n  type        = list(string)\n  default     = [ \"tags\" ]\n}\nvariable \"backup_recovery_search_indexed_object_snapshot_tags\" {\n  description = \"\\\"This field is deprecated. Please use mightHaveSnapshotTagIds.\\\".\"\n  type        = list(string)\n  default     = [ \"snapshotTags\" ]\n}\nvariable \"backup_recovery_search_indexed_object_must_have_tag_ids\" {\n  description = \"Specifies tags which must be all present in the document.\"\n  type        = list(string)\n  default     = [ \"mustHaveTagIds\" ]\n}\nvariable \"backup_recovery_search_indexed_object_might_have_tag_ids\" {\n  description = \"Specifies list of tags, one or more of which might be present in the document. These are OR'ed together and the resulting criteria AND'ed with the rest of the query.\"\n  type        = list(string)\n  default     = [ \"mightHaveTagIds\" ]\n}\nvariable \"backup_recovery_search_indexed_object_must_have_snapshot_tag_ids\" {\n  description = \"Specifies snapshot tags which must be all present in the document.\"\n  type        = list(string)\n  default     = [ \"mustHaveSnapshotTagIds\" ]\n}\nvariable \"backup_recovery_search_indexed_object_might_have_snapshot_tag_ids\" {\n  description = \"Specifies list of snapshot tags, one or more of which might be present in the document. These are OR'ed together and the resulting criteria AND'ed with the rest of the query.\"\n  type        = list(string)\n  default     = [ \"mightHaveSnapshotTagIds\" ]\n}\nvariable \"backup_recovery_search_indexed_object_pagination_cookie\" {\n  description = \"Specifies the pagination cookie with which subsequent parts of the response can be fetched.\"\n  type        = string\n  default     = \"pagination_cookie\"\n}\nvariable \"backup_recovery_search_indexed_object_count\" {\n  description = \"Specifies the number of indexed objects to be fetched for the specified pagination cookie.\"\n  type        = number\n  default     = 1\n}\nvariable \"backup_recovery_search_indexed_object_object_type\" {\n  description = \"Specifies the object type to be searched for.\"\n  type        = string\n  default     = \"Emails\"\n}\nvariable \"backup_recovery_search_indexed_object_use_cached_data\" {\n  description = \"Specifies whether we can serve the GET request from the read replica cache. There is a lag of 15 seconds between the read replica and primary data source.\"\n  type        = bool\n  default     = true\n}\n\n// Resource arguments for backup_recovery_source_registration\nvariable \"backup_recovery_source_registration_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_source_registration_environment\" {\n  description = \"Specifies the environment type of the Protection Source.\"\n  type        = string\n  default     = \"kPhysical\"\n}\nvariable \"backup_recovery_source_registration_name\" {\n  description = \"The user specified name for this source.\"\n  type        = string\n  default     = \"name\"\n}\nvariable \"backup_recovery_source_registration_connection_id\" {\n  description = \"Specifies the id of the connection from where this source is reachable. This should only be set for a source being registered by a tenant user. This field will be depricated in future. Use connections field.\"\n  type        = number\n  default     = 1\n}\nvariable \"backup_recovery_source_registration_connector_group_id\" {\n  description = \"Specifies the connector group id of connector groups.\"\n  type        = number\n  default     = 1\n}\nvariable \"backup_recovery_source_registration_data_source_connection_id\" {\n  description = \"Specifies the id of the connection from where this source is reachable. This should only be set for a source being registered by a tenant user. Also, this is the 'string' of connectionId. This property was added to accommodate for ID values that exceed 2^53 - 1, which is the max value for which JS maintains precision.\"\n  type        = string\n  default     = \"data_source_connection_id\"\n}\n\n// Resource arguments for backup_recovery_update_protection_group_run_request\nvariable \"backup_recovery_update_protection_group_run_request_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\n\n// Data source arguments for backup_recovery_agent_upgrade_tasks\nvariable \"backup_recovery_agent_upgrade_tasks_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_agent_upgrade_tasks_ids\" {\n  description = \"Specifies IDs of tasks to be fetched.\"\n  type        = list(number)\n  default     = [ 0 ]\n}\n\n// Data source arguments for backup_recovery_data_source_connections\nvariable \"backup_recovery_data_source_connections_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_data_source_connections_connection_ids\" {\n  description = \"Specifies the unique IDs of the connections which are to be fetched.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_data_source_connections_connection_names\" {\n  description = \"Specifies the names of the connections which are to be fetched.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\n\n// Data source arguments for backup_recovery_data_source_connectors\nvariable \"backup_recovery_data_source_connectors_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_data_source_connectors_connector_ids\" {\n  description = \"Specifies the unique IDs of the connectors which are to be fetched.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_data_source_connectors_connector_names\" {\n  description = \"Specifies the names of the connectors which are to be fetched.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_data_source_connectors_connection_id\" {\n  description = \"Specifies the ID of the connection, connectors belonging to which are to be fetched.\"\n  type        = string\n  default     = \"placeholder\"\n}\n\n// Data source arguments for backup_recovery_download_agent\nvariable \"backup_recovery_download_agent_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_download_agent_platform\" {\n  description = \"Specifies the platform for which agent needs to be downloaded.\"\n  type        = string\n  default     = \"kWindows\"\n}\nvariable \"backup_recovery_download_agent_linux_params\" {\n  description = \"Linux agent parameters.\"\n  type        = list(object({ example=string }))\n  default     = { example: \"object\" }\n}\n\n// Data source arguments for backup_recovery_object_snapshots\nvariable \"backup_recovery_object_snapshots_backup_recovery_object_snapshots_id\" {\n  description = \"Specifies the id of the Object.\"\n  type        = number\n  default     = 2\n}\nvariable \"backup_recovery_object_snapshots_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_object_snapshots_from_time_usecs\" {\n  description = \"Specifies the timestamp in Unix time epoch in microseconds to filter Object's snapshots which were taken after this value.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_object_snapshots_to_time_usecs\" {\n  description = \"Specifies the timestamp in Unix time epoch in microseconds to filter Object's snapshots which were taken before this value.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_object_snapshots_run_start_from_time_usecs\" {\n  description = \"Specifies the timestamp in Unix time epoch in microseconds to filter Object's snapshots which were run after this value.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_object_snapshots_run_start_to_time_usecs\" {\n  description = \"Specifies the timestamp in Unix time epoch in microseconds to filter Object's snapshots which were run before this value.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_object_snapshots_snapshot_actions\" {\n  description = \"Specifies a list of recovery actions. Only snapshots that apply to these actions will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_object_snapshots_run_types\" {\n  description = \"Filter by run type. Only protection runs matching the specified types will be returned. By default, CDP hydration snapshots are not included unless explicitly queried using this field.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_object_snapshots_protection_group_ids\" {\n  description = \"If specified, this returns only the snapshots of the specified object ID, which belong to the provided protection group IDs.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_object_snapshots_run_instance_ids\" {\n  description = \"Filter by a list of run instance IDs. If specified, only snapshots created by these protection runs will be returned.\"\n  type        = list(number)\n  default     = [ 0 ]\n}\nvariable \"backup_recovery_object_snapshots_region_ids\" {\n  description = \"Filter by a list of region IDs.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_object_snapshots_object_action_keys\" {\n  description = \"Filter by ObjectActionKey, which uniquely represents the protection of an object. An object can be protected in multiple ways but at most once for a given combination of ObjectActionKey. When specified, only snapshots matching the given action keys are returned for the corresponding object.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\n\n// Data source arguments for backup_recovery_search_objects\nvariable \"backup_recovery_search_objects_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_search_objects_request_initiator_type\" {\n  description = \"Specifies the type of request from UI, which is used for services like magneto to determine the priority of requests.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_search_objects_search_string\" {\n  description = \"Specifies the search string to filter the objects. This search string will be applicable for objectnames. User can specify a wildcard character '*' as a suffix to a string where all object names are matched with the prefix string. For example, if vm1 and vm2 are the names of objects, user can specify vm* to list the objects. If not specified, then all the objects will be returned which will match other filtering criteria.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_search_objects_environments\" {\n  description = \"Specifies the environment type to filter objects.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_protection_types\" {\n  description = \"Specifies the protection type to filter objects.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_protection_group_ids\" {\n  description = \"Specifies a list of Protection Group ids to filter the objects. If specified, the objects protected by specified Protection Group ids will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_object_ids\" {\n  description = \"Specifies a list of Object ids to filter.\"\n  type        = list(number)\n  default     = [ 0 ]\n}\nvariable \"backup_recovery_search_objects_os_types\" {\n  description = \"Specifies the operating system types to filter objects on.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_source_ids\" {\n  description = \"Specifies a list of Protection Source object ids to filter the objects. If specified, the object which are present in those Sources will be returned.\"\n  type        = list(number)\n  default     = [ 0 ]\n}\nvariable \"backup_recovery_search_objects_source_uuids\" {\n  description = \"Specifies a list of Protection Source object uuids to filter the objects. If specified, the object which are present in those Sources will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_is_protected\" {\n  description = \"Specifies the protection status of objects. If set to true, only protected objects will be returned. If set to false, only unprotected objects will be returned. If not specified, all objects will be returned.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_search_objects_is_deleted\" {\n  description = \"If set to true, then objects which are deleted on atleast one cluster will be returned. If not set or set to false then objects which are registered on atleast one cluster are returned.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_search_objects_last_run_status_list\" {\n  description = \"Specifies a list of status of the object's last protection run. Only objects with last run status of these will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_cluster_identifiers\" {\n  description = \"Specifies the list of cluster identifiers. Format is clusterId:clusterIncarnationId. Only records from clusters having these identifiers will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_include_deleted_objects\" {\n  description = \"Specifies whether to include deleted objects in response. These objects can't be protected but can be recovered. This field is deprecated.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_search_objects_pagination_cookie\" {\n  description = \"Specifies the pagination cookie with which subsequent parts of the response can be fetched.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_search_objects_count\" {\n  description = \"Specifies the number of objects to be fetched for the specified pagination cookie.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_search_objects_must_have_tag_ids\" {\n  description = \"Specifies tags which must be all present in the document.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_might_have_tag_ids\" {\n  description = \"Specifies list of tags, one or more of which might be present in the document. These are OR'ed together and the resulting criteria AND'ed with the rest of the query.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_must_have_snapshot_tag_ids\" {\n  description = \"Specifies snapshot tags which must be all present in the document.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_might_have_snapshot_tag_ids\" {\n  description = \"Specifies list of snapshot tags, one or more of which might be present in the document. These are OR'ed together and the resulting criteria AND'ed with the rest of the query.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_tag_search_name\" {\n  description = \"Specifies the tag name to filter the tagged objects and snapshots. User can specify a wildcard character '*' as a suffix to a string where all object's tag names are matched with the prefix string.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_search_objects_tag_names\" {\n  description = \"Specifies the tag names to filter the tagged objects and snapshots.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_tag_types\" {\n  description = \"Specifies the tag names to filter the tagged objects and snapshots.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_tag_categories\" {\n  description = \"Specifies the tag category to filter the objects and snapshots.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_tag_sub_categories\" {\n  description = \"Specifies the tag subcategory to filter the objects and snapshots.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_objects_include_helios_tag_info_for_objects\" {\n  description = \"pecifies whether to include helios tags information for objects in response. Default value is false.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_search_objects_external_filters\" {\n  description = \"Specifies the key-value pairs to filtering the results for the search. Each filter is of the form 'key:value'. The filter 'externalFilters:k1:v1&externalFilters:k2:v2&externalFilters:k2:v3' returns the documents where each document will match the query (k1=v1) AND (k2=v2 OR k2 = v3). Allowed keys: - vmBiosUuid - graphUuid - arn - instanceId - bucketName - azureId.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\n\n// Data source arguments for backup_recovery_search_protected_objects\nvariable \"backup_recovery_search_protected_objects_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_search_protected_objects_request_initiator_type\" {\n  description = \"Specifies the type of request from UI, which is used for services like magneto to determine the priority of requests.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_search_protected_objects_search_string\" {\n  description = \"Specifies the search string to filter the objects. This search string will be applicable for objectnames and Protection Group names. User can specify a wildcard character '*' as a suffix to a string where all object and their Protection Group names are matched with the prefix string. For example, if vm1 and vm2 are the names of objects, user can specify vm* to list the objects. If not specified, then all the objects with Protection Groups will be returned which will match other filtering criteria.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_search_protected_objects_environments\" {\n  description = \"Specifies the environment type to filter objects.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_protected_objects_snapshot_actions\" {\n  description = \"Specifies a list of recovery actions. Only snapshots that applies to these actions will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_protected_objects_object_action_key\" {\n  description = \"Filter by ObjectActionKey, which uniquely represents protection of an object. An object can be protected in multiple ways but atmost once for a given combination of ObjectActionKey. When specified, latest snapshot info matching the objectActionKey is for corresponding object.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_search_protected_objects_protection_group_ids\" {\n  description = \"Specifies a list of Protection Group ids to filter the objects. If specified, the objects protected by specified Protection Group ids will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_protected_objects_object_ids\" {\n  description = \"Specifies a list of Object ids to filter.\"\n  type        = list(number)\n  default     = [ 0 ]\n}\nvariable \"backup_recovery_search_protected_objects_sub_result_size\" {\n  description = \"Specifies the size of objects to be fetched for a single subresult.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_search_protected_objects_filter_snapshot_from_usecs\" {\n  description = \"Specifies the timestamp in Unix time epoch in microseconds to filter the objects if the Object has a successful snapshot after this value.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_search_protected_objects_filter_snapshot_to_usecs\" {\n  description = \"Specifies the timestamp in Unix time epoch in microseconds to filter the objects if the Object has a successful snapshot before this value.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_search_protected_objects_os_types\" {\n  description = \"Specifies the operating system types to filter objects on.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_search_protected_objects_source_ids\" {\n  description = \"Specifies a list of Protection Source object ids to filter the objects. If specified, the object which are present in those Sources will be returned.\"\n  type        = list(number)\n  default     = [ 0 ]\n}\nvariable \"backup_recovery_search_protected_objects_run_instance_ids\" {\n  description = \"Specifies a list of run instance ids. If specified only objects belonging to the provided run id will be retunrned.\"\n  type        = list(number)\n  default     = [ 0 ]\n}\nvariable \"backup_recovery_search_protected_objects_cdp_protected_only\" {\n  description = \"Specifies whether to only return the CDP protected objects.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_search_protected_objects_use_cached_data\" {\n  description = \"Specifies whether we can serve the GET request to the read replica cache cache. There is a lag of 15 seconds between the read replica and primary data source.\"\n  type        = bool\n  default     = false\n}\n\n// Data source arguments for backup_recovery_protection_group\nvariable \"data_backup_recovery_protection_group_backup_recovery_protection_group_id\" {\n  description = \"Specifies a unique id of the Protection Group.\"\n  type        = string\n  default     = \"backup_recovery_protection_group_id\"\n}\nvariable \"data_backup_recovery_protection_group_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"data_backup_recovery_protection_group_request_initiator_type\" {\n  description = \"Specifies the type of request from UI, which is used for services like magneto to determine the priority of requests.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"data_backup_recovery_protection_group_include_last_run_info\" {\n  description = \"If true, the response will include last run info. If it is false or not specified, the last run info won't be returned.\"\n  type        = bool\n  default     = false\n}\nvariable \"data_backup_recovery_protection_group_prune_excluded_source_ids\" {\n  description = \"If true, the response will not include the list of excluded source IDs in groups that contain this field. This can be set to true in order to improve performance if excluded source IDs are not needed by the user.\"\n  type        = bool\n  default     = false\n}\nvariable \"data_backup_recovery_protection_group_prune_source_ids\" {\n  description = \"If true, the response will exclude the list of source IDs within the group specified.\"\n  type        = bool\n  default     = false\n}\n\n// Data source arguments for backup_recovery_protection_groups\nvariable \"backup_recovery_protection_groups_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_protection_groups_request_initiator_type\" {\n  description = \"Specifies the type of request from UI, which is used for services like magneto to determine the priority of requests.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_protection_groups_ids\" {\n  description = \"Filter by a list of Protection Group ids.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_groups_names\" {\n  description = \"Filter by a list of Protection Group names.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_groups_policy_ids\" {\n  description = \"Filter by Policy ids that are associated with Protection Groups. Only Protection Groups associated with the specified Policy ids, are returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_groups_include_groups_with_datalock_only\" {\n  description = \"Whether to only return Protection Groups with a datalock.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_groups_environments\" {\n  description = \"Filter by environment types such as 'kVMware', 'kView', etc. Only Protection Groups protecting the specified environment types are returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_groups_is_active\" {\n  description = \"Filter by Inactive or Active Protection Groups. If not set, all Inactive and Active Protection Groups are returned. If true, only Active Protection Groups are returned. If false, only Inactive Protection Groups are returned. When you create a Protection Group on a Primary Cluster with a replication schedule, the Cluster creates an Inactive copy of the Protection Group on the Remote Cluster. In addition, when an Active and running Protection Group is deactivated, the Protection Group becomes Inactive.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_groups_is_deleted\" {\n  description = \"If true, return only Protection Groups that have been deleted but still have Snapshots associated with them. If false, return all Protection Groups except those Protection Groups that have been deleted and still have Snapshots associated with them. A Protection Group that is deleted with all its Snapshots is not returned for either of these cases.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_groups_is_paused\" {\n  description = \"Filter by paused or non paused Protection Groups, If not set, all paused and non paused Protection Groups are returned. If true, only paused Protection Groups are returned. If false, only non paused Protection Groups are returned.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_groups_last_run_local_backup_status\" {\n  description = \"Filter by last local backup run status.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_groups_last_run_replication_status\" {\n  description = \"Filter by last remote replication run status.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_groups_last_run_archival_status\" {\n  description = \"Filter by last cloud archival run status.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_groups_last_run_cloud_spin_status\" {\n  description = \"Filter by last cloud spin run status.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_groups_last_run_any_status\" {\n  description = \"Filter by last any run status.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_groups_is_last_run_sla_violated\" {\n  description = \"If true, return Protection Groups for which last run SLA was violated.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_groups_include_last_run_info\" {\n  description = \"If true, the response will include last run info. If it is false or not specified, the last run info won't be returned.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_groups_prune_excluded_source_ids\" {\n  description = \"If true, the response will not include the list of excluded source IDs in groups that contain this field. This can be set to true in order to improve performance if excluded source IDs are not needed by the user.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_groups_prune_source_ids\" {\n  description = \"If true, the response will exclude the list of source IDs within the group specified.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_groups_use_cached_data\" {\n  description = \"Specifies whether we can serve the GET request from the read replica cache. There is a lag of 15 seconds between the read replica and primary data source.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_groups_source_ids\" {\n  description = \"Filter by Source ids that are associated with Protection Groups. Only Protection Groups associated with the specified Source ids, are returned.\"\n  type        = list(number)\n  default     = [ 0 ]\n}\n\n// Data source arguments for backup_recovery_protection_group_run\nvariable \"backup_recovery_protection_group_run_backup_recovery_protection_group_run_id\" {\n  description = \"Specifies a unique id of the Protection Group.\"\n  type        = string\n  default     = \"backup_recovery_protection_group_run_id\"\n}\nvariable \"backup_recovery_protection_group_run_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_protection_group_run_request_initiator_type\" {\n  description = \"Specifies the type of request from UI, which is used for services like magneto to determine the priority of requests.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_protection_group_run_run_id\" {\n  description = \"Specifies the protection run id.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_protection_group_run_start_time_usecs\" {\n  description = \"Start time for time range filter. Specify the start time as a Unix epoch Timestamp (in microseconds), only runs executing after this time will be returned. By default it is endTimeUsecs minus an hour.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_protection_group_run_end_time_usecs\" {\n  description = \"End time for time range filter. Specify the end time as a Unix epoch Timestamp (in microseconds), only runs executing before this time will be returned. By default it is current time.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_protection_group_run_run_types\" {\n  description = \"Filter by run type. Only protection run matching the specified types will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_run_include_object_details\" {\n  description = \"Specifies if the result includes the object details for each protection run. If set to true, details of the protected object will be returned. If set to false or not specified, details will not be returned.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_group_run_local_backup_run_status\" {\n  description = \"Specifies a list of local backup status, runs matching the status will be returned.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_run_replication_run_status\" {\n  description = \"Specifies a list of replication status, runs matching the status will be returned.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_run_archival_run_status\" {\n  description = \"Specifies a list of archival status, runs matching the status will be returned.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_run_cloud_spin_run_status\" {\n  description = \"Specifies a list of cloud spin status, runs matching the status will be returned.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_run_num_runs\" {\n  description = \"Specifies the max number of runs. If not specified, at most 100 runs will be returned.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_protection_group_run_exclude_non_restorable_runs\" {\n  description = \"Specifies whether to exclude non restorable runs. Run is treated restorable only if there is atleast one object snapshot (which may be either a local or an archival snapshot) which is not deleted or expired. Default value is false.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_group_run_run_tags\" {\n  description = \"Specifies a list of tags for protection runs. If this is specified, only the runs which match these tags will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_run_use_cached_data\" {\n  description = \"Specifies whether we can serve the GET request from the read replica cache. There is a lag of 15 seconds between the read replica and primary data source.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_group_run_filter_by_end_time\" {\n  description = \"If true, the runs with backup end time within the specified time range will be returned. Otherwise, the runs with start time in the time range are returned.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_group_run_snapshot_target_types\" {\n  description = \"Specifies the snapshot's target type which should be filtered.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_run_only_return_successful_copy_run\" {\n  description = \"only successful copyruns are returned.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_group_run_filter_by_copy_task_end_time\" {\n  description = \"If true, then the details of the runs for which any copyTask completed in the given timerange will be returned. Only one of filterByEndTime and filterByCopyTaskEndTime can be set.\"\n  type        = bool\n  default     = false\n}\n\n// Data source arguments for backup_recovery_protection_group_runs\nvariable \"backup_recovery_protection_group_runs_backup_recovery_protection_group_runs_id\" {\n  description = \"Specifies a unique id of the Protection Group.\"\n  type        = string\n  default     = \"backup_recovery_protection_group_runs_id\"\n}\nvariable \"backup_recovery_protection_group_runs_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_protection_group_runs_request_initiator_type\" {\n  description = \"Specifies the type of request from UI, which is used for services like magneto to determine the priority of requests.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_protection_group_runs_run_id\" {\n  description = \"Specifies the protection run id.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_protection_group_runs_start_time_usecs\" {\n  description = \"Start time for time range filter. Specify the start time as a Unix epoch Timestamp (in microseconds), only runs executing after this time will be returned. By default it is endTimeUsecs minus an hour.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_protection_group_runs_end_time_usecs\" {\n  description = \"End time for time range filter. Specify the end time as a Unix epoch Timestamp (in microseconds), only runs executing before this time will be returned. By default it is current time.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_protection_group_runs_run_types\" {\n  description = \"Filter by run type. Only protection run matching the specified types will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_runs_include_object_details\" {\n  description = \"Specifies if the result includes the object details for each protection run. If set to true, details of the protected object will be returned. If set to false or not specified, details will not be returned.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_group_runs_local_backup_run_status\" {\n  description = \"Specifies a list of local backup status, runs matching the status will be returned.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_runs_replication_run_status\" {\n  description = \"Specifies a list of replication status, runs matching the status will be returned.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_runs_archival_run_status\" {\n  description = \"Specifies a list of archival status, runs matching the status will be returned.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_runs_cloud_spin_run_status\" {\n  description = \"Specifies a list of cloud spin status, runs matching the status will be returned.<br> 'Running' indicates that the run is still running.<br> 'Canceled' indicates that the run has been canceled.<br> 'Canceling' indicates that the run is in the process of being canceled.<br> 'Failed' indicates that the run has failed.<br> 'Missed' indicates that the run was unable to take place at the scheduled time because the previous run was still happening.<br> 'Succeeded' indicates that the run has finished successfully.<br> 'SucceededWithWarning' indicates that the run finished successfully, but there were some warning messages.<br> 'Paused' indicates that the ongoing run has been paused.<br> 'Skipped' indicates that the run was skipped.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_runs_num_runs\" {\n  description = \"Specifies the max number of runs. If not specified, at most 100 runs will be returned.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_protection_group_runs_exclude_non_restorable_runs\" {\n  description = \"Specifies whether to exclude non restorable runs. Run is treated restorable only if there is atleast one object snapshot (which may be either a local or an archival snapshot) which is not deleted or expired. Default value is false.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_group_runs_run_tags\" {\n  description = \"Specifies a list of tags for protection runs. If this is specified, only the runs which match these tags will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_runs_use_cached_data\" {\n  description = \"Specifies whether we can serve the GET request from the read replica cache. There is a lag of 15 seconds between the read replica and primary data source.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_group_runs_filter_by_end_time\" {\n  description = \"If true, the runs with backup end time within the specified time range will be returned. Otherwise, the runs with start time in the time range are returned.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_group_runs_snapshot_target_types\" {\n  description = \"Specifies the snapshot's target type which should be filtered.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_group_runs_only_return_successful_copy_run\" {\n  description = \"only successful copyruns are returned.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_group_runs_filter_by_copy_task_end_time\" {\n  description = \"If true, then the details of the runs for which any copyTask completed in the given timerange will be returned. Only one of filterByEndTime and filterByCopyTaskEndTime can be set.\"\n  type        = bool\n  default     = false\n}\n\n// Data source arguments for backup_recovery_protection_policies\nvariable \"backup_recovery_protection_policies_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_protection_policies_request_initiator_type\" {\n  description = \"Specifies the type of request from UI, which is used for services like magneto to determine the priority of requests.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_protection_policies_ids\" {\n  description = \"Filter policies by a list of policy ids.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_policies_policy_names\" {\n  description = \"Filter policies by a list of policy names.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_policies_types\" {\n  description = \"Types specifies the policy type of policies to be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recovery_protection_policies_exclude_linked_policies\" {\n  description = \"If excludeLinkedPolicies is set to true then only local policies created on cluster will be returned. The result will exclude all linked policies created from policy templates.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_policies_include_replicated_policies\" {\n  description = \"If includeReplicatedPolicies is set to true, then response will also contain replicated policies. By default, replication policies are not included in the response.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_protection_policies_include_stats\" {\n  description = \"If includeStats is set to true, then response will return number of protection groups and objects. By default, the protection stats are not included in the response.\"\n  type        = bool\n  default     = false\n}\n\n// Data source arguments for backup_recovery_protection_policy\nvariable \"data_backup_recovery_protection_policy_backup_recovery_protection_policy_id\" {\n  description = \"Specifies a unique id of the Protection Policy to return.\"\n  type        = string\n  default     = \"backup_recovery_protection_policy_id\"\n}\nvariable \"data_backup_recovery_protection_policy_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"data_backup_recovery_protection_policy_request_initiator_type\" {\n  description = \"Specifies the type of request from UI, which is used for services like magneto to determine the priority of requests.\"\n  type        = string\n  default     = \"placeholder\"\n}\n\n// Data source arguments for backup_recovery\nvariable \"data_backup_recovery_backup_recovery_id\" {\n  description = \"Specifies the id of a Recovery.\"\n  type        = string\n  default     = \"backup_recovery_id\"\n}\nvariable \"data_backup_recovery_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\n\n// Data source arguments for backup_recoveries\nvariable \"backup_recoveries_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recoveries_ids\" {\n  description = \"Filter Recoveries for given ids.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recoveries_return_only_child_recoveries\" {\n  description = \"Returns only child recoveries if passed as true. This filter should always be used along with 'ids' filter.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recoveries_start_time_usecs\" {\n  description = \"Returns the recoveries which are started after the specific time. This value should be in Unix timestamp epoch in microseconds.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recoveries_end_time_usecs\" {\n  description = \"Returns the recoveries which are started before the specific time. This value should be in Unix timestamp epoch in microseconds.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recoveries_snapshot_target_type\" {\n  description = \"Specifies the snapshot's target type from which recovery has been performed.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recoveries_archival_target_type\" {\n  description = \"Specifies the snapshot's archival target type from which recovery has been performed. This parameter applies only if 'snapshotTargetType' is 'Archival'.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recoveries_snapshot_environments\" {\n  description = \"Specifies the list of snapshot environment types to filter Recoveries. If empty, Recoveries related to all environments will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recoveries_status\" {\n  description = \"Specifies the list of run status to filter Recoveries. If empty, Recoveries with all run status will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\nvariable \"backup_recoveries_recovery_actions\" {\n  description = \"Specifies the list of recovery actions to filter Recoveries. If empty, Recoveries related to all actions will be returned.\"\n  type        = list(string)\n  default     = [ \"placeholder\" ]\n}\n\n// Data source arguments for backup_recovery_source_registrations\nvariable \"backup_recovery_source_registrations_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_source_registrations_ids\" {\n  description = \"Ids specifies the list of source registration ids to return. If left empty, every source registration will be returned by default.\"\n  type        = list(number)\n  default     = [ 0 ]\n}\nvariable \"backup_recovery_source_registrations_include_source_credentials\" {\n  description = \"If true, the encrypted crednetial for the registered sources will be included. Credential is first encrypted with internal key and then reencrypted with user supplied encryption key.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_source_registrations_encryption_key\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_source_registrations_use_cached_data\" {\n  description = \"Specifies whether we can serve the GET request from the read replica cache. There is a lag of 15 seconds between the read replica and primary data source.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_source_registrations_include_external_metadata\" {\n  description = \"If true, the external entity metadata like maintenance mode config for the registered sources will be included.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_source_registrations_ignore_tenant_migration_in_progress_check\" {\n  description = \"If true, tenant migration check will be ignored.\"\n  type        = bool\n  default     = false\n}\n\n// Data source arguments for backup_recovery_source_registration\nvariable \"data_backup_recovery_source_registration_backup_recovery_source_registration_id\" {\n  description = \"Specifies the id of the Protection Source registration.\"\n  type        = number\n  default     = 2\n}\nvariable \"data_backup_recovery_source_registration_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"data_backup_recovery_source_registration_request_initiator_type\" {\n  description = \"Specifies the type of request from UI, which is used for services like magneto to determine the priority of requests.\"\n  type        = string\n  default     = \"placeholder\"\n}\n\n// Data source arguments for backup_recovery_download_indexed_files\nvariable \"backup_recovery_download_indexed_files_snapshots_id\" {\n  description = \"Specifies the snapshot id to download from.\"\n  type        = string\n  default     = \"snapshots_id\"\n}\nvariable \"backup_recovery_download_indexed_files_x_ibm_tenant_id\" {\n  description = \"Specifies the key to be used to encrypt the source credential. If includeSourceCredentials is set to true this key must be specified.\"\n  type        = string\n  default     = \"x_ibm_tenant_id\"\n}\nvariable \"backup_recovery_download_indexed_files_file_path\" {\n  description = \"Specifies the path to the file to download. If no path is specified and snapshot environment is kVMWare, VMX file for VMware will be downloaded. For other snapshot environments, this field must be specified.\"\n  type        = string\n  default     = \"placeholder\"\n}\nvariable \"backup_recovery_download_indexed_files_nvram_file\" {\n  description = \"Specifies if NVRAM file for VMware should be downloaded.\"\n  type        = bool\n  default     = false\n}\nvariable \"backup_recovery_download_indexed_files_retry_attempt\" {\n  description = \"Specifies the number of attempts the protection run took to create this file.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_download_indexed_files_start_offset\" {\n  description = \"Specifies the start offset of file chunk to be downloaded.\"\n  type        = number\n  default     = 0\n}\nvariable \"backup_recovery_download_indexed_files_length\" {\n  description = \"Specifies the length of bytes to download. This can not be greater than 8MB (8388608 byets).\"\n  type        = number\n  default     = 0\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/IBM-Cloud__terraform-provider-ibm__examples__ibm-backup-recovery__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nterraform {\n  required_version = \">= 0.12\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__demo-terraform-101__getting-started__gcp__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// Use the AWS Certificate Manager to create an SSL cert for our domain.\n// This resource won't be created until you receive the email verifying you\n// own the domain and you click on the confirmation link.\nresource \"aws_acm_certificate\" \"certificate\" {\n  // We want a wildcard cert so we can host subdomains later.\n  domain_name       = \"*.${var.root_domain_name}\"\n  validation_method = \"EMAIL\"\n\n  // We also want the cert to be valid for the root domain even though we'll be\n  // redirecting to the www. domain immediately.\n  subject_alternative_names = [\"${var.root_domain_name}\"]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/runatlantis__atlantis__runatlantis.io__blog__2018__hosting-our-static-site__code__ssl-cert.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_233", "severity": "HIGH", "message": "Ensure Create before destroy for ACM certificates", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/runatlantis__atlantis__runatlantis.io__blog__2018__hosting-our-static-site__code__ssl-cert.tf", "start_line": 4}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"oci_identity_availability_domains\" \"ADs\" {\n  compartment_id = \"${var.tenancy_ocid}\"\n}\n\nresource \"template_file\" \"etcd_discovery_url\" {\n  provisioner \"local-exec\" {\n    command = \"[ -d ${path.root}/generated ] || mkdir -p ${path.root}/generated && curl --retry 3 https://discovery.etcd.io/new?size=${var.etcdAd1Count + var.etcdAd2Count + var.etcdAd3Count} > ${path.root}/generated/discovery${self.id}\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/oracle__terraform-kubernetes-installer__datasources.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"template_file\" \"client_userdata_script\" {\n  template = file(\"${path.module}/../templates/aws_user_data.sh\")\n  vars = merge(local.user_data_common, {\n    startup_script = \"client.sh\",\n    heap_size = var.client_heap_size\n  })\n}\n\nresource \"aws_launch_template\" \"client\" {\n  name_prefix   = \"elasticsearch-${var.es_cluster}-client-nodes\"\n  image_id      = data.aws_ami.kibana_client.id\n  instance_type = var.master_instance_type\n  user_data     = base64encode(data.template_file.client_userdata_script.rendered)\n  key_name      = var.key_name\n\n  iam_instance_profile {\n    arn = aws_iam_instance_profile.elasticsearch.arn\n  }\n\n  network_interfaces {\n    delete_on_termination       = true\n    associate_public_ip_address = false\n    security_groups = concat(\n      [aws_security_group.elasticsearch_security_group.id],\n      [aws_security_group.elasticsearch_clients_security_group.id],\n      var.additional_security_groups,\n    )\n  }\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n\nresource \"aws_autoscaling_group\" \"client_nodes\" {\n  count = length(keys(var.clients_count))\n\n  name               = \"elasticsearch-${var.es_cluster}-client-nodes-${keys(var.clients_count)[count.index]}\"\n  max_size           = var.clients_count[keys(var.clients_count)[count.index]]\n  min_size           = var.clients_count[keys(var.clients_count)[count.index]]\n  desired_capacity   = var.clients_count[keys(var.clients_count)[count.index]]\n  default_cooldown   = 30\n  force_delete       = true\n\n  vpc_zone_identifier = local.clients_subnet_ids[keys(var.clients_count)[count.index]]\n\n  target_group_arns = [\n    aws_lb_target_group.esearch-p9200-tg.arn,\n    aws_lb_target_group.kibana-p5601-tg[0].arn,\n  ]\n\n  launch_template {\n    id      = aws_launch_template.client.id\n    version = \"$Latest\"\n  }\n\n  tag {\n    key                 = \"Name\"\n    value               = format(\"%s-client-node\", var.es_cluster)\n    propagate_at_launch = true\n  }\n\n  tag {\n    key                 = \"Environment\"\n    value               = var.environment\n    propagate_at_launch = true\n  }\n\n  tag {\n    key                 = \"Cluster\"\n    value               = \"${var.environment}-${var.es_cluster}\"\n    propagate_at_launch = true\n  }\n\n  tag {\n    key                 = \"Role\"\n    value               = \"client\"\n    propagate_at_launch = true\n  }\n\n  tag {\n    key                 = \"AutoAttachDiskDisabled\"\n    value               = \"true\"\n    propagate_at_launch = true\n  }\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__client.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__client.tf", "start_line": 9}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_role\" \"iam-role\" {\n  name               = var.iam-role\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nEOF\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__iam-role.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"vpc\" {\n  source = \"terraform-aws-modules/vpc/aws\"\n\n  name = \"jenkins-vpc\"\n  cidr = var.vpc_cidr\n\n  azs = data.aws_availability_zones.azs.names\n\n  private_subnets = var.private_subnets\n  public_subnets  = var.public_subnets\n\n  enable_dns_hostnames = true\n  enable_nat_gateway   = true\n  single_nat_gateway   = true\n\n  tags = {\n    \"kubernetes.io/cluster/my-eks-cluster\" = \"shared\"\n  }\n\n  public_subnet_tags = {\n    \"kubernetes.io/cluster/my-eks-cluster\" = \"shared\"\n    \"kubernetes.io/role/elb\"               = 1\n  }\n\n  private_subnet_tags = {\n    \"kubernetes.io/cluster/my-eks-cluster\" = \"shared\"\n    \"kubernetes.io/role/internal-elb\"      = 1\n  }\n\n}\n\nmodule \"eks\" {\n  source = \"terraform-aws-modules/eks/aws\"\n\n  cluster_name    = \"my-eks-cluster\"\n  cluster_version = \"1.24\"\n\n  cluster_endpoint_public_access = true\n\n  vpc_id     = module.vpc.vpc_id\n  subnet_ids = module.vpc.private_subnets\n\n  eks_managed_node_groups = {\n    nodes = {\n      min_size     = 1\n      max_size     = 3\n      desired_size = 2\n\n      instance_type = [\"t2.small\"]\n    }\n  }\n\n  tags = {\n    Environment = \"dev\"\n    Terraform   = \"true\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gauri17-pro__terraform-jenkins-eks__EKS__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gauri17-pro__terraform-jenkins-eks__EKS__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gauri17-pro__terraform-jenkins-eks__EKS__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gauri17-pro__terraform-jenkins-eks__EKS__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gauri17-pro__terraform-jenkins-eks__EKS__main.tf", "start_line": 32}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n    backend \"s3\" {\n      # Replace this with your bucket name!\n      bucket         = \"ddevops-techstack21\"\n      key            = \"global/s3/terraform.tfstate\"\n      region         = \"us-east-2\"\n\n      # Replace this with your DynamoDB table name!\n      dynamodb_table = \"ddevops-techstack21\"\n      encrypt        = true\n    }\n  }\n\nprovider \"aws\" {\n  region = \"us-east-2\"\n}\n\nresource \"aws_instance\" \"example\" {\n  ami           = \"ami-0fb653ca2d3203ac1\"\n  instance_type = \"t2.micro\"\n\n  tags = {\n    Name = \"devops-techstack\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Devops-Techstack__Terraform__RemoteBackend.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Devops-Techstack__Terraform__RemoteBackend.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Devops-Techstack__Terraform__RemoteBackend.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Devops-Techstack__Terraform__RemoteBackend.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Devops-Techstack__Terraform__RemoteBackend.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Devops-Techstack__Terraform__RemoteBackend.tf", "start_line": 18}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"local_file\" \"pet\" {\n  filename = \"./pets.txt\"\n  content  = \"We love pets!\"\n}\n\nresource \"random_pet\" \"my-pet\" {\n  prefix = \"Mrs\"\n  separator = \".\"\n  length = \"1\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Pradumnasaraf__DevOps__docs__terraform__files__multiple-providers__my-pets.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// TERRAMATE: GENERATED AUTOMATICALLY DO NOT EDIT\n\nresource \"local_file\" \"cloud\" {\n  content = <<-EOT\npackage cloud // import \"github.com/terramate-io/terramate/cloud\"\n\nPackage cloud implements a client SDK for communication with the cloud API.\n\nPackage cloud implements the SDK for communicating with the Terramate Cloud.\n\nconst WellKnownCLIPath = \"/.well-known/cli.json\" ...\nconst PreviewsPath = \"/v1/previews\" ...\nconst BaseURL = \"https://\" + Host\nconst DefaultLogBatchSize = 256\nconst DefaultLogSyncInterval = 1 * time.Second\nconst ErrNotFound errors.Kind = \"resource not found (HTTP Status 404)\"\nconst ErrUnexpectedResponseBody errors.Kind = \"unexpected API response body\"\nconst ErrUnexpectedStatus errors.Kind = \"unexpected status code\"\nconst Host = \"api.terramate.io\"\nfunc Get[T Resource](ctx context.Context, client *Client, u url.URL) (entity T, err error)\nfunc Patch[T Resource](ctx context.Context, client *Client, payload interface{}, url url.URL) (entity T, err error)\nfunc Post[T Resource](ctx context.Context, client *Client, payload interface{}, url url.URL) (entity T, err error)\nfunc Put[T Resource](ctx context.Context, client *Client, payload interface{}, url url.URL) (entity T, err error)\nfunc Request[T Resource](ctx context.Context, c *Client, method string, url url.URL, postBody io.Reader) (entity T, err error)\ntype Author struct{ ... }\ntype ChangesetDetails struct{ ... }\ntype Client struct{ ... }\ntype CommandLog struct{ ... }\ntype CommandLogs []*CommandLog\ntype CreatePreviewOpts struct{ ... }\ntype CreatePreviewPayloadRequest struct{ ... }\ntype CreatePreviewResponse struct{ ... }\ntype CreatedPreview struct{ ... }\ntype Credential interface{ ... }\ntype DeploymentMetadata struct{ ... }\ntype DeploymentStackRequest struct{ ... }\ntype DeploymentStackRequests []DeploymentStackRequest\ntype DeploymentStackResponse struct{ ... }\ntype DeploymentStacksPayloadRequest struct{ ... }\ntype DeploymentStacksResponse []DeploymentStackResponse\ntype Drift struct{ ... }\ntype DriftStackPayloadRequest struct{ ... }\ntype DriftStackPayloadRequests []DriftStackPayloadRequest\ntype Drifts []Drift\ntype DriftsStackPayloadResponse struct{ ... }\ntype EmptyResponse string\ntype GitMetadata struct{ ... }\ntype GithubMetadata struct{ ... }\ntype GitlabMetadata struct{ ... }\ntype Label struct{ ... }\ntype LogChannel int\n    const StdoutLogChannel LogChannel ...\ntype LogSyncer struct{ ... }\n    func NewLogSyncer(syncfn Syncer) *LogSyncer\n    func NewLogSyncerWith(syncfn Syncer, batchSize int, syncInterval time.Duration) *LogSyncer\ntype MemberOrganization struct{ ... }\ntype MemberOrganizations []MemberOrganization\ntype PaginatedResult struct{ ... }\ntype PreviewStack struct{ ... }\ntype PreviewStacks []PreviewStack\ntype Resource interface{ ... }\ntype ResponsePreviewStack struct{ ... }\ntype ResponsePreviewStacks []ResponsePreviewStack\ntype ReviewRequest struct{ ... }\ntype ReviewRequestResponse struct{ ... }\ntype ReviewRequestResponsePayload struct{ ... }\ntype ReviewRequestResponses []ReviewRequestResponse\ntype Reviewer Author\ntype Reviewers []Reviewer\ntype RunContext struct{ ... }\ntype Stack struct{ ... }\ntype StackObject struct{ ... }\ntype StacksResponse struct{ ... }\ntype StatusFilters struct{ ... }\n    func NoStatusFilters() StatusFilters\ntype Syncer func(l CommandLogs)\ntype UUID string\ntype UpdateDeploymentStack struct{ ... }\ntype UpdateDeploymentStacks struct{ ... }\ntype UpdateStackPreviewOpts struct{ ... }\ntype UpdateStackPreviewPayloadRequest struct{ ... }\ntype User struct{ ... }\ntype WellKnown struct{ ... }\nEOT\n\n  filename = \"${path.module}/mock-cloud.ignore\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terramate-io__terramate__cloud___test_mock.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2023 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nresource \"google_project_service\" \"privateca\" {\n  service = \"privateca.googleapis.com\"\n  disable_on_destroy = false\n}\n\nresource \"google_project_service\" \"cloudkms\" {\n  service = \"cloudkms.googleapis.com\"\n  disable_on_destroy = false\n}\n\nresource \"time_sleep\" \"wait_enable_service\" {\n  depends_on = [google_project_service.privateca]\n  create_duration = \"15s\"\n  destroy_duration = \"15s\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__professional-services__examples__certificate-authority-service-hierarchy__apis.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# DON'T EDIT, run $0 instead\nvariable \"url_map\" {\n  type = map(string)\n\n  default = {\n    \"14.12\"  = \"https://nixos-cloud-images.storage.googleapis.com/nixos-14.12.471.1f09b77-x86_64-linux.raw.tar.gz\"\n    \"15.09\"  = \"https://nixos-cloud-images.storage.googleapis.com/nixos-15.09.425.7870f20-x86_64-linux.raw.tar.gz\"\n    \"16.03\"  = \"https://nixos-cloud-images.storage.googleapis.com/nixos-image-16.03.847.8688c17-x86_64-linux.raw.tar.gz\"\n    \"17.03\"  = \"https://nixos-cloud-images.storage.googleapis.com/nixos-image-17.03.1082.4aab5c5798-x86_64-linux.raw.tar.gz\"\n    \"18.03\"  = \"https://nixos-cloud-images.storage.googleapis.com/nixos-image-18.03.132536.fdb5ba4cdf9-x86_64-linux.raw.tar.gz\"\n    \"18.09\"  = \"https://nixos-cloud-images.storage.googleapis.com/nixos-image-18.09.1228.a4c4cbb613c-x86_64-linux.raw.tar.gz\"\n    \"20.03\"  = \"https://nixos-images.storage.googleapis.com/google-cloud-nixos-20.03.1639.73e73c7d6b5.raw.tar.gz\"\n    \"latest\" = \"https://nixos-images.storage.googleapis.com/google-cloud-nixos-20.03.1639.73e73c7d6b5.raw.tar.gz\"\n  }\n\n  description = \"A map of release series to actual releases\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nix-community__terraform-nixos__google_image_nixos__url_map.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-2\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__first_demo__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#--------------------------------------------------------------\n# This module creates all data resources\n#--------------------------------------------------------------\n\nvariable \"name\"               { }\nvariable \"region\"             { }\nvariable \"vpc_id\"             { }\nvariable \"vpc_cidr\"           { }\nvariable \"private_subnet_ids\" { }\nvariable \"public_subnet_ids\"  { }\nvariable \"ssl_cert\"           { }\nvariable \"ssl_key\"            { }\nvariable \"key_name\"           { }\nvariable \"atlas_username\"     { }\nvariable \"atlas_environment\"  { }\nvariable \"atlas_token\"        { }\nvariable \"sub_domain\"         { }\nvariable \"route_zone_id\"      { }\n\nvariable \"consul_amis\"          { }\nvariable \"consul_node_count\"    { }\nvariable \"consul_instance_type\" { }\nvariable \"openvpn_user\"         { }\nvariable \"openvpn_host\"         { }\nvariable \"private_key\"          { }\nvariable \"bastion_host\"         { }\nvariable \"bastion_user\"         { }\n\nvariable \"vault_amis\"          { }\nvariable \"vault_node_count\"    { }\nvariable \"vault_instance_type\" { }\n\nmodule \"consul\" {\n  source = \"./consul\"\n\n  name               = \"${var.name}-consul\"\n  vpc_id             = \"${var.vpc_id}\"\n  vpc_cidr           = \"${var.vpc_cidr}\"\n  private_subnet_ids = \"${var.private_subnet_ids}\"\n  key_name           = \"${var.key_name}\"\n  atlas_username     = \"${var.atlas_username}\"\n  atlas_environment  = \"${var.atlas_environment}\"\n  atlas_token        = \"${var.atlas_token}\"\n  amis               = \"${var.consul_amis}\"\n  nodes              = \"${var.consul_node_count}\"\n  instance_type      = \"${var.consul_instance_type}\"\n  openvpn_user       = \"${var.openvpn_user}\"\n  openvpn_host       = \"${var.openvpn_host}\"\n  private_key        = \"${var.private_key}\"\n  bastion_host       = \"${var.bastion_host}\"\n  bastion_user       = \"${var.bastion_user}\"\n}\n\nmodule \"vault\" {\n  source = \"./vault\"\n\n  name               = \"${var.name}-vault\"\n  region             = \"${var.region}\"\n  vpc_id             = \"${var.vpc_id}\"\n  vpc_cidr           = \"${var.vpc_cidr}\"\n  private_subnet_ids = \"${var.private_subnet_ids}\"\n  public_subnet_ids  = \"${var.public_subnet_ids}\"\n  ssl_cert           = \"${var.ssl_cert}\"\n  ssl_key            = \"${var.ssl_key}\"\n  key_name           = \"${var.key_name}\"\n  atlas_username     = \"${var.atlas_username}\"\n  atlas_environment  = \"${var.atlas_environment}\"\n  atlas_token        = \"${var.atlas_token}\"\n  amis               = \"${var.vault_amis}\"\n  nodes              = \"${var.vault_node_count}\"\n  instance_type      = \"${var.vault_instance_type}\"\n  sub_domain         = \"${var.sub_domain}\"\n  route_zone_id      = \"${var.route_zone_id}\"\n}\n\n# Consul\noutput \"consul_private_ips\" { value = \"${module.consul.private_ips}\" }\n\n# Vault\noutput \"vault_private_ips\"  { value = \"${module.vault.private_ips}\" }\noutput \"vault_elb_dns\"      { value = \"${module.vault.elb_dns}\" }\noutput \"vault_private_fqdn\" { value = \"${module.vault.private_fqdn}\" }\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__data__data.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.aws_region\n}\n\nlocals {\n  bucket_name = \"lambda-tf-way-bucket-101\"\n  lambda_name = \"s3ObjectListenerLambda\"\n  zip_file_name = \"/tmp/s3ObjectListenerLambda.zip\"\n  handler_name = \"s3ObjectListenerLambda.handler\"\n}\n\nmodule \"lambda_tf_way_bucket\" {\n  source = \"../modules/s3\"\n  lambda_tf_way_s3_bucket = local.bucket_name\n}\n\nmodule \"lambda_tf_way_role\" {\n  source = \"../modules/lambda-role\"\n}\n\nmodule \"s3_object_listener_lambda\" {\n  source = \"../modules/lambda\"\n  lambda_function_name = local.lambda_name\n  lambda_function_handler = local.handler_name\n  lambda_role_arn = module.lambda_tf_way_role.lambda_role_arn\n  lambda_zip_filename = local.zip_file_name\n}\n\nmodule \"s3_lambda_event_mapping\" {\n  source = \"../modules/s3-lambda-event-mapping\"\n  lambda_tf_way_bucket_arn = module.lambda_tf_way_bucket.lambda_tf_way_bucket_arn\n  lambda_tf_way_s3_bucket_name = module.lambda_tf_way_bucket.lambda_tf_way_bucket_name\n  lambda_tf_way_function_arn = module.s3_object_listener_lambda.tf_way_lambda_arn\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nsriram__lambda-the-terraform-way__samples__08__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright 2020 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     https://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\nresource \"google_cloudbuild_trigger\" \"default-push-trigger\" {\n    provider = google-beta  # Use Beta version for GitHub support\n    project = var.project_id\n    github {\n        owner = var.github_owner\n        name = var.github_repo_name\n        push {\n            branch = var.github_branch\n        }\n    }\n\n    filename = \"cloudbuild.yaml\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__professional-services__cloudbuild__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nterraform {\n  required_providers {\n    google = {\n      source = \"hashicorp/google\"\n      version = \"~> {{.Provider.version}}\"\n    }\n  }\n}\n\nprovider \"google\" {\n  {{if .Provider.credentials }}credentials = \"{{.Provider.credentials}}\"{{end}}\n}\n\nresource \"google_compute_disk\" \"my-disk-resource\" {\n  project = \"{{.Provider.project}}\"\n  name    = \"my-disk\"\n  type    = \"pd-ssd\"\n  zone    = \"us-central1-a\"\n  image   = \"projects/debian-cloud/global/images/debian-8-jessie-v20170523\"\n  labels  = {\n    \"disk-label-key-a\" = \"disk-label-val-a\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-validator__testdata__templates__disk.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-validator__testdata__templates__disk.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-validator__testdata__templates__disk.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linoproject__terraform__rancher-lab__cloud.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  service_name = \"forum\"\n  owner        = \"Community Team\"\n}\n\nlocals {\n  common_tags = {\n    Service = local.service_name\n    Owner   = local.owner\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/starhawking__python-terrascript__docs__tutorials__locals1.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"google\" {\n  region      = var.region\n  credentials = file(var.credentials_file_path)\n}\n\nprovider \"random\" {\n}\n\nresource \"random_id\" \"project_name\" {\n  byte_length = 8\n}\n\nresource \"google_project\" \"endpoints_project\" {\n  name            = \"Endpoints Project\"\n  project_id      = \"tf-ep-${random_id.project_name.hex}\"\n  org_id          = var.org_id\n  billing_account = var.billing_account_id\n}\n\nresource \"google_project_service\" \"endpoints_project\" {\n  project = google_project.endpoints_project.project_id\n  service = \"compute.googleapis.com\"\n}\n\nresource \"google_project_service\" \"endpoints_project_sm\" {\n  project = google_project.endpoints_project.project_id\n  service = \"servicemanagement.googleapis.com\"\n}\n\nresource \"google_endpoints_service\" \"endpoints_service\" {\n  service_name = \"echo-api.endpoints.${google_project.endpoints_project.project_id}.cloud.goog\"\n  project      = google_project.endpoints_project.project_id\n\n  openapi_config = <<EOF\nswagger: \"2.0\"\ninfo:\n  description: \"A simple Google Cloud Endpoints API example.\"\n  title: \"Endpoints Example\"\n  version: \"1.0.0\"\nhost: \"echo-api.endpoints.${google_project.endpoints_project.project_id}.cloud.goog\"\nbasePath: \"/\"\nconsumes:\n- \"application/json\"\nproduces:\n- \"application/json\"\nschemes:\n- \"https\"\npaths:\n  \"/echo\":\n    post:\n      description: \"Echo back a given message.\"\n      operationId: \"echo\"\n      produces:\n      - \"application/json\"\n      responses:\n        200:\n          description: \"Echo\"\n          schema:\n            $ref: \"#/definitions/echoMessage\"\n      parameters:\n      - description: \"Message to echo\"\n        in: body\n        name: message\n        required: true\n        schema:\n          $ref: \"#/definitions/echoMessage\"\n      security:\n      - api_key: []\ndefinitions:\n  echoMessage:\n    properties:\n      message:\n        type: \"string\"\nEOF\n\n\n  depends_on = [google_project_service.endpoints_project_sm]\n}\n\nresource \"google_compute_network\" \"network\" {\n  name                    = \"ep-network\"\n  auto_create_subnetworks = \"true\"\n  project                 = google_project.endpoints_project.project_id\n  depends_on              = [google_project_service.endpoints_project]\n}\n\n# Allow the hosted network to be hit over ICMP, SSH, and HTTP.\nresource \"google_compute_firewall\" \"network\" {\n  name    = \"allow-ssh-and-icmp\"\n  network = google_compute_network.network.self_link\n  project = google_compute_network.network.project\n\n  allow {\n    protocol = \"icmp\"\n  }\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\", \"80\"]\n  }\n}\n\nresource \"google_compute_instance\" \"project_1_vm\" {\n  name         = \"tf-ep-vm\"\n  project      = google_project.endpoints_project.project_id\n  machine_type = \"f1-micro\"\n  zone         = var.region_zone\n\n  boot_disk {\n    initialize_params {\n      image = \"projects/debian-cloud/global/images/family/debian-8\"\n    }\n  }\n\n  metadata = {\n    endpoints-service-name      = google_endpoints_service.endpoints_service.service_name\n    endpoints-service-config-id = google_endpoints_service.endpoints_service.config_id\n    startup-script              = file(\"scripts/install-vm.sh\")\n  }\n\n  network_interface {\n    network = google_compute_firewall.network.network\n\n    access_config {\n      // Ephemeral IP\n    }\n  }\n\n  service_account {\n    scopes = [\"https://www.googleapis.com/auth/cloud-platform\"]\n  }\n\n  depends_on = [\n    google_project_service.endpoints_project_sm,\n    google_project_service.endpoints_project,\n  ]\n}\n\noutput \"ip\" {\n  value = google_compute_instance.project_1_vm.network_interface[0].access_config[0].nat_ip\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__endpoints-on-compute-engine__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_27", "severity": "HIGH", "message": "Ensure that the default network does not exist in a project", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__endpoints-on-compute-engine__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__endpoints-on-compute-engine__main.tf", "start_line": 103}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__endpoints-on-compute-engine__main.tf", "start_line": 103}, {"tool": "checkov", "rule_id": "CKV_GCP_30", "severity": "HIGH", "message": "Ensure that instances are not configured to use the default service account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__endpoints-on-compute-engine__main.tf", "start_line": 103}, {"tool": "checkov", "rule_id": "CKV_GCP_31", "severity": "HIGH", "message": "Ensure that instances are not configured to use the default service account with full access to all Cloud APIs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__endpoints-on-compute-engine__main.tf", "start_line": 103}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__endpoints-on-compute-engine__main.tf", "start_line": 103}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__endpoints-on-compute-engine__main.tf", "start_line": 103}, {"tool": "checkov", "rule_id": "CKV2_GCP_5", "severity": "CRITICAL", "message": "Ensure that Cloud Audit Logging is configured properly across all services and all users from a project", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__endpoints-on-compute-engine__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_GCP_2", "severity": "CRITICAL", "message": "Ensure legacy networks do not exist for a project", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__endpoints-on-compute-engine__main.tf", "start_line": 13}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-2\"\n}\n\ndata \"aws_vpc\" \"default\" {\n  default = true\n}\n\ndata \"aws_subnets\" \"default\" {\n  filter {\n    name   = \"vpc-id\"\n    values = [data.aws_vpc.default.id]\n  }\n}\n\nresource \"aws_instance\" \"example\" {\n  ami           = \"ami-0a695f0d95cefc163\"\n  instance_type = \"t3.micro\"\n\n  vpc_security_group_ids = [aws_security_group.instance.id]\n\n  user_data = <<-EOF\n              #!/bin/bash\n              echo \"Hello, World\" > index.html\n              nohup busybox httpd -f -p ${var.server_port} &\n              EOF\n\n  user_data_replace_on_change = true\n\n  tags = {\n    Name = \"my-ubuntu\"\n  }\n}\n\nresource \"aws_launch_configuration\" \"example\" {\n  image_id        = \"ami-0a695f0d95cefc163\"\n  instance_type   = \"t3.micro\"\n  security_groups = [aws_security_group.instance.id]\n\n  user_data = <<-EOF\n              #!/bin/bash\n              echo \"Hello, World\" > index.html\n              nohup busybox httpd -f -p ${var.server_port} &\n              EOF\n\n  # Required with an autoscaling group.\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n\nresource \"aws_security_group\" \"instance\" {\n  name = \"web\"\n\n  ingress {\n    from_port   = var.server_port\n    to_port     = var.server_port\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\nresource \"aws_autoscaling_group\" \"example\" {\n  launch_configuration = aws_launch_configuration.example.name\n  vpc_zone_identifier  = data.aws_subnets.default.ids\n\n  target_group_arns = [aws_lb_target_group.asg.arn]\n  health_check_type = \"ELB\"\n\n  min_size = 2\n  max_size = 10\n\n  tag {\n    key                 = \"Name\"\n    value               = \"web\"\n    propagate_at_launch = true\n  }\n}\n\nresource \"aws_lb\" \"example\" {\n  name               = \"web\"\n  load_balancer_type = \"application\"\n  subnets            = data.aws_subnets.default.ids\n  security_groups    = [aws_security_group.alb.id]\n}\n\nresource \"aws_lb_listener\" \"http\" {\n  load_balancer_arn = aws_lb.example.arn\n  port              = 80\n  protocol          = \"HTTP\"\n\n  # By default, it just shows a simple 404 page\n  default_action {\n    type = \"fixed-response\"\n\n    fixed_response {\n      content_type = \"text/plain\"\n      message_body = \"404: page not found\"\n      status_code  = 404\n    }\n  }\n}\n\nresource \"aws_security_group\" \"alb\" {\n  name = \"web-alb\"\n  # Allow inbound HTTP requests\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  # Allow all outbound requests\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\nresource \"aws_lb_target_group\" \"asg\" {\n  name     = \"web-example\"\n  port     = var.server_port\n  protocol = \"HTTP\"\n  vpc_id   = data.aws_vpc.default.id\n\n  health_check {\n    path                = \"/\"\n    protocol            = \"HTTP\"\n    matcher             = \"200\"\n    interval            = 15\n    timeout             = 3\n    healthy_threshold   = 2\n    unhealthy_threshold = 2\n  }\n}\n\nresource \"aws_lb_listener_rule\" \"asg\" {\n  listener_arn = aws_lb_listener.http.arn\n  priority     = 100\n\n  condition {\n    path_pattern {\n      values = [\"*\"]\n    }\n  }\n\n  action {\n    type             = \"forward\"\n    target_group_arn = aws_lb_target_group.asg.arn\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 35}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 35}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV_AWS_315", "severity": "HIGH", "message": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 63}, {"tool": "checkov", "rule_id": "CKV_AWS_131", "severity": "HIGH", "message": "Ensure that ALB drops HTTP headers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 80}, {"tool": "checkov", "rule_id": "CKV_AWS_91", "severity": "HIGH", "message": "Ensure the ELBv2 (Application/Network) has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 80}, {"tool": "checkov", "rule_id": "CKV_AWS_150", "severity": "HIGH", "message": "Ensure that Load Balancer has deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 80}, {"tool": "checkov", "rule_id": "CKV_AWS_2", "severity": "HIGH", "message": "Ensure ALB protocol is HTTPS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 87}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 104}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 104}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 104}, {"tool": "checkov", "rule_id": "CKV2_AWS_20", "severity": "CRITICAL", "message": "Ensure that ALB redirects HTTP requests into HTTPS ones", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 80}, {"tool": "checkov", "rule_id": "CKV2_AWS_28", "severity": "CRITICAL", "message": "Ensure public facing ALB are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 80}, {"tool": "checkov", "rule_id": "CKV_AWS_103", "severity": "HIGH", "message": "Ensure that load balancer is using at least TLS 1.2", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 87}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_378", "severity": "HIGH", "message": "Ensure AWS Load Balancer doesn't use HTTP protocol", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__164__main.tf", "start_line": 123}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"vsphere_datacenter\" \"dc\" {\n  name = var.dc\n}\n\ndata \"vsphere_datastore_cluster\" \"datastore_cluster\" {\n  count         = var.datastore_cluster != \"\" ? 1 : 0\n  name          = var.datastore_cluster\n  datacenter_id = data.vsphere_datacenter.dc.id\n}\n\ndata \"vsphere_datastore\" \"datastore\" {\n  count         = var.datastore != \"\" && var.datastore_cluster == \"\" ? 1 : 0\n  name          = var.datastore\n  datacenter_id = data.vsphere_datacenter.dc.id\n}\n\ndata \"vsphere_datastore\" \"disk_datastore\" {\n  count         = var.disk_datastore != \"\" ? 1 : 0\n  name          = var.disk_datastore\n  datacenter_id = data.vsphere_datacenter.dc.id\n}\n\ndata \"vsphere_resource_pool\" \"pool\" {\n  count         = var.vmrp != \"\" ? 1 : 0\n  name          = var.vmrp\n  datacenter_id = data.vsphere_datacenter.dc.id\n}\n\ndata \"vsphere_network\" \"network\" {\n  count         = length(var.network)\n  name          = var.network_delimiter != null ? split(var.network_delimiter,keys(var.network)[count.index])[1] : keys(var.network)[count.index]\n  datacenter_id = data.vsphere_datacenter.dc.id\n}\n\ndata \"vsphere_virtual_machine\" \"template\" {\n  count         = var.content_library == null ? 1 : 0\n  name          = var.vmtemp\n  datacenter_id = data.vsphere_datacenter.dc.id\n}\n\ndata \"vsphere_content_library\" \"library\" {\n  count      = var.content_library != null ? 1 : 0\n  name       = var.content_library\n  depends_on = [var.tag_depends_on]\n}\n\ndata \"vsphere_content_library_item\" \"library_item_template\" {\n  count      = var.content_library != null ? 1 : 0\n  library_id = data.vsphere_content_library.library[0].id\n  type       = \"ovf\"\n  name       = var.vmtemp\n  depends_on = [var.tag_depends_on]\n}\n\ndata \"vsphere_tag_category\" \"category\" {\n  count      = var.tags != null ? length(var.tags) : 0\n  name       = keys(var.tags)[count.index]\n  depends_on = [var.tag_depends_on]\n}\n\ndata \"vsphere_tag\" \"tag\" {\n  count       = var.tags != null ? length(var.tags) : 0\n  name        = var.tags[keys(var.tags)[count.index]]\n  category_id = data.vsphere_tag_category.category[count.index].id\n  depends_on  = [var.tag_depends_on]\n}\n\ndata \"vsphere_folder\" \"folder\" {\n  count = var.vmfolder != null ? 1 : 0\n  path  = \"/${data.vsphere_datacenter.dc.name}/vm/${var.vmfolder}\"\n  depends_on  = [var.vm_depends_on]\n}\n\nlocals {\n  interface_count     = length(var.ipv4submask) #Used for Subnet handeling\n  template_disk_count = var.content_library == null ? length(data.vsphere_virtual_machine.template[0].disks) : 0\n}\n\n// Cloning a Linux or Windows VM from a given template.\nresource \"vsphere_virtual_machine\" \"vm\" {\n  count      = var.instances\n  depends_on = [var.vm_depends_on]\n  name       = \"${var.staticvmname != null ? var.staticvmname : format(\"${var.vmname}${var.vmnameformat}\", count.index + var.vmstartcount)}${var.fqdnvmname == true ? \".${var.domain}\" : \"\"}\"\n\n  resource_pool_id        = var.vmrp != \"\" ? data.vsphere_resource_pool.pool[0].id : var.vmrpid\n  folder                  = var.vmfolder\n  tags                    = var.tag_ids != null ? var.tag_ids : data.vsphere_tag.tag[*].id\n  custom_attributes       = var.custom_attributes\n  annotation              = var.annotation\n  extra_config            = var.extra_config\n  firmware                = var.content_library == null && var.firmware == null ? data.vsphere_virtual_machine.template[0].firmware : var.firmware\n  efi_secure_boot_enabled = var.content_library == null && var.efi_secure_boot == null ? data.vsphere_virtual_machine.template[0].efi_secure_boot_enabled : var.efi_secure_boot\n  enable_disk_uuid        = var.content_library == null && var.enable_disk_uuid == null ? data.vsphere_virtual_machine.template[0].enable_disk_uuid : var.enable_disk_uuid\n  storage_policy_id       = var.storage_policy_id\n\n  datastore_cluster_id = var.datastore_cluster != \"\" ? data.vsphere_datastore_cluster.datastore_cluster[0].id : null\n  datastore_id         = var.datastore != \"\" ? data.vsphere_datastore.datastore[0].id : null\n\n  num_cpus               = var.cpu_number\n  num_cores_per_socket   = var.num_cores_per_socket\n  cpu_hot_add_enabled    = var.cpu_hot_add_enabled\n  cpu_hot_remove_enabled = var.cpu_hot_remove_enabled\n  cpu_reservation        = var.cpu_reservation\n  cpu_share_level        = var.cpu_share_level\n  cpu_share_count        = var.cpu_share_level == \"custom\" ? var.cpu_share_count : null\n  memory_reservation     = var.memory_reservation\n  memory                 = var.ram_size\n  memory_hot_add_enabled = var.memory_hot_add_enabled\n  memory_share_level     = var.memory_share_level\n  memory_share_count     = var.memory_share_level == \"custom\" ? var.memory_share_count : null\n  guest_id               = var.content_library == null ? data.vsphere_virtual_machine.template[0].guest_id : null\n  scsi_bus_sharing       = var.scsi_bus_sharing\n  scsi_type              = var.scsi_type != \"\" ? var.scsi_type : (var.content_library == null ? data.vsphere_virtual_machine.template[0].scsi_type : null)\n  scsi_controller_count = max(\n    max(0, flatten([\n      for item in values(var.data_disk) : [\n        for elem, val in item :\n        elem == \"data_disk_scsi_controller\" ? val : 0\n    ]])...) + 1,\n    ceil((max(0, flatten([\n      for item in values(var.data_disk) : [\n        for elem, val in item :\n        elem == \"unit_number\" ? val : 0\n    ]])...) + 1) / 15),\n  var.scsi_controller)\n  wait_for_guest_net_routable = var.wait_for_guest_net_routable\n  wait_for_guest_ip_timeout   = var.wait_for_guest_ip_timeout\n  wait_for_guest_net_timeout  = var.wait_for_guest_net_timeout\n\n  ignored_guest_ips = var.ignored_guest_ips\n\n  dynamic \"network_interface\" {\n    for_each = keys(var.network) #data.vsphere_network.network[*].id #other option\n    content {\n      network_id   = data.vsphere_network.network[network_interface.key].id\n      adapter_type = var.network_type != null ? var.network_type[network_interface.key] : (var.content_library == null ? data.vsphere_virtual_machine.template[0].network_interface_types[0] : null)\n    }\n  }\n  // Disks defined in the original template\n  dynamic \"disk\" {\n    for_each = var.content_library == null ? data.vsphere_virtual_machine.template[0].disks : []\n    iterator = template_disks\n    content {\n      label             = length(var.disk_label) > 0 ? var.disk_label[template_disks.key] : \"disk${template_disks.key}\"\n      size              = var.disk_size_gb != null ? var.disk_size_gb[template_disks.key] : data.vsphere_virtual_machine.template[0].disks[template_disks.key].size\n      unit_number       = var.scsi_controller != null ? var.scsi_controller * 15 + template_disks.key : template_disks.key\n      thin_provisioned  = data.vsphere_virtual_machine.template[0].disks[template_disks.key].thin_provisioned\n      eagerly_scrub     = data.vsphere_virtual_machine.template[0].disks[template_disks.key].eagerly_scrub\n      datastore_id      = var.disk_datastore != \"\" ? data.vsphere_datastore.disk_datastore[0].id : null\n      storage_policy_id = length(var.template_storage_policy_id) > 0 ? var.template_storage_policy_id[template_disks.key] : null\n      io_reservation    = length(var.io_reservation) > 0 ? var.io_reservation[template_disks.key] : null\n      io_share_level    = length(var.io_share_level) > 0 ? var.io_share_level[template_disks.key] : \"normal\"\n      io_share_count    = length(var.io_share_level) > 0 && var.io_share_level[template_disks.key] == \"custom\" ? var.io_share_count[template_disks.key] : null\n    }\n  }\n  // Disk for template from Content Library\n  dynamic \"disk\" {\n    for_each = var.content_library == null ? [] : [1]\n    iterator = template_disks\n    content {\n      label             = length(var.disk_label) > 0 ? var.disk_label[template_disks.key] : \"disk${template_disks.key}\"\n      size              = var.disk_size_gb[template_disks.key]\n      unit_number       = var.scsi_controller != null ? var.scsi_controller * 15 + template_disks.key : template_disks.key\n      // thin_provisioned  = data.vsphere_virtual_machine.template[0].disks[template_disks.key].thin_provisioned\n      // eagerly_scrub     = data.vsphere_virtual_machine.template[0].disks[template_disks.key].eagerly_scrub\n      datastore_id      = var.disk_datastore != \"\" ? data.vsphere_datastore.disk_datastore[0].id : null\n      storage_policy_id = length(var.template_storage_policy_id) > 0 ? var.template_storage_policy_id[template_disks.key] : null\n      io_reservation    = length(var.io_reservation) > 0 ? var.io_reservation[template_disks.key] : null\n      io_share_level    = length(var.io_share_level) > 0 ? var.io_share_level[template_disks.key] : \"normal\"\n      io_share_count    = length(var.io_share_level) > 0 && var.io_share_level[template_disks.key] == \"custom\" ? var.io_share_count[template_disks.key] : null\n      disk_mode         = length(var.disk_mode) > 0 ? var.disk_mode[template_disks.key] : null\n    }\n  }\n  // Additional disks defined by Terraform config\n  dynamic \"disk\" {\n    for_each = var.data_disk\n    iterator = terraform_disks\n    content {\n      label = terraform_disks.key\n      size  = lookup(terraform_disks.value, \"size_gb\", null)\n      unit_number = (\n        lookup(\n          terraform_disks.value,\n          \"unit_number\",\n          -1\n          ) < 0 ? (\n          lookup(\n            terraform_disks.value,\n            \"data_disk_scsi_controller\",\n            0\n            ) > 0 ? (\n            (terraform_disks.value.data_disk_scsi_controller * 15) +\n            index(keys(var.data_disk), terraform_disks.key) +\n            (var.scsi_controller == tonumber(terraform_disks.value[\"data_disk_scsi_controller\"]) ? local.template_disk_count : 0)\n            ) : (\n            index(keys(var.data_disk), terraform_disks.key) + local.template_disk_count\n          )\n          ) : (\n          tonumber(terraform_disks.value[\"unit_number\"])\n        )\n      )\n      thin_provisioned  = lookup(terraform_disks.value, \"thin_provisioned\", \"true\")\n      eagerly_scrub     = lookup(terraform_disks.value, \"eagerly_scrub\", \"false\")\n      datastore_id      = lookup(terraform_disks.value, \"datastore_id\", null)\n      storage_policy_id = lookup(terraform_disks.value, \"storage_policy_id\", null)\n      io_reservation    = lookup(terraform_disks.value, \"io_reservation\", null)\n      io_share_level    = lookup(terraform_disks.value, \"io_share_level\", \"normal\")\n      io_share_count    = lookup(terraform_disks.value, \"io_share_level\", null) == \"custom\" ? lookup(terraform_disks.value, \"io_share_count\") : null\n      disk_mode         = lookup(terraform_disks.value, \"disk_mode\", null)\n      disk_sharing      = lookup(terraform_disks.value, \"disk_sharing\", null)\n      attach            = lookup(terraform_disks.value, \"attach\", null)\n      path              = lookup(terraform_disks.value, \"path\", null)\n    }\n  }\n  clone {\n    template_uuid = var.content_library == null ? data.vsphere_virtual_machine.template[0].id : data.vsphere_content_library_item.library_item_template[0].id\n    linked_clone  = var.linked_clone\n    timeout       = var.timeout\n\n    customize {\n      dynamic \"linux_options\" {\n        for_each = var.is_windows_image ? [] : [1]\n        content {\n          host_name    = var.staticvmname != null ? var.staticvmname : format(\"${var.vmname}${var.vmnameformat}\", count.index + var.vmstartcount)\n          domain       = var.domain\n          hw_clock_utc = var.hw_clock_utc\n        }\n      }\n\n      dynamic \"windows_options\" {\n        for_each = var.is_windows_image ? [1] : []\n        content {\n          computer_name         = var.staticvmname != null ? var.staticvmname : format(\"${var.vmname}${var.vmnameformat}\", count.index + var.vmstartcount)\n          admin_password        = var.local_adminpass\n          workgroup             = var.workgroup\n          join_domain           = var.windomain\n          domain_admin_user     = var.domain_admin_user\n          domain_admin_password = var.domain_admin_password\n          organization_name     = var.orgname\n          run_once_command_list = var.run_once\n          auto_logon            = var.auto_logon\n          auto_logon_count      = var.auto_logon_count\n          time_zone             = var.time_zone\n          product_key           = var.productkey\n          full_name             = var.full_name\n        }\n      }\n\n      dynamic \"network_interface\" {\n        for_each = keys(var.network)\n        content {\n          ipv4_address = split(\"/\", var.network[keys(var.network)[network_interface.key]][count.index])[0]\n          ipv4_netmask = var.network[keys(var.network)[network_interface.key]][count.index] == \"\" ? null : (\n            length(split(\"/\", var.network[keys(var.network)[network_interface.key]][count.index])) == 2 ? (\n              split(\"/\", var.network[keys(var.network)[network_interface.key]][count.index])[1]\n              ) : (\n              length(var.ipv4submask) == 1 ? var.ipv4submask[0] : var.ipv4submask[network_interface.key]\n            )\n          )\n        }\n      }\n      dns_server_list = var.dns_server_list\n      dns_suffix_list = var.dns_suffix_list\n      ipv4_gateway    = var.vmgateway\n    }\n  }\n\n  // Advanced options\n  hv_mode                          = var.hv_mode\n  ept_rvi_mode                     = var.ept_rvi_mode\n  nested_hv_enabled                = var.nested_hv_enabled\n  enable_logging                   = var.enable_logging\n  cpu_performance_counters_enabled = var.cpu_performance_counters_enabled\n  swap_placement_policy            = var.swap_placement_policy\n  latency_sensitivity              = var.latency_sensitivity\n\n  shutdown_wait_timeout = var.shutdown_wait_timeout\n  force_power_off       = var.force_power_off\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Terraform-VMWare-Modules__terraform-vsphere-vm__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"sg-out-terraguard-sg-name\" {\n  value = aws_security_group.terraguard-sg.name\n}\n\noutput \"sg-out-terraguard-sg-id\" {\n  value = aws_security_group.terraguard-sg.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__AWS__modules__sg__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    postgresql = {\n      source  = \"cyrilgdn/postgresql\"\n      version = \">=1.12\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cyrilgdn__terraform-provider-postgresql__examples__issues__48__test__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"5.8.0\"\n\n  external_\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vscode-terraform__src__test__integration__basics__workspace__registry_module.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vscode-terraform__src__test__integration__basics__workspace__registry_module.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vscode-terraform__src__test__integration__basics__workspace__registry_module.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#Set the terraform backend\nterraform {\n  # Backend variables are initialized by Azure DevOps\n  backend \"azurerm\" {}\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/microsoft__terraform-azure-devops-starter__201-plan-apply-stages__terraform_backend__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright Amazon.com, Inc. or its affiliates. All rights reserved.\n# SPDX-License-Identifier: Apache-2.0\n#\nmodule \"aft\" {\n  source = \"github.com/aws-ia/terraform-aws-control_tower_account_factory\"\n  # Required Vars\n  ct_management_account_id    = \"111122223333\"\n  log_archive_account_id      = \"444455556666\"\n  audit_account_id            = \"123456789012\"\n  aft_management_account_id   = \"777788889999\"\n  ct_home_region              = \"us-east-1\"\n  tf_backend_secondary_region = \"us-west-2\"\n  # VCS Vars\n  vcs_provider                                  = \"githubenterprise\"\n  github_enterprise_url                         = \"https://github.example.com\"\n  account_request_repo_name                     = \"ExampleOrg/example-repo-1\"\n  global_customizations_repo_name               = \"ExampleOrg/example-repo-2\"\n  account_customizations_repo_name              = \"ExampleOrg/example-repo-3\"\n  account_provisioning_customizations_repo_name = \"ExampleOrg/example-repo-4\"\n  # TF Vars\n  terraform_distribution = \"tfc\"\n  terraform_token        = \"EXAMPLE-uoc1c1qsw7poexampleewjeno1pte3rw\"\n  terraform_org_name     = \"ExampleOrg\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-control_tower_account_factory__examples__githubenterprise+tf_cloud__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nprovider \"azurerm\" {\n  features {}\n}\n\nresource \"azurerm_resource_group\" \"example\" {\n  name     = \"${var.prefix}-resources\"\n  location = var.location\n}\n\nresource \"azurerm_automation_account\" \"example\" {\n  name                = \"${var.prefix}-autoacc\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  sku {\n    name = \"Basic\"\n  }\n}\n\nresource \"azurerm_automation_runbook\" \"example\" {\n  name                = \"Get-AzureVMTutorial\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  account_name        = azurerm_automation_account.example.name\n  log_verbose         = \"true\"\n  log_progress        = \"true\"\n  description         = \"This is an example runbook\"\n  runbook_type        = \"PowerShellWorkflow\"\n\n  publish_content_link {\n    uri = \"https://raw.githubusercontent.com/Azure/azure-quickstart-templates/c4935ffb69246a6058eb24f54640f53f69d3ac9f/101-automation-runbook-getvms/Runbooks/Get-AzureVMTutorial.ps1\"\n  }\n}\n\nresource \"azurerm_automation_schedule\" \"one-time\" {\n  name                    = \"${var.prefix}-one-time\"\n  resource_group_name     = azurerm_resource_group.example.name\n  automation_account_name = azurerm_automation_account.example.name\n  frequency               = \"OneTime\"\n\n  // The start_time defaults to now + 7 min\n}\n\nresource \"azurerm_automation_schedule\" \"hour\" {\n  name                    = \"${var.prefix}-hour\"\n  resource_group_name     = azurerm_resource_group.example.name\n  automation_account_name = azurerm_automation_account.example.name\n  frequency               = \"Hour\"\n  interval                = 2\n\n  // Timezone defaults to UTC\n}\n\n// Schedules the example runbook to run on the hour schedule\nresource \"azurerm_automation_job_schedule\" \"example\" {\n  resource_group_name     = azurerm_resource_group.example.name\n  automation_account_name = azurerm_automation_account.example.name\n  runbook_name            = azurerm_automation_runbook.example.name\n  schedule_name           = azurerm_automation_schedule.hour.name\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-azurerm__examples__automation-account__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AZURE_36", "severity": "CRITICAL", "message": "Ensure Azure automation account is configured with managed identity", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-azurerm__examples__automation-account__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AZURE_24", "severity": "CRITICAL", "message": "Ensure Azure automation account does NOT have overly permissive network access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-azurerm__examples__automation-account__main.tf", "start_line": 13}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"region\" {\n  type        = \"string\"\n  description = \"AWS Region required by Terraform AWS Provider\"\n  default     = \"us-east-1\"\n  }\n\nvariable \"s3_bucket_region\" {\n  type        = \"string\"\n  description = \"Region where S3 bucket will be created used to store remote state file\"\n  default     = \"us-east-1\"\n  }\n\nvariable \"s3_bucket_name\" {\n  type        = \"string\"\n  description = \"Name of the S3 bucket to be created used to store the remote state file\"\n  default     = \"rc-tf-bucket-training-exersize-1\"\n  }\n\nvariable \"tag_env\" {\n  type        = \"string\"\n  description = \"Tag for Environment Name\"\n  default     = \"training\"\n  }\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_2__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright 2025 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\nvariable \"project_id\" {\n  type        = string\n  description = \"Host Project ID\"\n}\n\nvariable \"org_policies\" {\n  type        = bool\n  description = \"Whether to enable org policies or not\"\n}\n\nvariable \"location\" {\n  type        = string\n  description = \"Location (region) to deploy to\"\n}\n\nvariable \"firestore_location\" {\n  type        = string\n  description = \"Location (region) to deploy firestore (e.g. eur3)\"\n}\n\nvariable \"bucket_location\" {\n  type        = string\n  description = \"Location (region) to deploy bucket (e.g. eu)\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__generative-ai__gemini__autocal__terraform__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Input Variables\n# GCP Project\nvariable \"gcp_project\" {\n  description = \"Project in which GCP Resources to be created\"\n  type = string\n  default = \"kdaida123\"\n}\n\n# GCP Region\nvariable \"gcp_region1\" {\n  description = \"Region in which GCP Resources to be created\"\n  type = string\n  default = \"us-east1\"\n}\n\n# GCP Compute Engine Machine Type\nvariable \"machine_type\" {\n  description = \"Compute Engine Machine Type\"\n  type = string\n  default = \"e2-small\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-google-cloud__05-Terraform-Variables-Output-Values__terraform-manifests__c2-variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"acm_certificate_arn\" {\n  description = \"The ARN of the certificate\"\n  value       = module.acm.acm_certificate_arn\n}\n\noutput \"acm_certificate_domain_validation_options\" {\n  description = \"A list of attributes to feed into other resources to complete certificate validation. Can have more than one element, e.g. if SANs are defined. Only set if DNS-validation was used.\"\n  value       = module.acm.acm_certificate_domain_validation_options\n}\n\noutput \"acm_certificate_status\" {\n  description = \"Status of the certificate.\"\n  value       = module.acm.acm_certificate_status\n}\n\noutput \"acm_certificate_validation_emails\" {\n  description = \"A list of addresses that received a validation E-Mail. Only set if EMAIL-validation was used.\"\n  value       = module.acm.acm_certificate_validation_emails\n}\n\noutput \"validation_route53_record_fqdns\" {\n  description = \"List of FQDNs built using the zone domain and name.\"\n  value       = module.acm.validation_route53_record_fqdns\n}\n\noutput \"distinct_domain_names\" {\n  description = \"List of distinct domains names used for the validation.\"\n  value       = module.acm.distinct_domain_names\n}\n\noutput \"validation_domains\" {\n  description = \"List of distinct domain validation options. This is useful if subject alternative names contain wildcards.\"\n  value       = module.acm.validation_domains\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-acm__examples__complete-dns-validation__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \">= 3.7.0\"\n    }\n  }\n\n  # Update this block with the location of your terraform state file\n  backend \"azurerm\" {\n    resource_group_name  = \"rg-terraform-github-actions-state\"\n    storage_account_name = \"terraformgithubactions\"\n    container_name       = \"tfstate\"\n    key                  = \"terraform.tfstate\"\n    use_oidc             = true\n  }\n}\n\nprovider \"azurerm\" {\n  features {}\n  use_oidc = true\n}\n\n# Define any Azure resources to be created here. A simple resource group is shown here as a minimal example.\nresource \"azurerm_resource_group\" \"rg-aks\" {\n  name     = var.resource_group_name\n  location = var.location\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure-Samples__terraform-github-actions__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#--------------------------------------------------------------\n# This module creates all resources necessary for a Bastion\n# host\n#--------------------------------------------------------------\n\nvariable \"name\"              { default = \"bastion\" }\nvariable \"vpc_id\"            { }\nvariable \"vpc_cidr\"          { }\nvariable \"region\"            { }\nvariable \"public_subnet_ids\" { }\nvariable \"key_name\"          { }\nvariable \"instance_type\"     { }\n\nresource \"aws_security_group\" \"bastion\" {\n  name        = \"${var.name}\"\n  vpc_id      = \"${var.vpc_id}\"\n  description = \"Bastion security group\"\n\n  tags      { Name = \"${var.name}\" }\n  lifecycle { create_before_destroy = true }\n\n  ingress {\n    protocol    = -1\n    from_port   = 0\n    to_port     = 0\n    cidr_blocks = [\"${var.vpc_cidr}\"]\n  }\n\n  ingress {\n    protocol    = \"tcp\"\n    from_port   = 22\n    to_port     = 22\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    protocol    = -1\n    from_port   = 0\n    to_port     = 0\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\nmodule \"ami\" {\n  source        = \"github.com/terraform-community-modules/tf_aws_ubuntu_ami/ebs\"\n  instance_type = \"${var.instance_type}\"\n  region        = \"${var.region}\"\n  distribution  = \"trusty\"\n}\n\nresource \"aws_instance\" \"bastion\" {\n  ami                         = \"${module.ami.ami_id}\"\n  instance_type               = \"${var.instance_type}\"\n  subnet_id                   = \"${element(split(\",\", var.public_subnet_ids), count.index)}\"\n  key_name                    = \"${var.key_name}\"\n  vpc_security_group_ids      = [\"${aws_security_group.bastion.id}\"]\n  associate_public_ip_address = true\n\n  tags      { Name = \"${var.name}\" }\n  lifecycle { create_before_destroy = true }\n}\n\noutput \"user\"       { value = \"ubuntu\" }\noutput \"private_ip\" { value = \"${aws_instance.bastion.private_ip}\" }\noutput \"public_ip\"  { value = \"${aws_instance.bastion.public_ip}\" }\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__network__bastion__bastion.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__network__bastion__bastion.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__network__bastion__bastion.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__network__bastion__bastion.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__network__bastion__bastion.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__network__bastion__bastion.tf", "start_line": 51}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__network__bastion__bastion.tf", "start_line": 51}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__network__bastion__bastion.tf", "start_line": 51}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__network__bastion__bastion.tf", "start_line": 51}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__network__bastion__bastion.tf", "start_line": 51}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__best-practices__terraform__modules__aws__network__bastion__bastion.tf", "start_line": 51}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_role\" \"aikido-security-readonly-role\" {\n  name = \"aikido-security-readonly-role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\",\n    Statement = [\n      {\n        Effect = \"Allow\",\n        Principal = {\n          AWS = var.aikido-principal-arn\n        },\n        Action = \"sts:AssumeRole\",\n        Condition = {\n          StringEquals = {\n            \"sts:ExternalId\" = var.aikido-role-external-id\n          }\n        }\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"aikido-managed-role\" {\n  policy_arn = \"arn:aws:iam::aws:policy/SecurityAudit\"\n  role       = aws_iam_role.aikido-security-readonly-role.id\n}\n\nresource \"aws_iam_role_policy\" \"aikido-security-policy\" {\n  name = \"aikido-security-policy\"\n  role = aws_iam_role.aikido-security-readonly-role.id\n  policy = jsonencode({\n    Version = \"2012-10-17\",\n    Statement = [\n      {\n        Action = [\n          \"iam:CreateServiceLinkedRole\",\n          \"inspector2:*\",\n          \"budgets:ViewBudget\",\n          \"backup:ListBackupPlans\",\n          \"backup:GetBackupPlan\",\n          \"backup:ListProtectedResources\"\n        ],\n        Resource = \"*\",\n        Effect   = \"Allow\"\n      }\n    ]\n  })\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in4it__terraform-modules__modules__aikido__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_289", "severity": "HIGH", "message": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in4it__terraform-modules__modules__aikido__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in4it__terraform-modules__modules__aikido__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in4it__terraform-modules__modules__aikido__main.tf", "start_line": 27}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ECDSA key with P384 elliptic curve\nephemeral \"tls_private_key\" \"ecdsa-p384-example\" {\n  algorithm   = \"ECDSA\"\n  ecdsa_curve = \"P384\"\n}\n\n# RSA key of size 4096 bits\nephemeral \"tls_private_key\" \"rsa-4096-example\" {\n  algorithm = \"RSA\"\n  rsa_bits  = 4096\n}\n\n# ED25519 key\nephemeral \"tls_private_key\" \"ed25519-example\" {\n  algorithm = \"ED25519\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-tls__examples__ephemeral-resources__tls_private_key__ephemeral-resource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"alicloud__security_group_id\" {\n  value = alicloud_security_group.group.id\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HXSecurity__TerraformGoat__aliyun__networking__vpc_security_group_open_all_ports__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"s3\" {\n    bucket         = \"my-tf-test-bucket-svhgsjhgbn-7893121036\"\n    key            = \"dev/vpc.tfstate\"\n    region         = \"us-east-1\"\n    dynamodb_table = \"state-locking\"\n    profile = \"dev\"\n\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/telugudevopsguru__terraform__dev__vpc__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"random_string\" \"my_string\" {\n  length      = 11\n}\n\noutput \"output_string\" {\n  value = \"the_string\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/dflook__terraform-github-actions__tests__workflows__pull_request_review__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.region\n}\n\n################################################################################\n# Parameter Store\n################################################################################\n\n# # CodeDeploy Application Parameter\n# data \"aws_ssm_parameter\" \"codedeploy_app\" {\n#   name = \"/codedeploy/app/deploy_development_ecsdemo-frontend\"\n# }\n\n# # CodeDeploy Deployment Group Parameter\n# data \"aws_ssm_parameter\" \"deployment_group\" {\n#   name = \"/codedeploy/deployment-group/deploy_development_ecsdemo-frontend\"\n# }\n\n################################################################################\n# ECR and Git Repositories\n################################################################################\n\n# CodeCommit repository\nresource \"aws_codecommit_repository\" \"example_repo\" {\n  repository_name = \"ecs_service_repo\"\n}\n\nresource \"aws_ecr_repository\" \"example_repo\" {\n  name                 = \"ecs_service_repo\"\n  image_tag_mutability = \"MUTABLE\"\n\n  image_scanning_configuration {\n    scan_on_push = true\n  }\n}\n\n################################################################################\n# CodePipleine IAM role\n################################################################################\n\nresource \"aws_iam_role\" \"codepipeline_role\" {\n  name = \"codepipeline-app-role\"\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\",\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\",\n        Effect = \"Allow\",\n        Principal = {\n          Service = \"codepipeline.amazonaws.com\"\n        }\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"codepipeline_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AWSCodePipeline_FullAccess\" # Attach a policy that provides necessary permissions\n  role       = aws_iam_role.codepipeline_role.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"codecommit_codepipeline_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AWSCodeCommitFullAccess\" # Attach a policy that provides necessary permissions\n  role       = aws_iam_role.codepipeline_role.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"s3_codepipeline_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonS3FullAccess\" # Attach a policy that provides necessary permissions\n  role       = aws_iam_role.codepipeline_role.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"codebuild_codepipeline_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AWSCodeBuildDeveloperAccess\" # Attach a policy that provides necessary permissions\n  role       = aws_iam_role.codepipeline_role.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"cloudwatch_codepipeline_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/CloudWatchLogsFullAccess\" # Attach a policy that provides necessary permissions\n  role       = aws_iam_role.codepipeline_role.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"codedeploy_ecs_codepipeline_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonECS_FullAccess\" # Attach a policy that provides necessary permissions\n  role       = aws_iam_role.codepipeline_role.name\n}\n\n\nresource \"aws_iam_role_policy_attachment\" \"codedeploy_codepipeline_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AWSCodeDeployDeployerAccess\" # Attach a policy that provides necessary permissions\n  role       = aws_iam_role.codepipeline_role.name\n}\n\n################################################################################\n# CodeBuild Container Build Permissions\n################################################################################\n\nresource \"aws_iam_role\" \"codebuild_role\" {\n  name = \"codebuild-to-ecr-role\"\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\",\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\",\n        Effect = \"Allow\",\n        Principal = {\n          Service = \"codebuild.amazonaws.com\"\n        }\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"codebuild_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AWSCodeBuildDeveloperAccess\" # Attach a policy that provides necessary permissions\n  role       = aws_iam_role.codebuild_role.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"ecs_codebuild_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonECS_FullAccess\" # Attach a policy that provides necessary permissions\n  role       = aws_iam_role.codebuild_role.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"ecr_codebuild_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryFullAccess\" # Attach a policy that provides necessary permissions\n  role       = aws_iam_role.codebuild_role.name\n}\n\nresource \"aws_iam_policy\" \"codebuild_all_permissions\" {\n  description = \"IAM policy for AWS CodeBuild with all necessary permissions\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\",\n    Statement = [\n      {\n        Effect = \"Allow\",\n        Action = [\n          \"ssm:GetParameter\",\n          \"ssm:GetParameters\",\n          \"ssm:PutParameter\",\n          \"ssm:DescribeParameters\",\n          \"ssm:ListTagsForResource\",\n          \"ssm:DeleteParameter\",\n          \"logs:*\",\n          \"ec2:*\",\n          \"ecs:*\",\n          \"iam:PassRole\",\n          \"servicediscovery:*\",\n          \"s3:ListBucket\",\n          \"s3:GetObject\",\n          \"s3:PutObject\",\n          \"codebuild:*\",\n          \"codedeploy:*\",\n          \"s3:ListAllMyBuckets\",\n          \"s3:GetBucketLocation\",\n        ],\n        Resource = \"*\",\n      },\n    ],\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"codebuild_all_permissions_attachment\" {\n  policy_arn = aws_iam_policy.codebuild_all_permissions.arn\n  role       = aws_iam_role.codebuild_role.name\n}\n\n################################################################################\n# CodeBuild Module\n################################################################################\n\nresource \"random_id\" \"this\" {\n  byte_length = 8\n}\n\nmodule \"codepipeline_s3_bucket\" {\n  source  = \"terraform-aws-modules/s3-bucket/aws\"\n  version = \"~> 3.15\"\n\n  bucket_prefix = \"codepipeline-${var.region}-\"\n  # acl           = \"private\"\n\n  # For example only - please re-evaluate for your environment\n  force_destroy = true\n\n  attach_deny_insecure_transport_policy = true\n  attach_require_latest_tls_policy      = true\n\n  server_side_encryption_configuration = {\n    rule = {\n      apply_server_side_encryption_by_default = {\n        sse_algorithm = \"AES256\"\n      }\n    }\n  }\n}\n\nmodule \"build_container\" {\n  source = \"../../modules/codebuild\"\n\n  name           = \"dev-lb-service-codebuild\"\n  service_role   = aws_iam_role.codebuild_role.arn\n  buildspec_path = \"./buildspec-cicd.yml\"\n  s3_bucket      = module.codepipeline_s3_bucket\n\n  environment = {\n    image           = \"aws/codebuild/standard:5.0\"\n    privileged_mode = true\n    environment_variables = [\n      {\n        name  = \"REPO_URL\"\n        value = aws_ecr_repository.example_repo.repository_url\n      }\n    ]\n  }\n\n  create_iam_role = true\n  iam_role_name   = \"dev-codebuild-${random_id.this.hex}\"\n  ecr_repository  = aws_ecr_repository.example_repo.arn\n}\n\n################################################################################\n# CodePipeline\n################################################################################\n\nresource \"aws_codepipeline\" \"example_applicaiton_pipeline\" {\n  name     = \"example-applicaiton-pipeline\"\n  role_arn = aws_iam_role.codepipeline_role.arn\n\n  artifact_store {\n    location = module.codepipeline_s3_bucket.s3_bucket_id\n    type     = \"S3\"\n  }\n\n  stage {\n    name = \"Source\"\n\n    action {\n      name             = \"SourceAction\"\n      category         = \"Source\"\n      owner            = \"AWS\"\n      provider         = \"CodeCommit\"\n      version          = \"1\"\n      output_artifacts = [\"SourceArtifact\"]\n\n      configuration = {\n        RepositoryName = aws_codecommit_repository.example_repo.repository_name\n        BranchName     = \"main\" # Replace with your branch name\n      }\n    }\n  }\n\n  stage {\n    name = \"build-lb-service\"\n\n    action {\n      name             = \"BuildAction\"\n      category         = \"Build\"\n      owner            = \"AWS\"\n      provider         = \"CodeBuild\"\n      version          = \"1\"\n      input_artifacts  = [\"SourceArtifact\"]\n      output_artifacts = [\"BuildArtifact\"]\n\n      configuration = {\n        ProjectName = module.build_container.project_id\n      }\n    }\n  }\n\n  stage {\n    name = \"deploy-lb-service\"\n\n    action {\n      name            = \"deploy-action\"\n      category        = \"Deploy\"\n      owner           = \"AWS\"\n      provider        = \"CodeDeployToECS\"\n      version         = \"1\"\n      input_artifacts = [\"BuildArtifact\"]\n\n      configuration = {\n        ApplicationName                = \"deploy_development_ecsdemo-frontend\"\n        DeploymentGroupName            = \"deployment-group-deploy_development_ecsdemo-frontend\"\n        TaskDefinitionTemplateArtifact = \"BuildArtifact\"\n        TaskDefinitionTemplatePath     = \"development-task-definition.json\"\n        AppSpecTemplateArtifact        = \"BuildArtifact\"\n        AppSpecTemplatePath            = \"development-appspec.json.json\"\n      }\n    }\n  }\n\n  # You can add more stages for deployment or testing as needed\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_51", "severity": "HIGH", "message": "Ensure ECR Image Tags are immutable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_136", "severity": "HIGH", "message": "Ensure that ECR repositories are encrypted using KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_287", "severity": "HIGH", "message": "Ensure IAM policies does not allow credentials exposure", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "start_line": 130}, {"tool": "checkov", "rule_id": "CKV_AWS_288", "severity": "HIGH", "message": "Ensure IAM policies does not allow data exfiltration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "start_line": 130}, {"tool": "checkov", "rule_id": "CKV_AWS_289", "severity": "HIGH", "message": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "start_line": 130}, {"tool": "checkov", "rule_id": "CKV_AWS_286", "severity": "HIGH", "message": "Ensure IAM policies does not allow privilege escalation", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "start_line": 130}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "start_line": 130}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "start_line": 130}, {"tool": "checkov", "rule_id": "CKV_AWS_219", "severity": "HIGH", "message": "Ensure CodePipeline Artifact store is using a KMS CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "start_line": 227}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "start_line": 177}, {"tool": "checkov", "rule_id": "CKV2_AWS_37", "severity": "CRITICAL", "message": "Ensure CodeCommit associates an approval rule", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__main.tf", "start_line": 24}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_route53_zone\" \"main\" {\n  count = var.create_r53_zone && var.zone_id == null ? 0 : 1\n\n  name         = \"${var.domain_name}.\"\n  private_zone = false\n}\n\nmodule \"r53_zone\" {\n  source  = \"terraform-aws-modules/route53/aws//modules/zones\"\n  version = \"2.10.2\"\n\n  create = var.create_r53_zone\n\n  zones = {\n    (var.domain_name) = {\n      comment = var.domain_name\n      tags    = local.tags\n    }\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/maddevsio__aws-eks-base__terraform__layer1-aws__aws-r53.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/maddevsio__aws-eks-base__terraform__layer1-aws__aws-r53.tf", "start_line": 8}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Notes:\n# 1. Set values of AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY environment variables.\n\nterraform {\n  required_version = \">= 0.12.6, < 0.14\"\n\n  required_providers {\n    aws = \">= 2.46, < 4.0\"\n  }\n}\n\nprovider \"aws\" {\n  region  = \"eu-west-1\"\n  version = \"~> 3.0\"\n\n  //  allowed_account_ids = [\"905033465232\"] # 835367859851 - anton-demo; 905033465232 - tfworkshop\n\n  //  # Alternatively, IAM role can be assumed\n  //  assume_role {\n  //    role_arn = \"arn:aws:iam::905033465232:role/OrganizationAccountAccessRole\"\n  //  }\n}\n\nlocals {\n  #######################\n  # EDIT BELOW THIS LINE\n  #######################\n  name = \"tfworkshop-userX\"\n\n  tags = {\n    Name  = local.name\n    Owner = \"userX\"\n  }\n  #######################\n  # EDIT ABOVE THIS LINE\n  #######################\n}\n\ndata \"aws_caller_identity\" \"this\" {\n}\n\n##################################################\n# VPC\n##################################################\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"~> 2.0\"\n\n  name = local.name\n\n  cidr = \"10.10.0.0/16\"\n\n  azs             = [\"eu-west-1a\", \"eu-west-1b\", \"eu-west-1c\"]\n  private_subnets = [\"10.10.1.0/24\", \"10.10.2.0/24\", \"10.10.3.0/24\"]\n  public_subnets  = [\"10.10.11.0/24\", \"10.10.12.0/24\", \"10.10.13.0/24\"]\n\n  //  # Use arguments below with data-source aws_availability_zones.available to span resources in all availability zones\n  //  azs            = [for v in data.aws_availability_zones.available.names : v]\n  //  public_subnets = [for k, v in data.aws_availability_zones.available.names : cidrsubnet(\"10.10.0.0/16\", 8, k)]\n\n  enable_dns_hostnames = true\n  enable_dns_support   = true\n\n  enable_nat_gateway = true\n  single_nat_gateway = true\n\n  tags = local.tags\n}\n\n##################################################\n# Launch configuration and autoscaling\n##################################################\ndata \"aws_ami\" \"amazon_linux\" {\n  most_recent = true\n\n  owners = [\"amazon\"]\n\n  filter {\n    name = \"name\"\n\n    values = [\n      \"amzn-ami-hvm-*-x86_64-gp2\",\n    ]\n  }\n}\n\ndata \"template_file\" \"ec2_userdata\" {\n  template = <<EOF\n#cloud-config\nruncmd:\n  - yum install -y nginx\n  - service nginx start\nEOF\n\n}\n\nmodule \"autoscaling\" {\n  source  = \"terraform-aws-modules/autoscaling/aws\"\n  version = \"~> 3.0\"\n\n  name = local.name\n\n  # Launch configuration\n  image_id                     = data.aws_ami.amazon_linux.id\n  instance_type                = \"t2.micro\"\n  security_groups              = [module.ec2_security_group.this_security_group_id]\n  user_data                    = data.template_file.ec2_userdata.rendered\n  key_name                     = \"\"\n  associate_public_ip_address  = true\n  recreate_asg_when_lc_changes = true\n\n  # Autoscaling group\n  vpc_zone_identifier = module.vpc.public_subnets\n  health_check_type   = \"EC2\"\n  min_size            = 1\n  max_size            = 1\n  desired_capacity    = 1\n\n  tags_as_map = local.tags\n}\n\n##################################################\n# EC2 security group\n##################################################\nmodule \"ec2_security_group\" {\n  source  = \"terraform-aws-modules/security-group/aws\"\n  version = \"~> 3.0\"\n\n  name = local.name\n\n  description = \"EC2 security group with publicly open HTTP and SSH ports\"\n  vpc_id      = module.vpc.vpc_id\n\n  ingress_cidr_blocks = [\"0.0.0.0/0\"]\n  ingress_rules       = [\"http-80-tcp\", \"ssh-tcp\", \"all-icmp\"]\n\n  egress_cidr_blocks = [\"0.0.0.0/0\"]\n  egress_rules       = [\"all-all\"]\n\n  tags = local.tags\n}\n\n##################################################\n# This code may not be working when there are no matching instances.\n# Alternatively use AWS CLI:\n# aws ec2 describe-instances --filters 'Name=tag:Name,Values=tfworkshop-*' --output json --region eu-west-1 | jq -r '.Reservations[].Instances[].PublicIpAddress'\n##################################################\n//data \"aws_instance\" \"created\" {\n//  instance_tags = local.tags\n//\n//  depends_on = [module.autoscaling]\n//}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices-workshop__solutions__1-network__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices-workshop__solutions__1-network__main.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices-workshop__solutions__1-network__main.tf", "start_line": 97}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices-workshop__solutions__1-network__main.tf", "start_line": 125}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Terraform Provider Configuration: google\nprovider \"google\" {\n  project = \"gcplearn9\"\n  region = \"us-central1\"\n}\n\n# Resource: VPC\nresource \"google_compute_network\" \"myvpc\" {\n  name = \"vpc1\"\n  auto_create_subnetworks = false   \n}\n\n# Resource: Subnet\nresource \"google_compute_subnetwork\" \"mysubnet\" {\n  name          = \"subnet1\"\n  region        = \"us-central1\"\n  ip_cidr_range = \"10.128.0.0/20\"\n  network       = google_compute_network.myvpc.id  // GET VPC ID\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-google-cloud__02-Terraform-Commands__terraform-manifests__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_26", "severity": "HIGH", "message": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-google-cloud__02-Terraform-Commands__terraform-manifests__vpc.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_GCP_74", "severity": "HIGH", "message": "Ensure that private_ip_google_access is enabled for Subnet", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-google-cloud__02-Terraform-Commands__terraform-manifests__vpc.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV2_GCP_18", "severity": "CRITICAL", "message": "Ensure GCP network defines a firewall and does not use the default firewall", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-google-cloud__02-Terraform-Commands__terraform-manifests__vpc.tf", "start_line": 8}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"environment\" {\n    type = string\n    description = \"the env type\"\n    default = \"staging\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/piyushsachdeva__Terraform-Full-Course-Azure__lessons__day06__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-rds__examples__blue-green-deployment__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_ecr_repository\" \"demo\" {\n  name = \"demo\"\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wardviaene__terraform-course__codepipeline-demo__ecr.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_163", "severity": "HIGH", "message": "Ensure ECR image scanning on push is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wardviaene__terraform-course__codepipeline-demo__ecr.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_51", "severity": "HIGH", "message": "Ensure ECR Image Tags are immutable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wardviaene__terraform-course__codepipeline-demo__ecr.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_136", "severity": "HIGH", "message": "Ensure that ECR repositories are encrypted using KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wardviaene__terraform-course__codepipeline-demo__ecr.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region                      = \"us-east-1\" # <<<<< Try changing this to eu-west-1 to compare the costs\n  skip_credentials_validation = true\n  skip_requesting_account_id  = true\n  access_key                  = \"mock_access_key\"\n  secret_key                  = \"mock_secret_key\"\n}\n\nmodule \"small_app\" {\n  source              = \"./modules/instance\"\n  instance_type       = \"m5.4xlarge\"\n  volume_type         = \"io1\"\n  child_instance_type = \"m5.8xlarge\"\n}\n\nmodule \"small_app_gp2\" {\n  source              = \"./modules/instance\"\n  instance_type       = \"m5.4xlarge\"\n  volume_type         = \"gp2\"\n  child_instance_type = \"m5.8xlarge\"\n}\n\nmodule \"big_app\" {\n  source              = \"./modules/instance\"\n  instance_type       = \"m5.8xlarge\"\n  volume_type         = \"gp2\"\n  child_instance_type = \"m5.4xlarge\"\n}\n\nmodule \"big_app_gp2\" {\n  source              = \"./modules/instance\"\n  instance_type       = \"m5.8xlarge\"\n  volume_type         = \"gp2\"\n  child_instance_type = \"m5.4xlarge\"\n}\n\nmodule \"big_app_with_output\" {\n  source              = \"./modules/instance\"\n  instance_type       = module.big_app_gp2.parent_instance_type\n  volume_type         = \"gp2\"\n  child_instance_type = \"m5.4xlarge\"\n}\n\nresource \"aws_lambda_function\" \"hello_world\" {\n  function_name = \"hello_world\"\n  role          = \"arn:aws:lambda:us-east-1:aws:resource-id\"\n  handler       = \"exports.test\"\n  runtime       = \"nodejs12.x\"\n  filename      = \"function.zip\"\n  memory_size   = var.memory_size\n}\n\nresource \"aws_instance\" \"web_app\" {\n  ami           = \"ami-674cbc1e\"\n  instance_type = var.instance_type\n\n  root_block_device {\n    volume_size = 50\n  }\n\n  ebs_block_device {\n    device_name = \"my_data\"\n    volume_type = var.volume_type # <<<<< Try changing this to gp2 to compare costs\n    volume_size = 1000\n    iops        = 800\n  }\n}\n\nvariable \"memory_size\" {\n  default = 1024\n}\n\nvariable \"instance_type\" {\n  default = \"m5.2xlarge\"\n}\n\nvariable \"volume_type\" {\n  default = \"io1\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_directory_with_recursive_modules__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_363", "severity": "HIGH", "message": "Ensure Lambda Runtime is not deprecated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_directory_with_recursive_modules__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_directory_with_recursive_modules__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_directory_with_recursive_modules__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_directory_with_recursive_modules__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_directory_with_recursive_modules__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_directory_with_recursive_modules__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_directory_with_recursive_modules__main.tf", "start_line": 53}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_directory_with_recursive_modules__main.tf", "start_line": 53}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_directory_with_recursive_modules__main.tf", "start_line": 53}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_terraform_directory_with_recursive_modules__main.tf", "start_line": 53}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"s3\" {\n    bucket = \"terraform-state-devopsthehardway\"\n    key    = \"ecr-terraform.tfstate\"\n    region = \"us-east-1\"\n  }\n  required_providers {\n    aws = {\n      source = \"hashicorp/aws\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nresource \"aws_ecr_repository\" \"devopsthehardway-ecr-repo\" {\n  name                 = var.repo_name\n  image_tag_mutability = \"MUTABLE\"\n\n  image_scanning_configuration {\n    scan_on_push = true\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AdminTurnedDevOps__DevOps-The-Hard-Way-AWS__Terraform-AWS-Services-Creation__ECR__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_51", "severity": "HIGH", "message": "Ensure ECR Image Tags are immutable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AdminTurnedDevOps__DevOps-The-Hard-Way-AWS__Terraform-AWS-Services-Creation__ECR__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_136", "severity": "HIGH", "message": "Ensure that ECR repositories are encrypted using KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AdminTurnedDevOps__DevOps-The-Hard-Way-AWS__Terraform-AWS-Services-Creation__ECR__main.tf", "start_line": 18}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlocals {\n  default_suffix = var.suffix == \"\" ? random_string.suffix.result : \"${random_string.suffix.result}-${var.suffix}\"\n  key_name       = \"${var.key}-${local.default_suffix}\"\n}\n\nresource \"random_string\" \"suffix\" {\n  length  = 4\n  special = false\n  upper   = false\n}\n\nmodule \"kms\" {\n  source  = \"terraform-google-modules/kms/google\"\n  version = \"4.0.0\"\n\n  keyring              = \"${var.keyring}-${local.default_suffix}\"\n  location             = var.location\n  project_id           = var.project_id\n  keys                 = [local.key_name]\n  purpose              = \"ENCRYPT_DECRYPT\"\n  key_protection_level = \"HSM\"\n  prevent_destroy      = false\n}\n\nresource \"google_service_account\" \"default\" {\n  project      = var.project_id\n  account_id   = \"confidential-compute-sa\"\n  display_name = \"Custom SA for confidential VM Instance\"\n}\n\nresource \"google_project_iam_member\" \"service_account_roles\" {\n  for_each = toset(var.service_account_roles)\n\n  project = var.project_id\n  role    = each.key\n  member  = \"serviceAccount:${google_service_account.default.email}\"\n}\n\ndata \"google_project\" \"project\" {\n  project_id = var.project_id\n}\n\nresource \"google_kms_crypto_key_iam_binding\" \"crypto_key\" {\n  crypto_key_id = module.kms.keys[local.key_name]\n  role          = \"roles/cloudkms.cryptoKeyEncrypterDecrypter\"\n  members = [\n    \"serviceAccount:service-${data.google_project.project.number}@compute-system.iam.gserviceaccount.com\",\n  ]\n}\n\nmodule \"instance_template\" {\n  source = \"terraform-google-modules/vm/google//modules/instance_template\"\n\n  region     = var.region\n  project_id = var.project_id\n  subnetwork = var.subnetwork\n\n  name_prefix                = \"confidential-intel-encrypted\"\n  source_image_project       = \"tdx-guest-images\"\n  source_image               = \"ubuntu-2204-lts\"\n  disk_type                  = \"pd-ssd\"\n  machine_type               = \"c3-standard-4\"\n  min_cpu_platform           = \"Intel Sapphire Rapids\"\n  enable_confidential_vm     = true\n  confidential_instance_type = \"TDX\"\n\n  service_account = {\n    email  = google_service_account.default.email\n    scopes = [\"cloud-platform\"]\n  }\n  disk_encryption_key = module.kms.keys[local.key_name]\n}\n\nmodule \"compute_instance\" {\n  source  = \"terraform-google-modules/vm/google//modules/compute_instance\"\n  version = \"~> 13.0\"\n\n  region              = var.region\n  subnetwork          = var.subnetwork\n  hostname            = \"confidential-intel-encrypted\"\n  instance_template   = module.instance_template.self_link\n  deletion_protection = false\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__confidential_computing_intel__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__confidential_computing_intel__main.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__confidential_computing_intel__main.tf", "start_line": 67}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__confidential_computing_intel__main.tf", "start_line": 67}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__confidential_computing_intel__main.tf", "start_line": 90}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_security_group\" \"cluster\" {\n  name_prefix = \"acme\"\n  description = \"EKS cluster security group\"\n  vpc_id      = \"vpc-123456\"\n  tags = merge(\n  var.tags,\n  {\n    \"Name\" = \"${var.env}-eks_cluster_sg\"\n  },\n  )\n}\n\nresource \"aws_vpc\" \"vpc_tags_one_line\" {\n  cidr_block = \"\"\n  tags = { \"Name\" = \"tag-for-s3\", \"Environment\" = \"prod\" }\n}\n\nresource \"aws_instance\" \"no_tags\" {\n  ami           = \"some-ami\"\n  instance_type = \"t3.micro\"\n}\n\nresource \"aws_instance\" \"simple_tags\" {\n  ami           = \"some-ami\"\n  instance_type = \"t3.micro\"\n\n  tags = {\n    Name = \"my-instance\"\n  }\n}\n\nresource \"aws_instance\" \"rendered_tags\" {\n  ami           = \"some-ami\"\n  instance_type = \"t3.micro\"\n\n  tags = var.tags\n}\n\nresource \"aws_instance\" \"merge_tags\" {\n  ami           = \"some-ami\"\n  instance_type = \"t3.micro\"\n\n  tags = merge(var.tags,\n  {\n    Name = \"merged-tags-instance\",\n    Env  = var.env\n  })\n}\n\nvariable \"tags\" {\n  default = {}\n  type = map(string)\n}\n\nvariable \"env\" {\n  default = \"dev\"\n  type = string\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__resource_name__main.tf", "start_line": 39}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# <-- BEGIN DOC -->\n#\n# This mixin is meant to be placed in a Terraform configuration outside the organization's infrastructure monorepo in order to:\n#\n# 1. Instantiate an AWS Provider using roles managed by the infrastructure monorepo. This is required because Cloud Posse's `providers.tf` pattern\n#    requires an invocation of the `account-map` components `iam-roles` submodule, which is not present in a repository\n#    outside of the infrastructure monorepo.\n# 2. Retrieve outputs from a component in the infrastructure monorepo. This is required because Cloud Posses `remote-state` module expects\n#    a `stacks` directory, which will not be present in other repositories, the monorepo must be cloned via a `monorepo` module\n#    instantiation.\n#\n# Because the source attribute in the `monorepo` and `remote-state` modules cannot be interpolated and refers to a monorepo\n# in a given organization, the following dummy placeholders have been put in place upstream and need to be replaced accordingly\n# when \"dropped into\" a Terraform configuration:\n#\n# 1. Infrastructure monorepo: `github.com/ACME/infrastructure`\n# 2. Infrastructure monorepo ref: `0.1.0`\n#\n# <-- END DOC -->\nmodule \"monorepo\" {\n  source = \"git::https://github.com/ACME/infrastructure.git?ref=0.1.0\"\n}\n\nlocals {\n  monorepo_local_path     = \"${path.module}/.terraform/modules/monorepo\"\n  stack_config_local_path = \"${local.monorepo_local_path}/stacks\"\n}\n\nprovider \"aws\" {\n  region = var.region\n\n  profile = module.iam_roles.profiles_enabled ? coalesce(var.import_profile_name, module.iam_roles.terraform_profile_name) : null\n  dynamic \"assume_role\" {\n    for_each = module.iam_roles.profiles_enabled ? [] : [\"role\"]\n    content {\n      role_arn = coalesce(var.import_role_arn, module.iam_roles.terraform_role_arn)\n    }\n  }\n}\n\nmodule \"iam_roles\" {\n  # https://www.terraform.io/docs/language/modules/sources.html#modules-in-package-sub-directories\n  source                  = \"git::https://github.com/ACME/infrastructure.git//components/terraform/account-map/modules/iam-roles?ref=0.1.0\"\n  stack_config_local_path = local.stack_config_local_path\n  context                 = module.this.context\n}\n\nvariable \"import_profile_name\" {\n  type        = string\n  default     = null\n  description = \"AWS Profile name to use when importing a resource\"\n}\n\nvariable \"import_role_arn\" {\n  type        = string\n  default     = null\n  description = \"IAM Role ARN to use when importing a resource\"\n}\n\nvariable \"region\" {\n  description = \"AWS Region\"\n  type        = string\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-components__mixins__infra-state.mixin.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-components__mixins__infra-state.mixin.tf", "start_line": 20}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-components__mixins__infra-state.mixin.tf", "start_line": 41}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"alicloud_ack_service\" \"ci\" {\n  enable = \"On\"\n  type   = \"propayasgo\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aliyun__terraform-provider-alicloud__ci__assets__open-service__cs__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n# SPDX-License-Identifier: MIT-0\n\n/*==================================\n      AWS CodeBuild Project\n===================================*/\n\nresource \"aws_codebuild_project\" \"aws_codebuild\" {\n  name          = var.name\n  description   = \"Terraform codebuild project\"\n  build_timeout = \"10\"\n  service_role  = var.iam_role\n\n  artifacts {\n    type = \"CODEPIPELINE\"\n  }\n\n  environment {\n    compute_type    = \"BUILD_GENERAL1_SMALL\"\n    image           = \"aws/codebuild/standard:4.0\"\n    type            = \"LINUX_CONTAINER\"\n    privileged_mode = true\n\n    environment_variable {\n      name  = \"AWS_REGION\"\n      value = var.region\n    }\n\n    environment_variable {\n      name  = \"AWS_ACCOUNT_ID\"\n      value = var.account_id\n    }\n\n    environment_variable {\n      name  = \"REPO_URL\"\n      value = var.ecr_repo_url\n    }\n\n    environment_variable {\n      name  = \"IMAGE_TAG\"\n      value = \"latest\"\n    }\n\n    environment_variable {\n      name  = \"DYNAMODB_TABLE\"\n      value = var.dynamodb_table_name\n    }\n\n    environment_variable {\n      name  = \"TASK_DEFINITION_FAMILY\"\n      value = var.task_definition_family\n    }\n\n    environment_variable {\n      name  = \"CONTAINER_NAME\"\n      value = var.container_name\n    }\n\n    environment_variable {\n      name  = \"SERVICE_PORT\"\n      value = var.service_port\n    }\n\n    environment_variable {\n      name  = \"FOLDER_PATH\"\n      value = var.folder_path\n    }\n\n    environment_variable {\n      name  = \"ECS_ROLE\"\n      value = var.ecs_role\n    }\n\n    environment_variable {\n      name  = \"ECS_TASK_ROLE\"\n      value = var.ecs_task_role\n    }\n\n    environment_variable {\n      name  = \"SERVER_ALB_URL\"\n      value = var.server_alb_url\n    }\n  }\n\n  logs_config {\n    cloudwatch_logs {\n      group_name  = \"log-group\"\n      stream_name = \"log-stream\"\n    }\n  }\n\n  source {\n    type      = \"CODEPIPELINE\"\n    buildspec = var.buildspec_path\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__amazon-ecs-fullstack-app-terraform__Infrastructure__Modules__CodeBuild__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_316", "severity": "HIGH", "message": "Ensure CodeBuild project environments do not have privileged mode enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__amazon-ecs-fullstack-app-terraform__Infrastructure__Modules__CodeBuild__main.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_AWS_147", "severity": "HIGH", "message": "Ensure that CodeBuild projects are encrypted using CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__amazon-ecs-fullstack-app-terraform__Infrastructure__Modules__CodeBuild__main.tf", "start_line": 8}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE SECURITY GROUPS\n# 2 SG (FW MGMT, FW DATA)\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_security_group\" \"fw-mgmt-sg\" {\n  name        = \"fw-mgmt-sg-${random_id.deployment_id.hex}\"\n  description = \"Allow inbound traffic only from Palo Alto Networks\"\n  vpc_id      = aws_vpc.sec_vpc.id\n\n  ingress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = var.fw_mgmt_sg_list\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"fw-mgmt-sg-${random_id.deployment_id.hex}\"\n  }\n\n  depends_on = [aws_vpc.sec_vpc]\n}\n\nresource \"aws_security_group\" \"fw-data-sg\" {\n  name        = \"fw-data-sg-${random_id.deployment_id.hex}\"\n  description = \"Allow inbound traffic only from GWLB\"\n  vpc_id      = aws_vpc.sec_vpc.id\n\n  ingress {\n    from_port   = 6081\n    to_port     = 6081\n    protocol    = \"udp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"fw-data-sg-${random_id.deployment_id.hex}\"\n  }\n\n  depends_on = [aws_vpc.sec_vpc]\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__GWLB-Demo__securitygroup.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_role\" \"eks-cluster\" {\n  name = \"${local.prefix}-eks-master\"\n\n  assume_role_policy = <<POLICY\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"eks.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nPOLICY\n}\n\nresource \"aws_iam_role_policy_attachment\" \"eks-cluster-policy\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSClusterPolicy\"\n  role       = aws_iam_role.eks-cluster.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"eks-server-policy\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSServicePolicy\"\n  role       = aws_iam_role.eks-cluster.name\n}\n\nresource \"aws_security_group\" \"eks_master\" {\n  name        = \"${local.prefix}-eks\"\n  description = \"communication with worker nodes \"\n  vpc_id      = var.vpc_id\n  ingress {\n    from_port   = 443\n    protocol    = \"tcp\"\n    to_port     = 443\n    cidr_blocks = var.eks.allow_cidrs\n  }\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"TCP\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"UDP\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"ICMP\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n\n  tags = {\n    Name = \"${local.prefix}-eks\"\n  }\n}\n\n\n\nresource \"aws_eks_cluster\" \"eks-cluster\" {\n  name                      = \"${local.prefix}-eks\"\n  role_arn                  = aws_iam_role.eks-cluster.arn\n  enabled_cluster_log_types = [\"api\", \"audit\"]\n  version                   = var.eks.version\n  vpc_config {\n    security_group_ids = [aws_security_group.eks_master.id]\n    subnet_ids         = local.subnets\n  }\n\n  depends_on = [\n    aws_iam_role_policy_attachment.eks-cluster-policy,\n    aws_iam_role_policy_attachment.eks-server-policy,\n    aws_cloudwatch_log_group.eks\n  ]\n}\n\n\nlocals {\n  kubeconfig = <<KUBECONFIG\n\n\napiVersion: v1\nclusters:\n- cluster:\n    server: ${aws_eks_cluster.eks-cluster.endpoint}\n    certificate-authority-data: ${aws_eks_cluster.eks-cluster.certificate_authority.0.data}\n  name: kubernetes\ncontexts:\n- context:\n    cluster: kubernetes\n    user: aws\n  name: aws\ncurrent-context: aws\nkind: Config\npreferences: {}\nusers:\n- name: aws\n  user:\n    exec:\n      apiVersion: client.authentication.k8s.io/v1beta1\n      command: aws\n      args:\n      - --region\n      - ${var.region}\n      - eks\n      - get-token\n      - --cluster-name\n      - ${aws_eks_cluster.eks-cluster.name}\n      command: aws\n      env: null\n      interactiveMode: IfAvailable\n      provideClusterInfo: false\n      env:\n        - name: AWS_PROFILE\n          value: \"${var.aws}\"\nKUBECONFIG\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ViktorUJ__cks__terraform__modules__eks__eks_master.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ViktorUJ__cks__terraform__modules__eks__eks_master.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AWS_37", "severity": "HIGH", "message": "Ensure Amazon EKS control plane logging is enabled for all log types", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ViktorUJ__cks__terraform__modules__eks__eks_master.tf", "start_line": 68}, {"tool": "checkov", "rule_id": "CKV_AWS_39", "severity": "HIGH", "message": "Ensure Amazon EKS public endpoint disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ViktorUJ__cks__terraform__modules__eks__eks_master.tf", "start_line": 68}, {"tool": "checkov", "rule_id": "CKV_AWS_38", "severity": "HIGH", "message": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ViktorUJ__cks__terraform__modules__eks__eks_master.tf", "start_line": 68}, {"tool": "checkov", "rule_id": "CKV_AWS_58", "severity": "HIGH", "message": "Ensure EKS Cluster has Secrets Encryption Enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ViktorUJ__cks__terraform__modules__eks__eks_master.tf", "start_line": 68}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.aws_region\n}\n\nmodule \"lambda_tf_way_role\" {\n  source = \"../modules/lambda-role\"\n}\n\nlocals {\n  lambda_name = \"helloWorldLambda\"\n  zip_file_name = \"/tmp/helloWorldLambda.zip\"\n  handler_name = \"helloWorldLambda.handler\"\n}\n\nmodule \"hello_world_lambda\" {\n  source = \"../modules/lambda\"\n  lambda_function_name = local.lambda_name\n  lambda_function_handler = local.handler_name\n  lambda_role_arn = module.lambda_tf_way_role.lambda_role_arn\n  lambda_zip_filename = local.zip_file_name\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nsriram__lambda-the-terraform-way__samples__05__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\noutput \"project_id\" {\n  value = var.project_id\n}\n\n# instance 1\n\noutput \"instance_name1\" {\n  description = \"The name for Cloud SQL instance\"\n  value       = module.mssql1.instance_name\n}\n\noutput \"mssql_connection\" {\n  value       = module.mssql1.instance_connection_name\n  description = \"The connection name of the master instance to be used in connection strings\"\n}\n\noutput \"public_ip_address\" {\n  value       = module.mssql1.instance_first_ip_address\n  description = \"Public ip address\"\n}\n\n# instance 2\n\noutput \"instance_name2\" {\n  description = \"The name for Cloud SQL instance 2\"\n  value       = module.mssql2.instance_name\n}\n\noutput \"master_instance_name2\" {\n  value     = module.mssql2.primary.master_instance_name\n  sensitive = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-sql-db__examples__mssql-failover-replica__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2025 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlocals {\n  security_profile_group_ids = {\n    for k, v in google_network_security_security_profile_group.default :\n    k => \"//networksecurity.googleapis.com/${v.id}\"\n  }\n  tfvars = {\n    ngfw = {\n      associations = {\n        for k, v in google_network_security_firewall_endpoint_association.default :\n        k => v.id\n      }\n      endpoints = {\n        for k, v in google_network_security_firewall_endpoint.default : k => v.id\n      }\n    }\n    security_profile_groups = local.security_profile_group_ids\n  }\n}\n\nresource \"local_file\" \"tfvars\" {\n  for_each        = var.outputs_location == null ? {} : { 1 = 1 }\n  file_permission = \"0644\"\n  filename        = \"${try(pathexpand(var.outputs_location), \"\")}/tfvars/${var.names.output_files_prefix}.auto.tfvars.json\"\n  content         = jsonencode(local.tfvars)\n}\n\nresource \"google_storage_bucket_object\" \"tfvars\" {\n  bucket  = var.automation.outputs_bucket\n  name    = \"tfvars/${var.names.output_files_prefix}.auto.tfvars.json\"\n  content = jsonencode(local.tfvars)\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__cloud-foundation-fabric__fast__addons__2-networking-ngfw__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Create the main EC2 instance\n# https://www.terraform.io/docs/providers/aws/r/instance.html\nresource \"aws_instance\" \"this\" {\n  instance_type          = \"${var.instance_type}\"\n  ami                    = \"${var.instance_ami}\"\n  availability_zone      = \"${local.availability_zone}\"\n  key_name               = \"${aws_key_pair.this.id}\"                            # the name of the SSH keypair to use for provisioning\n  vpc_security_group_ids = [\"${aws_security_group.this.id}\"]\n  subnet_id              = \"${data.aws_subnet.this.id}\"\n  user_data              = \"${sha1(local.reprovision_trigger)}\"                 # this value isn't used by the EC2 instance, but its change will trigger re-creation of the resource\n  tags                   = \"${merge(var.tags, map(\"Name\", \"${var.hostname}\"))}\"\n  volume_tags            = \"${merge(var.tags, map(\"Name\", \"${var.hostname}\"))}\" # give the root EBS volume a name (+ other possible tags) that makes it easier to identify as belonging to this host\n\n  root_block_device {\n    volume_size = \"${var.root_volume_size}\"\n  }\n\n  connection {\n    user        = \"${var.ssh_username}\"\n    private_key = \"${file(\"${var.ssh_private_key_path}\")}\"\n    agent       = false                                    # don't use SSH agent because we have the private key right here\n  }\n\n  provisioner \"remote-exec\" {\n    inline = [\n      \"sudo hostnamectl set-hostname ${var.hostname}\",\n      \"echo 127.0.0.1 ${var.hostname} | sudo tee -a /etc/hosts\", # https://askubuntu.com/a/59517\n    ]\n  }\n\n  provisioner \"remote-exec\" {\n    script = \"${path.module}/provision-docker.sh\"\n  }\n\n  provisioner \"file\" {\n    source      = \"${path.module}/provision-swap.sh\"\n    destination = \"/home/${var.ssh_username}/provision-swap.sh\"\n  }\n\n  provisioner \"remote-exec\" {\n    inline = [\n      \"sh /home/${var.ssh_username}/provision-swap.sh ${var.swap_file_size} ${var.swap_swappiness}\",\n      \"rm /home/${var.ssh_username}/provision-swap.sh\",\n    ]\n  }\n}\n\n# Attach the separate data volume to the instance, if so configured\n\nresource \"aws_volume_attachment\" \"this\" {\n  count       = \"${var.data_volume_id == \"\" ? 0 : 1}\" # only create this resource if an external EBS data volume was provided\n  device_name = \"/dev/xvdh\"                           # note: this depends on the AMI, and can't be arbitrarily changed\n  instance_id = \"${aws_instance.this.id}\"\n  volume_id   = \"${var.data_volume_id}\"\n}\n\nresource \"null_resource\" \"provisioners\" {\n  count      = \"${var.data_volume_id == \"\" ? 0 : 1}\" # only create this resource if an external EBS data volume was provided\n  depends_on = [\"aws_volume_attachment.this\"]        # because we depend on the EBS volume being available\n\n  connection {\n    host        = \"${aws_instance.this.public_ip}\"\n    user        = \"${var.ssh_username}\"\n    private_key = \"${file(\"${var.ssh_private_key_path}\")}\"\n    agent       = false                                    # don't use SSH agent because we have the private key right here\n  }\n\n  # When creating the attachment\n  provisioner \"remote-exec\" {\n    script = \"${path.module}/provision-ebs.sh\"\n  }\n\n  # When tearing down the attachment\n  provisioner \"remote-exec\" {\n    when   = \"destroy\"\n    inline = [\"sudo umount -v ${aws_volume_attachment.this.device_name}\"]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/futurice__terraform-examples__aws__aws_ec2_ebs_docker_host__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/futurice__terraform-examples__aws__aws_ec2_ebs_docker_host__main.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/futurice__terraform-examples__aws__aws_ec2_ebs_docker_host__main.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/futurice__terraform-examples__aws__aws_ec2_ebs_docker_host__main.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/futurice__terraform-examples__aws__aws_ec2_ebs_docker_host__main.tf", "start_line": 3}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_iam_policy_document\" \"github_role_on_push\" {\n  statement {\n    actions   = [\"s3:PutObject\"]\n    resources = [\"${var.config_bucket_arn}/*\"]\n  }\n\n  statement {\n    actions = [\"ssm:GetParameter\"]\n    resources = [\"arn:aws:ssm:${data.aws_region.current.name}:${data.aws_caller_identity.current.account_id}:parameter/${var.app_name}/*\"]\n  }\n\n  statement {\n    actions = [\"ssm:GetParameter\"]\n    resources = [\"arn:aws:ssm:${data.aws_region.current.name}:${data.aws_caller_identity.current.account_id}:parameter/gh*\"]  # all github stacks\n  }\n\n  statement {\n    actions = [\"states:StartExecution\"]\n    resources = [\"arn:aws:states:${data.aws_region.current.name}:${data.aws_caller_identity.current.account_id}:stateMachine:gh-*\"]  # all github statemachines\n  }\n\n}\n\nresource \"aws_iam_policy\" \"github_role_on_push\" {\n  name        = \"github_on_push\"\n  path        = \"/\"\n  description = \"Policy for Github role on push\"\n  policy = data.aws_iam_policy_document.github_role_on_push.json\n}\n\nresource \"aws_iam_role_policy_attachment\" \"attach_github_on_push\" {\n  role       = aws_iam_role.github_role.name\n  policy_arn = aws_iam_policy.github_role_on_push.arn\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__oidc_github__policy_on_push.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# An Auth0 Client loaded using its name.\ndata \"auth0_client\" \"some-client-by-name\" {\n  name = \"Name of my Application\"\n}\n\n# An Auth0 Client loaded using its ID.\ndata \"auth0_client\" \"some-client-by-id\" {\n  client_id = \"abcdefghkijklmnopqrstuvwxyz0123456789\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/auth0__terraform-provider-auth0__examples__data-sources__auth0_client__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"key_name\" {\n  type        = string\n  description = <<-EOT\n    The name of an AWS key pair to use for SSH access to the instance.\n    This key should already be added to your ssh agent for server authentication.\n  EOT\n}\nvariable \"key\" {\n  type        = string\n  description = <<-EOT\n    The contents of an AWS key pair to use for SSH access to the instance.\n    This is necessary for installing rke2 on the nodes and will be removed after installation.\n  EOT\n}\nvariable \"identifier\" {\n  type        = string\n  description = <<-EOT\n    A unique identifier for the project, this helps when generating names for infrastructure items.\"\n  EOT\n}\nvariable \"owner\" {\n  type        = string\n  description = <<-EOT\n    The owner of the project, this helps when generating names for infrastructure items.\"\n  EOT\n}\nvariable \"zone\" {\n  type        = string\n  description = <<-EOT\n    The Route53 DNS zone to deploy the cluster into.\n    This is used to generate the DNS name for the cluster.\n    The zone must already exist.\n  EOT\n}\nvariable \"rke2_version\" {\n  type        = string\n  description = <<-EOT\n    The version of rke2 to install on the nodes.\n  EOT\n}\nvariable \"rancher_version\" {\n  type        = string\n  description = <<-EOT\n    The version of rancher to install on the rke2 cluster.\n  EOT\n  default     = \"2.12.3\"\n}\nvariable \"file_path\" {\n  type        = string\n  description = <<-EOT\n    The path to the file containing the rke2 install script.\n  EOT\n  default     = \"./rke2\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__terraform-provider-rancher2__examples__use-cases__three__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlocals {\n  seed_project_id            = var.project_id != \"\" ? var.project_id : format(\"%s-%s\", var.project_prefix, \"seed\")\n  generated_bucket_name      = var.random_suffix == true ? format(\"%s-%s-%s\", var.project_prefix, \"tfstate\", random_id.suffix.hex) : format(\"%s-%s\", var.project_prefix, \"tfstate\")\n  supplied_bucket_name       = var.random_suffix == true ? format(\"%s-%s\", var.state_bucket_name, random_id.suffix.hex) : var.state_bucket_name\n  state_bucket_name          = var.state_bucket_name != \"\" ? local.supplied_bucket_name : local.generated_bucket_name\n  base_apis                  = distinct(concat(var.activate_apis, var.encrypt_gcs_bucket_tfstate ? [\"cloudkms.googleapis.com\"] : []))\n  impersonation_apis         = distinct(concat(local.base_apis, [\"serviceusage.googleapis.com\", \"iamcredentials.googleapis.com\"]))\n  activate_apis              = var.sa_enable_impersonation == true ? local.impersonation_apis : local.base_apis\n  org_project_creators_tf_sa = var.create_terraform_sa ? [\"serviceAccount:${google_service_account.org_terraform[0].email}\"] : []\n  org_project_creators       = distinct(concat(var.org_project_creators, local.org_project_creators_tf_sa, [\"group:${var.group_org_admins}\"]))\n  is_organization            = var.parent_folder == \"\" ? true : false\n  parent_id                  = var.parent_folder == \"\" ? var.org_id : split(\"/\", var.parent_folder)[1]\n  seed_org_depends_on        = try(google_folder_iam_member.tmp_project_creator[0].etag, \"\") != \"\" ? var.org_id : google_organization_iam_member.tmp_project_creator[0].org_id\n}\n\nresource \"random_id\" \"suffix\" {\n  byte_length = 2\n}\n\n/*************************************************\n  Make sure group_org_admins has projectCreator.\n*************************************************/\n\nresource \"google_organization_iam_member\" \"tmp_project_creator\" {\n  count = local.is_organization ? 1 : 0\n\n  org_id = local.parent_id\n  role   = \"roles/resourcemanager.projectCreator\"\n  member = \"group:${var.group_org_admins}\"\n}\n\nresource \"google_folder_iam_member\" \"tmp_project_creator\" {\n  count = local.is_organization ? 0 : 1\n\n  folder = local.parent_id\n  role   = \"roles/resourcemanager.projectCreator\"\n  member = \"group:${var.group_org_admins}\"\n}\n\n/******************************************\n  Create IaC Project\n*******************************************/\n\nmodule \"seed_project\" {\n  source                      = \"terraform-google-modules/project-factory/google\"\n  version                     = \"~> 18.0\"\n  name                        = local.seed_project_id\n  random_project_id           = var.random_suffix\n  disable_services_on_destroy = false\n  folder_id                   = var.folder_id\n  org_id                      = local.seed_org_depends_on\n  billing_account             = var.billing_account\n  activate_apis               = local.activate_apis\n  create_project_sa           = false\n  labels                      = var.project_labels\n  lien                        = true\n  deletion_policy             = var.project_deletion_policy\n  auto_create_network         = var.project_auto_create_network\n}\n\nmodule \"enable_cross_project_service_account_usage\" {\n  source  = \"terraform-google-modules/org-policy/google\"\n  version = \"~> 6.0\"\n\n  project_id  = module.seed_project.project_id\n  policy_for  = \"project\"\n  policy_type = \"boolean\"\n  enforce     = \"false\"\n  constraint  = \"constraints/iam.disableCrossProjectServiceAccountUsage\"\n}\n\n\n/******************************************\n  Service Account - Terraform for Org\n*******************************************/\n\nresource \"google_service_account\" \"org_terraform\" {\n  count = var.create_terraform_sa ? 1 : 0\n\n  project                      = module.seed_project.project_id\n  account_id                   = var.tf_service_account_id\n  display_name                 = var.tf_service_account_name\n  create_ignore_already_exists = true\n}\n\n/***********************************************\n  GCS Bucket - Terraform State\n ***********************************************/\ndata \"google_storage_project_service_account\" \"gcs_account\" {\n  project = module.seed_project.project_id\n\n  depends_on = [\n    module.seed_project.project_id\n  ]\n}\n\nmodule \"kms\" {\n  count   = var.encrypt_gcs_bucket_tfstate ? 1 : 0\n  source  = \"terraform-google-modules/kms/google\"\n  version = \"~> 3.2\"\n\n  project_id           = module.seed_project.project_id\n  location             = var.default_region\n  keyring              = \"${var.project_prefix}-keyring\"\n  keys                 = [\"${var.project_prefix}-key\"]\n  key_rotation_period  = var.key_rotation_period\n  key_protection_level = var.key_protection_level\n  set_decrypters_for   = [\"${var.project_prefix}-key\"]\n  set_encrypters_for   = [\"${var.project_prefix}-key\"]\n  decrypters = [\n    \"serviceAccount:${data.google_storage_project_service_account.gcs_account.email_address}\",\n  ]\n  encrypters = [\n    \"serviceAccount:${data.google_storage_project_service_account.gcs_account.email_address}\",\n  ]\n  prevent_destroy = var.kms_prevent_destroy\n}\n\nresource \"google_storage_bucket\" \"org_terraform_state\" {\n  project                     = module.seed_project.project_id\n  name                        = local.state_bucket_name\n  location                    = var.default_region\n  labels                      = var.storage_bucket_labels\n  force_destroy               = var.force_destroy\n  uniform_bucket_level_access = true\n  versioning {\n    enabled = true\n  }\n\n  dynamic \"encryption\" {\n    for_each = var.encrypt_gcs_bucket_tfstate ? [\"encryption\"] : []\n    content {\n      default_kms_key_name = module.kms[0].keys[\"${var.project_prefix}-key\"]\n    }\n  }\n}\n\n/***********************************************\n  Authorative permissions at org. Required to\n  remove default org wide permissions\n  granting billing account and project creation.\n ***********************************************/\n\nresource \"google_organization_iam_binding\" \"billing_creator\" {\n  org_id = var.org_id\n  role   = \"roles/billing.creator\"\n  members = [\n    \"group:${var.group_billing_admins}\",\n  ]\n}\n\nresource \"google_organization_iam_binding\" \"project_creator\" {\n  count = local.is_organization ? 1 : 0\n\n  org_id  = local.parent_id\n  role    = \"roles/resourcemanager.projectCreator\"\n  members = local.org_project_creators\n}\n\nresource \"google_folder_iam_binding\" \"project_creator\" {\n  count = local.is_organization ? 0 : 1\n\n  folder  = local.parent_id\n  role    = \"roles/resourcemanager.projectCreator\"\n  members = local.org_project_creators\n}\n\n/***********************************************\n  Organization permissions for org admins.\n ***********************************************/\n\nresource \"google_organization_iam_member\" \"org_admins_group\" {\n  for_each = toset(var.org_admins_org_iam_permissions)\n\n  org_id = var.org_id\n  role   = each.value\n  member = \"group:${var.group_org_admins}\"\n}\n\n/***********************************************\n  Organization permissions for billing admins.\n ***********************************************/\n\nresource \"google_organization_iam_member\" \"org_billing_admin\" {\n  org_id = var.org_id\n  role   = \"roles/billing.admin\"\n  member = \"group:${var.group_billing_admins}\"\n}\n\n/***********************************************\n  Organization permissions for Terraform.\n ***********************************************/\n\nresource \"google_organization_iam_member\" \"tf_sa_org_perms\" {\n  for_each = var.create_terraform_sa ? toset(var.sa_org_iam_permissions) : []\n\n  org_id = var.org_id\n  role   = each.value\n  member = \"serviceAccount:${google_service_account.org_terraform[0].email}\"\n}\n\nresource \"google_billing_account_iam_member\" \"tf_billing_user\" {\n  count = var.grant_billing_user && var.create_terraform_sa ? 1 : 0\n\n  billing_account_id = var.billing_account\n  role               = \"roles/billing.user\"\n  member             = \"serviceAccount:${google_service_account.org_terraform[0].email}\"\n}\n\nresource \"google_storage_bucket_iam_member\" \"org_terraform_state_iam\" {\n  count = var.create_terraform_sa ? 1 : 0\n\n  bucket = google_storage_bucket.org_terraform_state.name\n  role   = \"roles/storage.admin\"\n  member = \"serviceAccount:${google_service_account.org_terraform[0].email}\"\n}\n\n/***********************************************\n  IAM - Impersonation permissions to run terraform\n  as org admin.\n ***********************************************/\n\nresource \"google_service_account_iam_member\" \"org_admin_sa_user\" {\n  count = var.sa_enable_impersonation && var.create_terraform_sa ? 1 : 0\n\n  service_account_id = google_service_account.org_terraform[0].name\n  role               = \"roles/iam.serviceAccountUser\"\n  member             = \"group:${var.group_org_admins}\"\n}\n\nresource \"google_service_account_iam_member\" \"org_admin_sa_impersonate_permissions\" {\n  count = var.sa_enable_impersonation && var.create_terraform_sa ? 1 : 0\n\n  service_account_id = google_service_account.org_terraform[0].name\n  role               = \"roles/iam.serviceAccountTokenCreator\"\n  member             = \"group:${var.group_org_admins}\"\n}\n\nresource \"google_organization_iam_member\" \"org_admin_serviceusage_consumer\" {\n  count = var.sa_enable_impersonation && local.is_organization ? 1 : 0\n\n  org_id = local.parent_id\n  role   = \"roles/serviceusage.serviceUsageConsumer\"\n  member = \"group:${var.group_org_admins}\"\n}\n\nresource \"google_folder_iam_member\" \"org_admin_service_account_user\" {\n  count = var.sa_enable_impersonation && !local.is_organization ? 1 : 0\n\n  folder = local.parent_id\n  role   = \"roles/iam.serviceAccountUser\"\n  member = \"group:${var.group_org_admins}\"\n}\n\nresource \"google_folder_iam_member\" \"org_admin_serviceusage_consumer\" {\n  count = var.sa_enable_impersonation && !local.is_organization ? 1 : 0\n\n  folder = local.parent_id\n  role   = \"roles/serviceusage.serviceUsageConsumer\"\n  member = \"group:${var.group_org_admins}\"\n}\n\nresource \"google_storage_bucket_iam_member\" \"orgadmins_state_iam\" {\n  count = var.sa_enable_impersonation ? 1 : 0\n\n  bucket = google_storage_bucket.org_terraform_state.name\n  role   = \"roles/storage.admin\"\n  member = \"group:${var.group_org_admins}\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_62", "severity": "HIGH", "message": "Bucket should log access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__main.tf", "start_line": 135}, {"tool": "checkov", "rule_id": "CKV_GCP_114", "severity": "HIGH", "message": "Ensure public access prevention is enforced on Cloud Storage bucket", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__main.tf", "start_line": 135}, {"tool": "checkov", "rule_id": "CKV_GCP_44", "severity": "HIGH", "message": "Ensure no roles that enable to impersonate and manage all service accounts are used at a folder level", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__main.tf", "start_line": 263}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__main.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__main.tf", "start_line": 113}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"instances_ami\" {\n  description = \"The Amazon Machine Image (AMI) to use for the AWS EC2 instances\"\n  type        = \"string\"\n}\n\nvariable \"key_pair_public_key\" {\n  description = <<EOD\nThe public key material to use for SSH authentication with the instances\nEOD\n\n  type = \"string\"\n}\n\nvariable \"subnet_availability_zone\" {\n  description = \"The isolated, regional location in which to place the subnet\"\n  type        = \"string\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/newcontext-oss__kitchen-terraform__examples__extensive_kitchen_terraform__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"instance_names\" {\n    type = list\n    default = [\"db\", \"backend\", \"frontend\"]\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__count__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"http\" \"current_ip\" {\n  url = \"http://ipv4.icanhazip.com/\"\n}\n\nlocals {\n  bootstrap_script = templatefile(\n    \"${path.module}/templates/requester.sh.tpl\",\n    {\n      vault_addr = \"http://${google_compute_instance.vault_server.network_interface[0].access_config[0].nat_ip}:8200\"\n    },\n  )\n}\n\nresource \"google_compute_network\" \"vault_gcp_demo_network\" {\n  project    = google_project.vault_gcp_demo.project_id\n  name       = \"vault-gcp-demo\"\n  depends_on = [google_project_services.vault_gcp_demo_services]\n}\n\nresource \"google_compute_firewall\" \"allow_vault_access\" {\n  project    = google_project.vault_gcp_demo.project_id\n  name       = \"allow-vault-access\"\n  network    = google_compute_network.vault_gcp_demo_network.self_link\n  depends_on = [\n    google_project_services.vault_gcp_demo_services,\n    google_compute_instance.vault_happy,\n    google_compute_instance.vault_sad,\n  ]\n  allow {\n    protocol = \"icmp\"\n  }\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\", \"8200\"]\n  }\n  source_ranges = [\n    \"${chomp(data.http.current_ip.body)}/32\",\n    \"${google_compute_instance.vault_happy.network_interface[0].access_config[0].nat_ip}/32\",\n    \"${google_compute_instance.vault_sad.network_interface[0].access_config[0].nat_ip}/32\",\n  ]\n  target_tags = [\"vault-server\", \"vault-requester\"]\n}\n\nresource \"google_compute_instance\" \"vault_server\" {\n  name         = \"vault-server\"\n  machine_type = \"n1-standard-1\"\n  zone         = \"europe-west2-a\"\n  project      = google_project.vault_gcp_demo.project_id\n  tags         = [\"vault-server\"]\n  depends_on   = [google_project_services.vault_gcp_demo_services]\n  network_interface {\n    network = google_compute_network.vault_gcp_demo_network.self_link\n    access_config { # Public-facing IP\n    }\n  }\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n  metadata_startup_script = file(\"./scripts/install_vault.sh\")\n  service_account {\n    email  = google_service_account.vault_auth_checker.email\n    scopes = [\"cloud-platform\"]\n  }\n}\n\nresource \"google_compute_instance\" \"vault_happy\" {\n  name         = \"vault-requester-happy\"\n  machine_type = \"f1-micro\"\n  zone         = \"europe-west2-a\"\n  project      = google_project.vault_gcp_demo.project_id\n  tags         = [\"vault-requester\"]\n  depends_on   = [google_project_services.vault_gcp_demo_services]\n  network_interface {\n    network = \"default\"\n    access_config {\n      // Ephemeral IP\n    }\n  }\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n  metadata_startup_script = local.bootstrap_script\n  service_account {\n    email  = \"${google_service_account.vault_auth_checker.email}\"\n    scopes = [\"cloud-platform\"]\n  }\n}\nresource \"google_compute_instance\" \"vault_sad\" {\n  name         = \"vault-requester-sad\"\n  machine_type = \"f1-micro\"\n  zone         = \"europe-west1-b\"\n  project      = google_project.vault_gcp_demo.project_id\n  tags         = [\"vault-requester\"]\n  depends_on   = [google_project_services.vault_gcp_demo_services]\n  network_interface {\n    network = \"default\"\n    access_config {\n      // Ephemeral IP\n    }\n  }\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n  metadata_startup_script = local.bootstrap_script\n  service_account {\n    email  = \"${google_service_account.vault_auth_checker.email}\"\n    scopes = [\"cloud-platform\"]\n  }\n}\noutput \"vault_server_instance_id\" {\n  value = google_compute_instance.vault_server.self_link\n}\noutput \"vault_happy_instance_id\" {\n  value = google_compute_instance.vault_happy.self_link\n}\noutput \"vault_sad_instance_id\" {\n  value = google_compute_instance.vault_sad.self_link\n}\noutput \"vault_addr_export\" {\n  value = \"Run the following for the Vault configuration: export VAULT_ADDR=http://${google_compute_instance.vault_server.network_interface[0].access_config[0].nat_ip}:8200\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 68}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 68}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 68}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 68}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 92}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 92}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 92}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__gcp-gce-auth__compute.tf", "start_line": 92}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"region\" {\n  default = \"us-central1\"\n}\n\nvariable \"region_zone\" {\n  default = \"us-central1-f\"\n}\n\nvariable \"project_name\" {\n  description = \"The ID of the Google Cloud project\"\n}\n\nvariable \"credentials_file_path\" {\n  description = \"Path to the JSON file used to describe your account credentials\"\n  default     = \"~/.gcloud/Terraform.json\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__content-based-load-balancing__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"keycloak_realm\" \"token-exchange_source_realm\" {\n  realm   = \"token-exchange_source_realm\"\n  enabled = true\n}\n\nresource \"keycloak_openid_client\" \"token-exchange_destination_client\" {\n  realm_id              = keycloak_realm.token-exchange_source_realm.id\n  name                  = \"destination_client\"\n  client_id             = \"destination_client\"\n  client_secret         = \"secret\"\n  description           = \"a client used by the destination realm\"\n  access_type           = \"CONFIDENTIAL\"\n  standard_flow_enabled = true\n  valid_redirect_uris = [\n    \"http://localhost:8080/*\",\n  ]\n}\n\nresource \"keycloak_realm\" \"token-exchange_destination_realm\" {\n  realm   = \"token-exchange_destination_realm\"\n  enabled = true\n}\n\nresource keycloak_oidc_identity_provider token-exchange_source_oidc_idp {\n  realm              = keycloak_realm.token-exchange_destination_realm.id\n  alias              = \"source\"\n  authorization_url  = \"http://localhost:8080/auth/realms/${keycloak_realm.token-exchange_source_realm.id}/protocol/openid-connect/auth\"\n  token_url          = \"http://localhost:8080/auth/realms/${keycloak_realm.token-exchange_source_realm.id}/protocol/openid-connect/token\"\n  user_info_url      = \"http://localhost:8080/auth/realms/${keycloak_realm.token-exchange_source_realm.id}/protocol/openid-connect/userinfo\"\n  jwks_url           = \"http://localhost:8080/auth/realms/${keycloak_realm.token-exchange_source_realm.id}/protocol/openid-connect/certs\"\n  validate_signature = true\n  client_id          = keycloak_openid_client.token-exchange_destination_client.client_id\n  client_secret      = keycloak_openid_client.token-exchange_destination_client.client_secret\n  default_scopes     = \"openid\"\n}\n\nresource \"keycloak_openid_client\" \"token-exchange_webapp_client\" {\n  realm_id              = keycloak_realm.token-exchange_destination_realm.id\n  name                  = \"webapp_client\"\n  client_id             = \"webapp_client\"\n  client_secret         = \"secret\"\n  description           = \"a webapp client on the destination realm\"\n  access_type           = \"CONFIDENTIAL\"\n  standard_flow_enabled = true\n  valid_redirect_uris = [\n    \"http://localhost:8080/*\",\n  ]\n}\n\n//token exchange feature enabler\nresource \"keycloak_identity_provider_token_exchange_scope_permission\" \"source_oidc_idp_permission\" {\n  realm_id       = keycloak_realm.token-exchange_destination_realm.id\n  provider_alias = keycloak_oidc_identity_provider.token-exchange_source_oidc_idp.alias\n  policy_type    = \"client\"\n  clients        = [keycloak_openid_client.token-exchange_webapp_client.id]\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keycloak__terraform-provider-keycloak__example__external_token_exchange_example.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"google\" {\n  region  = var.region\n  project = var.project_name\n}\n\nresource \"google_compute_network\" \"my-custom-network\" {\n  name = \"my-custom-network\"\n}\n\nresource \"google_compute_subnetwork\" \"my-custom-subnet\" {\n  name          = \"my-custom-subnet\"\n  ip_cidr_range = \"10.128.0.0/20\"\n  network       = google_compute_network.my-custom-network.self_link\n  region        = var.region\n}\n\nresource \"google_compute_firewall\" \"allow-all-internal\" {\n  name    = \"allow-all-10-128-0-0-20\"\n  network = google_compute_network.my-custom-network.name\n\n  allow {\n    protocol = \"tcp\"\n  }\n\n  allow {\n    protocol = \"udp\"\n  }\n\n  allow {\n    protocol = \"icmp\"\n  }\n\n  source_ranges = [\"10.128.0.0/20\"]\n}\n\nresource \"google_compute_firewall\" \"allow-ssh-rdp-icmp\" {\n  name    = \"allow-tcp22-tcp3389-icmp\"\n  network = google_compute_network.my-custom-network.name\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\", \"3389\"]\n  }\n\n  allow {\n    protocol = \"icmp\"\n  }\n}\n\nresource \"google_compute_instance\" \"ilb-instance-1\" {\n  name         = \"ilb-instance-1\"\n  machine_type = \"n1-standard-1\"\n  zone         = var.region_zone\n\n  tags = [\"int-lb\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-8\"\n    }\n  }\n\n  network_interface {\n    subnetwork = google_compute_subnetwork.my-custom-subnet.name\n\n    access_config {\n      // Ephemeral IP\n    }\n  }\n\n  service_account {\n    scopes = [\"compute-rw\"]\n  }\n\n  metadata_startup_script = file(\"startup.sh\")\n}\n\nresource \"google_compute_instance\" \"ilb-instance-2\" {\n  name         = \"ilb-instance-2\"\n  machine_type = \"n1-standard-1\"\n  zone         = var.region_zone\n\n  tags = [\"int-lb\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-8\"\n    }\n  }\n\n  network_interface {\n    subnetwork = google_compute_subnetwork.my-custom-subnet.name\n\n    access_config {\n      // Ephemeral IP\n    }\n  }\n\n  service_account {\n    scopes = [\"compute-rw\"]\n  }\n\n  metadata_startup_script = file(\"startup.sh\")\n}\n\nresource \"google_compute_instance\" \"ilb-instance-3\" {\n  name         = \"ilb-instance-3\"\n  machine_type = \"n1-standard-1\"\n  zone         = var.region_zone_2\n\n  tags = [\"int-lb\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-8\"\n    }\n  }\n\n  network_interface {\n    subnetwork = google_compute_subnetwork.my-custom-subnet.name\n\n    access_config {\n      // Ephemeral IP\n    }\n  }\n\n  service_account {\n    scopes = [\"compute-rw\"]\n  }\n\n  metadata_startup_script = file(\"startup.sh\")\n}\n\nresource \"google_compute_instance\" \"ilb-instance-4\" {\n  name         = \"ilb-instance-4\"\n  machine_type = \"n1-standard-1\"\n  zone         = var.region_zone_2\n\n  tags = [\"int-lb\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-8\"\n    }\n  }\n\n  network_interface {\n    subnetwork = google_compute_subnetwork.my-custom-subnet.name\n\n    access_config {\n      // Ephemeral IP\n    }\n  }\n\n  service_account {\n    scopes = [\"compute-rw\"]\n  }\n\n  metadata_startup_script = file(\"startup.sh\")\n}\n\nresource \"google_compute_instance_group\" \"us-ig1\" {\n  name = \"us-ig1\"\n\n  instances = [\n    google_compute_instance.ilb-instance-1.self_link,\n    google_compute_instance.ilb-instance-2.self_link,\n  ]\n\n  zone = var.region_zone\n}\n\nresource \"google_compute_instance_group\" \"us-ig2\" {\n  name = \"us-ig2\"\n\n  instances = [\n    google_compute_instance.ilb-instance-3.self_link,\n    google_compute_instance.ilb-instance-4.self_link,\n  ]\n\n  zone = var.region_zone_2\n}\n\nresource \"google_compute_health_check\" \"my-tcp-health-check\" {\n  name = \"my-tcp-health-check\"\n\n  tcp_health_check {\n    port = \"80\"\n  }\n}\n\nresource \"google_compute_region_backend_service\" \"my-int-lb\" {\n  name          = \"my-int-lb\"\n  health_checks = [google_compute_health_check.my-tcp-health-check.self_link]\n  region        = var.region\n\n  backend {\n    group = google_compute_instance_group.us-ig1.self_link\n  }\n\n  backend {\n    group = google_compute_instance_group.us-ig2.self_link\n  }\n}\n\nresource \"google_compute_forwarding_rule\" \"my-int-lb-forwarding-rule\" {\n  name                  = \"my-int-lb-forwarding-rule\"\n  load_balancing_scheme = \"INTERNAL\"\n  ports                 = [\"80\"]\n  network               = google_compute_network.my-custom-network.self_link\n  subnetwork            = google_compute_subnetwork.my-custom-subnet.self_link\n  backend_service       = google_compute_region_backend_service.my-int-lb.self_link\n}\n\nresource \"google_compute_firewall\" \"allow-internal-lb\" {\n  name    = \"allow-internal-lb\"\n  network = google_compute_network.my-custom-network.name\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"80\", \"443\"]\n  }\n\n  source_ranges = [\"10.128.0.0/20\"]\n  target_tags   = [\"int-lb\"]\n}\n\nresource \"google_compute_firewall\" \"allow-health-check\" {\n  name    = \"allow-health-check\"\n  network = google_compute_network.my-custom-network.name\n\n  allow {\n    protocol = \"tcp\"\n  }\n\n  source_ranges = [\"130.211.0.0/22\", \"35.191.0.0/16\"]\n  target_tags   = [\"int-lb\"]\n}\n\nresource \"google_compute_instance\" \"standalone-instance-1\" {\n  name         = \"standalone-instance-1\"\n  machine_type = \"n1-standard-1\"\n  zone         = var.region_zone\n\n  tags = [\"standalone\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-8\"\n    }\n  }\n\n  network_interface {\n    subnetwork = google_compute_subnetwork.my-custom-subnet.name\n\n    access_config {\n      // Ephemeral IP\n    }\n  }\n}\n\nresource \"google_compute_firewall\" \"allow-ssh-to-standalone\" {\n  name    = \"allow-ssh-to-standalone\"\n  network = google_compute_network.my-custom-network.name\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  target_tags = [\"standalone\"]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_26", "severity": "HIGH", "message": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_GCP_74", "severity": "HIGH", "message": "Ensure that private_ip_google_access is enabled for Subnet", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 50}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 50}, {"tool": "checkov", "rule_id": "CKV_GCP_30", "severity": "HIGH", "message": "Ensure that instances are not configured to use the default service account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 50}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 50}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 50}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_GCP_30", "severity": "HIGH", "message": "Ensure that instances are not configured to use the default service account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV_GCP_30", "severity": "HIGH", "message": "Ensure that instances are not configured to use the default service account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 134}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 134}, {"tool": "checkov", "rule_id": "CKV_GCP_30", "severity": "HIGH", "message": "Ensure that instances are not configured to use the default service account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 134}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 134}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 134}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 240}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 240}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 240}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google__examples__internal-load-balancing__main.tf", "start_line": 240}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"random_integer\" \"one\" {\n  min = 1\n  max = 3\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/im2nguyen__rover__example__multiple-files-same-resource-type-test__file-one.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 3.0\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-customizations__sandbox__terraform__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"okta_api_service_integration\" \"example\" {\n  type = \"anzennaapiservice\"\n  granted_scopes {\n    scope = \"okta.users.read\"\n  }\n  granted_scopes {\n    scope = \"okta.groups.read\"\n  }\n  granted_scopes {\n    scope = \"okta.logs.read\"\n  }\n}\n\ndata \"okta_api_service_integration\" \"example\" {\n  id = okta_api_service_integration.example.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/okta__terraform-provider-okta__examples__data-sources__okta_api_service_integration__datasource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"kubectl\" {}\n\nresource \"kubectl_manifest\" \"test\" {\n    yaml_body = <<YAML\napiVersion: v1\nkind: Service\nmetadata:\n  name: name-here\nspec:\n  ports:\n    - name: https\n      port: 443\n      targetPort: 8443\n    - name: http\n      port: 80\n      targetPort: 9090\nYAML\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gavinbunney__terraform-provider-kubectl__test__e2e__service__basic_service.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Nomad-Specific Variables\nvariable \"nomad_servers\" {\n  description = \"list of host names for Nomad servers\"\n  type        = list(string)\n  default     = []\n}\n\nvariable \"nomad_clients\" {\n  description = \"list of host names for Nomad clients\"\n  type        = list(string)\n  default     = []\n}\n\n# AWS-Specific Variables\nvariable \"aws_region\" {\n  description = \"AWS region to deploy resources\"\n  type        = string\n  default     = \"us-east-1\"\n}\n\nvariable \"ec2_ami_id\" {\n  description = \"AMI ID for the EC2 instances\"\n  type        = string\n}\n\nvariable \"associate_public_ip\" {\n  description = \"Whether to associate a public IP address with the EC2 instances\"\n  type        = bool\n  default     = false\n}\n\nvariable \"ec2_key_name\" {\n  description = \"Name of the EC2 key pair to use for SSH access\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"ec2_security_group_ids\" {\n  description = \"List of security group IDs to associate with the EC2 instances\"\n  type        = list(string)\n  default     = []\n}\n\nvariable \"nomad_server_subnet_id\" {\n  description = \"Subnet ID for Nomad server instances\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"nomad_client_subnet_id\" {\n  description = \"Subnet ID for Nomad client instances\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"nomad_server_ec2_instance_type\" {\n  description = \"Instance type for Nomad server instances\"\n  type        = string\n  default     = \"t3.medium\"\n\n}\n\nvariable \"nomad_client_ec2_instance_type\" {\n  description = \"Instance type for Nomad client instances\"\n  type        = string\n  default     = \"t3.medium\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__hashicorp__nomad__terraform__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"create\" {\n  description = \"Controls if resources should be created (affects nearly all resources)\"\n  type        = bool\n  default     = true\n}\n\nvariable \"region\" {\n  description = \"Region where the resource(s) will be managed. Defaults to the Region set in the provider configuration\"\n  type        = string\n  default     = null\n}\n\nvariable \"tags\" {\n  description = \"A map of tags to add to all resources\"\n  type        = map(string)\n  default     = {}\n}\n\n################################################################################\n# Load Balancer\n################################################################################\n\nvariable \"access_logs\" {\n  description = \"Map containing access logging configuration for load balancer\"\n  type = object({\n    bucket  = string\n    enabled = optional(bool, true)\n    prefix  = optional(string)\n  })\n  default = null\n}\n\nvariable \"client_keep_alive\" {\n  description = \"Client keep alive value in seconds. The valid range is 60-604800 seconds. The default is 3600 seconds\"\n  type        = number\n  default     = null\n}\n\nvariable \"connection_logs\" {\n  description = \"Map containing access logging configuration for load balancer\"\n  type = object({\n    bucket  = string\n    enabled = optional(bool, true)\n    prefix  = optional(string)\n  })\n  default = null\n}\n\nvariable \"customer_owned_ipv4_pool\" {\n  description = \"The ID of the customer owned ipv4 pool to use for this load balancer\"\n  type        = string\n  default     = null\n}\n\nvariable \"desync_mitigation_mode\" {\n  description = \"Determines how the load balancer handles requests that might pose a security risk to an application due to HTTP desync. Valid values are `monitor`, `defensive` (default), `strictest`\"\n  type        = string\n  default     = null\n}\n\nvariable \"dns_record_client_routing_policy\" {\n  description = \"Indicates how traffic is distributed among the load balancer Availability Zones. Possible values are any_availability_zone (default), availability_zone_affinity, or partial_availability_zone_affinity. Only valid for network type load balancers\"\n  type        = string\n  default     = null\n}\n\nvariable \"drop_invalid_header_fields\" {\n  description = \"Indicates whether HTTP headers with header fields that are not valid are removed by the load balancer (`true`) or routed to targets (`false`). The default is `true`. Elastic Load Balancing requires that message header names contain only alphanumeric characters and hyphens. Only valid for Load Balancers of type `application`\"\n  type        = bool\n  default     = true\n}\n\nvariable \"enable_cross_zone_load_balancing\" {\n  description = \"If `true`, cross-zone load balancing of the load balancer will be enabled. For application load balancer this feature is always enabled (`true`) and cannot be disabled. Defaults to `true`\"\n  type        = bool\n  default     = true\n}\n\nvariable \"enable_deletion_protection\" {\n  description = \"If `true`, deletion of the load balancer will be disabled via the AWS API. This will prevent Terraform from deleting the load balancer. Defaults to `true`\"\n  type        = bool\n  default     = true\n}\n\nvariable \"enable_http2\" {\n  description = \"Indicates whether HTTP/2 is enabled in application load balancers. Defaults to `true`\"\n  type        = bool\n  default     = null\n}\n\nvariable \"enable_tls_version_and_cipher_suite_headers\" {\n  description = \"Indicates whether the two headers (`x-amzn-tls-version` and `x-amzn-tls-cipher-suite`), which contain information about the negotiated TLS version and cipher suite, are added to the client request before sending it to the target. Only valid for Load Balancers of type `application`. Defaults to `false`\"\n  type        = bool\n  default     = null\n}\n\nvariable \"enable_waf_fail_open\" {\n  description = \"Indicates whether to allow a WAF-enabled load balancer to route requests to targets if it is unable to forward the request to AWS WAF. Defaults to `false`\"\n  type        = bool\n  default     = null\n}\n\nvariable \"enable_xff_client_port\" {\n  description = \"Indicates whether the X-Forwarded-For header should preserve the source port that the client used to connect to the load balancer in `application` load balancers. Defaults to `false`\"\n  type        = bool\n  default     = null\n}\n\nvariable \"enable_zonal_shift\" {\n  description = \"Whether zonal shift is enabled\"\n  type        = bool\n  default     = null\n}\n\nvariable \"enforce_security_group_inbound_rules_on_private_link_traffic\" {\n  description = \"Indicates whether inbound security group rules are enforced for traffic originating from a PrivateLink. Only valid for Load Balancers of type network. The possible values are on and off\"\n  type        = string\n  default     = null\n}\n\nvariable \"idle_timeout\" {\n  description = \"The time in seconds that the connection is allowed to be idle. Only valid for Load Balancers of type `application`. Default: `60`\"\n  type        = number\n  default     = null\n}\n\nvariable \"internal\" {\n  description = \"If true, the LB will be internal. Defaults to `false`\"\n  type        = bool\n  default     = null\n}\n\nvariable \"ip_address_type\" {\n  description = \"The type of IP addresses used by the subnets for your load balancer. The possible values are `ipv4` and `dualstack`\"\n  type        = string\n  default     = null\n}\n\nvariable \"ipam_pools\" {\n  description = \"The IPAM pools to use with the load balancer\"\n  type = object({\n    ipv4_ipam_pool_id = string\n  })\n  default = null\n}\n\nvariable \"load_balancer_type\" {\n  description = \"The type of load balancer to create. Possible values are `application`, `gateway`, or `network`. The default value is `application`\"\n  type        = string\n  default     = \"application\"\n}\n\nvariable \"minimum_load_balancer_capacity\" {\n  description = \"Minimum capacity for a load balancer. Only valid for Load Balancers of type `application` or `network`\"\n  type = object({\n    capacity_units = number\n  })\n  default = null\n}\n\nvariable \"name\" {\n  description = \"The name of the LB. This name must be unique within your AWS account, can have a maximum of 32 characters, must contain only alphanumeric characters or hyphens, and must not begin or end with a hyphen\"\n  type        = string\n  default     = null\n}\n\nvariable \"name_prefix\" {\n  description = \"Creates a unique name beginning with the specified prefix. Conflicts with `name`\"\n  type        = string\n  default     = null\n}\n\nvariable \"preserve_host_header\" {\n  description = \"Indicates whether the Application Load Balancer should preserve the Host header in the HTTP request and send it to the target without any change. Defaults to `false`\"\n  type        = bool\n  default     = null\n}\n\nvariable \"security_groups\" {\n  description = \"A list of security group IDs to assign to the LB\"\n  type        = list(string)\n  default     = []\n}\n\nvariable \"subnet_mapping\" {\n  description = \"A list of subnet mapping blocks describing subnets to attach to load balancer\"\n  type = list(object({\n    allocation_id        = optional(string)\n    ipv6_address         = optional(string)\n    private_ipv4_address = optional(string)\n    subnet_id            = string\n  }))\n  default = null\n}\n\nvariable \"subnets\" {\n  description = \"A list of subnet IDs to attach to the LB. Subnets cannot be updated for Load Balancers of type `network`. Changing this value for load balancers of type `network` will force a recreation of the resource\"\n  type        = list(string)\n  default     = null\n}\n\nvariable \"xff_header_processing_mode\" {\n  description = \"Determines how the load balancer modifies the X-Forwarded-For header in the HTTP request before sending the request to the target. The possible values are `append`, `preserve`, and `remove`. Only valid for Load Balancers of type `application`. The default is `append`\"\n  type        = string\n  default     = null\n}\n\nvariable \"timeouts\" {\n  description = \"Create, update, and delete timeout configurations for the load balancer\"\n  type = object({\n    create = optional(string)\n    update = optional(string)\n    delete = optional(string)\n  })\n  default = null\n}\n\n################################################################################\n# Listener(s)\n################################################################################\n\nvariable \"default_port\" {\n  description = \"Default port used across the listener and target group\"\n  type        = number\n  default     = 80\n}\n\nvariable \"default_protocol\" {\n  description = \"Default protocol used across the listener and target group\"\n  type        = string\n  default     = \"HTTP\"\n}\n\nvariable \"listeners\" {\n  description = \"Map of listener configurations to create\"\n  type = map(object({\n    alpn_policy                 = optional(string)\n    certificate_arn             = optional(string)\n    additional_certificate_arns = optional(list(string), [])\n    authenticate_cognito = optional(object({\n      authentication_request_extra_params = optional(map(string))\n      on_unauthenticated_request          = optional(string)\n      scope                               = optional(string)\n      session_cookie_name                 = optional(string)\n      session_timeout                     = optional(number)\n      user_pool_arn                       = optional(string)\n      user_pool_client_id                 = optional(string)\n      user_pool_domain                    = optional(string)\n    }))\n    authenticate_oidc = optional(object({\n      authentication_request_extra_params = optional(map(string))\n      authorization_endpoint              = string\n      client_id                           = string\n      client_secret                       = string\n      issuer                              = string\n      on_unauthenticated_request          = optional(string)\n      scope                               = optional(string)\n      session_cookie_name                 = optional(string)\n      session_timeout                     = optional(number)\n      token_endpoint                      = string\n      user_info_endpoint                  = string\n    }))\n    fixed_response = optional(object({\n      content_type = string\n      message_body = optional(string)\n      status_code  = optional(string)\n    }))\n    forward = optional(object({\n      target_group_arn = optional(string)\n      target_group_key = optional(string)\n    }))\n    jwt_validation = optional(object({\n      issuer        = string\n      jwks_endpoint = string\n      additional_claim = optional(list(object({\n        format = string\n        name   = string\n        values = list(string)\n      })))\n    }))\n    weighted_forward = optional(object({\n      target_groups = optional(list(object({\n        target_group_arn = optional(string)\n        target_group_key = optional(string)\n        weight           = optional(number)\n      })))\n      stickiness = optional(object({\n        duration = optional(number)\n        enabled  = optional(bool)\n      }))\n    }))\n    redirect = optional(object({\n      host        = optional(string)\n      path        = optional(string)\n      port        = optional(string)\n      protocol    = optional(string)\n      query       = optional(string)\n      status_code = string\n    }))\n    mutual_authentication = optional(object({\n      advertise_trust_store_ca_names   = optional(string)\n      ignore_client_certificate_expiry = optional(bool)\n      mode                             = string\n      trust_store_arn                  = optional(string)\n    }))\n    order                                                                 = optional(number)\n    port                                                                  = optional(number)\n    protocol                                                              = optional(string)\n    routing_http_request_x_amzn_mtls_clientcert_header_name               = optional(string)\n    routing_http_request_x_amzn_mtls_clientcert_issuer_header_name        = optional(string)\n    routing_http_request_x_amzn_mtls_clientcert_leaf_header_name          = optional(string)\n    routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name = optional(string)\n    routing_http_request_x_amzn_mtls_clientcert_subject_header_name       = optional(string)\n    routing_http_request_x_amzn_mtls_clientcert_validity_header_name      = optional(string)\n    routing_http_request_x_amzn_tls_cipher_suite_header_name              = optional(string)\n    routing_http_request_x_amzn_tls_version_header_name                   = optional(string)\n    routing_http_response_access_control_allow_credentials_header_value   = optional(string)\n    routing_http_response_access_control_allow_headers_header_value       = optional(string)\n    routing_http_response_access_control_allow_methods_header_value       = optional(string)\n    routing_http_response_access_control_allow_origin_header_value        = optional(string)\n    routing_http_response_access_control_expose_headers_header_value      = optional(string)\n    routing_http_response_access_control_max_age_header_value             = optional(string)\n    routing_http_response_content_security_policy_header_value            = optional(string)\n    routing_http_response_server_enabled                                  = optional(bool)\n    routing_http_response_strict_transport_security_header_value          = optional(string)\n    routing_http_response_x_content_type_options_header_value             = optional(string)\n    routing_http_response_x_frame_options_header_value                    = optional(string)\n    ssl_policy                                                            = optional(string)\n    tcp_idle_timeout_seconds                                              = optional(number)\n    tags                                                                  = optional(map(string), {})\n\n    # Listener rules\n    rules = optional(map(object({\n      actions = list(object({\n        authenticate_cognito = optional(object({\n          authentication_request_extra_params = optional(map(string))\n          on_unauthenticated_request          = optional(string)\n          scope                               = optional(string)\n          session_cookie_name                 = optional(string)\n          session_timeout                     = optional(number)\n          user_pool_arn                       = string\n          user_pool_client_id                 = string\n          user_pool_domain                    = string\n        }))\n        authenticate_oidc = optional(object({\n          authentication_request_extra_params = optional(map(string))\n          authorization_endpoint              = string\n          client_id                           = string\n          client_secret                       = string\n          issuer                              = string\n          on_unauthenticated_request          = optional(string)\n          scope                               = optional(string)\n          session_cookie_name                 = optional(string)\n          session_timeout                     = optional(number)\n          token_endpoint                      = string\n          user_info_endpoint                  = string\n        }))\n        jwt_validation = optional(object({\n          issuer        = string\n          jwks_endpoint = string\n          additional_claim = optional(list(object({\n            format = string\n            name   = string\n            values = list(string)\n          })))\n        }))\n        fixed_response = optional(object({\n          content_type = string\n          message_body = optional(string)\n          status_code  = optional(string)\n        }))\n        forward = optional(object({\n          target_group_arn = optional(string)\n          target_group_key = optional(string)\n        }))\n        order = optional(number)\n        redirect = optional(object({\n          host        = optional(string)\n          path        = optional(string)\n          port        = optional(string)\n          protocol    = optional(string)\n          query       = optional(string)\n          status_code = string\n        }))\n        weighted_forward = optional(object({\n          stickiness = optional(object({\n            duration = optional(number)\n            enabled  = optional(bool)\n          }))\n          target_groups = optional(list(object({\n            target_group_arn = optional(string)\n            target_group_key = optional(string)\n            weight           = optional(number)\n          })))\n        }))\n      }))\n      conditions = list(object({\n        host_header = optional(object({\n          values       = optional(list(string))\n          regex_values = optional(list(string))\n        }))\n        http_header = optional(object({\n          http_header_name = string\n          values           = optional(list(string))\n          regex_values     = optional(list(string))\n        }))\n        http_request_method = optional(object({\n          values = list(string)\n        }))\n        path_pattern = optional(object({\n          values       = optional(list(string))\n          regex_values = optional(list(string))\n        }))\n        query_string = optional(list(object({\n          key   = optional(string)\n          value = string\n        })))\n        source_ip = optional(object({\n          values = list(string)\n        }))\n      }))\n      listener_arn = optional(string)\n      listener_key = optional(string)\n      priority     = optional(number)\n      transform = optional(map(object({\n        type = optional(string)\n        host_header_rewrite_config = optional(object({\n          rewrite = optional(object({\n            regex   = string\n            replace = string\n          }))\n        }))\n        url_rewrite_config = optional(object({\n          rewrite = optional(object({\n            regex   = string\n            replace = string\n          }))\n        }))\n      })))\n      tags = optional(map(string), {})\n    })), {})\n  }))\n  default = {}\n}\n\n################################################################################\n# Target Group\n################################################################################\n\nvariable \"target_groups\" {\n  description = \"Map of target group configurations to create\"\n  type = map(object({\n    connection_termination = optional(bool)\n    deregistration_delay   = optional(number)\n    health_check = optional(object({\n      enabled             = optional(bool)\n      healthy_threshold   = optional(number)\n      interval            = optional(number)\n      matcher             = optional(string)\n      path                = optional(string)\n      port                = optional(string)\n      protocol            = optional(string)\n      timeout             = optional(number)\n      unhealthy_threshold = optional(number)\n    }))\n    ip_address_type                    = optional(string)\n    lambda_multi_value_headers_enabled = optional(bool)\n    load_balancing_algorithm_type      = optional(string)\n    load_balancing_anomaly_mitigation  = optional(string)\n    load_balancing_cross_zone_enabled  = optional(string)\n    name                               = optional(string)\n    name_prefix                        = optional(string)\n    port                               = optional(number)\n    preserve_client_ip                 = optional(bool)\n    protocol                           = optional(string)\n    protocol_version                   = optional(string)\n    proxy_protocol_v2                  = optional(bool)\n    slow_start                         = optional(number)\n    stickiness = optional(object({\n      cookie_duration = optional(number)\n      cookie_name     = optional(string)\n      enabled         = optional(bool)\n      type            = string\n    }))\n    tags = optional(map(string))\n    target_failover = optional(list(object({\n      on_deregistration = string\n      on_unhealthy      = string\n    })))\n    target_group_health = optional(object({\n      dns_failover = optional(object({\n        minimum_healthy_targets_count      = optional(string)\n        minimum_healthy_targets_percentage = optional(string)\n      }))\n      unhealthy_state_routing = optional(object({\n        minimum_healthy_targets_count      = optional(number)\n        minimum_healthy_targets_percentage = optional(string)\n      }))\n    }))\n    target_health_state = optional(object({\n      enable_unhealthy_connection_termination = bool\n      unhealthy_draining_interval             = optional(number)\n    }))\n    target_type = optional(string)\n    target_id   = optional(string)\n    vpc_id      = optional(string)\n    # Attachment\n    create_attachment = optional(bool, true)\n    availability_zone = optional(string)\n    # Lambda\n    attach_lambda_permission  = optional(bool, false)\n    lambda_qualifier          = optional(string)\n    lambda_statement_id       = optional(string)\n    lambda_action             = optional(string)\n    lambda_principal          = optional(string)\n    lambda_source_account     = optional(string)\n    lambda_event_source_token = optional(string)\n  }))\n  default = null\n}\n\nvariable \"additional_target_group_attachments\" {\n  description = \"Map of additional target group attachments to create. Use `target_group_key` to attach to the target group created in `target_groups`\"\n  type = map(object({\n    target_group_key  = string\n    target_id         = string\n    target_type       = optional(string)\n    port              = optional(number)\n    availability_zone = optional(string)\n  }))\n  default = null\n}\n\n################################################################################\n# Security Group\n################################################################################\n\nvariable \"create_security_group\" {\n  description = \"Determines if a security group is created\"\n  type        = bool\n  default     = true\n}\n\nvariable \"security_group_name\" {\n  description = \"Name to use on security group created\"\n  type        = string\n  default     = null\n}\n\nvariable \"security_group_use_name_prefix\" {\n  description = \"Determines whether the security group name (`security_group_name`) is used as a prefix\"\n  type        = bool\n  default     = true\n}\n\nvariable \"security_group_description\" {\n  description = \"Description of the security group created\"\n  type        = string\n  default     = null\n}\n\nvariable \"vpc_id\" {\n  description = \"Identifier of the VPC where the security group will be created\"\n  type        = string\n  default     = null\n}\n\nvariable \"security_group_ingress_rules\" {\n  description = \"Security group ingress rules to add to the security group created\"\n  type = map(object({\n    name = optional(string)\n\n    cidr_ipv4                    = optional(string)\n    cidr_ipv6                    = optional(string)\n    description                  = optional(string)\n    from_port                    = optional(string)\n    ip_protocol                  = optional(string, \"tcp\")\n    prefix_list_id               = optional(string)\n    referenced_security_group_id = optional(string)\n    tags                         = optional(map(string), {})\n    to_port                      = optional(string)\n  }))\n  default = null\n}\n\nvariable \"security_group_egress_rules\" {\n  description = \"Security group egress rules to add to the security group created\"\n  type = map(object({\n    name = optional(string)\n\n    cidr_ipv4                    = optional(string)\n    cidr_ipv6                    = optional(string)\n    description                  = optional(string)\n    from_port                    = optional(string)\n    ip_protocol                  = optional(string, \"tcp\")\n    prefix_list_id               = optional(string)\n    referenced_security_group_id = optional(string)\n    tags                         = optional(map(string), {})\n    to_port                      = optional(string)\n  }))\n  default = null\n}\n\nvariable \"security_group_tags\" {\n  description = \"A map of additional tags to add to the security group created\"\n  type        = map(string)\n  default     = {}\n}\n\n################################################################################\n# Route53 Record(s)\n################################################################################\n\nvariable \"route53_records\" {\n  description = \"Map of Route53 records to create. Each record map should contain `zone_id`, `name`, and `type`\"\n  type = map(object({\n    zone_id                = string\n    name                   = optional(string)\n    type                   = string\n    evaluate_target_health = optional(bool, true)\n  }))\n  default = null\n}\n\n################################################################################\n# WAF\n################################################################################\n\nvariable \"associate_web_acl\" {\n  description = \"Indicates whether a Web Application Firewall (WAF) ACL should be associated with the load balancer\"\n  type        = bool\n  default     = false\n}\n\nvariable \"web_acl_arn\" {\n  description = \"Web Application Firewall (WAF) ARN of the resource to associate with the load balancer\"\n  type        = string\n  default     = null\n}\n\nvariable \"putin_khuylo\" {\n  description = \"Do you agree that Putin doesn't respect Ukrainian sovereignty and territorial integrity? More info: https://en.wikipedia.org/wiki/Putin_khuylo!\"\n  type        = bool\n  default     = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"environment_nuke_accounts\" {\n  value     = module.environments.environment_nuke_accounts\n  sensitive = true\n}\n\noutput \"environment_nuke_blocklist_accounts\" {\n  value     = module.environments.environment_nuke_blocklist_accounts\n  sensitive = true\n}\n\noutput \"environment_rebuild_after_nuke_accounts\" {\n  value     = module.environments.environment_rebuild_after_nuke_accounts\n  sensitive = true\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ministryofjustice__modernisation-platform__terraform__environments__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE AN ECS SERVICE TO RUN A LONG-RUNNING ECS TASK\n# We also associate the ECS Service with an ELB, which can distribute traffic across the ECS Tasks.\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_ecs_service\" \"service\" {\n  name = \"${var.name}\"\n  cluster = \"${var.ecs_cluster_id}\"\n  task_definition = \"${aws_ecs_task_definition.task.arn}\"\n  desired_count = \"${var.desired_count}\"\n  iam_role = \"${aws_iam_role.ecs_service_role.arn}\"\n\n  deployment_minimum_healthy_percent = \"${var.deployment_minimum_healthy_percent}\"\n  deployment_maximum_percent = \"${var.deployment_maximum_percent}\"\n\n  load_balancer {\n    elb_name = \"${var.elb_name}\"\n    container_name = \"${var.name}\"\n    container_port = \"${var.container_port}\"\n  }\n\n  depends_on = [\"aws_iam_role_policy.ecs_service_policy\"]\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE AN ECS TASK TO RUN A DOCKER CONTAINER\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_ecs_task_definition\" \"task\" {\n  family = \"${var.name}\"\n  container_definitions = <<EOF\n[\n  {\n    \"name\": \"${var.name}\",\n    \"image\": \"${var.image}:${var.image_version}\",\n    \"cpu\": ${var.cpu},\n    \"memory\": ${var.memory},\n    \"essential\": true,\n    \"portMappings\": [\n      {\n        \"containerPort\": ${var.container_port},\n        \"hostPort\": ${var.host_port},\n        \"protocol\": \"tcp\"\n      }\n    ],\n    \"environment\": [${join(\",\", data.template_file.env_vars.*.rendered)}]\n  }\n]\nEOF\n}\n\n# Convert the environment variables the user passed-in into the format expected for for an ECS Task:\n#\n# \"environment\": [\n#    {\"name\": \"NAME\", \"value\": \"VALUE\"},\n#    {\"name\": \"NAME\", \"value\": \"VALUE\"},\n#    ...\n# ]\n#\ndata \"template_file\" \"env_vars\" {\n  count = \"${var.num_env_vars}\"\n  template = <<EOF\n{\"name\": \"${element(keys(var.env_vars), count.index)}\", \"value\": \"${lookup(var.env_vars, element(keys(var.env_vars), count.index))}\"}\nEOF\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE AN IAM ROLE FOR THE ECS SERVICE\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_iam_role\" \"ecs_service_role\" {\n  name = \"${var.name}\"\n  assume_role_policy = \"${data.aws_iam_policy_document.ecs_service_role.json}\"\n}\n\ndata \"aws_iam_policy_document\" \"ecs_service_role\" {\n  statement {\n    effect = \"Allow\"\n    actions = [\"sts:AssumeRole\"]\n    principals {\n      type = \"Service\"\n      identifiers = [\"ecs.amazonaws.com\"]\n    }\n  }\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# ATTACH IAM PERMISSIONS TO THE IAM ROLE\n# This IAM Policy allows the ECS Service to communicate with EC2 Instances.\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_iam_role_policy\" \"ecs_service_policy\" {\n  name = \"ecs-service-policy\"\n  role = \"${aws_iam_role.ecs_service_role.id}\"\n  policy = \"${data.aws_iam_policy_document.ecs_service_policy.json}\"\n}\n\ndata \"aws_iam_policy_document\" \"ecs_service_policy\" {\n  statement {\n    effect = \"Allow\"\n    resources = [\"*\"]\n    actions = [\n      \"elasticloadbalancing:Describe*\",\n      \"elasticloadbalancing:DeregisterInstancesFromLoadBalancer\",\n      \"elasticloadbalancing:RegisterInstancesWithLoadBalancer\",\n      \"ec2:Describe*\",\n      \"ec2:AuthorizeSecurityGroupIngress\"\n    ]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__infrastructure-as-code-talk__terraform-configurations__ecs-service__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_111", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__infrastructure-as-code-talk__terraform-configurations__ecs-service__main.tf", "start_line": 98}, {"tool": "checkov", "rule_id": "CKV_AWS_356", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__infrastructure-as-code-talk__terraform-configurations__ecs-service__main.tf", "start_line": 98}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#Variables declaration\n\nvariable \"subscription_id\" {\n  description = \"Azure subscription Id.\"\n}\n\nvariable \"tenant_id\" {\n  description = \"Azure tenant Id.\"\n}\n\nvariable \"client_id\" {\n  description = \"Azure service principal application Id\"\n}\n\nvariable \"client_secret\" {\n  description = \"Azure service principal application Secret\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/JamesDLD__terraform__Best-Practice__BestPractice-1__var.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"test_var\" {\n  default = \"\"\n}\n\nprovider \"archive\" {}\n\nvariable \"test_list_var\" {\n  type    = list(string)\n  default = [\"a\", \"b\"]\n}\n\nvariable \"test_map_var\" {\n  type = map\n\n  default = {\n    \"a\" = \"a\"\n    \"b\" = \"b\"\n  }\n}\n\noutput \"test_output\" {\n  value = var.test_var\n}\n\noutput \"test_list_output\" {\n  value = var.test_list_var\n}\n\noutput \"test_map_output\" {\n  value = var.test_map_var\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/beelit94__python-terraform__test__var_to_output__test.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"azurerm\" {\n  #  resource_group_name  = \"TerraformState\"\n  #  storage_account_name = \"terraformstatehoussem\"\n  #  container_name       = \"terraform-state\"\n  #  key                  = \"prod.terraform.tfstate\"\n  }\n}\n\nprovider \"azurerm\" {\n  version = \">=2.0\"\n  # The \"feature\" block is required for AzureRM provider 2.x.\n  features {}\n}\n\nresource \"azurerm_resource_group\" \"resource_group_terraform\" {\n  name     = \"terraform_resource_group_4\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_app_service_plan\" \"app_service_plan_terraform\" {\n  name                = \"terraform-appserviceplan\"\n  location            = azurerm_resource_group.resource_group_terraform.location\n  resource_group_name = azurerm_resource_group.resource_group_terraform.name\n\n  sku {\n    tier = \"Standard\"\n    size = \"S1\"\n  }\n}\n\nresource \"azurerm_app_service\" \"app_service_terraform\" {\n  name                = \"app-service-terraform-houssem-4\"\n  location            = azurerm_resource_group.resource_group_terraform.location\n  resource_group_name = azurerm_resource_group.resource_group_terraform.name\n  app_service_plan_id = azurerm_app_service_plan.app_service_plan_terraform.id\n\n  site_config {\n    dotnet_framework_version = \"v4.0\"\n    scm_type                 = \"LocalGit\"\n  }\n\n  app_settings = {\n    \"SOME_KEY\" = \"some-value\"\n  }\n\n  connection_string {\n    name  = \"Database\"\n    type  = \"SQLServer\"\n    value = \"Server=some-server.mydomain.com;Integrated Security=SSPI\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_13", "severity": "HIGH", "message": "Ensure App Service Authentication is set on Azure App Service", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_17", "severity": "HIGH", "message": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_65", "severity": "HIGH", "message": "Ensure that App service enables detailed error messages", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_80", "severity": "HIGH", "message": "Ensure that 'Net Framework' version is the latest, if used as a part of the web app", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_66", "severity": "HIGH", "message": "Ensure that App service enables failed request tracing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_78", "severity": "HIGH", "message": "Ensure FTP deployments are disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_63", "severity": "HIGH", "message": "Ensure that App service enables HTTP logging", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_18", "severity": "HIGH", "message": "Ensure that 'HTTP Version' is the latest if used to run the web app", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_14", "severity": "HIGH", "message": "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_16", "severity": "HIGH", "message": "Ensure that Register with Azure Active Directory is enabled on App Service", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_71", "severity": "HIGH", "message": "Ensure that Managed identity provider is enabled for app services", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_213", "severity": "HIGH", "message": "Ensure that App Service configures health check", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AZURE_88", "severity": "HIGH", "message": "Ensure that app services use Azure Files", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__Terraform-Demo__app-service-variables__main.tf", "start_line": 32}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# security group creation and attcahing in ecs, alb etc\n\n# ALB Security Group: Edit to restrict access to the application\nresource \"aws_security_group\" \"alb-sg\" {\n  name        = \"testapp-load-balancer-security-group\"\n  description = \"controls access to the ALB\"\n  vpc_id      = aws_vpc.test-vpc.id\n\n  ingress {\n    protocol    = \"tcp\"\n    from_port   = var.app_port\n    to_port     = var.app_port\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    protocol    = \"-1\"\n    from_port   = 0\n    to_port     = 0\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\n# this security group for ecs - Traffic to the ECS cluster should only come from the ALB\nresource \"aws_security_group\" \"ecs_sg\" {\n  name        = \"testapp-ecs-tasks-security-group\"\n  description = \"allow inbound access from the ALB only\"\n  vpc_id      = aws_vpc.test-vpc.id\n\n  ingress {\n    protocol        = \"tcp\"\n    from_port       = var.app_port\n    to_port         = var.app_port\n    security_groups = [aws_security_group.alb-sg.id]\n  }\n\n  egress {\n    protocol    = \"-1\"\n    from_port   = 0\n    to_port     = 0\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__security-groups.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__security-groups.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__security-groups.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__security-groups.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__security-groups.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__security-groups.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__security-groups.tf", "start_line": 25}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#This Terraform Code Deploys Basic VPC Infra.\nprovider \"aws\" {\n    access_key = \"${var.aws_access_key}\"\n    secret_key = \"${var.aws_secret_key}\"\n    region = \"${var.aws_region}\"\n}\n\nterraform {\n  required_version = \"<= 1.3.14\" #Forcing which version of Terraform needs to be used\n  required_providers {\n    aws = {\n      version = \"<= 5.0.0\" #Forcing which version of plugin needs to be used.\n      source = \"hashicorp/aws\"\n    }\n  }\n}\n\nresource \"aws_vpc\" \"default\" {\n    cidr_block = \"${var.vpc_cidr}\"\n    enable_dns_hostnames = true\n    tags = {\n        Name = \"${var.vpc_name}\"\n\tOwner = \"Sreeharsha Veerapalli\"\n\tenvironment = \"${var.environment}\"\n    }\n}\n\nresource \"aws_internet_gateway\" \"default\" {\n    vpc_id = \"${aws_vpc.default.id}\"\n\ttags = {\n        Name = \"${var.IGW_name}\"\n    }\n}\n\nresource \"aws_subnet\" \"subnet1-public\" {\n    vpc_id = \"${aws_vpc.default.id}\"\n    cidr_block = \"${var.public_subnet1_cidr}\"\n    availability_zone = \"us-east-1a\"\n\n    tags = {\n        Name = \"${var.public_subnet1_name}\"\n    }\n}\n\nresource \"aws_subnet\" \"subnet2-public\" {\n    vpc_id = \"${aws_vpc.default.id}\"\n    cidr_block = \"${var.public_subnet2_cidr}\"\n    availability_zone = \"us-east-1b\"\n\n    tags = {\n        Name = \"${var.public_subnet2_name}\"\n    }\n}\n\nresource \"aws_subnet\" \"subnet3-public\" {\n    vpc_id = \"${aws_vpc.default.id}\"\n    cidr_block = \"${var.public_subnet3_cidr}\"\n    availability_zone = \"us-east-1c\"\n\n    tags = {\n        Name = \"${var.public_subnet3_name}\"\n    }\n\t\n}\n\n\nresource \"aws_route_table\" \"terraform-public\" {\n    vpc_id = \"${aws_vpc.default.id}\"\n\n    route {\n        cidr_block = \"0.0.0.0/0\"\n        gateway_id = \"${aws_internet_gateway.default.id}\"\n    }\n\n    tags = {\n        Name = \"${var.Main_Routing_Table}\"\n    }\n}\n\nresource \"aws_route_table_association\" \"terraform-public\" {\n    subnet_id = \"${aws_subnet.subnet1-public.id}\"\n    route_table_id = \"${aws_route_table.terraform-public.id}\"\n}\n\nresource \"aws_security_group\" \"allow_all\" {\n  name        = \"allow_all\"\n  description = \"Allow all inbound traffic\"\n  vpc_id      = \"${aws_vpc.default.id}\"\n\n  ingress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port       = 0\n    to_port         = 0\n    protocol        = \"-1\"\n    cidr_blocks     = [\"0.0.0.0/0\"]\n    }\n}\n\n# data \"aws_ami\" \"my_ami\" {\n#      most_recent      = true\n#      #name_regex       = \"^mavrick\"\n#      owners           = [\"721834156908\"]\n# }\n\n\n# resource \"aws_instance\" \"web-1\" {\n#     ami = var.imagename\n#     #ami = \"ami-0d857ff0f5fc4e03b\"\n#     #ami = \"${data.aws_ami.my_ami.id}\"\n#     availability_zone = \"us-east-1a\"\n#     instance_type = \"t2.micro\"\n#     key_name = \"LaptopKey\"\n#     subnet_id = \"${aws_subnet.subnet1-public.id}\"\n#     vpc_security_group_ids = [\"${aws_security_group.allow_all.id}\"]\n#     associate_public_ip_address = true\t\n#     tags = {\n#         Name = \"Server-1\"\n#         Env = \"Prod\"\n#         Owner = \"Sree\"\n# \tCostCenter = \"ABCD\"\n#     }\n# }\n\n##output \"ami_id\" {\n#  value = \"${data.aws_ami.my_ami.id}\"\n#}\n#!/bin/bash\n# echo \"Listing the files in the repo.\"\n# ls -al\n# echo \"+++++++++++++++++++++++++++++++++++++++++++++++++++++\"\n# echo \"Running Packer Now...!!\"\n# packer build -var=aws_access_key=AAAAAAAAAAAAAAAAAA -var=aws_secret_key=BBBBBBBBBBBBB packer.json\n#packer validate --var-file creds.json packer.json\n#packer build --var-file creds.json packer.json\n#packer.exe build --var-file creds.json -var=aws_access_key=AAAAAAAAAAAAAAAAAA -var=aws_secret_key=BBBBBBBBBBBBB packer.json\n# echo \"+++++++++++++++++++++++++++++++++++++++++++++++++++++\"\n# echo \"Running Terraform Now...!!\"\n# terraform init\n# terraform apply --var-file terraform.tfvars -var=\"aws_access_key=AAAAAAAAAAAAAAAAAA\" -var=\"aws_secret_key=BBBBBBBBBBBBB\" --auto-approve\n#https://discuss.devopscube.com/t/how-to-get-the-ami-id-after-a-packer-build/36\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mavrick202__terraformsingleinstance__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mavrick202__terraformsingleinstance__main.tf", "start_line": 85}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mavrick202__terraformsingleinstance__main.tf", "start_line": 85}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mavrick202__terraformsingleinstance__main.tf", "start_line": 85}, {"tool": "checkov", "rule_id": "CKV_AWS_25", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mavrick202__terraformsingleinstance__main.tf", "start_line": 85}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mavrick202__terraformsingleinstance__main.tf", "start_line": 85}, {"tool": "checkov", "rule_id": "CKV_AWS_277", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mavrick202__terraformsingleinstance__main.tf", "start_line": 85}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mavrick202__terraformsingleinstance__main.tf", "start_line": 85}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mavrick202__terraformsingleinstance__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mavrick202__terraformsingleinstance__main.tf", "start_line": 18}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nprovider \"vsphere\" {\n  user           = var.vsphere_user\n  password       = var.vsphere_password\n  vsphere_server = var.vsphere_server\n\n  # If you have a self-signed cert\n  allow_unverified_ssl = true\n}\n\n\nresource vsphere_virtual_machine \"this\" {\n  name             = var.hostname\n  resource_pool_id = data.vsphere_compute_cluster.this.resource_pool_id\n  datastore_id     = data.vsphere_datastore.this.id\n\n  num_cpus = 2\n  memory   = 1024\n  guest_id = data.vsphere_virtual_machine.template.guest_id\n  scsi_type = data.vsphere_virtual_machine.template.scsi_type\n\n  cdrom {\n    client_device = true\n  }\n\n  network_interface {\n    network_id   = data.vsphere_network.this.id\n    adapter_type = data.vsphere_virtual_machine.template.network_interface_types[0]\n  }\n  wait_for_guest_net_timeout = 0\n\n  disk {\n    label            = \"disk0\"\n    size             = data.vsphere_virtual_machine.template.disks.0.size\n    eagerly_scrub    = data.vsphere_virtual_machine.template.disks.0.eagerly_scrub\n    thin_provisioned = data.vsphere_virtual_machine.template.disks.0.thin_provisioned\n  }\n\n  clone {\n    template_uuid = data.vsphere_virtual_machine.template.id\n  }\n\n  \n\n  vapp {\n    properties ={\n      hostname = var.hostname\n      user-data = base64encode(file(\"${path.module}/cloudinit/kickstart.yaml\"))\n    }\n  }\n\n  extra_config = {\n    \"guestinfo.metadata\"          = base64encode(file(\"${path.module}/cloudinit/metadata.yaml\"))\n    \"guestinfo.metadata.encoding\" = \"base64\"\n    \"guestinfo.userdata\"          = base64encode(file(\"${path.module}/cloudinit/userdata.yaml\"))\n    \"guestinfo.userdata.encoding\" = \"base64\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linoproject__terraform__vsphere-cloudinit__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_s3_bucket\" \"b\" {\n  bucket_prefix = var.bucket_prefix\n  acl    = var.acl\n\n    versioning {\n        enabled = var.versioning\n    }\n\n    logging {\n        target_bucket = var.target_bucket\n        target_prefix = var.target_prefix\n    }\n\n    server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        kms_master_key_id = var.kms_master_key_id\n        sse_algorithm     = var.sse_algorithm\n      }\n    }\n  }\n\n    tags = var.tags\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Jakeasaurus__terraform__s3_bucket__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Jakeasaurus__terraform__s3_bucket__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Jakeasaurus__terraform__s3_bucket__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Jakeasaurus__terraform__s3_bucket__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Jakeasaurus__terraform__s3_bucket__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"eu-west-1\"\n}\n\nlocals {\n  user_data = <<EOF\n#!/bin/bash\necho \"Hello Terraform!\"\nEOF\n}\n\n##################################################################\n# Data sources to get VPC, subnet, security group and AMI details\n##################################################################\ndata \"aws_vpc\" \"default\" {\n  default = true\n}\n\ndata \"aws_subnet_ids\" \"all\" {\n  vpc_id = data.aws_vpc.default.id\n}\n\ndata \"aws_ami\" \"amazon_linux\" {\n  most_recent = true\n\n  owners = [\"amazon\"]\n\n  filter {\n    name = \"name\"\n\n    values = [\n      \"amzn-ami-hvm-*-x86_64-gp2\",\n    ]\n  }\n\n  filter {\n    name = \"owner-alias\"\n\n    values = [\n      \"amazon\",\n    ]\n  }\n}\n\nmodule \"security_group\" {\n  source  = \"terraform-aws-modules/security-group/aws\"\n  version = \"~> 3.0\"\n\n  name        = \"example\"\n  description = \"Security group for example usage with EC2 instance\"\n  vpc_id      = data.aws_vpc.default.id\n\n  ingress_cidr_blocks = [\"0.0.0.0/0\"]\n  ingress_rules       = [\"http-80-tcp\", \"all-icmp\"]\n  egress_rules        = [\"all-all\"]\n}\n\nresource \"aws_eip\" \"this\" {\n  vpc      = true\n  instance = module.ec2.id[0]\n}\n\nresource \"aws_placement_group\" \"web\" {\n  name     = \"hunky-dory-pg\"\n  strategy = \"cluster\"\n}\n\nresource \"aws_kms_key\" \"this\" {\n}\n\nresource \"aws_network_interface\" \"this\" {\n  count = 1\n\n  subnet_id = tolist(data.aws_subnet_ids.all.ids)[count.index]\n}\n\nmodule \"ec2\" {\n  source = \"../../\"\n\n  instance_count = 1\n\n  name          = \"example-normal\"\n  ami           = data.aws_ami.amazon_linux.id\n  instance_type = \"c5.large\"\n  subnet_id     = tolist(data.aws_subnet_ids.all.ids)[0]\n  #  private_ips                 = [\"172.31.32.5\", \"172.31.46.20\"]\n  vpc_security_group_ids      = [module.security_group.this_security_group_id]\n  associate_public_ip_address = true\n  placement_group             = aws_placement_group.web.id\n\n  user_data_base64 = base64encode(local.user_data)\n\n  root_block_device = [\n    {\n      volume_type = \"gp2\"\n      volume_size = 10\n    },\n  ]\n\n  ebs_block_device = [\n    {\n      device_name = \"/dev/sdf\"\n      volume_type = \"gp2\"\n      volume_size = 5\n      encrypted   = true\n      kms_key_id  = aws_kms_key.this.arn\n    }\n  ]\n\n  tags = {\n    \"Env\"      = \"Private\"\n    \"Location\" = \"Secret\"\n  }\n}\n\nmodule \"ec2_with_t2_unlimited\" {\n  source = \"../../\"\n\n  instance_count = 1\n\n  name          = \"example-t2-unlimited\"\n  ami           = data.aws_ami.amazon_linux.id\n  instance_type = \"t2.micro\"\n  cpu_credits   = \"unlimited\"\n  subnet_id     = tolist(data.aws_subnet_ids.all.ids)[0]\n  #  private_ip = \"172.31.32.10\"\n  vpc_security_group_ids      = [module.security_group.this_security_group_id]\n  associate_public_ip_address = true\n}\n\nmodule \"ec2_with_t3_unlimited\" {\n  source = \"../../\"\n\n  instance_count = 1\n\n  name                        = \"example-t3-unlimited\"\n  ami                         = data.aws_ami.amazon_linux.id\n  instance_type               = \"t3.large\"\n  cpu_credits                 = \"unlimited\"\n  subnet_id                   = tolist(data.aws_subnet_ids.all.ids)[0]\n  vpc_security_group_ids      = [module.security_group.this_security_group_id]\n  associate_public_ip_address = true\n}\n\nmodule \"ec2_with_metadata_options\" {\n  source = \"../../\"\n\n  instance_count = 1\n\n  name                        = \"example-metadata_options\"\n  ami                         = data.aws_ami.amazon_linux.id\n  instance_type               = \"t2.small\"\n  subnet_id                   = tolist(data.aws_subnet_ids.all.ids)[0]\n  vpc_security_group_ids      = [module.security_group.this_security_group_id]\n  associate_public_ip_address = true\n\n  metadata_options = {\n    http_endpoint               = \"enabled\"\n    http_tokens                 = \"required\"\n    http_put_response_hop_limit = 8\n  }\n}\n\nmodule \"ec2_with_network_interface\" {\n  source = \"../../\"\n\n  instance_count = 1\n\n  name            = \"example-network\"\n  ami             = data.aws_ami.amazon_linux.id\n  instance_type   = \"c5.large\"\n  placement_group = aws_placement_group.web.id\n\n  network_interface = [\n    {\n      device_index          = 0\n      network_interface_id  = aws_network_interface.this[0].id\n      delete_on_termination = false\n    }\n  ]\n}\n\n# This instance won't be created\nmodule \"ec2_zero\" {\n  source = \"../../\"\n\n  instance_count = 0\n\n  name                   = \"example-zero\"\n  ami                    = data.aws_ami.amazon_linux.id\n  instance_type          = \"c5.large\"\n  subnet_id              = tolist(data.aws_subnet_ids.all.ids)[0]\n  vpc_security_group_ids = [module.security_group.this_security_group_id]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kserge2001__terraform__examples__basic__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kserge2001__terraform__examples__basic__main.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_7", "severity": "HIGH", "message": "Ensure rotation for customer created CMKs is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kserge2001__terraform__examples__basic__main.tf", "start_line": 68}, {"tool": "checkov", "rule_id": "CKV2_AWS_64", "severity": "CRITICAL", "message": "Ensure KMS key Policy is defined", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kserge2001__terraform__examples__basic__main.tf", "start_line": 68}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"web\" {\n  ami                    = \"ami-0277155c3f0ab2930\"      #change ami id for different region\n  instance_type          = \"t2.micro\"\n  key_name               = \"vscode\"              #change key name as per your setup\n \n  tags = {\n    Name = \"project-MainEc2\"\n  }\n\n  root_block_device {         #we can give custom value here \n    volume_size = 40\n  }\n}\n\nresource \"aws_security_group\" \"devops-project-veera\" {\n  name        = \"devops-project-veera\"\n  description = \"Allow TLS inbound traffic\"\n\n  ingress = [\n    for port in [22, 80, 443, 8080, 9000, 3000, 8082, 8081] : {\n      description      = \"inbound rules\"\n      from_port        = port\n      to_port          = port\n      protocol         = \"tcp\"\n      cidr_blocks      = [\"0.0.0.0/0\"]\n      ipv6_cidr_blocks = []\n      prefix_list_ids  = []\n      security_groups  = []\n      self             = false\n    }\n  ]\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"devops-project-veera\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-12-multi-sgrules-forloop-ec2__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-12-multi-sgrules-forloop-ec2__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-12-multi-sgrules-forloop-ec2__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-12-multi-sgrules-forloop-ec2__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-12-multi-sgrules-forloop-ec2__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-12-multi-sgrules-forloop-ec2__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-12-multi-sgrules-forloop-ec2__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-12-multi-sgrules-forloop-ec2__main.tf", "start_line": 15}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Terraform AWS Application Load Balancer (ALB)\nmodule \"alb\" {\n  source  = \"terraform-aws-modules/alb/aws\"\n  #version = \"5.16.0\"\n  version = \"6.0.0\" \n\n  name = \"${local.name}-alb\"\n  load_balancer_type = \"application\"\n  vpc_id = module.vpc.vpc_id\n  /*Option-1: Give as list with specific subnets or in next line, pass all public subnets \n  subnets = [\n    module.vpc.public_subnets[0],\n    module.vpc.public_subnets[1]\n  ]*/\n  subnets = module.vpc.public_subnets\n  #security_groups = [module.loadbalancer_sg.this_security_group_id]\n  security_groups = [module.loadbalancer_sg.security_group_id]\n  # Listeners\n  # HTTP Listener - HTTP to HTTPS Redirect\n    http_tcp_listeners = [\n    {\n      port               = 80\n      protocol           = \"HTTP\"\n      action_type = \"redirect\"\n      redirect = {\n        port        = \"443\"\n        protocol    = \"HTTPS\"\n        status_code = \"HTTP_301\"\n      }\n    }\n  ]  \n  # Target Groups\n  target_groups = [\n    # App1 Target Group - TG Index = 0\n    {\n      name_prefix          = \"app1-\"\n      backend_protocol     = \"HTTP\"\n      backend_port         = 80\n      target_type          = \"instance\"\n      deregistration_delay = 10\n      health_check = {\n        enabled             = true\n        interval            = 30\n        path                = \"/app1/index.html\"\n        port                = \"traffic-port\"\n        healthy_threshold   = 3\n        unhealthy_threshold = 3\n        timeout             = 6\n        protocol            = \"HTTP\"\n        matcher             = \"200-399\"\n      }\n      protocol_version = \"HTTP1\"\n     /* # App1 Target Group - Targets\n      targets = {\n        my_app1_vm1 = {\n          target_id = module.ec2_private_app1.id[0]\n          port      = 80\n        },\n        my_app1_vm2 = {\n          target_id = module.ec2_private_app1.id[1]\n          port      = 80\n        }\n      }\n      tags =local.common_tags # Target Group Tags*/\n    },  \n  ]\n\n  # HTTPS Listener\n  https_listeners = [\n    # HTTPS Listener Index = 0 for HTTPS 443\n    {\n      port               = 443\n      protocol           = \"HTTPS\"\n      #certificate_arn    = module.acm.this_acm_certificate_arn\n      certificate_arn    = module.acm.acm_certificate_arn\n      action_type = \"fixed-response\"\n      fixed_response = {\n        content_type = \"text/plain\"\n        message_body = \"Fixed Static message - for Root Context\"\n        status_code  = \"200\"\n      }\n    }, \n  ]\n\n  # HTTPS Listener Rules\n  https_listener_rules = [\n    # Rule-1: /app1* should go to App1 EC2 Instances\n    { \n      https_listener_index = 0\n      priority = 1\n      actions = [\n        {\n          type               = \"forward\"\n          target_group_index = 0\n        }\n      ]\n      conditions = [{\n        path_patterns = [\"/*\"]\n      }]\n    },  \n  ]\n  tags = local.common_tags # ALB Tags\n}\n\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-iacdevops-with-aws-codepipeline__terraform-manifests__c10-02-ALB-application-loadbalancer.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-iacdevops-with-aws-codepipeline__terraform-manifests__c10-02-ALB-application-loadbalancer.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"eks\" {\n  source       = \"terraform-aws-modules/eks/aws\"\n  cluster_name = local.cluster_name\n  subnets      = module.vpc.private_subnets\n\n  tags = {\n    Environment = \"training\"\n    GithubRepo  = \"terraform-aws-eks\"\n    GithubOrg   = \"terraform-aws-modules\"\n  }\n\n  vpc_id = module.vpc.vpc_id\n\n  worker_groups = [\n    {\n      name                          = \"worker-group-1\"\n      instance_type                 = \"t2.small\"\n      additional_userdata           = \"echo foo bar\"\n      asg_desired_capacity          = 2\n      additional_security_group_ids = [aws_security_group.worker_group_mgmt_one.id]\n    },\n    {\n      name                          = \"worker-group-2\"\n      instance_type                 = \"t2.medium\"\n      additional_userdata           = \"echo foo bar\"\n      additional_security_group_ids = [aws_security_group.worker_group_mgmt_two.id]\n      asg_desired_capacity          = 1\n    },\n  ]\n}\n\ndata \"aws_eks_cluster\" \"cluster\" {\n  name = module.eks.cluster_id\n}\n\ndata \"aws_eks_cluster_auth\" \"cluster\" {\n  name = module.eks.cluster_id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/collabnix__terraform__beginners__aws__eks__eks-cluster.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#\n# MAINTAINER Vitaliy Natarov \"vitaliy.natarov@yahoo.com\"\n#\n\nterraform {\n  required_version = \">= 0.13.0\"\n\n  required_providers {\n    argocd = {\n      source  = \"oboukili/argocd\"\n      version = \"0.4.7\"\n    }\n  }\n}\n\nprovider \"argocd\" {\n  server_addr = \"argocd.local:443\" # env ARGOCD_SERVER\n  auth_token  = \"1234...\"          # env ARGOCD_AUTH_TOKEN\n  # username  = \"admin\"            # env ARGOCD_AUTH_USERNAME\n  # password  = \"foo\"              # env ARGOCD_AUTH_PASSWORD\n  insecure = false # env ARGOCD_INSECURE\n}\n\nmodule \"argocd_repository\" {\n  source = \"../../modules/repository\"\n\n  enable_repository = true\n  repository_repo   = \"https://helm.nginx.com/stable\"\n  repository_name   = \"nginx-stable\"\n  repository_type   = \"helm\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/SebastianUA__terraform__argocd__examples__repository__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
