{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#-----------------------------------------------------------\n# ArgoCD application\n#-----------------------------------------------------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/SebastianUA__terraform__argocd__modules__application__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# STATE_BUCKET=$(aws ssm get-parameters --names terraform_state_bucket | jq -r '.Parameters[0].Value')\n\n# terraform init -backend-config=\"bucket=$STATE_BUCKET\" -backend-config=\"key=lb-service-dev.tfstate\" -backend-config=\"region=us-west-2\"\n# terraform apply -var-file=../dev.tfvars\n# terraform destroy -var-file=../dev.tfvars\n\n# terraform init -backend-config=\"bucket=$STATE_BUCKET\" -backend-config=\"key=lb-service-qa.tfstate\" -backend-config=\"region=us-west-2\"\n# terraform apply -var-file=../qa.tfvars\n# terraform destroy -var-file=../qa.tfvars\n\nprovider \"aws\" {\n  region = var.region\n}\n\n# Terraform backend configuration to store state in S3\nterraform {\n  backend \"s3\" {}\n}\n\nlocals {\n  name = \"ecsdemo-frontend\"\n\n  tags = {\n    Blueprint   = local.name\n    GithubRepo  = \"github.com/aws-ia/ecs-blueprints\"\n    Environment = var.environment\n  }\n}\n\n################################################################################\n# ECS Blueprint\n################################################################################\n\nmodule \"service_alb\" {\n  source  = \"terraform-aws-modules/alb/aws\"\n  version = \"~> 8.3\"\n\n  name = \"${local.name}-alb\"\n\n  load_balancer_type = \"application\"\n\n  vpc_id  = data.aws_vpc.vpc.id\n  subnets = data.aws_subnets.public.ids\n\n  security_group_rules = {\n    ingress_all_http = {\n      type        = \"ingress\"\n      from_port   = 80\n      to_port     = 80\n      protocol    = \"tcp\"\n      description = \"HTTP web traffic\"\n      cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    egress_all = {\n      type        = \"egress\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_blocks = [for s in data.aws_subnet.private_cidr : s.cidr_block]\n    }\n  }\n\n  http_tcp_listeners = [\n    {\n      port               = \"80\"\n      protocol           = \"HTTP\"\n      target_group_index = 0\n    },\n    {\n      port               = \"8080\"\n      protocol           = \"HTTP\"\n      target_group_index = 1\n    },\n  ]\n\n  target_groups = [\n    {\n\n      name             = \"${local.name}-green-tg\"\n      backend_protocol = \"HTTP\"\n      backend_port     = var.container_port\n      target_type      = \"ip\"\n      health_check = {\n        path    = \"/\"\n        port    = var.container_port\n        matcher = \"200-299\"\n      }\n    },\n    {\n      name             = \"${local.name}-blue-tg\"\n      backend_protocol = \"HTTP\"\n      backend_port     = var.container_port\n      target_type      = \"ip\"\n      health_check = {\n        path    = \"/\"\n        port    = var.container_port\n        matcher = \"200-299\"\n      }\n    },\n  ]\n\n  tags = local.tags\n}\n\nresource \"aws_service_discovery_service\" \"this\" {\n  name = local.name\n\n  dns_config {\n    namespace_id = data.aws_service_discovery_dns_namespace.this.id\n\n    dns_records {\n      ttl  = 10\n      type = \"A\"\n    }\n\n    routing_policy = \"MULTIVALUE\"\n  }\n\n  health_check_custom_config {\n    failure_threshold = 1\n  }\n}\n\nmodule \"ecs_service_definition\" {\n  source  = \"terraform-aws-modules/ecs/aws//modules/service\"\n  version = \"~> 5.0\"\n\n  name               = local.name\n  desired_count      = 3\n  cluster_arn        = data.aws_ecs_cluster.core_infra.arn\n  enable_autoscaling = false\n\n  subnet_ids = data.aws_subnets.private.ids\n  security_group_rules = {\n    ingress_alb_service = {\n      type                     = \"ingress\"\n      from_port                = var.container_port\n      to_port                  = var.container_port\n      protocol                 = \"tcp\"\n      description              = \"Service port\"\n      source_security_group_id = module.service_alb.security_group_id\n    }\n    egress_all = {\n      type        = \"egress\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_blocks = [\"0.0.0.0/0\"]\n    }\n  }\n\n  deployment_controller = {\n    type = \"CODE_DEPLOY\"\n  }\n\n  load_balancer = [{\n    container_name   = var.container_name\n    container_port   = var.container_port\n    target_group_arn = element(module.service_alb.target_group_arns, 0)\n  }]\n\n  service_registries = {\n    registry_arn = aws_service_discovery_service.this.arn\n  }\n\n  # service_connect_configuration = {\n  #   enabled = false\n  # }\n\n  # Task Definition\n  create_iam_role           = false\n  create_task_exec_iam_role = true\n  #task_exec_iam_role_arn = one(data.aws_iam_roles.ecs_core_infra_exec_role.arns)\n  enable_execute_command = true\n\n  container_definitions = {\n    main_container = {\n      name                     = var.container_name\n      image                    = var.container_image\n      readonly_root_filesystem = false\n\n      port_mappings = [{\n        protocol : \"tcp\",\n        containerPort : var.container_port\n        hostPort : var.container_port\n      }]\n    }\n  }\n\n  ignore_task_definition_changes = false\n\n  tags = local.tags\n}\n\n################################################################################\n# Code Deploy\n################################################################################\n\nresource \"aws_sns_topic\" \"deployment_notificaitons\" {\n  name = \"${var.environment}_${local.name}_deployment_topic\"\n}\n\nmodule \"deploy_dev_service\" {\n  source          = \"../../modules/codedeploy\"\n  name            = \"deploy_${var.environment}_${local.name}\"\n  ecs_cluster     = data.aws_ecs_cluster.core_infra.cluster_name\n  ecs_service     = local.name\n  sns_topic_arn   = aws_sns_topic.deployment_notificaitons.arn\n  iam_role_name   = \"deploy_${var.environment}_${local.name}\"\n  create_iam_role = true\n  service_role    = aws_iam_role.codedeploy_service_role.arn\n  alb_listener    = module.service_alb.http_tcp_listener_arns[0]\n  tg_blue         = \"${local.name}-green-tg\"\n  tg_green        = \"${local.name}-blue-tg\"\n}\n\nresource \"aws_iam_role\" \"codedeploy_service_role\" {\n  name = \"codedeploy-service-role\"\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\",\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\",\n        Effect = \"Allow\",\n        Principal = {\n          Service = \"codedeploy.amazonaws.com\"\n        }\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"ecs_codedeploy_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AWSCodeDeployRoleForECS\"\n  role       = aws_iam_role.codedeploy_service_role.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"codedeploy_policy_attachment\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AWSCodeDeployFullAccess\"\n  role       = aws_iam_role.codedeploy_service_role.name\n}\n\n################################################################################\n# Supporting Resources\n################################################################################\n\ndata \"aws_vpc\" \"vpc\" {\n  filter {\n    name   = \"tag:Name\"\n    values = [\"core-infra-external-state\"]\n  }\n\n  filter {\n    name   = \"tag:Environment\"\n    values = [var.environment]\n  }\n\n}\n\ndata \"aws_subnets\" \"public\" {\n  filter {\n    name   = \"tag:Name\"\n    values = [\"core-infra-external-state-public-*\"]\n  }\n  filter {\n    name   = \"tag:Environment\"\n    values = [var.environment]\n  }\n}\n\ndata \"aws_subnets\" \"private\" {\n  filter {\n    name   = \"tag:Name\"\n    values = [\"core-infra-external-state-private-*\"]\n  }\n  tags = {\n    Environment = var.environment\n  }\n}\n\ndata \"aws_subnet\" \"private_cidr\" {\n  for_each = toset(data.aws_subnets.private.ids)\n  id       = each.value\n\n  tags = {\n    Environment = var.environment\n  }\n}\n\ndata \"aws_ecs_cluster\" \"core_infra\" {\n  tags = {\n    Environment = var.environment\n  }\n  cluster_name = \"core-infra-external-state\"\n\n}\n\ndata \"aws_service_discovery_dns_namespace\" \"this\" {\n  name = \"default.${data.aws_ecs_cluster.core_infra.cluster_name}.local\"\n  type = \"DNS_PRIVATE\"\n\n  tags = {\n    Environment = var.environment\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-external-state__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_26", "severity": "HIGH", "message": "Ensure all data stored in the SNS topic is encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-external-state__main.tf", "start_line": 199}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-external-state__main.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-external-state__main.tf", "start_line": 124}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Simple usage\ndata \"snowflake_connections\" \"simple\" {\n}\n\noutput \"simple_output\" {\n  value = data.snowflake_connections.simple.connections\n}\n\n# Filtering (like)\ndata \"snowflake_connections\" \"like\" {\n  like = \"connection-name\"\n}\n\noutput \"like_output\" {\n  value = data.snowflake_connections.like.connections\n}\n\n# Filtering by prefix (like)\ndata \"snowflake_connections\" \"like_prefix\" {\n  like = \"prefix%\"\n}\n\noutput \"like_prefix_output\" {\n  value = data.snowflake_connections.like_prefix.connections\n}\n\n# Ensure the number of connections is equal to exactly one element (with the use of check block)\ncheck \"connection_check\" {\n  data \"snowflake_connections\" \"assert_with_check_block\" {\n    like = \"connection-name\"\n  }\n\n  assert {\n    condition     = length(data.snowflake_connections.assert_with_check_block.connections) == 1\n    error_message = \"connections filtered by '${data.snowflake_connections.assert_with_check_block.like}' returned ${length(data.snowflake_connections.assert_with_check_block.connections)} connections where one was expected\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snowflakedb__terraform-provider-snowflake__examples__data-sources__snowflake_connections__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2022 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nterraform {\n  required_providers {\n    google = {\n      source  = \"hashicorp/google\"\n      version = \">= 3.54\"\n    }\n    google-beta = {\n      source  = \"hashicorp/google-beta\"\n      version = \">= 3.83\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \">= 3.0\"\n    }\n  }\n\n  required_version = \">= 0.12.31\"\n}\n\nprovider \"google\" {\n  project = var.project\n  region  = var.region\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__cluster-toolkit__community__front-end__ofe__infrastructure_files__vpc_tf__GCP__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"instances_ami\" {\n  description = <<EOD\nThe Amazon Machine Image (AMI) to use for the AWS EC2 instances of the module\nEOD\n\n  type = \"string\"\n}\n\nvariable \"subnet_availability_zone\" {\n  description = <<EOD\nThe isolated, regional location in which to place the subnet of the module\nEOD\n\n  type = \"string\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/newcontext-oss__kitchen-terraform__examples__extensive_kitchen_terraform__test__fixtures__wrapper__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"acl\" {\n  type        = string\n  default     = \"private\"\n  description = <<-EOT\n    The [canned ACL](https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html#canned-acl) to apply.\n    Deprecated by AWS in favor of bucket policies.\n    Automatically disabled if `s3_object_ownership` is set to \"BucketOwnerEnforced\".\n    Defaults to \"private\" for backwards compatibility, but we recommend setting `s3_object_ownership` to \"BucketOwnerEnforced\" instead.\n    EOT\n}\n\nvariable \"grants\" {\n  type = list(object({\n    id          = string\n    type        = string\n    permissions = list(string)\n    uri         = string\n  }))\n  default = []\n\n  description = <<-EOT\n    A list of policy grants for the bucket, taking a list of permissions.\n    Conflicts with `acl`. Set `acl` to `null` to use this.\n    Deprecated by AWS in favor of bucket policies.\n    Automatically disabled if `s3_object_ownership` is set to \"BucketOwnerEnforced\".\n    EOT\n  nullable    = false\n}\n\nvariable \"source_policy_documents\" {\n  type        = list(string)\n  default     = []\n  description = <<-EOT\n    List of IAM policy documents (in JSON) that are merged together into the exported document.\n    Statements defined in source_policy_documents must have unique SIDs.\n    Statement having SIDs that match policy SIDs generated by this module will override them.\n    EOT\n  nullable    = false\n}\n\nvariable \"force_destroy\" {\n  type        = bool\n  default     = false\n  description = <<-EOT\n    When `true`, permits a non-empty S3 bucket to be deleted by first deleting all objects in the bucket.\n    THESE OBJECTS ARE NOT RECOVERABLE even if they were versioned and stored in Glacier.\n    EOT\n  nullable    = false\n}\n\nvariable \"versioning_enabled\" {\n  type        = bool\n  default     = true\n  description = \"A state of versioning. Versioning is a means of keeping multiple variants of an object in the same bucket\"\n  nullable    = false\n}\n\nvariable \"logging\" {\n  type = list(object({\n    bucket_name = string\n    prefix      = string\n  }))\n  default     = []\n  description = \"Bucket access logging configuration. Empty list for no logging, list of 1 to enable logging.\"\n  nullable    = false\n}\n\nvariable \"sse_algorithm\" {\n  type        = string\n  default     = \"AES256\"\n  description = \"The server-side encryption algorithm to use. Valid values are `AES256` and `aws:kms`\"\n  nullable    = false\n}\n\nvariable \"kms_master_key_arn\" {\n  type        = string\n  default     = \"\"\n  description = \"The AWS KMS master key ARN used for the `SSE-KMS` encryption. This can only be used when you set the value of `sse_algorithm` as `aws:kms`. The default aws/s3 AWS KMS master key is used if this element is absent while the `sse_algorithm` is `aws:kms`\"\n  nullable    = false\n}\n\nvariable \"user_enabled\" {\n  type        = bool\n  default     = false\n  description = \"Set to `true` to create an IAM user with permission to access the bucket\"\n  nullable    = false\n}\n\nvariable \"user_permissions_boundary_arn\" {\n  type        = string\n  default     = null\n  description = \"Permission boundary ARN for the IAM user created to access the bucket.\"\n}\n\nvariable \"access_key_enabled\" {\n  type        = bool\n  default     = true\n  description = \"Set to `true` to create an IAM Access Key for the created IAM user\"\n  nullable    = false\n}\n\nvariable \"store_access_key_in_ssm\" {\n  type        = bool\n  default     = false\n  description = <<-EOT\n    Set to `true` to store the created IAM user's access key in SSM Parameter Store,\n    `false` to store them in Terraform state as outputs.\n    Since Terraform state would contain the secrets in plaintext,\n    use of SSM Parameter Store is recommended.\n    EOT\n  nullable    = false\n}\n\nvariable \"ssm_base_path\" {\n  type        = string\n  description = \"The base path for SSM parameters where created IAM user's access key is stored\"\n  default     = \"/s3_user/\"\n  nullable    = false\n}\n\nvariable \"allowed_bucket_actions\" {\n  type        = list(string)\n  default     = [\"s3:PutObject\", \"s3:PutObjectAcl\", \"s3:GetObject\", \"s3:DeleteObject\", \"s3:ListBucket\", \"s3:ListBucketMultipartUploads\", \"s3:GetBucketLocation\", \"s3:AbortMultipartUpload\"]\n  description = \"List of actions the user is permitted to perform on the S3 bucket\"\n  nullable    = false\n}\n\nvariable \"allow_encrypted_uploads_only\" {\n  type        = bool\n  default     = false\n  description = \"Set to `true` to prevent uploads of unencrypted objects to S3 bucket\"\n  nullable    = false\n}\n\nvariable \"allow_ssl_requests_only\" {\n  type        = bool\n  default     = false\n  description = \"Set to `true` to require requests to use Secure Socket Layer (HTTPS/SSL). This will explicitly deny access to HTTP requests\"\n  nullable    = false\n}\n\nvariable \"minimum_tls_version\" {\n  type        = string\n  default     = null\n  description = \"Set the minimum TLS version for in-transit traffic\"\n}\n\nvariable \"lifecycle_configuration_rules\" {\n  type = list(object({\n    enabled = optional(bool, true)\n    id      = string\n\n    abort_incomplete_multipart_upload_days = optional(number)\n\n    # `filter_and` is the `and` configuration block inside the `filter` configuration.\n    # This is the only place you should specify a prefix.\n    filter_and = optional(object({\n      object_size_greater_than = optional(number) # integer >= 0\n      object_size_less_than    = optional(number) # integer >= 1\n      prefix                   = optional(string)\n      tags                     = optional(map(string), {})\n    }))\n    expiration = optional(object({\n      date                         = optional(string) # string, RFC3339 time format, GMT\n      days                         = optional(number) # integer > 0\n      expired_object_delete_marker = optional(bool)\n    }))\n    noncurrent_version_expiration = optional(object({\n      newer_noncurrent_versions = optional(number) # integer > 0\n      noncurrent_days           = optional(number) # integer >= 0\n    }))\n    transition = optional(list(object({\n      date          = optional(string) # string, RFC3339 time format, GMT\n      days          = optional(number) # integer > 0\n      storage_class = optional(string)\n      # string/enum, one of GLACIER, STANDARD_IA, ONEZONE_IA, INTELLIGENT_TIERING, DEEP_ARCHIVE, GLACIER_IR.\n    })), [])\n\n    noncurrent_version_transition = optional(list(object({\n      newer_noncurrent_versions = optional(number) # integer >= 0\n      noncurrent_days           = optional(number) # integer >= 0\n      storage_class             = optional(string)\n      # string/enum, one of GLACIER, STANDARD_IA, ONEZONE_IA, INTELLIGENT_TIERING, DEEP_ARCHIVE, GLACIER_IR.\n    })), [])\n  }))\n  default     = []\n  description = \"A list of lifecycle V2 rules\"\n  nullable    = false\n}\n# See lifecycle.tf for conversion of deprecated `lifecycle_rules` to `lifecycle_configuration_rules`\n\n\nvariable \"cors_configuration\" {\n  type = list(object({\n    id              = optional(string)\n    allowed_headers = optional(list(string))\n    allowed_methods = optional(list(string))\n    allowed_origins = optional(list(string))\n    expose_headers  = optional(list(string))\n    max_age_seconds = optional(number)\n  }))\n  description = \"Specifies the allowed headers, methods, origins and exposed headers when using CORS on this bucket\"\n  default     = []\n  nullable    = false\n}\n\nvariable \"block_public_acls\" {\n  type        = bool\n  default     = true\n  description = \"Set to `false` to disable the blocking of new public access lists on the bucket\"\n  nullable    = false\n}\n\nvariable \"block_public_policy\" {\n  type        = bool\n  default     = true\n  description = \"Set to `false` to disable the blocking of new public policies on the bucket\"\n  nullable    = false\n}\n\nvariable \"ignore_public_acls\" {\n  type        = bool\n  default     = true\n  description = \"Set to `false` to disable the ignoring of public access lists on the bucket\"\n  nullable    = false\n}\n\nvariable \"restrict_public_buckets\" {\n  type        = bool\n  default     = true\n  description = \"Set to `false` to disable the restricting of making the bucket public\"\n  nullable    = false\n}\n\nvariable \"s3_replication_enabled\" {\n  type        = bool\n  default     = false\n  description = \"Set this to true and specify `s3_replication_rules` to enable replication. `versioning_enabled` must also be `true`.\"\n  nullable    = false\n}\n\nvariable \"s3_replica_bucket_arn\" {\n  type        = string\n  default     = \"\"\n  description = <<-EOT\n    A single S3 bucket ARN to use for all replication rules.\n    Note: The destination bucket can be specified in the replication rule itself\n    (which allows for multiple destinations), in which case it will take precedence over this variable.\n    EOT\n}\n\nvariable \"s3_replication_rules\" {\n  type = list(object({\n    id       = optional(string)\n    priority = optional(number)\n    prefix   = optional(string)\n    status   = optional(string, \"Enabled\")\n    # delete_marker_replication { status } had been flattened for convenience\n    delete_marker_replication_status = optional(string, \"Disabled\")\n    # Add the configuration as it appears in the resource, for consistency\n    # this nested version takes precedence if both are provided.\n    delete_marker_replication = optional(object({\n      status = string\n    }))\n\n    # destination_bucket is specified here rather than inside the destination object because before optional\n    # attributes, it made it easier to work with the Terraform type system and create a list of consistent type.\n    # It is preserved for backward compatibility, but the nested version takes priority if both are provided.\n    destination_bucket = optional(string) # destination bucket ARN, overrides s3_replica_bucket_arn\n\n    destination = object({\n      bucket        = optional(string) # destination bucket ARN, overrides s3_replica_bucket_arn\n      storage_class = optional(string, \"STANDARD\")\n      # replica_kms_key_id at this level is for backward compatibility, and is overridden by the one in `encryption_configuration`\n      replica_kms_key_id = optional(string, \"\")\n      encryption_configuration = optional(object({\n        replica_kms_key_id = string\n      }))\n      access_control_translation = optional(object({\n        owner = string\n      }))\n      # account_id is for backward compatibility, overridden by account\n      account_id = optional(string)\n      account    = optional(string)\n      # For convenience, specifying either metrics or replication_time enables both\n      metrics = optional(object({\n        event_threshold = optional(object({\n          minutes = optional(number, 15) # Currently 15 is the only valid number\n        }), { minutes = 15 })\n        status = optional(string, \"Enabled\")\n      }), { status = \"Disabled\" })\n      # To preserve backward compatibility, Replication Time Control (RTC) is automatically enabled\n      # when metrics are enabled. To enable metrics without RTC, you must explicitly configure\n      # replication_time.status = \"Disabled\".\n      replication_time = optional(object({\n        time = optional(object({\n          minutes = optional(number, 15) # Currently 15 is the only valid number\n        }), { minutes = 15 })\n        status = optional(string)\n      }))\n    })\n\n    source_selection_criteria = optional(object({\n      replica_modifications = optional(object({\n        status = string # Either Enabled or Disabled\n      }))\n      sse_kms_encrypted_objects = optional(object({\n        status = optional(string)\n      }))\n    }))\n    # filter.prefix overrides top level prefix\n    filter = optional(object({\n      prefix = optional(string)\n      tags   = optional(map(string), {})\n    }))\n  }))\n  default     = null\n  description = \"Specifies the replication rules for S3 bucket replication if enabled. You must also set s3_replication_enabled to true.\"\n}\nlocals {\n  # Deprecate `replication_rules` in favor of `s3_replication_rules` to keep all the replication related\n  # inputs grouped under s3_replica[tion]\n  s3_replication_rules = var.replication_rules == null ? var.s3_replication_rules : var.replication_rules\n}\n\nvariable \"s3_replication_source_roles\" {\n  type        = list(string)\n  default     = []\n  description = \"Cross-account IAM Role ARNs that will be allowed to perform S3 replication to this bucket (for replication within the same AWS account, it's not necessary to adjust the bucket policy).\"\n  nullable    = false\n}\n\nvariable \"s3_replication_permissions_boundary_arn\" {\n  type        = string\n  default     = null\n  description = \"Permissions boundary ARN for the created IAM replication role.\"\n}\n\nvariable \"bucket_name\" {\n  type        = string\n  default     = null\n  description = \"Bucket name. If provided, the bucket will be created with this name instead of generating the name from the context\"\n}\n\nvariable \"object_lock_configuration\" {\n  type = object({\n    mode  = string # Valid values are GOVERNANCE and COMPLIANCE.\n    days  = number\n    years = number\n  })\n  default     = null\n  description = \"A configuration for S3 object locking. With S3 Object Lock, you can store objects using a `write once, read many` (WORM) model. Object Lock can help prevent objects from being deleted or overwritten for a fixed amount of time or indefinitely.\"\n}\n\nvariable \"website_redirect_all_requests_to\" {\n  type = list(object({\n    host_name = string\n    protocol  = string\n  }))\n  description = \"If provided, all website requests will be redirected to the specified host name and protocol\"\n  default     = []\n\n  validation {\n    condition     = length(var.website_redirect_all_requests_to) < 2\n    error_message = \"Only 1 website_redirect_all_requests_to is allowed.\"\n  }\n  nullable = false\n}\n\nvariable \"website_configuration\" {\n  type = list(object({\n    index_document = string\n    error_document = string\n    routing_rules = list(object({\n      condition = object({\n        http_error_code_returned_equals = string\n        key_prefix_equals               = string\n      })\n      redirect = object({\n        host_name               = string\n        http_redirect_code      = string\n        protocol                = string\n        replace_key_prefix_with = string\n        replace_key_with        = string\n      })\n    }))\n  }))\n  description = \"Specifies the static website hosting configuration object\"\n  default     = []\n\n  validation {\n    condition     = length(var.website_configuration) < 2\n    error_message = \"Only 1 website_configuration is allowed.\"\n  }\n  nullable = false\n}\n\n# Need input to be a list to fix https://github.com/cloudposse/terraform-aws-s3-bucket/issues/102\nvariable \"privileged_principal_arns\" {\n  #  type        = map(list(string))\n  #  default     = {}\n  type    = list(map(list(string)))\n  default = []\n\n  description = <<-EOT\n    List of maps. Each map has a key, an IAM Principal ARN, whose associated value is\n    a list of S3 path prefixes to grant `privileged_principal_actions` permissions for that principal,\n    in addition to the bucket itself, which is automatically included. Prefixes should not begin with '/'.\n    EOT\n  nullable    = false\n}\n\nvariable \"privileged_principal_actions\" {\n  type        = list(string)\n  default     = []\n  description = \"List of actions to permit `privileged_principal_arns` to perform on bucket and bucket prefixes (see `privileged_principal_arns`)\"\n  nullable    = false\n}\n\nvariable \"source_ip_allow_list\" {\n  type        = list(string)\n  default     = []\n  description = \"List of IP addresses to allow to perform all actions to the bucket\"\n  nullable    = false\n}\n\nvariable \"transfer_acceleration_enabled\" {\n  type        = bool\n  default     = false\n  description = <<-EOT\n    Set this to `true` to enable S3 Transfer Acceleration for the bucket.\n    Note: When this is set to `false` Terraform does not perform drift detection\n    and will not disable Transfer Acceleration if it was enabled outside of Terraform.\n    To disable it via Terraform, you must set this to `true` and then to `false`.\n    Note: not all regions support Transfer Acceleration.\n    EOT\n  nullable    = false\n}\n\nvariable \"s3_object_ownership\" {\n  type        = string\n  default     = \"ObjectWriter\"\n  description = <<-EOT\n    Specifies the S3 object ownership control.\n    Valid values are `ObjectWriter`, `BucketOwnerPreferred`, and 'BucketOwnerEnforced'.\n    Defaults to \"ObjectWriter\" for backwards compatibility, but we recommend setting \"BucketOwnerEnforced\" instead.\n    EOT\n  nullable    = false\n}\n\nvariable \"bucket_key_enabled\" {\n  type        = bool\n  default     = false\n  description = <<-EOT\n  Set this to true to use Amazon S3 Bucket Keys for SSE-KMS, which may or may not reduce the number of AWS KMS requests.\n  For more information, see: https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-key.html\n  EOT\n  nullable    = false\n}\n\nvariable \"expected_bucket_owner\" {\n  type        = string\n  default     = null\n  description = <<-EOT\n    Account ID of the expected bucket owner. \n    More information: https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-owner-condition.html\n  EOT\n}\n\nvariable \"event_notification_details\" {\n  type = object({\n    enabled     = bool\n    eventbridge = optional(bool, false)\n    lambda_list = optional(list(object({\n      lambda_function_arn = string\n      events              = optional(list(string), [\"s3:ObjectCreated:*\"])\n      filter_prefix       = optional(string)\n      filter_suffix       = optional(string)\n    })), [])\n\n    queue_list = optional(list(object({\n      queue_arn     = string\n      events        = optional(list(string), [\"s3:ObjectCreated:*\"])\n      filter_prefix = optional(string)\n      filter_suffix = optional(string)\n    })), [])\n\n    topic_list = optional(list(object({\n      topic_arn     = string\n      events        = optional(list(string), [\"s3:ObjectCreated:*\"])\n      filter_prefix = optional(string)\n      filter_suffix = optional(string)\n    })), [])\n  })\n  description = \"S3 event notification details\"\n  default = {\n    enabled = false\n  }\n}\n\nvariable \"s3_request_payment_configuration\" {\n  type = object({\n    enabled               = bool\n    expected_bucket_owner = optional(string)\n    payer                 = string\n  })\n  description = \"S3 request payment configuration\"\n  default = {\n    enabled = false\n    payer   = \"BucketOwner\"\n  }\n  validation {\n    condition     = contains([\"bucketowner\", \"requester\"], lower(var.s3_request_payment_configuration.payer))\n    error_message = \"The s3 request payment config's payer must be either BucketOwner or Requester\"\n  }\n}\n\nvariable \"create_s3_directory_bucket\" {\n  description = \"Control the creation of the S3 directory bucket. Set to true to create the bucket, false to skip.\"\n  type        = bool\n  default     = false\n}\n\nvariable \"availability_zone_id\" {\n  description = \"The ID of the availability zone.\"\n  type        = string\n  default     = \"\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-s3-bucket__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n\n  eks_map_roles = [\n    {\n      rolearn  = \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:role/administrator\"\n      username = \"administrator\"\n      groups   = [\"system:masters\"]\n    }\n  ]\n}\n\ndata \"aws_ami\" \"eks_default_arm64\" {\n  most_recent = true\n  owners      = [\"amazon\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"amazon-eks-arm64-node-${var.eks_cluster_version}-v*\"]\n\n  }\n}\n\n#tfsec:ignore:aws-vpc-no-public-egress-sgr tfsec:ignore:aws-eks-enable-control-plane-logging tfsec:ignore:aws-eks-encrypt-secrets tfsec:ignore:aws-eks-no-public-cluster-access tfsec:ignore:aws-eks-no-public-cluster-access-to-cidr\nmodule \"eks\" {\n  source  = \"terraform-aws-modules/eks/aws\"\n  version = \"19.12.0\"\n\n  cluster_name              = local.name\n  cluster_version           = var.eks_cluster_version\n  subnet_ids                = module.vpc.private_subnets\n  control_plane_subnet_ids  = module.vpc.intra_subnets\n  enable_irsa               = true\n  manage_aws_auth_configmap = true\n  create_aws_auth_configmap = false\n  aws_auth_roles            = local.eks_map_roles\n  cluster_addons = {\n    coredns = {\n      most_recent = true\n    }\n    kube-proxy = {\n      most_recent = true\n    }\n    vpc-cni = {\n      most_recent              = true\n      service_account_role_arn = module.vpc_cni_irsa.iam_role_arn\n      configuration_values = jsonencode({\n        enableNetworkPolicy = \"true\"\n      })\n    }\n    aws-ebs-csi-driver = {\n      most_recent              = true\n      service_account_role_arn = module.aws_ebs_csi_driver.iam_role_arn\n    }\n  }\n\n  cluster_enabled_log_types              = var.eks_cluster_enabled_log_types\n  cloudwatch_log_group_retention_in_days = var.eks_cloudwatch_log_group_retention_in_days\n\n  vpc_id = module.vpc.vpc_id\n\n  cluster_endpoint_public_access       = var.eks_cluster_endpoint_public_access\n  cluster_endpoint_private_access      = var.eks_cluster_endpoint_private_access\n  cluster_endpoint_public_access_cidrs = var.eks_cluster_endpoint_only_pritunl ? [\"${module.pritunl[0].pritunl_endpoint}/32\"] : [\"0.0.0.0/0\"]\n\n  node_security_group_tags = { \"karpenter.sh/discovery\" = local.name }\n\n  self_managed_node_group_defaults = {\n    ami_id = data.aws_ami.eks_default_arm64.id\n    block_device_mappings = {\n      xvda = {\n        device_name = \"/dev/xvda\"\n        ebs = {\n          delete_on_termination = true\n          encrypted             = false\n          volume_size           = 100\n          volume_type           = \"gp3\"\n        }\n\n      }\n    }\n    metadata_options = {\n      http_endpoint               = \"enabled\"\n      http_tokens                 = \"required\"\n      http_put_response_hop_limit = 1\n      instance_metadata_tags      = \"disabled\"\n    }\n    iam_role_attach_cni_policy = false\n  }\n  self_managed_node_groups = {\n    default = {\n      name          = \"${local.name}-default\"\n      iam_role_name = \"${local.name}-default\"\n      desired_size  = var.node_group_default.desired_capacity\n      max_size      = var.node_group_default.max_capacity\n      min_size      = var.node_group_default.min_capacity\n      subnet_ids    = module.vpc.private_subnets\n\n      bootstrap_extra_args       = \"--kubelet-extra-args '--node-labels=nodegroup=default --register-with-taints=CriticalAddonsOnly=true:NoSchedule'\"\n      capacity_rebalance         = var.node_group_default.capacity_rebalance\n      use_mixed_instances_policy = var.node_group_default.use_mixed_instances_policy\n      mixed_instances_policy     = var.node_group_default.mixed_instances_policy\n    }\n  }\n  fargate_profiles = {\n    default = {\n      name = \"fargate\"\n\n      selectors = [\n        {\n          namespace = \"fargate\"\n        }\n      ]\n\n      subnets = module.vpc.private_subnets\n\n      tags = merge(local.tags, {\n        Namespace = \"fargate\"\n      })\n    }\n  }\n\n  tags = { \"ClusterName\" = local.name }\n}\n\nmodule \"vpc_cni_irsa\" {\n  source  = \"terraform-aws-modules/iam/aws//modules/iam-role-for-service-accounts-eks\"\n  version = \"5.17.0\"\n\n  role_name             = \"${local.name}-vpc-cni\"\n  attach_vpc_cni_policy = true\n  vpc_cni_enable_ipv4   = true\n\n  oidc_providers = {\n    main = {\n      provider_arn               = module.eks.oidc_provider_arn\n      namespace_service_accounts = [\"kube-system:aws-node\"]\n    }\n  }\n\n  tags = local.tags\n}\n\nmodule \"aws_ebs_csi_driver\" {\n  source  = \"terraform-aws-modules/iam/aws//modules/iam-role-for-service-accounts-eks\"\n  version = \"5.17.0\"\n\n  role_name             = \"${local.name}-aws-ebs-csi-driver\"\n  attach_ebs_csi_policy = true\n\n  oidc_providers = {\n    main = {\n      provider_arn               = module.eks.oidc_provider_arn\n      namespace_service_accounts = [\"kube-system:ebs-csi-controller-sa\"]\n    }\n  }\n\n  tags = local.tags\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/maddevsio__aws-eks-base__terraform__layer1-aws__aws-eks.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/maddevsio__aws-eks-base__terraform__layer1-aws__aws-eks.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/maddevsio__aws-eks-base__terraform__layer1-aws__aws-eks.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/maddevsio__aws-eks-base__terraform__layer1-aws__aws-eks.tf", "start_line": 143}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"ibm\" {\n  ibmcloud_api_key = var.ibmcloud_api_key\n}\n\n// Provision atracker_target resource instance\nresource \"ibm_atracker_target\" \"atracker_target_instance\" {\n  name = var.atracker_target_name\n  target_type = var.atracker_target_target_type\n  cos_endpoint {\n    endpoint = \"s3.private.us-east.cloud-object-storage.appdomain.cloud\"\n    target_crn = \"crn:v1:bluemix:public:cloud-object-storage:global:a/11111111111111111111111111111111:22222222-2222-2222-2222-222222222222::\"\n    bucket = \"my-atracker-bucket\"\n    api_key = \"xxxxxxxxxxxxxx\"\n  }\n  region = var.atracker_target_region\n}\n\nresource \"ibm_atracker_target\" atracker_target_eventstreams_instance {\n  name = var.atracker_target_name\n  target_type = \"event_streams\"\n  eventstreams_endpoint {\n    target_crn = \"crn:v1:bluemix:public:messagehub:us-south:a/11111111111111111111111111111111:22222222-2222-2222-2222-222222222222::\"\n    brokers = [ \"kafka-x:9094\" ]\n    topic = \"my-topic\"\n    api_key = \"xxxxxxxxxxxxxx\"\n    service_to_service_enabled = false\n  }\n  region = var.atracker_target_region\n}\n\nresource \"ibm_atracker_target\" atracker_target_cloudlogs_instance {\n  name = var.atracker_target_name\n  target_type = \"cloud_logs\"\n  cloudlogs_endpoint {\n    target_crn = \"crn:v1:bluemix:public:logs:eu-es:a/11111111111111111111111111111111:22222222-2222-2222-2222-222222222222::\"\n  }\n  region = var.atracker_target_region\n}\n\n// Provision atracker_route resource instance\nresource \"ibm_atracker_route\" \"atracker_route_instance\" {\n  name = var.atracker_route_name\n  rules {\n    target_ids = [ ibm_atracker_target.atracker_target_instance.id ]\n    locations = [ \"us-south\" ]\n  }\n}\n\n// Provision atracker_settings resource instance\nresource \"ibm_atracker_settings\" \"atracker_settings_instance\" {\n  default_targets = var.atracker_settings_default_targets\n  permitted_target_regions = var.atracker_settings_permitted_target_regions\n  metadata_region_primary = var.atracker_settings_metadata_region_primary\n  metadata_region_backup = var.atracker_settings_metadata_region_backup\n  private_api_endpoint_only = var.atracker_settings_private_api_endpoint_only\n}\n\n// Create atracker_targets data source\ndata \"ibm_atracker_targets\" \"atracker_targets_instance\" {\n  name = var.atracker_targets_name\n}\n\n// Create atracker_routes data source\ndata \"ibm_atracker_routes\" \"atracker_routes_instance\" {\n  name = var.atracker_routes_name\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/IBM-Cloud__terraform-provider-ibm__examples__ibm-atracker__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_sns_topic\" \"ecs_events\" {\n  name = \"ecs_events_${var.environment}_${var.cluster}\"\n}\n\ndata \"aws_caller_identity\" \"current\" {}\n\ndata \"aws_region\" \"current\" {\n  current = true\n}\n\ndata \"template_file\" \"ecs_task_stopped\" {\n  template = <<EOF\n{\n  \"source\": [\"aws.ecs\"],\n  \"detail-type\": [\"ECS Task State Change\"],\n  \"detail\": {\n    \"clusterArn\": [\"arn:aws:ecs:$${aws_region}:$${account_id}:cluster/$${cluster}\"],\n    \"lastStatus\": [\"STOPPED\"],\n    \"stoppedReason\": [\"Essential container in task exited\"]\n  }\n}\nEOF\n\n  vars {\n    account_id = data.aws_caller_identity.current.account_id\n    cluster    = var.cluster\n    aws_region = data.aws_region.current.name\n  }\n}\n\nresource \"aws_cloudwatch_event_rule\" \"ecs_task_stopped\" {\n  name          = \"${var.environment}_${var.cluster}_task_stopped\"\n  description   = \"${var.environment}_${var.cluster} Essential container in task exited\"\n  event_pattern = data.template_file.ecs_task_stopped.rendered\n}\n\nresource \"aws_cloudwatch_event_target\" \"event_fired\" {\n  rule  = aws_cloudwatch_event_rule.ecs_task_stopped.name\n  arn   = aws_sns_topic.ecs_events.arn\n  input = \"{ \\\"message\\\": \\\"Essential container in task exited\\\", \\\"account_id\\\": \\\"${data.aws_caller_identity.current.account_id}\\\", \\\"cluster\\\": \\\"${var.cluster}\\\"}\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/arminc__terraform-ecs__modules__ecs_events__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_26", "severity": "HIGH", "message": "Ensure all data stored in the SNS topic is encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/arminc__terraform-ecs__modules__ecs_events__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nterraform {\n  required_providers {\n    random = {\n      source = \"hashicorp/random\"\n      version = \"3.3.2\"\n    }\n  }\n}\n\nvariable \"prefix\" {\n  type = string\n}\n\nresource \"random_pet\" \"this\" {\n  prefix = var.prefix\n  length = 3\n}\n\noutput \"name\" {\n  value = random_pet.this.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__go-tfe__test-fixtures__stack-source__pet__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright 2016-2021 Copado NCS LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\nterraform {\n  required_version = \">= 0.13.0, < 2.0.0\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/newcontext-oss__kitchen-terraform__test__terraform__attributes__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = local.region\n}\n\ndata \"aws_availability_zones\" \"available\" {}\n\nlocals {\n  region = \"eu-west-1\"\n  name   = \"ex-${basename(path.cwd)}\"\n\n  vpc_cidr = \"10.0.0.0/16\"\n  azs      = slice(data.aws_availability_zones.available.names, 0, 3)\n\n  tags = {\n    Name       = local.name\n    Example    = local.name\n    Repository = \"https://github.com/terraform-aws-modules/terraform-aws-alb\"\n  }\n}\n\n##################################################################\n# Network Load Balancer\n##################################################################\n\nmodule \"nlb\" {\n  source = \"../../\"\n\n  name = local.name\n\n  load_balancer_type               = \"network\"\n  vpc_id                           = module.vpc.vpc_id\n  dns_record_client_routing_policy = \"availability_zone_affinity\"\n\n  # https://github.com/hashicorp/terraform-provider-aws/issues/17281\n  # subnets = module.vpc.private_subnets\n\n  # Use `subnet_mapping` to attach EIPs\n  subnet_mapping = [for i, eip in aws_eip.this :\n    {\n      allocation_id = eip.id\n      subnet_id     = module.vpc.private_subnets[i]\n    }\n  ]\n\n  # For example only\n  enable_deletion_protection = false\n\n  # Security Group\n  enforce_security_group_inbound_rules_on_private_link_traffic = \"off\"\n  security_group_ingress_rules = {\n    all_tcp = {\n      from_port   = 80\n      to_port     = 84\n      ip_protocol = \"tcp\"\n      description = \"TCP traffic\"\n      cidr_ipv4   = \"0.0.0.0/0\"\n    }\n    all_udp = {\n      from_port   = 80\n      to_port     = 84\n      ip_protocol = \"udp\"\n      description = \"UDP traffic\"\n      cidr_ipv4   = \"0.0.0.0/0\"\n    }\n  }\n  security_group_egress_rules = {\n    all = {\n      ip_protocol = \"-1\"\n      cidr_ipv4   = module.vpc.vpc_cidr_block\n    }\n  }\n\n  access_logs = {\n    bucket = module.log_bucket.s3_bucket_id\n  }\n\n  listeners = {\n    ex-one = {\n      port     = 81\n      protocol = \"TCP_UDP\"\n      forward = {\n        target_group_key = \"ex-target-one\"\n      }\n    }\n\n    ex-two = {\n      port     = 82\n      protocol = \"UDP\"\n      forward = {\n        target_group_key = \"ex-target-two\"\n      }\n    }\n\n    ex-three = {\n      port                     = 83\n      protocol                 = \"TCP\"\n      tcp_idle_timeout_seconds = 60\n      forward = {\n        target_group_key = \"ex-target-three\"\n      }\n    }\n\n    ex-four = {\n      port            = 84\n      protocol        = \"TLS\"\n      certificate_arn = module.acm.acm_certificate_arn\n      forward = {\n        target_group_key = \"ex-target-four\"\n      }\n    }\n  }\n\n  target_groups = {\n    ex-target-one = {\n      name_prefix            = \"t1-\"\n      protocol               = \"TCP_UDP\"\n      port                   = 81\n      target_type            = \"instance\"\n      target_id              = aws_instance.this.id\n      connection_termination = true\n      preserve_client_ip     = true\n\n      stickiness = {\n        type = \"source_ip\"\n      }\n\n      tags = {\n        tcp_udp = true\n      }\n    }\n\n    ex-target-two = {\n      name_prefix = \"t2-\"\n      protocol    = \"UDP\"\n      port        = 82\n      target_type = \"instance\"\n      target_id   = aws_instance.this.id\n    }\n\n    ex-target-three = {\n      name_prefix          = \"t3-\"\n      protocol             = \"TCP\"\n      port                 = 83\n      target_type          = \"ip\"\n      target_id            = aws_instance.this.private_ip\n      deregistration_delay = 10\n      health_check = {\n        enabled             = true\n        interval            = 30\n        path                = \"/healthz\"\n        port                = \"traffic-port\"\n        healthy_threshold   = 3\n        unhealthy_threshold = 3\n        timeout             = 6\n      }\n    }\n\n    ex-target-four = {\n      name_prefix = \"t4-\"\n      protocol    = \"TLS\"\n      port        = 84\n      target_type = \"instance\"\n      target_id   = aws_instance.this.id\n      target_health_state = {\n        enable_unhealthy_connection_termination = false\n        unhealthy_draining_interval             = 600\n      }\n    }\n  }\n\n  tags = local.tags\n}\n\n################################################################################\n# Supporting resources\n################################################################################\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"~> 6.0\"\n\n  name = local.name\n  cidr = local.vpc_cidr\n\n  azs             = local.azs\n  private_subnets = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 4, k)]\n  public_subnets  = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 8, k + 48)]\n\n  tags = local.tags\n}\n\ndata \"aws_route53_zone\" \"this\" {\n  name = var.domain_name\n}\n\nmodule \"acm\" {\n  source  = \"terraform-aws-modules/acm/aws\"\n  version = \"~> 5.0\"\n\n  domain_name       = var.domain_name\n  zone_id           = data.aws_route53_zone.this.id\n  validation_method = \"DNS\"\n\n  tags = local.tags\n}\n\nresource \"aws_eip\" \"this\" {\n  count = length(local.azs)\n\n  domain = \"vpc\"\n}\n\ndata \"aws_ssm_parameter\" \"al2023\" {\n  name = \"/aws/service/ami-amazon-linux-latest/al2023-ami-kernel-default-x86_64\"\n}\n\nresource \"aws_instance\" \"this\" {\n  ami           = data.aws_ssm_parameter.al2023.value\n  instance_type = \"t3.nano\"\n  subnet_id     = element(module.vpc.private_subnets, 0)\n}\n\nmodule \"log_bucket\" {\n  source  = \"terraform-aws-modules/s3-bucket/aws\"\n  version = \"~> 5.0\"\n\n  bucket_prefix = \"${local.name}-logs-\"\n  acl           = \"log-delivery-write\"\n\n  # For example only\n  force_destroy = true\n\n  control_object_ownership = true\n  object_ownership         = \"ObjectWriter\"\n\n  attach_elb_log_delivery_policy = true # Required for ALB logs\n  attach_lb_log_delivery_policy  = true # Required for ALB/NLB logs\n\n  attach_deny_insecure_transport_policy = true\n  attach_require_latest_tls_policy      = true\n\n  tags = local.tags\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__examples__complete-nlb__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__examples__complete-nlb__main.tf", "start_line": 178}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__examples__complete-nlb__main.tf", "start_line": 196}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__examples__complete-nlb__main.tf", "start_line": 223}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__examples__complete-nlb__main.tf", "start_line": 217}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__examples__complete-nlb__main.tf", "start_line": 217}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__examples__complete-nlb__main.tf", "start_line": 217}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__examples__complete-nlb__main.tf", "start_line": 217}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__examples__complete-nlb__main.tf", "start_line": 217}, {"tool": "checkov", "rule_id": "CKV2_AWS_19", "severity": "CRITICAL", "message": "Ensure that all EIP addresses allocated to a VPC are attached to EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__examples__complete-nlb__main.tf", "start_line": 207}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Access data about available availability zones in the current region\ndata \"aws_availability_zones\" \"this\" {}\n\n# Retrieve info about the VPC this host should join\n\ndata \"aws_vpc\" \"this\" {\n  default = \"${var.vpc_id == \"\" ? true : false}\"\n  id      = \"${var.vpc_id}\"\n}\n\ndata \"aws_subnet\" \"this\" {\n  vpc_id            = \"${data.aws_vpc.this.id}\"\n  availability_zone = \"${local.availability_zone}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/futurice__terraform-examples__aws__aws_ec2_ebs_docker_host__data.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#\n# iam roles\n#\nresource \"aws_iam_role\" \"demo-codebuild\" {\n  name = \"demo-codebuild\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"codebuild.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nEOF\n\n}\n\nresource \"aws_iam_role_policy\" \"demo-codebuild\" {\n  role = aws_iam_role.demo-codebuild.name\n\n  policy = <<POLICY\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ]\n    },\n    {\n      \"Sid\": \"CodeCommitPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codecommit:GitPull\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\"\n      ],\n      \"Resource\": [\n        \"${aws_s3_bucket.codebuild-cache.arn}\",\n        \"${aws_s3_bucket.codebuild-cache.arn}/*\"\n      ]\n    },\n    {\n      \"Effect\":\"Allow\",\n      \"Action\": [\n        \"s3:List*\",\n        \"s3:Put*\",\n        \"s3:Get*\"\n      ],\n      \"Resource\": [\n        \"${aws_s3_bucket.demo-artifacts.arn}\",\n        \"${aws_s3_bucket.demo-artifacts.arn}/*\"\n      ]\n    },\n    {\n      \"Sid\": \"ECRPushPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:BatchCheckLayerAvailability\",\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:GetRepositoryPolicy\",\n        \"ecr:DescribeRepositories\",\n        \"ecr:ListImages\",\n        \"ecr:DescribeImages\",\n        \"ecr:BatchGetImage\",\n        \"ecr:InitiateLayerUpload\",\n        \"ecr:UploadLayerPart\",\n        \"ecr:CompleteLayerUpload\",\n        \"ecr:PutImage\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"ECRAuthPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetAuthorizationToken\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }, \n    {\n      \"Sid\": \"ECS\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecs:List*\",\n        \"ecs:Describe*\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }, \n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n         \"kms:DescribeKey\",\n         \"kms:GenerateDataKey*\",\n         \"kms:Encrypt\",\n         \"kms:ReEncrypt*\",\n         \"kms:Decrypt\"\n        ],\n      \"Resource\": [\n         \"${aws_kms_key.demo-artifacts.arn}\"\n        ]\n    }\n  ]\n}\nPOLICY\n\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__iam-codebuild.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__iam-codebuild.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__iam-codebuild.tf", "start_line": 24}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"awscc_acmpca_certificate_authority\" \"example\" {\n  key_algorithm     = \"RSA_4096\"\n  signing_algorithm = \"SHA512WITHRSA\"\n  type              = \"ROOT\"\n  subject = {\n    common_name = \"example.com\"\n  }\n  usage_mode = \"GENERAL_PURPOSE\"\n  revocation_configuration = {\n    crl_configuration = {\n      custom_name        = \"crl.example.com\"\n      enabled            = true\n      expiration_in_days = 7\n      s3_bucket_name     = awscc_s3_bucket.example.id\n      s3_object_acl      = \"BUCKET_OWNER_FULL_CONTROL\"\n    }\n  }\n  depends_on = [awscc_s3_bucket_policy.example]\n}\n\nresource \"awscc_s3_bucket_policy\" \"example\" {\n  bucket = awscc_s3_bucket.example.id\n  policy_document = jsonencode({\n    Version = \"2012-10-17\",\n    Statement = [\n      {\n        Sid    = \"ACMPCA CRLs Access\",\n        Effect = \"Allow\",\n        Principal = {\n          Service = \"acm-pca.amazonaws.com\"\n        },\n        Action = [\n          \"s3:GetBucketAcl\",\n          \"s3:GetBucketLocation\",\n          \"s3:PutObject\",\n          \"s3:PutObjectAcl\"\n        ],\n        Resource = [\n          \"${awscc_s3_bucket.example.arn}\",\n          \"${awscc_s3_bucket.example.arn}/*\"\n        ]\n        Condition = {\n          StringEquals = {\n            \"aws:SourceAccount\" = data.aws_caller_identity.current.account_id\n          }\n        }\n      }\n    ]\n  })\n}\n\nresource \"awscc_s3_bucket\" \"example\" {\n  bucket_name = \"example-certificate-revocation-list\"\n}\n\ndata \"aws_caller_identity\" \"current\" {}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-awscc__examples__resources__awscc_acmpca_certificate_authority__revocation_list_certificate_authority.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"rules\" {\n  description = \"Map of known security group rules (define as 'name' = ['from port', 'to port', 'protocol', 'description'])\"\n  type        = map(list(any))\n\n  # Protocols (tcp, udp, icmp, all - are allowed keywords) or numbers (from https://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml):\n  # All = -1, IPV4-ICMP = 1, TCP = 6, UDP = 17, IPV6-ICMP = 58\n  default = {\n    # ActiveMQ\n    activemq-5671-tcp  = [5671, 5671, \"tcp\", \"ActiveMQ AMQP\"]\n    activemq-8883-tcp  = [8883, 8883, \"tcp\", \"ActiveMQ MQTT\"]\n    activemq-61614-tcp = [61614, 61614, \"tcp\", \"ActiveMQ STOMP\"]\n    activemq-61617-tcp = [61617, 61617, \"tcp\", \"ActiveMQ OpenWire\"]\n    activemq-61619-tcp = [61619, 61619, \"tcp\", \"ActiveMQ WebSocket\"]\n    # Alert Manager\n    alertmanager-9093-tcp = [9093, 9093, \"tcp\", \"Alert Manager\"]\n    alertmanager-9094-tcp = [9094, 9094, \"tcp\", \"Alert Manager Cluster\"]\n    # Carbon relay\n    carbon-line-in-tcp = [2003, 2003, \"tcp\", \"Carbon line-in\"]\n    carbon-line-in-udp = [2003, 2003, \"udp\", \"Carbon line-in\"]\n    carbon-pickle-tcp  = [2013, 2013, \"tcp\", \"Carbon pickle\"]\n    carbon-pickle-udp  = [2013, 2013, \"udp\", \"Carbon pickle\"]\n    carbon-admin-tcp   = [2004, 2004, \"tcp\", \"Carbon admin\"]\n    carbon-gui-udp     = [8081, 8081, \"tcp\", \"Carbon GUI\"]\n    # Cassandra\n    cassandra-clients-tcp        = [9042, 9042, \"tcp\", \"Cassandra clients\"]\n    cassandra-thrift-clients-tcp = [9160, 9160, \"tcp\", \"Cassandra Thrift clients\"]\n    cassandra-jmx-tcp            = [7199, 7199, \"tcp\", \"JMX\"]\n    # Consul\n    consul-tcp             = [8300, 8300, \"tcp\", \"Consul server\"]\n    consul-grpc-tcp        = [8502, 8502, \"tcp\", \"Consul gRPC\"]\n    consul-grpc-tcp-tls    = [8503, 8503, \"tcp\", \"Consul gRPC TLS\"]\n    consul-webui-http-tcp  = [8500, 8500, \"tcp\", \"Consul web UI HTTP\"]\n    consul-webui-https-tcp = [8501, 8501, \"tcp\", \"Consul web UI HTTPS\"]\n    consul-dns-tcp         = [8600, 8600, \"tcp\", \"Consul DNS\"]\n    consul-dns-udp         = [8600, 8600, \"udp\", \"Consul DNS\"]\n    consul-serf-lan-tcp    = [8301, 8301, \"tcp\", \"Serf LAN\"]\n    consul-serf-lan-udp    = [8301, 8301, \"udp\", \"Serf LAN\"]\n    consul-serf-wan-tcp    = [8302, 8302, \"tcp\", \"Serf WAN\"]\n    consul-serf-wan-udp    = [8302, 8302, \"udp\", \"Serf WAN\"]\n    # DAX Cluster\n    dax-cluster-unencrypted-tcp = [8111, 8111, \"tcp\", \"DAX Cluster unencrypted\"]\n    dax-cluster-encrypted-tcp   = [9111, 9111, \"tcp\", \"DAX Cluster encrypted\"]\n    # Docker Swarm\n    docker-swarm-mngmt-tcp   = [2377, 2377, \"tcp\", \"Docker Swarm cluster management\"]\n    docker-swarm-node-tcp    = [7946, 7946, \"tcp\", \"Docker Swarm node\"]\n    docker-swarm-node-udp    = [7946, 7946, \"udp\", \"Docker Swarm node\"]\n    docker-swarm-overlay-udp = [4789, 4789, \"udp\", \"Docker Swarm Overlay Network Traffic\"]\n    # DNS\n    dns-udp = [53, 53, \"udp\", \"DNS\"]\n    dns-tcp = [53, 53, \"tcp\", \"DNS\"]\n    # Etcd\n    etcd-client-tcp = [2379, 2379, \"tcp\", \"Etcd Client\"]\n    etcd-peer-tcp   = [2380, 2380, \"tcp\", \"Etcd Peer\"]\n    # NTP - Network Time Protocol\n    ntp-udp = [123, 123, \"udp\", \"NTP\"]\n    # Elasticsearch\n    elasticsearch-rest-tcp = [9200, 9200, \"tcp\", \"Elasticsearch REST interface\"]\n    elasticsearch-java-tcp = [9300, 9300, \"tcp\", \"Elasticsearch Java interface\"]\n    # Grafana\n    grafana-tcp = [3000, 3000, \"tcp\", \"Grafana Dashboard\"]\n    # Graphite Statsd\n    graphite-webui    = [80, 80, \"tcp\", \"Graphite admin interface\"]\n    graphite-2003-tcp = [2003, 2003, \"tcp\", \"Carbon receiver plain text\"]\n    graphite-2004-tcp = [2004, 2004, \"tcp\", \"Carbon receiver pickle\"]\n    graphite-2023-tcp = [2023, 2023, \"tcp\", \"Carbon aggregator plaintext\"]\n    graphite-2024-tcp = [2024, 2024, \"tcp\", \"Carbon aggregator pickle\"]\n    graphite-8080-tcp = [8080, 8080, \"tcp\", \"Graphite gunicorn port\"]\n    graphite-8125-tcp = [8125, 8125, \"tcp\", \"Statsd TCP\"]\n    graphite-8125-udp = [8125, 8125, \"udp\", \"Statsd UDP default\"]\n    graphite-8126-tcp = [8126, 8126, \"tcp\", \"Statsd admin\"]\n    # HTTP\n    http-80-tcp   = [80, 80, \"tcp\", \"HTTP\"]\n    http-8080-tcp = [8080, 8080, \"tcp\", \"HTTP\"]\n    # HTTPS\n    https-443-tcp  = [443, 443, \"tcp\", \"HTTPS\"]\n    https-8443-tcp = [8443, 8443, \"tcp\", \"HTTPS\"]\n    # IPSEC\n    ipsec-500-udp  = [500, 500, \"udp\", \"IPSEC ISAKMP\"]\n    ipsec-4500-udp = [4500, 4500, \"udp\", \"IPSEC NAT-T\"]\n    # Kafka\n    kafka-broker-tcp                   = [9092, 9092, \"tcp\", \"Kafka PLAINTEXT enable broker 0.8.2+\"]\n    kafka-broker-tls-tcp               = [9094, 9094, \"tcp\", \"Kafka TLS enabled broker 0.8.2+\"]\n    kafka-broker-tls-public-tcp        = [9194, 9194, \"tcp\", \"Kafka TLS Public enabled broker 0.8.2+ (MSK specific)\"]\n    kafka-broker-sasl-scram-tcp        = [9096, 9096, \"tcp\", \"Kafka SASL/SCRAM enabled broker (MSK specific)\"]\n    kafka-broker-sasl-scram-public-tcp = [9196, 9196, \"tcp\", \"Kafka SASL/SCRAM Public enabled broker (MSK specific)\"]\n    kafka-broker-sasl-iam-tcp          = [9098, 9098, \"tcp\", \"Kafka SASL/IAM access control enabled (MSK specific)\"]\n    kafka-broker-sasl-iam-public-tcp   = [9198, 9198, \"tcp\", \"Kafka SASL/IAM Public access control enabled (MSK specific)\"]\n    kafka-jmx-exporter-tcp             = [11001, 11001, \"tcp\", \"Kafka JMX Exporter\"]\n    kafka-node-exporter-tcp            = [11002, 11002, \"tcp\", \"Kafka Node Exporter\"]\n    # Kibana\n    kibana-tcp = [5601, 5601, \"tcp\", \"Kibana Web Interface\"]\n    # Kubernetes\n    kubernetes-api-tcp = [6443, 6443, \"tcp\", \"Kubernetes API Server\"]\n    # LDAP\n    ldap-tcp = [389, 389, \"tcp\", \"LDAP\"]\n    # LDAPS\n    ldaps-tcp = [636, 636, \"tcp\", \"LDAPS\"]\n    # Logstash\n    logstash-tcp = [5044, 5044, \"tcp\", \"Logstash\"]\n    # Loki\n    loki-grafana      = [3100, 3100, \"tcp\", \"Grafana Loki endpoint\"]\n    loki-grafana-grpc = [9095, 9095, \"tcp\", \"Grafana Loki GRPC\"]\n    # Memcached\n    memcached-tcp = [11211, 11211, \"tcp\", \"Memcached\"]\n    # MinIO\n    minio-tcp = [9000, 9000, \"tcp\", \"MinIO\"]\n    # MongoDB\n    mongodb-27017-tcp = [27017, 27017, \"tcp\", \"MongoDB\"]\n    mongodb-27018-tcp = [27018, 27018, \"tcp\", \"MongoDB shard\"]\n    mongodb-27019-tcp = [27019, 27019, \"tcp\", \"MongoDB config server\"]\n    # MySQL\n    mysql-tcp = [3306, 3306, \"tcp\", \"MySQL/Aurora\"]\n    # MSSQL Server\n    mssql-tcp           = [1433, 1433, \"tcp\", \"MSSQL Server\"]\n    mssql-udp           = [1434, 1434, \"udp\", \"MSSQL Browser\"]\n    mssql-analytics-tcp = [2383, 2383, \"tcp\", \"MSSQL Analytics\"]\n    mssql-broker-tcp    = [4022, 4022, \"tcp\", \"MSSQL Broker\"]\n    # NFS/EFS\n    nfs-tcp = [2049, 2049, \"tcp\", \"NFS/EFS\"]\n    # Nomad\n    nomad-http-tcp = [4646, 4646, \"tcp\", \"Nomad HTTP\"]\n    nomad-rpc-tcp  = [4647, 4647, \"tcp\", \"Nomad RPC\"]\n    nomad-serf-tcp = [4648, 4648, \"tcp\", \"Serf\"]\n    nomad-serf-udp = [4648, 4648, \"udp\", \"Serf\"]\n    # OpenVPN\n    openvpn-udp       = [1194, 1194, \"udp\", \"OpenVPN\"]\n    openvpn-tcp       = [943, 943, \"tcp\", \"OpenVPN\"]\n    openvpn-https-tcp = [443, 443, \"tcp\", \"OpenVPN\"]\n    # PostgreSQL\n    postgresql-tcp = [5432, 5432, \"tcp\", \"PostgreSQL\"]\n    # Puppet\n    puppet-tcp   = [8140, 8140, \"tcp\", \"Puppet\"]\n    puppetdb-tcp = [8081, 8081, \"tcp\", \"PuppetDB\"]\n    # Prometheus\n    prometheus-http-tcp               = [9090, 9090, \"tcp\", \"Prometheus\"]\n    prometheus-pushgateway-http-tcp   = [9091, 9091, \"tcp\", \"Prometheus Pushgateway\"]\n    prometheus-node-exporter-http-tcp = [9100, 9100, \"tcp\", \"Prometheus Node Exporter\"]\n    # Promtail\n    promtail-http = [9080, 9080, \"tcp\", \"Promtail endpoint\"]\n    # Oracle Database\n    oracle-db-tcp = [1521, 1521, \"tcp\", \"Oracle\"]\n    # Octopus Tentacles\n    octopus-tentacle-tcp = [10933, 10933, \"tcp\", \"Octopus Tentacle\"]\n    # RabbitMQ\n    rabbitmq-4369-tcp  = [4369, 4369, \"tcp\", \"RabbitMQ epmd\"]\n    rabbitmq-5671-tcp  = [5671, 5671, \"tcp\", \"RabbitMQ\"]\n    rabbitmq-5672-tcp  = [5672, 5672, \"tcp\", \"RabbitMQ\"]\n    rabbitmq-15672-tcp = [15672, 15672, \"tcp\", \"RabbitMQ\"]\n    rabbitmq-25672-tcp = [25672, 25672, \"tcp\", \"RabbitMQ\"]\n    # RDP\n    rdp-tcp = [3389, 3389, \"tcp\", \"Remote Desktop\"]\n    rdp-udp = [3389, 3389, \"udp\", \"Remote Desktop\"]\n    # Redis\n    redis-tcp = [6379, 6379, \"tcp\", \"Redis\"]\n    # Redshift\n    redshift-tcp = [5439, 5439, \"tcp\", \"Redshift\"]\n    # SaltStack\n    saltstack-tcp = [4505, 4506, \"tcp\", \"SaltStack\"]\n    # SMTP\n    smtp-tcp                 = [25, 25, \"tcp\", \"SMTP\"]\n    smtp-submission-587-tcp  = [587, 587, \"tcp\", \"SMTP Submission\"]\n    smtp-submission-2587-tcp = [2587, 2587, \"tcp\", \"SMTP Submission\"]\n    smtps-465-tcp            = [465, 465, \"tcp\", \"SMTPS\"]\n    smtps-2456-tcp           = [2465, 2465, \"tcp\", \"SMTPS\"]\n    # Solr\n    solr-tcp = [8983, 8987, \"tcp\", \"Solr\"]\n    # Splunk\n    splunk-indexer-tcp = [9997, 9997, \"tcp\", \"Splunk indexer\"]\n    splunk-web-tcp     = [8000, 8000, \"tcp\", \"Splunk Web\"]\n    splunk-splunkd-tcp = [8089, 8089, \"tcp\", \"Splunkd\"]\n    splunk-hec-tcp     = [8088, 8088, \"tcp\", \"Splunk HEC\"]\n    # Squid\n    squid-proxy-tcp = [3128, 3128, \"tcp\", \"Squid default proxy\"]\n    # SSH\n    ssh-tcp = [22, 22, \"tcp\", \"SSH\"]\n    # Storm\n    storm-nimbus-tcp     = [6627, 6627, \"tcp\", \"Nimbus\"]\n    storm-ui-tcp         = [8080, 8080, \"tcp\", \"Storm UI\"]\n    storm-supervisor-tcp = [6700, 6703, \"tcp\", \"Supervisor\"]\n    # Vault\n    vault-tcp = [8200, 8200, \"tcp\", \"Vault\"]\n    # Wazuh\n    wazuh-server-agent-connection-tcp = [1514, 1514, \"tcp\", \"Agent connection service(TCP)\"]\n    wazuh-server-agent-connection-udp = [1514, 1514, \"udp\", \"Agent connection service(UDP)\"]\n    wazuh-server-agent-enrollment     = [1515, 1515, \"tcp\", \"Agent enrollment service\"]\n    wazuh-server-agent-cluster-daemon = [1516, 1516, \"tcp\", \"Wazuh cluster daemon\"]\n    wazuh-server-syslog-collector-tcp = [514, 514, \"tcp\", \"Wazuh Syslog collector(TCP)\"]\n    wazuh-server-syslog-collector-udp = [514, 514, \"udp\", \"Wazuh Syslog collector(UDP)\"]\n    wazuh-server-restful-api          = [55000, 55000, \"tcp\", \"Wazuh server RESTful API\"]\n    wazuh-indexer-restful-api         = [9200, 9200, \"tcp\", \"Wazuh indexer RESTful API\"]\n    wazuh-dashboard                   = [443, 443, \"tcp\", \"Wazuh web user interface\"]\n    # Web\n    web-jmx-tcp = [1099, 1099, \"tcp\", \"JMX\"]\n    # WinRM\n    winrm-http-tcp  = [5985, 5985, \"tcp\", \"WinRM HTTP\"]\n    winrm-https-tcp = [5986, 5986, \"tcp\", \"WinRM HTTPS\"]\n    # Zabbix\n    zabbix-server = [10051, 10051, \"tcp\", \"Zabbix Server\"]\n    zabbix-proxy  = [10051, 10051, \"tcp\", \"Zabbix Proxy\"]\n    zabbix-agent  = [10050, 10050, \"tcp\", \"Zabbix Agent\"]\n    # Zipkin\n    zipkin-admin-tcp       = [9990, 9990, \"tcp\", \"Zipkin Admin port collector\"]\n    zipkin-admin-query-tcp = [9901, 9901, \"tcp\", \"Zipkin Admin port query\"]\n    zipkin-admin-web-tcp   = [9991, 9991, \"tcp\", \"Zipkin Admin port web\"]\n    zipkin-query-tcp       = [9411, 9411, \"tcp\", \"Zipkin query port\"]\n    zipkin-web-tcp         = [8080, 8080, \"tcp\", \"Zipkin web port\"]\n    # Zookeeper\n    zookeeper-2181-tcp     = [2181, 2181, \"tcp\", \"Zookeeper\"]\n    zookeeper-2182-tls-tcp = [2182, 2182, \"tcp\", \"Zookeeper TLS (MSK specific)\"]\n    zookeeper-2888-tcp     = [2888, 2888, \"tcp\", \"Zookeeper\"]\n    zookeeper-3888-tcp     = [3888, 3888, \"tcp\", \"Zookeeper\"]\n    zookeeper-jmx-tcp      = [7199, 7199, \"tcp\", \"JMX\"]\n    # Open all ports & protocols\n    all-all       = [-1, -1, \"-1\", \"All protocols\"]\n    all-tcp       = [0, 65535, \"tcp\", \"All TCP ports\"]\n    all-udp       = [0, 65535, \"udp\", \"All UDP ports\"]\n    all-icmp      = [-1, -1, \"icmp\", \"All IPV4 ICMP\"]\n    all-ipv6-icmp = [-1, -1, 58, \"All IPV6 ICMP\"]\n    # This is a fallback rule to pass to lookup() as default. It does not open anything, because it should never be used.\n    _ = [\"\", \"\", \"\"]\n  }\n}\n\nvariable \"auto_groups\" {\n  description = \"Map of groups of security group rules to use to generate modules (see update_groups.sh)\"\n  type        = map(map(list(string)))\n\n  # Valid keys - ingress_rules, egress_rules, ingress_with_self, egress_with_self\n  default = {\n    activemq = {\n      ingress_rules     = [\"activemq-5671-tcp\", \"activemq-8883-tcp\", \"activemq-61614-tcp\", \"activemq-61617-tcp\", \"activemq-61619-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    alertmanager = {\n      ingress_rules     = [\"alertmanager-9093-tcp\", \"alertmanager-9094-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    carbon-relay-ng = {\n      ingress_rules     = [\"carbon-line-in-tcp\", \"carbon-line-in-udp\", \"carbon-pickle-tcp\", \"carbon-pickle-udp\", \"carbon-gui-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    cassandra = {\n      ingress_rules     = [\"cassandra-clients-tcp\", \"cassandra-thrift-clients-tcp\", \"cassandra-jmx-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    consul = {\n      ingress_rules     = [\"consul-tcp\", \"consul-grpc-tcp\", \"consul-grpc-tcp-tls\", \"consul-webui-http-tcp\", \"consul-webui-https-tcp\", \"consul-dns-tcp\", \"consul-dns-udp\", \"consul-serf-lan-tcp\", \"consul-serf-lan-udp\", \"consul-serf-wan-tcp\", \"consul-serf-wan-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    dax-cluster = {\n      ingress_rules     = [\"dax-cluster-unencrypted-tcp\", \"dax-cluster-encrypted-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    docker-swarm = {\n      ingress_rules     = [\"docker-swarm-mngmt-tcp\", \"docker-swarm-node-tcp\", \"docker-swarm-node-udp\", \"docker-swarm-overlay-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    etcd = {\n      ingress_rules     = [\"etcd-client-tcp\", \"etcd-peer-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    elasticsearch = {\n      ingress_rules     = [\"elasticsearch-rest-tcp\", \"elasticsearch-java-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    grafana = {\n      ingress_rules     = [\"grafana-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    graphite-statsd = {\n      ingress_rules     = [\"graphite-webui\", \"graphite-2003-tcp\", \"graphite-2004-tcp\", \"graphite-2023-tcp\", \"graphite-2024-tcp\", \"graphite-8080-tcp\", \"graphite-8125-tcp\", \"graphite-8125-udp\", \"graphite-8126-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    http-80 = {\n      ingress_rules     = [\"http-80-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    http-8080 = {\n      ingress_rules     = [\"http-8080-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    https-443 = {\n      ingress_rules     = [\"https-443-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    https-8443 = {\n      ingress_rules     = [\"https-8443-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ipsec-500 = {\n      ingress_rules     = [\"ipsec-500-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ipsec-4500 = {\n      ingress_rules     = [\"ipsec-4500-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    kafka = {\n      ingress_rules     = [\"kafka-broker-tcp\", \"kafka-broker-tls-tcp\", \"kafka-broker-tls-public-tcp\", \"kafka-broker-sasl-scram-tcp\", \"kafka-broker-sasl-scram-tcp\", \"kafka-broker-sasl-iam-tcp\", \"kafka-broker-sasl-iam-public-tcp\", \"kafka-jmx-exporter-tcp\", \"kafka-node-exporter-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    kubernetes-api = {\n      ingress_rules     = [\"kubernetes-api-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    kibana = {\n      ingress_rules     = [\"kibana-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ldap = {\n      ingress_rules     = [\"ldap-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ldaps = {\n      ingress_rules     = [\"ldaps-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    logstash = {\n      ingress_rules     = [\"logstash-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    loki = {\n      ingress_rules     = [\"loki-grafana\", \"loki-grafana-grpc\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    memcached = {\n      ingress_rules     = [\"memcached-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    minio = {\n      ingress_rules     = [\"minio-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    mongodb = {\n      ingress_rules     = [\"mongodb-27017-tcp\", \"mongodb-27018-tcp\", \"mongodb-27019-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    mysql = {\n      ingress_rules     = [\"mysql-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    mssql = {\n      ingress_rules     = [\"mssql-tcp\", \"mssql-udp\", \"mssql-analytics-tcp\", \"mssql-broker-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    nfs = {\n      ingress_rules     = [\"nfs-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    nomad = {\n      ingress_rules     = [\"nomad-http-tcp\", \"nomad-rpc-tcp\", \"nomad-serf-tcp\", \"nomad-serf-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    openvpn = {\n      ingress_rules     = [\"openvpn-udp\", \"openvpn-tcp\", \"openvpn-https-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    postgresql = {\n      ingress_rules     = [\"postgresql-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    oracle-db = {\n      ingress_rules     = [\"oracle-db-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ntp = {\n      ingress_rules     = [\"ntp-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    puppet = {\n      ingress_rules     = [\"puppet-tcp\", \"puppetdb-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    prometheus = {\n      ingress_rules     = [\"prometheus-http-tcp\", \"prometheus-pushgateway-http-tcp\", \"prometheus-node-exporter-http-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    promtail = {\n      ingress_rules     = [\"promtail-http\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    rabbitmq = {\n      ingress_rules     = [\"rabbitmq-4369-tcp\", \"rabbitmq-5671-tcp\", \"rabbitmq-5672-tcp\", \"rabbitmq-15672-tcp\", \"rabbitmq-25672-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    rdp = {\n      ingress_rules     = [\"rdp-tcp\", \"rdp-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    redis = {\n      ingress_rules     = [\"redis-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    redshift = {\n      ingress_rules     = [\"redshift-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    smtp = {\n      ingress_rules     = [\"smtp-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    smtp-submission = {\n      ingress_rules     = [\"smtp-submission-587-tcp\", \"smtp-submission-2587-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    smtps = {\n      ingress_rules     = [\"smtps-465-tcp\", \"smtps-2465-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    solr = {\n      ingress_rules     = [\"solr-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    splunk = {\n      ingress_rules     = [\"splunk-indexer-tcp\", \"splunk-web-tcp\", \"splunk-splunkd-tcp\", \"splunk-hec-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    squid = {\n      ingress_rules     = [\"squid-proxy-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ssh = {\n      ingress_rules     = [\"ssh-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    storm = {\n      ingress_rules     = [\"storm-nimbus-tcp\", \"storm-ui-tcp\", \"storm-supervisor-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    vault = {\n      ingress_rules     = [\"vault-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    wazuh = {\n      ingress_rules     = [\"wazuh-server-agent-connection-tcp\", \"wazuh-server-agent-connection-udp\", \"wazuh-server-agent-enrollment\", \"wazuh-server-agent-cluster-daemon\", \"wazuh-server-syslog-collector-tcp\", \"wazuh-server-syslog-collector-udp\", \"wazuh-server-restful-api\", \"wazuh-indexer-restful-api\", \"wazuh-dashboard\", ]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    web = {\n      ingress_rules     = [\"http-80-tcp\", \"http-8080-tcp\", \"https-443-tcp\", \"web-jmx-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    winrm = {\n      ingress_rules     = [\"winrm-http-tcp\", \"winrm-https-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    zabbix = {\n      ingress_rules     = [\"zabbix-server\", \"zabbix-proxy\", \"zabbix-agent\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    zipkin = {\n      ingress_rules     = [\"zipkin-admin-tcp\", \"zipkin-admin-query-tcp\", \"zipkin-admin-web-tcp\", \"zipkin-query-tcp\", \"zipkin-web-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    zookeeper = {\n      ingress_rules     = [\"zookeeper-2181-tcp\", \"zookeeper-2182-tls-tcp\", \"zookeeper-2888-tcp\", \"zookeeper-3888-tcp\", \"zookeeper-jmx-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-security-group__rules.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"netbox_cluster\" \"vmw_cluster_01\" {\n  name = \"vmw-cluster-01\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/e-breuninger__terraform-provider-netbox__examples__data-sources__netbox_cluster__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  # component kubeconfigs assets map\n  auth_kubeconfigs = {\n    \"auth/admin.conf\"              = local.kubeconfig-admin,\n    \"auth/controller-manager.conf\" = local.kubeconfig-controller-manager\n    \"auth/scheduler.conf\"          = local.kubeconfig-scheduler\n  }\n}\n\nlocals {\n  # Generated admin kubeconfig to bootstrap control plane\n  kubeconfig-admin = templatefile(\"${path.module}/resources/kubeconfig-admin\",\n    {\n      name         = var.cluster_name\n      ca_cert      = base64encode(tls_self_signed_cert.kube-ca.cert_pem)\n      kubelet_cert = base64encode(tls_locally_signed_cert.admin.cert_pem)\n      kubelet_key  = base64encode(tls_private_key.admin.private_key_pem)\n      server       = format(\"https://%s:%s\", var.api_servers[0], var.external_apiserver_port)\n    }\n  )\n\n  # Generated kube-controller-manager kubeconfig\n  kubeconfig-controller-manager = templatefile(\"${path.module}/resources/kubeconfig-admin\",\n    {\n      name         = var.cluster_name\n      ca_cert      = base64encode(tls_self_signed_cert.kube-ca.cert_pem)\n      kubelet_cert = base64encode(tls_locally_signed_cert.controller-manager.cert_pem)\n      kubelet_key  = base64encode(tls_private_key.controller-manager.private_key_pem)\n      server       = format(\"https://%s:%s\", var.api_servers[0], var.external_apiserver_port)\n    }\n  )\n\n  # Generated kube-controller-manager kubeconfig\n  kubeconfig-scheduler = templatefile(\"${path.module}/resources/kubeconfig-admin\",\n    {\n      name         = var.cluster_name\n      ca_cert      = base64encode(tls_self_signed_cert.kube-ca.cert_pem)\n      kubelet_cert = base64encode(tls_locally_signed_cert.scheduler.cert_pem)\n      kubelet_key  = base64encode(tls_private_key.scheduler.private_key_pem)\n      server       = format(\"https://%s:%s\", var.api_servers[0], var.external_apiserver_port)\n    }\n  )\n\n  # Generated kubeconfig to bootstrap Kubelets\n  kubeconfig-bootstrap = templatefile(\"${path.module}/resources/kubeconfig-bootstrap\",\n    {\n      ca_cert      = base64encode(tls_self_signed_cert.kube-ca.cert_pem)\n      server       = format(\"https://%s:%s\", var.api_servers[0], var.external_apiserver_port)\n      token_id     = random_password.bootstrap-token-id.result\n      token_secret = random_password.bootstrap-token-secret.result\n    }\n  )\n}\n\n# Generate a cryptographically random token id (public)\nresource \"random_password\" \"bootstrap-token-id\" {\n  length  = 6\n  upper   = false\n  special = false\n}\n\n# Generate a cryptographically random token secret\nresource \"random_password\" \"bootstrap-token-secret\" {\n  length  = 16\n  upper   = false\n  special = false\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__terraform-render-bootstrap__auth.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nterraform {\n  required_version = \"~> 1.0\"\n  required_providers {\n    azurerm = {\n      version = \"~> 3.18\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"3.5.1\"\n    }\n  }\n}\n\nprovider \"azurerm\" {\n  skip_provider_registration = true\n  features {}\n}\n\nresource \"azurerm_resource_group\" \"rg-app\" {\n  name     = \"${var.resource_group_name}-${var.environment}\"\n  location = var.location\n  tags = {\n    ENV = var.environment\n  }\n}\n\n\ndata \"terraform_remote_state\" \"service_plan_tfstate\" {\n  backend = \"azurerm\"\n  config = {\n    resource_group_name  = \"rg_tfstate\"\n    storage_account_name = \"storstate\"\n    container_name       = \"tfbackends\"\n    key                  = \"serviceplan.tfstate\"\n  }\n}\n\nresource \"azurerm_app_service\" \"app\" {\n  name                = \"${var.app_name}-${var.environment}\"\n  location            = azurerm_resource_group.rg-app.location\n  resource_group_name = azurerm_resource_group.rg-app.name\n  app_service_plan_id = data.terraform_remote_state.service_plan_tfstate.outputs.service_plan_id\n}\n\nresource \"azurerm_application_insights\" \"appinsight-app\" {\n  name                = \"${var.app_name}-${var.environment}\"\n  location            = azurerm_resource_group.rg-app.location\n  resource_group_name = azurerm_resource_group.rg-app.name\n  application_type    = \"web\"\n\n  tags = {\n    ENV       = var.environment\n    CreatedBy = var.createdby\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_13", "severity": "HIGH", "message": "Ensure App Service Authentication is set on Azure App Service", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AZURE_17", "severity": "HIGH", "message": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AZURE_65", "severity": "HIGH", "message": "Ensure that App service enables detailed error messages", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AZURE_66", "severity": "HIGH", "message": "Ensure that App service enables failed request tracing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AZURE_78", "severity": "HIGH", "message": "Ensure FTP deployments are disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AZURE_63", "severity": "HIGH", "message": "Ensure that App service enables HTTP logging", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AZURE_18", "severity": "HIGH", "message": "Ensure that 'HTTP Version' is the latest if used to run the web app", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AZURE_14", "severity": "HIGH", "message": "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AZURE_16", "severity": "HIGH", "message": "Ensure that Register with Azure Active Directory is enabled on App Service", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AZURE_71", "severity": "HIGH", "message": "Ensure that Managed identity provider is enabled for app services", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AZURE_213", "severity": "HIGH", "message": "Ensure that App Service configures health check", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AZURE_88", "severity": "HIGH", "message": "Ensure that app services use Azure Files", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__remote-state__main.tf", "start_line": 39}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"google\" {\n  project     = var.project_id\n  region      = var.region\n  zone        = var.zone\n}\nresource \"tls_private_key\" \"ssh_key\" {\n  algorithm = \"RSA\"\n  rsa_bits  = 4096\n}\n\nresource \"null_resource\" \"ssh_key\" {\n\n  provisioner \"local-exec\" {\n    command = \"echo '${tls_private_key.ssh_key.private_key_pem}' > /tmp/'${var.key_name}'.pem\"\n  }\n\n  provisioner \"local-exec\" {\n    command = \"chmod 400 /tmp/'${var.key_name}'.pem\"\n  }\n}\n\nresource \"google_compute_firewall\" \"terraguard\" {\n  name    = \"terraguard-firewall\"\n  network = var.vpc\n\n  allow {\n    protocol = \"icmp\"\n  }\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  allow {\n    protocol = \"udp\"\n    ports    = [\"41194\"]\n  }\n  target_tags = [\"terraguard\"]\n}\n\n\nresource \"google_compute_instance\" \"terraguard\" {\n  name         = \"terraguard\"\n  machine_type = \"f1-micro\"\n  can_ip_forward = true\n  tags = [\"terraguard\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"ubuntu-2004-lts\"\n    }\n  }\n\n  network_interface {\n    network = var.vpc\n    access_config {\n      // Ephemeral IP\n    }\n  }  \n  metadata = {\n    ssh-keys = \"terraguard:${tls_private_key.ssh_key.public_key_openssh}\"\n  }\n}\n\n\nresource \"local_file\" \"hosts_cfg\" {\n  content = templatefile(\"${path.module}/templates/hosts.tpl\",\n    {\n      wireguard = google_compute_instance.terraguard.network_interface.0.access_config.0.nat_ip\n      key       = var.key_name\n      mobile    = var.mobile ? true : \"False\"\n    }\n  )\n  filename = \"../ansible/hosts.cfg\"\n  depends_on = [\n    google_compute_instance.terraguard\n  ]\n}\n\nresource \"time_sleep\" \"wait_60_seconds\" {\n  depends_on      = [google_compute_instance.terraguard]\n  create_duration = \"60s\"\n}\n\nresource \"null_resource\" \"ansible\" {\n  provisioner \"local-exec\" {\n    command = \"ANSIBLE_HOST_KEY_CHECKING=False ansible-playbook -i ../ansible/hosts.cfg ../ansible/main.yml\"\n  }\n  depends_on = [\n    local_file.hosts_cfg,\n    time_sleep.wait_60_seconds\n  ]\n}\n\nresource \"null_resource\" \"mobile_qr\" {\n  count              = var.mobile ? 1 : 0\n  provisioner \"local-exec\" {\n    command = \"qrencode -t ansiutf8 < /tmp/terraguard-mobile.conf\"\n  }\n  depends_on = [\n    null_resource.ansible\n  ]\n}\n\noutput \"HELP\" {\n  value = \"To start VPN run: sudo systemctl start wg-quick@wg0\"\n}\n\noutput \"ExitIP\" {\n  value = google_compute_instance.terraguard.network_interface.0.access_config.0.nat_ip\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__GCP__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__GCP__main.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__GCP__main.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__GCP__main.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_GCP_36", "severity": "HIGH", "message": "Ensure that IP forwarding is not enabled on Instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__GCP__main.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__GCP__main.tf", "start_line": 43}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# First setup your authentication\n#  https://www.terraform.io/docs/providers/azurerm/index.html\n#  example: create sp with secret\n#   az ad sp create-for-rbac --role=\"Contributor\" --scopes=\"/subscriptions/SUBSCRIPTION_ID\"\n\n#{\n#  \"appId\": \"<Secret Stuff>\",         # client_id\n#  \"displayName\": \"azure-cli-2019-05-26-21-21-54\",\n#  \"name\": \"http://azure-cli-2019-05-26-21-21-54\",\n#  \"password\": \"<Secret Stuff>\",      # client_secret\n#  \"tenant\": \"<Secret Stuff>\"         # tenant_id\n#}\n\n# Set environement variable, used by terraform\n#$env:ARM_CLIENT_ID=\"<Secret Stuff>\"\n#$env:ARM_CLIENT_SECRET=\"<Secret Stuff>\"\n#$env:ARM_SUBSCRIPTION_ID=\"<Secret Stuff>\"\n#$env:ARM_TENANT_ID=\"<Secret Stuff>\"\n\n# VARIABLES\n#variable \"azure_access_key\" {}\n#variable \"azure_secret_key\" {}\n#variable \"private_key_path\" {}\n#variable \"key_name\" {\n#    default = \"pluralsight\"\n#}\n\n# PROVIDER\n# https://www.terraform.io/docs/providers/azurerm/index.html\n# Configure the Azure Provider\nprovider \"azurerm\" {}\n\n# RESOURCES\n# Create a resource group\nresource \"azurerm_resource_group\" \"demofx\" {\n  name     = \"demofx\"\n  location = \"westus2\"\n  tags = {\n    env   = \"demo\"\n    build = \"demo1\"\n  }\n}\n\n# create a virtual network in the RG\nresource \"azurerm_virtual_network\" \"demofx_network\" {\n  name                = \"demo01_network\"\n  address_space       = [\"10.0.0.0/16\"]\n  location            = azurerm_resource_group.demofx.location\n  resource_group_name = azurerm_resource_group.demofx.name\n\n  subnet {\n    name           = \"demo01_public_subnet\"\n    address_prefix = \"10.0.1.0/24\"\n  }\n\n  subnet {\n    name           = \"demo01_private_subnet\"\n    address_prefix = \"10.0.2.0/24\"\n  }\n  tags = {\n    env   = \"demo\"\n    build = \"demo1\"\n    gnia = \"demo1\"\n  }\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__101__101-001-rg_and_network_env_vars__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_ami\" \"rocky8\" {\n  # See http://cavaliercoder.com/blog/finding-the-latest-centos-ami.html\n  # https://wiki.centos.org/Cloud/AWS\n  most_recent = true\n\n  filter {\n    name   = \"name\"\n    values = [\"Rocky-8*\"]\n  }\n\n  filter {\n    name = \"architecture\"\n    values = [\"x86_64\"]\n  }\n\n  owners = [\"792107900819\"] #Owner ID as stated from https://forums.rockylinux.org/t/rocky-linux-official-aws-ami/3049/25\n}\n\nlocals {\n  mgmt_hostname = \"mgmt\"\n}\n\nresource \"tls_private_key\" \"provisioner_key\" {\n  algorithm   = \"RSA\"  # AWS only supports RSA, not ECDSA\n  rsa_bits = \"4096\"\n}\n\nresource \"aws_instance\" \"mgmt\" {\n  ami           = data.aws_ami.rocky8.id\n  instance_type = var.management_shape\n  vpc_security_group_ids = [aws_security_group.mgmt.id]\n  subnet_id = aws_subnet.vpc_subnetwork.id\n  associate_public_ip_address = true\n  iam_instance_profile = aws_iam_instance_profile.describe_tags.id\n\n  user_data = data.template_file.bootstrap-script.rendered\n  key_name = aws_key_pair.ec2-user.key_name\n\n  depends_on = [aws_efs_mount_target.shared, aws_key_pair.ec2-user, aws_route53_record.shared, aws_route.internet_route]\n\n  provisioner \"file\" {\n    destination = \"/tmp/startnode.yaml\"\n    content     = data.template_file.startnode-yaml.rendered\n\n    connection {\n      type        = \"ssh\"\n      user        = \"rocky\"\n      private_key = tls_private_key.provisioner_key.private_key_pem\n      host        = self.public_ip\n    }\n  }\n\n  provisioner \"file\" {\n    destination = \"/home/rocky/aws-credentials.csv\"\n    content     = <<EOF\n[default]\naws_access_key_id = ${aws_iam_access_key.mgmt_sa.id}\naws_secret_access_key = ${aws_iam_access_key.mgmt_sa.secret}\nEOF\n\n    connection {\n      type        = \"ssh\"\n      user        = \"rocky\"\n      private_key = tls_private_key.provisioner_key.private_key_pem\n      host        = self.public_ip\n    }\n  }\n\n  provisioner \"local-exec\" {\n    when = destroy\n    command = \"files/cleanup.sh\"\n    environment = {\n      CLUSTERID = self.tags.cluster\n    }\n    working_dir = path.module\n  }\n\n  tags = {\n    Name = local.mgmt_hostname\n    cluster = local.cluster_id\n  }\n}\n\nresource \"aws_key_pair\" \"ec2-user\" {\n  key_name   = \"ec2-user-${local.cluster_id}\"\n  public_key = tls_private_key.provisioner_key.public_key_openssh\n}\n\nresource \"aws_route53_record\" \"mgmt\" {\n  zone_id = aws_route53_zone.cluster.zone_id\n  name    = \"${local.mgmt_hostname}.${aws_route53_zone.cluster.name}\"\n  type    = \"A\"\n  ttl     = \"300\"\n  records = [aws_instance.mgmt.private_ip]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/clusterinthecloud__terraform__aws__compute.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/clusterinthecloud__terraform__aws__compute.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/clusterinthecloud__terraform__aws__compute.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/clusterinthecloud__terraform__aws__compute.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/clusterinthecloud__terraform__aws__compute.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/clusterinthecloud__terraform__aws__compute.tf", "start_line": 28}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"landing_zone_providers\" {\n  type        = map(map(string))\n  description = \"The list of AWS providers.\"\n}\n\nvariable \"landing_zone_components\" {\n  type        = map(string)\n  description = \"This is the list of AWS Landing Zone components that will be deployed if corresponding `.tfvars` file is included.\"\n}\n\nvariable \"terraform_backend\" {\n  type        = map(string)\n  description = \"This is the backend configure for all components.\"\n  default     = {\n    backend = \"local\"\n    path    = \"/tmp/.terrahub/landing_zone\"\n  }\n}\n\nvariable \"terraform_config\" {\n  type        = bool\n  default     = true\n  description = \"The command that will be generate the `terraform` config file.\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/MitocGroup__terraform-aws-landing-zone__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"ssh_public_key\" {}\nvariable \"domain\" {}\nvariable \"region\" {}\nvariable \"droplet_images\" { type = map }\nvariable \"droplet_sizes\" { type = map }\nvariable \"web_droplet_count\" {}\nvariable \"storage_size\" {}\nvariable \"env\" {}\nvariable \"project_envs\" { type = map }\nvariable \"deploy_key\" {}\nvariable \"web_deploy_tags\" { type = list }\nvariable \"storage_deploy_tags\" { type = list }\nvariable \"repo_url\" {}\nvariable \"allowed_ips\" { type = list }\n\nresource \"digitalocean_ssh_key\" \"ssh_key\" {\n  name       = var.domain\n  public_key = file(var.ssh_public_key)\n}\n\ndata \"local_file\" \"deploy_key\" {\n  filename = var.deploy_key\n}\n\ndata \"template_file\" \"web_user_data\" {\n  template = file(\"files/user-data.sh.txt\")\n  vars     = {\n    region      = var.region\n    domain      = var.domain\n    env         = var.env\n    deploy_key  = data.local_file.deploy_key.content\n    repo_url    = var.repo_url\n    tags        = join(\",\", var.web_deploy_tags)\n  }\n}\n\ndata \"template_file\" \"storage_user_data\" {\n  template = file(\"files/user-data.sh.txt\")\n  vars = {\n    region      = var.region\n    domain      = var.domain\n    env         = var.env\n    deploy_key  = data.local_file.deploy_key.content\n    repo_url    = var.repo_url\n    tags        = join(\",\", var.storage_deploy_tags)\n  }\n}\n\nresource \"digitalocean_project\" \"project\" {\n  name        = \"${var.region}-${var.env}-${replace(var.domain, \".\", \"-\")}\"\n  description = \"${var.region}-${var.env}-${replace(var.domain, \".\", \"-\")}\"\n  purpose     = \"Web Application\"\n  environment = var.project_envs[var.env]\n  resources   = concat([\n    digitalocean_domain.domain.urn,\n    digitalocean_spaces_bucket.bucket.urn,\n    digitalocean_droplet.storage_droplet.urn,\n    digitalocean_volume.storage_volume.urn,\n    digitalocean_loadbalancer.loadbalancer.urn\n  ], digitalocean_droplet.web_droplet.*.urn)\n}\n\nresource \"digitalocean_tag\" \"site_tag\" {\n  name = replace(var.domain, \".\", \"-\")\n}\n\nresource \"digitalocean_tag\" \"region_tag\" {\n  name = \"${var.region}-${replace(var.domain, \".\", \"-\")}\"\n}\n\nresource \"digitalocean_tag\" \"env_tag\" {\n  name = \"${var.env}-${replace(var.domain, \".\", \"-\")}\"\n}\n\nresource \"digitalocean_tag\" \"region_env_tag\" {\n  name = \"${var.region}-${var.env}-${replace(var.domain, \".\", \"-\")}\"\n}\n\nresource \"digitalocean_spaces_bucket\" \"bucket\" {\n  region        = var.region\n  name          = \"${var.region}-${var.env}-${replace(var.domain, \".\", \"-\")}\"\n  acl           = \"private\"\n  force_destroy = true\n}\n\nresource \"digitalocean_cdn\" \"cdn\" {\n  origin         = digitalocean_spaces_bucket.bucket.bucket_domain_name\n  custom_domain  = \"cdn-${var.region}-${var.env}.${var.domain}\"\n  certificate_name = digitalocean_certificate.certificate.name\n}\n\nresource \"digitalocean_volume\" \"storage_volume\" {\n  region                   = var.region\n  name                     = \"storage-${var.region}-${var.env}-${replace(var.domain, \".\", \"-\")}\"\n  size                     = var.storage_size\n  initial_filesystem_type  = \"ext4\"\n  initial_filesystem_label = \"s-${var.region}-${var.env}\"\n}\n\nresource \"digitalocean_volume_attachment\" \"storage_volume_attachment\" {\n  droplet_id = digitalocean_droplet.storage_droplet.id\n  volume_id  = digitalocean_volume.storage_volume.id\n}\n\nresource \"digitalocean_droplet\" \"storage_droplet\" {\n  image              = var.droplet_images[\"storage\"]\n  name               = \"storage-${var.region}-${var.env}.${var.domain}\"\n  region             = var.region\n  size               = var.droplet_sizes[\"storage\"]\n  ipv6               = true\n  private_networking = true\n  monitoring         = true\n  ssh_keys           = [digitalocean_ssh_key.ssh_key.fingerprint]\n  user_data          = data.template_file.storage_user_data.rendered\n  tags               = [\n    digitalocean_tag.site_tag.name,\n    digitalocean_tag.region_tag.name,\n    digitalocean_tag.env_tag.name,\n    digitalocean_tag.region_env_tag.name,\n    \"storage-${digitalocean_tag.site_tag.name}\",    \n    \"storage-${digitalocean_tag.region_tag.name}\",\n    \"storage-${digitalocean_tag.env_tag.name}\",\n    \"storage-${digitalocean_tag.region_env_tag.name}\",\n    \"database-${digitalocean_tag.site_tag.name}\",    \n    \"database-${digitalocean_tag.region_tag.name}\",\n    \"database-${digitalocean_tag.env_tag.name}\",\n    \"database-${digitalocean_tag.region_env_tag.name}\",\n    \"cache-${digitalocean_tag.site_tag.name}\",    \n    \"cache-${digitalocean_tag.region_tag.name}\",\n    \"cache-${digitalocean_tag.env_tag.name}\",\n    \"cache-${digitalocean_tag.region_env_tag.name}\"\n  ]\n}\n\nresource \"digitalocean_droplet\" \"web_droplet\" {\n  image              = var.droplet_images[\"web\"]\n  name               = \"web-${format(\"%02d\", count.index)}-${var.region}-${var.env}.${var.domain}\"\n  region             = var.region\n  size               = var.droplet_sizes[\"web\"]\n  ipv6               = true\n  private_networking = true\n  monitoring         = true\n  ssh_keys           = [digitalocean_ssh_key.ssh_key.fingerprint]\n  user_data          = data.template_file.web_user_data.rendered\n  tags               = [\n    digitalocean_tag.site_tag.name,\n    digitalocean_tag.region_tag.name,\n    digitalocean_tag.env_tag.name,\n    digitalocean_tag.region_env_tag.name,\n    \"web-${digitalocean_tag.site_tag.name}\",    \n    \"web-${digitalocean_tag.region_tag.name}\",\n    \"web-${digitalocean_tag.env_tag.name}\",\n    \"web-${digitalocean_tag.region_env_tag.name}\"\n  ]\n  depends_on = [digitalocean_droplet.storage_droplet]\n  count      = var.web_droplet_count\n}\n\nresource \"digitalocean_firewall\" \"firewall\" {\n  name = \"${var.region}-${var.env}.${var.domain}\"\n  tags = [\n    digitalocean_tag.site_tag.name,\n    digitalocean_tag.region_tag.name,\n    digitalocean_tag.env_tag.name,\n    digitalocean_tag.region_env_tag.name\n  ]\n\n  inbound_rule {\n      protocol         = \"tcp\"\n      port_range       = \"80\"\n      source_addresses = [\"0.0.0.0/0\", \"::/0\"]\n  }\n\n  inbound_rule {\n      protocol         = \"tcp\"\n      port_range       = \"443\"\n      source_addresses = [\"0.0.0.0/0\", \"::/0\"]\n  }\n\n  inbound_rule {\n      protocol         = \"tcp\"\n      port_range       = \"1935\"\n      source_addresses = [\"0.0.0.0/0\", \"::/0\"]\n  }\n\n  inbound_rule {\n      protocol         = \"tcp\"\n      port_range       = \"1-65535\"\n      source_addresses = var.allowed_ips\n      source_tags      = [digitalocean_tag.region_env_tag.name]\n  }\n\n  inbound_rule {\n      protocol         = \"udp\"\n      port_range       = \"1-65535\"\n      source_addresses = var.allowed_ips\n      source_tags      = [digitalocean_tag.region_env_tag.name]\n  }\n\n  inbound_rule {\n      protocol         = \"icmp\"\n      port_range       = \"1-65535\"\n      source_addresses = [\"0.0.0.0/0\", \"::/0\"]\n  }\n\n  outbound_rule {\n      protocol              = \"tcp\"\n      port_range            = \"1-65535\"\n      destination_addresses = [\"0.0.0.0/0\", \"::/0\"]\n  }\n\n  outbound_rule {\n      protocol              = \"udp\"\n      port_range            = \"1-65535\"\n      destination_addresses = [\"0.0.0.0/0\", \"::/0\"]\n    }\n\n  outbound_rule {\n      protocol              = \"icmp\"\n      port_range            = \"1-65535\"\n      destination_addresses = [\"0.0.0.0/0\", \"::/0\"]\n  }\n}\n\nresource \"digitalocean_certificate\" \"certificate\" {\n  name    = \"${var.region}-${var.env}-${replace(var.domain, \".\", \"-\")}\"\n  type    = \"lets_encrypt\"\n  domains = [\n    var.domain,\n    \"cdn.${var.domain}\",\n    \"cdn-${var.region}-${var.env}.${var.domain}\",\n    \"web-${var.region}-${var.env}.${var.domain}\"\n  ]\n\n  lifecycle {\n    create_before_destroy = true\n  }\n\n  depends_on = [digitalocean_domain.domain]\n}\n\nresource \"digitalocean_loadbalancer\" \"loadbalancer\" {\n  name                   = \"${var.region}-${var.env}-${replace(var.domain, \".\", \"-\")}\"\n  region                 = var.region\n  algorithm              = \"least_connections\"\n  redirect_http_to_https = true\n  droplet_tag            = \"web-${digitalocean_tag.region_env_tag.name}\"\n\n  forwarding_rule {\n    entry_port      = 80\n    entry_protocol  = \"http\"\n    target_port     = 80\n    target_protocol = \"http\"\n  }\n\n  forwarding_rule {\n    entry_port      = 443\n    entry_protocol  = \"https\"\n    target_port     = 80\n    target_protocol = \"http\"\n    certificate_id  = digitalocean_certificate.certificate.id\n  }\n\n  forwarding_rule {\n    entry_port      = 1935\n    entry_protocol  = \"tcp\"\n    target_port     = 1935\n    target_protocol = \"tcp\"\n  }\n\n  healthcheck {\n    port     = 80\n    protocol = \"http\"\n    path     = \"/app-health\"\n  }\n}\n\nresource \"digitalocean_domain\" \"domain\" {\n  name = var.domain\n}\n\nresource \"digitalocean_record\" \"web_ipv4_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"A\"\n  ttl    = \"300\"\n  name   = \"web-${var.region}-${var.env}\"\n  value  = digitalocean_loadbalancer.loadbalancer.ip\n}\n\nresource \"digitalocean_record\" \"web_droplet_ipv4_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"A\"\n  ttl    = \"300\"\n  name   = \"web-${format(\"%02d\", count.index)}-${var.region}-${var.env}\"\n  value  = element(digitalocean_droplet.web_droplet.*.ipv4_address, count.index)\n  count  = var.web_droplet_count\n}\n\nresource \"digitalocean_record\" \"web_droplet_private_ipv4_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"A\"\n  ttl    = \"300\"\n  name   = \"web-${format(\"%02d\", count.index)}-internal-${var.region}-${var.env}\"\n  value  = element(digitalocean_droplet.web_droplet.*.ipv4_address_private, count.index)\n  count  = var.web_droplet_count\n}\n\nresource \"digitalocean_record\" \"web_droplet_ipv6_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"AAAA\"\n  ttl    = \"300\"\n  name   = \"web-${format(\"%02d\", count.index)}-${var.region}-${var.env}\"\n  value  = element(digitalocean_droplet.web_droplet.*.ipv6_address, count.index)\n  count  = var.web_droplet_count\n}\n\nresource \"digitalocean_record\" \"storage_droplet_ipv4_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"A\"\n  ttl    = \"300\"\n  name   = \"storage-${var.region}-${var.env}\"\n  value  = digitalocean_droplet.storage_droplet.ipv4_address\n}\n\nresource \"digitalocean_record\" \"storage_droplet_ipv6_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"AAAA\"\n  ttl    = \"300\"\n  name   = \"storage-${var.region}-${var.env}\"\n  value  = digitalocean_droplet.storage_droplet.ipv6_address\n}\n\nresource \"digitalocean_record\" \"storage_droplet_private_ipv4_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"A\"\n  ttl    = \"300\"\n  name   = \"storage-internal-${var.region}-${var.env}\"\n  value  = digitalocean_droplet.storage_droplet.ipv4_address_private\n}\n\nresource \"digitalocean_record\" \"database_droplet_ipv4_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"A\"\n  ttl    = \"300\"\n  name   = \"database-${var.region}-${var.env}\"\n  value  = digitalocean_droplet.storage_droplet.ipv4_address\n}\n\nresource \"digitalocean_record\" \"database_droplet_ipv6_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"AAAA\"\n  ttl    = \"300\"\n  name   = \"database-${var.region}-${var.env}\"\n  value  = digitalocean_droplet.storage_droplet.ipv6_address\n}\n\nresource \"digitalocean_record\" \"database_droplet_private_ipv4_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"A\"\n  ttl    = \"300\"\n  name   = \"database-internal-${var.region}-${var.env}\"\n  value  = digitalocean_droplet.storage_droplet.ipv4_address_private\n}\n\nresource \"digitalocean_record\" \"cache_droplet_ipv4_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"A\"\n  ttl    = \"300\"\n  name   = \"cache-${var.region}-${var.env}\"\n  value  = digitalocean_droplet.storage_droplet.ipv4_address\n}\n\nresource \"digitalocean_record\" \"cache_droplet_ipv6_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"AAAA\"\n  ttl    = \"300\"\n  name   = \"cache-${var.region}-${var.env}\"\n  value  = digitalocean_droplet.storage_droplet.ipv6_address\n}\n\nresource \"digitalocean_record\" \"cache_droplet_private_ipv4_record\" {\n  domain = digitalocean_domain.domain.id\n  type   = \"A\"\n  ttl    = \"300\"\n  name   = \"cache-internal-${var.region}-${var.env}\"\n  value  = digitalocean_droplet.storage_droplet.ipv4_address_private\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/benwilber__boltstream__terraform__terraform.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_DIO_1", "severity": "HIGH", "message": "Ensure the Spaces bucket has versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/benwilber__boltstream__terraform__terraform.tf", "start_line": 79}, {"tool": "checkov", "rule_id": "CKV_DIO_4", "severity": "HIGH", "message": "Ensure the firewall ingress is not wide open", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/benwilber__boltstream__terraform__terraform.tf", "start_line": 159}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n### frigga name\nmodule \"frigga\" {\n  source  = \"Young-ook/spinnaker/aws//modules/frigga\"\n  version = \"2.3.5\"\n  name    = var.name == null || var.name == \"\" ? \"eks\" : var.name\n  petname = var.name == null || var.name == \"\" ? true : false\n}\n\nlocals {\n  name = module.frigga.name\n  default-tags = merge(\n    { \"terraform.io\" = \"managed\" },\n    { \"Name\" = local.name },\n  )\n}\n\n### kubernetes tags\nlocals {\n  eks-shared-tag = {\n    format(\"kubernetes.io/cluster/%s\", local.name) = \"shared\"\n  }\n  eks-owned-tag = {\n    format(\"kubernetes.io/cluster/%s\", local.name) = \"owned\"\n  }\n  eks-elb-tag = {\n    \"kubernetes.io/role/elb\" = \"1\"\n  }\n  eks-internal-elb-tag = {\n    \"kubernetes.io/role/internal-elb\" = \"1\"\n  }\n  eks-autoscaler-tag = {\n    \"k8s.io/cluster-autoscaler/enabled\"                = \"true\"\n    format(\"k8s.io/cluster-autoscaler/%s\", local.name) = \"owned\"\n  }\n  eks-tag = merge(\n    {\n      \"eks:cluster-name\" = local.name\n    },\n    local.eks-owned-tag,\n    local.eks-autoscaler-tag,\n  )\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Young-ook__terraform-aws-eks__labels.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Young-ook__terraform-aws-eks__labels.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tencentcloudstack__terraform-provider-tencentcloud__examples__tencentcloud-as__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# -------------------------------------------\n# Common Variables\n# -------------------------------------------\n\nvariable \"aws_region\" {\n  description = \"AWS infrastructure region\"\n  type        = string\n  default     = null\n}\n\n\nvariable \"tags\" {\n  description = \"Tag map for the resource\"\n  type        = map(string)\n  default     = {}\n}\n\nvariable \"prefix\" {\n  description = \"Resource name prefix\"\n  type        = string\n  default     = null\n}\n\nvariable \"additional_domain_names\" {\n  description = \"additional_domain_names\"\n  type        = list(string)\n  default     = []\n}\n\nvariable \"number\" {\n  description = \"number\"\n  type        = number\n  default     = 0\n}\n\nvariable \"bool\" {\n  description = \"bool\"\n  type        = bool\n  default     = false\n}\n\nvariable \"name\" {\n  description = \"name\"\n  type        = string\n  default     = null\n}\n\nvariable \"domain_name\" {\n  description = \"domain name\"\n  type        = string\n  default     = null\n}\n\nvariable \"validation_method\" {\n  description = \"validation_method\"\n  type        = string\n  default     = \"DNS\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/e2eSolutionArchitect__terraform__providers__aws__modules__e2esa-module-aws-acm__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Variable definitions for authentication\nvariable \"region_name\" {\n  description = \"The region where resources will be created\"\n  type        = string\n}\n\nvariable \"access_key\" {\n  description = \"The access key of the IAM user\"\n  type        = string\n  sensitive   = true\n}\n\nvariable \"secret_key\" {\n  description = \"The secret key of the IAM user\"\n  type        = string\n  sensitive   = true\n}\n\n# Variable definitions for resources/data sources\nvariable \"availability_zones\" {\n  description = \"The availability zones to which the instance belongs\"\n  type        = list(string)\n  default     = []\n  nullable    = false\n}\n\nvariable \"availability_zones_count\" {\n  description = \"The number of availability zones to which the instance belongs\"\n  type        = number\n  default     = 1\n}\n\nvariable \"vpc_id\" {\n  description = \"The ID of the VPC\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"subnet_id\" {\n  description = \"The ID of the subnet\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"vpc_name\" {\n  description = \"The name of the VPC\"\n  type        = string\n  default     = \"\"\n\n  validation {\n    condition     = var.vpc_id != \"\" || var.vpc_name != \"\"\n    error_message = \"vpc_name must be provided if vpc_id is not provided.\"\n  }\n}\n\nvariable \"vpc_cidr\" {\n  description = \"The CIDR block of the VPC\"\n  type        = string\n  default     = \"192.168.0.0/16\"\n}\n\nvariable \"subnet_name\" {\n  description = \"The name of the subnet\"\n  type        = string\n  default     = \"\"\n\n  validation {\n    condition     = var.subnet_id == \"\" || var.subnet_name == \"\"\n    error_message = \"subnet_name must be provided if subnet_id is not provided.\"\n  }\n}\n\nvariable \"subnet_cidr\" {\n  description = \"The CIDR block of the subnet\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"subnet_gateway_ip\" {\n  description = \"The gateway IP address of the subnet\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"security_group_name\" {\n  description = \"The name of the security group\"\n  type        = string\n}\n\nvariable \"instance_name\" {\n  description = \"The name of the APIG instance\"\n  type        = string\n}\n\nvariable \"instance_edition\" {\n  description = \"The edition of the APIG instance\"\n  type        = string\n  default     = \"BASIC\"\n}\n\nvariable \"enterprise_project_id\" {\n  description = \"The ID of the enterprise project\"\n  type        = string\n  default     = null\n}\n\nvariable \"plugin_name\" {\n  description = \"The name of the APIG plugin\"\n  type        = string\n}\n\nvariable \"plugin_description\" {\n  description = \"The description of the APIG plugin\"\n  type        = string\n  default     = null\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/huaweicloud__terraform-provider-huaweicloud__examples__apig__proxy-cache-plugin__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nresource \"aws_instance\" \"ec2_jenkins\" {\n  ami           = \"${lookup(var.ami_id, var.region)}\"\n  instance_type = \"${var.instance_type}\"\n  # Security group assign to instance\n  vpc_security_group_ids = [aws_security_group.allow_ssh.id]\n\n  # key name\n  key_name = \"${var.key_name}\"\n\n  user_data = <<EOF\n\t\t#! /bin/bash\n                sudo yum update -y\n\t\tsudo yum install -y httpd.x86_64\n\t\tsudo service httpd start\n\t\tsudo service httpd enable\n\t\techo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n\n    yum install java-1.8.0-openjdk-devel -y\n    curl --silent --location http://pkg.jenkins-ci.org/redhat-stable/jenkins.repo | sudo tee /etc/yum.repos.d/jenkins.repo\n    sudo rpm --import https://jenkins-ci.org/redhat/jenkins-ci.org.key\n    yum install -y jenkins\n    systemctl start jenkins\n    systemctl status jenkins\n    systemctl enable jenkins\n\n\t   EOF\n\n  tags = {\n    Name = \"Ec2-User-data\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__EC2withJenkins__ec2_jenkins.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__EC2withJenkins__ec2_jenkins.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__EC2withJenkins__ec2_jenkins.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__EC2withJenkins__ec2_jenkins.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__EC2withJenkins__ec2_jenkins.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__EC2withJenkins__ec2_jenkins.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"network\" {\n  source               = \"../network\"\n  environment          = var.environment\n  vpc_cidr             = var.vpc_cidr\n  public_subnet_cidrs  = var.public_subnet_cidrs\n  private_subnet_cidrs = var.private_subnet_cidrs\n  availability_zones   = var.availability_zones\n  depends_id           = \"\"\n}\n\nmodule \"ecs_instances\" {\n  source = \"../ecs_instances\"\n\n  environment             = var.environment\n  cluster                 = var.cluster\n  instance_group          = var.instance_group\n  private_subnet_ids      = module.network.private_subnet_ids\n  aws_ami                 = var.ecs_aws_ami\n  instance_type           = var.instance_type\n  max_size                = var.max_size\n  min_size                = var.min_size\n  desired_capacity        = var.desired_capacity\n  vpc_id                  = module.network.vpc_id\n  iam_instance_profile_id = aws_iam_instance_profile.ecs.id\n  key_name                = var.key_name\n  load_balancers          = var.load_balancers\n  depends_id              = module.network.depends_id\n  custom_userdata         = var.custom_userdata\n  cloudwatch_prefix       = var.cloudwatch_prefix\n}\n\nresource \"aws_ecs_cluster\" \"cluster\" {\n  name = var.cluster\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/arminc__terraform-ecs__modules__ecs__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_65", "severity": "HIGH", "message": "Ensure container insights are enabled on ECS cluster", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/arminc__terraform-ecs__modules__ecs__main.tf", "start_line": 32}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    kubernetes = {\n      source = \"hashicorp/kubernetes\"\n    }\n  }\n}\nprovider \"kubernetes\" {\n  config_path = \"~/.kube/config\"\n}\nresource \"kubernetes_deployment\" \"nginx\" {\n  metadata {\n    name = \"scalable-nginx-example\"\n    labels = {\n      App = \"ScalableNginxExample\"\n    }\n  }\n  spec {\n    replicas = 4\n    selector {\n      match_labels = {\n        App = \"ScalableNginxExample\"\n      }\n    }\n    template {\n      metadata {\n        labels = {\n          App = \"ScalableNginxExample\"\n        }\n      }\n      spec {\n        container {\n          image = \"nginx:1.7.8\"\n          name  = \"example\"\n          port {\n            container_port = 80\n          }\n          resources {\n            limits = {\n              cpu    = \"0.5\"\n              memory = \"512Mi\"\n            }\n            requests = {\n              cpu    = \"250m\"\n              memory = \"128Mi\"\n            }\n          }\n        }\n      }\n    }\n  }\n}\nresource \"kubernetes_service\" \"nginx\" {\n  metadata {\n    name = \"nginx-example\"\n  }\n  spec {\n    selector = {\n      App = kubernetes_deployment.nginx.spec.0.template.0.metadata[0].labels.App\n    }\n    port {\n      node_port   = 30201\n      port        = 80\n      target_port = 80\n    }\n    type = \"NodePort\"\n  }\n}\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__jesh__learn-terraform-deploy-nginx-kubernetes__kubernetes.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_K8S_30", "severity": "HIGH", "message": "Apply security context to your pods and containers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__jesh__learn-terraform-deploy-nginx-kubernetes__kubernetes.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_K8S_21", "severity": "HIGH", "message": "The default namespace should not be used", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__jesh__learn-terraform-deploy-nginx-kubernetes__kubernetes.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_K8S_28", "severity": "HIGH", "message": "Minimize the admission of containers with the NET_RAW capability", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__jesh__learn-terraform-deploy-nginx-kubernetes__kubernetes.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_K8S_43", "severity": "HIGH", "message": "Image should use digest", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__jesh__learn-terraform-deploy-nginx-kubernetes__kubernetes.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_K8S_15", "severity": "HIGH", "message": "Image Pull Policy should be Always", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__jesh__learn-terraform-deploy-nginx-kubernetes__kubernetes.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_K8S_8", "severity": "HIGH", "message": "Liveness Probe Should be Configured", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__jesh__learn-terraform-deploy-nginx-kubernetes__kubernetes.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_K8S_29", "severity": "HIGH", "message": "Apply security context to your pods, deployments and daemon_sets", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__jesh__learn-terraform-deploy-nginx-kubernetes__kubernetes.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_K8S_9", "severity": "HIGH", "message": "Readiness Probe Should be Configured", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__jesh__learn-terraform-deploy-nginx-kubernetes__kubernetes.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_K8S_21", "severity": "HIGH", "message": "The default namespace should not be used", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__jesh__learn-terraform-deploy-nginx-kubernetes__kubernetes.tf", "start_line": 53}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvariable \"group_email\" {\n  type        = string\n  description = \"Email for group to receive roles (ex. group@example.com)\"\n}\n\nvariable \"sa_email\" {\n  type        = string\n  description = \"Email for Service Account to receive roles (Ex. default-sa@example-project-id.iam.gserviceaccount.com)\"\n}\n\nvariable \"user_email\" {\n  type        = string\n  description = \"Email for group to receive roles (Ex. user@example.com)\"\n}\n\n/******************************************\n  cloud_run_service_iam_binding variables\n *****************************************/\nvariable \"cloud_run_service_project\" {\n  type        = string\n  description = \"Project id of the cloud run service\"\n}\n\nvariable \"cloud_run_service_location\" {\n  type        = string\n  description = \"The location of the cloud run instance\"\n}\n\nvariable \"cloud_run_service_one\" {\n  type        = string\n  description = \"First cloud run service to add the IAM policies/bindings\"\n}\n\nvariable \"cloud_run_service_two\" {\n  type        = string\n  description = \"Second cloud run service to add the IAM policies/bindings\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-iam__examples__cloud_run_service__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nterraform {\n  required_providers {\n\n    aws = {\n      source = \"hashicorp/aws\"\n    }\n\n    awscc = {\n      source = \"hashicorp/awscc\"\n    }\n  }\n}\n\nprovider \"aws\" {}\nprovider \"awscc\" {}\n\nresource \"awscc_kms_key\" \"test\" {\n  key_policy = jsonencode({\n    Id = \"kms-tf-1\"\n    Statement = [\n      {\n        Action = \"kms:*\"\n        Effect = \"Allow\"\n        Principal = {\n          AWS = \"*\"\n        }\n\n        Resource = \"*\"\n        Sid      = \"Enable IAM User Permissions\"\n      },\n    ]\n    Version = \"2012-10-17\"\n  })\n}\n\n# resource \"awscc_ecs_task_definition\" \"test\" {\n#   container_definitions = [\n#     {\n#       command = [\"sleep\", \"10\"]\n#       cpu     = 10\n#       docker_labels = {\n#         \"env\" = \"testing\"\n#       }\n#       entry_point = [\"/\"]\n#       environment = [\n#         {\n#           name  = \"VARNAME\"\n#           value = \"VARVAL\"\n#         }\n#       ]\n#       essential = true\n#       image     = \"jenkins/jenkins:lts\"\n#       memory    = 128\n#       name      = \"jenkins\"\n#       port_mappings = [\n#         {\n#           container_port = 80\n#           host_port      = 8080\n#         }\n#       ]\n#     }\n#   ]\n# }\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-awscc__test__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"hcloud_firewalls\" \"sample_firewall_1\" {\n  with_selector = \"key=value\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hetznercloud__terraform-provider-hcloud__examples__data-sources__hcloud_firewalls__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlocals {\n  instance_name = format(\"%s-%s\", var.instance_name, substr(md5(module.gce-advanced-container.container.image), 0, 8))\n}\n\nmodule \"gce-advanced-container\" {\n  source  = \"terraform-google-modules/container-vm/google\"\n  version = \"~> 3.0\"\n\n  container = {\n    image = \"busybox\"\n    command = [\n      \"tail\"\n    ]\n    args = [\n      \"-f\",\n      \"/dev/null\"\n    ]\n    securityContext = {\n      privileged : true\n    }\n    tty : true\n    env = [\n      {\n        name  = \"EXAMPLE\"\n        value = \"VAR\"\n      }\n    ]\n  }\n\n  restart_policy = \"OnFailure\"\n}\n\nresource \"google_compute_instance\" \"vm\" {\n  project      = var.project_id\n  name         = local.instance_name\n  machine_type = \"n1-standard-1\"\n  zone         = var.zone\n\n  boot_disk {\n    initialize_params {\n      image = module.gce-advanced-container.source_image\n    }\n  }\n\n  network_interface {\n    subnetwork_project = var.subnetwork_project\n    subnetwork         = var.subnetwork\n    access_config {}\n  }\n\n  tags = [\"container-vm-example\"]\n\n  metadata = {\n    gce-container-declaration = module.gce-advanced-container.metadata_value\n  }\n\n  labels = {\n    container-vm = module.gce-advanced-container.vm_container_label\n  }\n\n  service_account {\n    email = var.client_email\n    scopes = [\n      \"https://www.googleapis.com/auth/cloud-platform\",\n    ]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_advanced_options__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_advanced_options__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_advanced_options__main.tf", "start_line": 49}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_advanced_options__main.tf", "start_line": 49}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_advanced_options__main.tf", "start_line": 49}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_advanced_options__main.tf", "start_line": 49}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  #############################################################\n  ## AFTER RUNNING TERRAFORM APPLY (WITH LOCAL BACKEND)\n  ## YOU WILL UNCOMMENT THIS CODE THEN RERUN TERRAFORM INIT\n  ## TO SWITCH FROM LOCAL BACKEND TO REMOTE AWS BACKEND\n  #############################################################\n  # backend \"s3\" {\n  #   bucket         = \"devops-directive-tf-state\" # REPLACE WITH YOUR BUCKET NAME\n  #   key            = \"03-basics/import-bootstrap/terraform.tfstate\"\n  #   region         = \"us-east-1\"\n  #   dynamodb_table = \"terraform-state-locking\"\n  #   encrypt        = true\n  # }\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 3.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nresource \"aws_s3_bucket\" \"terraform_state\" {\n  bucket        = \"devops-directive-tf-state\" # REPLACE WITH YOUR BUCKET NAME\n  force_destroy = true\n}\n\nresource \"aws_s3_bucket_versioning\" \"terraform_bucket_versioning\" {\n  bucket = aws_s3_bucket.terraform_state.id\n  versioning_configuration {\n    status = \"Enabled\"\n  }\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"terraform_state_crypto_conf\" {\n  bucket        = aws_s3_bucket.terraform_state.bucket \n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}\n\nresource \"aws_dynamodb_table\" \"terraform_locks\" {\n  name         = \"terraform-state-locking\"\n  billing_mode = \"PAY_PER_REQUEST\"\n  hash_key     = \"LockID\"\n  attribute {\n    name = \"LockID\"\n    type = \"S\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__03-basics__aws-backend__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_28", "severity": "HIGH", "message": "Ensure DynamoDB point in time recovery (backup) is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__03-basics__aws-backend__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__03-basics__aws-backend__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__03-basics__aws-backend__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__03-basics__aws-backend__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__03-basics__aws-backend__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__03-basics__aws-backend__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__03-basics__aws-backend__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__03-basics__aws-backend__main.tf", "start_line": 27}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata vsphere_datacenter \"this\" {\n  name = var.template.datacenter\n}\n\ndata vsphere_compute_cluster \"this\" {\n\n  name          = var.template.cluster\n  datacenter_id = data.vsphere_datacenter.this.id\n}\n\ndata vsphere_datastore \"this\" {\n\n  name          = var.template.datastore\n  datacenter_id = data.vsphere_datacenter.this.id\n}\n\ndata vsphere_network \"this\" {\n\n  name          = var.template.network\n  datacenter_id = data.vsphere_datacenter.this.id\n}\n\n\ndata vsphere_virtual_machine \"template\" {\n\n  name          = var.template.template\n  datacenter_id = data.vsphere_datacenter.this.id\n}\n\n\ndata template_file \"kickstartconfig\" {\n\n  # Main cloud-config configuration file.\n  template = file(\"${path.module}/template/kickstart.yaml\")\n  vars = {\n    user = \"${var.template.user}\"\n    password = \"${var.template.password}\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linoproject__terraform__template-prep-adv__vpshere_data.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"fastly_ngwaf_alert_jira_integration\" \"ngwaf_jira_alerts\" {\n    workspace_id = fastly_ngwaf_workspace.test_redactions_workspace.id\n}\n\noutput \"ngwaf_jira_alerts_all\" {\n  value = data.ngwaf_jira_alerts.jira_alerts\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/fastly__terraform-provider-fastly__examples__data-sources__ngwaf_alert_mailing_list_integration.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Configure the AWS Provider\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\n# Create an EC2 instance\nresource \"aws_instance\" \"example_for_talk\" {\n  # AMI ID for Amazon Linux AMI 2016.03.0 (HVM) in us-east-1\n  ami = \"ami-0b33d91d\"\n  instance_type = \"t2.micro\"\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__infrastructure-as-code-talk__terraform-tutorial__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__infrastructure-as-code-talk__terraform-tutorial__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__infrastructure-as-code-talk__terraform-tutorial__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__infrastructure-as-code-talk__terraform-tutorial__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__infrastructure-as-code-talk__terraform-tutorial__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__infrastructure-as-code-talk__terraform-tutorial__main.tf", "start_line": 7}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n        access_key = \"${var.access_key}\"\n        secret_key = \"${var.secret_key}\"\n        region = \"${var.region}\"\n}\n\nresource \"aws_instance\" \"web-instance\" {\n        ami = \"${var.aws_ami}\"\n        instance_type = \"t2.micro\"\n        key_name = \"${var.key_name}\"\n        user_data = \"${file(\"httpd.sh\")}\"\n        vpc_security_group_ids = [\"${aws_security_group.webSG.id}\"]\n  tags = {\n    Name = \"web-instance\"\n  }\n}\n\n#Creating the Security Group  \nresource \"aws_security_group\" \"webSG\" {\n  name        = \"webSG\"\n  description = \"Allow ssh  inbound traffic\"\n  vpc_id      = \"vpc-f0525289\"\n\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port       = 0\n    to_port         = 0\n    protocol        = \"-1\"\n    cidr_blocks     = [\"0.0.0.0/0\"]\n    \n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__ec2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__ec2.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__ec2.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__ec2.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__ec2.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__ec2.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__ec2.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__ec2.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__ec2.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-ec2-user-data__ec2.tf", "start_line": 7}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nnot terraform!!\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__terraform__malformed_file_in_dir__malformed.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__terraform__malformed_file_in_dir__malformed.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__terraform__malformed_file_in_dir__malformed.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// Once everything is ready, let us start an EC2 instance within our public subnet with created key pair and security group.\n\ndata \"aws_ami\" \"ubuntu-bionic-latest\" {\n  most_recent = true\n\n  filter {\n    name = \"name\"\n    values = [\n      \"ubuntu/images/hvm-ssd/ubuntu-bionic-18.04-amd64-server-*\"\n    ]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  owners = [\"099720109477\"] # Canonical\n}\n\n\n// Login with ubuntu@PUBLIC_IP\nresource \"aws_instance\" \"web\" {\n  ami           = data.aws_ami.ubuntu-bionic-latest.id\n  instance_type = var.instance_type\n  subnet_id = aws_default_subnet.default_az1.id\n  vpc_security_group_ids = [aws_security_group.sg_22.id]\n  key_name = aws_key_pair.ec2key.key_name\n\n  tags = {\n    Name = \"DroneCI\"\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/codeaprendiz__learn_devops__home__infrastructure_as_code__terraform__aws__taskset_aws_terraform_infrastructure_as_code__task_002_defaultVPC_sbnt_sg_kp_ec2__35-ec2-instance.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/codeaprendiz__learn_devops__home__infrastructure_as_code__terraform__aws__taskset_aws_terraform_infrastructure_as_code__task_002_defaultVPC_sbnt_sg_kp_ec2__35-ec2-instance.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/codeaprendiz__learn_devops__home__infrastructure_as_code__terraform__aws__taskset_aws_terraform_infrastructure_as_code__task_002_defaultVPC_sbnt_sg_kp_ec2__35-ec2-instance.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/codeaprendiz__learn_devops__home__infrastructure_as_code__terraform__aws__taskset_aws_terraform_infrastructure_as_code__task_002_defaultVPC_sbnt_sg_kp_ec2__35-ec2-instance.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/codeaprendiz__learn_devops__home__infrastructure_as_code__terraform__aws__taskset_aws_terraform_infrastructure_as_code__task_002_defaultVPC_sbnt_sg_kp_ec2__35-ec2-instance.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/codeaprendiz__learn_devops__home__infrastructure_as_code__terraform__aws__taskset_aws_terraform_infrastructure_as_code__task_002_defaultVPC_sbnt_sg_kp_ec2__35-ec2-instance.tf", "start_line": 23}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n* Copyright 2024 Google LLC\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*      http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\nresource \"google_service_account\" \"default\" {\n  account_id   = \"my-serviceaccount\"\n  display_name = \"Custom SA for VM Instance\"\n}\n\nresource \"google_compute_instance\" \"default\" {\n  name         = \"my-instance\"\n  machine_type = \"n2-standard-2\"\n  zone         = \"us-central1-a\"\n  tags         = [\"foo\", \"bar\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-11\"\n      labels = {\n        my_label = \"value\"\n      }\n    }\n  }\n\n  // Local SSD disk\n  scratch_disk {\n    interface = \"NVME\"\n  }\n\n  network_interface {\n    network = \"default\"\n    access_config {\n      // Ephemeral public IP\n    }\n  }\n\n  service_account {\n    # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n    email  = google_service_account.default.email\n    scopes = [\"cloud-platform\"]\n  }\n}\n\nresource \"google_compute_disk\" \"default\" {\n  name = \"disk-data\"\n  type = \"pd-standard\"\n  zone = \"us-central1-a\"\n}\n\nresource \"google_backup_dr_backup_vault\" \"default\" {\n  provider                                   = google-beta\n  location                                   = \"us-central1\"\n  backup_vault_id                            = \"my-vault\"\n  description                                = \"This is a second backup vault built by Terraform.\"\n  backup_minimum_enforced_retention_duration = \"100000s\"\n\n  labels = {\n    foo = \"bar1\"\n    bar = \"baz1\"\n  }\n\n  annotations = {\n    annotations1 = \"bar1\"\n    annotations2 = \"baz1\"\n  }\n\n  force_update                = \"true\"\n  ignore_inactive_datasources = \"true\"\n  allow_missing               = \"true\"\n}\n\nresource \"google_backup_dr_backup_plan\" \"default\" {\n  provider       = google-beta\n  location       = \"us-central1\"\n  backup_plan_id = \"my-bp\"\n  resource_type  = \"compute.googleapis.com/Instance\"\n  backup_vault   = google_backup_dr_backup_vault.default.name\n\n  backup_rules {\n    rule_id               = \"rule-1\"\n    backup_retention_days = 2\n\n    standard_schedule {\n      recurrence_type  = \"HOURLY\"\n      hourly_frequency = 6\n      time_zone        = \"UTC\"\n\n      backup_window {\n        start_hour_of_day = 12\n        end_hour_of_day   = 18\n      }\n    }\n  }\n}\n\nresource \"google_backup_dr_backup_plan\" \"disk_default\" {\n  provider       = google-beta\n  location       = \"us-central1\"\n  backup_plan_id = \"my-disk-bp\"\n  resource_type  = \"compute.googleapis.com/Disk\"\n  backup_vault   = google_backup_dr_backup_vault.default.name\n\n  backup_rules {\n    rule_id               = \"rule-1\"\n    backup_retention_days = 5\n\n    standard_schedule {\n      recurrence_type  = \"HOURLY\"\n      hourly_frequency = 1\n      time_zone        = \"UTC\"\n\n      backup_window {\n        start_hour_of_day = 0\n        end_hour_of_day   = 6\n      }\n    }\n  }\n}\n\n# [START backupdr_create_backupplanassociation]\n\n# Before creating a backup plan association, you need to create backup plan (google_backup_dr_backup_plan)\n# and compute instance (google_compute_instance).\nresource \"google_backup_dr_backup_plan_association\" \"default\" {\n  provider                   = google-beta\n  location                   = \"us-central1\"\n  backup_plan_association_id = \"my-bpa\"\n  resource                   = google_compute_instance.default.id\n  resource_type              = \"compute.googleapis.com/Instance\"\n  backup_plan                = google_backup_dr_backup_plan.default.name\n}\n\n# [END backupdr_create_backupplanassociation]\n\n# [START backupdr_create_backupplanassociation_disk]\n\n# Before creating a backup plan association, you need to create backup plan (google_backup_dr_backup_plan)\n# and compute disk (google_compute_disk or google_compute_region_disk).\nresource \"google_backup_dr_backup_plan_association\" \"disk_association\" {\n  provider                   = google-beta\n  location                   = \"us-central1\"\n  backup_plan_association_id = \"my-disk-bpa\"\n  resource                   = google_compute_disk.default.id\n  resource_type              = \"compute.googleapis.com/Disk\"\n  backup_plan                = google_backup_dr_backup_plan.disk_default.name\n}\n\n# [END backupdr_create_backupplanassociation_disk]\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-docs-samples__backupdr__backup_plan_association__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-docs-samples__backupdr__backup_plan_association__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-docs-samples__backupdr__backup_plan_association__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-docs-samples__backupdr__backup_plan_association__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-docs-samples__backupdr__backup_plan_association__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_GCP_37", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-docs-samples__backupdr__backup_plan_association__main.tf", "start_line": 56}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"certificate_transparency_disabled\" {\n  description = \"Certificate Transparency logging enabled\"\n  type        = bool\n  default     = false\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nccgroup__sadcloud__modules__aws__acm__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    coder = {\n      source = \"coder/coder\"\n    }\n  }\n}\n\ndata \"coder_workspace_owner\" \"me\" {}\n\nlocals {\n  isAdmin = contains(data.coder_workspace_owner.me.groups, \"admin\")\n}\n\ndata \"coder_parameter\" \"isAdmin\" {\n  name      = \"isAdmin\"\n  type      = \"bool\"\n  form_type = \"switch\"\n  default   = local.isAdmin\n  order     = 1\n}\n\ndata \"coder_parameter\" \"adminonly\" {\n  count     = local.isAdmin ? 1 : 0\n  name      = \"adminonly\"\n  form_type = \"input\"\n  type      = \"string\"\n  default   = \"I am an admin!\"\n  order     = 2\n}\n\n\ndata \"coder_parameter\" \"groups\" {\n  name      = \"groups\"\n  type      = \"list(string)\"\n  form_type = \"multi-select\"\n  default   = jsonencode([data.coder_workspace_owner.me.groups[0]])\n  order     = 50\n\n  dynamic \"option\" {\n    for_each = data.coder_workspace_owner.me.groups\n    content {\n      name  = option.value\n      value = option.value\n    }\n  }\n}\n\nlocals {\n  colors = {\n    \"red\" : [\"apple\", \"ruby\"]\n    \"yellow\" : [\"banana\"]\n    \"blue\" : [\"ocean\", \"sky\"]\n    \"green\" : [\"grass\", \"leaf\"]\n  }\n}\n\ndata \"coder_parameter\" \"colors\" {\n  name      = \"colors\"\n  type      = \"list(string)\"\n  form_type = \"multi-select\"\n  order     = 100\n\n  dynamic \"option\" {\n    for_each = keys(local.colors)\n    content {\n      name  = option.value\n      value = option.value\n    }\n  }\n}\n\nlocals {\n  selected = jsondecode(data.coder_parameter.colors.value)\n  things = flatten([\n    for color in local.selected : local.colors[color]\n  ])\n}\n\ndata \"coder_parameter\" \"thing\" {\n  name      = \"thing\"\n  type      = \"string\"\n  form_type = \"dropdown\"\n  order     = 101\n\n  dynamic \"option\" {\n    for_each = local.things\n    content {\n      name  = option.value\n      value = option.value\n    }\n  }\n}\n\n// Cool people like blue. Idk what to tell you.\ndata \"coder_parameter\" \"cool\" {\n  count     = contains(local.selected, \"blue\") ? 1 : 0\n  name      = \"cool\"\n  type      = \"bool\"\n  form_type = \"switch\"\n  order     = 102\n  default   = \"true\"\n}\n\ndata \"coder_parameter\" \"number\" {\n  count = contains(local.selected, \"green\") ? 1 : 0\n  name  = \"number\"\n  type  = \"number\"\n  order = 103\n  validation {\n    error = \"Number must be between 0 and 10\"\n    min   = 0\n    max   = 10\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/coder__coder__enterprise__coderd__testdata__parameters__dynamic__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_lb_listener_rule\" \"alb_rule\" {\n  listener_arn = var.listener_arn\n  priority     = var.priority\n\n  action {\n    type             = var.action_type\n    target_group_arn = var.target_group_arn\n\n    dynamic fixed_response {\n      for_each = var.action_type == \"fixed-response\" ? [1] : []\n      content {\n        content_type = var.fixed_response.content_type\n        message_body = var.fixed_response.message_body\n        status_code  = var.fixed_response.status_code\n      }\n    }\n    dynamic redirect {\n      for_each = var.action_type == \"redirect\" ? [1] : []\n      content {\n        port        = var.redirect.port\n        protocol    = var.redirect.protocol\n        status_code = var.redirect.status_code\n        host        = var.redirect.host == \"\" ? \"#{host}\" : var.redirect.host\n        path        = var.redirect.path == \"\" ? \"/#{path}\" : var.redirect.path\n        query       = var.redirect.query == \"\" ? \"#{query}\" : var.redirect.query\n      }\n    }\n  }\n\n  # legacy code\n  condition {\n    dynamic host_header {\n      for_each = var.condition_field == \"host-header\" ? [1] : []\n      content {\n        values = var.condition_values\n      }\n    }\n    dynamic path_pattern {\n      for_each = var.condition_field == \"path-pattern\" ? [1] : []\n      content {\n        values = var.condition_values\n      }\n    }\n  }\n  # more flexible approach\n  dynamic condition {\n    for_each = var.conditions\n    content {\n      dynamic host_header {\n        for_each = condition.value.field == \"host-header\" ? [1] : []\n        content {\n          values = condition.value.values\n        }\n      }\n      dynamic path_pattern {\n        for_each = condition.value.field == \"path-pattern\" ? [1] : []\n        content {\n          values = condition.value.values\n        }\n      }\n      dynamic query_string {\n        for_each = condition.value.field == \"query-string\" ? [1] : []\n        content {\n          value = condition.value.value\n        }\n      }\n    }\n  }\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in4it__terraform-modules__modules__alb-rule__rule.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_secretsmanager_secret\" \"infra\" {\n  name = \"/${local.name_wo_region}/infra/layer2-k8s\"\n}\n\ndata \"aws_secretsmanager_secret_version\" \"infra\" {\n  secret_id = data.aws_secretsmanager_secret.infra.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/maddevsio__aws-eks-base__terraform__layer2-k8s__aws-sm-secrets.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"mongodbatlas\" {\n  client_id     = var.atlas_client_id\n  client_secret = var.atlas_client_secret\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mongodb__terraform-provider-mongodbatlas__examples__mongodbatlas_alert_configuration__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  # Kubernetes Aggregation TLS assets map\n  aggregation_tls = var.enable_aggregation ? {\n    \"tls/k8s/aggregation-ca.crt\"     = tls_self_signed_cert.aggregation-ca[0].cert_pem,\n    \"tls/k8s/aggregation-client.crt\" = tls_locally_signed_cert.aggregation-client[0].cert_pem,\n    \"tls/k8s/aggregation-client.key\" = tls_private_key.aggregation-client[0].private_key_pem,\n  } : {}\n}\n\n# Kubernetes Aggregation CA (i.e. front-proxy-ca)\n# Files: tls/{aggregation-ca.crt,aggregation-ca.key}\n\nresource \"tls_private_key\" \"aggregation-ca\" {\n  count = var.enable_aggregation ? 1 : 0\n\n  algorithm = \"RSA\"\n  rsa_bits  = \"2048\"\n}\n\nresource \"tls_self_signed_cert\" \"aggregation-ca\" {\n  count = var.enable_aggregation ? 1 : 0\n\n  private_key_pem = tls_private_key.aggregation-ca[0].private_key_pem\n\n  subject {\n    common_name = \"kubernetes-front-proxy-ca\"\n  }\n\n  is_ca_certificate     = true\n  validity_period_hours = 8760\n\n  allowed_uses = [\n    \"key_encipherment\",\n    \"digital_signature\",\n    \"cert_signing\",\n  ]\n}\n\n# Kubernetes apiserver (i.e. front-proxy-client)\n# Files: tls/{aggregation-client.crt,aggregation-client.key}\n\nresource \"tls_private_key\" \"aggregation-client\" {\n  count = var.enable_aggregation ? 1 : 0\n\n  algorithm = \"RSA\"\n  rsa_bits  = \"2048\"\n}\n\nresource \"tls_cert_request\" \"aggregation-client\" {\n  count = var.enable_aggregation ? 1 : 0\n\n  private_key_pem = tls_private_key.aggregation-client[0].private_key_pem\n\n  subject {\n    common_name = \"kube-apiserver\"\n  }\n}\n\nresource \"tls_locally_signed_cert\" \"aggregation-client\" {\n  count = var.enable_aggregation ? 1 : 0\n\n  cert_request_pem = tls_cert_request.aggregation-client[0].cert_request_pem\n\n  ca_private_key_pem = tls_private_key.aggregation-ca[0].private_key_pem\n  ca_cert_pem        = tls_self_signed_cert.aggregation-ca[0].cert_pem\n\n  validity_period_hours = 8760\n\n  allowed_uses = [\n    \"key_encipherment\",\n    \"digital_signature\",\n    \"client_auth\",\n  ]\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__terraform-render-bootstrap__tls-aggregation.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"azurerm_resource_group\" \"rg\" {\n  name     = var.resource_group_name\n  location = \"uksouth\"\n}\n\nresource \"azurerm_storage_account\" \"sa\" {\n  count                    = var.create_resource_group ? 1 : 0\n  name                     = \"tamopsstorage\"\n  resource_group_name      = azurerm_resource_group.rg.name\n  location                 = azurerm_resource_group.rg.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"LRS\"\n\n  depends_on = [\n    azurerm_resource_group.rg\n  ]\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_59", "severity": "HIGH", "message": "Ensure that Storage accounts disallow public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_33", "severity": "HIGH", "message": "Ensure Storage logging is enabled for Queue service for read, write and delete requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_44", "severity": "HIGH", "message": "Ensure Storage Account is using the latest version of TLS encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_206", "severity": "HIGH", "message": "Ensure that Storage Accounts use replication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_190", "severity": "HIGH", "message": "Ensure that Storage blobs restrict public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AZURE_40", "severity": "CRITICAL", "message": "Ensure storage account is not configured with Shared Key authorization", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AZURE_47", "severity": "CRITICAL", "message": "Ensure storage account is configured without blob anonymous access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AZURE_33", "severity": "CRITICAL", "message": "Ensure storage account is configured with private endpoint", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AZURE_41", "severity": "CRITICAL", "message": "Ensure storage account is configured with SAS expiration policy", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AZURE_38", "severity": "CRITICAL", "message": "Ensure soft-delete is enabled on Azure storage account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AZURE_1", "severity": "CRITICAL", "message": "Ensure storage for critical data are encrypted with Customer Managed Key", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__4-terraform-advanced__4-conditional-expressions__conditional-expressions-example__main.tf", "start_line": 6}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\n# This configuration creates and manages workspaces in HCP Terraform /\n# Enterprise. Workspaces and the variables that should be set on them come from\n# two maps, and can come from additional sources as well, such as individual\n# variable resource blocks. The maps are merged, and then the result is\n# iterated over using for_each.\n\nvariable \"tf_organization\" {\n  description = \"The HCP Terraform or Enterprise organization under which all operations should be performed.\"\n  type = string\n}\n\nvariable \"vcs_repo_identifier\" {\n  description = <<-EOT\n  The format of VCS repo identifier might differ depending on the VCS provider,\n  see https://registry.terraform.io/providers/hashicorp/tfe/latest/docs/resources/workspace\n  EOT\n  type = string\n}\n\nvariable \"vcs_token\" {\n  description = \"The VCS token should correspond to an API token that can create OAuth clients.\"\n  type = string\n}\n\nvariable \"vars_mapped_by_workspace_name\" {\n    description = <<-EOT\n    This is the map of workspaces and variables. A workspace is created for each\n    top level key and then variables are set on the workspace.\n    EOT\n    type = any\n}\n\nvariable \"additional_vars\" {\n  description = \"This is a map of additional variables intended to be set in specific workspaces.\"\n  type = any\n  default = {\n    customer_1_workspace = {\n      i_am_sensitive_tf_var = {\n        value = \"i am sensitive\"\n        sensitive = true\n      }\n    }\n  }\n}\n\nvariable \"default_var_category\" {\n  description = \"Default category for variables being set in managed workspaces unless specified\"\n  default = \"terraform\"\n  type = string\n}\n\nvariable \"default_var_hcl\" {\n  description = \"By default, variables being set in managed workspaces will not be interpreted as hcl values\"\n  default = false\n  type = bool\n}\n\nvariable \"default_var_sensitive\" {\n  description = \"By default, variables being set in managed workspaces will be non-sensitive\"\n  default = false\n  type = bool\n}\n\nlocals {\n  # Flatten the workspaces variable nested structure for later iteration in the managed_var resource. Adapted from:\n  # https://developer.hashicorp.com/terraform/language/functions/flatten#flattening-nested-structures-for-for_each\n\n  # Results in a list of maps, that contains all the information\n  # required to manage that workspace variable.\n  #   [{\n  #     ws            = ws_name\n  #     var_key       = name\n  #     var_value     = value\n  #     var_category  = string\n  #     var_hcl       = true/false\n  #     var_sensitive = true/false\n  #     ws_id         = <tfe_workspace>.id\n  #   }...]\n  ws_variables = flatten([\n    for ws_name, variables in var.vars_mapped_by_workspace_name : [\n      for var_name, var_attrs in merge(variables, lookup(var.additional_vars, ws_name, {})) : {\n        ws            = ws_name\n        var_key       = var_name\n        var_value     = var_attrs[\"value\"]\n        var_category  = lookup(var_attrs, \"category\",  var.default_var_category)\n        var_hcl       = lookup(var_attrs, \"hcl\",       var.default_var_hcl)\n        var_sensitive = lookup(var_attrs, \"sensitive\", var.default_var_sensitive)\n        ws_id         = tfe_workspace.managed_ws[ws_name].id\n      }\n    ]\n  ])\n}\n\n# This example oauth connection assumes the VCS provider is Github.\nresource \"tfe_oauth_client\" \"gh\" {\n  organization     = var.tf_organization\n  api_url          = \"https://api.github.com\"\n  http_url         = \"https://github.com\"\n  oauth_token      = var.vcs_token\n  service_provider = \"github\"\n}\n\nresource \"tfe_workspace\" \"managed_ws\" {\n  description = \"Create all workspaces specified in the input workspaces map\"\n  for_each = var.vars_mapped_by_workspace_name\n\n  name = each.key\n  organization = var.tf_organization\n  auto_apply = true\n  force_delete = true\n  vcs_repo {\n    identifier = var.vcs_repo_identifier\n    oauth_token_id = tfe_oauth_client.gh.oauth_token_id\n  }\n}\n\nresource \"tfe_variable\" \"managed_var\" {\n  # The for_each expression expects a map or a set of strings,\n  # see https://developer.hashicorp.com/terraform/language/meta-arguments/for_each\n  # Accordingly, the flattened list of maps, local.ws_variables, is converted to a\n  # map with unique key format \"workspace_name_variable_name\".\n  # {\n  #   customer_1_workspace_var1 = {\n  #     ws            = ws_name\n  #     var_key       = name\n  #     var_value     = value\n  #     var_category  = string\n  #     var_hcl       = true/false\n  #     var_sensitive = true/false\n  #     ws_id         = <tfe_workspace>.id\n  #   }\n  #   customer_1_workspace_var2 = {\n  #     ...\n  #   }\n  #   ...\n  # }\n\n  for_each = {\n    for v in local.ws_variables : \"${v.ws}.${v.var_key}\" => v\n  }\n\n  workspace_id = each.value.ws_id\n  key          = each.value.var_key\n  value        = each.value.var_value\n  category     = each.value.var_category\n  hcl          = each.value.var_hcl\n  sensitive    = each.value.var_sensitive\n}\n\nresource \"random_pet\" \"a_dynamic_value\" {\n  length = 5\n}\n\nresource \"tfe_variable\" \"managed_customized_var\" {\n  description  = \"Create dynamic variable for specific workspaces\"\n  for_each     = tfe_workspace.managed_ws\n\n  workspace_id = each.value.id\n  key          = \"a_customized_var\"\n  value        = random_pet.a_dynamic_value.id\n  category     = \"terraform\"\n  hcl          = false\n  sensitive    = false\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-tfe__examples__workspaces_variables__manager__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"proxmox_virtual_environment_vm\" \"controlplane\" {\n  count = var.controlplane_num\n  vm_id = \"${var.controlplane_vmid_prefix}${count.index + 1}\"\n\n  pool_id   = proxmox_virtual_environment_pool.proxmox_resource_pool.id\n  node_name = var.controlplane_node_name\n\n  name        = \"${var.controlplane_hostname_prefix}-${count.index + 1}\"\n  description = \"${var.controlplane_hostname_prefix}: ${count.index + 1}\"\n  tags        = var.controlplane_tags\n\n  cpu {\n    cores = var.controlplane_cpu_cores\n    type  = \"host\"\n  }\n\n  memory {\n    dedicated = var.controlplane_memory\n  }\n\n  network_device {\n    bridge      = var.controlplane_network_device\n    mac_address = \"${var.controlplane_mac_address_prefix}${count.index + 1}\"\n    vlan_id     = var.controlplane_vlan_id\n  }\n\n  disk {\n    datastore_id = var.controlplane_datastore\n    file_id      = proxmox_virtual_environment_file.talos_image.id\n    file_format  = \"raw\"\n    interface    = \"scsi0\"\n    size         = var.controlplane_disk_size\n  }\n\n  agent {\n    enabled = true\n    # If left to default, Terraform will be held for 15 minutes waiting for the agent to start\n    # before it is even installed. Prevent this by effectively immediatly timing out.\n    timeout = \"1s\"\n  }\n\n  operating_system {\n    type = \"l26\"\n  }\n\n  # Remove the node from Kubernetes on destroy\n  provisioner \"local-exec\" {\n    when    = destroy\n    command = \"./bin/manage_nodes remove ${self.name}\"\n  }\n}\n\ndata \"talos_machine_configuration\" \"controlplane\" {\n  cluster_name     = var.kubernetes_cluster_name\n  cluster_endpoint = \"https://${var.talos_virtual_ip}:6443\"\n\n  machine_type    = \"controlplane\"\n  machine_secrets = talos_machine_secrets.this.machine_secrets\n\n  talos_version      = var.talos_version\n  kubernetes_version = var.kubernetes_version\n}\n\nresource \"talos_machine_configuration_apply\" \"controlplane\" {\n  depends_on = [\n    proxmox_virtual_environment_vm.controlplane\n  ]\n\n  count    = var.controlplane_num\n  node     = local.controlplane_nodes[count.index]\n  endpoint = local.controlplane_nodes[count.index]\n\n  client_configuration        = talos_machine_secrets.this.client_configuration\n  machine_configuration_input = data.talos_machine_configuration.controlplane.machine_configuration\n\n  config_patches = [\n    templatefile(\"configs/global.yml\", {\n      qemu_guest_agent_version = var.qemu_guest_agent_version\n    }),\n    templatefile(\"configs/controlplane.yml\", {\n      talos_virtual_ip = var.talos_virtual_ip\n    }),\n    var.talos_disable_flannel ? templatefile(\"configs/disable_flannel.yml\", {}) : null\n  ]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/zimmertr__TJs-Kubernetes-Service__talos_controlplanes.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"region\" {\n  value = data.aws_region.current.name\n}\n\noutput \"logger_public_ip\" {\n  value = aws_instance.logger.public_ip\n}\n\noutput \"logger_ssh_access\" {\n  value = \"ssh vagrant@${aws_instance.logger.public_ip} (password=vagrant)\"\n}\n\noutput \"dc_public_ip\" {\n  value = aws_instance.dc.public_ip\n}\n\noutput \"wef_public_ip\" {\n  value = aws_instance.wef.public_ip\n}\n\noutput \"win10_public_ip\" {\n  value = aws_instance.win10.public_ip\n}\n\noutput \"fleet_url\" {\n  value = local.fleet_url\n}\n\noutput \"splunk_url\" {\n  value = local.splunk_url\n}\n\noutput \"guacamole_url\" {\n  value = local.guacamole_url\n}\n\noutput \"velociraptor_url\" {\n  value = local.velociraptor_url\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/clong__DetectionLab__AWS__Terraform__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Licensed to the Apache Software Foundation (ASF) under one\n# or more contributor license agreements.  See the NOTICE file\n# distributed with this work for additional information\n# regarding copyright ownership.  The ASF licenses this file\n# to you under the Apache License, Version 2.0 (the\n# \"License\"); you may not use this file except in compliance\n# with the License.  You may obtain a copy of the License at\n#\n#   http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing,\n# software distributed under the License is distributed on an\n# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n# KIND, either express or implied.  See the License for the\n# specific language governing permissions and limitations\n# under the License.\n\n# Generates a secure private key and encodes it as PEM\nresource \"tls_private_key\" \"key_pair\" {\n  algorithm = \"RSA\"\n  rsa_bits  = 4096\n}\n\n# Create the Key Pair\nresource \"aws_key_pair\" \"key_pair\" {\n  key_name   = \"dolphinscheduler\"\n  public_key = tls_private_key.key_pair.public_key_openssh\n}\n\n# Save file\nresource \"local_file\" \"ssh_key\" {\n  filename        = \"${aws_key_pair.key_pair.key_name}.pem\"\n  content         = tls_private_key.key_pair.private_key_pem\n  file_permission = \"0700\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/apache__dolphinscheduler__deploy__terraform__aws__key-pair-main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nresource \"aws_instance\" \"test_instance\" {\n  ami           = \"ami-084568db4383264d4\"\n  instance_type = \"t2.micro\"\n\n  user_data                   = <<-EOF\n  #!/bin/bash\n  echo \"Hello World!\" > index.html\n  nohup busybox httpd -f -p 8080 &\n  EOF\n  user_data_replace_on_change = true\n\n  tags = {\n    Name = \"HelloWorld-v6\"\n  }\n}\n\nresource \"aws_security_group\" \"test_sg\" {\n  name = \"terraform-example-instance\"\n\n  ingress {\n    from_port   = 8080\n    to_port     = 8080\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_02__01_web_server__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_02__01_web_server__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_02__01_web_server__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_02__01_web_server__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_02__01_web_server__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_02__01_web_server__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_02__01_web_server__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_02__01_web_server__main.tf", "start_line": 21}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"hello\" {\n  value = \"world\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/flux-iac__tofu-controller__tfctl__testdata__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Retrieve an Issue Alert\ndata \"sentry_issue_alert\" \"original\" {\n  organization = \"my-organization\"\n  project      = \"my-project\"\n  id           = \"42\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jianyuan__terraform-provider-sentry__examples__data-sources__sentry_issue_alert__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.16\"\n    }\n  }\n\n  required_version = \">= 1.2.0\"\n}\n\nprovider \"aws\" {\n  region  = \"us-west-2\"\n}\n\nresource \"aws_instance\" \"app_server\" {\n  ami           = \"ami-830c94e3\"\n  instance_type = \"t2.micro\"\n\n  tags = {\n    Name = \"Terraform_Demo\"\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__local_state__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__local_state__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__local_state__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__local_state__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__local_state__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__local_state__main.tf", "start_line": 16}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// This output allows backup_recovery_connection_registration_token data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery_connection_registration_token\" {\n  value       = ibm_backup_recovery_connection_registration_token.backup_recovery_connection_registration_token_instance\n  description = \"backup_recovery_connection_registration_token resource instance\"\n}\n// This output allows backup_recovery_protection_group_run_request data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery_protection_group_run_request\" {\n  value       = ibm_backup_recovery_protection_group_run_request.backup_recovery_protection_group_run_request_instance\n  description = \"backup_recovery_protection_group_run_request resource instance\"\n}\n// This output allows backup_recovery_data_source_connection data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery_data_source_connection\" {\n  value       = ibm_backup_recovery_data_source_connection.backup_recovery_data_source_connection_instance\n  description = \"backup_recovery_data_source_connection resource instance\"\n}\n// This output allows backup_recovery_download_files_folders data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery_download_files_folders\" {\n  value       = ibm_backup_recovery_download_files_folders.backup_recovery_download_files_folders_instance\n  description = \"backup_recovery_download_files_folders resource instance\"\n}\n// This output allows backup_recovery_restore_points data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery_restore_points\" {\n  value       = ibm_backup_recovery_restore_points.backup_recovery_restore_points_instance\n  description = \"backup_recovery_restore_points resource instance\"\n}\n// This output allows backup_recovery_perform_action_on_protection_group_run_request data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery_perform_action_on_protection_group_run_request\" {\n  value       = ibm_backup_recovery_perform_action_on_protection_group_run_request.backup_recovery_perform_action_on_protection_group_run_request_instance\n  description = \"backup_recovery_perform_action_on_protection_group_run_request resource instance\"\n}\n// This output allows backup_recovery_protection_group data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery_protection_group\" {\n  value       = ibm_backup_recovery_protection_group.backup_recovery_protection_group_instance\n  description = \"backup_recovery_protection_group resource instance\"\n}\n// This output allows backup_recovery_protection_policy data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery_protection_policy\" {\n  value       = ibm_backup_recovery_protection_policy.backup_recovery_protection_policy_instance\n  description = \"backup_recovery_protection_policy resource instance\"\n}\n// This output allows backup_recovery data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery\" {\n  value       = ibm_backup_recovery.backup_recovery_instance\n  description = \"backup_recovery resource instance\"\n}\n// This output allows backup_recovery_search_indexed_object data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery_search_indexed_object\" {\n  value       = ibm_backup_recovery_search_indexed_object.backup_recovery_search_indexed_object_instance\n  description = \"backup_recovery_search_indexed_object resource instance\"\n}\n// This output allows backup_recovery_source_registration data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery_source_registration\" {\n  value       = ibm_backup_recovery_source_registration.backup_recovery_source_registration_instance\n  description = \"backup_recovery_source_registration resource instance\"\n}\n// This output allows backup_recovery_update_protection_group_run_request data to be referenced by other resources and the terraform CLI\n// Modify this output if only certain data should be exposed\noutput \"ibm_backup_recovery_update_protection_group_run_request\" {\n  value       = ibm_backup_recovery_update_protection_group_run_request.backup_recovery_update_protection_group_run_request_instance\n  description = \"backup_recovery_update_protection_group_run_request resource instance\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/IBM-Cloud__terraform-provider-ibm__examples__ibm-backup-recovery__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  /*\n  # full_lifecycle_rule_schema is just for documentation, not actually used.\n  full_lifecycle_rule_schema = {\n    enabled = true # bool\n    id      = null # string, must be specified and unique\n\n    abort_incomplete_multipart_upload_days = null # number\n    filter_prefix_only                     = null # string See https://github.com/hashicorp/terraform-provider-aws/issues/23882\n    filter_and = {\n      object_size_greater_than = null # integer >= 0\n      object_size_less_than    = null # integer >= 1\n      prefix                   = null # string\n      tags                     = {}   # map(string)\n    }\n    expiration = {\n      date                         = null # string\n      days                         = null # integer > 0\n      expired_object_delete_marker = null # bool\n    }\n    noncurrent_version_expiration = {\n      newer_noncurrent_versions = null # integer > 0\n      noncurrent_days           = null # integer >= 0\n    }\n    transition = [{\n      date          = null # string\n      days          = null # integer > 0\n      storage_class = null # string/enum, one of GLACIER, STANDARD_IA, ONEZONE_IA, INTELLIGENT_TIERING, DEEP_ARCHIVE, GLACIER_IR.\n    }]\n    noncurrent_version_transition = [{\n      newer_noncurrent_versions = null # integer >= 0\n      noncurrent_days           = null # integer >= 0\n      storage_class             = null # string/enum, one of GLACIER, STANDARD_IA, ONEZONE_IA, INTELLIGENT_TIERING, DEEP_ARCHIVE, GLACIER_IR.\n    }]\n  }\n  */\n\n  lifecycle_configuration_rules = var.lifecycle_configuration_rules == null ? [] : var.lifecycle_configuration_rules\n  # Normalize the input, filling in missing fields\n  normalized_lifecycle_configuration_rules = [for rule in local.lifecycle_configuration_rules : {\n    enabled = rule.enabled\n    id      = rule.id\n\n    abort_incomplete_multipart_upload_days = rule.abort_incomplete_multipart_upload_days # number\n\n    # Due to https://github.com/hashicorp/terraform-provider-aws/issues/23882\n    # we have to treat having only the `prefix` set differently than having any other setting.\n    filter_prefix_only = (try(rule.filter_and.object_size_greater_than, null) == null &&\n      try(rule.filter_and.object_size_less_than, null) == null &&\n      try(length(rule.filter_and.tags), 0) == 0 &&\n    try(length(rule.filter_and.prefix), 0) > 0) ? rule.filter_and.prefix : null\n\n    filter_and = (try(rule.filter_and.object_size_greater_than, null) == null &&\n      try(rule.filter_and.object_size_less_than, null) == null &&\n      try(length(rule.filter_and.tags), 0) == 0) ? null : {\n      object_size_greater_than = try(rule.filter_and.object_size_greater_than, null)\n      object_size_less_than    = try(rule.filter_and.object_size_less_than, null)\n      prefix                   = try(length(rule.filter_and.prefix), 0) == 0 ? null : rule.filter_and.prefix\n      tags                     = try(length(rule.filter_and.tags), 0) == 0 ? {} : rule.filter_and.tags\n    }\n    # We use \"!= true\" because it covers !null as well as !false, and allows the \"null\" option to be on the same line.\n    expiration = (try(rule.expiration.date, null) == null &&\n      try(rule.expiration.days, null) == null &&\n      try(rule.expiration.expired_object_delete_marker, null) == null) ? null : {\n      date = try(rule.expiration.date, null)\n      days = try(rule.expiration.days, null)\n\n      expired_object_delete_marker = try(rule.expiration.expired_object_delete_marker, null)\n    }\n    noncurrent_version_expiration = (try(rule.noncurrent_version_expiration.noncurrent_days, null) == null &&\n      try(rule.noncurrent_version_expiration.newer_noncurrent_versions, null) == null) ? null : {\n      newer_noncurrent_versions = try(rule.noncurrent_version_expiration.newer_noncurrent_versions, null)\n      noncurrent_days           = try(rule.noncurrent_version_expiration.noncurrent_days, null)\n    }\n    transition = rule.transition == null ? [] : [for t in rule.transition : {\n      date          = try(t.date, null)\n      days          = try(t.days, null)\n      storage_class = t.storage_class\n    } if try(t.date, null) != null || try(t.days, null) != null]\n    noncurrent_version_transition = rule.noncurrent_version_transition == null ? [] : [\n      for t in rule.noncurrent_version_transition :\n      {\n        newer_noncurrent_versions = try(t.newer_noncurrent_versions, null)\n        noncurrent_days           = try(t.noncurrent_days, null)\n        storage_class             = t.storage_class\n      } if try(t.newer_noncurrent_versions, null) != null || try(t.noncurrent_days, null) != null\n    ]\n  }]\n\n  # Backwards compatibility: translate old `lifecycle_rules` variable to new format\n  lifecycle_rules = var.lifecycle_rules == null ? [] : var.lifecycle_rules\n  normalized_lifecycle_rules = [for i, rule in local.lifecycle_rules : {\n    enabled = rule.enabled\n    id      = try(var.lifecycle_rule_ids[i], \"rule-${i + 1}\")\n\n    abort_incomplete_multipart_upload_days = rule.abort_incomplete_multipart_upload_days # number\n\n    filter_prefix_only = try(length(rule.prefix), 0) > 0 && try(length(rule.tags), 0) == 0 ? rule.prefix : null\n    filter_and = try(length(rule.tags), 0) == 0 ? null : {\n      object_size_greater_than = null                                   # integer >= 0\n      object_size_less_than    = null                                   # integer >= 1\n      prefix                   = rule.prefix == \"\" ? null : rule.prefix # string\n      tags                     = rule.tags == null ? {} : rule.tags     # map(string)\n    }\n    # We use \"!= true\" because it covers !null as well as !false, and allows the \"null\" option to be on the same line.\n    expiration = rule.enable_current_object_expiration != true ? null : {\n      date                         = null                 # string\n      days                         = rule.expiration_days # integer > 0\n      expired_object_delete_marker = null                 # bool\n    }\n    noncurrent_version_expiration = rule.enable_noncurrent_version_expiration != true ? null : {\n      newer_noncurrent_versions = null                                    # integer > 0\n      noncurrent_days           = rule.noncurrent_version_expiration_days # integer >= 0\n    }\n    transition = concat(\n      rule.enable_standard_ia_transition != true ? [] :\n      [{\n        date          = null                          # string\n        days          = rule.standard_transition_days # integer >= 0\n        storage_class = \"STANDARD_IA\"\n      }],\n      rule.enable_glacier_transition != true ? [] :\n      [{\n        date          = null                         # string\n        days          = rule.glacier_transition_days # integer >= 0\n        storage_class = \"GLACIER\"\n      }],\n      rule.enable_deeparchive_transition != true ? [] :\n      [{\n        date          = null                             # string\n        days          = rule.deeparchive_transition_days # integer >= 0\n        storage_class = \"DEEP_ARCHIVE\"\n      }],\n    )\n    noncurrent_version_transition = concat(\n      # In the old `lifecycle_rules` variable, `enable_glacier_transition`\n      # enabled the transition for both current and non-current version.\n      rule.enable_glacier_transition != true ? [] :\n      [{\n        newer_noncurrent_versions = null                                            # integer >= 0\n        noncurrent_days           = rule.noncurrent_version_glacier_transition_days # integer >= 0\n        storage_class             = \"GLACIER\"\n      }],\n      # In the old `lifecycle_rules` variable, `enable_deeparchive_transition`\n      # enabled the transition for both current and non-current version.\n      rule.enable_deeparchive_transition != true ? [] :\n      [{\n        newer_noncurrent_versions = null                                                # integer >= 0\n        noncurrent_days           = rule.noncurrent_version_deeparchive_transition_days # integer >= 0\n        storage_class             = \"DEEP_ARCHIVE\"\n      }],\n    )\n  }]\n\n  lc_rules = concat(local.normalized_lifecycle_rules, local.normalized_lifecycle_configuration_rules)\n}\n\n\nresource \"aws_s3_bucket_lifecycle_configuration\" \"default\" {\n  count  = local.enabled && length(local.lc_rules) > 0 ? 1 : 0\n  bucket = local.bucket_id\n\n  dynamic \"rule\" {\n    for_each = local.lc_rules\n\n    content {\n      id     = rule.value.id\n      status = rule.value.enabled == true ? \"Enabled\" : \"Disabled\"\n\n      # Filter is always required due to https://github.com/hashicorp/terraform-provider-aws/issues/23299\n      dynamic \"filter\" {\n        for_each = rule.value.filter_prefix_only == null && rule.value.filter_and == null ? [\"empty\"] : []\n        content {}\n      }\n\n      # When only specifying `prefix`, do not use `and` due to https://github.com/hashicorp/terraform-provider-aws/issues/23882\n      dynamic \"filter\" {\n        for_each = rule.value.filter_prefix_only == null ? [] : [\"prefix\"]\n        content {\n          prefix = rule.value.filter_prefix_only\n        }\n      }\n\n      # When specifying more than 1 filter criterion, use `and`\n      dynamic \"filter\" {\n        for_each = rule.value.filter_and == null ? [] : [\"and\"]\n        content {\n          and {\n            object_size_greater_than = rule.value.filter_and.object_size_greater_than\n            object_size_less_than    = rule.value.filter_and.object_size_less_than\n            prefix                   = rule.value.filter_and.prefix\n            tags                     = rule.value.filter_and.tags\n          }\n        }\n      }\n\n      dynamic \"abort_incomplete_multipart_upload\" {\n        for_each = rule.value.abort_incomplete_multipart_upload_days == null ? [] : [1]\n        content {\n          days_after_initiation = rule.value.abort_incomplete_multipart_upload_days\n        }\n      }\n\n      dynamic \"expiration\" {\n        for_each = rule.value.expiration == null ? [] : [rule.value.expiration]\n        content {\n          date                         = expiration.value.date\n          days                         = expiration.value.days\n          expired_object_delete_marker = expiration.value.expired_object_delete_marker\n        }\n      }\n\n      dynamic \"noncurrent_version_expiration\" {\n        for_each = rule.value.noncurrent_version_expiration == null ? [] : [rule.value.noncurrent_version_expiration]\n        iterator = expiration\n        content {\n          newer_noncurrent_versions = expiration.value.newer_noncurrent_versions\n          noncurrent_days           = expiration.value.noncurrent_days\n        }\n      }\n\n      dynamic \"transition\" {\n        for_each = rule.value.transition\n\n        content {\n          date          = transition.value.date\n          days          = transition.value.days\n          storage_class = transition.value.storage_class\n        }\n      }\n\n      dynamic \"noncurrent_version_transition\" {\n        for_each = rule.value.noncurrent_version_transition\n        iterator = transition\n        content {\n          newer_noncurrent_versions = transition.value.newer_noncurrent_versions\n          noncurrent_days           = transition.value.noncurrent_days\n          storage_class             = transition.value.storage_class\n        }\n      }\n    }\n  }\n\n  depends_on = [\n    # versioning must be set before lifecycle configuration\n    aws_s3_bucket_versioning.default\n  ]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-s3-bucket__lifecycle.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_300", "severity": "HIGH", "message": "Ensure S3 lifecycle configuration sets period for aborting failed uploads", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-s3-bucket__lifecycle.tf", "start_line": 159}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_ecs_cluster\" \"test-cluster\" {\n  name = \"myapp-cluster\"\n}\n\ndata \"template_file\" \"testapp\" {\n  template = file(\"./templates/image/image.json\")\n\n  vars = {\n    app_image      = var.app_image\n    app_port       = var.app_port\n    fargate_cpu    = var.fargate_cpu\n    fargate_memory = var.fargate_memory\n    aws_region     = var.aws_region\n  }\n}\n\nresource \"aws_ecs_task_definition\" \"test-def\" {\n  family                   = \"testapp-task\"\n  execution_role_arn       = aws_iam_role.ecs_task_execution_role.arn\n  network_mode             = \"awsvpc\"\n  requires_compatibilities = [\"FARGATE\"]\n  cpu                      = var.fargate_cpu\n  memory                   = var.fargate_memory\n  container_definitions    = data.template_file.testapp.rendered\n}\n\nresource \"aws_ecs_service\" \"test-service\" {\n  name            = \"testapp-service\"\n  cluster         = aws_ecs_cluster.test-cluster.id\n  task_definition = aws_ecs_task_definition.test-def.arn\n  desired_count   = var.app_count\n  launch_type     = \"FARGATE\"\n\n  network_configuration {\n    security_groups  = [aws_security_group.ecs_sg.id]\n    subnets          = aws_subnet.private.*.id\n    assign_public_ip = true\n  }\n\n  load_balancer {\n    target_group_arn = aws_alb_target_group.myapp-tg.arn\n    container_name   = \"testapp\"\n    container_port   = var.app_port\n  }\n\n  depends_on = [aws_alb_listener.testapp, aws_iam_role_policy_attachment.ecs_task_execution_role]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__ecs.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_65", "severity": "HIGH", "message": "Ensure container insights are enabled on ECS cluster", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__ecs.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_333", "severity": "HIGH", "message": "Ensure ECS services do not have public IP addresses assigned to them automatically", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__ecs.tf", "start_line": 27}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"layer\" {\n    type = string\n    default = \"dev\"\n  \n}\n\nvariable \"env\" {\n    type = string\n    default = \"test\"\n  \n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-10-meta_arguments_locals__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"helloworld\" {\n  ami           = \"ami-09dd2e08d601bff67\"\n  instance_type = \"t2.micro\"\n  tags = {\n    Name = \"HelloWorld\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter1__listing1.1__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter1__listing1.1__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter1__listing1.1__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter1__listing1.1__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter1__listing1.1__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter1__listing1.1__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource aws_s3_bucket \"test-bucket\" {\n  name = \"test-bucket\"\n}\n\nresource tls_private_key \"pem\" {\n  algorithm = \"some-algo\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__terraform__mixed__mixed.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__terraform__mixed__mixed.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__terraform__mixed__mixed.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__terraform__mixed__mixed.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__terraform__mixed__mixed.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__terraform__mixed__mixed.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__terraform__mixed__mixed.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bridgecrewio__yor__tests__terraform__mixed__mixed.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_policy\" \"privesc-AssumeRole-high-priv-policy\" {\n  name        = \"privesc-AssumeRole-high-priv-policy\"\n  path        = \"/\"\n  description = \"Allows privesc via targeted sts:AssumeRole\"\n\n  # Terraform's \"jsonencode\" function converts a\n  # Terraform expression result to valid JSON syntax.\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect   = \"Allow\"\n        Action = \"*\"\n        Resource = \"*\"\n      },\n    ]\n  })\n}\n\nresource \"aws_iam_role\" \"privesc-AssumeRole-starting-role\" {\n  name                = \"privesc-AssumeRole-starting-role\"\n  assume_role_policy  = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Sid    = \"\"\n        Principal = {\n          AWS = var.aws_assume_role_arn\n        }\n      },\n    ]\n  })\n}\n\nresource \"aws_iam_role\" \"privesc-AssumeRole-intermediate-role\" {\n  name                = \"privesc-AssumeRole-intermediate-role\"\n  assume_role_policy  = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Sid    = \"\"\n        Principal = {\n          AWS = aws_iam_role.privesc-AssumeRole-starting-role.arn\n        }\n      },\n    ]\n  })\n}\n\n\nresource \"aws_iam_role\" \"privesc-AssumeRole-ending-role\" {\n  name                = \"privesc-AssumeRole-ending-role\"\n  assume_role_policy  = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Sid    = \"\"\n        Principal = {\n          AWS = aws_iam_role.privesc-AssumeRole-intermediate-role.arn\n        }\n      },\n    ]\n  })\n}\n\n\n\nresource \"aws_iam_user\" \"privesc-AssumeRole-start-user\" {\n  name = \"privesc-AssumeRole-start-user\"\n  path = \"/\"\n}\nresource \"aws_iam_access_key\" \"privesc-AssumeRole-start-user\" {\n  user = aws_iam_user.privesc-AssumeRole-start-user.name\n}\nresource \"aws_iam_role_policy_attachment\" \"privesc-AssumeRole-high-priv-policy-role-attach-policy\" {\n  role       = aws_iam_role.privesc-AssumeRole-ending-role.name\n  policy_arn = aws_iam_policy.privesc-AssumeRole-high-priv-policy.arn\n\n}  ", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-AssumeRole.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_62", "severity": "HIGH", "message": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-AssumeRole.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_287", "severity": "HIGH", "message": "Ensure IAM policies does not allow credentials exposure", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-AssumeRole.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_288", "severity": "HIGH", "message": "Ensure IAM policies does not allow data exfiltration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-AssumeRole.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_289", "severity": "HIGH", "message": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-AssumeRole.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_286", "severity": "HIGH", "message": "Ensure IAM policies does not allow privilege escalation", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-AssumeRole.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_63", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-AssumeRole.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-AssumeRole.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-AssumeRole.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-AssumeRole.tf", "start_line": 74}, {"tool": "checkov", "rule_id": "CKV2_AWS_40", "severity": "CRITICAL", "message": "Ensure AWS IAM policy does not allow full IAM privileges", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-AssumeRole.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"local_file\" \"cluster_bootstrap_state\" {\n  filename = \"${path.module}/cluster_bootstrap_state\"\n}\n\ndata \"template_file\" \"master_userdata_script\" {\n  template = file(\"${path.module}/../templates/aws_user_data.sh\")\n  vars = merge(local.user_data_common, {\n    startup_script = \"master.sh\",\n    heap_size = var.master_heap_size\n  })\n}\n\ndata \"template_file\" \"bootstrap_userdata_script\" {\n  template = file(\"${path.module}/../templates/aws_user_data.sh\")\n  vars = merge(local.user_data_common, {\n    startup_script = \"bootstrap.sh\",\n    heap_size = var.master_heap_size\n  })\n}\n\nresource \"aws_launch_template\" \"master\" {\n  name_prefix   = \"elasticsearch-${var.es_cluster}-master-nodes\"\n  image_id      = data.aws_ami.elasticsearch.id\n  instance_type = var.master_instance_type\n  user_data     = base64encode(data.template_file.master_userdata_script.rendered)\n  key_name      = var.key_name\n\n  iam_instance_profile {\n    arn = aws_iam_instance_profile.elasticsearch.arn\n  }\n\n  network_interfaces {\n    delete_on_termination       = true\n    associate_public_ip_address = false\n    security_groups = concat(\n      [aws_security_group.elasticsearch_security_group.id],\n      var.additional_security_groups,\n    )\n  }\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n\nresource \"aws_autoscaling_group\" \"master_nodes\" {\n  count = length(keys(var.masters_count))\n\n  name               = \"elasticsearch-${var.es_cluster}-master-nodes-${keys(var.masters_count)[count.index]}\"\n  max_size           = var.masters_count[keys(var.masters_count)[count.index]]\n  min_size           = var.masters_count[keys(var.masters_count)[count.index]]\n  desired_capacity   = var.masters_count[keys(var.masters_count)[count.index]]\n  default_cooldown   = 30\n  force_delete       = true\n\n  vpc_zone_identifier = local.cluster_subnet_ids[keys(var.masters_count)[count.index]]\n\n  launch_template {\n    id      = aws_launch_template.master.id\n    version = \"$Latest\"\n  }\n\n  tag {\n    key                 = \"Name\"\n    value               = format(\"%s-master-node\", var.es_cluster)\n    propagate_at_launch = true\n  }\n\n  tag {\n    key                 = \"Environment\"\n    value               = var.environment\n    propagate_at_launch = true\n  }\n\n  tag {\n    key                 = \"Cluster\"\n    value               = \"${var.environment}-${var.es_cluster}\"\n    propagate_at_launch = true\n  }\n\n  tag {\n    key                 = \"Role\"\n    value               = \"master\"\n    propagate_at_launch = true\n  }\n\n  lifecycle {\n    create_before_destroy = true\n  }\n\n  depends_on = [aws_ebs_volume.master]\n}\n\nresource \"aws_instance\" \"bootstrap_node\" {\n  count = local.singlenode_mode || local.is_cluster_bootstrapped ? 0 : 1\n\n  ami                                  = data.aws_ami.elasticsearch.id\n  instance_type                        = var.master_instance_type\n  instance_initiated_shutdown_behavior = \"terminate\"\n\n  vpc_security_group_ids = concat(\n    [aws_security_group.elasticsearch_security_group.id],\n    var.additional_security_groups,\n  )\n  iam_instance_profile = aws_iam_instance_profile.elasticsearch.id\n  user_data            = data.template_file.bootstrap_userdata_script.rendered\n  key_name             = var.key_name\n  subnet_id            = local.bootstrap_node_subnet_id\n\n  associate_public_ip_address = false\n\n  tags = {\n    Name        = \"${var.es_cluster}-bootstrap-node\"\n    Environment = var.environment\n    Cluster     = \"${var.environment}-${var.es_cluster}\"\n    Role        = \"bootstrap\"\n  }\n}\n\nresource \"null_resource\" \"cluster_bootstrap_state\" {\n  provisioner \"local-exec\" {\n    command = \"printf 1 > ${path.module}/cluster_bootstrap_state\"\n  }\n  provisioner \"local-exec\" {\n    when    = destroy\n    command = \"printf 0 > ${path.module}/cluster_bootstrap_state\"\n  }\n\n  depends_on = [aws_instance.bootstrap_node]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__masters.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__masters.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__masters.tf", "start_line": 94}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__masters.tf", "start_line": 94}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__masters.tf", "start_line": 94}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__masters.tf", "start_line": 94}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nvariable \"ami\" {\n  description = \"value\"\n}\n\nvariable \"instance_type\" {\n  description = \"value\"\n  type = map(string)\n\n  default = {\n    \"dev\" = \"t2.micro\"\n    \"stage\" = \"t2.medium\"\n    \"prod\" = \"t2.xlarge\"\n  }\n}\n\nmodule \"ec2_instance\" {\n  source = \"./modules/ec2_instance\"\n  ami = var.ami\n  instance_type = lookup(var.instance_type, terraform.workspace, \"t2.micro\")\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-6__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-2\"\n}\nmodule \"app-platzi\" {\n\tsource = \"github.com/muchikon/modulos-remotos/instance\"\n\tami_id = var.ami_id\n\tinstance_type = var.instance_type\n\ttags = var.tags\n\tsg_name = var.sg_name\n\tingress_rules = var.ingress_rules\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__modulos-remotos__app.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__modulos-remotos__app.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__modulos-remotos__app.tf", "start_line": 4}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"cloudflare_access_rule\" \"example_access_rule\" {\n  rule_id = \"023e105f4ecef8ad9ca31a8372d0c353\"\n  account_id = \"account_id\"\n  zone_id = \"zone_id\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudflare__terraform-provider-cloudflare__examples__data-sources__cloudflare_access_rule__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Query the client configuration for our current service account, which should\n# have permission to talk to the GKE cluster since it created it.\ndata \"google_client_config\" \"current\" {}\n\n# This file contains all the interactions with Kubernetes\nprovider \"kubernetes\" {\n  host = google_container_cluster.vault.endpoint\n\n  cluster_ca_certificate = base64decode(\n    google_container_cluster.vault.master_auth[0].cluster_ca_certificate,\n  )\n  token = data.google_client_config.current.access_token\n}\n\n# Write the secret\nresource \"kubernetes_secret\" \"vault-tls\" {\n  metadata {\n    name = \"vault-tls\"\n  }\n\n  data = {\n    \"vault.crt\" = \"${tls_locally_signed_cert.vault.cert_pem}\\n${tls_self_signed_cert.vault-ca.cert_pem}\"\n    \"vault.key\" = tls_private_key.vault.private_key_pem\n    \"ca.crt\"    = tls_self_signed_cert.vault-ca.cert_pem\n  }\n}\n\nresource \"kubernetes_service_account\" \"vault-server\" {\n  metadata {\n    name = \"vault-server\"\n  }\n}\n\nresource \"kubernetes_role\" \"vault-server\" {\n  metadata {\n    name = \"vault-server\"\n  }\n\n  rule {\n    api_groups     = [\"\"]\n    resources      = [\"pods\"]\n    resource_names = [for i in range(var.num_vault_pods) : \"vault-${i}\"]\n    verbs          = [\"get\", \"patch\", \"update\"]\n  }\n}\n\nresource \"kubernetes_role_binding\" \"vault-server\" {\n  metadata {\n    name = \"vault-server\"\n  }\n\n  role_ref {\n    api_group = \"rbac.authorization.k8s.io\"\n    kind      = \"Role\"\n    name      = kubernetes_role.vault-server.metadata.0.name\n  }\n\n  subject {\n    kind      = \"ServiceAccount\"\n    name      = kubernetes_service_account.vault-server.metadata.0.name\n    namespace = kubernetes_service_account.vault-server.metadata.0.namespace\n  }\n}\n\nresource \"kubernetes_service\" \"vault-lb\" {\n  metadata {\n    name = \"vault\"\n    labels = {\n      app = \"vault\"\n    }\n  }\n\n  spec {\n    type                        = \"LoadBalancer\"\n    load_balancer_ip            = google_compute_address.vault.address\n    load_balancer_source_ranges = var.vault_source_ranges\n    external_traffic_policy     = \"Local\"\n\n    selector = {\n      app          = \"vault\"\n      vault-active = \"true\"\n    }\n\n    port {\n      name        = \"vault-port\"\n      port        = 443\n      target_port = 8200\n      protocol    = \"TCP\"\n    }\n  }\n}\n\nresource \"kubernetes_stateful_set\" \"vault\" {\n  metadata {\n    name = \"vault\"\n    labels = {\n      app = \"vault\"\n    }\n  }\n\n  spec {\n    service_name = \"vault\"\n    replicas     = var.num_vault_pods\n\n    selector {\n      match_labels = {\n        app = \"vault\"\n      }\n    }\n\n    template {\n      metadata {\n        labels = {\n          app = \"vault\"\n        }\n      }\n\n      spec {\n        service_account_name = kubernetes_service_account.vault-server.metadata.0.name\n\n        termination_grace_period_seconds = 10\n\n        affinity {\n          pod_anti_affinity {\n            preferred_during_scheduling_ignored_during_execution {\n              weight = 50\n\n              pod_affinity_term {\n                topology_key = \"kubernetes.io/hostname\"\n\n                label_selector {\n                  match_expressions {\n                    key      = \"app\"\n                    operator = \"In\"\n                    values   = [\"vault\"]\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        container {\n          name              = \"vault-init\"\n          image             = var.vault_init_container\n          image_pull_policy = \"IfNotPresent\"\n\n          resources {\n            requests = {\n              cpu    = \"100m\"\n              memory = \"64Mi\"\n            }\n          }\n\n          env {\n            name  = \"GCS_BUCKET_NAME\"\n            value = google_storage_bucket.vault.name\n          }\n\n          env {\n            name  = \"KMS_KEY_ID\"\n            value = google_kms_crypto_key.vault-init.self_link\n          }\n\n          env {\n            name  = \"VAULT_ADDR\"\n            value = \"http://127.0.0.1:8200\"\n          }\n\n          env {\n            name  = \"VAULT_RECOVERY_SHARES\"\n            value = var.vault_recovery_shares\n          }\n\n          env {\n            name  = \"VAULT_RECOVERY_THRESHOLD\"\n            value = var.vault_recovery_threshold\n          }\n        }\n\n        container {\n          name              = \"vault\"\n          image             = var.vault_container\n          image_pull_policy = \"IfNotPresent\"\n\n          args = [\"server\"]\n\n          security_context {\n            capabilities {\n              add = [\"IPC_LOCK\"]\n            }\n          }\n\n          port {\n            name           = \"vault-port\"\n            container_port = 8200\n            protocol       = \"TCP\"\n          }\n\n          port {\n            name           = \"cluster-port\"\n            container_port = 8201\n            protocol       = \"TCP\"\n          }\n\n          resources {\n            requests = {\n              cpu    = \"500m\"\n              memory = \"256Mi\"\n            }\n          }\n\n          volume_mount {\n            name       = \"vault-tls\"\n            mount_path = \"/etc/vault/tls\"\n          }\n\n          env {\n            name  = \"VAULT_ADDR\"\n            value = \"http://127.0.0.1:8200\"\n          }\n\n          env {\n            name = \"POD_IP_ADDR\"\n            value_from {\n              field_ref {\n                field_path = \"status.podIP\"\n              }\n            }\n          }\n\n          env {\n            name = \"VAULT_K8S_POD_NAME\"\n            value_from {\n              field_ref {\n                api_version = \"v1\"\n                field_path  = \"metadata.name\"\n              }\n            }\n          }\n\n          env {\n            name = \"VAULT_K8S_NAMESPACE\"\n            value_from {\n              field_ref {\n                api_version = \"v1\"\n                field_path  = \"metadata.namespace\"\n              }\n            }\n          }\n\n          env {\n            name  = \"VAULT_LOCAL_CONFIG\"\n            value = <<EOF\n              api_addr     = \"https://${google_compute_address.vault.address}\"\n              cluster_addr = \"https://$(POD_IP_ADDR):8201\"\n\n              service_registration \"kubernetes\" {}\n\n              log_level = \"warn\"\n\n              ui = true\n\n              seal \"gcpckms\" {\n                project    = \"${google_kms_key_ring.vault.project}\"\n                region     = \"${google_kms_key_ring.vault.location}\"\n                key_ring   = \"${google_kms_key_ring.vault.name}\"\n                crypto_key = \"${google_kms_crypto_key.vault-init.name}\"\n              }\n\n              storage \"gcs\" {\n                bucket     = \"${google_storage_bucket.vault.name}\"\n                ha_enabled = \"true\"\n              }\n\n              listener \"tcp\" {\n                address     = \"127.0.0.1:8200\"\n                tls_disable = \"true\"\n              }\n\n              listener \"tcp\" {\n                address       = \"$(POD_IP_ADDR):8200\"\n                tls_cert_file = \"/etc/vault/tls/vault.crt\"\n                tls_key_file  = \"/etc/vault/tls/vault.key\"\n\n                tls_disable_client_certs = true\n              }\n            EOF\n          }\n\n          readiness_probe {\n            initial_delay_seconds = 5\n            period_seconds        = 5\n\n            http_get {\n              path   = \"/v1/sys/health?standbyok=true\"\n              port   = 8200\n              scheme = \"HTTPS\"\n            }\n          }\n        }\n\n        volume {\n          name = \"vault-tls\"\n          secret {\n            secret_name = \"vault-tls\"\n          }\n        }\n      }\n    }\n  }\n}\n\noutput \"root_token_decrypt_command\" {\n  value = \"gsutil cat gs://${google_storage_bucket.vault.name}/root-token.enc | base64 --decode | gcloud kms decrypt --key ${google_kms_crypto_key.vault-init.self_link} --ciphertext-file - --plaintext-file -\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__k8s.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_K8S_21", "severity": "HIGH", "message": "The default namespace should not be used", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__k8s.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_K8S_21", "severity": "HIGH", "message": "The default namespace should not be used", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__k8s.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_K8S_21", "severity": "HIGH", "message": "The default namespace should not be used", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__k8s.tf", "start_line": 47}, {"tool": "checkov", "rule_id": "CKV_K8S_21", "severity": "HIGH", "message": "The default namespace should not be used", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__k8s.tf", "start_line": 65}, {"tool": "checkov", "rule_id": "CKV_K8S_21", "severity": "HIGH", "message": "The default namespace should not be used", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__k8s.tf", "start_line": 93}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# The following example shows how to generate a unique pet name\n# for an AWS EC2 instance that changes each time a new AMI id is\n# selected.\n\nresource \"random_pet\" \"server\" {\n  keepers = {\n    # Generate a new pet name each time we switch to a new AMI id\n    ami_id = var.ami_id\n  }\n}\n\nresource \"aws_instance\" \"server\" {\n  tags = {\n    Name = \"web-server-${random_pet.server.id}\"\n  }\n\n  # Read the AMI id \"through\" the random_pet resource to ensure that\n  # both will change together.\n  ami = random_pet.server.keepers.ami_id\n\n  # ... (other aws_instance arguments) ...\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_pet__resource.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_pet__resource.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_pet__resource.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_pet__resource.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_pet__resource.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_pet__resource.tf", "start_line": 12}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  project_id       = \"devopsbyexample-325402\"\n  network          = \"default\"\n  image            = \"ubuntu-2004-focal-v20211212\"\n  ssh_user         = \"ansible\"\n  private_key_path = \"~/.ssh/ansbile_ed25519\"\n\n  web_servers = {\n    nginx-000-staging = {\n      machine_type = \"e2-micro\"\n      zone         = \"us-central1-a\"\n    }\n    nginx-001-staging = {\n      machine_type = \"e2-micro\"\n      zone         = \"us-central1-b\"\n    }\n  }\n}\n\nprovider \"google\" {\n  project = local.project_id\n  region  = \"us-central1\"\n}\n\nresource \"google_service_account\" \"nginx\" {\n  account_id = \"nginx-demo\"\n}\n\nresource \"google_compute_firewall\" \"web\" {\n  name    = \"web-access\"\n  network = local.network\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"80\"]\n  }\n\n  source_ranges           = [\"0.0.0.0/0\"]\n  target_service_accounts = [google_service_account.nginx.email]\n}\n\nresource \"google_compute_instance\" \"nginx\" {\n  for_each = local.web_servers\n\n  name         = each.key\n  machine_type = each.value.machine_type\n  zone         = each.value.zone\n\n  boot_disk {\n    initialize_params {\n      image = local.image\n    }\n  }\n\n  network_interface {\n    network = local.network\n    access_config {}\n  }\n\n  service_account {\n    email  = google_service_account.nginx.email\n    scopes = [\"cloud-platform\"]\n  }\n\n  provisioner \"remote-exec\" {\n    inline = [\"echo 'Wait until SSH is ready'\"]\n\n    connection {\n      type        = \"ssh\"\n      user        = local.ssh_user\n      private_key = file(local.private_key_path)\n      host        = self.network_interface.0.access_config.0.nat_ip\n    }\n  }\n\n  provisioner \"local-exec\" {\n    command = \"ansible-playbook  -i ${self.network_interface.0.access_config.0.nat_ip}, --private-key ${local.private_key_path} nginx.yaml\"\n  }\n}\n\noutput \"nginx_ips\" {\n  value = {\n    for k, v in google_compute_instance.nginx : k => \"http://${v.network_interface.0.access_config.0.nat_ip}\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__101__2-example.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_106", "severity": "HIGH", "message": "Ensure Google compute firewall ingress does not allow unrestricted http port 80 access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__101__2-example.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__101__2-example.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__101__2-example.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__101__2-example.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__101__2-example.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__101__2-example.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__101__2-example.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__101__2-example.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__101__2-example.tf", "start_line": 42}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"wrapper\" {\n  source = \"../\"\n\n  for_each = var.items\n\n  allocated_storage                                      = try(each.value.allocated_storage, var.defaults.allocated_storage, null)\n  allow_major_version_upgrade                            = try(each.value.allow_major_version_upgrade, var.defaults.allow_major_version_upgrade, false)\n  apply_immediately                                      = try(each.value.apply_immediately, var.defaults.apply_immediately, false)\n  auto_minor_version_upgrade                             = try(each.value.auto_minor_version_upgrade, var.defaults.auto_minor_version_upgrade, true)\n  availability_zone                                      = try(each.value.availability_zone, var.defaults.availability_zone, null)\n  backup_retention_period                                = try(each.value.backup_retention_period, var.defaults.backup_retention_period, null)\n  backup_window                                          = try(each.value.backup_window, var.defaults.backup_window, null)\n  blue_green_update                                      = try(each.value.blue_green_update, var.defaults.blue_green_update, {})\n  ca_cert_identifier                                     = try(each.value.ca_cert_identifier, var.defaults.ca_cert_identifier, null)\n  character_set_name                                     = try(each.value.character_set_name, var.defaults.character_set_name, null)\n  cloudwatch_log_group_class                             = try(each.value.cloudwatch_log_group_class, var.defaults.cloudwatch_log_group_class, null)\n  cloudwatch_log_group_kms_key_id                        = try(each.value.cloudwatch_log_group_kms_key_id, var.defaults.cloudwatch_log_group_kms_key_id, null)\n  cloudwatch_log_group_retention_in_days                 = try(each.value.cloudwatch_log_group_retention_in_days, var.defaults.cloudwatch_log_group_retention_in_days, 7)\n  cloudwatch_log_group_skip_destroy                      = try(each.value.cloudwatch_log_group_skip_destroy, var.defaults.cloudwatch_log_group_skip_destroy, null)\n  cloudwatch_log_group_tags                              = try(each.value.cloudwatch_log_group_tags, var.defaults.cloudwatch_log_group_tags, {})\n  copy_tags_to_snapshot                                  = try(each.value.copy_tags_to_snapshot, var.defaults.copy_tags_to_snapshot, false)\n  create_cloudwatch_log_group                            = try(each.value.create_cloudwatch_log_group, var.defaults.create_cloudwatch_log_group, false)\n  create_db_instance                                     = try(each.value.create_db_instance, var.defaults.create_db_instance, true)\n  create_db_option_group                                 = try(each.value.create_db_option_group, var.defaults.create_db_option_group, true)\n  create_db_parameter_group                              = try(each.value.create_db_parameter_group, var.defaults.create_db_parameter_group, true)\n  create_db_subnet_group                                 = try(each.value.create_db_subnet_group, var.defaults.create_db_subnet_group, false)\n  create_monitoring_role                                 = try(each.value.create_monitoring_role, var.defaults.create_monitoring_role, false)\n  custom_iam_instance_profile                            = try(each.value.custom_iam_instance_profile, var.defaults.custom_iam_instance_profile, null)\n  database_insights_mode                                 = try(each.value.database_insights_mode, var.defaults.database_insights_mode, null)\n  db_instance_role_associations                          = try(each.value.db_instance_role_associations, var.defaults.db_instance_role_associations, {})\n  db_instance_tags                                       = try(each.value.db_instance_tags, var.defaults.db_instance_tags, {})\n  db_name                                                = try(each.value.db_name, var.defaults.db_name, null)\n  db_option_group_tags                                   = try(each.value.db_option_group_tags, var.defaults.db_option_group_tags, {})\n  db_parameter_group_tags                                = try(each.value.db_parameter_group_tags, var.defaults.db_parameter_group_tags, {})\n  db_subnet_group_description                            = try(each.value.db_subnet_group_description, var.defaults.db_subnet_group_description, null)\n  db_subnet_group_name                                   = try(each.value.db_subnet_group_name, var.defaults.db_subnet_group_name, null)\n  db_subnet_group_tags                                   = try(each.value.db_subnet_group_tags, var.defaults.db_subnet_group_tags, {})\n  db_subnet_group_use_name_prefix                        = try(each.value.db_subnet_group_use_name_prefix, var.defaults.db_subnet_group_use_name_prefix, true)\n  dedicated_log_volume                                   = try(each.value.dedicated_log_volume, var.defaults.dedicated_log_volume, false)\n  delete_automated_backups                               = try(each.value.delete_automated_backups, var.defaults.delete_automated_backups, true)\n  deletion_protection                                    = try(each.value.deletion_protection, var.defaults.deletion_protection, false)\n  domain                                                 = try(each.value.domain, var.defaults.domain, null)\n  domain_auth_secret_arn                                 = try(each.value.domain_auth_secret_arn, var.defaults.domain_auth_secret_arn, null)\n  domain_dns_ips                                         = try(each.value.domain_dns_ips, var.defaults.domain_dns_ips, null)\n  domain_fqdn                                            = try(each.value.domain_fqdn, var.defaults.domain_fqdn, null)\n  domain_iam_role_name                                   = try(each.value.domain_iam_role_name, var.defaults.domain_iam_role_name, null)\n  domain_ou                                              = try(each.value.domain_ou, var.defaults.domain_ou, null)\n  enabled_cloudwatch_logs_exports                        = try(each.value.enabled_cloudwatch_logs_exports, var.defaults.enabled_cloudwatch_logs_exports, [])\n  engine                                                 = try(each.value.engine, var.defaults.engine, null)\n  engine_lifecycle_support                               = try(each.value.engine_lifecycle_support, var.defaults.engine_lifecycle_support, null)\n  engine_version                                         = try(each.value.engine_version, var.defaults.engine_version, null)\n  family                                                 = try(each.value.family, var.defaults.family, null)\n  final_snapshot_identifier_prefix                       = try(each.value.final_snapshot_identifier_prefix, var.defaults.final_snapshot_identifier_prefix, \"final\")\n  iam_database_authentication_enabled                    = try(each.value.iam_database_authentication_enabled, var.defaults.iam_database_authentication_enabled, false)\n  identifier                                             = try(each.value.identifier, var.defaults.identifier)\n  instance_class                                         = try(each.value.instance_class, var.defaults.instance_class, null)\n  instance_use_identifier_prefix                         = try(each.value.instance_use_identifier_prefix, var.defaults.instance_use_identifier_prefix, false)\n  iops                                                   = try(each.value.iops, var.defaults.iops, null)\n  kms_key_id                                             = try(each.value.kms_key_id, var.defaults.kms_key_id, null)\n  license_model                                          = try(each.value.license_model, var.defaults.license_model, null)\n  maintenance_window                                     = try(each.value.maintenance_window, var.defaults.maintenance_window, null)\n  major_engine_version                                   = try(each.value.major_engine_version, var.defaults.major_engine_version, null)\n  manage_master_user_password                            = try(each.value.manage_master_user_password, var.defaults.manage_master_user_password, true)\n  manage_master_user_password_rotation                   = try(each.value.manage_master_user_password_rotation, var.defaults.manage_master_user_password_rotation, false)\n  master_user_password_rotate_immediately                = try(each.value.master_user_password_rotate_immediately, var.defaults.master_user_password_rotate_immediately, null)\n  master_user_password_rotation_automatically_after_days = try(each.value.master_user_password_rotation_automatically_after_days, var.defaults.master_user_password_rotation_automatically_after_days, null)\n  master_user_password_rotation_duration                 = try(each.value.master_user_password_rotation_duration, var.defaults.master_user_password_rotation_duration, null)\n  master_user_password_rotation_schedule_expression      = try(each.value.master_user_password_rotation_schedule_expression, var.defaults.master_user_password_rotation_schedule_expression, null)\n  master_user_secret_kms_key_id                          = try(each.value.master_user_secret_kms_key_id, var.defaults.master_user_secret_kms_key_id, null)\n  max_allocated_storage                                  = try(each.value.max_allocated_storage, var.defaults.max_allocated_storage, 0)\n  monitoring_interval                                    = try(each.value.monitoring_interval, var.defaults.monitoring_interval, 0)\n  monitoring_role_arn                                    = try(each.value.monitoring_role_arn, var.defaults.monitoring_role_arn, null)\n  monitoring_role_description                            = try(each.value.monitoring_role_description, var.defaults.monitoring_role_description, null)\n  monitoring_role_name                                   = try(each.value.monitoring_role_name, var.defaults.monitoring_role_name, \"rds-monitoring-role\")\n  monitoring_role_permissions_boundary                   = try(each.value.monitoring_role_permissions_boundary, var.defaults.monitoring_role_permissions_boundary, null)\n  monitoring_role_use_name_prefix                        = try(each.value.monitoring_role_use_name_prefix, var.defaults.monitoring_role_use_name_prefix, false)\n  multi_az                                               = try(each.value.multi_az, var.defaults.multi_az, false)\n  nchar_character_set_name                               = try(each.value.nchar_character_set_name, var.defaults.nchar_character_set_name, null)\n  network_type                                           = try(each.value.network_type, var.defaults.network_type, null)\n  option_group_description                               = try(each.value.option_group_description, var.defaults.option_group_description, null)\n  option_group_name                                      = try(each.value.option_group_name, var.defaults.option_group_name, null)\n  option_group_skip_destroy                              = try(each.value.option_group_skip_destroy, var.defaults.option_group_skip_destroy, null)\n  option_group_timeouts                                  = try(each.value.option_group_timeouts, var.defaults.option_group_timeouts, {})\n  option_group_use_name_prefix                           = try(each.value.option_group_use_name_prefix, var.defaults.option_group_use_name_prefix, true)\n  options                                                = try(each.value.options, var.defaults.options, [])\n  parameter_group_description                            = try(each.value.parameter_group_description, var.defaults.parameter_group_description, null)\n  parameter_group_name                                   = try(each.value.parameter_group_name, var.defaults.parameter_group_name, null)\n  parameter_group_skip_destroy                           = try(each.value.parameter_group_skip_destroy, var.defaults.parameter_group_skip_destroy, null)\n  parameter_group_use_name_prefix                        = try(each.value.parameter_group_use_name_prefix, var.defaults.parameter_group_use_name_prefix, true)\n  parameters                                             = try(each.value.parameters, var.defaults.parameters, [])\n  password                                               = try(each.value.password, var.defaults.password, null)\n  performance_insights_enabled                           = try(each.value.performance_insights_enabled, var.defaults.performance_insights_enabled, false)\n  performance_insights_kms_key_id                        = try(each.value.performance_insights_kms_key_id, var.defaults.performance_insights_kms_key_id, null)\n  performance_insights_retention_period                  = try(each.value.performance_insights_retention_period, var.defaults.performance_insights_retention_period, 7)\n  port                                                   = try(each.value.port, var.defaults.port, null)\n  publicly_accessible                                    = try(each.value.publicly_accessible, var.defaults.publicly_accessible, false)\n  putin_khuylo                                           = try(each.value.putin_khuylo, var.defaults.putin_khuylo, true)\n  replica_mode                                           = try(each.value.replica_mode, var.defaults.replica_mode, null)\n  replicate_source_db                                    = try(each.value.replicate_source_db, var.defaults.replicate_source_db, null)\n  restore_to_point_in_time                               = try(each.value.restore_to_point_in_time, var.defaults.restore_to_point_in_time, null)\n  s3_import                                              = try(each.value.s3_import, var.defaults.s3_import, null)\n  skip_final_snapshot                                    = try(each.value.skip_final_snapshot, var.defaults.skip_final_snapshot, false)\n  snapshot_identifier                                    = try(each.value.snapshot_identifier, var.defaults.snapshot_identifier, null)\n  storage_encrypted                                      = try(each.value.storage_encrypted, var.defaults.storage_encrypted, true)\n  storage_throughput                                     = try(each.value.storage_throughput, var.defaults.storage_throughput, null)\n  storage_type                                           = try(each.value.storage_type, var.defaults.storage_type, null)\n  subnet_ids                                             = try(each.value.subnet_ids, var.defaults.subnet_ids, [])\n  tags                                                   = try(each.value.tags, var.defaults.tags, {})\n  timeouts                                               = try(each.value.timeouts, var.defaults.timeouts, {})\n  timezone                                               = try(each.value.timezone, var.defaults.timezone, null)\n  upgrade_storage_config                                 = try(each.value.upgrade_storage_config, var.defaults.upgrade_storage_config, null)\n  username                                               = try(each.value.username, var.defaults.username, null)\n  vpc_security_group_ids                                 = try(each.value.vpc_security_group_ids, var.defaults.vpc_security_group_ids, [])\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-rds__wrappers__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"4.17.1\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\nresource \"aws_instance\" \"app_server\" {\n  ami           = \"ami-077ee47512dc6f3ca\"\n  instance_type = \"t2.nano\"\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__05-input-variables__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__05-input-variables__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__05-input-variables__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__05-input-variables__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__05-input-variables__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__05-input-variables__main.tf", "start_line": 14}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable repo_name {\n  type        = string\n  default     = \"devopsthehardway\"\n  description = \"ECR repo to store a Docker image\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AdminTurnedDevOps__DevOps-The-Hard-Way-AWS__Terraform-AWS-Services-Creation__ECR__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_eks_cluster\" \"eks\" {\n\n  count    = var.is-eks-cluster-enabled == true ? 1 : 0\n  name     = var.cluster-name\n  role_arn = aws_iam_role.eks-cluster-role[count.index].arn\n  version  = var.cluster-version\n\n  vpc_config {\n    subnet_ids              = [aws_subnet.private-subnet[0].id, aws_subnet.private-subnet[1].id, aws_subnet.private-subnet[2].id]\n    endpoint_private_access = var.endpoint-private-access\n    endpoint_public_access  = var.endpoint-public-access\n    security_group_ids      = [aws_security_group.eks-cluster-sg.id]\n  }\n\n\n  access_config {\n    authentication_mode                         = \"CONFIG_MAP\"\n    bootstrap_cluster_creator_admin_permissions = true\n  }\n\n  tags = {\n    Name = var.cluster-name\n    Env  = var.env\n  }\n}\n\n# OIDC Provider\nresource \"aws_iam_openid_connect_provider\" \"eks-oidc\" {\n  client_id_list  = [\"sts.amazonaws.com\"]\n  thumbprint_list = [data.tls_certificate.eks-certificate.certificates[0].sha1_fingerprint]\n  url             = data.tls_certificate.eks-certificate.url\n}\n\n\n# AddOns for EKS Cluster\nresource \"aws_eks_addon\" \"eks-addons\" {\n  for_each      = { for idx, addon in var.addons : idx => addon }\n  cluster_name  = aws_eks_cluster.eks[0].name\n  addon_name    = each.value.name\n  addon_version = each.value.version\n\n  depends_on = [\n    aws_eks_node_group.ondemand-node,\n    aws_eks_node_group.spot-node\n  ]\n}\n\n# NodeGroups\nresource \"aws_eks_node_group\" \"ondemand-node\" {\n  cluster_name    = aws_eks_cluster.eks[0].name\n  node_group_name = \"${var.cluster-name}-on-demand-nodes\"\n\n  node_role_arn = aws_iam_role.eks-nodegroup-role[0].arn\n\n  scaling_config {\n    desired_size = var.desired_capacity_on_demand\n    min_size     = var.min_capacity_on_demand\n    max_size     = var.max_capacity_on_demand\n  }\n\n  subnet_ids = [aws_subnet.private-subnet[0].id, aws_subnet.private-subnet[1].id, aws_subnet.private-subnet[2].id]\n\n  instance_types = var.ondemand_instance_types\n  capacity_type  = \"ON_DEMAND\"\n  labels = {\n    type = \"ondemand\"\n  }\n\n  update_config {\n    max_unavailable = 1\n  }\n  tags = {\n    \"Name\" = \"${var.cluster-name}-ondemand-nodes\"\n  }\n  tags_all = {\n    \"kubernetes.io/cluster/${var.cluster-name}\" = \"owned\"\n    \"Name\" = \"${var.cluster-name}-ondemand-nodes\"\n  }\n\n  depends_on = [aws_eks_cluster.eks]\n}\n\nresource \"aws_eks_node_group\" \"spot-node\" {\n  cluster_name    = aws_eks_cluster.eks[0].name\n  node_group_name = \"${var.cluster-name}-spot-nodes\"\n\n  node_role_arn = aws_iam_role.eks-nodegroup-role[0].arn\n\n  scaling_config {\n    desired_size = var.desired_capacity_spot\n    min_size     = var.min_capacity_spot\n    max_size     = var.max_capacity_spot\n  }\n\n  subnet_ids = [aws_subnet.private-subnet[0].id, aws_subnet.private-subnet[1].id, aws_subnet.private-subnet[2].id]\n\n  instance_types = var.spot_instance_types\n  capacity_type  = \"SPOT\"\n\n  update_config {\n    max_unavailable = 1\n  }\n  tags = {\n    \"Name\" = \"${var.cluster-name}-spot-nodes\"\n  }\n  tags_all = {\n    \"kubernetes.io/cluster/${var.cluster-name}\" = \"owned\"\n    \"Name\" = \"${var.cluster-name}-ondemand-nodes\"\n  }\n  labels = {\n    type      = \"spot\"\n    lifecycle = \"spot\"\n  }\n  disk_size = 50\n\n  depends_on = [aws_eks_cluster.eks]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__EKS-Terraform-GitHub-Actions__module__eks.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \"~> 1.0\"\n  required_providers {\n    azurerm = {\n      version = \"~> 3.18\"\n    }\n  }\n}\n\nprovider \"azurerm\" {\n  features {}\n}\n\nvariable \"app_name\" {\n  description = \"Name of application\"\n  type        = string\n}\n\nvariable \"environment\" {\n  description = \"Environment Name\"\n  type        = string\n}\n\n\n#resource \"azurerm_resource_group\" \"rg-app\" {\n#  name     = upper(format(\"RG-%s-%s\",var.app_name,var.environment))\n#  location = \"westeurope\"\n#}\n\n#FOR CONDITION\nresource \"azurerm_resource_group\" \"rg-app\" {\n  name     = var.environment == \"Production\" ? upper(format(\"RG-%s\", var.app_name)) : upper(format(\"RG-%s-%s\", var.app_name, var.environment))\n  location = \"westeurope\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__fct__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlocals {\n  prefix = var.prefix == \"\" ? random_string.prefix.result : var.prefix\n}\n\nresource \"random_string\" \"prefix\" {\n  length  = 30 - length(var.name) - 1\n  upper   = false\n  numeric = false\n  special = false\n}\n\nmodule \"fabric-project\" {\n  source  = \"terraform-google-modules/project-factory/google//modules/fabric-project\"\n  version = \"~> 18.0\"\n\n  activate_apis   = var.activate_apis\n  billing_account = var.billing_account\n  name            = var.name\n  owners          = var.owners\n  parent          = var.parent\n  prefix          = local.prefix\n\n  deletion_policy = \"DELETE\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-project-factory__examples__fabric_project__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-project-factory__examples__fabric_project__main.tf", "start_line": 28}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.region\n\n  # Profile is deprecated in favor of terraform_role_arn. When profiles are not in use, terraform_profile_name is null.\n  profile = module.iam_roles.terraform_profile_name\n\n  dynamic \"assume_role\" {\n    # module.iam_roles.terraform_role_arn may be null, in which case do not assume a role.\n    for_each = compact([module.iam_roles.terraform_role_arn])\n    content {\n      role_arn = assume_role.value\n    }\n  }\n}\n\nmodule \"iam_roles\" {\n  source  = \"../account-map/modules/iam-roles\"\n  context = module.this.context\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-components__mixins__providers.depth-1.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# EC2 Instance\nresource \"aws_instance\" \"myec2vm\" {\n  ami = data.aws_ami.amzlinux2.id\n  instance_type = var.instance_type\n  user_data = file(\"${path.module}/app1-install.sh\")\n  key_name = var.instance_keypair\n  vpc_security_group_ids = [ aws_security_group.vpc-ssh.id, aws_security_group.vpc-web.id   ]\n  tags = {\n    \"Name\" = \"EC2 Demo 2\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-ec2__04-Terraform-Variables-and-Datasources__terraform-manifests__c5-ec2instance.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-ec2__04-Terraform-Variables-and-Datasources__terraform-manifests__c5-ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-ec2__04-Terraform-Variables-and-Datasources__terraform-manifests__c5-ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-ec2__04-Terraform-Variables-and-Datasources__terraform-manifests__c5-ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-ec2__04-Terraform-Variables-and-Datasources__terraform-manifests__c5-ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-ec2__04-Terraform-Variables-and-Datasources__terraform-manifests__c5-ec2instance.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nprovider \"vault\" {\n  address = \"<>:8200\"\n  skip_child_token = true\n\n  auth_login {\n    path = \"auth/approle/login\"\n\n    parameters = {\n      role_id = \"<>\"\n      secret_id = \"<>\"\n    }\n  }\n}\n\ndata \"vault_kv_secret_v2\" \"example\" {\n  mount = \"secret\" // change it according to your mount\n  name  = \"test-secret\" // change it according to your secret\n}\n\nresource \"aws_instance\" \"my_instance\" {\n  ami           = \"ami-053b0d53c279acc90\"\n  instance_type = \"t2.micro\"\n\n  tags = {\n    Name = \"test\"\n    Secret = data.vault_kv_secret_v2.example.data[\"foo\"]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-7__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-7__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-7__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-7__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-7__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-7__main.tf", "start_line": 24}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright Amazon.com, Inc. or its affiliates. All rights reserved.\n# SPDX-License-Identifier: Apache-2.0\n#\nprovider \"aws\" {\n  alias  = \"ct_management\"\n  region = var.ct_home_region\n  # The default profile or environment variables should authenticate to the Control Tower Management Account as Administrator\n  default_tags {\n    tags = local.aft_tags\n  }\n}\n\nprovider \"aws\" {\n  alias  = \"aft_management\"\n  region = var.ct_home_region\n  assume_role {\n    role_arn     = \"arn:${data.aws_partition.current.partition}:iam::${var.aft_management_account_id}:role/AWSControlTowerExecution\"\n    session_name = local.aft_session_name\n  }\n  default_tags {\n    tags = local.aft_tags\n  }\n}\nprovider \"aws\" {\n  alias  = \"tf_backend_secondary_region\"\n  region = var.tf_backend_secondary_region\n  assume_role {\n    role_arn     = \"arn:${data.aws_partition.current.partition}:iam::${var.aft_management_account_id}:role/AWSControlTowerExecution\"\n    session_name = local.aft_session_name\n  }\n  default_tags {\n    tags = local.aft_tags\n  }\n}\nprovider \"aws\" {\n  alias  = \"audit\"\n  region = var.ct_home_region\n  assume_role {\n    role_arn     = \"arn:${data.aws_partition.current.partition}:iam::${var.audit_account_id}:role/AWSControlTowerExecution\"\n    session_name = local.aft_session_name\n  }\n  default_tags {\n    tags = local.aft_tags\n  }\n}\nprovider \"aws\" {\n  alias  = \"log_archive\"\n  region = var.ct_home_region\n  assume_role {\n    role_arn     = \"arn:${data.aws_partition.current.partition}:iam::${var.log_archive_account_id}:role/AWSControlTowerExecution\"\n    session_name = local.aft_session_name\n  }\n  default_tags {\n    tags = local.aft_tags\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-control_tower_account_factory__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource: EC2 Instance\nresource \"aws_instance\" \"myec2\" {\n  ami = \"ami-0e5b6b6a9f3db6db8\"\n  instance_type = \"t2.micro\"\n  user_data = file(\"${path.module}/app1-install.sh\")\n  tags = {\n    \"Name\" = \"EC2 Demo\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__04 - Settings__manifests__ec2instance.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__04 - Settings__manifests__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__04 - Settings__manifests__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__04 - Settings__manifests__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__04 - Settings__manifests__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__04 - Settings__manifests__ec2instance.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Enable spike protection for several projects in a Sentry organization.\nresource \"sentry_project\" \"web-app\" {\n  organization = \"my-organization\"\n\n  teams = [\"my-first-team\"]\n  name  = \"web-app\"\n  slug  = \"web-app\"\n\n  platform = \"go\"\n}\n\nresource \"sentry_project\" \"mobile-app\" {\n  organization = \"my-organization\"\n\n  teams = [\"my-second-team\"]\n  name  = \"mobile-app\"\n  slug  = \"mobile-app\"\n\n  platform = \"android\"\n}\n\nresource \"sentry_all_projects_spike_protection\" \"main\" {\n  organization = \"my-organization\"\n  projects = [\n    sentry_project.web-app.id,\n    sentry_project.mobile-app.id,\n  ]\n  enabled = true\n}\n\n# Use the `sentry_all_projects` data source to get all projects in a Sentry organization and enable spike protection for all of them.\ndata \"sentry_all_projects\" \"all\" {\n  organization = \"my-organization\"\n}\n\nresource \"sentry_all_projects_spike_protection\" \"main\" {\n  organization = data.sentry_all_projects.all.organization\n  projects     = data.sentry_all_projects.all.project_slugs\n  enabled      = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jianyuan__terraform-provider-sentry__examples__resources__sentry_all_projects_spike_protection__resource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Create Security Group - SSH Traffic\nresource \"aws_security_group\" \"vpc-ssh\" {\n  name        = \"vpc-ssh-${terraform.workspace}\"\n  description = \"Dev VPC SSH\"\n  ingress {\n    description = \"Allow Port 22\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  egress {\n    description = \"Allow all ip and ports outboun\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\n# Create Security Group - Web Traffic\nresource \"aws_security_group\" \"vpc-web\" {\n  name        = \"vpc-web-${terraform.workspace}\"\n  description = \"Dev VPC web\"\n  ingress {\n    description = \"Allow Port 80\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    description = \"Allow Port 443\"\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    description = \"Allow all ip and ports outbound\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-cloud-demo1__c3-security-groups.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-cloud-demo1__c3-security-groups.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-cloud-demo1__c3-security-groups.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-cloud-demo1__c3-security-groups.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-cloud-demo1__c3-security-groups.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-cloud-demo1__c3-security-groups.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-cloud-demo1__c3-security-groups.tf", "start_line": 22}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_vpc\" \"network\" {\n    cidr_block = \"${var.vpc_cidr_block}\"\n    enable_dns_support = true\n    enable_dns_hostnames = true\n\n    tags {\n        Name = \"lattice\"\n    }\n}\n\nresource \"aws_subnet\" \"network\" {\n    vpc_id = \"${aws_vpc.network.id}\"\n    cidr_block = \"${var.subnet_cidr_block}\"\n    map_public_ip_on_launch = true\n\n    tags {\n        Name = \"lattice\"\n    }\n}\n\nresource \"aws_internet_gateway\" \"network\" {\n    vpc_id = \"${aws_vpc.network.id}\"\n}\n\nresource \"aws_route_table\" \"network\" {\n    vpc_id = \"${aws_vpc.network.id}\"\n\n    route {\n        cidr_block = \"0.0.0.0/0\"\n        gateway_id = \"${aws_internet_gateway.network.id}\"\n    }\n}\n\nresource \"aws_route_table_association\" \"network\" {\n    subnet_id = \"${aws_subnet.network.id}\"\n    route_table_id = \"${aws_route_table.network.id}\"\n}\n\nresource \"aws_security_group\" \"network\" {\n    name = \"lattice\"\n    description = \"Lattice security group\"\n    vpc_id = \"${aws_vpc.network.id}\"\n\n    ingress {\n        protocol = \"tcp\"\n        from_port = 1\n        to_port = 65535\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n\n    ingress {\n        protocol = \"udp\"\n        from_port = 1\n        to_port = 65535\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n\n    egress {\n        protocol = \"tcp\"\n        from_port = 1\n        to_port = 65535\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n\n    egress {\n        protocol = \"udp\"\n        from_port = 1\n        to_port = 65535\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n\n    tags {\n        Name = \"lattice\"\n    }\n}\n\nresource \"aws_instance\" \"brain\" {\n    ami = \"${lookup(var.brain_ami, var.aws_region)}\"\n    instance_type = \"${var.brain_instance_type}\"\n    key_name = \"${var.aws_ssh_private_key_name}\"\n    subnet_id = \"${aws_subnet.network.id}\"\n    security_groups = [\"${aws_security_group.network.id}\"]\n\n    tags {\n        Name = \"lattice-brain\"\n    }\n\n    connection {\n        user = \"${var.ssh_username}\"\n        key_file = \"${var.aws_ssh_private_key_path}\"\n    }\n\n    provisioner \"local-exec\" {\n        command = \"mkdir .lattice || echo\"\n    }\n\n    provisioner \"file\" {\n        source = \".lattice/\"\n        destination = \"/tmp\"\n    }\n}\n\nresource \"aws_eip\" \"ip\" {\n    instance = \"${aws_instance.brain.id}\"\n    vpc = true\n\n    connection {\n        host = \"${aws_eip.ip.public_ip}\"\n        user = \"${var.ssh_username}\"\n        key_file = \"${var.aws_ssh_private_key_path}\"\n    }\n\n    provisioner \"remote-exec\" {\n        inline = [\n            \"sudo sh -c 'echo USERNAME=${var.username} >> /var/lattice/setup'\",\n            \"sudo sh -c 'echo PASSWORD=${var.password} >> /var/lattice/setup'\",\n            \"sudo sh -c 'echo DOMAIN=${aws_eip.ip.public_ip}.xip.io >> /var/lattice/setup'\",\n            \"sudo sh -c 'echo HOST_ID=lattice-brain-0 >> /var/lattice/setup'\",\n            \"[ -f /tmp/lattice.tgz ] || curl -s -o /tmp/lattice.tgz '${var.lattice_tgz_url}'\",\n            \"sudo tar xzf /tmp/lattice.tgz -C /tmp install\",\n            \"sudo /tmp/install/common\",\n            \"sudo /tmp/install/brain /tmp/lattice.tgz\",\n            \"sudo /tmp/install/start\"\n        ]\n    }\n}\n\nresource \"aws_instance\" \"cell\" {\n    depends_on = [\"aws_eip.ip\"]\n    count = \"${var.cell_count}\"\n    ami = \"${lookup(var.cell_ami, var.aws_region)}\"\n    instance_type = \"${var.cell_instance_type}\"\n    ebs_optimized = true\n    key_name = \"${var.aws_ssh_private_key_name}\"\n    subnet_id = \"${aws_subnet.network.id}\"\n    security_groups = [\"${aws_security_group.network.id}\"]\n\n    tags {\n        Name = \"lattice-cell-${count.index}\"\n    }\n\n    connection {\n        user = \"${var.ssh_username}\"\n        key_file = \"${var.aws_ssh_private_key_path}\"\n    }\n\n    provisioner \"local-exec\" {\n        command = \"mkdir .lattice || echo\"\n    }\n\n    provisioner \"file\" {\n        source = \".lattice/\"\n        destination = \"/tmp\"\n    }\n\n    provisioner \"remote-exec\" {\n        inline = [\n            \"sudo sh -c 'echo HOST_ID=lattice-cell-${count.index} >> /var/lattice/setup'\",\n            \"sudo sh -c \\\"echo GARDEN_IP=$(ip route get 1 | awk '{print $NF;exit}') >> /var/lattice/setup\\\"\",\n            \"sudo sh -c 'echo BRAIN_IP=${aws_instance.brain.private_ip} >> /var/lattice/setup'\",\n            \"[ -f /tmp/lattice.tgz ] || curl -s -o /tmp/lattice.tgz '${var.lattice_tgz_url}'\",\n            \"sudo tar xzf /tmp/lattice.tgz -C /tmp install\",\n            \"sudo /tmp/install/common\",\n            \"sudo /tmp/install/cell /tmp/lattice.tgz\",\n            \"sudo /tmp/install/terraform/cell\",\n            \"sudo /tmp/install/start\"\n        ]\n    }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_25", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 128}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 128}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 128}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudfoundry-attic__lattice-release__terraform__aws__resources.tf", "start_line": 128}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Using the built-in CA with specific TTL\nresource \"consul_certificate_authority\" \"connect\" {\n  connect_provider = \"consul\"\n\n  config_json = jsonencode({\n    LeafCertTTL         = \"24h\"\n    RotationPeriod      = \"2160h\"\n    IntermediateCertTTL = \"8760h\"\n  })\n}\n\n\n# Using Vault to manage and sign certificates\nresource \"consul_certificate_authority\" \"connect\" {\n  connect_provider = \"vault\"\n\n  config_json = jsonencode({\n    Address             = \"http://localhost:8200\"\n    Token               = \"...\"\n    RootPKIPath         = \"connect-root\"\n    IntermediatePKIPath = \"connect-intermediate\"\n  })\n}\n\n\n# Using the AWS Certificate Manager Private Certificate Authority\n#  * https://aws.amazon.com/certificate-manager/private-certificate-authority/\nresource \"consul_certificate_authority\" \"connect\" {\n  connect_provider = \"aws-pca\"\n\n  config_json = jsonencode({\n    ExistingARN = \"arn:aws:acm-pca:region:account:certificate-authority/12345678-1234-1234-123456789012\"\n  })\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-consul__examples__resources__consul_certificate_authority__resource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.16\"\n    }\n  }\n\n  required_version = \">= 1.2.0\"\n}\n\n#####################################################\n# With for_each\nresource \"aws_iam_user\" \"example\" {\n  for_each = var.user_names\n  name  = each.value\n}\n# With Map\nvariable \"user_names\" {\n  description = \"map\"\n  type        = map(string)\n  default     = {\n    user1      = \"username1\"\n    user2      = \"username2\"\n    user3      = \"username3\"\n  }\n}\n# with for loop on map \noutput \"user_with_roles\" {\n  value = [for name, role in var.user_names : \"${name} is the ${role}\"]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__iamuser-metaargs-count-for-foreach-map__map__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__iamuser-metaargs-count-for-foreach-map__map__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__iamuser-metaargs-count-for-foreach-map__map__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__iamuser-metaargs-count-for-foreach-map__map__main.tf", "start_line": 14}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\nCopyright 2019 F5 Networks Inc.\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nprovider \"bigip\" {\n  address  = \"xxx.xxx.xxx.xxx\"\n  username = \"xxxx\"\n  password = \"xxxx\"\n}\n\nresource \"bigip_ltm_profile_fastl4\" \"sjfastl4profile\" {\n  name                   = \"/Common/sjfastl4profile\"\n  partition              = \"Common\"\n  defaults_from          = \"/Common/fastL4\"\n  client_timeout         = 40\n  explicitflow_migration = \"enabled\"\n  hardware_syncookie     = \"enabled\"\n  idle_timeout           = \"200\"\n  iptos_toclient         = \"pass-through\"\n  iptos_toserver         = \"pass-through\"\n  keepalive_interval     = \"disabled\" //This cannot take enabled\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/F5Networks__terraform-provider-bigip__examples__bigip_ltm_profile_fastl4.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\nName: IaC Buildout for Terraform Associate Exam\nDescription: AWS Infrastructure Buildout\nContributors: Bryan and Gabe\n*/\n\n# Configure the AWS Provider\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\n#Retrieve the list of AZs in the current AWS region\ndata \"aws_availability_zones\" \"available\" {}\ndata \"aws_region\" \"current\" {}\n\n# Terraform Data Block - Lookup Ubuntu 20.04\ndata \"aws_ami\" \"ubuntu\" {\n  most_recent = true\n\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  owners = [\"099720109477\"]\n}\n\n#Define the VPC \nresource \"aws_vpc\" \"vpc\" {\n  cidr_block = var.vpc_cidr\n\n  tags = {\n    Name        = var.vpc_name\n    Environment = \"demo_environment\"\n    Terraform   = \"true\"\n  }\n}\n\n#Deploy the private subnets\nresource \"aws_subnet\" \"private_subnets\" {\n  for_each          = var.private_subnets\n  vpc_id            = aws_vpc.vpc.id\n  cidr_block        = cidrsubnet(var.vpc_cidr, 8, each.value)\n  availability_zone = tolist(data.aws_availability_zones.available.names)[each.value]\n\n  tags = {\n    Name      = each.key\n    Terraform = \"true\"\n  }\n}\n\n#Deploy the public subnets\nresource \"aws_subnet\" \"public_subnets\" {\n  for_each                = var.public_subnets\n  vpc_id                  = aws_vpc.vpc.id\n  cidr_block              = cidrsubnet(var.vpc_cidr, 8, each.value + 100)\n  availability_zone       = tolist(data.aws_availability_zones.available.names)[each.value]\n  map_public_ip_on_launch = true\n\n  tags = {\n    Name      = each.key\n    Terraform = \"true\"\n  }\n}\n\n#Create route tables for public and private subnets\nresource \"aws_route_table\" \"public_route_table\" {\n  vpc_id = aws_vpc.vpc.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.internet_gateway.id\n    #nat_gateway_id = aws_nat_gateway.nat_gateway.id\n  }\n  tags = {\n    Name      = \"demo_public_rtb\"\n    Terraform = \"true\"\n  }\n}\n\nresource \"aws_route_table\" \"private_route_table\" {\n  vpc_id = aws_vpc.vpc.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    # gateway_id     = aws_internet_gateway.internet_gateway.id\n    nat_gateway_id = aws_nat_gateway.nat_gateway.id\n  }\n  tags = {\n    Name      = \"demo_private_rtb\"\n    Terraform = \"true\"\n  }\n}\n\n#Create route table associations\nresource \"aws_route_table_association\" \"public\" {\n  depends_on     = [aws_subnet.public_subnets]\n  route_table_id = aws_route_table.public_route_table.id\n  for_each       = aws_subnet.public_subnets\n  subnet_id      = each.value.id\n}\n\nresource \"aws_route_table_association\" \"private\" {\n  depends_on     = [aws_subnet.private_subnets]\n  route_table_id = aws_route_table.private_route_table.id\n  for_each       = aws_subnet.private_subnets\n  subnet_id      = each.value.id\n}\n\n#Create Internet Gateway\nresource \"aws_internet_gateway\" \"internet_gateway\" {\n  vpc_id = aws_vpc.vpc.id\n  tags = {\n    Name = \"demo_igw\"\n  }\n}\n\n#Create EIP for NAT Gateway\nresource \"aws_eip\" \"nat_gateway_eip\" {\n  domain     = \"vpc\"\n  depends_on = [aws_internet_gateway.internet_gateway]\n  tags = {\n    Name = \"demo_igw_eip\"\n  }\n}\n\n#Create NAT Gateway\nresource \"aws_nat_gateway\" \"nat_gateway\" {\n  depends_on    = [aws_subnet.public_subnets]\n  allocation_id = aws_eip.nat_gateway_eip.id\n  subnet_id     = aws_subnet.public_subnets[\"public_subnet_1\"].id\n  tags = {\n    Name = \"demo_nat_gateway\"\n  }\n}\n\n# Terraform Resource Block - To Build EC2 instance in Public Subnet\nresource \"aws_instance\" \"web_server\" {                            # BLOCK\n  ami           = data.aws_ami.ubuntu.id                          # Argument with data expression\n  instance_type = \"t3.micro\"                                      # Argument\n  subnet_id     = aws_subnet.public_subnets[\"public_subnet_1\"].id # Argument with value as expression\n  tags = {\n    Name = \"Web EC2 Server\"\n  }\n}\n\nresource \"aws_subnet\" \"variables-subnet\" {\n  vpc_id                  = aws_vpc.vpc.id\n  cidr_block              = var.variables_sub_cidr\n  availability_zone       = var.variables_sub_az\n  map_public_ip_on_launch = var.variables_sub_auto_ip\n\n  tags = {\n    Name      = \"sub-variables-${var.variables_sub_az}\"\n    Terraform = \"true\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__hashicorp__terraform__Lab Prerequisites__Section 04 - Understand Terraform Basics__Provider Installation and Versioning__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  alias = \"eu-west-1\"\n\n  region              = \"eu-west-1\"\n  allowed_account_ids = [\"905033465232\"]\n\n  assume_role {\n    role_arn = \"arn:aws:iam::905033465232:role/OrganizationAccountAccessRole\"\n  }\n}\n\nprovider \"aws\" {\n  alias = \"eu-central-1\"\n\n  region              = \"eu-central-1\"\n  allowed_account_ids = [\"905033465232\"]\n\n  assume_role {\n    role_arn = \"arn:aws:iam::905033465232:role/OrganizationAccountAccessRole\"\n  }\n}\n\nprovider \"aws\" {\n  alias = \"us-west-1\"\n\n  region              = \"us-west-1\"\n  allowed_account_ids = [\"905033465232\"]\n\n  assume_role {\n    role_arn = \"arn:aws:iam::905033465232:role/OrganizationAccountAccessRole\"\n  }\n}\n\nprovider \"aws\" {\n  alias = \"us-east-1\"\n\n  region              = \"us-east-1\"\n  allowed_account_ids = [\"905033465232\"]\n\n  assume_role {\n    role_arn = \"arn:aws:iam::905033465232:role/OrganizationAccountAccessRole\"\n  }\n}\n\nmodule \"vpc_eu-west-1\" {\n  source = \"./vpc-with-defaults\"\n\n  providers = {\n    aws = aws.eu-west-1\n  }\n}\n\nmodule \"vpc_eu-central-1\" {\n  source = \"./vpc-with-defaults\"\n\n  providers = {\n    aws = aws.eu-central-1\n  }\n}\n\nmodule \"vpc_us-west-1\" {\n  source = \"./vpc-with-defaults\"\n\n  providers = {\n    aws = aws.us-west-1\n  }\n}\n\nmodule \"vpc_us-east-1\" {\n  source = \"./vpc-with-defaults\"\n\n  providers = {\n    aws = aws.us-east-1\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices-workshop__bootstrap-workshop-jsonnet__vpc.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region  = \"us-east-2\"\n  access_key = \"AKIA52UPAOLET47YOP9SXC\"\n  secret_key = \"8Y/V1aAms1yEGpHQgsJGHLvbSlY1K4ig2qTxu7JGbcnl\"\n}\n\nresource \"aws_instance\" \"app_server\" {\n  ami       \t= \"ami-0a5588cee1fe39fff\"\n  instance_type = \"t2.small\"  \n \n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iamkishore0__Terraform__Terraform__Import__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.region\n}\n\n#S3 access controls, policies and logging should be created as seperate terraform resources\n#tfsec:ignore:aws-s3-block-public-acls tfsec:ignore:aws-s3-block-public-policy tfsec:ignore:aws-s3-enable-bucket-encryption tfsec:ignore:aws-s3-encryption-customer-key tfsec:ignore:aws-s3-ignore-public-acls tfsec:ignore:aws-s3-no-public-buckets tfsec:ignore:aws-s3-enable-bucket-logging tfsec:ignore:aws-s3-enable-versioning tfsec:ignore:aws-s3-specify-public-access-block\nresource \"aws_s3_bucket\" \"default\" {\n  count = module.this.enabled ? 1 : 0\n\n  bucket = \"${module.this.id}-logs\"\n}\n\nmodule \"tfstate_backend\" {\n  source = \"../../\"\n\n  force_destroy = true\n\n  bucket_enabled   = var.bucket_enabled\n  dynamodb_enabled = var.dynamodb_enabled\n\n  logging = [\n    {\n      target_bucket = one(aws_s3_bucket.default[*].id)\n      target_prefix = \"tfstate/\"\n    }\n  ]\n\n  bucket_ownership_enforced_enabled = true\n\n  context = module.this.context\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__examples__complete__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__examples__complete__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__examples__complete__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__examples__complete__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__examples__complete__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__examples__complete__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__examples__complete__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__examples__complete__main.tf", "start_line": 7}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"vpc_cidr\" {\n  description = \"VPC CIDR\"\n  type        = string\n}\n\nvariable \"private_subnets\" {\n  description = \"Subnets CIDR\"\n  type        = list(string)\n}\n\nvariable \"public_subnets\" {\n  description = \"Subnets CIDR\"\n  type        = list(string)\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gauri17-pro__terraform-jenkins-eks__EKS__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# resource <resource-type> <resource-name>\nresource \"aws_instance\" \"db\" {\n\n    ami = \"ami-090252cbe067a9e58\"\n    vpc_security_group_ids = [aws_security_group.allow_ssh.id]\n    instance_type = \"t3.micro\"\n\n    tags = {\n        Name = \"db\"\n    }\n}\n\nresource \"aws_security_group\" \"allow_ssh\" {\n    name = \"allow_ssh\"\n    description = \"allowing SSH access\"\n\n    #terraform block\n    ingress {\n        from_port        = 22\n        to_port          = 22\n        protocol         = \"tcp\"\n        cidr_blocks      = [\"0.0.0.0/0\"]\n    }\n\n    egress {\n        from_port        = 0 # from 0 to 0 means, opening all protocols\n        to_port          = 0\n        protocol         = \"-1\" # -1 all protocols\n        cidr_blocks      = [\"0.0.0.0/0\"]\n    }\n\n    tags = {\n        Name = \"allow_ssh\"\n        CreatedBy = \"Sivakumar\"\n    }\n}\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__ec2__ec2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__ec2__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__ec2__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__ec2__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__ec2__ec2.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__ec2__ec2.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__ec2__ec2.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__ec2__ec2.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__ec2__ec2.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n################################################################################\n# Public Zone\n################################################################################\n\noutput \"public_zone_id\" {\n  description = \"Zone ID of Route53 zone\"\n  value       = module.zone_public.id\n}\n\noutput \"public_zone_arn\" {\n  description = \"Zone ARN of Route53 zone\"\n  value       = module.zone_public.arn\n}\n\noutput \"public_zone_name_servers\" {\n  description = \"Name servers of Route53 zone\"\n  value       = module.zone_public.name_servers\n}\n\noutput \"public_zone_primary_name_server\" {\n  description = \"The Route 53 name server that created the SOA record.\"\n  value       = module.zone_public.primary_name_server\n}\n\noutput \"public_zone_name\" {\n  description = \"Name of Route53 zone\"\n  value       = module.zone_public.name\n}\n\noutput \"public_zone_dnssec_signing_key_digest_value\" {\n  description = \"A cryptographic digest of a DNSKEY resource record (RR). DNSKEY records are used to publish the public key that resolvers can use to verify DNSSEC signatures that are used to secure certain kinds of information provided by the DNS system\"\n  value       = module.zone_public.dnssec_signing_key_digest_value\n}\n\noutput \"public_zone_dnssec_signing_key_dnskey_record\" {\n  description = \"A string that represents a DNSKEY record\"\n  value       = module.zone_public.dnssec_signing_key_dnskey_record\n}\n\noutput \"public_zone_dnssec_signing_key_ds_record\" {\n  description = \"A string that represents a delegation signer (DS) record\"\n  value       = module.zone_public.dnssec_signing_key_ds_record\n}\n\noutput \"public_zone_dnssec_signing_key_id\" {\n  description = \"Route 53 Hosted Zone identifier and KMS Key identifier, separated by a comma (`,`)\"\n  value       = module.zone_public.dnssec_signing_key_id\n}\n\noutput \"public_zone_dnssec_signing_key_tag\" {\n  description = \"An integer used to identify the DNSSEC record for the domain name. The process used to calculate the value is described in RFC-4034 Appendix B\"\n  value       = module.zone_public.dnssec_signing_key_tag\n}\n\noutput \"public_zone_dnssec_signing_key_public_key\" {\n  description = \"The public key, represented as a Base64 encoding, as required by RFC-4034 Page 5\"\n  value       = module.zone_public.dnssec_signing_key_public_key\n}\n\n# KMS key\noutput \"public_zone_dnssec_kms_key_arn\" {\n  description = \"The Amazon Resource Name (ARN) of the key\"\n  value       = module.zone_public.dnssec_kms_key_arn\n}\n\noutput \"public_zone_dnssec_kms_key_id\" {\n  description = \"The globally unique identifier for the key\"\n  value       = module.zone_public.dnssec_kms_key_id\n}\n\noutput \"public_zone_dnssec_kms_key_region\" {\n  description = \"The region for the key\"\n  value       = module.zone_public.dnssec_kms_key_region\n}\n\noutput \"public_zone_dnssec_kms_key_policy\" {\n  description = \"The IAM resource policy set on the key\"\n  value       = module.zone_public.dnssec_kms_key_policy\n}\n\noutput \"public_zone_records\" {\n  description = \"Records created in the Route53 zone\"\n  value       = module.zone_public.records\n}\n\n################################################################################\n# Private Zone\n################################################################################\n\noutput \"private_zone_id\" {\n  description = \"Zone ID of Route53 zone\"\n  value       = module.zone_private.id\n}\n\noutput \"private_zone_arn\" {\n  description = \"Zone ARN of Route53 zone\"\n  value       = module.zone_private.arn\n}\n\noutput \"private_zone_name_servers\" {\n  description = \"Name servers of Route53 zone\"\n  value       = module.zone_private.name_servers\n}\n\noutput \"private_zone_primary_name_server\" {\n  description = \"The Route 53 name server that created the SOA record.\"\n  value       = module.zone_private.primary_name_server\n}\n\noutput \"private_zone_name\" {\n  description = \"Name of Route53 zone\"\n  value       = module.zone_private.name\n}\n\noutput \"private_zone_dnssec_signing_key_digest_value\" {\n  description = \"A cryptographic digest of a DNSKEY resource record (RR). DNSKEY records are used to publish the public key that resolvers can use to verify DNSSEC signatures that are used to secure certain kinds of information provided by the DNS system\"\n  value       = module.zone_private.dnssec_signing_key_digest_value\n}\n\noutput \"private_zone_dnssec_signing_key_dnskey_record\" {\n  description = \"A string that represents a DNSKEY record\"\n  value       = module.zone_private.dnssec_signing_key_dnskey_record\n}\n\noutput \"private_zone_dnssec_signing_key_ds_record\" {\n  description = \"A string that represents a delegation signer (DS) record\"\n  value       = module.zone_private.dnssec_signing_key_ds_record\n}\n\noutput \"private_zone_dnssec_signing_key_id\" {\n  description = \"Route 53 Hosted Zone identifier and KMS Key identifier, separated by a comma (`,`)\"\n  value       = module.zone_private.dnssec_signing_key_id\n}\n\noutput \"private_zone_dnssec_signing_key_tag\" {\n  description = \"An integer used to identify the DNSSEC record for the domain name. The process used to calculate the value is described in RFC-4034 Appendix B\"\n  value       = module.zone_private.dnssec_signing_key_tag\n}\n\noutput \"private_zone_dnssec_signing_key_public_key\" {\n  description = \"The public key, represented as a Base64 encoding, as required by RFC-4034 Page 5\"\n  value       = module.zone_private.dnssec_signing_key_public_key\n}\n\n# KMS key\noutput \"private_zone_dnssec_kms_key_arn\" {\n  description = \"The Amazon Resource Name (ARN) of the key\"\n  value       = module.zone_private.dnssec_kms_key_arn\n}\n\noutput \"private_zone_dnssec_kms_key_id\" {\n  description = \"The globally unique identifier for the key\"\n  value       = module.zone_private.dnssec_kms_key_id\n}\n\noutput \"private_zone_dnssec_kms_key_region\" {\n  description = \"The region for the key\"\n  value       = module.zone_private.dnssec_kms_key_region\n}\n\noutput \"private_zone_dnssec_kms_key_policy\" {\n  description = \"The IAM resource policy set on the key\"\n  value       = module.zone_private.dnssec_kms_key_policy\n}\n\noutput \"private_zone_records\" {\n  description = \"Records created in the Route53 zone\"\n  value       = module.zone_private.records\n}\n\n################################################################################\n# Inbound Resolver Endpoint\n################################################################################\n\noutput \"inbound_resolver_endpoint_id\" {\n  description = \"The ID of the Resolver Endpoint\"\n  value       = module.resolver_endpoint_inbound.id\n}\n\noutput \"inbound_resolver_endpoint_arn\" {\n  description = \"The ARN of the Resolver Endpoint\"\n  value       = module.resolver_endpoint_inbound.arn\n}\n\noutput \"inbound_resolver_endpoint_host_vpc_id\" {\n  description = \"The VPC ID used by the Resolver Endpoint\"\n  value       = module.resolver_endpoint_inbound.host_vpc_id\n}\n\noutput \"inbound_resolver_endpoint_security_group_ids\" {\n  description = \"Security Group IDs mapped to Resolver Endpoint\"\n  value       = module.resolver_endpoint_inbound.security_group_ids\n}\n\noutput \"inbound_resolver_endpoint_ip_addresses\" {\n  description = \"Resolver Endpoint IP Addresses\"\n  value       = module.resolver_endpoint_inbound.ip_addresses\n}\n\noutput \"inbound_resolver_endpoint_security_group_arn\" {\n  description = \"Amazon Resource Name (ARN) of the security group\"\n  value       = module.resolver_endpoint_inbound.security_group_arn\n}\n\noutput \"inbound_resolver_endpoint_security_group_id\" {\n  description = \"ID of the security group\"\n  value       = module.resolver_endpoint_inbound.security_group_id\n}\n\noutput \"inbound_resolver_endpoint_rules\" {\n  description = \"Resolver Endpoint Rules created\"\n  value       = module.resolver_endpoint_inbound.rules\n}\n\n################################################################################\n# Outbound Resolver Endpoint\n################################################################################\n\noutput \"outbound_resolver_endpoint_id\" {\n  description = \"The ID of the Resolver Endpoint\"\n  value       = module.resolver_endpoint_outbound.id\n}\n\noutput \"outbound_resolver_endpoint_arn\" {\n  description = \"The ARN of the Resolver Endpoint\"\n  value       = module.resolver_endpoint_outbound.arn\n}\n\noutput \"outbound_resolver_endpoint_host_vpc_id\" {\n  description = \"The VPC ID used by the Resolver Endpoint\"\n  value       = module.resolver_endpoint_outbound.host_vpc_id\n}\n\noutput \"outbound_resolver_endpoint_security_group_ids\" {\n  description = \"Security Group IDs mapped to Resolver Endpoint\"\n  value       = module.resolver_endpoint_outbound.security_group_ids\n}\n\noutput \"outbound_resolver_endpoint_ip_addresses\" {\n  description = \"Resolver Endpoint IP Addresses\"\n  value       = module.resolver_endpoint_outbound.ip_addresses\n}\n\noutput \"outbound_resolver_endpoint_security_group_arn\" {\n  description = \"Amazon Resource Name (ARN) of the security group\"\n  value       = module.resolver_endpoint_outbound.security_group_arn\n}\n\noutput \"outbound_resolver_endpoint_security_group_id\" {\n  description = \"ID of the security group\"\n  value       = module.resolver_endpoint_outbound.security_group_id\n}\n\noutput \"outbound_resolver_endpoint_rules\" {\n  description = \"Resolver Endpoint Rules created\"\n  value       = module.resolver_endpoint_outbound.rules\n}\n\n################################################################################\n# Resolver Firewall Rule Group\n################################################################################\n\noutput \"resolver_firewall_rule_group_arn\" {\n  description = \"The ARN (Amazon Resource Name) of the rule group\"\n  value       = module.resolver_firewall_rule_group.arn\n}\n\noutput \"resolver_firewall_rule_group_id\" {\n  description = \"The ID of the rule group\"\n  value       = module.resolver_firewall_rule_group.id\n}\n\noutput \"resolver_firewall_rule_group_share_status\" {\n  description = \"Whether the rule group is shared with other AWS accounts, or was shared with the current account by another AWS account. Sharing is configured through AWS Resource Access Manager (AWS RAM). Valid values: `NOT_SHARED`, `SHARED_BY_ME`, `SHARED_WITH_ME`\"\n  value       = module.resolver_firewall_rule_group.share_status\n}\n\noutput \"resolver_firewall_rule_group_domain_lists\" {\n  description = \"Map of all domain lists created and their attributes\"\n  value       = module.resolver_firewall_rule_group.domain_lists\n}\n\noutput \"resolver_firewall_rule_group_rules\" {\n  description = \"Map of all rules created and their attributes\"\n  value       = module.resolver_firewall_rule_group.rules\n}\n\noutput \"s3\" {\n  description = \"S3 bucket name used for logging\"\n  value       = module.s3_bucket\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-route53__examples__complete__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"ap-south-1\"\n}\n\ndata \"aws_eks_cluster\" \"cluster\" {\n  name = module.eks.cluster_id\n}\n\ndata \"aws_eks_cluster_auth\" \"cluster\" {\n  name = module.eks.cluster_id\n}\n\ndata \"aws_availability_zones\" \"available\" {}\n\nvariable \"cluster_name\" {\n  default = \"learnk8s\"\n}\n\nprovider \"kubernetes\" {\n  host                   = data.aws_eks_cluster.cluster.endpoint\n  cluster_ca_certificate = base64decode(data.aws_eks_cluster.cluster.certificate_authority.0.data)\n  token                  = data.aws_eks_cluster_auth.cluster.token\n\n}\n\nmodule \"eks-kubeconfig\" {\n  source     = \"hyperbadger/eks-kubeconfig/aws\"\n  version    = \"1.0.0\"\n\n  depends_on = [module.eks]\n  cluster_id =  module.eks.cluster_id\n  }\n\nresource \"local_file\" \"kubeconfig\" {\n  content  = module.eks-kubeconfig.kubeconfig\n  filename = \"kubeconfig_${var.cluster_name}\"\n}\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"3.18.1\"\n\n  name                 = \"k8s-${var.cluster_name}-vpc\"\n  cidr                 = \"172.16.0.0/16\"\n  azs                  = data.aws_availability_zones.available.names\n  private_subnets      = [\"172.16.1.0/24\", \"172.16.2.0/24\", \"172.16.3.0/24\"]\n  public_subnets       = [\"172.16.4.0/24\", \"172.16.5.0/24\", \"172.16.6.0/24\"]\n  enable_nat_gateway   = true\n  single_nat_gateway   = true\n  enable_dns_hostnames = true\n\n  public_subnet_tags = {\n    \"kubernetes.io/cluster/${var.cluster_name}\" = \"shared\"\n    \"kubernetes.io/role/elb\"                    = \"1\"\n  }\n\n  private_subnet_tags = {\n    \"kubernetes.io/cluster/${var.cluster_name}\" = \"shared\"\n    \"kubernetes.io/role/internal-elb\"           = \"1\"\n  }\n}\n\nmodule \"eks\" {\n  source  = \"terraform-aws-modules/eks/aws\"\n  version = \"18.30.3\"\n\n  cluster_name    = \"eks-${var.cluster_name}\"\n  cluster_version = \"1.24\"\n  subnet_ids        = module.vpc.private_subnets\n  vpc_id = module.vpc.vpc_id\n\n  eks_managed_node_groups = {\n    first = {\n      desired_capacity = 1\n      max_capacity     = 10\n      min_capacity     = 1\n\n      instance_type = \"m5.large\"\n    }\n  }\n  \n  node_security_group_additional_rules = {\n    ingress_allow_access_from_control_plane = {\n      type                          = \"ingress\"\n      protocol                      = \"tcp\"\n      from_port                     = 9443\n      to_port                       = 9443\n      source_cluster_security_group = true\n      description                   = \"Allow access from control plane to webhook port of AWS load balancer controller\"\n    }\n  }\n}\n\nresource \"aws_iam_policy\" \"worker_policy\" {\n  name        = \"worker-policy-${var.cluster_name}\"\n  description = \"Worker policy for the ALB Ingress\"\n\n  policy = file(\"iam-policy.json\")\n}\n\nresource \"aws_iam_role_policy_attachment\" \"additional\" {\n  for_each = module.eks.eks_managed_node_groups\n\n  policy_arn = aws_iam_policy.worker_policy.arn\n  role       = each.value.iam_role_name\n}\n\nprovider \"helm\" {\n  kubernetes {\n    host                   = data.aws_eks_cluster.cluster.endpoint\n    cluster_ca_certificate = base64decode(data.aws_eks_cluster.cluster.certificate_authority.0.data)\n    token                  = data.aws_eks_cluster_auth.cluster.token\n    }\n}\n\nresource \"helm_release\" \"ingress\" {\n  name       = \"ingress\"\n  chart      = \"aws-load-balancer-controller\"\n  repository = \"https://aws.github.io/eks-charts\"\n  version    = \"1.4.6\"\n\n  set {\n    name  = \"autoDiscoverAwsRegion\"\n    value = \"true\"\n  }\n  set {\n    name  = \"autoDiscoverAwsVpcID\"\n    value = \"true\"\n  }\n  set {\n    name  = \"clusterName\"\n    value = var.cluster_name\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__05_terraform_env_module__cluster__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__05_terraform_env_module__cluster__main.tf", "start_line": 26}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__05_terraform_env_module__cluster__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__05_terraform_env_module__cluster__main.tf", "start_line": 63}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# SYNTAX TEST \"Terraform.sublime-syntax\"\n\n terraform {\n#@@@@@@@@@ local-definition\n  backend \"gcs\" {\n# @@@@@@@@@@@@@ local-definition\n    prefix = \"minecraft/state\"\n    bucket = \"terraform-larkworthy\"\n  }\n}\n\n# You need to fill these locals out with the project, region and zone\n# Then to boot it up, run:-\n#   gcloud auth application-default login\n#   terraform init\n#   terraform apply\n locals {\n#@@@@@@ local-definition\n  # The Google Cloud Project ID that will host and pay for your Minecraft server\n  project = \"larkworthy-tester\"\n  region  = \"europe-west1\"\n  zone    = \"europe-west1-b\"\n  # Allow members of an external Google group to turn on the server\n  # through the Cloud Console mobile app or https://console.cloud.google.com\n  # Create a group at https://groups.google.com/forum/#!creategroup\n  # and invite members by their email address.\n  enable_switch_access_group = 1\n  minecraft_switch_access_group = \"minecraft-switchers-lark@googlegroups.com\"\n}\n\n\n provider \"google\" {\n#@@@@@@@@@@@@@@@@@ local-definition\n#          @@@@@@ global-definition\n  project = local.project\n  region  = local.region\n}\n\n# Create service account to run service with no permissions\n resource \"google_service_account\" \"minecraft\" {\n#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ local-definition\n#                                   @@@@@@@@@ global-definition\n  account_id   = \"minecraft\"\n  display_name = <<EOT\nhello\nworld\nEOT\n  test = \"Hello, %{ if var.name != \"\" }${var.name}%{ else }unnamed%{ endif }!\"\n  x = <<EOT\n%{ for ip in aws_instance.example[*].private_ip ~}\nserver ${ip}\n%{ endfor }\nEOT\n}\n\n    provider \"name\" {}\n#   @@@@@@@@@@@@@@@ local-definition\n#             @@@@ global-definition\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/SublimeText__Terraform__tests__syntax_test_symbol.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/SublimeText__Terraform__tests__syntax_test_symbol.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/SublimeText__Terraform__tests__syntax_test_symbol.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# This file contains all the interactions with Google Cloud\nprovider \"google\" {\n  region  = var.region\n  project = var.project\n}\n\nprovider \"google-beta\" {\n  region  = var.region\n  project = var.project\n}\n\n# Generate a random id for the project - GCP projects must have globally\n# unique names\nresource \"random_id\" \"project_random\" {\n  prefix      = var.project_prefix\n  byte_length = \"8\"\n}\n\n# Create the project if one isn't specified\nresource \"google_project\" \"vault\" {\n  count           = var.project != \"\" ? 0 : 1\n  name            = random_id.project_random.hex\n  project_id      = random_id.project_random.hex\n  org_id          = var.org_id\n  billing_account = var.billing_account\n}\n\n# Or use an existing project, if defined\ndata \"google_project\" \"vault\" {\n  project_id = var.project != \"\" ? var.project : google_project.vault[0].project_id\n}\n\n# Create the vault service account\nresource \"google_service_account\" \"vault-server\" {\n  account_id   = \"vault-server\"\n  display_name = \"Vault Server\"\n  project      = data.google_project.vault.project_id\n}\n\n# Add the service account to the project\nresource \"google_project_iam_member\" \"service-account\" {\n  count   = length(var.service_account_iam_roles)\n  project = data.google_project.vault.project_id\n  role    = element(var.service_account_iam_roles, count.index)\n  member  = \"serviceAccount:${google_service_account.vault-server.email}\"\n}\n\n# Add user-specified roles\nresource \"google_project_iam_member\" \"service-account-custom\" {\n  count   = length(var.service_account_custom_iam_roles)\n  project = data.google_project.vault.project_id\n  role    = element(var.service_account_custom_iam_roles, count.index)\n  member  = \"serviceAccount:${google_service_account.vault-server.email}\"\n}\n\n# Enable required services on the project\nresource \"google_project_service\" \"service\" {\n  count   = length(var.project_services)\n  project = data.google_project.vault.project_id\n  service = element(var.project_services, count.index)\n\n  # Do not disable the service on destroy. On destroy, we are going to\n  # destroy the project, but we need the APIs available to destroy the\n  # underlying resources.\n  disable_on_destroy = false\n}\n\n# Create the storage bucket\nresource \"google_storage_bucket\" \"vault\" {\n  name          = \"${data.google_project.vault.project_id}-vault-storage\"\n  project       = data.google_project.vault.project_id\n  force_destroy = true\n  storage_class = \"MULTI_REGIONAL\"\n\n  uniform_bucket_level_access = true\n\n  versioning {\n    enabled = true\n  }\n\n  lifecycle_rule {\n    action {\n      type = \"Delete\"\n    }\n\n    condition {\n      num_newer_versions = 1\n    }\n  }\n\n  depends_on = [google_project_service.service]\n}\n\n# Grant service account access to the storage bucket\nresource \"google_storage_bucket_iam_member\" \"vault-server\" {\n  count  = length(var.storage_bucket_roles)\n  bucket = google_storage_bucket.vault.name\n  role   = element(var.storage_bucket_roles, count.index)\n  member = \"serviceAccount:${google_service_account.vault-server.email}\"\n}\n\n# Generate a random suffix for the KMS keyring. Like projects, key rings names\n# must be globally unique within the project. A key ring also cannot be\n# destroyed, so deleting and re-creating a key ring will fail.\n#\n# This uses a random_id to prevent that from happening.\nresource \"random_id\" \"kms_random\" {\n  prefix      = var.kms_key_ring_prefix\n  byte_length = \"8\"\n}\n\n# Obtain the key ring ID or use a randomly generated on.\nlocals {\n  kms_key_ring = var.kms_key_ring != \"\" ? var.kms_key_ring : random_id.kms_random.hex\n}\n\n# Create the KMS key ring\nresource \"google_kms_key_ring\" \"vault\" {\n  name     = local.kms_key_ring\n  location = var.region\n  project  = data.google_project.vault.project_id\n\n  depends_on = [google_project_service.service]\n}\n\n# Create the crypto key for encrypting init keys\nresource \"google_kms_crypto_key\" \"vault-init\" {\n  name            = var.kms_crypto_key\n  key_ring        = google_kms_key_ring.vault.id\n  rotation_period = \"604800s\"\n}\n\n# Grant service account access to the key\nresource \"google_kms_crypto_key_iam_member\" \"vault-init\" {\n  crypto_key_id = google_kms_crypto_key.vault-init.id\n  role          = \"roles/cloudkms.cryptoKeyEncrypterDecrypter\"\n  member        = \"serviceAccount:${google_service_account.vault-server.email}\"\n}\n\n# Create the crypto key for encrypting Kubernetes secrets\nresource \"google_kms_crypto_key\" \"kubernetes-secrets\" {\n  name            = var.kubernetes_secrets_crypto_key\n  key_ring        = google_kms_key_ring.vault.id\n  rotation_period = \"604800s\"\n}\n\n# Grant GKE access to the key\nresource \"google_kms_crypto_key_iam_member\" \"kubernetes-secrets-gke\" {\n  crypto_key_id = google_kms_crypto_key.kubernetes-secrets.id\n  role          = \"roles/cloudkms.cryptoKeyEncrypterDecrypter\"\n  member        = \"serviceAccount:service-${data.google_project.vault.number}@container-engine-robot.iam.gserviceaccount.com\"\n}\n\n# Create an external NAT IP\nresource \"google_compute_address\" \"vault-nat\" {\n  count   = 2\n  name    = \"vault-nat-external-${count.index}\"\n  project = data.google_project.vault.project_id\n  region  = var.region\n\n  depends_on = [google_project_service.service]\n}\n\n# Create a network for GKE\nresource \"google_compute_network\" \"vault-network\" {\n  name                    = \"vault-network\"\n  project                 = data.google_project.vault.project_id\n  auto_create_subnetworks = false\n\n  depends_on = [google_project_service.service]\n}\n\n# Create subnets\nresource \"google_compute_subnetwork\" \"vault-subnetwork\" {\n  name          = \"vault-subnetwork\"\n  project       = data.google_project.vault.project_id\n  network       = google_compute_network.vault-network.self_link\n  region        = var.region\n  ip_cidr_range = var.kubernetes_network_ipv4_cidr\n\n  private_ip_google_access = true\n\n  secondary_ip_range {\n    range_name    = \"vault-pods\"\n    ip_cidr_range = var.kubernetes_pods_ipv4_cidr\n  }\n\n  secondary_ip_range {\n    range_name    = \"vault-svcs\"\n    ip_cidr_range = var.kubernetes_services_ipv4_cidr\n  }\n}\n\n# Create a NAT router so the nodes can reach DockerHub, etc\nresource \"google_compute_router\" \"vault-router\" {\n  name    = \"vault-router\"\n  project = data.google_project.vault.project_id\n  region  = var.region\n  network = google_compute_network.vault-network.self_link\n\n  bgp {\n    asn = 64514\n  }\n}\n\nresource \"google_compute_router_nat\" \"vault-nat\" {\n  name    = \"vault-nat-1\"\n  project = data.google_project.vault.project_id\n  router  = google_compute_router.vault-router.name\n  region  = var.region\n\n  nat_ip_allocate_option = \"MANUAL_ONLY\"\n  nat_ips                = google_compute_address.vault-nat.*.self_link\n\n  source_subnetwork_ip_ranges_to_nat = \"LIST_OF_SUBNETWORKS\"\n\n  subnetwork {\n    name                    = google_compute_subnetwork.vault-subnetwork.self_link\n    source_ip_ranges_to_nat = [\"PRIMARY_IP_RANGE\", \"LIST_OF_SECONDARY_IP_RANGES\"]\n\n    secondary_ip_range_names = [\n      google_compute_subnetwork.vault-subnetwork.secondary_ip_range[0].range_name,\n      google_compute_subnetwork.vault-subnetwork.secondary_ip_range[1].range_name,\n    ]\n  }\n}\n\n# Create the GKE cluster\nresource \"google_container_cluster\" \"vault\" {\n  provider = google-beta\n\n  name     = \"vault\"\n  project  = data.google_project.vault.project_id\n  location = var.region\n\n  network    = google_compute_network.vault-network.self_link\n  subnetwork = google_compute_subnetwork.vault-subnetwork.self_link\n\n  initial_node_count = var.kubernetes_nodes_per_zone\n\n  release_channel {\n    channel = var.kubernetes_release_channel\n  }\n\n  logging_service    = var.kubernetes_logging_service\n  monitoring_service = var.kubernetes_monitoring_service\n\n  # Disable legacy ACLs. The default is false, but explicitly marking it false\n  # here as well.\n  enable_legacy_abac = false\n\n  database_encryption {\n    state    = \"ENCRYPTED\"\n    key_name = google_kms_crypto_key.kubernetes-secrets.self_link\n  }\n\n  node_config {\n    machine_type    = var.kubernetes_instance_type\n    service_account = google_service_account.vault-server.email\n\n    oauth_scopes = [\n      \"https://www.googleapis.com/auth/cloud-platform\",\n    ]\n\n    # Set metadata on the VM to supply more entropy\n    metadata = {\n      google-compute-enable-virtio-rng = \"true\"\n      disable-legacy-endpoints         = \"true\"\n    }\n\n    labels = {\n      service = \"vault\"\n    }\n\n    tags = [\"vault\"]\n\n    # Protect node metadata\n    workload_metadata_config {\n      node_metadata = \"SECURE\"\n    }\n  }\n\n  # Configure various addons\n  addons_config {\n    # Enable network policy configurations (like Calico).\n    network_policy_config {\n      disabled = false\n    }\n  }\n\n  # Disable basic authentication and cert-based authentication.\n  master_auth {\n    username = \"\"\n    password = \"\"\n\n    client_certificate_config {\n      issue_client_certificate = false\n    }\n  }\n\n  # Enable network policy configurations (like Calico) - for some reason this\n  # has to be in here twice.\n  network_policy {\n    enabled = true\n  }\n\n  # Set the maintenance window.\n  maintenance_policy {\n    daily_maintenance_window {\n      start_time = var.kubernetes_daily_maintenance_window\n    }\n  }\n\n  # Allocate IPs in our subnetwork\n  ip_allocation_policy {\n    cluster_secondary_range_name  = google_compute_subnetwork.vault-subnetwork.secondary_ip_range[0].range_name\n    services_secondary_range_name = google_compute_subnetwork.vault-subnetwork.secondary_ip_range[1].range_name\n  }\n\n  # Specify the list of CIDRs which can access the master's API\n  master_authorized_networks_config {\n    dynamic \"cidr_blocks\" {\n      for_each = var.kubernetes_master_authorized_networks\n      content {\n        cidr_block   = cidr_blocks.value.cidr_block\n        display_name = cidr_blocks.value.display_name\n      }\n    }\n  }\n\n  # Configure the cluster to be private (not have public facing IPs)\n  private_cluster_config {\n    # This field is misleading. This prevents access to the master API from\n    # any external IP. While that might represent the most secure\n    # configuration, it is not ideal for most setups. As such, we disable the\n    # private endpoint (allow the public endpoint) and restrict which CIDRs\n    # can talk to that endpoint.\n    enable_private_endpoint = false\n\n    enable_private_nodes   = true\n    master_ipv4_cidr_block = var.kubernetes_masters_ipv4_cidr\n  }\n\n  depends_on = [\n    google_project_service.service,\n    google_kms_crypto_key_iam_member.vault-init,\n    google_kms_crypto_key_iam_member.kubernetes-secrets-gke,\n    google_storage_bucket_iam_member.vault-server,\n    google_project_iam_member.service-account,\n    google_project_iam_member.service-account-custom,\n    google_compute_router_nat.vault-nat,\n  ]\n}\n\n# Provision IP\nresource \"google_compute_address\" \"vault\" {\n  name    = \"vault-lb\"\n  region  = var.region\n  project = data.google_project.vault.project_id\n\n  depends_on = [google_project_service.service]\n}\n\noutput \"address\" {\n  value = google_compute_address.vault.address\n}\n\noutput \"project\" {\n  value = data.google_project.vault.project_id\n}\n\noutput \"region\" {\n  value = var.region\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_27", "severity": "HIGH", "message": "Ensure that the default network does not exist in a project", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 20}, {"tool": "checkov", "rule_id": "CKV_GCP_62", "severity": "HIGH", "message": "Bucket should log access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 69}, {"tool": "checkov", "rule_id": "CKV_GCP_114", "severity": "HIGH", "message": "Ensure public access prevention is enforced on Cloud Storage bucket", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 69}, {"tool": "checkov", "rule_id": "CKV_GCP_82", "severity": "HIGH", "message": "Ensure KMS keys are protected from deletion", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 127}, {"tool": "checkov", "rule_id": "CKV_GCP_82", "severity": "HIGH", "message": "Ensure KMS keys are protected from deletion", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 141}, {"tool": "checkov", "rule_id": "CKV_GCP_26", "severity": "HIGH", "message": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 174}, {"tool": "checkov", "rule_id": "CKV_GCP_66", "severity": "HIGH", "message": "Ensure use of Binary Authorization", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 229}, {"tool": "checkov", "rule_id": "CKV_GCP_61", "severity": "HIGH", "message": "Enable VPC Flow Logs and Intranode Visibility", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 229}, {"tool": "checkov", "rule_id": "CKV_GCP_21", "severity": "HIGH", "message": "Ensure Kubernetes Clusters are configured with Labels", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 229}, {"tool": "checkov", "rule_id": "CKV_GCP_65", "severity": "HIGH", "message": "Manage Kubernetes RBAC users with Google Groups for GKE", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 229}, {"tool": "checkov", "rule_id": "CKV_GCP_69", "severity": "HIGH", "message": "Ensure the GKE Metadata Server is Enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 229}, {"tool": "checkov", "rule_id": "CKV_GCP_68", "severity": "HIGH", "message": "Ensure Secure Boot for Shielded GKE Nodes is Enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 229}, {"tool": "checkov", "rule_id": "CKV2_GCP_5", "severity": "CRITICAL", "message": "Ensure that Cloud Audit Logging is configured properly across all services and all users from a project", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 20}, {"tool": "checkov", "rule_id": "CKV2_GCP_18", "severity": "CRITICAL", "message": "Ensure GCP network defines a firewall and does not use the default firewall", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__gcp.tf", "start_line": 165}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.3.0\"\n\n  required_providers {\n    local = {\n      source  = \"hashicorp/local\"\n      version = \">= 1.2\"\n    }\n    aws = {\n      source = \"hashicorp/aws\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-ecs-container-definition__examples__complete__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"aws_region\" {\n  description = \"The AWS region to deploy resources in\"\n  type        = string\n  default     = \"us-east-1\"\n}\n\nvariable \"vpc_cidr_block\" {\n  description = \"The CIDR block for the VPC\"\n  type        = string\n  default     = \"10.0.0.0/16\"\n}\n\nvariable \"vpc_enable_dns_hostnames\" {\n  description = \"Enable DNS hostnames in the VPC\"\n  type        = bool\n  default     = true\n}\n\nvariable \"vpc_subnet_cidr\" {\n  description = \"The CIDR block for the public subnet\"\n  type        = string\n  default     = \"10.0.0.0/24\"\n}\n\nvariable \"map_public_ip_on_launch\" {\n  description = \"Whether to map public IPs on launch for the subnet\"\n  type        = bool\n  default     = true\n}\n\nvariable \"http_port\" {\n  description = \"The HTTP port for the application\"\n  type        = number\n}\n\nvariable \"ec2_instance_type\" {\n  description = \"The type of EC2 instance to launch\"\n  type        = string\n}\n\nvariable \"company_name\" {\n  description = \"The name of the company\"\n  type        = string\n  default     = \"Globomantics\"\n}\n\nvariable \"project\" {\n  description = \"The name of the project\"\n  type        = string\n}\n\nvariable \"environment\" {\n  description = \"The environment for the deployment (e.g., dev, staging, prod)\"\n  type        = string\n}\n\nvariable \"billing_code\" {\n  description = \"The billing code for the project\"\n  type        = string\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m6_solution__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"tls_private_key\" \"baz\" {}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-docs__terraform-docs__terraform__testdata__no-modulecalls__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nterraform {\n  required_version = \">= 0.12\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in4it__terraform-modules__modules__alb__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2022 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nterraform {\n  required_version = \">= 0.13\"\n  required_providers {\n\n    google = {\n      source  = \"hashicorp/google\"\n      version = \"~> 4.56.0\"\n    }\n\n    google-beta = {\n      source  = \"hashicorp/google-beta\"\n      version = \"~> 4.56.0\"\n    }\n\n  }\n\n  # Terraform state stored in GCS\n  backend \"gcs\" {}\n}\n\n# Core Vertex Pipelines infrastructure\nmodule \"vertex_deployment\" {\n  source     = \"../../modules/vertex_deployment\"\n  project_id = var.project_id\n  region     = var.region\n}\n\n# Cloud Scheduler jobs (for triggering pipelines)\nmodule \"scheduler\" {\n  for_each            = var.cloud_schedulers_config\n  source              = \"../../modules/scheduled_pipelines\"\n  project_id          = var.project_id\n  region              = var.region\n  name                = each.value.name\n  description         = lookup(each.value, \"description\", null)\n  schedule            = each.value.schedule\n  time_zone           = lookup(each.value, \"time_zone\", \"UTC\")\n  topic_name          = module.vertex_deployment.pubsub_topic_id\n  template_path       = each.value.template_path\n  enable_caching      = lookup(each.value, \"enable_caching\", null)\n  pipeline_parameters = lookup(each.value, \"pipeline_parameters\", null)\n  depends_on          = [module.vertex_deployment]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__vertex-pipelines-end-to-end-samples__terraform__envs__prod__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nmodule \"child_d\" {\n  source  = \"example.com/foo/bar_d/baz\"\n  # Intentionally no version here\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/camptocamp__terraboard__internal__terraform__configs__configload__testdata__already-installed__.terraform__modules__child_b__child_b.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/camptocamp__terraboard__internal__terraform__configs__configload__testdata__already-installed__.terraform__modules__child_b__child_b.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/camptocamp__terraboard__internal__terraform__configs__configload__testdata__already-installed__.terraform__modules__child_b__child_b.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#--------------\n# VPC Definition\n#--------------\nresource \"aws_vpc\" \"saha_vpc\" {\n  cidr_block           = \"172.10.0.0/16\"\n  instance_tenancy     = \"default\"\n\n  enable_dns_support   = \"true\"\n  enable_dns_hostnames = \"true\"\n\n  tags = {\n    Name               = \"saha-sandbox-vpc\"\n  }\n}\n\n#-------------\n# Data for AZ\n#-------------\ndata \"aws_availability_zones\" \"azs\" {\n  state = \"available\"\n}\n\n\n#------------------------\n# Public Subnet Settings \n#------------------------\n# Create Public Subnets\nresource \"aws_subnet\" \"public_subnet\" {\n  count                   = 3\n\n  vpc_id                  = aws_vpc.saha_vpc.id\n  cidr_block              = \"172.10.${count.index + 1}.0/24\"\n  availability_zone       = element(var.availability_zones, count.index)\n\n  map_public_ip_on_launch = true\n\n  tags = {\n    Name = \"saha-sandbox-public-subnet-${count.index + 1}\"\n  }\n}\n\n#-------------------------\n# Private Subnet Settings \n#-------------------------\nresource \"aws_subnet\" \"private_subnet\" {\n  count                   = 3\n\n  vpc_id                  = aws_vpc.saha_vpc.id\n  cidr_block              = \"172.10.${count.index + 4}.0/24\"\n#  availability_zone       = \"var.availability_zones.{count.index}\"\n  availability_zone       = element(var.availability_zones, count.index)\n\n  map_public_ip_on_launch = false\n\n  tags = {\n    Name = \"saha-sandbox-private-subnet-${count.index + 1}\"\n  }\n}\n\n\n#-----------------------------\n# Public Route Table Settings\n#-----------------------------\nresource \"aws_route_table\" \"saha-sandbox_rt\" {\n  vpc_id                  = aws_vpc.saha_vpc.id\n\n  route {\n    cidr_block            = \"0.0.0.0/0\"\n    gateway_id            = aws_internet_gateway.saha_igw.id\n  }\n\n  tags = {\n    Name                  = \"saha-sandbox-public-rt\"\n  }\n}\n\n\n#-----------------------------\n# Private Route Table Settings\n#-----------------------------\nresource \"aws_route_table\" \"saha-sandbox_private_rt\" {\n  vpc_id                  = aws_vpc.saha_vpc.id\n\n\n  tags = {\n    Name                  = \"saha-sandbox-private-rt\"\n  }\n}\n\n\n#--------------------------------\n# Public Route Table Association \n#--------------------------------\nresource \"aws_route_table_association\" \"rt_a\" {\n  count                   = 3\n  subnet_id               = element(aws_subnet.public_subnet.*.id, count.index)\n  route_table_id          = element(aws_route_table.saha-sandbox_rt.*.id, count.index)\n}\n\n\n#---------------------------------\n# Private Route Table Association \n#---------------------------------\nresource \"aws_route_table_association\" \"rt_b\" {\n  count                   = 3\n  subnet_id               = element(aws_subnet.private_subnet.*.id, count.index)\n  route_table_id          = element(aws_route_table.saha-sandbox_private_rt.*.id, count.index)\n}\n\n\n\n#-----------------\n# Internet Gateway\n#-----------------\nresource \"aws_internet_gateway\" \"saha_igw\" {\n  vpc_id                  = aws_vpc.saha_vpc.id\n\n  tags = {\n    Name                  = \"saha-sandbox-igw\"\n  }\n}\n\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/frankisinfotech__terraform__aws__aws-services-infra__vpc.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: Apache-2.0\n\n# Outputs file\noutput \"catapp_url\" {\n  value = \"http://${azurerm_public_ip.catapp-pip.fqdn}\"\n}\n\noutput \"catapp_ip\" {\n  value = \"http://${azurerm_public_ip.catapp-pip.ip_address}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__hashicat-azure__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\n// tfsec:ignore:*\nresource \"aws_s3_bucket\" \"bkt\" {\n\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__ignored__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__ignored__main.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__ignored__main.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__ignored__main.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__ignored__main.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__ignored__main.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__ignored__main.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__ignored__main.tf", "start_line": 3}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"region\" {\n  description = \"AWS region\"\n  type        = string\n  default     = \"us-east-1\"\n}\n\nvariable \"allowed_ip\" {\n  description = \"IP address allowed to access the ingress controller\"\n  type        = string\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/latiotech__insecure-kubernetes-deployments__terraform__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#----------------------------------------------------------\n# My Terraform\n#\n# Build WebServer during Bootstrap\n#\n# Made by Denis Astahov\n#----------------------------------------------------------\n\n\nprovider \"aws\" {\n  region = \"eu-central-1\"\n}\n\nresource \"aws_default_vpc\" \"default\" {} # This need to be added since AWS Provider v4.29+ to get VPC id\n\nresource \"aws_instance\" \"my_webserver\" {\n  ami                    = \"ami-03a71cec707bfc3d7\"\n  instance_type          = \"t3.micro\"\n  vpc_security_group_ids = [aws_security_group.my_webserver.id]\n  user_data = templatefile(\"user_data.sh.tpl\", {\n    f_name = \"Denis\",\n    l_name = \"Astahov\",\n    names  = [\"Vasya\", \"Kolya\", \"Petya\", \"John\", \"Donald\", \"Masha\"]\n  })\n\n  tags = {\n    Name  = \"Web Server Build by Terraform\"\n    Owner = \"Denis Astahov\"\n  }\n}\n\n\nresource \"aws_security_group\" \"my_webserver\" {\n  name        = \"WebServer Security Group\"\n  description = \"My First SecurityGroup\"\n  vpc_id      = aws_default_vpc.default.id # This need to be added since AWS Provider v4.29+ to set VPC id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name  = \"Web Server SecurityGroup\"\n    Owner = \"Denis Astahov\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-04__WebServer.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_148", "severity": "HIGH", "message": "Ensure no default VPC is planned to be provisioned", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-04__WebServer.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-04__WebServer.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-04__WebServer.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-04__WebServer.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-04__WebServer.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-04__WebServer.tf", "start_line": 33}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-04__WebServer.tf", "start_line": 33}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-04__WebServer.tf", "start_line": 33}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-04__WebServer.tf", "start_line": 16}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# data \"template_file\" \"dev-s3\" {\n#   template = file(\"${path.module}/../assets/s3-backup.json\")\n\n#   vars = {\n#     s3_backup_bucket = var.DEV_MODE_scripts_s3_bucket\n#   }\n# }\n\n# resource \"aws_s3_bucket\" \"dev\" {\n#   count = var.DEV_MODE_scripts_s3_bucket == \"\" ? 0 : 1\n\n#   bucket = \"${var.DEV_MODE_scripts_s3_bucket}\"\n#   region = var.aws_region\n#   acl    = \"private\"\n# }\n\n# resource \"aws_iam_role_policy\" \"dev-s3\" {\n#   count  = var.DEV_MODE_scripts_s3_bucket != \"\" ? 1 : 0\n#   name   = \"${var.es_cluster}-elasticsearch-s3-devmode-policy\"\n#   role   = aws_iam_role.elasticsearch.id\n#   policy = data.template_file.dev-s3.rendered\n# }\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BigDataBoutique__elasticsearch-cloud-deploy__terraform-aws__dev.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Security Group All Traffic Attached To Instnaces In instances.tf\nresource \"aws_security_group\" \"demo_sg\" {\n  name        = \"Allow_All_Ports\"\n  description = \"Allow All Ports All Protocals\"\n  vpc_id      = aws_vpc.vpc.id\n  ingress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/MithunTechnologiesDevOps__Terraform_Scripts__VPC__security-groups.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/MithunTechnologiesDevOps__Terraform_Scripts__VPC__security-groups.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/MithunTechnologiesDevOps__Terraform_Scripts__VPC__security-groups.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/MithunTechnologiesDevOps__Terraform_Scripts__VPC__security-groups.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_25", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/MithunTechnologiesDevOps__Terraform_Scripts__VPC__security-groups.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/MithunTechnologiesDevOps__Terraform_Scripts__VPC__security-groups.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_277", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/MithunTechnologiesDevOps__Terraform_Scripts__VPC__security-groups.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/MithunTechnologiesDevOps__Terraform_Scripts__VPC__security-groups.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#####################################################################\n# Block-1: Terraform Settings Block\nterraform {\n  required_version = \"~> 1.4\"\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \">= 4.0\"\n    }\n  }\n  # Adding Backend as S3 for Remote State Storage with State Locking\n  backend \"s3\" {\n    bucket = \"terraform-stacksimplify\"\n    key    = \"dev2/terraform.tfstate\"\n    region = \"us-east-1\"  \n\n    # For State Locking\n    dynamodb_table = \"terraform-dev-state-table\"\n  }\n}\n#####################################################################\n# Block-2: Provider Block\nprovider \"aws\" {\n  profile = \"default\" # AWS Credentials Profile configured on your local desktop terminal  $HOME/.aws/credentials\n  region  = \"us-east-1\"\n}\n#####################################################################\n# Block-3: Resource Block\nresource \"aws_instance\" \"ec2demo\" {\n  ami           = \"ami-04d29b6f966df1537\" # Amazon Linux\n  instance_type = var.instance_type\n}\n#####################################################################\n# Block-4: Input Variables Block\nvariable \"instance_type\" {\n  default = \"t2.micro\"\n  description = \"EC2 Instance Type\"\n  type = string\n}\n#####################################################################\n# Block-5: Output Values Block\noutput \"ec2_instance_publicip\" {\n  description = \"EC2 Instance Public IP\"\n  value = aws_instance.my-ec2-vm.public_ip\n}\n#####################################################################\n# Block-6: Local Values Block\n# Create S3 Bucket - with Input Variables & Local Values\nlocals {\n  bucket-name-prefix = \"${var.app_name}-${var.environment_name}\"\n}\n#####################################################################\n# Block-7: Data sources Block\n# Get latest AMI ID for Amazon Linux2 OS\ndata \"aws_ami\" \"amzlinux\" {\n  most_recent      = true\n  owners           = [\"amazon\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"amzn2-ami-hvm-*\"]\n  }\n\n  filter {\n    name   = \"root-device-type\"\n    values = [\"ebs\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  filter {\n    name   = \"architecture\"\n    values = [\"x86_64\"]\n  }\n\n}\n#####################################################################\n# Block-8: Modules Block\n# AWS EC2 Instance Module\n\nmodule \"ec2_cluster\" {\n  source                 = \"terraform-aws-modules/ec2-instance/aws\"\n  version                = \"~> 2.0\"\n\n  name                   = \"my-modules-demo\"\n  instance_count         = 2\n\n  ami                    = data.aws_ami.amzlinux.id\n  instance_type          = \"t2.micro\"\n  key_name               = \"terraform-key\"\n  monitoring             = true\n  vpc_security_group_ids = [\"sg-08b25c5a5bf489ffa\"]  # Get Default VPC Security Group ID and replace\n  subnet_id              = \"subnet-4ee95470\" # Get one public subnet id from default vpc and replace\n  user_data               = file(\"apache-install.sh\")\n\n  tags = {\n    Terraform   = \"true\"\n    Environment = \"dev\"\n  }\n}\n#####################################################################", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 84}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate__02-Terraform-Basics__02-03-Terraform-Language-Syntax__terraform-manifests__top-level-blocks-samples.tf", "start_line": 29}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n    access_key = \"${var.aws_access_key}\"\n    secret_key = \"${var.aws_secret_key}\"\n    region = \"${var.aws_region}\"\n}\n\nresource \"aws_vpc\" \"default\" {\n    cidr_block = \"${var.vpc_cidr}\"\n    enable_dns_hostnames = true\n    tags = {\n        Name = \"${var.vpc_name}\"\n    }\n}\n\nresource \"aws_internet_gateway\" \"default\" {\n    vpc_id = \"${aws_vpc.default.id}\"\n\ttags = {\n        Name = \"${var.IGW_name}\"\n    }\n}\n\nresource \"aws_subnet\" \"subnet1-public\" {\n    vpc_id = \"${aws_vpc.default.id}\"\n    cidr_block = \"${var.public_subnet1_cidr}\"\n    availability_zone = \"us-east-1a\"\n\n    tags = {\n        Name = \"${var.public_subnet1_name}\"\n    }\n}\n\nresource \"aws_subnet\" \"subnet2-public\" {\n    vpc_id = \"${aws_vpc.default.id}\"\n    cidr_block = \"${var.public_subnet2_cidr}\"\n    availability_zone = \"us-east-1b\"\n\n    tags = {\n        Name = \"${var.public_subnet2_name}\"\n    }\n}\n\nresource \"aws_subnet\" \"subnet3-public\" {\n    vpc_id = \"${aws_vpc.default.id}\"\n    cidr_block = \"${var.public_subnet3_cidr}\"\n    availability_zone = \"us-east-1c\"\n\n    tags = {\n        Name = \"${var.public_subnet3_name}\"\n    }\n\t\n}\n\n\nresource \"aws_route_table\" \"terraform-public\" {\n    vpc_id = \"${aws_vpc.default.id}\"\n\n    route {\n        cidr_block = \"0.0.0.0/0\"\n        gateway_id = \"${aws_internet_gateway.default.id}\"\n    }\n\n    tags = {\n        Name = \"${var.Main_Routing_Table}\"\n    }\n}\n\nresource \"aws_route_table_association\" \"terraform-public\" {\n    subnet_id = \"${aws_subnet.subnet1-public.id}\"\n    route_table_id = \"${aws_route_table.terraform-public.id}\"\n}\n\nresource \"aws_security_group\" \"allow_all\" {\n  name        = \"allow_all\"\n  description = \"Allow all inbound traffic\"\n  vpc_id      = \"${aws_vpc.default.id}\"\n\n  ingress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port       = 0\n    to_port         = 0\n    protocol        = \"-1\"\n    cidr_blocks     = [\"0.0.0.0/0\"]\n    }\n}\n\n#data \"aws_ami\" \"my_ami\" {\n#      most_recent      = true\n#      #name_regex       = \"^mavrick\"\n#      owners           = [\"444984551434\"]\n#}\n\n\nresource \"aws_instance\" \"web-1\" {\n    #ami = \"${data.aws_ami.my_ami.id}\"\n    ami = \"ami-0d857ff0f5fc4e03b\"\n    availability_zone = \"us-east-1a\"\n    instance_type = \"t2.micro\"\n    key_name = \"LaptopKey\"\n    subnet_id = \"${aws_subnet.subnet1-public.id}\"\n    vpc_security_group_ids = [\"${aws_security_group.allow_all.id}\"]\n    associate_public_ip_address = true\t\n    tags = {\n        Name = \"Server-1\"\n        Env = \"Prod\"\n        Owner = \"Sree\"\n    }\n}\n\n#output \"ami_id\" {\n#  value = \"${data.aws_ami.my_ami.id}\"\n#}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 72}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 72}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 72}, {"tool": "checkov", "rule_id": "CKV_AWS_25", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 72}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 72}, {"tool": "checkov", "rule_id": "CKV_AWS_277", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 72}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 99}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 99}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 99}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 99}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 99}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__main.tf", "start_line": 99}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"my_server\" {\n  ami           = \"ami-087c17d1fe0178315\"\n  instance_type = var.instance_type\n\n  tags = {\n    Name = \"MyServer-${local.project_name}\"\n  }\n}\n\n/*\nmodule \"vpc\" {\n  source = \"terraform-aws-modules/vpc/aws\"\n  providers = {\n    aws = aws.eu\n  }\n\n  name = \"my-vpc\"\n  cidr = \"10.0.0.0/16\"\n\n  azs             = [\"eu-west-1a\", \"eu-west-1b\", \"eu-west-1c\"]\n  private_subnets = [\"10.0.1.0/24\", \"10.0.2.0/24\", \"10.0.3.0/24\"]\n  public_subnets  = [\"10.0.101.0/24\", \"10.0.102.0/24\", \"10.0.103.0/24\"]\n\n  enable_nat_gateway = true\n  enable_vpn_gateway = true\n\n  tags = {\n    Terraform = \"true\"\n    Environment = \"dev\"\n  }\n}\n*/", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__000_getting_started__aws.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__000_getting_started__aws.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__000_getting_started__aws.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__000_getting_started__aws.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__000_getting_started__aws.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__000_getting_started__aws.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nvariable \"region\" {\n  description = \"AWS region\"\n  default     = \"us-west-1\"\n}\n\nvariable \"instance_type\" {\n  description = \"Type of EC2 instance to provision\"\n  default     = \"t2.micro\"\n}\n\nvariable \"instance_name\" {\n  description = \"EC2 instance name\"\n  default     = \"Provisioned by Terraform\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__tfc-guide-example__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"kustomization\" {\n  alias          = \"gke_zero\"\n  kubeconfig_raw = module.gke_zero.kubeconfig\n}\n\nprovider \"kubernetes\" {\n  alias = \"gke_zero\"\n\n  host                   = local.gke_zero_kubeconfig[\"clusters\"][0][\"cluster\"][\"server\"]\n  cluster_ca_certificate = base64decode(local.gke_zero_kubeconfig[\"clusters\"][0][\"cluster\"][\"certificate-authority-data\"])\n  token                  = local.gke_zero_kubeconfig[\"users\"][0][\"user\"][\"token\"]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kbst__terraform-kubestack__tests__gke_zero_providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.0\"\n    }\n  }\n\n  backend \"s3\" {\n    bucket = \"<SET TO YOUR BUCKET NAME>\"\n    region = \"us-east-1\"\n    \n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m6_solution__terraform.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_role_policy_attachment\" \"iam-policy\" {\n  role = aws_iam_role.iam-role.name\n  # Just for testing purpose, don't try to give administrator access\n  policy_arn = \"arn:aws:iam::aws:policy/AdministratorAccess\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__iam-policy.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Create container in storage acc and container for use by blob mount tests\nresource \"azurerm_storage_account\" \"blobaccount\" {\n  name                     = \"${local.prefix}blob\"\n  resource_group_name      = azurerm_resource_group.example.name\n  location                 = azurerm_resource_group.example.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"LRS\"\n  account_kind             = \"StorageV2\"\n  tags                     = local.tags\n}\n\nresource \"azurerm_storage_container\" \"sample\" {\n  name                  = \"sample\"\n  storage_account_name  = azurerm_storage_account.blobaccount.name\n  container_access_type = \"private\"\n}\n\noutput \"test_storage_v2_account_name\" {\n  value = azurerm_storage_account.blobaccount.name\n}\n\noutput \"test_storage_v2_account_key\" {\n  value     = azurerm_storage_account.blobaccount.primary_access_key\n  sensitive = true\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_59", "severity": "HIGH", "message": "Ensure that Storage accounts disallow public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AZURE_33", "severity": "HIGH", "message": "Ensure Storage logging is enabled for Queue service for read, write and delete requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AZURE_44", "severity": "HIGH", "message": "Ensure Storage Account is using the latest version of TLS encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AZURE_206", "severity": "HIGH", "message": "Ensure that Storage Accounts use replication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AZURE_190", "severity": "HIGH", "message": "Ensure that Storage blobs restrict public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AZURE_40", "severity": "CRITICAL", "message": "Ensure storage account is not configured with Shared Key authorization", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AZURE_47", "severity": "CRITICAL", "message": "Ensure storage account is configured without blob anonymous access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AZURE_33", "severity": "CRITICAL", "message": "Ensure storage account is configured with private endpoint", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AZURE_41", "severity": "CRITICAL", "message": "Ensure storage account is configured with SAS expiration policy", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AZURE_38", "severity": "CRITICAL", "message": "Ensure soft-delete is enabled on Azure storage account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AZURE_1", "severity": "CRITICAL", "message": "Ensure storage for critical data are encrypted with Customer Managed Key", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AZURE_21", "severity": "CRITICAL", "message": "Ensure Storage logging is enabled for Blob service for read requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__storage.tf", "start_line": 12}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\noutput \"bucket\" {\n  description = \"The created storage bucket\"\n  value       = google_storage_bucket.bucket\n}\n\noutput \"name\" {\n  description = \"Bucket name.\"\n  value       = google_storage_bucket.bucket.name\n}\n\noutput \"url\" {\n  description = \"Bucket URL.\"\n  value       = google_storage_bucket.bucket.url\n}\n\noutput \"internal_kms_configuration\" {\n  description = \"The intenal KMS Resource.\"\n  value       = var.internal_encryption_config.create_encryption_key ? module.encryption_key[0] : null\n}\n\noutput \"apphub_service_uri\" {\n  value = {\n    service_uri = \"//storage.googleapis.com/${element(split(\"//\", google_storage_bucket.bucket.url), 1)}\"\n    service_id  = substr(google_storage_bucket.bucket.name, 0, 63)\n    location    = var.location\n  }\n  description = \"URI in CAIS style to be used by Apphub.\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-cloud-storage__modules__simple_bucket__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource: EC2 Instance\nresource \"aws_instance\" \"myec2\" {\n  ami           = \"ami-0e5b6b6a9f3db6db8\"\n  instance_type = \"t2.micro\"\n  user_data     = file(\"${path.module}/app1-install.sh\")\n  tags = {\n    \"Name\" = \"EC2 Demo\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__04 - Settings__Project-04__ec2-04-solution__ec2instance.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__04 - Settings__Project-04__ec2-04-solution__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__04 - Settings__Project-04__ec2-04-solution__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__04 - Settings__Project-04__ec2-04-solution__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__04 - Settings__Project-04__ec2-04-solution__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-master-class-series__04 - Settings__Project-04__ec2-04-solution__ec2instance.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ---------------------------------------------------------------------------------------------------------------------\n# PIN TERRAFORM VERSION TO >= 0.12\n# The examples have been upgraded to 0.12 syntax\n# ---------------------------------------------------------------------------------------------------------------------\nprovider \"aws\" {\n  region = var.region\n}\n\nterraform {\n  # This module is now only being tested with Terraform 0.13.x. However, to make upgrading easier, we are setting\n  # 0.12.26 as the minimum version, as that version added support for required_providers with source URLs, making it\n  # forwards compatible with 0.13.x code.\n  required_version = \">= 0.12.26\"\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE THE DYNAMODB TABLE\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_dynamodb_table\" \"example\" {\n  name         = var.table_name\n  hash_key     = \"userId\"\n  range_key    = \"department\"\n  billing_mode = \"PAY_PER_REQUEST\"\n\n  server_side_encryption {\n    enabled = true\n  }\n  point_in_time_recovery {\n    enabled = true\n  }\n\n  attribute {\n    name = \"userId\"\n    type = \"S\"\n  }\n  attribute {\n    name = \"department\"\n    type = \"S\"\n  }\n\n  ttl {\n    enabled        = true\n    attribute_name = \"expires\"\n  }\n\n  tags = {\n    Environment = \"production\"\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terratest__examples__terraform-aws-dynamodb-example__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terratest__examples__terraform-aws-dynamodb-example__main.tf", "start_line": 20}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"lambda_name\" {\n  value = module.format_currency_lambda.tf_way_lambda_function_name\n}\n\noutput lambda_arn {\n  value = module.format_currency_lambda.tf_way_lambda_arn\n}\n\noutput \"lambda_role_arn\" {\n  value = module.lambda_tf_way_role.lambda_role_arn\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nsriram__lambda-the-terraform-way__samples__06__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"s3\" {\n    bucket         = \"abhishek-s3-demo-xyz\" # change this\n    key            = \"abhi/terraform.tfstate\"\n    region         = \"us-east-1\"\n    encrypt        = true\n    dynamodb_table = \"terraform-lock\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-4__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n//\n// Get information about existing ALB HTTP Router\n//\ndata \"yandex_alb_http_router\" \"tf-router\" {\n  http_router_id = \"my-http-router-id\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/yandex-cloud__terraform-provider-yandex__examples__alb_http_router__d_alb_http_router_1.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_policy\" \"privesc11-PutGroupPolicy\" {\n  name        = \"privesc11-PutGroupPolicy\"\n  path        = \"/\"\n  description = \"Allows privesc via iam:PutGroupPolicy\"\n\n  # Terraform's \"jsonencode\" function converts a\n  # Terraform expression result to valid JSON syntax.\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"iam:PutGroupPolicy\"\n        Effect   = \"Allow\"\n        Resource = \"*\"\n      },\n    ]\n  })\n}\n\nresource \"aws_iam_role\" \"privesc11-PutGroupPolicy-role\" {\n  name                = \"privesc11-PutGroupPolicy-role\"\n  assume_role_policy  = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Sid    = \"\"\n        Principal = {\n          AWS = var.aws_assume_role_arn\n        }\n      },\n    ]\n  })\n}\n\nresource \"aws_iam_user\" \"privesc11-PutGroupPolicy-user\" {\n  name = \"privesc11-PutGroupPolicy-user\"\n  path = \"/\"\n}\n\n resource \"aws_iam_access_key\" \"privesc11-PutGroupPolicy-user\" {\n   user = aws_iam_user.privesc11-PutGroupPolicy-user.name\n }\n\n\nresource \"aws_iam_user_policy_attachment\" \"privesc11-PutGroupPolicy-user-attach-policy\" {\n  user       = aws_iam_user.privesc11-PutGroupPolicy-user.name\n  policy_arn = aws_iam_policy.privesc11-PutGroupPolicy.arn\n}\n\nresource \"aws_iam_role_policy_attachment\" \"privesc11-PutGroupPolicy-role-attach-policy\" {\n  role       = aws_iam_role.privesc11-PutGroupPolicy-role.name\n  policy_arn = aws_iam_policy.privesc11-PutGroupPolicy.arn\n}\n\nresource \"aws_iam_group\" \"privesc11-PutGroupPolicy-group\" {\n  name = \"privesc11-PutGroupPolicy-group\"\n  path = \"/\"\n}\n\nresource \"aws_iam_group_membership\" \"privesc11-PutGroupPolicy-group-membership\" {\n  name = \"privesc11-PutGroupPolicy-group-membership\"\n\n  users = [\n    aws_iam_user.privesc11-PutGroupPolicy-user.name\n  ]\n\n  group = aws_iam_group.privesc11-PutGroupPolicy-group.name\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc11-PutGroupPolicy.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_289", "severity": "HIGH", "message": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc11-PutGroupPolicy.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_286", "severity": "HIGH", "message": "Ensure IAM policies does not allow privilege escalation", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc11-PutGroupPolicy.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc11-PutGroupPolicy.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc11-PutGroupPolicy.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_40", "severity": "HIGH", "message": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc11-PutGroupPolicy.tf", "start_line": 47}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 3.0\"\n    }\n  }\n  backend \"s3\" {\n    bucket = \"dcube-terraform-state\"\n    # key    = \"dev/vpc.tfstate\"\n    region         = \"us-west-2\"\n    dynamodb_table = aws_dynamodb_table.state_lock.name\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\nresource \"aws_dynamodb_table\" \"state_lock\" {\n  name         = \"terraform-state-lock\"\n  billing_mode = \"PAY_PER_REQUEST\"\n  hash_key     = \"LockID\"\n\n  attribute {\n    name = \"LockID\"\n    type = \"S\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__terraform-aws__provider.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_28", "severity": "HIGH", "message": "Ensure DynamoDB point in time recovery (backup) is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__terraform-aws__provider.tf", "start_line": 20}, {"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__terraform-aws__provider.tf", "start_line": 20}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"region\" {\n  default = \"us-west1\"\n}\n\nvariable \"zone\" {\n  default = \"us-west1-b\"\n}\n\nvariable \"network_name\" {\n  default = \"tf-gke-k8s\"\n}\n\nprovider \"google\" {\n  region = \"${var.region}\"\n}\n\nresource \"google_compute_network\" \"default\" {\n  name                    = \"${var.network_name}\"\n  auto_create_subnetworks = false\n}\n\nresource \"google_compute_subnetwork\" \"default\" {\n  name                     = \"${var.network_name}\"\n  ip_cidr_range            = \"10.127.0.0/20\"\n  network                  = \"${google_compute_network.default.self_link}\"\n  region                   = \"${var.region}\"\n  private_ip_google_access = true\n}\n\ndata \"google_client_config\" \"current\" {}\n\ndata \"google_container_engine_versions\" \"default\" {\n  zone = \"${var.zone}\"\n}\n\nresource \"google_container_cluster\" \"default\" {\n  name               = \"${var.network_name}\"\n  zone               = \"${var.zone}\"\n  initial_node_count = 3\n  min_master_version = \"${data.google_container_engine_versions.default.latest_master_version}\"\n  network            = \"${google_compute_subnetwork.default.name}\"\n  subnetwork         = \"${google_compute_subnetwork.default.name}\"\n\n  // Use legacy ABAC until these issues are resolved: \n  //   https://github.com/mcuadros/terraform-provider-helm/issues/56\n  //   https://github.com/terraform-providers/terraform-provider-kubernetes/pull/73\n  enable_legacy_abac = true\n\n  // Wait for the GCE LB controller to cleanup the resources.\n  provisioner \"local-exec\" {\n    when    = \"destroy\"\n    command = \"sleep 90\"\n  }\n}\n\noutput network {\n  value = \"${google_compute_subnetwork.default.network}\"\n}\n\noutput subnetwork_name {\n  value = \"${google_compute_subnetwork.default.name}\"\n}\n\noutput cluster_name {\n  value = \"${google_container_cluster.default.name}\"\n}\n\noutput cluster_region {\n  value = \"${var.region}\"\n}\n\noutput cluster_zone {\n  value = \"${google_container_cluster.default.zone}\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_26", "severity": "HIGH", "message": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_GCP_23", "severity": "HIGH", "message": "Ensure Kubernetes Cluster is created with Alias IP ranges enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_66", "severity": "HIGH", "message": "Ensure use of Binary Authorization", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_13", "severity": "HIGH", "message": "Ensure client certificate authentication to Kubernetes Engine Clusters is disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_7", "severity": "HIGH", "message": "Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_61", "severity": "HIGH", "message": "Enable VPC Flow Logs and Intranode Visibility", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_21", "severity": "HIGH", "message": "Ensure Kubernetes Clusters are configured with Labels", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_65", "severity": "HIGH", "message": "Manage Kubernetes RBAC users with Google Groups for GKE", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_20", "severity": "HIGH", "message": "Ensure master authorized networks is set to enabled in GKE clusters", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_69", "severity": "HIGH", "message": "Ensure the GKE Metadata Server is Enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_12", "severity": "HIGH", "message": "Ensure Network Policy is enabled on Kubernetes Engine Clusters", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_25", "severity": "HIGH", "message": "Ensure Kubernetes Cluster is created with Private cluster enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_64", "severity": "HIGH", "message": "Ensure clusters are created with Private Nodes", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_70", "severity": "HIGH", "message": "Ensure the GKE Release Channel is set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV2_GCP_18", "severity": "CRITICAL", "message": "Ensure GCP network defines a firewall and does not use the default firewall", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-service-lb__main.tf", "start_line": 17}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"ip\" {\n  value = aws_instance.r100c86.public_ip\n}\n\noutput \"KeyName\" {\n  value = aws_instance.r100c86.key_name\n}\n\noutput \"Subnets-Attached\" {\n  value = aws_instance.r100c86.subnet_id\n}\n\noutput \"PrivateEc2IP\" {\n  value = aws_instance.r100c87.private_ip\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__myout.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#\n# EKS Worker Nodes Resources\n#  * IAM role allowing Kubernetes actions to access other AWS services\n#  * EKS Node Group to launch worker nodes\n#\n\nresource \"aws_iam_role\" \"demo-node\" {\n  name = \"terraform-eks-demo-node\"\n\n  assume_role_policy = <<POLICY\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nPOLICY\n}\n\ndata \"aws_iam_policy_document\" \"worker_autoscaling\" {\n  statement {\n    sid    = \"eksWorkerAutoscalingAll\"\n    effect = \"Allow\"\n\n    actions = [\n      \"autoscaling:DescribeAutoScalingGroups\",\n      \"autoscaling:DescribeAutoScalingInstances\",\n      \"autoscaling:DescribeLaunchConfigurations\",\n      \"autoscaling:DescribeTags\",\n      \"ec2:DescribeLaunchTemplateVersions\",\n    ]\n\n    resources = [\"*\"]\n  }\n\n  statement {\n    sid    = \"eksWorkerAutoscalingOwn\"\n    effect = \"Allow\"\n\n    actions = [\n      \"autoscaling:SetDesiredCapacity\",\n      \"autoscaling:TerminateInstanceInAutoScalingGroup\",\n      \"autoscaling:UpdateAutoScalingGroup\",\n    ]\n\n    resources = [\"*\"]\n\n    condition {\n      test     = \"StringEquals\"\n      variable = \"autoscaling:ResourceTag/kubernetes.io/cluster/${aws_eks_cluster.demo.id}\"\n      values   = [\"owned\"]\n    }\n\n    condition {\n      test     = \"StringEquals\"\n      variable = \"autoscaling:ResourceTag/k8s.io/cluster-autoscaler/enabled\"\n      values   = [\"true\"]\n    }\n  }\n}\n\nresource \"aws_iam_role_policy_attachment\" \"workers_autoscaling\" {\n  policy_arn = aws_iam_policy.worker_autoscaling.arn\n  role       = aws_iam_role.demo-node.name\n}\n\nresource \"aws_iam_policy\" \"worker_autoscaling\" {\n  name_prefix = \"eks-worker-autoscaling-${aws_eks_cluster.demo.id}\"\n  description = \"EKS worker node autoscaling policy for cluster ${aws_eks_cluster.demo.id}\"\n  policy      = data.aws_iam_policy_document.worker_autoscaling.json\n}\n\n\n\nresource \"aws_iam_role_policy_attachment\" \"demo-node-AmazonEKSWorkerNodePolicy\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy\"\n  role       = aws_iam_role.demo-node.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"demo-node-AmazonEKS_CNI_Policy\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy\"\n  role       = aws_iam_role.demo-node.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"demo-node-AmazonEC2ContainerRegistryReadOnly\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly\"\n  role       = aws_iam_role.demo-node.name\n}\n\nresource \"aws_eks_node_group\" \"demo\" {\n  cluster_name    = aws_eks_cluster.demo.name\n  node_group_name = \"demo\"\n  node_role_arn   = aws_iam_role.demo-node.arn\n  subnet_ids      = aws_subnet.demo[*].id\n  instance_types = [var.eks_node_instance_type]\n  remote_access{\n      ec2_ssh_key = var.key_pair_name\n  }\n\n\n  scaling_config {\n    desired_size = 2\n    max_size     = 4\n    min_size     = 2\n  }\n\n  depends_on = [\n    aws_iam_role_policy_attachment.workers_autoscaling,\n    aws_iam_role_policy_attachment.demo-node-AmazonEKSWorkerNodePolicy,\n    aws_iam_role_policy_attachment.demo-node-AmazonEKS_CNI_Policy,\n    aws_iam_role_policy_attachment.demo-node-AmazonEC2ContainerRegistryReadOnly,\n  ]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__EKS__eks-worker-nodes.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_100", "severity": "HIGH", "message": "Ensure AWS EKS node group does not have implicit SSH access from 0.0.0.0/0", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__EKS__eks-worker-nodes.tf", "start_line": 96}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource-1: Azure Resource Group\nresource \"azurerm_resource_group\" \"myrg\" {\n  name = \"myrg-1\"\n  location = \"East US\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-azure-cloud__09-Resource-Syntax-and-Behavior__terraform-manifests__c2-resource-group.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Used for configuring ELBs.\noutput \"instance_ids\" {\n    value = [\"${aws_instance.instance.*.id}\"]\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/fredsted__terraform__instance__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/******************************************\n  Required variables\n*******************************************/\n\nvariable \"parent_folder\" {\n  description = \"GCP parent folder ID in the form folders/{id}\"\n  default     = \"\"\n  type        = string\n}\n\nvariable \"org_id\" {\n  description = \"GCP Organization ID\"\n  type        = string\n}\n\nvariable \"billing_account\" {\n  description = \"The ID of the billing account to associate projects with.\"\n  type        = string\n}\n\nvariable \"group_org_admins\" {\n  description = \"Google Group for GCP Organization Administrators\"\n  type        = string\n}\n\nvariable \"group_billing_admins\" {\n  description = \"Google Group for GCP Billing Administrators\"\n  type        = string\n}\n\nvariable \"default_region\" {\n  description = \"Default region to create resources where applicable.\"\n  type        = string\n  default     = \"us-central1\"\n}\n\n/******************************************\n  Optional variables\n*******************************************/\n\nvariable \"project_labels\" {\n  description = \"Labels to apply to the project.\"\n  type        = map(string)\n  default     = {}\n}\n\nvariable \"project_prefix\" {\n  description = \"Name prefix to use for projects created.\"\n  default     = \"cft\"\n  type        = string\n}\n\nvariable \"project_id\" {\n  description = \"Custom project ID to use for project created. If not supplied, the default id is {project_prefix}-seed-{random suffix}.\"\n  default     = \"\"\n  type        = string\n}\n\nvariable \"project_deletion_policy\" {\n  description = \"The deletion policy for the project created.\"\n  type        = string\n  default     = \"PREVENT\"\n}\n\nvariable \"project_auto_create_network\" {\n  description = \"Create the default network for the project created.\"\n  type        = bool\n  default     = false\n}\n\nvariable \"activate_apis\" {\n  description = \"List of APIs to enable in the seed project.\"\n  type        = list(string)\n\n  default = [\n    \"serviceusage.googleapis.com\",\n    \"servicenetworking.googleapis.com\",\n    \"compute.googleapis.com\",\n    \"logging.googleapis.com\",\n    \"bigquery.googleapis.com\",\n    \"cloudresourcemanager.googleapis.com\",\n    \"cloudbilling.googleapis.com\",\n    \"iam.googleapis.com\",\n    \"admin.googleapis.com\",\n    \"appengine.googleapis.com\",\n    \"storage-api.googleapis.com\",\n    \"monitoring.googleapis.com\"\n  ]\n}\n\nvariable \"sa_org_iam_permissions\" {\n  description = \"List of permissions granted to Terraform service account across the GCP organization.\"\n  type        = list(string)\n  default = [\n    \"roles/billing.user\",\n    \"roles/compute.networkAdmin\",\n    \"roles/compute.xpnAdmin\",\n    \"roles/iam.securityAdmin\",\n    \"roles/iam.serviceAccountAdmin\",\n    \"roles/logging.configWriter\",\n    \"roles/orgpolicy.policyAdmin\",\n    \"roles/resourcemanager.folderAdmin\",\n    \"roles/resourcemanager.organizationViewer\",\n  ]\n}\n\nvariable \"sa_enable_impersonation\" {\n  description = \"Allow org_admins group to impersonate service account & enable APIs required.\"\n  type        = bool\n  default     = false\n}\n\nvariable \"create_terraform_sa\" {\n  description = \"If the Terraform service account should be created.\"\n  type        = bool\n  default     = true\n}\n\nvariable \"state_bucket_name\" {\n  description = \"Custom state bucket name. If not supplied, the default name is {project_prefix}-tfstate-{random suffix}.\"\n  default     = \"\"\n  type        = string\n}\n\nvariable \"grant_billing_user\" {\n  description = \"Grant roles/billing.user role to CFT service account\"\n  type        = bool\n  default     = true\n}\n\nvariable \"storage_bucket_labels\" {\n  description = \"Labels to apply to the storage bucket.\"\n  type        = map(string)\n  default     = {}\n}\n\nvariable \"force_destroy\" {\n  description = \"If supplied, the state bucket will be deleted even while containing objects.\"\n  type        = bool\n  default     = false\n}\n\nvariable \"org_admins_org_iam_permissions\" {\n  description = \"List of permissions granted to the group supplied in group_org_admins variable across the GCP organization.\"\n  type        = list(string)\n  default = [\n    \"roles/billing.user\",\n    \"roles/resourcemanager.organizationAdmin\"\n  ]\n}\n\nvariable \"folder_id\" {\n  description = \"The ID of a folder to host this project\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"org_project_creators\" {\n  description = \"Additional list of members to have project creator role accross the organization. Prefix of group: user: or serviceAccount: is required.\"\n  type        = list(string)\n  default     = []\n}\n\nvariable \"random_suffix\" {\n  description = \"Appends a 4 character random suffix to project ID and GCS bucket name.\"\n  type        = bool\n  default     = true\n}\n\nvariable \"tf_service_account_id\" {\n  description = \"ID of service account for terraform in seed project\"\n  type        = string\n  default     = \"org-terraform\"\n}\n\nvariable \"tf_service_account_name\" {\n  description = \"Display name of service account for terraform in seed project\"\n  type        = string\n  default     = \"CFT Organization Terraform Account\"\n}\n\nvariable \"encrypt_gcs_bucket_tfstate\" {\n  description = \"Encrypt bucket used for storing terraform state files in seed project.\"\n  type        = bool\n  default     = false\n}\n\nvariable \"key_protection_level\" {\n  type        = string\n  description = \"The protection level to use when creating a version based on this template. Default value: \\\"SOFTWARE\\\" Possible values: [\\\"SOFTWARE\\\", \\\"HSM\\\"]\"\n  default     = \"SOFTWARE\"\n}\n\nvariable \"key_rotation_period\" {\n  description = \"The rotation period of the key.\"\n  type        = string\n  default     = null\n}\n\nvariable \"kms_prevent_destroy\" {\n  description = \"Set the prevent_destroy lifecycle attribute on keys.\"\n  type        = bool\n  default     = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-bootstrap__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"~>3.0\"\n    }\n    azapi = {\n      source  = \"Azure/azapi\"\n      version = \"2.0.1\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"~>3.0\"\n    }\n  }\n}\n\nprovider \"azurerm\" {\n  features {}\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform__quickstart__101-aks-extended-zones__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# which provider you are connecting to, version\nterraform {\n  required_providers {\n    aws = {\n      source = \"hashicorp/aws\"\n      version = \"5.4.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  # Configuration options\n  region = \"ap-south-1\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tf-docker-k8__terraform__session-01__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"s3_bucket_name\" {\n  value       = aws_s3_bucket.terraform_state.id\n  description = \"The NAME of the S3 bucket\"\n}\n\noutput \"s3_bucket_arn\" {\n  value       = aws_s3_bucket.terraform_state.arn\n  description = \"The ARN of the S3 bucket\"\n}\n\noutput \"s3_bucket_region\" {\n  value       = aws_s3_bucket.terraform_state.region\n  description = \"The REGION of the S3 bucket\"\n}\n\noutput \"dynamodb_table_name\" {\n  value       = aws_dynamodb_table.terraform_lock.name\n  description = \"The ARN of the DynamoDB table\"\n}\n\noutput \"dynamodb_table_arn\" {\n  value       = aws_dynamodb_table.terraform_lock.arn\n  description = \"The ARN of the DynamoDB table\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__remote_state__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  username = \"code-commit-replicator\"\n}\n\nresource \"aws_iam_user_policy\" \"write_to_codecommit\" {\n  name   = \"write-to-codecommit\"\n  user   = local.username\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [{\n    \"Effect\": \"Allow\",\n    \"Action\": [\n      \"codecommit:GitPull\",\n      \"codecommit:GitPush\",\n      \"codecommit:ListRepositories\",\n      \"codecommit:CreateRepository\"\n    ],\n    \"Resource\": \"*\"\n  }]\n}\nEOF\n}\n\nresource \"aws_codecommit_repository\" \"repos\" {\n  for_each        = local.github_repos\n  repository_name = each.key\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__terraform__codecommit.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_40", "severity": "HIGH", "message": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__terraform__codecommit.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__terraform__codecommit.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__terraform__codecommit.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV2_AWS_37", "severity": "CRITICAL", "message": "Ensure CodeCommit associates an approval rule", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__terraform__codecommit.tf", "start_line": 25}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.16\"\n    }\n  }\n\n  required_version = \">= 1.2.0\"\n\n  backend \"s3\" {\n    bucket = \"terraform-state\"\n    key = \"key/terraform.tfstate\"\n    region = \"eu-central-1\"\n  }\n}\n\nprovider \"aws\" {\n   region = \"eu-central-1\"\n}\n\nresource \"aws_instance\" \"instance\" {\n   ami           = \"ami-0d1ddd83282187d18\" # Ubuntu 22.04 eu-central-1 Frankfurt\n   instance_type = \"t2.nano\"\n\n   tags = {\n      Name = \"Basic Instance\"\n   }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__backend-remote-state__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__backend-remote-state__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__backend-remote-state__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__backend-remote-state__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__backend-remote-state__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__backend-remote-state__main.tf", "start_line": 22}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nresource \"random_uuid\" \"widgets_scope_id\" {}\n\nresource \"azuread_application\" \"widgets_service\" {\n  display_name = \"widgets-service\"\n  type         = \"webapp/api\"\n\n  identifier_uris = [\"api://widgets-service\"]\n\n  api {\n    oauth2_permission_scope {\n      admin_consent_description  = \"Access Widgets Service as a user\"\n      admin_consent_display_name = \"Access Widgets Service as a user\"\n      id                         = random_uuid.widgets_scope_id.result\n      is_enabled                 = true\n      type                       = \"User\"\n      user_consent_description   = \"Access Widgets Service as a user\"\n      user_consent_display_name  = \"Access Widgets Service as a user\"\n      value                      = \"access_as_user\"\n    }\n  }\n}\n\nresource \"azuread_application_password\" \"widgets_service\" {\n  application_object_id = azuread_application.widgets_service.object_id\n}\n\nresource \"azuread_application\" \"widgets_app\" {\n  display_name = \"widgets-app\"\n  type         = \"webapp/api\"\n\n  logout_url = \"https://widgets.example.net/logout\"\n  reply_urls = [\n    \"https://widgets.example.net/\",\n    \"https://widgets.example.net/login\",\n  ]\n\n  oauth2_allow_implicit_flow = true\n\n  required_resource_access {\n    # Microsoft Graph\n    resource_app_id = \"00000003-0000-0000-c000-000000000000\"\n\n    resource_access {\n      # User.Read\n      id   = \"e1fe6dd8-ba31-4d61-89e7-88639da4683d\"\n      type = \"Scope\"\n    }\n  }\n\n  required_resource_access {\n    resource_app_id = azuread_application.widgets_service.application_id\n\n    dynamic \"resource_access\" {\n      for_each = azuread_application.widgets_service.api.0.oauth2_permission_scope\n      iterator = scope\n\n      content {\n        id   = scope.value.id\n        type = \"Scope\"\n      }\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-azuread__examples__application__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\n\nvariable \"name\" {\n}\n\nvariable \"location\" {\n  default = \"uksouth\"\n}\n\nvariable \"ssh_public_key\" {\n  default = \"~/.ssh/id_rsa.pub\"\n}\n\nvariable \"kubernetes_version\" {\n}\n\nvariable \"agent_count\" {\n}\n\nvariable \"vm_size\" {\n}\n\nvariable \"dns_prefix\" {\n  default = \"tamopsdns\"\n}\n\nvariable \"kubernetes_cluster_rbac_enabled\" {\n  default = \"true\"\n}\n\nvariable \"aks_admins_group_object_id\" {\n  default = \"e97b6454-3fa1-499e-8e5c-5d631e9ca4d1\"\n}\n\nvariable \"addons\" {\n  description = \"Defines which addons will be activated.\"\n  type = object({\n    oms_agent                   = bool\n    azure_policy                = bool\n    ingress_application_gateway = bool\n  })\n}\n\nvariable \"log_analytics_workspace_id\" {\n}\n\nvariable \"aks_subnet\" {\n}\n\nvariable \"agic_subnet_id\" {\n}\n\nvariable \"environment\" {\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__DevOps-Journey-Using-Azure-DevOps__labs__2-AzureDevOps-Terraform-Pipeline__terraform__modules__aks__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"id\" {\n  value = azurerm_api_management_api_operation_policy.policy.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/recognizegroup__terraform__modules__azure__api_management_api_operation_policy__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"google_compute_instance\" \"inframap-tmp\" {\n  name         = \"inframap-tmp\"\n  machine_type = \"f1-micro\"\n  zone         = \"us-east1-b\"\n\n  tags = [\"front\", \"ssh\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  scheduling {\n    preemptible       = true\n    automatic_restart = false\n  }\n\n  network_interface {\n    network = google_compute_network.vpc_network.name\n\n    access_config {\n      // Ephemeral IP\n    }\n  }\n\n}\n\nresource \"google_compute_instance\" \"inframap-tmp-two\" {\n  name         = \"inframap-tmp-two\"\n  machine_type = \"f1-micro\"\n  zone         = \"us-east1-b\"\n\n  tags = [\"ssh\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  scheduling {\n    preemptible       = true\n    automatic_restart = false\n  }\n\n  network_interface {\n    network = google_compute_network.vpc_network.name\n\n    access_config {\n      // Ephemeral IP\n    }\n  }\n\n}\n\nresource \"google_compute_network\" \"vpc_network\" {\n  name                    = \"inframap-network-tmp\"\n  auto_create_subnetworks = true\n}\n\nresource \"google_compute_firewall\" \"allow-http\" {\n  network     = google_compute_network.vpc_network.name\n  description = \"allow incoming http traffic\"\n  name        = \"allow-http\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"80\"]\n  }\n  direction     = \"INGRESS\"\n  source_ranges = [\"0.0.0.0/0\"]\n  target_tags   = [\"front\"]\n}\n\nresource \"google_compute_firewall\" \"allow-ssh\" {\n  network     = google_compute_network.vpc_network.name\n  description = \"allow SSH between instances\"\n  name        = \"allow-ssh\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n  direction   = \"INGRESS\"\n  source_tags = [\"ssh\"]\n  target_tags = [\"front\"]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__google_hcl.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__google_hcl.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__google_hcl.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__google_hcl.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__google_hcl.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__google_hcl.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__google_hcl.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__google_hcl.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__google_hcl.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_GCP_106", "severity": "HIGH", "message": "Ensure Google compute firewall ingress does not allow unrestricted http port 80 access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__google_hcl.tf", "start_line": 62}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n\n  defaults = {\n    # The `tenant` label was introduced in v0.25.0. To preserve backward compatibility, or, really, to ensure\n    # that people using the `tenant` label are alerted that it was not previously supported if they try to\n    # use it in an older version, it is not included by default.\n    label_order         = [\"namespace\", \"environment\", \"stage\", \"name\", \"attributes\"]\n    regex_replace_chars = \"/[^-a-zA-Z0-9]/\"\n    delimiter           = \"-\"\n    replacement         = \"\"\n    id_length_limit     = 0\n    id_hash_length      = 5\n    label_key_case      = \"title\"\n    label_value_case    = \"lower\"\n\n    # The default value of labels_as_tags cannot be included in this\n    # defaults` map because it creates a circular dependency\n  }\n\n  default_labels_as_tags = keys(local.tags_context)\n  # Unlike other inputs, the first setting of `labels_as_tags` cannot be later overridden. However,\n  # we still have to pass the `input` map as the context to the next module. So we need to distinguish\n  # between the first setting of var.labels_as_tags == null as meaning set the default and do not change\n  # it later, versus later settings of var.labels_as_tags that should be ignored. So, we make the\n  # default value in context be \"unset\", meaning it can be changed, but when it is unset and\n  # var.labels_as_tags is null, we change it to \"default\". Once it is set to \"default\" we will\n  # not allow it to be changed again, but of course we have to detect \"default\" and replace it\n  # with local.default_labels_as_tags when we go to use it.\n  #\n  # We do not want to use null as default or unset, because Terraform has issues with\n  # the value of an object field being null in some places and [] in others.\n  # We do not want to use [] as default or unset because that is actually a valid setting\n  # that we want to have override the default.\n  #\n  # To determine whether that context.labels_as_tags is not set,\n  # we have to cover 2 cases: 1) context does not have a labels_as_tags key, 2) it is present and set to [\"unset\"]\n  context_labels_as_tags_is_unset = try(contains(var.context.labels_as_tags, \"unset\"), true)\n\n  # So far, we have decided not to allow overriding replacement or id_hash_length\n  replacement    = local.defaults.replacement\n  id_hash_length = local.defaults.id_hash_length\n\n  # The values provided by variables supersede the values inherited from the context object,\n  # except for tags and attributes which are merged.\n  input = {\n    # It would be nice to use coalesce here, but we cannot, because it\n    # is an error for all the arguments to coalesce to be empty.\n    enabled   = var.enabled == null ? var.context.enabled : var.enabled\n    namespace = var.namespace == null ? var.context.namespace : var.namespace\n    # tenant was introduced in v0.25.0, prior context versions do not have it\n    tenant      = var.tenant == null ? lookup(var.context, \"tenant\", null) : var.tenant\n    environment = var.environment == null ? var.context.environment : var.environment\n    stage       = var.stage == null ? var.context.stage : var.stage\n    name        = var.name == null ? var.context.name : var.name\n    delimiter   = var.delimiter == null ? var.context.delimiter : var.delimiter\n    # modules tack on attributes (passed by var) to the end of the list (passed by context)\n    attributes = compact(distinct(concat(coalesce(var.context.attributes, []), coalesce(var.attributes, []))))\n    tags       = merge(var.context.tags, var.tags)\n\n    additional_tag_map  = merge(var.context.additional_tag_map, var.additional_tag_map)\n    label_order         = var.label_order == null ? var.context.label_order : var.label_order\n    regex_replace_chars = var.regex_replace_chars == null ? var.context.regex_replace_chars : var.regex_replace_chars\n    id_length_limit     = var.id_length_limit == null ? var.context.id_length_limit : var.id_length_limit\n    label_key_case      = var.label_key_case == null ? lookup(var.context, \"label_key_case\", null) : var.label_key_case\n    label_value_case    = var.label_value_case == null ? lookup(var.context, \"label_value_case\", null) : var.label_value_case\n\n    descriptor_formats = merge(lookup(var.context, \"descriptor_formats\", {}), var.descriptor_formats)\n    labels_as_tags     = local.context_labels_as_tags_is_unset ? var.labels_as_tags : var.context.labels_as_tags\n  }\n\n\n  enabled             = local.input.enabled\n  regex_replace_chars = coalesce(local.input.regex_replace_chars, local.defaults.regex_replace_chars)\n\n  # string_label_names are names of inputs that are strings (not list of strings) used as labels\n  string_label_names = [\"namespace\", \"tenant\", \"environment\", \"stage\", \"name\"]\n  normalized_labels = { for k in local.string_label_names : k =>\n    local.input[k] == null ? \"\" : replace(local.input[k], local.regex_replace_chars, local.replacement)\n  }\n  normalized_attributes = compact(distinct([for v in local.input.attributes : replace(v, local.regex_replace_chars, local.replacement)]))\n\n  formatted_labels = { for k in local.string_label_names : k => local.label_value_case == \"none\" ? local.normalized_labels[k] :\n    local.label_value_case == \"title\" ? title(lower(local.normalized_labels[k])) :\n    local.label_value_case == \"upper\" ? upper(local.normalized_labels[k]) : lower(local.normalized_labels[k])\n  }\n\n  attributes = compact(distinct([\n    for v in local.normalized_attributes : (local.label_value_case == \"none\" ? v :\n      local.label_value_case == \"title\" ? title(lower(v)) :\n    local.label_value_case == \"upper\" ? upper(v) : lower(v))\n  ]))\n\n  namespace   = local.formatted_labels[\"namespace\"]\n  tenant      = local.formatted_labels[\"tenant\"]\n  environment = local.formatted_labels[\"environment\"]\n  stage       = local.formatted_labels[\"stage\"]\n  name        = local.formatted_labels[\"name\"]\n\n  delimiter        = local.input.delimiter == null ? local.defaults.delimiter : local.input.delimiter\n  label_order      = local.input.label_order == null ? local.defaults.label_order : coalescelist(local.input.label_order, local.defaults.label_order)\n  id_length_limit  = local.input.id_length_limit == null ? local.defaults.id_length_limit : local.input.id_length_limit\n  label_key_case   = local.input.label_key_case == null ? local.defaults.label_key_case : local.input.label_key_case\n  label_value_case = local.input.label_value_case == null ? local.defaults.label_value_case : local.input.label_value_case\n\n  # labels_as_tags is an exception to the rule that input vars override context values (see above)\n  labels_as_tags = contains(local.input.labels_as_tags, \"default\") ? local.default_labels_as_tags : local.input.labels_as_tags\n\n  # Just for standardization and completeness\n  descriptor_formats = local.input.descriptor_formats\n\n  additional_tag_map = merge(var.context.additional_tag_map, var.additional_tag_map)\n\n  tags = merge(local.generated_tags, local.input.tags)\n\n  tags_as_list_of_maps = flatten([\n    for key in keys(local.tags) : merge(\n      {\n        key   = key\n        value = local.tags[key]\n    }, local.additional_tag_map)\n  ])\n\n  tags_context = {\n    namespace   = local.namespace\n    tenant      = local.tenant\n    environment = local.environment\n    stage       = local.stage\n    # For AWS we need `Name` to be disambiguated since it has a special meaning\n    name       = local.id\n    attributes = local.id_context.attributes\n  }\n\n  generated_tags = {\n    for l in setintersection(keys(local.tags_context), local.labels_as_tags) :\n    local.label_key_case == \"upper\" ? upper(l) : (\n      local.label_key_case == \"lower\" ? lower(l) : title(lower(l))\n    ) => local.tags_context[l] if length(local.tags_context[l]) > 0\n  }\n\n  id_context = {\n    namespace   = local.namespace\n    tenant      = local.tenant\n    environment = local.environment\n    stage       = local.stage\n    name        = local.name\n    attributes  = join(local.delimiter, local.attributes)\n  }\n\n  labels = [for l in local.label_order : local.id_context[l] if length(local.id_context[l]) > 0]\n\n  id_full = join(local.delimiter, local.labels)\n  # Create a truncated ID if needed\n  delimiter_length = length(local.delimiter)\n  # Calculate length of normal part of ID, leaving room for delimiter and hash\n  id_truncated_length_limit = local.id_length_limit - (local.id_hash_length + local.delimiter_length)\n  # Truncate the ID and ensure a single (not double) trailing delimiter\n  id_truncated = local.id_truncated_length_limit <= 0 ? \"\" : \"${trimsuffix(substr(local.id_full, 0, local.id_truncated_length_limit), local.delimiter)}${local.delimiter}\"\n  # Support usages that disallow numeric characters. Would prefer tr 0-9 q-z but Terraform does not support it.\n  # Probably would have been better to take the hash of only the characters being removed,\n  # so identical removed strings would produce identical hashes, but it is not worth breaking existing IDs for.\n  id_hash_plus = \"${md5(local.id_full)}qrstuvwxyz\"\n  id_hash_case = local.label_value_case == \"title\" ? title(local.id_hash_plus) : local.label_value_case == \"upper\" ? upper(local.id_hash_plus) : local.label_value_case == \"lower\" ? lower(local.id_hash_plus) : local.id_hash_plus\n  id_hash      = replace(local.id_hash_case, local.regex_replace_chars, local.replacement)\n  # Create the short ID by adding a hash to the end of the truncated ID\n  id_short = substr(\"${local.id_truncated}${local.id_hash}\", 0, local.id_length_limit)\n  id       = local.id_length_limit != 0 && length(local.id_full) > local.id_length_limit ? local.id_short : local.id_full\n\n\n  # Context of this label to pass to other label modules\n  output_context = {\n    enabled             = local.enabled\n    namespace           = local.namespace\n    tenant              = local.tenant\n    environment         = local.environment\n    stage               = local.stage\n    name                = local.name\n    delimiter           = local.delimiter\n    attributes          = local.attributes\n    tags                = local.tags\n    additional_tag_map  = local.additional_tag_map\n    label_order         = local.label_order\n    regex_replace_chars = local.regex_replace_chars\n    id_length_limit     = local.id_length_limit\n    label_key_case      = local.label_key_case\n    label_value_case    = local.label_value_case\n    labels_as_tags      = local.labels_as_tags\n    descriptor_formats  = local.descriptor_formats\n  }\n\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-null-label__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\nCopyright 2019 F5 Networks Inc.\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nprovider \"bigip\" {\n  address  = \"xxx.xxx.xxx.xxx\"\n  username = \"xxxx\"\n  password = \"xxxx\"\n}\n\nresource \"bigip_ltm_policy\" \"test-policy\" {\n  name           = \"my_policy\"\n  strategy       = \"first-match\"\n  requires       = [\"http\"]\n  published_copy = \"Drafts/my_policy\"\n  controls       = [\"forwarding\"]\n  rule {\n    name = \"rule6\"\n\n    action {\n      tm_name    = \"20\"\n      forward    = true\n      connection = false\n      pool       = \"/Common/mypool\"\n    }\n  }\n  depends_on = [bigip_ltm_pool.mypool]\n}\n\nresource \"bigip_ltm_pool\" \"mypool\" {\n  name                = \"/Common/mypool\"\n  monitors            = [\"/Common/http\"]\n  allow_nat           = \"yes\"\n  allow_snat          = \"yes\"\n  load_balancing_mode = \"round-robin\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/F5Networks__terraform-provider-bigip__examples__bigip_ltm_policy.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# //////////////////////////////\n# VPC\n# //////////////////////////////\nmodule \"vpc\" {\n  source = \"terraform-aws-modules/vpc/aws\"\n  name = \"frontend-vpc\"\n  cidr = \"10.0.0.0/16\"\n\n  azs             = [\"us-east-2a\", \"us-east-2b\", \"us-east-2c\"]\n  private_subnets = [\"10.0.1.0/24\", \"10.0.2.0/24\", \"10.0.3.0/24\"]\n  public_subnets  = [\"10.0.101.0/24\", \"10.0.102.0/24\", \"10.0.103.0/24\"]\n\n  enable_nat_gateway = true\n  single_nat_gateway = true\n  # one_nat_gateway_per_az = true\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__03_04_complex__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__03_04_complex__vpc.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__03_04_complex__vpc.tf", "start_line": 4}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# This is where you put your variables declaration\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/boltops-tools__terraspace__lib__templates__hcl__stack__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \"~> 1.0\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  access_key = var.aws_access_key\n  secret_key = var.aws_secret_key\n  region     = var.aws_region\n\n  default_tags {\n    tags = var.aws_default_tags\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__aws__standard__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n## managed kubernetes cluster\n\n## features\nlocals {\n  node_groups_enabled         = (var.node_groups != null ? ((length(var.node_groups) > 0) ? true : false) : false)\n  managed_node_groups_enabled = (var.managed_node_groups != null ? ((length(var.managed_node_groups) > 0) ? true : false) : false)\n  fargate_enabled             = (var.fargate_profiles != null ? ((length(var.fargate_profiles) > 0) ? true : false) : false)\n}\n\n## control plane (cp)\n# security/policy\nresource \"aws_iam_role\" \"cp\" {\n  name = join(\"-\", [local.name, \"cp\"])\n  tags = merge(local.default-tags, var.tags)\n  assume_role_policy = jsonencode({\n    Statement = [{\n      Action = \"sts:AssumeRole\"\n      Effect = \"Allow\"\n      Principal = {\n        Service = format(\"eks.%s\", module.aws.partition.dns_suffix)\n      }\n    }]\n    Version = \"2012-10-17\"\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"eks-cluster\" {\n  policy_arn = format(\"arn:%s:iam::aws:policy/AmazonEKSClusterPolicy\", module.aws.partition.partition)\n  role       = aws_iam_role.cp.id\n}\n\nresource \"aws_eks_cluster\" \"cp\" {\n  name     = local.name\n  role_arn = aws_iam_role.cp.arn\n  version  = var.kubernetes_version\n  tags     = merge(local.default-tags, var.tags)\n\n  enabled_cluster_log_types = var.enabled_cluster_log_types\n\n  vpc_config {\n    subnet_ids = var.subnets\n  }\n\n  depends_on = [\n    aws_iam_role_policy_attachment.eks-cluster,\n  ]\n}\n\n## node groups (ng)\n# security/policy\nresource \"aws_iam_role\" \"ng\" {\n  for_each = local.node_groups_enabled || local.managed_node_groups_enabled ? toset([\"enabled\"]) : []\n  name     = join(\"-\", [local.name, \"ng\"])\n  tags     = merge(local.default-tags, var.tags)\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [{\n      Action = \"sts:AssumeRole\"\n      Effect = \"Allow\"\n      Principal = {\n        Service = [format(\"ec2.%s\", module.aws.partition.dns_suffix)]\n      }\n    }]\n  })\n}\n\nresource \"aws_iam_instance_profile\" \"ng\" {\n  for_each = local.node_groups_enabled || local.managed_node_groups_enabled ? toset([\"enabled\"]) : []\n  name     = join(\"-\", [local.name, \"ng\"])\n  role     = aws_iam_role.ng[\"enabled\"].name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"eks-ng\" {\n  for_each   = local.node_groups_enabled || local.managed_node_groups_enabled ? toset([\"enabled\"]) : []\n  policy_arn = format(\"arn:%s:iam::aws:policy/AmazonEKSWorkerNodePolicy\", module.aws.partition.partition)\n  role       = aws_iam_role.ng[\"enabled\"].name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"eks-cni\" {\n  for_each   = local.node_groups_enabled || local.managed_node_groups_enabled ? toset([\"enabled\"]) : []\n  policy_arn = format(\"arn:%s:iam::aws:policy/AmazonEKS_CNI_Policy\", module.aws.partition.partition)\n  role       = aws_iam_role.ng[\"enabled\"].name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"ecr-read\" {\n  for_each   = local.node_groups_enabled || local.managed_node_groups_enabled ? toset([\"enabled\"]) : []\n  policy_arn = format(\"arn:%s:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly\", module.aws.partition.partition)\n  role       = aws_iam_role.ng[\"enabled\"].name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"ssm-managed\" {\n  for_each   = (local.node_groups_enabled || local.managed_node_groups_enabled) && var.enable_ssm ? toset([\"enabled\"]) : []\n  policy_arn = format(\"arn:%s:iam::aws:policy/AmazonSSMManagedInstanceCore\", module.aws.partition.partition)\n  role       = aws_iam_role.ng[\"enabled\"].name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"ng-extra\" {\n  for_each   = (local.node_groups_enabled || local.managed_node_groups_enabled) ? { for k, v in var.policy_arns : k => v } : {}\n  policy_arn = each.value\n  role       = aws_iam_role.ng[\"enabled\"].name\n}\n\n## bottlerocket\nlocals {\n  bottlerocket_userdata = templatefile(\"${path.module}/templates/bottlerocket.tpl\", {\n    cluster_name                 = aws_eks_cluster.cp.name\n    cluster_endpoint             = aws_eks_cluster.cp.endpoint\n    cluster_ca_data              = aws_eks_cluster.cp.certificate_authority.0.data\n    admin_container_enabled      = lookup(var.bottlerocket_config, \"admin_container_enabled\", local.default_bottlerocket_config.admin_container_enabled)\n    admin_container_superpowered = lookup(var.bottlerocket_config, \"admin_container_superpowered\", local.default_bottlerocket_config.admin_container_superpowered)\n    admin_container_source       = lookup(var.bottlerocket_config, \"admin_container_source\", local.default_bottlerocket_config.admin_container_source)\n    control_container_enabled    = var.enable_ssm\n  })\n}\n\n## self-managed node groups\n\ndata \"aws_ami\" \"eks\" {\n  for_each    = { for ng in var.node_groups : ng.name => ng }\n  owners      = [\"amazon\"]\n  most_recent = true\n\n  filter {\n    name = \"name\"\n    values = [\n      format(length(regexall(\"^AL2\", lookup(each.value, \"ami_type\", local.default_eks_config.ami_type))) > 0 ?\n        (length(regexall(\"ARM|GPU$\", lookup(each.value, \"ami_type\", local.default_eks_config.ami_type))) > 0 ? \"amazon-eks-*-node-%s-*\" : \"amazon-eks-node-%s-*\") :\n        (length(regexall(\"^BOTTLEROCKET\", lookup(each.value, \"ami_type\", local.default_eks_config.ami_type))) > 0 ? \"bottlerocket-aws-k8s-%s-*\" : \"amazon-eks-node-%s-*\")\n      , var.kubernetes_version)\n    ]\n  }\n  filter {\n    name   = \"architecture\"\n    values = [length(regexall(\"ARM\", lookup(each.value, \"ami_type\", \"AL2_x86_64\"))) > 0 ? \"arm64\" : \"x86_64\"]\n  }\n}\n\ndata \"cloudinit_config\" \"ng\" {\n  for_each      = { for ng in var.node_groups : ng.name => ng }\n  base64_encode = true\n  gzip          = false\n\n  part {\n    content_type = \"text/x-shellscript\"\n    content      = <<-EOT\n    #!/bin/bash\n    ${var.enable_ssm ? \"yum install -y amazon-ssm-agent\\nsystemctl enable amazon-ssm-agent\\nsystemctl start amazon-ssm-agent\" : \"\"}\n    EOT\n  }\n\n  part {\n    content_type = \"text/x-shellscript\"\n    content      = <<-EOT\n    #!/bin/bash\n    set -ex\n    /etc/eks/bootstrap.sh ${aws_eks_cluster.cp.name} --kubelet-extra-args '--node-labels=eks.amazonaws.com/nodegroup-image=${data.aws_ami.eks[each.key].id},eks.amazonaws.com/nodegroup=${each.key}' --b64-cluster-ca ${aws_eks_cluster.cp.certificate_authority.0.data} --apiserver-endpoint ${aws_eks_cluster.cp.endpoint}\n    EOT\n  }\n}\n\nresource \"aws_launch_template\" \"ng\" {\n  for_each      = { for ng in var.node_groups : ng.name => ng }\n  name          = format(\"eks-%s\", uuid())\n  tags          = merge(local.default-tags, local.eks-tag, var.tags, lookup(each.value, \"tags\", {}))\n  image_id      = data.aws_ami.eks[each.key].id\n  instance_type = lookup(each.value, \"instance_type\", local.default_eks_config.instance_type)\n  user_data = (\n    length(regexall(\"^AL2\", lookup(each.value, \"ami_type\", local.default_eks_config.ami_type))) > 0 ?\n    data.cloudinit_config.ng[each.key].rendered :\n    length(regexall(\"^BOTTLEROCKET\", lookup(each.value, \"ami_type\", local.default_eks_config.ami_type))) > 0 ?\n    base64encode(local.bottlerocket_userdata) :\n    data.cloudinit_config.ng[each.key].rendered\n  )\n\n  iam_instance_profile {\n    arn = aws_iam_instance_profile.ng[\"enabled\"].arn\n  }\n\n  block_device_mappings {\n    device_name = \"/dev/xvda\"\n    ebs {\n      volume_size           = lookup(each.value, \"volume_size\", local.default_eks_config.volume_size)\n      volume_type           = lookup(each.value, \"volume_type\", local.default_eks_config.volume_type)\n      delete_on_termination = true\n    }\n  }\n\n  metadata_options {\n    http_tokens = \"required\"\n  }\n\n  network_interfaces {\n    security_groups       = [aws_eks_cluster.cp.vpc_config.0.cluster_security_group_id]\n    delete_on_termination = true\n  }\n\n  tag_specifications {\n    resource_type = \"instance\"\n    tags          = merge(local.default-tags, local.eks-tag, var.tags, lookup(each.value, \"tags\", {}))\n  }\n\n  lifecycle {\n    create_before_destroy = true\n    ignore_changes        = [name]\n  }\n}\n\nresource \"aws_autoscaling_group\" \"ng\" {\n  for_each              = { for ng in var.node_groups : ng.name => ng }\n  name                  = format(\"eks-%s-%s\", each.key, uuid())\n  vpc_zone_identifier   = var.subnets\n  max_size              = lookup(each.value, \"max_size\", 3)\n  min_size              = lookup(each.value, \"min_size\", 1)\n  desired_capacity      = lookup(each.value, \"desired_size\", 1)\n  force_delete          = true\n  protect_from_scale_in = false\n  termination_policies  = [\"Default\"]\n  enabled_metrics = [\n    \"GroupMinSize\",\n    \"GroupMaxSize\",\n    \"GroupDesiredCapacity\",\n    \"GroupInServiceInstances\",\n    \"GroupPendingInstances\",\n    \"GroupStandbyInstances\",\n    \"GroupTerminatingInstances\",\n    \"GroupTotalInstances\",\n  ]\n\n  mixed_instances_policy {\n    launch_template {\n      launch_template_specification {\n        launch_template_id = aws_launch_template.ng[each.key].id\n        version            = aws_launch_template.ng[each.key].latest_version\n      }\n\n      dynamic \"override\" {\n        for_each = lookup(each.value, \"instances_override\", [])\n        content {\n          instance_type     = lookup(override.value, \"instance_type\", null)\n          weighted_capacity = lookup(override.value, \"weighted_capacity\", null)\n        }\n      }\n    }\n\n    dynamic \"instances_distribution\" {\n      for_each = { for key, val in each.value : key => val if key == \"instances_distribution\" }\n      content {\n        on_demand_allocation_strategy            = lookup(instances_distribution.value, \"on_demand_allocation_strategy\", null)\n        on_demand_base_capacity                  = lookup(instances_distribution.value, \"on_demand_base_capacity\", null)\n        on_demand_percentage_above_base_capacity = lookup(instances_distribution.value, \"on_demand_percentage_above_base_capacity\", null)\n        spot_allocation_strategy                 = lookup(instances_distribution.value, \"spot_allocation_strategy\", null)\n        spot_instance_pools                      = lookup(instances_distribution.value, \"spot_instance_pools\", null)\n        spot_max_price                           = lookup(instances_distribution.value, \"spot_max_price\", null)\n      }\n    }\n  }\n\n  dynamic \"tag\" {\n    for_each = merge(\n      { \"eks:nodegroup-name\" = join(\"-\", [each.key]) },\n      local.eks-tag,\n    )\n    content {\n      key                 = tag.key\n      value               = tag.value\n      propagate_at_launch = true\n    }\n  }\n\n  lifecycle {\n    create_before_destroy = true\n    ignore_changes        = [desired_capacity, name]\n  }\n\n  depends_on = [\n    aws_iam_role.ng,\n    aws_iam_role_policy_attachment.eks-ng,\n    aws_iam_role_policy_attachment.eks-cni,\n    aws_iam_role_policy_attachment.ecr-read,\n    aws_launch_template.ng,\n    time_sleep.wait,\n  ]\n}\n\n## managed node groups\n\n# Render a multi-part cloud-init config making use of the part\n# above, and other source files\ndata \"cloudinit_config\" \"mng\" {\n  for_each      = { for ng in var.managed_node_groups : ng.name => ng }\n  base64_encode = true\n  gzip          = false\n\n  # Main cloud-config configuration file.\n  part {\n    content_type = \"text/x-shellscript\"\n    content      = <<-EOT\n    #!/bin/bash\n    ${var.enable_ssm ? \"yum install -y amazon-ssm-agent\\nsystemctl enable amazon-ssm-agent\\nsystemctl start amazon-ssm-agent\" : \"\"}\n    EOT\n  }\n}\n\nresource \"aws_launch_template\" \"mng\" {\n  for_each = { for ng in var.managed_node_groups : ng.name => ng }\n  name     = format(\"eks-%s\", uuid())\n  tags     = merge(local.default-tags, local.eks-tag, var.tags, lookup(each.value, \"tags\", {}))\n  user_data = (\n    length(regexall(\"^AL2\", lookup(each.value, \"ami_type\", local.default_eks_config.ami_type))) > 0 ?\n    data.cloudinit_config.mng[each.key].rendered :\n    length(regexall(\"^BOTTLEROCKET\", lookup(each.value, \"ami_type\", local.default_eks_config.ami_type))) > 0 ?\n    base64encode(local.bottlerocket_userdata) :\n    data.cloudinit_config.mng[each.key].rendered\n  )\n\n  block_device_mappings {\n    device_name = \"/dev/xvda\"\n    ebs {\n      volume_size           = lookup(each.value, \"volume_size\", local.default_eks_config.volume_size)\n      volume_type           = lookup(each.value, \"volume_type\", local.default_eks_config.volume_type)\n      delete_on_termination = true\n    }\n  }\n\n  metadata_options {\n    http_tokens = \"required\"\n  }\n\n  tag_specifications {\n    resource_type = \"instance\"\n    tags          = merge(local.default-tags, local.eks-tag, var.tags, lookup(each.value, \"tags\", {}))\n  }\n\n  lifecycle {\n    create_before_destroy = true\n    ignore_changes        = [name]\n  }\n}\n\nresource \"aws_eks_node_group\" \"ng\" {\n  for_each        = { for ng in var.managed_node_groups : ng.name => ng }\n  cluster_name    = aws_eks_cluster.cp.name\n  node_group_name = each.key\n  node_role_arn   = aws_iam_role.ng[\"enabled\"].arn\n  subnet_ids      = var.subnets\n  ami_type        = lookup(each.value, \"ami_type\", local.default_eks_config.ami_type)\n  capacity_type   = lookup(each.value, \"capacity_type\", local.default_eks_config.capacity_type)\n  instance_types  = [lookup(each.value, \"instance_type\", local.default_eks_config.instance_type)]\n  version         = aws_eks_cluster.cp.version\n  tags            = merge(local.default-tags, var.tags, lookup(each.value, \"tags\", {}))\n\n  scaling_config {\n    max_size     = lookup(each.value, \"max_size\", 3)\n    min_size     = lookup(each.value, \"min_size\", 1)\n    desired_size = lookup(each.value, \"desired_size\", 1)\n  }\n\n  launch_template {\n    id      = aws_launch_template.mng[each.key].id\n    version = aws_launch_template.mng[each.key].latest_version\n  }\n\n  lifecycle {\n    create_before_destroy = true\n    ignore_changes        = [scaling_config[0].desired_size]\n  }\n\n  depends_on = [\n    aws_iam_role.ng,\n    aws_iam_role_policy_attachment.eks-ng,\n    aws_iam_role_policy_attachment.eks-cni,\n    aws_iam_role_policy_attachment.ecr-read,\n    aws_launch_template.mng,\n    time_sleep.wait,\n  ]\n}\n\n## fargate\n# security/policy\nresource \"aws_iam_role\" \"fargate\" {\n  for_each = local.fargate_enabled ? toset([\"enabled\"]) : []\n  name     = join(\"-\", [local.name, \"fargate\"])\n  tags     = merge(local.default-tags, var.tags)\n  assume_role_policy = jsonencode({\n    Statement = [{\n      Action = \"sts:AssumeRole\"\n      Effect = \"Allow\"\n      Principal = {\n        Service = [format(\"eks-fargate-pods.%s\", module.aws.partition.dns_suffix)]\n      }\n    }]\n    Version = \"2012-10-17\"\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"eks-fargate\" {\n  count      = local.fargate_enabled ? 1 : 0\n  policy_arn = format(\"arn:%s:iam::aws:policy/AmazonEKSFargatePodExecutionRolePolicy\", module.aws.partition.partition)\n  role       = aws_iam_role.fargate[\"enabled\"].name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"fargate-extra\" {\n  for_each   = local.fargate_enabled ? { for k, v in var.policy_arns : k => v } : {}\n  policy_arn = each.value\n  role       = aws_iam_role.fargate[\"enabled\"].name\n}\n\nresource \"aws_eks_fargate_profile\" \"fargate\" {\n  for_each               = { for ng in var.fargate_profiles : ng.name => ng }\n  cluster_name           = aws_eks_cluster.cp.name\n  fargate_profile_name   = each.key\n  pod_execution_role_arn = aws_iam_role.fargate[\"enabled\"].arn\n  subnet_ids             = var.subnets\n  tags                   = merge(local.default-tags, var.tags, lookup(each.value, \"tags\", {}))\n\n  selector {\n    namespace = lookup(each.value, \"namespace\", \"default\")\n    labels    = lookup(each.value, \"labels\", null)\n  }\n\n  depends_on = [\n    aws_iam_role.fargate,\n    aws_iam_role_policy_attachment.eks-fargate,\n  ]\n}\n\ndata \"tls_certificate\" \"cert\" {\n  url = aws_eks_cluster.cp.identity.0.oidc.0.issuer\n}\n\nresource \"aws_iam_openid_connect_provider\" \"oidc\" {\n  client_id_list  = [\"sts.amazonaws.com\"]\n  thumbprint_list = data.tls_certificate.cert.certificates[*].sha1_fingerprint\n  url             = data.tls_certificate.cert.url\n}\n\nlocals {\n  oidc = {\n    arn = aws_iam_openid_connect_provider.oidc.arn\n    url = replace(aws_iam_openid_connect_provider.oidc.url, \"https://\", \"\")\n  }\n}\n\nprovider \"kubernetes\" {\n  host                   = aws_eks_cluster.cp.endpoint\n  token                  = data.aws_eks_cluster_auth.cp.token\n  cluster_ca_certificate = base64decode(aws_eks_cluster.cp.certificate_authority.0.data)\n}\n\nresource \"time_sleep\" \"wait\" {\n  for_each        = local.node_groups_enabled && !(local.managed_node_groups_enabled || local.fargate_enabled) ? toset([\"ng\"]) : []\n  create_duration = var.wait\n  depends_on      = [aws_eks_cluster.cp, ]\n}\n\nresource \"kubernetes_config_map\" \"aws-auth\" {\n  for_each   = local.node_groups_enabled && !(local.managed_node_groups_enabled || local.fargate_enabled) ? toset([\"ng\"]) : []\n  depends_on = [time_sleep.wait]\n  metadata {\n    name      = \"aws-auth\"\n    namespace = \"kube-system\"\n  }\n\n  data = {\n    mapRoles = yamlencode(\n      [{\n        rolearn  = aws_iam_role.ng[\"enabled\"].arn\n        username = \"system:node:{{EC2PrivateDNSName}}\"\n        groups   = [\"system:bootstrappers\", \"system:nodes\"]\n      }],\n    )\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Young-ook__terraform-aws-eks__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_37", "severity": "HIGH", "message": "Ensure Amazon EKS control plane logging is enabled for all log types", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Young-ook__terraform-aws-eks__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AWS_39", "severity": "HIGH", "message": "Ensure Amazon EKS public endpoint disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Young-ook__terraform-aws-eks__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AWS_38", "severity": "HIGH", "message": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Young-ook__terraform-aws-eks__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_AWS_58", "severity": "HIGH", "message": "Ensure EKS Cluster has Secrets Encryption Enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Young-ook__terraform-aws-eks__main.tf", "start_line": 32}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"consul_acl_auth_method\" \"minikube\" {\n  name        = \"minikube\"\n  type        = \"kubernetes\"\n  description = \"dev minikube cluster\"\n\n  config = {\n    Host              = \"https://192.0.2.42:8443\"\n    CACert            = \"-----BEGIN CERTIFICATE-----\\n...-----END CERTIFICATE-----\\n\"\n    ServiceAccountJWT = \"eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9...\"\n  }\n}\n\nresource \"consul_acl_binding_rule\" \"test\" {\n  auth_method = consul_acl_auth_method.minikube.name\n  description = \"foobar\"\n  selector    = \"serviceaccount.namespace==default\"\n  bind_type   = \"service\"\n  bind_name   = \"minikube\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-consul__examples__resources__consul_acl_binding_rule__resource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#########################################\n#  ESXI Provider host/login details\n#########################################\n#\n#   Use of variables here to hide/move the variables to a separate file\n#\nprovider \"esxi\" {\n  esxi_hostname = var.esxi_hostname\n  esxi_hostport = var.esxi_hostport\n  esxi_hostssl  = var.esxi_hostssl\n  esxi_username = var.esxi_username\n  esxi_password = var.esxi_password\n}\n\n#########################################\n#  Resource Pools\n#########################################\nresource \"esxi_resource_pool\" \"Terraform\" {\n  resource_pool_name = \"Terraform\"\n  cpu_min            = \"100\"\n  cpu_min_expandable = \"true\"\n  cpu_max            = \"8000\"\n  cpu_shares         = \"normal\"\n  mem_min            = \"200\"\n  mem_min_expandable = \"false\"\n  mem_max            = \"8192\"\n  mem_shares         = \"normal\"\n}\n\nresource \"esxi_resource_pool\" \"pool2\" {\n  resource_pool_name = \"${esxi_resource_pool.Terraform.resource_pool_name}/pool2\"\n}\n\n#########################################\n#  Virtual Disks\n#########################################\nresource \"esxi_virtual_disk\" \"vdisk1\" {\n  virtual_disk_disk_store = var.disk_store\n  virtual_disk_dir        = \"Terraform\"\n  virtual_disk_name       = \"vdisk_1.vmdk\"\n  virtual_disk_size       = 10\n  virtual_disk_type       = \"zeroedthick\"\n}\n\nresource \"esxi_virtual_disk\" \"vdisk2\" {\n  virtual_disk_disk_store = var.disk_store\n  virtual_disk_dir        = \"Terraform\"\n  virtual_disk_size       = 15\n  virtual_disk_type       = \"eagerzeroedthick\"\n}\n\n#########################################\n#  ESXI Guest resource\n#########################################\n#\n#  This Guest VM is a clone of an existing Guest VM named \"centos7\" (must exist and\n#  be powered off), located in the \"Templates\" resource pool.  vmtest03 will be powered\n#  on by default by terraform.  The virtual network \"VM Network\", must already exist on\n#  your esxi host!\n#\nresource \"esxi_guest\" \"vmtest03\" {\n  guest_name = \"vmtes03\"\n  disk_store = var.disk_store\n  guestos    = \"centos-64\"\n\n  boot_disk_type = \"thin\"\n  boot_disk_size = \"35\"\n\n  memsize            = \"2048\"\n  numvcpus           = \"2\"\n  resource_pool_name = esxi_resource_pool.pool2.resource_pool_name\n  power              = \"on\"\n\n  #  clone_from_vm uses ovftool to clone an existing Guest on your esxi host.  This example will clone a Guest VM named \"centos7\", located in the \"Templates\" resource pool.\n  #  ovf_source uses ovftool to produce a clone from an ovf or vmx image. (typically produced using the ovf_tool).\n  #    Basically clone_from_vm clones from sources on the esxi host and ovf_source clones from sources on your local hard disk or URL.\n  #    These two options are mutually exclusive.\n  clone_from_vm = \"Templates/centos7\"\n\n  #ovf_source        = \"/my_local_system_path/centos-7-min/centos-7.vmx\"\n\n  network_interfaces {\n    virtual_network = \"VM Network\"\n    mac_address     = \"00:50:56:a1:b1:c3\"\n    nic_type        = \"e1000\"\n  }\n\n  guest_startup_timeout  = 45\n  guest_shutdown_timeout = 30\n\n  virtual_disks {\n    virtual_disk_id = esxi_virtual_disk.vdisk1.id\n    slot            = \"0:1\"\n  }\n  virtual_disks {\n    virtual_disk_id = esxi_virtual_disk.vdisk2.id\n    slot            = \"0:2\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/josenk__terraform-provider-esxi__examples__03 Resource Pools - Additional Storage__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"vpc_id\" {\n  description = \"ID of the VPC\"\n  value       = module.vpc.vpc_id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices__examples__large-terraform__modules__network__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"grafana_organization\" \"test\" {\n  name = \"testing dashboards data source\"\n}\n\nresource \"grafana_folder\" \"data_source_dashboards\" {\n  org_id = grafana_organization.test.id\n\n  title = \"test folder data_source_dashboards\"\n}\n\nresource \"grafana_dashboard\" \"data_source_dashboards1\" {\n  org_id = grafana_organization.test.id\n\n  folder = grafana_folder.data_source_dashboards.id\n  config_json = jsonencode({\n    uid   = \"data-source-dashboards-1\"\n    title = \"data_source_dashboards 1\"\n    tags  = [\"dev\"]\n  })\n}\n\nresource \"grafana_dashboard\" \"data_source_dashboards2\" {\n  org_id = grafana_organization.test.id\n\n  config_json = jsonencode({\n    uid   = \"data-source-dashboards-2\"\n    title = \"data_source_dashboards 2\"\n    tags  = [\"prod\"]\n  })\n}\n\ndata \"grafana_dashboards\" \"tags\" {\n  org_id = grafana_organization.test.id\n  tags   = jsondecode(grafana_dashboard.data_source_dashboards1.config_json)[\"tags\"]\n}\n\ndata \"grafana_dashboards\" \"folder_uids\" {\n  org_id      = grafana_organization.test.id\n  folder_uids = [grafana_dashboard.data_source_dashboards1.folder]\n}\n\ndata \"grafana_dashboards\" \"folder_uids_tags\" {\n  org_id      = grafana_organization.test.id\n  folder_uids = [grafana_dashboard.data_source_dashboards1.folder]\n  tags        = jsondecode(grafana_dashboard.data_source_dashboards1.config_json)[\"tags\"]\n}\n\n// use depends_on to wait for dashboard resource to be created before searching\ndata \"grafana_dashboards\" \"all\" {\n  org_id = grafana_organization.test.id\n  depends_on = [\n    grafana_dashboard.data_source_dashboards1,\n    grafana_dashboard.data_source_dashboards2\n  ]\n}\n\n// get only one result\ndata \"grafana_dashboards\" \"limit_one\" {\n  org_id = grafana_organization.test.id\n  limit  = 1\n  depends_on = [\n    grafana_dashboard.data_source_dashboards1,\n    grafana_dashboard.data_source_dashboards2\n  ]\n}\n\n// The dashboards are not in the default org so this should return an empty list\ndata \"grafana_dashboards\" \"wrong_org\" {\n  depends_on = [\n    grafana_dashboard.data_source_dashboards1,\n    grafana_dashboard.data_source_dashboards2\n  ]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/grafana__terraform-provider-grafana__examples__data-sources__grafana_dashboards__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// Default matcher group for machines\nresource \"matchbox_group\" \"default\" {\n  name    = \"default\"\n  profile = matchbox_profile.fedora-coreos-install.name\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__matchbox__examples__terraform__fedora-coreos-install__groups.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"4.60\"\n    }\n  }\n}\n\n# Configure the AWS Provider\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\n\n\nresource \"aws_instance\" \"web\" {\n  ami           = ami-123\n  instance_type = \"t2.micro\"\n}\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/zealvora__terraform-beginner-to-advanced-resource__Section 6 - Security Primer__dependency-lock.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/zealvora__terraform-beginner-to-advanced-resource__Section 6 - Security Primer__dependency-lock.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/zealvora__terraform-beginner-to-advanced-resource__Section 6 - Security Primer__dependency-lock.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/zealvora__terraform-beginner-to-advanced-resource__Section 6 - Security Primer__dependency-lock.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/zealvora__terraform-beginner-to-advanced-resource__Section 6 - Security Primer__dependency-lock.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/zealvora__terraform-beginner-to-advanced-resource__Section 6 - Security Primer__dependency-lock.tf", "start_line": 17}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#\n# ONLY EDIT THIS FILE IN github.com/cloudposse/terraform-null-label\n# All other instances of this file should be a copy of that one\n#\n#\n# Copy this file from https://github.com/cloudposse/terraform-null-label/blob/master/exports/context.tf\n# and then place it in your Terraform module to automatically get\n# Cloud Posse's standard configuration inputs suitable for passing\n# to Cloud Posse modules.\n#\n# curl -sL https://raw.githubusercontent.com/cloudposse/terraform-null-label/master/exports/context.tf -o context.tf\n#\n# Modules should access the whole context as `module.this.context`\n# to get the input variables with nulls for defaults,\n# for example `context = module.this.context`,\n# and access individual variables as `module.this.<var>`,\n# with final values filled in.\n#\n# For example, when using defaults, `module.this.context.delimiter`\n# will be null, and `module.this.delimiter` will be `-` (hyphen).\n#\n\nmodule \"this\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.25.0\" # requires Terraform >= 0.13.0\n\n  enabled             = var.enabled\n  namespace           = var.namespace\n  tenant              = var.tenant\n  environment         = var.environment\n  stage               = var.stage\n  name                = var.name\n  delimiter           = var.delimiter\n  attributes          = var.attributes\n  tags                = var.tags\n  additional_tag_map  = var.additional_tag_map\n  label_order         = var.label_order\n  regex_replace_chars = var.regex_replace_chars\n  id_length_limit     = var.id_length_limit\n  label_key_case      = var.label_key_case\n  label_value_case    = var.label_value_case\n  descriptor_formats  = var.descriptor_formats\n  labels_as_tags      = var.labels_as_tags\n\n  context = var.context\n}\n\n# Copy contents of cloudposse/terraform-null-label/variables.tf here\n\nvariable \"context\" {\n  type = any\n  default = {\n    enabled             = true\n    namespace           = null\n    tenant              = null\n    environment         = null\n    stage               = null\n    name                = null\n    delimiter           = null\n    attributes          = []\n    tags                = {}\n    additional_tag_map  = {}\n    regex_replace_chars = null\n    label_order         = []\n    id_length_limit     = null\n    label_key_case      = null\n    label_value_case    = null\n    descriptor_formats  = {}\n    # Note: we have to use [] instead of null for unset lists due to\n    # https://github.com/hashicorp/terraform/issues/28137\n    # which was not fixed until Terraform 1.0.0,\n    # but we want the default to be all the labels in `label_order`\n    # and we want users to be able to prevent all tag generation\n    # by setting `labels_as_tags` to `[]`, so we need\n    # a different sentinel to indicate \"default\"\n    labels_as_tags = [\"unset\"]\n  }\n  description = <<-EOT\n    Single object for setting entire context at once.\n    See description of individual variables for details.\n    Leave string and numeric variables as `null` to use default value.\n    Individual variable settings (non-null) override settings in context object,\n    except for attributes, tags, and additional_tag_map, which are merged.\n  EOT\n\n  validation {\n    condition     = lookup(var.context, \"label_key_case\", null) == null ? true : contains([\"lower\", \"title\", \"upper\"], var.context[\"label_key_case\"])\n    error_message = \"Allowed values: `lower`, `title`, `upper`.\"\n  }\n\n  validation {\n    condition     = lookup(var.context, \"label_value_case\", null) == null ? true : contains([\"lower\", \"title\", \"upper\", \"none\"], var.context[\"label_value_case\"])\n    error_message = \"Allowed values: `lower`, `title`, `upper`, `none`.\"\n  }\n}\n\nvariable \"enabled\" {\n  type        = bool\n  default     = null\n  description = \"Set to false to prevent the module from creating any resources\"\n}\n\nvariable \"namespace\" {\n  type        = string\n  default     = null\n  description = \"ID element. Usually an abbreviation of your organization name, e.g. 'eg' or 'cp', to help ensure generated IDs are globally unique\"\n}\n\nvariable \"tenant\" {\n  type        = string\n  default     = null\n  description = \"ID element _(Rarely used, not included by default)_. A customer identifier, indicating who this instance of a resource is for\"\n}\n\nvariable \"environment\" {\n  type        = string\n  default     = null\n  description = \"ID element. Usually used for region e.g. 'uw2', 'us-west-2', OR role 'prod', 'staging', 'dev', 'UAT'\"\n}\n\nvariable \"stage\" {\n  type        = string\n  default     = null\n  description = \"ID element. Usually used to indicate role, e.g. 'prod', 'staging', 'source', 'build', 'test', 'deploy', 'release'\"\n}\n\nvariable \"name\" {\n  type        = string\n  default     = null\n  description = <<-EOT\n    ID element. Usually the component or solution name, e.g. 'app' or 'jenkins'.\n    This is the only ID element not also included as a `tag`.\n    The \"name\" tag is set to the full `id` string. There is no tag with the value of the `name` input.\n    EOT\n}\n\nvariable \"delimiter\" {\n  type        = string\n  default     = null\n  description = <<-EOT\n    Delimiter to be used between ID elements.\n    Defaults to `-` (hyphen). Set to `\"\"` to use no delimiter at all.\n  EOT\n}\n\nvariable \"attributes\" {\n  type        = list(string)\n  default     = []\n  description = <<-EOT\n    ID element. Additional attributes (e.g. `workers` or `cluster`) to add to `id`,\n    in the order they appear in the list. New attributes are appended to the\n    end of the list. The elements of the list are joined by the `delimiter`\n    and treated as a single ID element.\n    EOT\n}\n\nvariable \"labels_as_tags\" {\n  type        = set(string)\n  default     = [\"default\"]\n  description = <<-EOT\n    Set of labels (ID elements) to include as tags in the `tags` output.\n    Default is to include all labels.\n    Tags with empty values will not be included in the `tags` output.\n    Set to `[]` to suppress all generated tags.\n    **Notes:**\n      The value of the `name` tag, if included, will be the `id`, not the `name`.\n      Unlike other `null-label` inputs, the initial setting of `labels_as_tags` cannot be\n      changed in later chained modules. Attempts to change it will be silently ignored.\n    EOT\n}\n\nvariable \"tags\" {\n  type        = map(string)\n  default     = {}\n  description = <<-EOT\n    Additional tags (e.g. `{'BusinessUnit': 'XYZ'}`).\n    Neither the tag keys nor the tag values will be modified by this module.\n    EOT\n}\n\nvariable \"additional_tag_map\" {\n  type        = map(string)\n  default     = {}\n  description = <<-EOT\n    Additional key-value pairs to add to each map in `tags_as_list_of_maps`. Not added to `tags` or `id`.\n    This is for some rare cases where resources want additional configuration of tags\n    and therefore take a list of maps with tag key, value, and additional configuration.\n    EOT\n}\n\nvariable \"label_order\" {\n  type        = list(string)\n  default     = null\n  description = <<-EOT\n    The order in which the labels (ID elements) appear in the `id`.\n    Defaults to [\"namespace\", \"environment\", \"stage\", \"name\", \"attributes\"].\n    You can omit any of the 6 labels (\"tenant\" is the 6th), but at least one must be present.\n    EOT\n}\n\nvariable \"regex_replace_chars\" {\n  type        = string\n  default     = null\n  description = <<-EOT\n    Terraform regular expression (regex) string.\n    Characters matching the regex will be removed from the ID elements.\n    If not set, `\"/[^a-zA-Z0-9-]/\"` is used to remove all characters other than hyphens, letters and digits.\n  EOT\n}\n\nvariable \"id_length_limit\" {\n  type        = number\n  default     = null\n  description = <<-EOT\n    Limit `id` to this many characters (minimum 6).\n    Set to `0` for unlimited length.\n    Set to `null` for keep the existing setting, which defaults to `0`.\n    Does not affect `id_full`.\n  EOT\n  validation {\n    condition     = var.id_length_limit == null ? true : var.id_length_limit >= 6 || var.id_length_limit == 0\n    error_message = \"The id_length_limit must be >= 6 if supplied (not null), or 0 for unlimited length.\"\n  }\n}\n\nvariable \"label_key_case\" {\n  type        = string\n  default     = null\n  description = <<-EOT\n    Controls the letter case of the `tags` keys (label names) for tags generated by this module.\n    Does not affect keys of tags passed in via the `tags` input.\n    Possible values: `lower`, `title`, `upper`.\n    Default value: `title`.\n  EOT\n\n  validation {\n    condition     = var.label_key_case == null ? true : contains([\"lower\", \"title\", \"upper\"], var.label_key_case)\n    error_message = \"Allowed values: `lower`, `title`, `upper`.\"\n  }\n}\n\nvariable \"label_value_case\" {\n  type        = string\n  default     = null\n  description = <<-EOT\n    Controls the letter case of ID elements (labels) as included in `id`,\n    set as tag values, and output by this module individually.\n    Does not affect values of tags passed in via the `tags` input.\n    Possible values: `lower`, `title`, `upper` and `none` (no transformation).\n    Set this to `title` and set `delimiter` to `\"\"` to yield Pascal Case IDs.\n    Default value: `lower`.\n  EOT\n\n  validation {\n    condition     = var.label_value_case == null ? true : contains([\"lower\", \"title\", \"upper\", \"none\"], var.label_value_case)\n    error_message = \"Allowed values: `lower`, `title`, `upper`, `none`.\"\n  }\n}\n\nvariable \"descriptor_formats\" {\n  type        = any\n  default     = {}\n  description = <<-EOT\n    Describe additional descriptors to be output in the `descriptors` output map.\n    Map of maps. Keys are names of descriptors. Values are maps of the form\n    `{\n       format = string\n       labels = list(string)\n    }`\n    (Type is `any` so the map values can later be enhanced to provide additional options.)\n    `format` is a Terraform format string to be passed to the `format()` function.\n    `labels` is a list of labels, in order, to pass to `format()` function.\n    Label values will be normalized before being passed to `format()` so they will be\n    identical to how they appear in `id`.\n    Default is `{}` (`descriptors` output will be empty).\n    EOT\n}\n\n#### End of copy of cloudposse/terraform-null-label/variables.tf\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-components__deprecated__account-map__context.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-components__deprecated__account-map__context.tf", "start_line": 23}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\nCopyright 2019 The KubeOne Authors.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\nprovider \"digitalocean\" {\n}\n\nlocals {\n  kube_cluster_tag            = \"kubernetes-cluster:${var.cluster_name}\"\n  control_plane_droplet_image = var.control_plane_droplet_image == \"\" ? var.image_references[var.os].image_name : var.control_plane_droplet_image\n  worker_os                   = var.worker_os == \"\" ? var.image_references[var.os].worker_os : var.worker_os\n  ssh_username                = var.ssh_username == \"\" ? var.image_references[var.os].ssh_username : var.ssh_username\n  kubeapi_endpoint            = var.disable_kubeapi_loadbalancer ? digitalocean_droplet.control_plane.0.ipv4_address_private : digitalocean_loadbalancer.control_plane.0.ip\n  loadbalancer_count          = var.disable_kubeapi_loadbalancer ? 0 : 1\n\n  cluster_autoscaler_min_replicas = var.cluster_autoscaler_min_replicas > 0 ? var.cluster_autoscaler_min_replicas : var.initial_machinedeployment_replicas\n  cluster_autoscaler_max_replicas = var.cluster_autoscaler_max_replicas > 0 ? var.cluster_autoscaler_max_replicas : var.initial_machinedeployment_replicas\n}\n\nresource \"digitalocean_tag\" \"kube_cluster_tag\" {\n  name = local.kube_cluster_tag\n}\n\nresource \"digitalocean_ssh_key\" \"deployer\" {\n  name       = \"${var.cluster_name}-deployer-key\"\n  public_key = file(var.ssh_public_key_file)\n}\n\nresource \"digitalocean_droplet\" \"control_plane\" {\n  count = var.control_plane_vm_count\n  name  = \"${var.cluster_name}-control-plane-${count.index + 1}\"\n\n  tags = [\n    local.kube_cluster_tag,\n    \"kubeone\",\n  ]\n\n  image              = local.control_plane_droplet_image\n  region             = var.region\n  size               = var.control_plane_size\n  private_networking = true\n  monitoring         = false\n  ipv6               = false\n\n  ssh_keys = [\n    digitalocean_ssh_key.deployer.id,\n  ]\n}\n\nresource \"digitalocean_loadbalancer\" \"control_plane\" {\n  depends_on = [\n    digitalocean_droplet.control_plane,\n    time_sleep.wait_60_seconds,\n  ]\n\n  count = local.loadbalancer_count\n\n  name   = \"${var.cluster_name}-lb\"\n  region = var.region\n\n  forwarding_rule {\n    entry_port     = 6443\n    entry_protocol = \"tcp\"\n\n    target_port     = 6443\n    target_protocol = \"tcp\"\n  }\n\n  healthcheck {\n    port     = 6443\n    protocol = \"tcp\"\n  }\n\n  droplet_tag = local.kube_cluster_tag\n}\n\n# Hack to ensure apt update has released the lock file\nresource \"time_sleep\" \"wait_60_seconds\" {\n  depends_on      = [digitalocean_droplet.control_plane]\n  create_duration = \"60s\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__digitalocean__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource Block: Create Random Pet Name \nresource \"random_pet\" \"petname\" {\n  length    = 5\n  separator = \"-\"\n}\n\n# Resource Block: Create AWS S3 Bucket\nresource \"aws_s3_bucket\" \"sample\" {\n  bucket = random_pet.petname.id\n  acl    = \"public-read\"\n  region = \"us-east-1\"  # Comment this if we are going to use AWS Provider v3.x version\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-04-Providers-Dependency-Lock-File__terraform-manifests__c2-s3bucket.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-04-Providers-Dependency-Lock-File__terraform-manifests__c2-s3bucket.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-04-Providers-Dependency-Lock-File__terraform-manifests__c2-s3bucket.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-04-Providers-Dependency-Lock-File__terraform-manifests__c2-s3bucket.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-04-Providers-Dependency-Lock-File__terraform-manifests__c2-s3bucket.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-04-Providers-Dependency-Lock-File__terraform-manifests__c2-s3bucket.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-04-Providers-Dependency-Lock-File__terraform-manifests__c2-s3bucket.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-04-Providers-Dependency-Lock-File__terraform-manifests__c2-s3bucket.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_AWS_20", "severity": "HIGH", "message": "S3 Bucket has an ACL defined which allows public READ access.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-04-Providers-Dependency-Lock-File__terraform-manifests__c2-s3bucket.tf", "start_line": 8}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_ami\" \"ubuntu\" {\n  most_recent = true\n  owners      = [\"099720109477\"] # Owner is Canonical\n\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-*-22.04-amd64-server-*\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n}\n\n# resource \"aws_instance\" \"compute\" {\n#   ami           = data.aws_ami.ubuntu.id\n#   instance_type = var.ec2_instance_type\n\n#   root_block_device {\n#     delete_on_termination = true\n#     volume_size           = var.ec2_volume_config.size\n#     volume_type           = var.ec2_volume_config.type\n#   }\n\n#   tags = merge(local.common_tags, var.additional_tags)\n# }", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__08-input-vars-locals-outputs__compute.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_alb\" \"main\" {\n  name     = \"${var.name}\"\n\n  security_groups = [\"${var.security_groups}\"]\n  subnets         = [\"${var.subnet_ids}\"]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/outsideris__citizen__test__integration__fixture__alb__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_131", "severity": "HIGH", "message": "Ensure that ALB drops HTTP headers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/outsideris__citizen__test__integration__fixture__alb__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_91", "severity": "HIGH", "message": "Ensure the ELBv2 (Application/Network) has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/outsideris__citizen__test__integration__fixture__alb__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_150", "severity": "HIGH", "message": "Ensure that Load Balancer has deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/outsideris__citizen__test__integration__fixture__alb__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_28", "severity": "CRITICAL", "message": "Ensure public facing ALB are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/outsideris__citizen__test__integration__fixture__alb__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"test_instance\" \"tmpl\" {\n  foo = \"${file(\"${path.module}/template.txt\")}\"\n}\n\noutput \"template\" {\n\tvalue = \"${test_instance.tmpl.foo}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/koding__terraform__command__test-fixtures__apply-plan-no-module__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    kafka = {\n      source = \"Mongey/kafka\"\n    }\n  }\n}\n\nprovider \"kafka\" {\n  bootstrap_servers = [\"localhost:9092\"]\n\n  ca_cert     = file(\"../secrets/ca.crt\")\n  client_cert = file(\"../secrets/client.pem\")\n  client_key  = file(\"../secrets/client-no-password.key\")\n  tls_enabled = true\n}\n\n# Make sure we don't lock down ourself on first run of terraform.\n# First grant ourself admin permissions, then add ACL for topic.\nresource \"kafka_acl\" \"global\" {\n  resource_name       = \"*\"\n  resource_type       = \"Topic\"\n  acl_principal       = \"User:*\"\n  acl_host            = \"*\"\n  acl_operation       = \"All\"\n  acl_permission_type = \"Allow\"\n}\n\nresource \"kafka_topic\" \"syslog\" {\n  name               = \"syslog\"\n  replication_factor = 1\n  partitions         = 4\n\n  config = {\n    \"segment.ms\"   = \"4000\"\n    \"retention.ms\" = \"86400000\"\n  }\n\n  depends_on = [kafka_acl.global]\n}\n\nresource \"kafka_acl\" \"test\" {\n  resource_name       = \"syslog\"\n  resource_type       = \"Topic\"\n  acl_principal       = \"User:Alice\"\n  acl_host            = \"*\"\n  acl_operation       = \"Write\"\n  acl_permission_type = \"Deny\"\n\n  depends_on = [kafka_acl.global]\n}\n\nresource \"kafka_quota\" \"quota1\" {\n  entity_name = \"client1\"\n  entity_type = \"client-id\"\n  config = {\n    \"consumer_byte_rate\" = \"4000000\"\n    \"producer_byte_rate\" = \"3500000\"\n  }\n}\n\nresource \"kafka_quota\" \"default_user_quota\" {\n  // omit the entity_name to set the default quota\n  entity_type = \"user\"\n  config = {\n    \"consumer_byte_rate\" = \"2000000\"\n    \"producer_byte_rate\" = \"1500000\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Mongey__terraform-provider-kafka__examples__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource: EC2 Instance\nresource \"aws_instance\" \"myec2vm\" {\n  ami = \"ami-0e5b6b6a9f3db6db8\"\n  instance_type = \"t3.micro\"\n  user_data = file(\"${path.module}/app1-install.sh\")\n  tags = {\n    \"Name\" = \"EC2 Demo\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__03 - Language Syntax__manifests__ec2instance.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__03 - Language Syntax__manifests__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__03 - Language Syntax__manifests__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__03 - Language Syntax__manifests__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__03 - Language Syntax__manifests__ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__03 - Language Syntax__manifests__ec2instance.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    coder = {\n      source = \"coder/coder\"\n    }\n    docker = {\n      source  = \"kreuzwerker/docker\"\n      version = \"~> 3.0\"\n    }\n    envbuilder = {\n      source = \"coder/envbuilder\"\n    }\n  }\n}\n\nlocals {\n  // These are cluster service addresses mapped to Tailscale nodes.\n  // Ask #dogfood-admins for help.\n  // NOTE: keep these up to date with those in ../dogfood/main.tf!\n  docker_host = {\n    \"\"              = \"tcp://dogfood-ts-cdr-dev.tailscale.svc.cluster.local:2375\"\n    \"us-pittsburgh\" = \"tcp://dogfood-ts-cdr-dev.tailscale.svc.cluster.local:2375\"\n    // For legacy reasons, this host is labelled `eu-helsinki` but it's\n    // actually in Germany now.\n    \"eu-helsinki\" = \"tcp://katerose-fsn-cdr-dev.tailscale.svc.cluster.local:2375\"\n    \"ap-sydney\"   = \"tcp://wolfgang-syd-cdr-dev.tailscale.svc.cluster.local:2375\"\n    \"za-jnb\"      = \"tcp://greenhill-jnb-cdr-dev.tailscale.svc.cluster.local:2375\"\n  }\n\n  envbuilder_repo = \"ghcr.io/coder/envbuilder-preview\"\n  container_name  = \"coder-${data.coder_workspace_owner.me.name}-${lower(data.coder_workspace.me.name)}\"\n  // Envbuilder clones repos to /workspaces by default.\n  repo_dir = \"/workspaces/coder\"\n}\n\ndata \"coder_parameter\" \"devcontainer_repo\" {\n  type        = \"string\"\n  name        = \"Devcontainer Repository\"\n  default     = \"https://github.com/coder/coder\"\n  description = \"Repo containing a devcontainer.json. This is only cloned once.\"\n  mutable     = false\n}\n\ndata \"coder_parameter\" \"devcontainer_dir\" {\n  type        = \"string\"\n  name        = \"Devcontainer Directory\"\n  default     = \"dogfood/coder/\"\n  description = \"Directory containing a devcontainer.json relative to the repository root\"\n  mutable     = true\n}\n\ndata \"coder_parameter\" \"region\" {\n  type    = \"string\"\n  name    = \"Region\"\n  icon    = \"/emojis/1f30e.png\"\n  default = \"us-pittsburgh\"\n  option {\n    icon  = \"/emojis/1f1fa-1f1f8.png\"\n    name  = \"Pittsburgh\"\n    value = \"us-pittsburgh\"\n  }\n  option {\n    icon = \"/emojis/1f1e9-1f1ea.png\"\n    name = \"Falkenstein\"\n    // For legacy reasons, this host is labelled `eu-helsinki` but it's\n    // actually in Germany now.\n    value = \"eu-helsinki\"\n  }\n  option {\n    icon  = \"/emojis/1f1e6-1f1fa.png\"\n    name  = \"Sydney\"\n    value = \"ap-sydney\"\n  }\n  option {\n    icon  = \"/emojis/1f1ff-1f1e6.png\"\n    name  = \"Johannesburg\"\n    value = \"za-jnb\"\n  }\n}\n\n# This file is mounted as a Kubernetes secret on provisioner pods.\n# It contains the required credentials for the envbuilder cache repo.\nvariable \"envbuilder_cache_dockerconfigjson_path\" {\n  type      = string\n  sensitive = true\n}\n\nprovider \"docker\" {\n  host = lookup(local.docker_host, data.coder_parameter.region.value)\n  registry_auth {\n    address     = \"us-central1-docker.pkg.dev\"\n    config_file = pathexpand(var.envbuilder_cache_dockerconfigjson_path)\n  }\n}\n\nprovider \"coder\" {}\n\ndata \"coder_external_auth\" \"github\" {\n  id = \"github\"\n}\n\ndata \"coder_workspace\" \"me\" {}\ndata \"coder_workspace_owner\" \"me\" {}\n\nmodule \"slackme\" {\n  source           = \"dev.registry.coder.com/coder/slackme/coder\"\n  version          = \"1.0.32\"\n  agent_id         = coder_agent.dev.id\n  auth_provider_id = \"slack\"\n}\n\nmodule \"dotfiles\" {\n  source   = \"dev.registry.coder.com/coder/dotfiles/coder\"\n  version  = \"1.2.2\"\n  agent_id = coder_agent.dev.id\n}\n\nmodule \"personalize\" {\n  source   = \"dev.registry.coder.com/coder/personalize/coder\"\n  version  = \"1.0.32\"\n  agent_id = coder_agent.dev.id\n}\n\nmodule \"code-server\" {\n  source                  = \"dev.registry.coder.com/coder/code-server/coder\"\n  version                 = \"1.4.1\"\n  agent_id                = coder_agent.dev.id\n  folder                  = local.repo_dir\n  auto_install_extensions = true\n}\n\nmodule \"jetbrains\" {\n  count      = data.coder_workspace.me.start_count\n  source     = \"dev.registry.coder.com/coder/jetbrains/coder\"\n  version    = \"~> 1.0\"\n  agent_id   = coder_agent.dev.id\n  agent_name = \"dev\"\n  folder     = local.repo_dir\n}\n\nmodule \"filebrowser\" {\n  source   = \"dev.registry.coder.com/coder/filebrowser/coder\"\n  version  = \"1.1.3\"\n  agent_id = coder_agent.dev.id\n}\n\nmodule \"coder-login\" {\n  source   = \"dev.registry.coder.com/coder/coder-login/coder\"\n  version  = \"1.1.1\"\n  agent_id = coder_agent.dev.id\n}\n\nresource \"coder_agent\" \"dev\" {\n  arch = \"amd64\"\n  os   = \"linux\"\n  dir  = local.repo_dir\n  env = {\n    OIDC_TOKEN : data.coder_workspace_owner.me.oidc_access_token,\n  }\n  startup_script_behavior = \"blocking\"\n\n  # The following metadata blocks are optional. They are used to display\n  # information about your workspace in the dashboard. You can remove them\n  # if you don't want to display any information.\n  metadata {\n    display_name = \"CPU Usage\"\n    key          = \"cpu_usage\"\n    order        = 0\n    script       = \"coder stat cpu\"\n    interval     = 10\n    timeout      = 1\n  }\n\n  metadata {\n    display_name = \"RAM Usage\"\n    key          = \"ram_usage\"\n    order        = 1\n    script       = \"coder stat mem\"\n    interval     = 10\n    timeout      = 1\n  }\n\n  metadata {\n    display_name = \"CPU Usage (Host)\"\n    key          = \"cpu_usage_host\"\n    order        = 2\n    script       = \"coder stat cpu --host\"\n    interval     = 10\n    timeout      = 1\n  }\n\n  metadata {\n    display_name = \"RAM Usage (Host)\"\n    key          = \"ram_usage_host\"\n    order        = 3\n    script       = \"coder stat mem --host\"\n    interval     = 10\n    timeout      = 1\n  }\n\n  metadata {\n    display_name = \"Swap Usage (Host)\"\n    key          = \"swap_usage_host\"\n    order        = 4\n    script       = <<EOT\n      #!/bin/bash\n      echo \"$(free -b | awk '/^Swap/ { printf(\"%.1f/%.1f\", $3/1024.0/1024.0/1024.0, $2/1024.0/1024.0/1024.0) }') GiB\"\n    EOT\n    interval     = 10\n    timeout      = 1\n  }\n\n  metadata {\n    display_name = \"Load Average (Host)\"\n    key          = \"load_host\"\n    order        = 5\n    # get load avg scaled by number of cores\n    script   = <<EOT\n      #!/bin/bash\n      echo \"`cat /proc/loadavg | awk '{ print $1 }'` `nproc`\" | awk '{ printf \"%0.2f\", $1/$2 }'\n    EOT\n    interval = 60\n    timeout  = 1\n  }\n\n  metadata {\n    display_name = \"Disk Usage (Host)\"\n    key          = \"disk_host\"\n    order        = 6\n    script       = \"coder stat disk --path /\"\n    interval     = 600\n    timeout      = 10\n  }\n\n  metadata {\n    display_name = \"Word of the Day\"\n    key          = \"word\"\n    order        = 7\n    script       = <<EOT\n      #!/bin/bash\n      curl -o - --silent https://www.merriam-webster.com/word-of-the-day 2>&1 | awk ' $0 ~ \"Word of the Day: [A-z]+\" { print $5; exit }'\n    EOT\n    interval     = 86400\n    timeout      = 5\n  }\n\n  startup_script = <<-EOT\n    set -eux -o pipefail\n\n    # Allow synchronization between scripts.\n    trap 'touch /tmp/.coder-startup-script.done' EXIT\n\n    # BUG: Kaniko does not symlink /run => /var/run properly, resulting in\n    # /var/run/ owned by root:root\n    # WORKAROUND: symlink it manually\n    sudo ln -s /run /var/run\n    # Start Docker service\n    sudo service docker start\n\n    # Chown /var/run/docker.sock as even though we are a member of the Docker group\n    # it did not exist at the start of the workspace. This can be worked around with\n    # `newgrp docker` but this is annoying to have to do manually.\n    for attempt in $(seq 1 10); do\n      if sudo docker info > /dev/null; then break; fi\n      sleep 1\n    done\n    sudo chmod a+rw /var/run/docker.sock\n\n    # Install playwright dependencies\n    # We want to use the playwright version from site/package.json\n    # Check if the directory exists At workspace creation as the coder_script runs in parallel so clone might not exist yet.\n    while ! [[ -f \"${local.repo_dir}/site/package.json\" ]]; do\n      sleep 1\n    done\n    cd \"${local.repo_dir}/site\" && pnpm install && pnpm playwright:install\n  EOT\n}\n\nresource \"docker_volume\" \"home_volume\" {\n  name = \"coder-${data.coder_workspace.me.id}-home\"\n  # Protect the volume from being deleted due to changes in attributes.\n  lifecycle {\n    ignore_changes = all\n  }\n  # Add labels in Docker to keep track of orphan resources.\n  labels {\n    label = \"coder.owner\"\n    value = data.coder_workspace_owner.me.name\n  }\n  labels {\n    label = \"coder.owner_id\"\n    value = data.coder_workspace_owner.me.id\n  }\n  labels {\n    label = \"coder.workspace_id\"\n    value = data.coder_workspace.me.id\n  }\n  # This field becomes outdated if the workspace is renamed but can\n  # be useful for debugging or cleaning out dangling volumes.\n  labels {\n    label = \"coder.workspace_name_at_creation\"\n    value = data.coder_workspace.me.name\n  }\n}\n\nresource \"docker_volume\" \"workspaces\" {\n  name = \"coder-${data.coder_workspace.me.id}\"\n  # Protect the volume from being deleted due to changes in attributes.\n  lifecycle {\n    ignore_changes = all\n  }\n  # Add labels in Docker to keep track of orphan resources.\n  labels {\n    label = \"coder.owner\"\n    value = data.coder_workspace_owner.me.name\n  }\n  labels {\n    label = \"coder.owner_id\"\n    value = data.coder_workspace_owner.me.id\n  }\n  labels {\n    label = \"coder.workspace_id\"\n    value = data.coder_workspace.me.id\n  }\n  # This field becomes outdated if the workspace is renamed but can\n  # be useful for debugging or cleaning out dangling volumes.\n  labels {\n    label = \"coder.workspace_name_at_creation\"\n    value = data.coder_workspace.me.name\n  }\n}\n\n# This file is mounted as a Kubernetes secret on provisioner pods.\n# It contains the required credentials for the envbuilder cache repo.\ndata \"local_sensitive_file\" \"envbuilder_cache_dockerconfigjson\" {\n  filename = var.envbuilder_cache_dockerconfigjson_path\n}\n\ndata \"docker_registry_image\" \"envbuilder\" {\n  name = \"${local.envbuilder_repo}:latest\"\n}\n\nresource \"docker_image\" \"envbuilder\" {\n  name          = \"${local.envbuilder_repo}@${data.docker_registry_image.envbuilder.sha256_digest}\"\n  pull_triggers = [data.docker_registry_image.envbuilder.sha256_digest]\n  keep_locally  = true\n}\n\nlocals {\n  cache_repo = \"us-central1-docker.pkg.dev/coder-dogfood-v2/envbuilder-cache/coder-dogfood\"\n  envbuilder_env = {\n    \"CODER_AGENT_TOKEN\" : coder_agent.dev.token,\n    \"CODER_AGENT_URL\" : data.coder_workspace.me.access_url,\n    \"ENVBUILDER_GIT_USERNAME\" : data.coder_external_auth.github.access_token,\n    # \"ENVBUILDER_GIT_URL\" : data.coder_parameter.devcontainer_repo.value, # The provider sets this via the `git_url` property.\n    \"ENVBUILDER_DEVCONTAINER_DIR\" : data.coder_parameter.devcontainer_dir.value,\n    \"ENVBUILDER_INIT_SCRIPT\" : coder_agent.dev.init_script,\n    \"ENVBUILDER_FALLBACK_IMAGE\" : \"codercom/oss-dogfood:latest\", # This image runs if builds fail\n    \"ENVBUILDER_PUSH_IMAGE\" : \"true\",                            # Push the image to the remote cache\n    # \"ENVBUILDER_CACHE_REPO\" : local.cache_repo, # The provider sets this via the `cache_repo` property.\n    \"ENVBUILDER_DOCKER_CONFIG_BASE64\" : data.local_sensitive_file.envbuilder_cache_dockerconfigjson.content_base64,\n    \"USE_CAP_NET_ADMIN\" : \"true\",\n    # Set git commit details correctly\n    \"GIT_AUTHOR_NAME\" : coalesce(data.coder_workspace_owner.me.full_name, data.coder_workspace_owner.me.name),\n    \"GIT_AUTHOR_EMAIL\" : data.coder_workspace_owner.me.email,\n    \"GIT_COMMITTER_NAME\" : coalesce(data.coder_workspace_owner.me.full_name, data.coder_workspace_owner.me.name),\n    \"GIT_COMMITTER_EMAIL\" : data.coder_workspace_owner.me.email,\n  }\n}\n\n# Check for the presence of a prebuilt image in the cache repo\n# that we can use instead.\nresource \"envbuilder_cached_image\" \"cached\" {\n  count         = data.coder_workspace.me.start_count\n  builder_image = docker_image.envbuilder.name\n  git_url       = data.coder_parameter.devcontainer_repo.value\n  cache_repo    = local.cache_repo\n  extra_env     = local.envbuilder_env\n}\n\nresource \"docker_container\" \"workspace\" {\n  count = data.coder_workspace.me.start_count\n  image = envbuilder_cached_image.cached.0.image\n  name  = local.container_name\n  # Hostname makes the shell more user friendly: coder@my-workspace:~$\n  hostname = data.coder_workspace.me.name\n  # CPU limits are unnecessary since Docker will load balance automatically\n  memory  = 32768\n  runtime = \"sysbox-runc\"\n  # Use environment computed from the provider\n  env = envbuilder_cached_image.cached.0.env\n  host {\n    host = \"host.docker.internal\"\n    ip   = \"host-gateway\"\n  }\n  volumes {\n    container_path = \"/home/coder/\"\n    volume_name    = docker_volume.home_volume.name\n    read_only      = false\n  }\n  volumes {\n    container_path = local.repo_dir\n    volume_name    = docker_volume.workspaces.name\n    read_only      = false\n  }\n  capabilities {\n    add = [\"CAP_NET_ADMIN\", \"CAP_SYS_NICE\"]\n  }\n  # Add labels in Docker to keep track of orphan resources.\n  labels {\n    label = \"coder.owner\"\n    value = data.coder_workspace_owner.me.name\n  }\n  labels {\n    label = \"coder.owner_id\"\n    value = data.coder_workspace_owner.me.id\n  }\n  labels {\n    label = \"coder.workspace_id\"\n    value = data.coder_workspace.me.id\n  }\n  labels {\n    label = \"coder.workspace_name\"\n    value = data.coder_workspace.me.name\n  }\n}\n\nresource \"coder_metadata\" \"container_info\" {\n  count       = data.coder_workspace.me.start_count\n  resource_id = coder_agent.dev.id\n  item {\n    key   = \"memory\"\n    value = docker_container.workspace[0].memory\n  }\n  item {\n    key   = \"runtime\"\n    value = docker_container.workspace[0].runtime\n  }\n  item {\n    key   = \"region\"\n    value = data.coder_parameter.region.option[index(data.coder_parameter.region.option.*.value, data.coder_parameter.region.value)].name\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/coder__coder__dogfood__coder-envbuilder__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/coder__coder__dogfood__coder-envbuilder__main.tf", "start_line": 105}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/coder__coder__dogfood__coder-envbuilder__main.tf", "start_line": 112}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/coder__coder__dogfood__coder-envbuilder__main.tf", "start_line": 118}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/coder__coder__dogfood__coder-envbuilder__main.tf", "start_line": 124}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/coder__coder__dogfood__coder-envbuilder__main.tf", "start_line": 132}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/coder__coder__dogfood__coder-envbuilder__main.tf", "start_line": 141}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/coder__coder__dogfood__coder-envbuilder__main.tf", "start_line": 147}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"auth0\" {}\n\nresource \"auth0_prompt\" \"prompt\" {\n  universal_login_experience = \"classic\"\n  identifier_first           = false\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alexkappa__terraform-provider-auth0__example__prompt__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Terraform Settings Block\nterraform {\n  required_version = \"~> 1.0\"\n  required_providers {\n    aws = {\n        source  = \"hashicorp/aws\"\n        version = \"~> 3.0\"\n        # Optional but recommended in production\n    }\n  }\n}\n\n# Provider Block\nprovider \"aws\" {\n  profile = \"default\"\n  region  = \"us-west-2\"\n}\n\n# Resource Block\n\nresource \"aws_vpc\" \"project1vpc\" {\n    cidr_block = \"192.168.0.0/24\"\n    tags = {\n        Name = \"FirstVPC\"\n    }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__02 - Command basics__Project1__Project1-solution__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__02 - Command basics__Project1__Project1-solution__vpc.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-series__02 - Command basics__Project1__Project1-solution__vpc.tf", "start_line": 21}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"mongodbatlas\" {\n  client_id     = var.atlas_client_id\n  client_secret = var.atlas_client_secret\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mongodb__terraform-provider-mongodbatlas__examples__mongodbatlas_api_key__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# terraform/main.tf\nterraform {\n  required_version = \">= 1.0\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.0\"\n    }\n    archive = {\n      source  = \"hashicorp/archive\"\n      version = \"~> 2.4\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = var.aws_region\n}\n\n# Variables\nvariable \"aws_region\" {\n  description = \"AWS region\"\n  type        = string\n  default     = \"us-east-1\"\n}\n\nvariable \"project_name\" {\n  description = \"Project name for resource naming\"\n  type        = string\n  default     = \"llm-app\"\n}\n\nvariable \"bedrock_model_id\" {\n  description = \"Bedrock model ID\"\n  type        = string\n}\n\nvariable \"rate_limit_per_hour\" {\n  description = \"Maximum requests per client per hour\"\n  type        = number\n  default     = 100\n}\n\nvariable \"cost_alert_threshold\" {\n  description = \"Cost alert threshold in USD\"\n  type        = number\n  default     = 50\n}\n\n# DynamoDB Table for Rate Limiting\nresource \"aws_dynamodb_table\" \"api_usage\" {\n  name         = \"${var.project_name}-api-usage\"\n  billing_mode = \"PAY_PER_REQUEST\"\n  hash_key     = \"client_id\"\n\n  attribute {\n    name = \"client_id\"\n    type = \"S\"\n  }\n\n  ttl {\n    attribute_name = \"ttl\"\n    enabled        = true\n  }\n\n  tags = {\n    Name        = \"${var.project_name}-api-usage\"\n    Environment = \"production\"\n  }\n\n  lifecycle {\n    prevent_destroy = false\n    ignore_changes  = [tags]\n  }\n}\n\n# IAM Role for Lambda\nresource \"aws_iam_role\" \"lambda_role\" {\n  name = \"${var.project_name}-lambda-role\"\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"lambda.amazonaws.com\"\n        }\n      }\n    ]\n  })\n\n  lifecycle {\n    prevent_destroy = false\n  }\n}\n\n# IAM Policy for Lambda\nresource \"aws_iam_role_policy\" \"lambda_policy\" {\n  name = \"${var.project_name}-lambda-policy\"\n  role = aws_iam_role.lambda_role.id\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"logs:CreateLogGroup\",\n          \"logs:CreateLogStream\",\n          \"logs:PutLogEvents\"\n        ]\n        Resource = \"arn:aws:logs:*:*:*\"\n      },\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"bedrock:InvokeModel\",\n          \"bedrock:InvokeModelWithResponseStream\"\n        ]\n        Resource = \"*\"\n      },\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"dynamodb:GetItem\",\n          \"dynamodb:PutItem\",\n          \"dynamodb:UpdateItem\"\n        ]\n        Resource = aws_dynamodb_table.api_usage.arn\n      }\n    ]\n  })\n}\n\n# Create Lambda deployment package\ndata \"archive_file\" \"lambda_zip\" {\n  type        = \"zip\"\n  source_dir  = \"${path.module}/lambda\"\n  output_path = \"${path.module}/lambda_function.zip\"\n}\n\n# Lambda Function with Response Streaming\nresource \"aws_lambda_function\" \"bedrock_proxy\" {\n  filename         = data.archive_file.lambda_zip.output_path\n  function_name    = \"${var.project_name}-bedrock-proxy\"\n  role             = aws_iam_role.lambda_role.arn\n  handler          = \"index.handler\"\n  source_code_hash = data.archive_file.lambda_zip.output_base64sha256\n  runtime          = \"nodejs20.x\"\n  timeout          = 300\n  memory_size      = 512\n\n  environment {\n    variables = {\n      BEDROCK_MODEL_ID    = var.bedrock_model_id\n      DYNAMODB_TABLE      = aws_dynamodb_table.api_usage.name\n      RATE_LIMIT_PER_HOUR = var.rate_limit_per_hour\n    }\n  }\n\n  tags = {\n    Name = \"${var.project_name}-bedrock-proxy\"\n  }\n}\n\n# Lambda Function URL for Streaming\nresource \"aws_lambda_function_url\" \"bedrock_proxy_url\" {\n  function_name      = aws_lambda_function.bedrock_proxy.function_name\n  authorization_type = \"NONE\"\n  invoke_mode        = \"RESPONSE_STREAM\"\n\n  cors {\n    allow_origins = [\"*\"]\n    allow_methods = [\"*\"]\n    allow_headers = [\"*\"]\n    max_age       = 86400\n  }\n}\n\n# Lambda Permission for Function URL\nresource \"aws_lambda_permission\" \"function_url\" {\n  statement_id           = \"AllowFunctionURLInvoke\"\n  action                 = \"lambda:InvokeFunctionUrl\"\n  function_name          = aws_lambda_function.bedrock_proxy.function_name\n  principal              = \"*\"\n  function_url_auth_type = \"NONE\"\n}\n\n# CloudWatch Log Group\nresource \"aws_cloudwatch_log_group\" \"lambda_logs\" {\n  name              = \"/aws/lambda/${aws_lambda_function.bedrock_proxy.function_name}\"\n  retention_in_days = 7\n\n  tags = {\n    Name = \"${var.project_name}-lambda-logs\"\n  }\n}\n\n# REST API Gateway with streaming support\nresource \"aws_api_gateway_rest_api\" \"api\" {\n  name        = \"${var.project_name}-rest-api\"\n  description = \"REST API with Lambda streaming\"\n}\n\nresource \"aws_api_gateway_resource\" \"chat\" {\n  rest_api_id = aws_api_gateway_rest_api.api.id\n  parent_id   = aws_api_gateway_rest_api.api.root_resource_id\n  path_part   = \"chat\"\n}\n\nresource \"aws_api_gateway_method\" \"post_chat\" {\n  rest_api_id   = aws_api_gateway_rest_api.api.id\n  resource_id   = aws_api_gateway_resource.chat.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n}\n\n# Create integration with streaming using AWS CLI\nresource \"null_resource\" \"lambda_integration\" {\n  triggers = {\n    method_id  = aws_api_gateway_method.post_chat.id\n    lambda_arn = aws_lambda_function.bedrock_proxy.arn\n  }\n\n  provisioner \"local-exec\" {\n    command = <<-EOT\n      aws apigateway put-integration \\\n        --rest-api-id ${aws_api_gateway_rest_api.api.id} \\\n        --resource-id ${aws_api_gateway_resource.chat.id} \\\n        --http-method POST \\\n        --type AWS_PROXY \\\n        --integration-http-method POST \\\n        --uri \"arn:aws:apigateway:${var.aws_region}:lambda:path/2021-11-15/functions/${aws_lambda_function.bedrock_proxy.arn}/response-streaming-invocations\" \\\n        --timeout-in-millis 300000 \\\n        --response-transfer-mode STREAM \\\n        --region ${var.aws_region}\n    EOT\n  }\n\n  provisioner \"local-exec\" {\n    when    = destroy\n    command = \"echo 'Integration will be deleted with API Gateway resource'\"\n  }\n\n  depends_on = [aws_api_gateway_method.post_chat]\n}\n\nresource \"aws_api_gateway_deployment\" \"deployment\" {\n  rest_api_id = aws_api_gateway_rest_api.api.id\n\n  triggers = {\n    redeployment = sha1(jsonencode([\n      aws_api_gateway_resource.chat.id,\n      aws_api_gateway_method.post_chat.id,\n      null_resource.lambda_integration.id,\n    ]))\n  }\n\n  lifecycle {\n    create_before_destroy = true\n  }\n\n  depends_on = [null_resource.lambda_integration]\n}\n\nresource \"aws_api_gateway_stage\" \"prod\" {\n  deployment_id = aws_api_gateway_deployment.deployment.id\n  rest_api_id   = aws_api_gateway_rest_api.api.id\n  stage_name    = \"prod\"\n}\n\nresource \"aws_api_gateway_method_settings\" \"streaming\" {\n  rest_api_id = aws_api_gateway_rest_api.api.id\n  stage_name  = aws_api_gateway_stage.prod.stage_name\n  method_path = \"chat/POST\"\n\n  settings {\n    throttling_burst_limit = 50\n    throttling_rate_limit  = 100\n  }\n}\n\n\n\nresource \"aws_lambda_permission\" \"api_gateway\" {\n  statement_id  = \"AllowAPIGatewayInvoke\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.bedrock_proxy.function_name\n  principal     = \"apigateway.amazonaws.com\"\n  source_arn    = \"${aws_api_gateway_rest_api.api.execution_arn}/*/*\"\n}\n\n# CloudWatch Alarm for Costs\nresource \"aws_cloudwatch_metric_alarm\" \"cost_alert\" {\n  alarm_name          = \"${var.project_name}-cost-alert\"\n  comparison_operator = \"GreaterThanThreshold\"\n  evaluation_periods  = 1\n  metric_name         = \"EstimatedCharges\"\n  namespace           = \"AWS/Billing\"\n  period              = 3600\n  statistic           = \"Maximum\"\n  threshold           = var.cost_alert_threshold\n  alarm_description   = \"Alert when estimated charges exceed threshold\"\n  treat_missing_data  = \"notBreaching\"\n\n  dimensions = {\n    Currency = \"USD\"\n  }\n}\n\n# CloudWatch Alarm for Lambda Errors\nresource \"aws_cloudwatch_metric_alarm\" \"lambda_errors\" {\n  alarm_name          = \"${var.project_name}-lambda-errors\"\n  comparison_operator = \"GreaterThanThreshold\"\n  evaluation_periods  = 1\n  metric_name         = \"Errors\"\n  namespace           = \"AWS/Lambda\"\n  period              = 300\n  statistic           = \"Sum\"\n  threshold           = 10\n  alarm_description   = \"Alert when Lambda errors exceed threshold\"\n\n  dimensions = {\n    FunctionName = aws_lambda_function.bedrock_proxy.function_name\n  }\n}\n\n# Outputs\noutput \"api_endpoint\" {\n  description = \"REST API Gateway endpoint URL\"\n  value       = \"${aws_api_gateway_stage.prod.invoke_url}/chat\"\n}\n\noutput \"function_url\" {\n  description = \"Lambda Function URL (direct streaming)\"\n  value       = aws_lambda_function_url.bedrock_proxy_url.function_url\n}\n\noutput \"api_id\" {\n  description = \"REST API Gateway ID\"\n  value       = aws_api_gateway_rest_api.api.id\n}\n\noutput \"lambda_function_name\" {\n  description = \"Lambda function name\"\n  value       = aws_lambda_function.bedrock_proxy.function_name\n}\n\noutput \"dynamodb_table_name\" {\n  description = \"DynamoDB table name\"\n  value       = aws_dynamodb_table.api_usage.name\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_28", "severity": "HIGH", "message": "Ensure DynamoDB point in time recovery (backup) is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 101}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 146}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 146}, {"tool": "checkov", "rule_id": "CKV_AWS_173", "severity": "HIGH", "message": "Check encryption settings for Lambda environmental variable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 146}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 146}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 146}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 146}, {"tool": "checkov", "rule_id": "CKV_AWS_258", "severity": "HIGH", "message": "Ensure that Lambda function URLs AuthType is not None", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 170}, {"tool": "checkov", "rule_id": "CKV_AWS_301", "severity": "HIGH", "message": "Ensure that AWS Lambda function is not publicly accessible", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 184}, {"tool": "checkov", "rule_id": "CKV_AWS_158", "severity": "HIGH", "message": "Ensure that CloudWatch Log Group is encrypted by KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 193}, {"tool": "checkov", "rule_id": "CKV_AWS_338", "severity": "HIGH", "message": "Ensure CloudWatch log groups retains logs for at least 1 year", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 193}, {"tool": "checkov", "rule_id": "CKV_AWS_237", "severity": "HIGH", "message": "Ensure Create before destroy for API Gateway", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 203}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 214}, {"tool": "checkov", "rule_id": "CKV_AWS_76", "severity": "HIGH", "message": "Ensure API Gateway has Access Logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 269}, {"tool": "checkov", "rule_id": "CKV_AWS_120", "severity": "HIGH", "message": "Ensure API Gateway caching is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 269}, {"tool": "checkov", "rule_id": "CKV_AWS_73", "severity": "HIGH", "message": "Ensure API Gateway has X-Ray Tracing enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 269}, {"tool": "checkov", "rule_id": "CKV_AWS_225", "severity": "HIGH", "message": "Ensure API Gateway method setting caching is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 275}, {"tool": "checkov", "rule_id": "CKV2_AWS_51", "severity": "CRITICAL", "message": "Ensure AWS API Gateway endpoints uses client certificate authentication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 269}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 214}, {"tool": "checkov", "rule_id": "CKV2_AWS_4", "severity": "CRITICAL", "message": "Ensure API Gateway stage have logging level defined as appropriate", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 269}, {"tool": "checkov", "rule_id": "CKV2_AWS_75", "severity": "CRITICAL", "message": "Ensure no open CORS policy", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 146}, {"tool": "checkov", "rule_id": "CKV2_AWS_29", "severity": "CRITICAL", "message": "Ensure public API gateway are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__ai-backend-terraform__main.tf", "start_line": 269}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"local\" {\n\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/patrickchugh__terravision__override.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// TERRAMATE: GENERATED AUTOMATICALLY DO NOT EDIT\n\nresource \"local_file\" \"ci\" {\n  content = <<-EOT\npackage ci // import \"github.com/terramate-io/terramate/ci\"\n\ntype PlatformType int\n    const PlatformLocal PlatformType = iota ...\n    func DetectPlatformFromEnv(repo *git.Repository) PlatformType\nEOT\n\n  filename = \"${path.module}/mock-ci.ignore\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terramate-io__terramate__ci___test_mock.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"4.52.0\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"3.4.3\"\n    }\n  }\n  required_version = \">= 1.1.0\"\n\n  cloud {\n    organization = \"REPLACE_ME\"\n\n    workspaces {\n      name = \"gh-actions-demo\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\nresource \"random_pet\" \"sg\" {}\n\ndata \"aws_ami\" \"ubuntu\" {\n  most_recent = true\n\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  owners = [\"099720109477\"] # Canonical\n}\n\nresource \"aws_instance\" \"web\" {\n  ami                    = data.aws_ami.ubuntu.id\n  instance_type          = \"t2.micro\"\n  vpc_security_group_ids = [aws_security_group.web-sg.id]\n\n  user_data = <<-EOF\n              #!/bin/bash\n              apt-get update\n              apt-get install -y apache2\n              sed -i -e 's/80/8080/' /etc/apache2/ports.conf\n              echo \"Hello World\" > /var/www/html/index.html\n              systemctl restart apache2\n              EOF\n}\n\nresource \"aws_security_group\" \"web-sg\" {\n  name = \"${random_pet.sg.id}-sg\"\n  ingress {\n    from_port   = 8080\n    to_port     = 8080\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  // connectivity to ubuntu mirrors is required to run `apt-get update` and `apt-get install apache2`\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\noutput \"web-address\" {\n  value = \"${aws_instance.web.public_dns}:8080\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-github-actions__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#1. Creating custom VPC #\nresource \"aws_vpc\" \"primary\" {\n  cidr_block = \"192.168.16.0/24\"\n  tags = {\n    Name = \"custom-vpc-technix\"\n  }\n}\n\n#2. Creating 3 subnets in custom VPC #\nresource \"aws_subnet\" \"main1\" {\n  vpc_id = aws_vpc.primary.id\n  availability_zone = \"ap-south-1a\"\n  cidr_block = \"192.168.16.0/26\"\n  tags = {\n    Name = \"prod-subnet(subnet1)\"\n  }\n}\n\nresource \"aws_subnet\" \"main2\" {\n  vpc_id = aws_vpc.primary.id\n  availability_zone = \"ap-south-1b\"\n  cidr_block = \"192.168.16.64/26\"\n  tags = {\n    Name = \"dev-subnet(subnet2)\"\n  }\n}\n\nresource \"aws_subnet\" \"main3\" {\n  vpc_id = aws_vpc.primary.id\n  availability_zone = \"ap-south-1c\"\n  cidr_block = \"192.168.16.128/26\"\n  tags = {\n    Name = \"dB-subnet(subnet3)\"\n  }\n}\n\n\n#3. Creating Internaet GW for Internet connectivity #\nresource \"aws_internet_gateway\" \"maingw1\" {\n  vpc_id = aws_vpc.primary.id\n  tags = {\n    Name = \"learningtechnix-VPC-IgW\"\n  }\n}\n\n#4. Creating Elastic IP to be attached with NAT gateway\nresource \"aws_eip\" \"e-ip-natgw\" {\n  vpc              = true\n}\n\n\n#5. Creating NATGW\nresource \"aws_nat_gateway\" \"learningtechnix-nat-gw\" {\n  allocation_id = aws_eip.e-ip-natgw.id\n  subnet_id     = aws_subnet.main1.id\n\n  tags = {\n    Name = \"ltn-natGw\"\n  }\n}\n\n\n#6. Creating Routing tables for each subnet # \nresource \"aws_route_table\" \"r\" {\n  vpc_id = aws_vpc.primary.id\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.maingw1.id\n  }\n  tags = {\n    Name = \"prod-subnet-RT\"\n  }\n}\n\nresource \"aws_route_table\" \"s\" {\n  vpc_id = aws_vpc.primary.id\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_nat_gateway.learningtechnix-nat-gw.id\n  }\n  tags = {\n    Name = \"dev-subnet-RT\"\n  }\n}\n\nresource \"aws_route_table\" \"t\" {\n  vpc_id = aws_vpc.primary.id\n  tags = {\n    Name = \"dB-subnet-RT\"\n  }\n}\n\n\n#7. Binding each routing table to appropriate subnet #\nresource \"aws_route_table_association\" \"a\" {\n  subnet_id      = aws_subnet.main1.id\n  route_table_id = aws_route_table.r.id\n}\n\nresource \"aws_route_table_association\" \"b\" {\n  subnet_id      = aws_subnet.main2.id\n  route_table_id = aws_route_table.s.id\n}\n\nresource \"aws_route_table_association\" \"c\" {\n  subnet_id      = aws_subnet.main3.id\n  route_table_id = aws_route_table.t.id\n}\n\n\n#8. Adding SG to be applied  \n\nresource \"aws_security_group\" \"r03hg16_allow_all\" {\n  name        = \"r03hg16_allow_all\"\n  description = \"Allow ALL inbound/outbound traffic\"\n  ingress {\n    description = \"SSH for VM\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  ingress {\n    description = \"Ping for VM\"\n    from_port   = -1\n    to_port     = -1\n    protocol    = \"1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  vpc_id      = aws_vpc.primary.id\n  tags = {\n    Name = \"custom-SG-allow_all\"\n  }\n}\n\nresource \"aws_security_group_rule\" \"example\" {\n  type              = \"egress\"\n  from_port         = 0\n  to_port           = 0\n  protocol          = \"-1\"\n  cidr_blocks = [\"0.0.0.0/0\"]\n  security_group_id = aws_security_group.r03hg16_allow_all.id\n}\n\n#9. Creating custom EC2\n\nresource \"aws_instance\" \"r100c86\" {\n  ami           = var.aws_instance_my_infra_ami\n  instance_type = \"t2.micro\"\n  key_name      = \"aws-exam-testing\"\n  availability_zone = \"ap-south-1a\"\n  subnet_id     = aws_subnet.main1.id\n  vpc_security_group_ids = [aws_security_group.r03hg16_allow_all.id]\n  associate_public_ip_address = \"true\"\n  tags = {\n    Name  = var.aws_instance_name\n  }\n}\n\nresource \"aws_instance\" \"r100c87\" {\n  ami           = var.aws_instance_my_infra_ami\n  instance_type = \"t2.micro\"\n  key_name      = \"aws-exam-testing\"\n  availability_zone = \"ap-south-1b\"\n  subnet_id     = aws_subnet.main2.id\n  vpc_security_group_ids = [aws_security_group.r03hg16_allow_all.id]\n  associate_public_ip_address = \"false\"\n  tags = {\n    Name  = var.aws_instance_name\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 113}, {"tool": "checkov", "rule_id": "CKV_AWS_277", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 113}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 136}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 136}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 147}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 147}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 147}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 147}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 147}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 160}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 160}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 160}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 160}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 147}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__vpc-network-creation__mynetwork.tf", "start_line": 160}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__2-code-suggestions__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"s3\" {\n  source = \"./modules/s3\"\n\n  # variables\n  aws = \"${ var.aws }\"\n  bucket = \"kz8s-pki-${ var.name }-${ var.aws[\"account-id\"] }-${ var.aws[\"region\"] }\"\n  name = \"${ var.name }\"\n}\n\nmodule \"vpc\" {\n  source = \"./modules/vpc\"\n  depends-id = \"\"\n\n  # variables\n  azs = \"${ var.aws[\"azs\"] }\"\n  cidr = \"${ var.cidr[\"vpc\"] }\"\n  hyperkube-tag = \"${ var.k8s[\"hyperkube-tag\"] }\"\n  name = \"${ var.name }\"\n  region = \"${ var.aws[\"region\"] }\"\n}\n\nmodule \"route53\" {\n  source = \"./modules/route53\"\n  depends-id = \"${ module.vpc.depends-id }\"\n\n  # variables\n  etcd-ips = \"${ var.etcd-ips }\"\n  internal-tld = \"${ var.internal-tld }\"\n  name = \"${ var.name }\"\n\n  # modules\n  vpc-id = \"${ module.vpc.id }\"\n}\n\nmodule \"pki\" {\n  source = \"./modules/pki\"\n  depends-id = \"${ module.vpc.depends-id }\"\n\n  # variables\n  ami-id = \"${ var.coreos-aws[\"ami\"] }\"\n  aws = \"${ var.aws }\"\n  cidr-vpc = \"${ var.cidr[\"vpc\"] }\"\n  instance-type = \"${ var.instance-type[\"pki\"] }\"\n  internal-tld = \"${ var.internal-tld }\"\n  ip = \"${ var.pki-ip }\"\n  k8s = \"${ var.k8s }\"\n  name = \"${ var.name }\"\n\n  # modules\n  instance-profile-name = \"${ module.iam.instance-profile-name-pki }\"\n  internal-zone-id = \"${ module.route53.internal-zone-id }\"\n  s3-bucket = \"${ module.s3.bucket }\"\n  s3-bucket-arn = \"${ module.s3.bucket-arn }\"\n  security-group-id = \"${ module.security.pki-id }\"\n  subnet-id = \"${ element( split(\",\", module.vpc.subnet-ids-private), 0 ) }\"\n  vpc-id = \"${ module.vpc.id }\"\n}\n\nmodule \"security\" {\n  source = \"./modules/security\"\n  depends-id = \"${ module.vpc.depends-id }\"\n\n  # variables\n  cidr-allow-ssh = \"${ var.cidr[\"allow-ssh\"] }\"\n  cidr-vpc = \"${ var.cidr[\"vpc\"] }\"\n  name = \"${ var.name }\"\n\n  # modules\n  vpc-id = \"${ module.vpc.id }\"\n}\n\nmodule \"iam\" {\n  source = \"./modules/iam\"\n  depends-id = \"${ module.pki.depends-id }\"\n\n  # variables\n  name = \"${ var.name }\"\n\n  # modules\n  s3-bucket-arn = \"${ module.s3.bucket-arn }\"\n}\n\nmodule \"bastion\" {\n  source = \"./modules/bastion\"\n  depends-id = \"${ module.vpc.depends-id }\"\n\n  # variables\n  ami-id = \"${ var.coreos-aws[\"ami\"] }\"\n  instance-type = \"${ var.instance-type[\"bastion\"] }\"\n  internal-tld = \"${ var.internal-tld }\"\n  key-name = \"${ var.aws[\"key-name\"] }\"\n  name = \"${ var.name }\"\n\n  # modules\n  instance-profile-name = \"${ module.iam.instance-profile-name-bastion }\"\n  s3-bucket = \"${ module.s3.bucket }\"\n  s3-bucket-arn = \"${ module.s3.bucket-arn }\"\n  security-group-id = \"${ module.security.bastion-id }\"\n  subnet-id = \"${ element( split(\",\", module.vpc.subnet-ids-public), 0 ) }\"\n  vpc-id = \"${ module.vpc.id }\"\n}\n\nmodule \"etcd\" {\n  source = \"./modules/etcd\"\n  depends-id = \"${ module.route53.depends-id }\"\n\n  # variables\n  ami-id = \"${ var.coreos-aws[\"ami\"] }\"\n  aws = \"${ var.aws }\"\n  cluster-domain = \"${ var.cluster-domain }\"\n  dns-service-ip = \"${ var.dns-service-ip }\"\n  etcd-ips = \"${ var.etcd-ips }\"\n  instance-type = \"${ var.instance-type[\"etcd\"] }\"\n  internal-tld = \"${ var.internal-tld }\"\n  ip-k8s-service = \"${ var.k8s-service-ip }\"\n  k8s = \"${ var.k8s }\"\n  name = \"${ var.name }\"\n  pod-ip-range = \"${ var.cidr[\"pods\"] }\"\n  service-cluster-ip-range = \"${ var.cidr[\"service-cluster\"] }\"\n\n  # modules\n  etcd-security-group-id = \"${ module.security.etcd-id }\"\n  external-elb-security-group-id = \"${ module.security.external-elb-id }\"\n  instance-profile-name = \"${ module.iam.instance-profile-name-master }\"\n  s3-bucket = \"${ module.s3.bucket }\"\n  subnet-id-private = \"${ element( split(\",\", module.vpc.subnet-ids-private), 0 ) }\"\n  subnet-id-public = \"${ element( split(\",\", module.vpc.subnet-ids-public), 0 ) }\"\n  vpc-id = \"${ module.vpc.id }\"\n}\n\nmodule \"worker\" {\n  source = \"./modules/worker\"\n  depends-id = \"${ module.route53.depends-id }\"\n\n  # variables\n  ami-id = \"${ var.coreos-aws[\"ami\"] }\"\n  aws = \"${ var.aws }\"\n  capacity = {\n    desired = 3\n    max = 5\n    min = 1\n  }\n  cluster-domain = \"${ var.cluster-domain }\"\n  dns-service-ip = \"${ var.dns-service-ip }\"\n  instance-type = \"${ var.instance-type[\"worker\"] }\"\n  internal-tld = \"${ var.internal-tld }\"\n  k8s = \"${ var.k8s }\"\n  name = \"${ var.name }\"\n  volume_size = {\n    ebs = 250\n    root = 52\n  }\n  worker-name = \"general\"\n\n  # modules\n  instance-profile-name = \"${ module.iam.instance-profile-name-worker }\"\n  s3-bucket = \"${ module.s3.bucket }\"\n  security-group-id = \"${ module.security.worker-id }\"\n  subnet-id = \"${ element( split(\",\", module.vpc.subnet-ids-private), 0 ) }\"\n  vpc-id = \"${ module.vpc.id }\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kz8s__tack__modules.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"azurerm\" {\n  features {}\n}\n\nresource \"random_id\" \"rg_name\" {\n  byte_length = 8\n}\n\nresource \"azurerm_resource_group\" \"test\" {\n  location = var.location\n  name     = \"testRG-${random_id.rg_name.hex}\"\n}\n\nmodule \"network\" {\n  source              = \"../../\"\n  resource_group_name = azurerm_resource_group.test.name\n  address_spaces      = [\"10.0.0.0/16\", \"10.2.0.0/16\"]\n  subnet_prefixes     = [\"10.0.1.0/24\", \"10.0.2.0/24\", \"10.0.3.0/24\"]\n  subnet_names        = [\"subnet1\", \"subnet2\", \"subnet3\"]\n\n  subnet_enforce_private_link_endpoint_network_policies = {\n    \"subnet1\" : true\n  }\n  subnet_delegation = {\n    subnet1 = [\n      {\n        name = \"delegation\"\n        service_delegation = {\n          name = \"Microsoft.ContainerInstance/containerGroups\"\n          actions = [\n            \"Microsoft.Network/virtualNetworks/subnets/action\",\n          ]\n        }\n      }\n    ]\n  }\n  subnet_service_endpoints = {\n    \"subnet1\" : [\"Microsoft.Sql\"]\n  }\n\n  tags = {\n    environment = \"dev\"\n    costcenter  = \"it\"\n  }\n  use_for_each = var.use_for_each\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform-azurerm-network__examples__startup__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"s3_bucket_id\" {\n  value       = module.tfstate_backend.s3_bucket_id\n  description = \"S3 bucket ID\"\n}\n\noutput \"s3_replication_role_arn\" {\n  value       = module.tfstate_backend.s3_replication_role_arn\n  description = \"The ARN of the IAM Role created for replication, if enabled.\"\n}\n\noutput \"dynamodb_table_name\" {\n  value       = module.tfstate_backend.dynamodb_table_name\n  description = \"DynamoDB table name\"\n}\n\noutput \"dynamodb_table_id\" {\n  value       = module.tfstate_backend.dynamodb_table_id\n  description = \"DynamoDB table ID\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__examples__complete__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \"~527> 1.0.0\"\n\n  required_providers {\n    aws        = \">325= 2.52.0\"\n    kubernetes = \">32= 1.11.1\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/warrensbox__terraform-switcher__test-data__skip-integration-tests__test_versiontf_error__version.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"vultr_seattle\" {\n  description = \"Vultr Seattle Region\"\n  default = \"sea\"\n}\n\nvariable \"docker_centos\" {\n  description = \"Docker on CentOS 7\"\n  default = 17\n}\n\nvariable \"one_cpu_two_gb_ram\" {\n  description = \"2048 MB RAM,25 GB SSD,1.00 TB BW\"\n  default = \"vc2-1c-2gb\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vultr__terraform-provider-vultr__example__variable.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"cloudflare_account_api_token_permission_groups_list\" \"example_account_api_token_permission_groups_list\" {\n  account_id = \"023e105f4ecef8ad9ca31a8372d0c353\"\n  name = \"Account%20Settings%20Write\"\n  scope = \"com.cloudflare.api.account.zone\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudflare__terraform-provider-cloudflare__examples__data-sources__cloudflare_account_api_token_permission_groups_list__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"azurerm\" {\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-databricks-examples__cicd-pipelines__manual-approve-with-azure-devops__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# https://cloud.google.com/compute/docs/load-balancing/http/content-based-example\n\nprovider \"google\" {\n  region      = var.region\n  project     = var.project_name\n  credentials = file(var.credentials_file_path)\n  zone        = var.region_zone\n}\n\nresource \"google_compute_instance\" \"www\" {\n  name         = \"tf-www-compute\"\n  machine_type = \"f1-micro\"\n  tags         = [\"http-tag\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"projects/debian-cloud/global/images/family/debian-8\"\n    }\n  }\n\n  network_interface {\n    network = \"default\"\n\n    access_config {\n      // Ephemeral IP\n    }\n  }\n\n  metadata_startup_script = file(\"scripts/install-www.sh\")\n\n  service_account {\n    scopes = [\"https://www.googleapis.com/auth/compute.readonly\"]\n  }\n}\n\nresource \"google_compute_instance\" \"www-video\" {\n  name         = \"tf-www-video-compute\"\n  machine_type = \"f1-micro\"\n  tags         = [\"http-tag\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"projects/debian-cloud/global/images/family/debian-8\"\n    }\n  }\n\n  network_interface {\n    network = \"default\"\n\n    access_config {\n      // Ephemeral IP\n    }\n  }\n\n  metadata_startup_script = file(\"scripts/install-video.sh\")\n\n  service_account {\n    scopes = [\"https://www.googleapis.com/auth/compute.readonly\"]\n  }\n}\n\nresource \"google_compute_global_address\" \"external-address\" {\n  name = \"tf-external-address\"\n}\n\nresource \"google_compute_instance_group\" \"www-resources\" {\n  name = \"tf-www-resources\"\n\n  instances = [google_compute_instance.www.self_link]\n\n  named_port {\n    name = \"http\"\n    port = \"80\"\n  }\n}\n\nresource \"google_compute_instance_group\" \"video-resources\" {\n  name = \"tf-video-resources\"\n\n  instances = [google_compute_instance.www-video.self_link]\n\n  named_port {\n    name = \"http\"\n    port = \"80\"\n  }\n}\n\nresource \"google_compute_health_check\" \"health-check\" {\n  name = \"tf-health-check\"\n\n  http_health_check {\n  }\n}\n\nresource \"google_compute_backend_service\" \"www-service\" {\n  name     = \"tf-www-service\"\n  protocol = \"HTTP\"\n\n  backend {\n    group = google_compute_instance_group.www-resources.self_link\n  }\n\n  health_checks = [google_compute_health_check.health-check.self_link]\n}\n\nresource \"google_compute_backend_service\" \"video-service\" {\n  name     = \"tf-video-service\"\n  protocol = \"HTTP\"\n\n  backend {\n    group = google_compute_instance_group.video-resources.self_link\n  }\n\n  health_checks = [google_compute_health_check.health-check.self_link]\n}\n\nresource \"google_compute_url_map\" \"web-map\" {\n  name            = \"tf-web-map\"\n  default_service = google_compute_backend_service.www-service.self_link\n\n  host_rule {\n    hosts        = [\"*\"]\n    path_matcher = \"tf-allpaths\"\n  }\n\n  path_matcher {\n    name            = \"tf-allpaths\"\n    default_service = google_compute_backend_service.www-service.self_link\n\n    path_rule {\n      paths   = [\"/video\", \"/video/*\"]\n      service = google_compute_backend_service.video-service.self_link\n    }\n  }\n}\n\nresource \"google_compute_target_http_proxy\" \"http-lb-proxy\" {\n  name    = \"tf-http-lb-proxy\"\n  url_map = google_compute_url_map.web-map.self_link\n}\n\nresource \"google_compute_global_forwarding_rule\" \"default\" {\n  name       = \"tf-http-content-gfr\"\n  target     = google_compute_target_http_proxy.http-lb-proxy.self_link\n  ip_address = google_compute_global_address.external-address.address\n  port_range = \"80\"\n}\n\nresource \"google_compute_firewall\" \"default\" {\n  name    = \"tf-www-firewall-allow-internal-only\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"80\"]\n  }\n\n  source_ranges = [\"130.211.0.0/22\", \"35.191.0.0/16\"]\n  target_tags   = [\"http-tag\"]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__content-based-load-balancing__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__content-based-load-balancing__main.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__content-based-load-balancing__main.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_GCP_30", "severity": "HIGH", "message": "Ensure that instances are not configured to use the default service account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__content-based-load-balancing__main.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__content-based-load-balancing__main.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__content-based-load-balancing__main.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__content-based-load-balancing__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__content-based-load-balancing__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_30", "severity": "HIGH", "message": "Ensure that instances are not configured to use the default service account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__content-based-load-balancing__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__content-based-load-balancing__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-google-beta__examples__content-based-load-balancing__main.tf", "start_line": 36}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"vpn_ip\" {\n  default = \"116.50.30.50/32\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/zealvora__terraform-beginner-to-advanced-resource__Section 2 - Read, Generate, Modify Congiruations__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// Create Resource Group\nresource \"azurerm_resource_group\" \"rg_network\" {\n  name                = \"${var.rg_network}\"\n  location            = \"${var.location}\"\n}\n// Create Network\nmodule \"create_network\" {\n  source                    = \"./modules/1-network\"\n  location                  = \"${azurerm_resource_group.rg_network.location}\"\n  rg_network                = \"${azurerm_resource_group.rg_network.name}\"\n}\n// Get Keyvault Data\ndata \"azurerm_resource_group\" \"rg_keyvault\" {\n  name                = \"${var.rg_keyvault}\"\n}\ndata \"azurerm_key_vault\" \"keyvault\" {\n  name                = \"${var.keyvault_name}\"\n  resource_group_name = \"${data.azurerm_resource_group.rg_keyvault.name}\"\n}\ndata \"azurerm_key_vault_secret\" \"secret_Default-Admin-Windows-Linux-VM\" {\n  name      = \"Default-Admin-Windows-Linux-VM\"\n  vault_uri = \"${data.azurerm_key_vault.keyvault.vault_uri}\"\n}\n// Create Windows VM\nmodule \"windows_vm\" {\n  source                    = \"./modules/2-windows_vm\"\n  computer_name_Windows     = \"${var.computer_name_Windows}\"\n  rg_network                = \"${azurerm_resource_group.rg_network.name}\"\n  subnet_id                 = \"${module.create_network.mgmt_sub_id}\"\n  location                  = \"${azurerm_resource_group.rg_network.location}\"\n  vmsize                    = \"${var.vmsize}\"\n  os_ms                     = \"${var.os_ms}\"\n  admin_username            = \"${var.admin_username}\"\n  admin_password            = \"${data.azurerm_key_vault_secret.secret_Default-Admin-Windows-Linux-VM.value}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Flodu31__Terraform__Deploy_New_Environment_Keyvault__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region                   = \"eu-central-1\"\n  shared_credentials_files = [\"/Users/rahulwagh/.aws/credentials\"]\n}\n\nresource \"aws_iam_role\" \"lambda_role\" {\n name   = \"terraform_aws_lambda_role\"\n assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n\n# IAM policy for logging from a lambda\n\nresource \"aws_iam_policy\" \"iam_policy_for_lambda\" {\n\n  name         = \"aws_iam_policy_for_terraform_aws_lambda_role\"\n  path         = \"/\"\n  description  = \"AWS IAM Policy for managing aws lambda role\"\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:*\",\n      \"Effect\": \"Allow\"\n    }\n  ]\n}\nEOF\n}\n\n# Policy Attachment on the role.\n\nresource \"aws_iam_role_policy_attachment\" \"attach_iam_policy_to_iam_role\" {\n  role        = aws_iam_role.lambda_role.name\n  policy_arn  = aws_iam_policy.iam_policy_for_lambda.arn\n}\n\n# Generates an archive from content, a file, or a directory of files.\n\ndata \"archive_file\" \"zip_the_python_code\" {\n type        = \"zip\"\n source_dir  = \"${path.module}/python/\"\n output_path = \"${path.module}/python/hello-python.zip\"\n}\n\n# Create a lambda function\n# In terraform ${path.module} is the current directory.\nresource \"aws_lambda_function\" \"terraform_lambda_func\" {\n filename                       = \"${path.module}/python/hello-python.zip\"\n function_name                  = \"Jhooq-Lambda-Function\"\n role                           = aws_iam_role.lambda_role.arn\n handler                        = \"hello-python.lambda_handler\"\n runtime                        = \"python3.8\"\n depends_on                     = [aws_iam_role_policy_attachment.attach_iam_policy_to_iam_role]\n}\n\n\noutput \"teraform_aws_role_output\" {\n value = aws_iam_role.lambda_role.name\n}\n\noutput \"teraform_aws_role_arn_output\" {\n value = aws_iam_role.lambda_role.arn\n}\n\noutput \"teraform_logging_arn_output\" {\n value = aws_iam_policy.iam_policy_for_lambda.arn\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__aws-lambda__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__aws-lambda__main.tf", "start_line": 67}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__aws-lambda__main.tf", "start_line": 67}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__aws-lambda__main.tf", "start_line": 67}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__aws-lambda__main.tf", "start_line": 67}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__aws-lambda__main.tf", "start_line": 67}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Terraform script to deploy AHA Solution\n# 1.0 - Initial version \n\n# Variables defined below, you can overwrite them using tfvars or imput variables\n\ndata \"aws_caller_identity\" \"current\" {}\n\nprovider \"aws\" {\n    region  = var.aha_primary_region\n    default_tags {\n      tags = \"${var.default_tags}\"\n    }\n}\n\n# Secondary region - provider config\nlocals {\n    secondary_region = \"${var.aha_secondary_region == \"\" ? var.aha_primary_region : var.aha_secondary_region}\"\n}\n\nprovider \"aws\" {\n    alias   = \"secondary_region\"\n    region  = local.secondary_region\n    default_tags {\n      tags = \"${var.default_tags}\"\n    }\n}\n\n# Comment below - if needed to use s3_bucket, s3_key for consistency with cf \nlocals {\n    source_files = [\"${path.module}/../../handler.py\", \"${path.module}/../../messagegenerator.py\"]\n}\ndata \"archive_file\" \"lambda_zip\" {\n    type          = \"zip\"\n    output_path   = \"${path.module}/lambda_function.zip\"\n    source {\n      filename = \"${basename(local.source_files[0])}\"\n      content  = file(\"${local.source_files[0]}\")\n    }\n    source {\n      filename = \"${basename(local.source_files[1])}\"\n      content  = file(\"${local.source_files[1]}\")\n  }\n}\n\nvariable \"aha_primary_region\" {\n    description = \"Primary region where AHA solution will be deployed\"\n    type        = string\n    default     = \"us-east-1\"\n}\n\nvariable \"aha_secondary_region\" {\n    description = \"Secondary region where AHA solution will be deployed\"\n    type        = string\n    default     = \"\"\n}\n\nvariable \"default_tags\" {\n    description = \"Tags used for the AWS resources created by this template\"\n    type        = map\n    default     = {\n      Application      = \"AHA-Solution\"\n    }\n}\n\nvariable \"dynamodbtable\" {\n    type    = string\n    default = \"AHA-DynamoDBTable\"\n}\n\nvariable \"AWSOrganizationsEnabled\" {\n    type = string\n    default = \"No\"\n    description = \"You can receive both PHD and SHD alerts if you're using AWS Organizations. \\n If you are, make sure to enable Organizational Health View: \\n (https://docs.aws.amazon.com/health/latest/ug/aggregate-events.html) to \\n aggregate all PHD events in your AWS Organization. If not, you can still \\n get SHD alerts.\"\n    validation {\n      condition = (\n        var.AWSOrganizationsEnabled == \"Yes\" || var.AWSOrganizationsEnabled == \"No\"\n      )\n      error_message = \"AWSOrganizationsEnabled variable can only accept Yes or No as values.\"\n    }\n}\n\nvariable \"ManagementAccountRoleArn\" {\n    type    = string\n    default = \"\"\n    description = \"Arn of the IAM role in the top-level management account for collecting PHD Events. 'None' if deploying into the top-level management account.\"\n}\n\nvariable \"AWSHealthEventType\" {\n    type = string\n    default = \"issue | accountNotification | scheduledChange\"\n    description = \"Select the event type that you want AHA to report on. Refer to \\n https://docs.aws.amazon.com/health/latest/APIReference/API_EventType.html for more information on EventType.\"\n    validation {\n      condition = (\n        var.AWSHealthEventType == \"issue | accountNotification | scheduledChange\" || var.AWSHealthEventType == \"issue\"\n      )\n      error_message = \"AWSHealthEventType variable can only accept issue | accountNotification | scheduledChange or issue as values.\"\n    }\n}\n\n#variable \"S3Bucket\" {\n#    type = string\n#    description = \"Name of your S3 Bucket where the AHA Package .zip resides. Just the name of the bucket (e.g. my-s3-bucket)\"\n#    validation {\n#      condition     = length(var.S3Bucket) > 0\n#      error_message = \"The S3Bucket cannot be empty.\"\n#    }\n#}\n#\n#variable \"S3Key\" {\n#    type = string\n#    description = \"Name of the .zip in your S3 Bucket. Just the name of the file (e.g. aha-v1.0.zip)\"\n#    validation {\n#      condition     = length(var.S3Key) > 0\n#      error_message = \"The S3Key cannot be empty.\"\n#    }\n#}\n\nvariable \"EventBusName\" {\n    type    = string\n    default = \"\"\n    description = \"This is to ingest alerts into AWS EventBridge. Enter the event bus name if you wish to send the alerts to the AWS EventBridge. Note: By ingesting you wish to send the alerts to the AWS EventBridge. Note: By ingesting these alerts to AWS EventBridge, you can integrate with 35 SaaS vendors such as DataDog/NewRelic/PagerDuty. If you don't prefer to use EventBridge, leave the default (None).\"\n}\n\nvariable \"SlackWebhookURL\" {\n    type    = string\n    default = \"\"\n    description = \"Enter the Slack Webhook URL. If you don't prefer to use Slack, leave the default (empty).\"\n}\n\nvariable \"MicrosoftTeamsWebhookURL\" {\n    type    = string\n    default = \"\"\n    description = \"Enter Microsoft Teams Webhook URL. If you don't prefer to use MS Teams, leave the default (empty).\"\n}\n\nvariable \"AmazonChimeWebhookURL\" {\n    type    = string\n    default = \"\"\n    description = \"Enter the Chime Webhook URL, If you don't prefer to use Amazon Chime, leave the default (empty).\"\n}\n\nvariable \"Regions\" {\n    type = string\n    default = \"all regions\"\n    description = \"By default, AHA reports events affecting all AWS regions. \\n If you want to report on certain regions you can enter up to 10 in a comma separated format. \\n Available Regions: us-east-1,us-east-2,us-west-1,us-west-2,af-south-1,ap-east-1,ap-south-1,ap-northeast-3, \\n ap-northeast-2,ap-southeast-1,ap-southeast-2,ap-northeast-1,ca-central-1,eu-central-1,eu-west-1,eu-west-2, \\n eu-south-1,eu-south-3,eu-north-1,me-south-1,sa-east-1,global\"\n}\n\nvariable \"EventSearchBack\" {\n    type = number\n    default = \"1\"\n    description = \"How far back to search for events in hours. Default is 1 hour\"\n}\n\nvariable \"FromEmail\" {\n    type = string\n    default = \"none@domain.com\"\n    description = \"Enter FROM Email Address\"\n}\n\nvariable \"ToEmail\" {\n    type = string\n    default = \"none@domain.com\"\n    description = \"Enter email addresses separated by commas (for ex: abc@amazon.com, bcd@amazon.com)\"\n}\n\nvariable \"Subject\" {\n    type = string\n    default = \"AWS Health Alert\"\n    description = \"Enter the subject of the email address\"\n}\n\n#variable \"S3Bucket\" {\n#    type = string\n#    description = \"Name of your S3 Bucket where the AHA Package .zip resides. Just the name of the bucket (e.g. my-s3-bucket)\"\n#    default = \"\"\n#}\n\nvariable \"ExcludeAccountIDs\" {\n    type = string\n    default = \"\"\n    description = \"If you would like to EXCLUDE any accounts from alerting, enter a .csv filename created with comma-seperated account numbers. Sample AccountIDs file name: aha_account_ids.csv. If not, leave the default empty.\"\n}\n\n##### Resources for AHA Solution created below.\n\n# Random id generator\nresource \"random_string\" \"resource_code\" {\n  length  = 8\n  special = false\n  upper   = false\n}\n\n# S3 buckets creation\nresource \"aws_s3_bucket\" \"AHA-S3Bucket-PrimaryRegion\" {\n    count      = \"${var.ExcludeAccountIDs != \"\" ? 1 : 0}\"\n    bucket     = \"aha-bucket-${var.aha_primary_region}-${random_string.resource_code.result}\"\n    tags = {\n      Name        = \"aha-bucket\"\n    }\n}\n\nresource \"aws_s3_bucket_acl\" \"AHA-S3Bucket-PrimaryRegion\" {\n    count  = var.ExcludeAccountIDs != \"\" ? 1 : 0\n    bucket = aws_s3_bucket.AHA-S3Bucket-PrimaryRegion[0].id\n    acl    = \"private\"\n}\n\nresource \"aws_s3_bucket\" \"AHA-S3Bucket-SecondaryRegion\" {\n    count      = \"${var.aha_secondary_region != \"\" && var.ExcludeAccountIDs != \"\" ? 1 : 0}\"\n    provider   = aws.secondary_region\n    bucket     = \"aha-bucket-${var.aha_secondary_region}-${random_string.resource_code.result}\"\n    tags = {\n      Name        = \"aha-bucket\"\n    }\n}\n\nresource \"aws_s3_bucket_acl\" \"AHA-S3Bucket-SecondaryRegion\" {\n    count  = \"${var.aha_secondary_region != \"\" && var.ExcludeAccountIDs != \"\" ? 1 : 0}\"\n    provider   = aws.secondary_region\n    bucket = aws_s3_bucket.AHA-S3Bucket-SecondaryRegion[0].id\n    acl    = \"private\"\n}\n\nresource \"aws_s3_object\" \"AHA-S3Object-PrimaryRegion\" {\n    count      = \"${var.ExcludeAccountIDs != \"\" ? 1 : 0}\"\n    key        = var.ExcludeAccountIDs\n    bucket     = aws_s3_bucket.AHA-S3Bucket-PrimaryRegion[0].bucket\n    source     = var.ExcludeAccountIDs\n    tags = {\n      Name        = \"${var.ExcludeAccountIDs}\"\n    }\n}\n\nresource \"aws_s3_object\" \"AHA-S3Object-SecondaryRegion\" {\n    count      = \"${var.aha_secondary_region != \"\" && var.ExcludeAccountIDs != \"\" ? 1 : 0}\"\n    provider   = aws.secondary_region\n    key        = var.ExcludeAccountIDs\n    bucket     = aws_s3_bucket.AHA-S3Bucket-SecondaryRegion[0].bucket\n    source     = var.ExcludeAccountIDs\n    tags = {\n      Name        = \"${var.ExcludeAccountIDs}\"\n    }\n}\n\n# DynamoDB table - Create if secondary region not set\nresource \"aws_dynamodb_table\" \"AHA-DynamoDBTable\" {\n    count = \"${var.aha_secondary_region == \"\" ? 1 : 0}\"\n    billing_mode   = \"PROVISIONED\"\n    hash_key       = \"arn\"\n    name           = \"${var.dynamodbtable}-${random_string.resource_code.result}\"\n    read_capacity  = 5\n    write_capacity = 5\n    stream_enabled = false\n    tags           = {\n       Name   = \"${var.dynamodbtable}\"\n    }\n\n    attribute {\n        name = \"arn\"\n        type = \"S\"\n    }\n\n    point_in_time_recovery {\n        enabled = false\n    }\n\n    timeouts {}\n\n    ttl {\n        attribute_name = \"ttl\"\n        enabled        = true\n    }\n}\n\n# DynamoDB table - Multi region Global Table - Create if secondary region is set\nresource \"aws_dynamodb_table\" \"AHA-GlobalDynamoDBTable\" {\n    count = \"${var.aha_secondary_region == \"\" ? 0 : 1}\"\n    billing_mode     = \"PAY_PER_REQUEST\"\n    hash_key         = \"arn\"\n    name             = \"${var.dynamodbtable}-${random_string.resource_code.result}\"\n    stream_enabled   = true\n    stream_view_type = \"NEW_AND_OLD_IMAGES\"\n    tags           = {\n       Name   = \"${var.dynamodbtable}\"\n    }\n\n    attribute {\n        name = \"arn\"\n        type = \"S\"\n    }\n\n    point_in_time_recovery {\n        enabled = false\n    }\n\n    replica {\n        region_name = var.aha_secondary_region\n    }\n\n    timeouts {}\n\n    ttl {\n        attribute_name = \"ttl\"\n        enabled        = true\n    }\n}\n# Tags for DynamoDB - secondary region\nresource \"aws_dynamodb_tag\" \"AHA-GlobalDynamoDBTable\" {\n    count = \"${var.aha_secondary_region == \"\" ? 0 : 1}\"\n    provider   = aws.secondary_region\n    resource_arn = replace(aws_dynamodb_table.AHA-GlobalDynamoDBTable[count.index].arn, var.aha_primary_region, var.aha_secondary_region)\n    key          = \"Name\"\n    value        = \"${var.dynamodbtable}\"\n}\n# Tags for DynamoDB - secondary region - default_tags\nresource \"aws_dynamodb_tag\" \"AHA-GlobalDynamoDBTable-Additional-tags\" {\n    for_each = { for key, value in var.default_tags : key => value if var.aha_secondary_region != \"\" }\n    provider   = aws.secondary_region\n    resource_arn = replace(aws_dynamodb_table.AHA-GlobalDynamoDBTable[0].arn, var.aha_primary_region, var.aha_secondary_region)\n    key          = each.key\n    value        = each.value\n}\n\n# Secrets - SlackChannelSecret\nresource \"aws_secretsmanager_secret\" \"SlackChannelID\" {\n    count = \"${var.SlackWebhookURL == \"\" ? 0 : 1}\"\n    name             = \"SlackChannelID\"\n    description      = \"Slack Channel ID Secret\"\n    recovery_window_in_days      = 0\n    tags             = {\n        \"HealthCheckSlack\" = \"ChannelID\"\n    }\n    dynamic \"replica\" {\n      for_each = var.aha_secondary_region == \"\" ? [] : [1]\n      content {\n        region = var.aha_secondary_region\n      }\n    }\n}\nresource \"aws_secretsmanager_secret_version\" \"SlackChannelID\" {\n    count = \"${var.SlackWebhookURL == \"\" ? 0 : 1}\"\n    secret_id     = \"${aws_secretsmanager_secret.SlackChannelID.*.id[count.index]}\"\n    secret_string = \"${var.SlackWebhookURL}\"\n}\n\n# Secrets - MicrosoftChannelSecret\nresource \"aws_secretsmanager_secret\" \"MicrosoftChannelID\" {\n    count = \"${var.MicrosoftTeamsWebhookURL == \"\" ? 0 : 1}\"\n    name             = \"MicrosoftChannelID\"\n    description      = \"Microsoft Channel ID Secret\"\n    recovery_window_in_days      = 0\n    tags             = {\n        \"HealthCheckMicrosoft\" = \"ChannelID\"\n        \"Name\"                 = \"AHA-MicrosoftChannelID\"\n    }\n    dynamic \"replica\" {\n      for_each = var.aha_secondary_region == \"\" ? [] : [1]\n      content {\n        region = var.aha_secondary_region\n      }\n    }\n}\nresource \"aws_secretsmanager_secret_version\" \"MicrosoftChannelID\" {\n    count = \"${var.MicrosoftTeamsWebhookURL == \"\" ? 0 : 1}\"\n    secret_id     = \"${aws_secretsmanager_secret.MicrosoftChannelID.*.id[count.index]}\"\n    secret_string = \"${var.MicrosoftTeamsWebhookURL}\"\n}\n\n# Secrets - EventBusNameSecret\nresource \"aws_secretsmanager_secret\" \"EventBusName\" {\n    count = \"${var.EventBusName == \"\" ? 0 : 1}\"\n    name             = \"EventBusName\"\n    description      = \"EventBus Name Secret\"\n    recovery_window_in_days      = 0\n    tags             = {\n        \"EventBusName\" = \"ChannelID\"\n        \"Name\"         = \"AHA-EventBusName\"\n    }\n    dynamic \"replica\" {\n      for_each = var.aha_secondary_region == \"\" ? [] : [1]\n      content {\n        region = var.aha_secondary_region\n      }\n    }\n}\n\nresource \"aws_secretsmanager_secret_version\" \"EventBusName\" {\n    count = \"${var.EventBusName == \"\" ? 0 : 1}\"\n    secret_id     = \"${aws_secretsmanager_secret.EventBusName.*.id[count.index]}\"\n    secret_string = \"${var.EventBusName}\"\n}\n\n# Secrets - ChimeChannelSecret\nresource \"aws_secretsmanager_secret\" \"ChimeChannelID\" {\n    count = \"${var.AmazonChimeWebhookURL == \"\" ? 0 : 1}\"\n    name             = \"ChimeChannelID\"\n    description      = \"Chime Channel ID Secret\"\n    recovery_window_in_days      = 0\n    tags             = {\n        \"HealthCheckChime\" = \"ChannelID\"\n        \"Name\"             = \"AHA-ChimeChannelID-${random_string.resource_code.result}\"\n    }\n    dynamic \"replica\" {\n      for_each = var.aha_secondary_region == \"\" ? [] : [1]\n      content {\n        region = var.aha_secondary_region\n      }\n    }\n}\nresource \"aws_secretsmanager_secret_version\" \"ChimeChannelID\" {\n    count = \"${var.AmazonChimeWebhookURL == \"\" ? 0 : 1}\"\n    secret_id     = \"${aws_secretsmanager_secret.ChimeChannelID.*.id[count.index]}\"\n    secret_string = \"${var.AmazonChimeWebhookURL}\"\n}\n\n# Secrets - AssumeRoleSecret\nresource \"aws_secretsmanager_secret\" \"AssumeRoleArn\" {\n    count = \"${var.ManagementAccountRoleArn == \"\" ? 0 : 1}\"\n    name             = \"AssumeRoleArn\"\n    description      = \"Management account role for AHA to assume\"\n    recovery_window_in_days      = 0\n    tags             = {\n        \"AssumeRoleArn\" = \"\"\n        \"Name\"          = \"AHA-AssumeRoleArn\"\n    }\n    dynamic \"replica\" {\n      for_each = var.aha_secondary_region == \"\" ? [] : [1]\n      content {\n        region = var.aha_secondary_region\n      }\n    }\n}\nresource \"aws_secretsmanager_secret_version\" \"AssumeRoleArn\" {\n    count = \"${var.ManagementAccountRoleArn == \"\" ? 0 : 1}\"\n    secret_id     = \"${aws_secretsmanager_secret.AssumeRoleArn.*.id[count.index]}\"\n    secret_string = \"${var.ManagementAccountRoleArn}\"\n}\n\n# IAM Role for Lambda function execution\nresource \"aws_iam_role\" \"AHA-LambdaExecutionRole\" {\n    name                  = \"AHA-LambdaExecutionRole-${random_string.resource_code.result}\"\n    path                  = \"/\"\n    assume_role_policy    = jsonencode(\n        {\n            Version   = \"2012-10-17\"\n            Statement = [\n                {\n                    Action    = \"sts:AssumeRole\"\n                    Effect    = \"Allow\"\n                    Principal = {\n                        Service = \"lambda.amazonaws.com\"\n                    }\n                },\n            ]\n        }\n    )\n    inline_policy {\n        name   = \"AHA-LambdaPolicy\"\n        policy = data.aws_iam_policy_document.AHA-LambdaPolicy-Document.json\n    }\n    tags             = {\n        \"Name\"             = \"AHA-LambdaExecutionRole\"\n    }\n}\n\ndata \"aws_iam_policy_document\" \"AHA-LambdaPolicy-Document\" {\n  version   = \"2012-10-17\"\n  statement {\n    effect = \"Allow\"\n    actions = [\n          \"logs:CreateLogGroup\",\n          \"logs:CreateLogStream\",\n          \"logs:PutLogEvents\",\n    ]\n    resources = [\n          \"arn:aws:logs:${var.aha_primary_region}:${data.aws_caller_identity.current.account_id}:*\",\n          \"arn:aws:logs:${local.secondary_region}:${data.aws_caller_identity.current.account_id}:*\"\n    ]\n  }\n  statement {\n    effect   = \"Allow\"\n    actions   = [\n          \"health:DescribeAffectedAccountsForOrganization\",\n          \"health:DescribeAffectedEntitiesForOrganization\",\n          \"health:DescribeEventDetailsForOrganization\",\n          \"health:DescribeEventsForOrganization\",\n          \"health:DescribeEventDetails\",\n          \"health:DescribeEvents\",\n          \"health:DescribeEventTypes\",\n          \"health:DescribeAffectedEntities\",\n          \"organizations:ListAccounts\",\n          \"organizations:DescribeAccount\",\n    ]\n    resources = [ \"*\" ]\n  }\n  statement {\n    effect   = \"Allow\"\n    actions   = [\n          \"dynamodb:ListTables\",\n    ]\n    resources = [\n          \"arn:aws:dynamodb:${var.aha_primary_region}:${data.aws_caller_identity.current.account_id}:*\",\n          \"arn:aws:dynamodb:${local.secondary_region}:${data.aws_caller_identity.current.account_id}:*\",\n    ]\n  }\n  statement {\n    effect   = \"Allow\"\n    actions   = [\n          \"ses:SendEmail\",\n    ]\n    resources = [\n          \"arn:aws:ses:${var.aha_primary_region}:${data.aws_caller_identity.current.account_id}:*\",\n          \"arn:aws:ses:${local.secondary_region}:${data.aws_caller_identity.current.account_id}:*\",\n    ]\n  }\n  statement {\n    effect   = \"Allow\"\n    actions   = [\n          \"dynamodb:UpdateTimeToLive\",\n          \"dynamodb:PutItem\",\n          \"dynamodb:DeleteItem\",\n          \"dynamodb:GetItem\",\n          \"dynamodb:Scan\",\n          \"dynamodb:Query\",\n          \"dynamodb:UpdateItem\",\n          \"dynamodb:UpdateTable\",\n          \"dynamodb:GetRecords\",\n    ]\n    resources = [\n          #aws_dynamodb_table.AHA-DynamoDBTable.arn\n          \"arn:aws:dynamodb:${var.aha_primary_region}:${data.aws_caller_identity.current.account_id}:table/${var.dynamodbtable}-${random_string.resource_code.result}\",\n          \"arn:aws:dynamodb:${local.secondary_region}:${data.aws_caller_identity.current.account_id}:table/${var.dynamodbtable}-${random_string.resource_code.result}\",\n    ]\n  }\n  dynamic \"statement\" {\n    for_each = var.SlackWebhookURL == \"\" ? [] : [1]\n    content {\n      effect = \"Allow\"\n      actions = [\n          \"secretsmanager:GetResourcePolicy\",\n          \"secretsmanager:DescribeSecret\",\n          \"secretsmanager:ListSecretVersionIds\",\n          \"secretsmanager:GetSecretValue\",\n      ]\n      resources = [\n          aws_secretsmanager_secret.SlackChannelID[0].arn,\n          \"arn:aws:secretsmanager:${local.secondary_region}:${data.aws_caller_identity.current.account_id}:secret:${element(split(\":\", aws_secretsmanager_secret.SlackChannelID[0].arn),6)}\"\n#          var.aha_secondary_region != \"\" ? \"arn:aws:secretsmanager:${var.aha_secondary_region}:${data.aws_caller_identity.current.account_id}:secret:${element(split(\":\", aws_secretsmanager_secret.SlackChannelID[0].arn),6)}\" : null\n      ]\n    }\n  }\n  dynamic \"statement\" {\n    for_each = var.MicrosoftTeamsWebhookURL == \"\" ? [] : [1]\n    content {\n      effect = \"Allow\"\n      actions = [\n          \"secretsmanager:GetResourcePolicy\",\n          \"secretsmanager:DescribeSecret\",\n          \"secretsmanager:ListSecretVersionIds\",\n          \"secretsmanager:GetSecretValue\",\n      ]\n      resources = [\n          aws_secretsmanager_secret.MicrosoftChannelID[0].arn,\n          \"arn:aws:secretsmanager:${local.secondary_region}:${data.aws_caller_identity.current.account_id}:secret:${element(split(\":\", aws_secretsmanager_secret.MicrosoftChannelID[0].arn),6)}\"\n      ]\n    }\n  }\n  dynamic \"statement\" {\n    for_each = var.AmazonChimeWebhookURL == \"\" ? [] : [1]\n    content {\n      effect = \"Allow\"\n      actions = [\n          \"secretsmanager:GetResourcePolicy\",\n          \"secretsmanager:DescribeSecret\",\n          \"secretsmanager:ListSecretVersionIds\",\n          \"secretsmanager:GetSecretValue\",\n      ]\n      resources = [\n          aws_secretsmanager_secret.ChimeChannelID[0].arn,\n          \"arn:aws:secretsmanager:${local.secondary_region}:${data.aws_caller_identity.current.account_id}:secret:${element(split(\":\", aws_secretsmanager_secret.ChimeChannelID[0].arn),6)}\"\n      ]\n    }\n  }\n  dynamic \"statement\" {\n    for_each = var.EventBusName == \"\" ? [] : [1]\n    content {\n      effect = \"Allow\"\n      actions = [\n          \"secretsmanager:GetResourcePolicy\",\n          \"secretsmanager:DescribeSecret\",\n          \"secretsmanager:ListSecretVersionIds\",\n          \"secretsmanager:GetSecretValue\",\n      ]\n      resources = [\n          aws_secretsmanager_secret.EventBusName[0].arn,\n          \"arn:aws:secretsmanager:${local.secondary_region}:${data.aws_caller_identity.current.account_id}:secret:${element(split(\":\", aws_secretsmanager_secret.EventBusName[0].arn),6)}\"\n      ]\n    }\n  }\n  dynamic \"statement\" {\n    for_each = var.ManagementAccountRoleArn == \"\" ? [] : [1]\n    content {\n      effect = \"Allow\"\n      actions = [\n          \"secretsmanager:GetResourcePolicy\",\n          \"secretsmanager:DescribeSecret\",\n          \"secretsmanager:ListSecretVersionIds\",\n          \"secretsmanager:GetSecretValue\",\n      ]\n      resources = [\n          aws_secretsmanager_secret.AssumeRoleArn[0].arn,\n          \"arn:aws:secretsmanager:${local.secondary_region}:${data.aws_caller_identity.current.account_id}:secret:${element(split(\":\", aws_secretsmanager_secret.AssumeRoleArn[0].arn),6)}\"\n      ]\n    }\n  }\n  dynamic \"statement\" {\n    for_each = var.EventBusName == \"\" ? [] : [1]\n    content {\n      effect = \"Allow\"\n      actions = [\n          \"events:PutEvents\",\n      ]\n      resources = [\n          \"arn:aws:events:${var.aha_primary_region}:${data.aws_caller_identity.current.account_id}:event-bus/${var.EventBusName}\",\n          \"arn:aws:events:${local.secondary_region}:${data.aws_caller_identity.current.account_id}:event-bus/${var.EventBusName}\"\n      ]\n    }\n  }\n  dynamic \"statement\" {\n    for_each = var.ManagementAccountRoleArn == \"\" ? [] : [1]\n    content {\n      effect = \"Allow\"\n      actions = [\n          \"sts:AssumeRole\",\n      ]\n      resources = [\n          \"${var.ManagementAccountRoleArn}\",\n      ]\n    }\n  }\n  dynamic \"statement\" {\n    for_each = var.ExcludeAccountIDs == \"\" ? [] : [1]\n    content {\n      effect = \"Allow\"\n      actions = [\n          \"s3:GetObject\",\n      ]\n      resources = [\n          \"arn:aws:s3:::aha-bucket-${var.aha_primary_region}-${random_string.resource_code.result}/${var.ExcludeAccountIDs}\",\n          \"arn:aws:s3:::aha-bucket-${local.secondary_region}-${random_string.resource_code.result}/${var.ExcludeAccountIDs}\",\n      ]\n    }\n  }\n}\n# aws_lambda_function - AHA-LambdaFunction - Primary region\nresource \"aws_lambda_function\" \"AHA-LambdaFunction-PrimaryRegion\" {\n    description                    = \"Lambda function that runs AHA\"\n    function_name                  = \"AHA-LambdaFunction-${random_string.resource_code.result}\"\n    handler                        = \"handler.main\"\n    memory_size                    = 128\n    timeout                        = 600\n    filename                       = data.archive_file.lambda_zip.output_path\n    source_code_hash               = data.archive_file.lambda_zip.output_base64sha256\n#    s3_bucket                      = var.S3Bucket\n#    s3_key                         = var.S3Key\n    reserved_concurrent_executions = -1\n    role                           = aws_iam_role.AHA-LambdaExecutionRole.arn\n    runtime                        = \"python3.11\"\n\n    environment {\n        variables = {\n            \"Slack\"               = var.SlackWebhookURL != \"\" ? \"True\" : null\n            \"Team\"                = var.MicrosoftTeamsWebhookURL != \"\" ? \"True\" : null\n            \"Chime\"               = var.AmazonChimeWebhookURL != \"\" ? \"True\" : null\n            \"Eventbridge\"         = var.EventBusName != \"\" ? \"True\" : null\n            \"DYNAMODB_TABLE\"      = \"${var.dynamodbtable}-${random_string.resource_code.result}\"\n            \"EMAIL_SUBJECT\"       = var.Subject\n            \"EVENT_SEARCH_BACK\"   = var.EventSearchBack\n            \"FROM_EMAIL\"          = var.FromEmail\n            \"HEALTH_EVENT_TYPE\"   = var.AWSHealthEventType\n            \"ORG_STATUS\"          = var.AWSOrganizationsEnabled\n            \"REGIONS\"             = var.Regions\n            \"TO_EMAIL\"            = var.ToEmail\n            \"MANAGEMENT_ROLE_ARN\" = var.ManagementAccountRoleArn == \"\" ? \"None\" : var.ManagementAccountRoleArn\n            \"ACCOUNT_IDS\"         = var.ExcludeAccountIDs\n            \"S3_BUCKET\"           = join(\"\",aws_s3_bucket.AHA-S3Bucket-PrimaryRegion[*].bucket)\n        }\n    }\n\n    timeouts {}\n\n    tracing_config {\n        mode = \"PassThrough\"\n    }\n    tags             = {   \n        \"Name\"             = \"AHA-LambdaFunction\"\n    }\n    depends_on = [\n      aws_dynamodb_table.AHA-DynamoDBTable,\n      aws_dynamodb_table.AHA-GlobalDynamoDBTable,\n    ]\n}\n\n# aws_lambda_function - AHA-LambdaFunction - Secondary region\nresource \"aws_lambda_function\" \"AHA-LambdaFunction-SecondaryRegion\" {\n    count                          = \"${var.aha_secondary_region == \"\" ? 0 : 1}\"\n    provider                       = aws.secondary_region\n    description                    = \"Lambda function that runs AHA\"\n    function_name                  = \"AHA-LambdaFunction-${random_string.resource_code.result}\"\n    handler                        = \"handler.main\"\n    memory_size                    = 128\n    timeout                        = 600\n    filename                       = data.archive_file.lambda_zip.output_path\n    source_code_hash               = data.archive_file.lambda_zip.output_base64sha256\n#    s3_bucket                      = var.S3Bucket\n#    s3_key                         = var.S3Key\n    reserved_concurrent_executions = -1\n    role                           = aws_iam_role.AHA-LambdaExecutionRole.arn\n    runtime                        = \"python3.11\"\n\n    environment {\n        variables = {\n            \"Slack\"               = var.SlackWebhookURL != \"\" ? \"True\" : null\n            \"Team\"                = var.MicrosoftTeamsWebhookURL != \"\" ? \"True\" : null\n            \"Chime\"               = var.AmazonChimeWebhookURL != \"\" ? \"True\" : null\n            \"Eventbridge\"         = var.EventBusName != \"\" ? \"True\" : null\n            \"DYNAMODB_TABLE\"      = \"${var.dynamodbtable}-${random_string.resource_code.result}\"\n            \"EMAIL_SUBJECT\"       = var.Subject\n            \"EVENT_SEARCH_BACK\"   = var.EventSearchBack\n            \"FROM_EMAIL\"          = var.FromEmail\n            \"HEALTH_EVENT_TYPE\"   = var.AWSHealthEventType\n            \"ORG_STATUS\"          = var.AWSOrganizationsEnabled\n            \"REGIONS\"             = var.Regions\n            \"TO_EMAIL\"            = var.ToEmail\n            \"MANAGEMENT_ROLE_ARN\" = var.ManagementAccountRoleArn\n            \"ACCOUNT_IDS\"         = var.ExcludeAccountIDs\n            \"S3_BUCKET\"           = join(\"\",aws_s3_bucket.AHA-S3Bucket-SecondaryRegion[*].bucket)\n        }\n    }\n\n    timeouts {}\n\n    tracing_config {\n        mode = \"PassThrough\"\n    }\n    tags             = {\n        \"Name\"             = \"AHA-LambdaFunction\"\n    }\n    depends_on = [\n      aws_dynamodb_table.AHA-DynamoDBTable,\n      aws_dynamodb_table.AHA-GlobalDynamoDBTable,\n    ]\n}\n\n# EventBridge - Schedule to run lambda\nresource \"aws_cloudwatch_event_rule\" \"AHA-LambdaSchedule-PrimaryRegion\" {\n    description         = \"Lambda trigger Event\"\n    event_bus_name      = \"default\"\n    state               = \"ENABLED\"\n    name                = \"AHA-LambdaSchedule-${random_string.resource_code.result}\"\n    schedule_expression = \"rate(1 minute)\"\n    tags             = {\n        \"Name\"             = \"AHA-LambdaSchedule\"\n    }\n}\nresource \"aws_cloudwatch_event_rule\" \"AHA-LambdaSchedule-SecondaryRegion\" {\n    description         = \"Lambda trigger Event\"\n    count               = \"${var.aha_secondary_region == \"\" ? 0 : 1}\"\n    provider            = aws.secondary_region    \n    event_bus_name      = \"default\"\n    state               = \"ENABLED\"\n    name                = \"AHA-LambdaSchedule-${random_string.resource_code.result}\"\n    schedule_expression = \"rate(1 minute)\"\n    tags             = {\n        \"Name\"             = \"AHA-LambdaSchedule\"\n    }\n}\n\nresource \"aws_cloudwatch_event_target\" \"AHA-LambdaFunction-PrimaryRegion\" {\n    arn            = aws_lambda_function.AHA-LambdaFunction-PrimaryRegion.arn\n    rule           = aws_cloudwatch_event_rule.AHA-LambdaSchedule-PrimaryRegion.name\n}\nresource \"aws_cloudwatch_event_target\" \"AHA-LambdaFunction-SecondaryRegion\" {\n    count          = \"${var.aha_secondary_region == \"\" ? 0 : 1}\"\n    provider       = aws.secondary_region    \n    arn            = aws_lambda_function.AHA-LambdaFunction-SecondaryRegion[0].arn\n    rule           = aws_cloudwatch_event_rule.AHA-LambdaSchedule-SecondaryRegion[0].name\n}\n\nresource \"aws_lambda_permission\" \"AHA-LambdaSchedulePermission-PrimaryRegion\" {\n    action        = \"lambda:InvokeFunction\"\n    principal     = \"events.amazonaws.com\"\n    function_name = aws_lambda_function.AHA-LambdaFunction-PrimaryRegion.arn\n    source_arn    = aws_cloudwatch_event_rule.AHA-LambdaSchedule-PrimaryRegion.arn\n}\nresource \"aws_lambda_permission\" \"AHA-LambdaSchedulePermission-SecondaryRegion\" {\n    count         = \"${var.aha_secondary_region == \"\" ? 0 : 1}\"\n    provider      = aws.secondary_region    \n    action        = \"lambda:InvokeFunction\"\n    principal     = \"events.amazonaws.com\"\n    function_name = aws_lambda_function.AHA-LambdaFunction-SecondaryRegion[0].arn\n    source_arn    = aws_cloudwatch_event_rule.AHA-LambdaSchedule-SecondaryRegion[0].arn\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_356", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 466}, {"tool": "checkov", "rule_id": "CKV_AWS_28", "severity": "HIGH", "message": "Ensure DynamoDB point in time recovery (backup) is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 246}, {"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 246}, {"tool": "checkov", "rule_id": "CKV_AWS_28", "severity": "HIGH", "message": "Ensure DynamoDB point in time recovery (backup) is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 276}, {"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 276}, {"tool": "checkov", "rule_id": "CKV_AWS_149", "severity": "HIGH", "message": "Ensure that Secrets Manager secret is encrypted using KMS CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 325}, {"tool": "checkov", "rule_id": "CKV_AWS_149", "severity": "HIGH", "message": "Ensure that Secrets Manager secret is encrypted using KMS CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 347}, {"tool": "checkov", "rule_id": "CKV_AWS_149", "severity": "HIGH", "message": "Ensure that Secrets Manager secret is encrypted using KMS CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 370}, {"tool": "checkov", "rule_id": "CKV_AWS_149", "severity": "HIGH", "message": "Ensure that Secrets Manager secret is encrypted using KMS CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 394}, {"tool": "checkov", "rule_id": "CKV_AWS_149", "severity": "HIGH", "message": "Ensure that Secrets Manager secret is encrypted using KMS CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 417}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 656}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 656}, {"tool": "checkov", "rule_id": "CKV_AWS_173", "severity": "HIGH", "message": "Check encryption settings for Lambda environmental variable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 656}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 656}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 705}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 705}, {"tool": "checkov", "rule_id": "CKV_AWS_173", "severity": "HIGH", "message": "Check encryption settings for Lambda environmental variable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 705}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 705}, {"tool": "checkov", "rule_id": "CKV2_AWS_16", "severity": "CRITICAL", "message": "Ensure that Auto Scaling is enabled on your DynamoDB tables", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 246}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 194}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 194}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 194}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV2_AWS_57", "severity": "CRITICAL", "message": "Ensure Secrets Manager secrets should have automatic rotation enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 325}, {"tool": "checkov", "rule_id": "CKV2_AWS_57", "severity": "CRITICAL", "message": "Ensure Secrets Manager secrets should have automatic rotation enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 347}, {"tool": "checkov", "rule_id": "CKV2_AWS_57", "severity": "CRITICAL", "message": "Ensure Secrets Manager secrets should have automatic rotation enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 370}, {"tool": "checkov", "rule_id": "CKV2_AWS_57", "severity": "CRITICAL", "message": "Ensure Secrets Manager secrets should have automatic rotation enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 394}, {"tool": "checkov", "rule_id": "CKV2_AWS_57", "severity": "CRITICAL", "message": "Ensure Secrets Manager secrets should have automatic rotation enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 417}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 194}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 194}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 194}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 194}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_DEPLOY_AHA__Terraform_DEPLOY_AHA.tf", "start_line": 208}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# We will define \n# 1. Terraform Settings Block\n# 1. Required Version Terraform\n# 2. Required Terraform Providers\n# 3. Terraform Remote State Storage with Azure Storage Account (last step of this section)\n# 2. Terraform Provider Block for AzureRM\n# 3. Terraform Resource Block: Define a Random Pet Resource\n\n# 1. Terraform Settings Block\nterraform {\n  # 1. Required Version Terraform\n  required_version = \">= 0.13\"\n  # 2. Required Terraform Providers  \n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"~> 2.0\"\n    }\n    azuread = {\n      source  = \"hashicorp/azuread\"\n      version = \"~> 1.0\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"~> 3.0\"\n    }\n  }\n\n# Terraform State Storage to Azure Storage Container\n  backend \"azurerm\" {\n    resource_group_name   = \"terraform-storage-rg\"\n    storage_account_name  = \"terraformstatexlrwdrzs\"\n    container_name        = \"tfstatefiles\"\n    key                   = \"terraform.tfstate\"\n  }  \n}\n\n\n# 2. Terraform Provider Block for AzureRM\nprovider \"azurerm\" {\n  features {\n\n  }\n}\n\n# 3. Terraform Resource Block: Define a Random Pet Resource\nresource \"random_pet\" \"aksrandom\" {\n\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__azure-aks-kubernetes-masterclass__24-Azure-AKS-Terraform__24-02-Terraform-Language-Basics__OLD-BACKUP__v1-old-terraform-manifests-aks__01-main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\nCopyright 2023 The Kubernetes Authors.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n/*\nThis file contains:\n- configuration for IAM Access Analyzer at the organization level\n*/\n\nresource \"aws_accessanalyzer_analyzer\" \"default\" {\n  provider = aws.audit\n\n  analyzer_name = \"organization-zone-trust-${data.aws_region.current.name}\"\n  type          = \"ORGANIZATION\"\n\n  tags = merge({\n    env       = \"Audit\",\n    component = \"Security\",\n    service   = \"IAM Access Analyzer\"\n  }, var.tags)\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubernetes__k8s.io__infra__aws__terraform__audit-account__access_analyzer.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nresource \"aws_api_gateway_rest_api\" \"example\" {\n  body = jsonencode({\n    openapi = \"3.0.1\"\n    info = {\n      title   = var.rest_api_name\n      version = \"1.0\"\n    }\n    paths = {\n      (var.rest_api_path) = {\n        get = {\n          x-amazon-apigateway-integration = {\n            httpMethod           = \"GET\"\n            payloadFormatVersion = \"1.0\"\n            type                 = \"HTTP_PROXY\"\n            uri                  = \"https://ip-ranges.amazonaws.com/ip-ranges.json\"\n          }\n        }\n      }\n    }\n  })\n\n  name = var.rest_api_name\n\n  endpoint_configuration {\n    types = [\"REGIONAL\"]\n  }\n}\n\nresource \"aws_api_gateway_deployment\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n\n  triggers = {\n    redeployment = sha1(jsonencode(aws_api_gateway_rest_api.example.body))\n  }\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-aws__examples__api-gateway-rest-api-openapi__rest-api.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_237", "severity": "HIGH", "message": "Ensure Create before destroy for API Gateway", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-aws__examples__api-gateway-rest-api-openapi__rest-api.tf", "start_line": 4}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#----------------------------------------------------------\n# My Terraform\n#\n# Find Latest AMI id of:\n#    - Ubuntu 18.04\n#    - Amazon Linux 2\n#    - Windows Server 2016 Base\n#\n# Made by Denis Astahov\n#-----------------------------------------------------------\n\n\nprovider \"aws\" {\n  region = \"ap-southeast-2\"\n}\n\ndata \"aws_ami\" \"latest_ubuntu\" {\n  owners      = [\"099720109477\"]\n  most_recent = true\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-bionic-18.04-amd64-server-*\"]\n  }\n}\n\n\ndata \"aws_ami\" \"latest_amazon_linux\" {\n  owners      = [\"amazon\"]\n  most_recent = true\n  filter {\n    name   = \"name\"\n    values = [\"amzn2-ami-hvm-*-x86_64-gp2\"]\n  }\n}\n\n\ndata \"aws_ami\" \"latest_windows_2016\" {\n  owners      = [\"amazon\"]\n  most_recent = true\n  filter {\n    name   = \"name\"\n    values = [\"Windows_Server-2016-English-Full-Base-*\"]\n  }\n\n}\n\n// How to use\n/*\nresource \"aws_instance\" \"my_webserver_with_latest_ubuntu_ami\" {\n  ami           = data.aws_ami.latest_ubuntu.id\n  instance_type = \"t3.micro\"\n}\n*/\n\n\noutput \"latest_windows_2016_ami_id\" {\n  value = data.aws_ami.latest_windows_2016.id\n}\n\noutput \"latest_windows_2016_ami_name\" {\n  value = data.aws_ami.latest_windows_2016.name\n}\n\n\noutput \"latest_amazon_linux_ami_id\" {\n  value = data.aws_ami.latest_amazon_linux.id\n}\n\noutput \"latest_amazon_linux_ami_name\" {\n  value = data.aws_ami.latest_amazon_linux.name\n}\n\n\noutput \"latest_ubuntu_ami_id\" {\n  value = data.aws_ami.latest_ubuntu.id\n}\n\noutput \"latest_ubuntu_ami_name\" {\n  value = data.aws_ami.latest_ubuntu.name\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-10__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"wrapper\" {\n  source = \"../\"\n\n  for_each = var.items\n\n  auto_groups = try(each.value.auto_groups, var.defaults.auto_groups, {\n    activemq = {\n      ingress_rules     = [\"activemq-5671-tcp\", \"activemq-8883-tcp\", \"activemq-61614-tcp\", \"activemq-61617-tcp\", \"activemq-61619-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    alertmanager = {\n      ingress_rules     = [\"alertmanager-9093-tcp\", \"alertmanager-9094-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    carbon-relay-ng = {\n      ingress_rules     = [\"carbon-line-in-tcp\", \"carbon-line-in-udp\", \"carbon-pickle-tcp\", \"carbon-pickle-udp\", \"carbon-gui-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    cassandra = {\n      ingress_rules     = [\"cassandra-clients-tcp\", \"cassandra-thrift-clients-tcp\", \"cassandra-jmx-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    consul = {\n      ingress_rules     = [\"consul-tcp\", \"consul-grpc-tcp\", \"consul-grpc-tcp-tls\", \"consul-webui-http-tcp\", \"consul-webui-https-tcp\", \"consul-dns-tcp\", \"consul-dns-udp\", \"consul-serf-lan-tcp\", \"consul-serf-lan-udp\", \"consul-serf-wan-tcp\", \"consul-serf-wan-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    dax-cluster = {\n      ingress_rules     = [\"dax-cluster-unencrypted-tcp\", \"dax-cluster-encrypted-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    docker-swarm = {\n      ingress_rules     = [\"docker-swarm-mngmt-tcp\", \"docker-swarm-node-tcp\", \"docker-swarm-node-udp\", \"docker-swarm-overlay-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    etcd = {\n      ingress_rules     = [\"etcd-client-tcp\", \"etcd-peer-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    elasticsearch = {\n      ingress_rules     = [\"elasticsearch-rest-tcp\", \"elasticsearch-java-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    grafana = {\n      ingress_rules     = [\"grafana-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    graphite-statsd = {\n      ingress_rules     = [\"graphite-webui\", \"graphite-2003-tcp\", \"graphite-2004-tcp\", \"graphite-2023-tcp\", \"graphite-2024-tcp\", \"graphite-8080-tcp\", \"graphite-8125-tcp\", \"graphite-8125-udp\", \"graphite-8126-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    http-80 = {\n      ingress_rules     = [\"http-80-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    http-8080 = {\n      ingress_rules     = [\"http-8080-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    https-443 = {\n      ingress_rules     = [\"https-443-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    https-8443 = {\n      ingress_rules     = [\"https-8443-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ipsec-500 = {\n      ingress_rules     = [\"ipsec-500-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ipsec-4500 = {\n      ingress_rules     = [\"ipsec-4500-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    kafka = {\n      ingress_rules     = [\"kafka-broker-tcp\", \"kafka-broker-tls-tcp\", \"kafka-broker-tls-public-tcp\", \"kafka-broker-sasl-scram-tcp\", \"kafka-broker-sasl-scram-tcp\", \"kafka-broker-sasl-iam-tcp\", \"kafka-broker-sasl-iam-public-tcp\", \"kafka-jmx-exporter-tcp\", \"kafka-node-exporter-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    kubernetes-api = {\n      ingress_rules     = [\"kubernetes-api-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    kibana = {\n      ingress_rules     = [\"kibana-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ldap = {\n      ingress_rules     = [\"ldap-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ldaps = {\n      ingress_rules     = [\"ldaps-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    logstash = {\n      ingress_rules     = [\"logstash-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    loki = {\n      ingress_rules     = [\"loki-grafana\", \"loki-grafana-grpc\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    memcached = {\n      ingress_rules     = [\"memcached-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    minio = {\n      ingress_rules     = [\"minio-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    mongodb = {\n      ingress_rules     = [\"mongodb-27017-tcp\", \"mongodb-27018-tcp\", \"mongodb-27019-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    mysql = {\n      ingress_rules     = [\"mysql-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    mssql = {\n      ingress_rules     = [\"mssql-tcp\", \"mssql-udp\", \"mssql-analytics-tcp\", \"mssql-broker-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    nfs = {\n      ingress_rules     = [\"nfs-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    nomad = {\n      ingress_rules     = [\"nomad-http-tcp\", \"nomad-rpc-tcp\", \"nomad-serf-tcp\", \"nomad-serf-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    openvpn = {\n      ingress_rules     = [\"openvpn-udp\", \"openvpn-tcp\", \"openvpn-https-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    postgresql = {\n      ingress_rules     = [\"postgresql-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    oracle-db = {\n      ingress_rules     = [\"oracle-db-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ntp = {\n      ingress_rules     = [\"ntp-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    puppet = {\n      ingress_rules     = [\"puppet-tcp\", \"puppetdb-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    prometheus = {\n      ingress_rules     = [\"prometheus-http-tcp\", \"prometheus-pushgateway-http-tcp\", \"prometheus-node-exporter-http-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    promtail = {\n      ingress_rules     = [\"promtail-http\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    rabbitmq = {\n      ingress_rules     = [\"rabbitmq-4369-tcp\", \"rabbitmq-5671-tcp\", \"rabbitmq-5672-tcp\", \"rabbitmq-15672-tcp\", \"rabbitmq-25672-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    rdp = {\n      ingress_rules     = [\"rdp-tcp\", \"rdp-udp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    redis = {\n      ingress_rules     = [\"redis-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    redshift = {\n      ingress_rules     = [\"redshift-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    smtp = {\n      ingress_rules     = [\"smtp-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    smtp-submission = {\n      ingress_rules     = [\"smtp-submission-587-tcp\", \"smtp-submission-2587-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    smtps = {\n      ingress_rules     = [\"smtps-465-tcp\", \"smtps-2465-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    solr = {\n      ingress_rules     = [\"solr-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    splunk = {\n      ingress_rules     = [\"splunk-indexer-tcp\", \"splunk-web-tcp\", \"splunk-splunkd-tcp\", \"splunk-hec-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    squid = {\n      ingress_rules     = [\"squid-proxy-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    ssh = {\n      ingress_rules     = [\"ssh-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    storm = {\n      ingress_rules     = [\"storm-nimbus-tcp\", \"storm-ui-tcp\", \"storm-supervisor-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    vault = {\n      ingress_rules     = [\"vault-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    wazuh = {\n      ingress_rules     = [\"wazuh-server-agent-connection-tcp\", \"wazuh-server-agent-connection-udp\", \"wazuh-server-agent-enrollment\", \"wazuh-server-agent-cluster-daemon\", \"wazuh-server-syslog-collector-tcp\", \"wazuh-server-syslog-collector-udp\", \"wazuh-server-restful-api\", \"wazuh-indexer-restful-api\", \"wazuh-dashboard\", ]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    web = {\n      ingress_rules     = [\"http-80-tcp\", \"http-8080-tcp\", \"https-443-tcp\", \"web-jmx-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    winrm = {\n      ingress_rules     = [\"winrm-http-tcp\", \"winrm-https-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    zabbix = {\n      ingress_rules     = [\"zabbix-server\", \"zabbix-proxy\", \"zabbix-agent\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    zipkin = {\n      ingress_rules     = [\"zipkin-admin-tcp\", \"zipkin-admin-query-tcp\", \"zipkin-admin-web-tcp\", \"zipkin-query-tcp\", \"zipkin-web-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n    zookeeper = {\n      ingress_rules     = [\"zookeeper-2181-tcp\", \"zookeeper-2182-tls-tcp\", \"zookeeper-2888-tcp\", \"zookeeper-3888-tcp\", \"zookeeper-jmx-tcp\"]\n      ingress_with_self = [\"all-all\"]\n      egress_rules      = [\"all-all\"]\n    }\n  })\n  computed_egress_rules                                    = try(each.value.computed_egress_rules, var.defaults.computed_egress_rules, [])\n  computed_egress_with_cidr_blocks                         = try(each.value.computed_egress_with_cidr_blocks, var.defaults.computed_egress_with_cidr_blocks, [])\n  computed_egress_with_ipv6_cidr_blocks                    = try(each.value.computed_egress_with_ipv6_cidr_blocks, var.defaults.computed_egress_with_ipv6_cidr_blocks, [])\n  computed_egress_with_prefix_list_ids                     = try(each.value.computed_egress_with_prefix_list_ids, var.defaults.computed_egress_with_prefix_list_ids, [])\n  computed_egress_with_self                                = try(each.value.computed_egress_with_self, var.defaults.computed_egress_with_self, [])\n  computed_egress_with_source_security_group_id            = try(each.value.computed_egress_with_source_security_group_id, var.defaults.computed_egress_with_source_security_group_id, [])\n  computed_ingress_rules                                   = try(each.value.computed_ingress_rules, var.defaults.computed_ingress_rules, [])\n  computed_ingress_with_cidr_blocks                        = try(each.value.computed_ingress_with_cidr_blocks, var.defaults.computed_ingress_with_cidr_blocks, [])\n  computed_ingress_with_ipv6_cidr_blocks                   = try(each.value.computed_ingress_with_ipv6_cidr_blocks, var.defaults.computed_ingress_with_ipv6_cidr_blocks, [])\n  computed_ingress_with_prefix_list_ids                    = try(each.value.computed_ingress_with_prefix_list_ids, var.defaults.computed_ingress_with_prefix_list_ids, [])\n  computed_ingress_with_self                               = try(each.value.computed_ingress_with_self, var.defaults.computed_ingress_with_self, [])\n  computed_ingress_with_source_security_group_id           = try(each.value.computed_ingress_with_source_security_group_id, var.defaults.computed_ingress_with_source_security_group_id, [])\n  create                                                   = try(each.value.create, var.defaults.create, true)\n  create_sg                                                = try(each.value.create_sg, var.defaults.create_sg, true)\n  create_timeout                                           = try(each.value.create_timeout, var.defaults.create_timeout, \"10m\")\n  delete_timeout                                           = try(each.value.delete_timeout, var.defaults.delete_timeout, \"15m\")\n  description                                              = try(each.value.description, var.defaults.description, \"Security Group managed by Terraform\")\n  egress_cidr_blocks                                       = try(each.value.egress_cidr_blocks, var.defaults.egress_cidr_blocks, [\"0.0.0.0/0\"])\n  egress_ipv6_cidr_blocks                                  = try(each.value.egress_ipv6_cidr_blocks, var.defaults.egress_ipv6_cidr_blocks, [\"::/0\"])\n  egress_prefix_list_ids                                   = try(each.value.egress_prefix_list_ids, var.defaults.egress_prefix_list_ids, [])\n  egress_rules                                             = try(each.value.egress_rules, var.defaults.egress_rules, [])\n  egress_with_cidr_blocks                                  = try(each.value.egress_with_cidr_blocks, var.defaults.egress_with_cidr_blocks, [])\n  egress_with_ipv6_cidr_blocks                             = try(each.value.egress_with_ipv6_cidr_blocks, var.defaults.egress_with_ipv6_cidr_blocks, [])\n  egress_with_prefix_list_ids                              = try(each.value.egress_with_prefix_list_ids, var.defaults.egress_with_prefix_list_ids, [])\n  egress_with_self                                         = try(each.value.egress_with_self, var.defaults.egress_with_self, [])\n  egress_with_source_security_group_id                     = try(each.value.egress_with_source_security_group_id, var.defaults.egress_with_source_security_group_id, [])\n  ingress_cidr_blocks                                      = try(each.value.ingress_cidr_blocks, var.defaults.ingress_cidr_blocks, [])\n  ingress_ipv6_cidr_blocks                                 = try(each.value.ingress_ipv6_cidr_blocks, var.defaults.ingress_ipv6_cidr_blocks, [])\n  ingress_prefix_list_ids                                  = try(each.value.ingress_prefix_list_ids, var.defaults.ingress_prefix_list_ids, [])\n  ingress_rules                                            = try(each.value.ingress_rules, var.defaults.ingress_rules, [])\n  ingress_with_cidr_blocks                                 = try(each.value.ingress_with_cidr_blocks, var.defaults.ingress_with_cidr_blocks, [])\n  ingress_with_ipv6_cidr_blocks                            = try(each.value.ingress_with_ipv6_cidr_blocks, var.defaults.ingress_with_ipv6_cidr_blocks, [])\n  ingress_with_prefix_list_ids                             = try(each.value.ingress_with_prefix_list_ids, var.defaults.ingress_with_prefix_list_ids, [])\n  ingress_with_self                                        = try(each.value.ingress_with_self, var.defaults.ingress_with_self, [])\n  ingress_with_source_security_group_id                    = try(each.value.ingress_with_source_security_group_id, var.defaults.ingress_with_source_security_group_id, [])\n  name                                                     = try(each.value.name, var.defaults.name, null)\n  number_of_computed_egress_rules                          = try(each.value.number_of_computed_egress_rules, var.defaults.number_of_computed_egress_rules, 0)\n  number_of_computed_egress_with_cidr_blocks               = try(each.value.number_of_computed_egress_with_cidr_blocks, var.defaults.number_of_computed_egress_with_cidr_blocks, 0)\n  number_of_computed_egress_with_ipv6_cidr_blocks          = try(each.value.number_of_computed_egress_with_ipv6_cidr_blocks, var.defaults.number_of_computed_egress_with_ipv6_cidr_blocks, 0)\n  number_of_computed_egress_with_prefix_list_ids           = try(each.value.number_of_computed_egress_with_prefix_list_ids, var.defaults.number_of_computed_egress_with_prefix_list_ids, 0)\n  number_of_computed_egress_with_self                      = try(each.value.number_of_computed_egress_with_self, var.defaults.number_of_computed_egress_with_self, 0)\n  number_of_computed_egress_with_source_security_group_id  = try(each.value.number_of_computed_egress_with_source_security_group_id, var.defaults.number_of_computed_egress_with_source_security_group_id, 0)\n  number_of_computed_ingress_rules                         = try(each.value.number_of_computed_ingress_rules, var.defaults.number_of_computed_ingress_rules, 0)\n  number_of_computed_ingress_with_cidr_blocks              = try(each.value.number_of_computed_ingress_with_cidr_blocks, var.defaults.number_of_computed_ingress_with_cidr_blocks, 0)\n  number_of_computed_ingress_with_ipv6_cidr_blocks         = try(each.value.number_of_computed_ingress_with_ipv6_cidr_blocks, var.defaults.number_of_computed_ingress_with_ipv6_cidr_blocks, 0)\n  number_of_computed_ingress_with_prefix_list_ids          = try(each.value.number_of_computed_ingress_with_prefix_list_ids, var.defaults.number_of_computed_ingress_with_prefix_list_ids, 0)\n  number_of_computed_ingress_with_self                     = try(each.value.number_of_computed_ingress_with_self, var.defaults.number_of_computed_ingress_with_self, 0)\n  number_of_computed_ingress_with_source_security_group_id = try(each.value.number_of_computed_ingress_with_source_security_group_id, var.defaults.number_of_computed_ingress_with_source_security_group_id, 0)\n  putin_khuylo                                             = try(each.value.putin_khuylo, var.defaults.putin_khuylo, true)\n  revoke_rules_on_delete                                   = try(each.value.revoke_rules_on_delete, var.defaults.revoke_rules_on_delete, false)\n  rules = try(each.value.rules, var.defaults.rules, {\n\n    activemq-5671-tcp  = [5671, 5671, \"tcp\", \"ActiveMQ AMQP\"]\n    activemq-8883-tcp  = [8883, 8883, \"tcp\", \"ActiveMQ MQTT\"]\n    activemq-61614-tcp = [61614, 61614, \"tcp\", \"ActiveMQ STOMP\"]\n    activemq-61617-tcp = [61617, 61617, \"tcp\", \"ActiveMQ OpenWire\"]\n    activemq-61619-tcp = [61619, 61619, \"tcp\", \"ActiveMQ WebSocket\"]\n\n    alertmanager-9093-tcp = [9093, 9093, \"tcp\", \"Alert Manager\"]\n    alertmanager-9094-tcp = [9094, 9094, \"tcp\", \"Alert Manager Cluster\"]\n\n    carbon-line-in-tcp = [2003, 2003, \"tcp\", \"Carbon line-in\"]\n    carbon-line-in-udp = [2003, 2003, \"udp\", \"Carbon line-in\"]\n    carbon-pickle-tcp  = [2013, 2013, \"tcp\", \"Carbon pickle\"]\n    carbon-pickle-udp  = [2013, 2013, \"udp\", \"Carbon pickle\"]\n    carbon-admin-tcp   = [2004, 2004, \"tcp\", \"Carbon admin\"]\n    carbon-gui-udp     = [8081, 8081, \"tcp\", \"Carbon GUI\"]\n\n    cassandra-clients-tcp        = [9042, 9042, \"tcp\", \"Cassandra clients\"]\n    cassandra-thrift-clients-tcp = [9160, 9160, \"tcp\", \"Cassandra Thrift clients\"]\n    cassandra-jmx-tcp            = [7199, 7199, \"tcp\", \"JMX\"]\n\n    consul-tcp             = [8300, 8300, \"tcp\", \"Consul server\"]\n    consul-grpc-tcp        = [8502, 8502, \"tcp\", \"Consul gRPC\"]\n    consul-grpc-tcp-tls    = [8503, 8503, \"tcp\", \"Consul gRPC TLS\"]\n    consul-webui-http-tcp  = [8500, 8500, \"tcp\", \"Consul web UI HTTP\"]\n    consul-webui-https-tcp = [8501, 8501, \"tcp\", \"Consul web UI HTTPS\"]\n    consul-dns-tcp         = [8600, 8600, \"tcp\", \"Consul DNS\"]\n    consul-dns-udp         = [8600, 8600, \"udp\", \"Consul DNS\"]\n    consul-serf-lan-tcp    = [8301, 8301, \"tcp\", \"Serf LAN\"]\n    consul-serf-lan-udp    = [8301, 8301, \"udp\", \"Serf LAN\"]\n    consul-serf-wan-tcp    = [8302, 8302, \"tcp\", \"Serf WAN\"]\n    consul-serf-wan-udp    = [8302, 8302, \"udp\", \"Serf WAN\"]\n\n    dax-cluster-unencrypted-tcp = [8111, 8111, \"tcp\", \"DAX Cluster unencrypted\"]\n    dax-cluster-encrypted-tcp   = [9111, 9111, \"tcp\", \"DAX Cluster encrypted\"]\n\n    docker-swarm-mngmt-tcp   = [2377, 2377, \"tcp\", \"Docker Swarm cluster management\"]\n    docker-swarm-node-tcp    = [7946, 7946, \"tcp\", \"Docker Swarm node\"]\n    docker-swarm-node-udp    = [7946, 7946, \"udp\", \"Docker Swarm node\"]\n    docker-swarm-overlay-udp = [4789, 4789, \"udp\", \"Docker Swarm Overlay Network Traffic\"]\n\n    dns-udp = [53, 53, \"udp\", \"DNS\"]\n    dns-tcp = [53, 53, \"tcp\", \"DNS\"]\n\n    etcd-client-tcp = [2379, 2379, \"tcp\", \"Etcd Client\"]\n    etcd-peer-tcp   = [2380, 2380, \"tcp\", \"Etcd Peer\"]\n\n    ntp-udp = [123, 123, \"udp\", \"NTP\"]\n\n    elasticsearch-rest-tcp = [9200, 9200, \"tcp\", \"Elasticsearch REST interface\"]\n    elasticsearch-java-tcp = [9300, 9300, \"tcp\", \"Elasticsearch Java interface\"]\n\n    grafana-tcp = [3000, 3000, \"tcp\", \"Grafana Dashboard\"]\n\n    graphite-webui    = [80, 80, \"tcp\", \"Graphite admin interface\"]\n    graphite-2003-tcp = [2003, 2003, \"tcp\", \"Carbon receiver plain text\"]\n    graphite-2004-tcp = [2004, 2004, \"tcp\", \"Carbon receiver pickle\"]\n    graphite-2023-tcp = [2023, 2023, \"tcp\", \"Carbon aggregator plaintext\"]\n    graphite-2024-tcp = [2024, 2024, \"tcp\", \"Carbon aggregator pickle\"]\n    graphite-8080-tcp = [8080, 8080, \"tcp\", \"Graphite gunicorn port\"]\n    graphite-8125-tcp = [8125, 8125, \"tcp\", \"Statsd TCP\"]\n    graphite-8125-udp = [8125, 8125, \"udp\", \"Statsd UDP default\"]\n    graphite-8126-tcp = [8126, 8126, \"tcp\", \"Statsd admin\"]\n\n    http-80-tcp   = [80, 80, \"tcp\", \"HTTP\"]\n    http-8080-tcp = [8080, 8080, \"tcp\", \"HTTP\"]\n\n    https-443-tcp  = [443, 443, \"tcp\", \"HTTPS\"]\n    https-8443-tcp = [8443, 8443, \"tcp\", \"HTTPS\"]\n\n    ipsec-500-udp  = [500, 500, \"udp\", \"IPSEC ISAKMP\"]\n    ipsec-4500-udp = [4500, 4500, \"udp\", \"IPSEC NAT-T\"]\n\n    kafka-broker-tcp                   = [9092, 9092, \"tcp\", \"Kafka PLAINTEXT enable broker 0.8.2+\"]\n    kafka-broker-tls-tcp               = [9094, 9094, \"tcp\", \"Kafka TLS enabled broker 0.8.2+\"]\n    kafka-broker-tls-public-tcp        = [9194, 9194, \"tcp\", \"Kafka TLS Public enabled broker 0.8.2+ (MSK specific)\"]\n    kafka-broker-sasl-scram-tcp        = [9096, 9096, \"tcp\", \"Kafka SASL/SCRAM enabled broker (MSK specific)\"]\n    kafka-broker-sasl-scram-public-tcp = [9196, 9196, \"tcp\", \"Kafka SASL/SCRAM Public enabled broker (MSK specific)\"]\n    kafka-broker-sasl-iam-tcp          = [9098, 9098, \"tcp\", \"Kafka SASL/IAM access control enabled (MSK specific)\"]\n    kafka-broker-sasl-iam-public-tcp   = [9198, 9198, \"tcp\", \"Kafka SASL/IAM Public access control enabled (MSK specific)\"]\n    kafka-jmx-exporter-tcp             = [11001, 11001, \"tcp\", \"Kafka JMX Exporter\"]\n    kafka-node-exporter-tcp            = [11002, 11002, \"tcp\", \"Kafka Node Exporter\"]\n\n    kibana-tcp = [5601, 5601, \"tcp\", \"Kibana Web Interface\"]\n\n    kubernetes-api-tcp = [6443, 6443, \"tcp\", \"Kubernetes API Server\"]\n\n    ldap-tcp = [389, 389, \"tcp\", \"LDAP\"]\n\n    ldaps-tcp = [636, 636, \"tcp\", \"LDAPS\"]\n\n    logstash-tcp = [5044, 5044, \"tcp\", \"Logstash\"]\n\n    loki-grafana      = [3100, 3100, \"tcp\", \"Grafana Loki endpoint\"]\n    loki-grafana-grpc = [9095, 9095, \"tcp\", \"Grafana Loki GRPC\"]\n\n    memcached-tcp = [11211, 11211, \"tcp\", \"Memcached\"]\n\n    minio-tcp = [9000, 9000, \"tcp\", \"MinIO\"]\n\n    mongodb-27017-tcp = [27017, 27017, \"tcp\", \"MongoDB\"]\n    mongodb-27018-tcp = [27018, 27018, \"tcp\", \"MongoDB shard\"]\n    mongodb-27019-tcp = [27019, 27019, \"tcp\", \"MongoDB config server\"]\n\n    mysql-tcp = [3306, 3306, \"tcp\", \"MySQL/Aurora\"]\n\n    mssql-tcp           = [1433, 1433, \"tcp\", \"MSSQL Server\"]\n    mssql-udp           = [1434, 1434, \"udp\", \"MSSQL Browser\"]\n    mssql-analytics-tcp = [2383, 2383, \"tcp\", \"MSSQL Analytics\"]\n    mssql-broker-tcp    = [4022, 4022, \"tcp\", \"MSSQL Broker\"]\n\n    nfs-tcp = [2049, 2049, \"tcp\", \"NFS/EFS\"]\n\n    nomad-http-tcp = [4646, 4646, \"tcp\", \"Nomad HTTP\"]\n    nomad-rpc-tcp  = [4647, 4647, \"tcp\", \"Nomad RPC\"]\n    nomad-serf-tcp = [4648, 4648, \"tcp\", \"Serf\"]\n    nomad-serf-udp = [4648, 4648, \"udp\", \"Serf\"]\n\n    openvpn-udp       = [1194, 1194, \"udp\", \"OpenVPN\"]\n    openvpn-tcp       = [943, 943, \"tcp\", \"OpenVPN\"]\n    openvpn-https-tcp = [443, 443, \"tcp\", \"OpenVPN\"]\n\n    postgresql-tcp = [5432, 5432, \"tcp\", \"PostgreSQL\"]\n\n    puppet-tcp   = [8140, 8140, \"tcp\", \"Puppet\"]\n    puppetdb-tcp = [8081, 8081, \"tcp\", \"PuppetDB\"]\n\n    prometheus-http-tcp               = [9090, 9090, \"tcp\", \"Prometheus\"]\n    prometheus-pushgateway-http-tcp   = [9091, 9091, \"tcp\", \"Prometheus Pushgateway\"]\n    prometheus-node-exporter-http-tcp = [9100, 9100, \"tcp\", \"Prometheus Node Exporter\"]\n\n    promtail-http = [9080, 9080, \"tcp\", \"Promtail endpoint\"]\n\n    oracle-db-tcp = [1521, 1521, \"tcp\", \"Oracle\"]\n\n    octopus-tentacle-tcp = [10933, 10933, \"tcp\", \"Octopus Tentacle\"]\n\n    rabbitmq-4369-tcp  = [4369, 4369, \"tcp\", \"RabbitMQ epmd\"]\n    rabbitmq-5671-tcp  = [5671, 5671, \"tcp\", \"RabbitMQ\"]\n    rabbitmq-5672-tcp  = [5672, 5672, \"tcp\", \"RabbitMQ\"]\n    rabbitmq-15672-tcp = [15672, 15672, \"tcp\", \"RabbitMQ\"]\n    rabbitmq-25672-tcp = [25672, 25672, \"tcp\", \"RabbitMQ\"]\n\n    rdp-tcp = [3389, 3389, \"tcp\", \"Remote Desktop\"]\n    rdp-udp = [3389, 3389, \"udp\", \"Remote Desktop\"]\n\n    redis-tcp = [6379, 6379, \"tcp\", \"Redis\"]\n\n    redshift-tcp = [5439, 5439, \"tcp\", \"Redshift\"]\n\n    saltstack-tcp = [4505, 4506, \"tcp\", \"SaltStack\"]\n\n    smtp-tcp                 = [25, 25, \"tcp\", \"SMTP\"]\n    smtp-submission-587-tcp  = [587, 587, \"tcp\", \"SMTP Submission\"]\n    smtp-submission-2587-tcp = [2587, 2587, \"tcp\", \"SMTP Submission\"]\n    smtps-465-tcp            = [465, 465, \"tcp\", \"SMTPS\"]\n    smtps-2456-tcp           = [2465, 2465, \"tcp\", \"SMTPS\"]\n\n    solr-tcp = [8983, 8987, \"tcp\", \"Solr\"]\n\n    splunk-indexer-tcp = [9997, 9997, \"tcp\", \"Splunk indexer\"]\n    splunk-web-tcp     = [8000, 8000, \"tcp\", \"Splunk Web\"]\n    splunk-splunkd-tcp = [8089, 8089, \"tcp\", \"Splunkd\"]\n    splunk-hec-tcp     = [8088, 8088, \"tcp\", \"Splunk HEC\"]\n\n    squid-proxy-tcp = [3128, 3128, \"tcp\", \"Squid default proxy\"]\n\n    ssh-tcp = [22, 22, \"tcp\", \"SSH\"]\n\n    storm-nimbus-tcp     = [6627, 6627, \"tcp\", \"Nimbus\"]\n    storm-ui-tcp         = [8080, 8080, \"tcp\", \"Storm UI\"]\n    storm-supervisor-tcp = [6700, 6703, \"tcp\", \"Supervisor\"]\n\n    vault-tcp = [8200, 8200, \"tcp\", \"Vault\"]\n\n    wazuh-server-agent-connection-tcp = [1514, 1514, \"tcp\", \"Agent connection service(TCP)\"]\n    wazuh-server-agent-connection-udp = [1514, 1514, \"udp\", \"Agent connection service(UDP)\"]\n    wazuh-server-agent-enrollment     = [1515, 1515, \"tcp\", \"Agent enrollment service\"]\n    wazuh-server-agent-cluster-daemon = [1516, 1516, \"tcp\", \"Wazuh cluster daemon\"]\n    wazuh-server-syslog-collector-tcp = [514, 514, \"tcp\", \"Wazuh Syslog collector(TCP)\"]\n    wazuh-server-syslog-collector-udp = [514, 514, \"udp\", \"Wazuh Syslog collector(UDP)\"]\n    wazuh-server-restful-api          = [55000, 55000, \"tcp\", \"Wazuh server RESTful API\"]\n    wazuh-indexer-restful-api         = [9200, 9200, \"tcp\", \"Wazuh indexer RESTful API\"]\n    wazuh-dashboard                   = [443, 443, \"tcp\", \"Wazuh web user interface\"]\n\n    web-jmx-tcp = [1099, 1099, \"tcp\", \"JMX\"]\n\n    winrm-http-tcp  = [5985, 5985, \"tcp\", \"WinRM HTTP\"]\n    winrm-https-tcp = [5986, 5986, \"tcp\", \"WinRM HTTPS\"]\n\n    zabbix-server = [10051, 10051, \"tcp\", \"Zabbix Server\"]\n    zabbix-proxy  = [10051, 10051, \"tcp\", \"Zabbix Proxy\"]\n    zabbix-agent  = [10050, 10050, \"tcp\", \"Zabbix Agent\"]\n\n    zipkin-admin-tcp       = [9990, 9990, \"tcp\", \"Zipkin Admin port collector\"]\n    zipkin-admin-query-tcp = [9901, 9901, \"tcp\", \"Zipkin Admin port query\"]\n    zipkin-admin-web-tcp   = [9991, 9991, \"tcp\", \"Zipkin Admin port web\"]\n    zipkin-query-tcp       = [9411, 9411, \"tcp\", \"Zipkin query port\"]\n    zipkin-web-tcp         = [8080, 8080, \"tcp\", \"Zipkin web port\"]\n\n    zookeeper-2181-tcp     = [2181, 2181, \"tcp\", \"Zookeeper\"]\n    zookeeper-2182-tls-tcp = [2182, 2182, \"tcp\", \"Zookeeper TLS (MSK specific)\"]\n    zookeeper-2888-tcp     = [2888, 2888, \"tcp\", \"Zookeeper\"]\n    zookeeper-3888-tcp     = [3888, 3888, \"tcp\", \"Zookeeper\"]\n    zookeeper-jmx-tcp      = [7199, 7199, \"tcp\", \"JMX\"]\n\n    all-all       = [-1, -1, \"-1\", \"All protocols\"]\n    all-tcp       = [0, 65535, \"tcp\", \"All TCP ports\"]\n    all-udp       = [0, 65535, \"udp\", \"All UDP ports\"]\n    all-icmp      = [-1, -1, \"icmp\", \"All IPV4 ICMP\"]\n    all-ipv6-icmp = [-1, -1, 58, \"All IPV6 ICMP\"]\n\n    _ = [\"\", \"\", \"\"]\n  })\n  security_group_id = try(each.value.security_group_id, var.defaults.security_group_id, null)\n  tags              = try(each.value.tags, var.defaults.tags, {})\n  use_name_prefix   = try(each.value.use_name_prefix, var.defaults.use_name_prefix, true)\n  vpc_id            = try(each.value.vpc_id, var.defaults.vpc_id, null)\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-security-group__wrappers__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"helm\" {\n    kubernetes = {\n        host  = \"https://${data.google_container_cluster.my_cluster.endpoint}\"\n        token = data.google_client_config.provider.access_token\n        cluster_ca_certificate = base64decode(\n        data.google_container_cluster.my_cluster.master_auth[0].cluster_ca_certificate,)\n        exec = {\n            api_version = \"client.authentication.k8s.io/v1beta1\"\n            command     = \"gke-gcloud-auth-plugin\"\n        }\n    }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-helm__examples__example_6.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nvariable \"project_id\" {\n  type        = string\n  description = \"Project ID of GCP project to be used\"\n  default     = \"\"\n}\n\nvariable \"environment\" {\n  type        = string\n  description = \"Name of the environment (dev or prod)\"\n  default     = \"dev\"\n}\n\nvariable \"subnet1_region\" {\n  type        = string\n  description = \"GCP Region where first subnet will be created\"\n  default     = \"us-central1\"\n}\n\nvariable \"subnet1_zone\" {\n  type        = string\n  description = \"GCP Zone within Subnet1 Region where GCE instance will be created\"\n  default     = \"us-central1-a\"\n}\n\nvariable \"subnet1_cidr\" {\n  type        = string\n  description = \"VPC Network CIDR to be assigned to the VPC being created\"\n  default     = \"10.0.0.0/17\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-jenkins-gitops__example-pipelines__environments__prod__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#-----------------\n# Azurerm Provider\n#-----------------\n\nterraform {\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"=3.0.0\"\n    }\n  }\n}\n\n# Configure the Microsoft Azure Provider\nprovider \"azurerm\" {\n  features {}\n  subscription_id = \"xxxxxxxxxxxxxxx\"\n  tenant_id       = \"9cad23bc-9611-\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/frankisinfotech__terraform__azure__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nresource \"aws_instance\" \"example\" {\n    ami = var.ami_value\n    instance_type = var.instance_type_value\n    subnet_id = var.subnet_id_value\n    associate_public_ip_address = true\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-3__modules__ec2_instance__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-3__modules__ec2_instance__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-3__modules__ec2_instance__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-3__modules__ec2_instance__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-3__modules__ec2_instance__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-3__modules__ec2_instance__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-3__modules__ec2_instance__main.tf", "start_line": 5}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"public_instance_ip\" {\n  value = [\"${aws_instance.levelup_instance.public_ip}\"]\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/anshulc55__terraform__NetworkModule__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nprovider \"aws\" {\n  region = var.region\n}\n\n# Filter out local zones, which are not currently supported \n# with managed node groups\ndata \"aws_availability_zones\" \"available\" {\n  filter {\n    name   = \"opt-in-status\"\n    values = [\"opt-in-not-required\"]\n  }\n}\n\nlocals {\n  cluster_name = \"education-eks-${random_string.suffix.result}\"\n}\n\nresource \"random_string\" \"suffix\" {\n  length  = 8\n  special = false\n}\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"5.8.1\"\n\n  name = \"education-vpc\"\n\n  cidr = \"10.0.0.0/16\"\n  azs  = slice(data.aws_availability_zones.available.names, 0, 3)\n\n  private_subnets = [\"10.0.1.0/24\", \"10.0.2.0/24\", \"10.0.3.0/24\"]\n  public_subnets  = [\"10.0.4.0/24\", \"10.0.5.0/24\", \"10.0.6.0/24\"]\n\n  enable_nat_gateway   = true\n  single_nat_gateway   = true\n  enable_dns_hostnames = true\n\n  public_subnet_tags = {\n    \"kubernetes.io/role/elb\" = 1\n  }\n\n  private_subnet_tags = {\n    \"kubernetes.io/role/internal-elb\" = 1\n  }\n}\n\nmodule \"eks\" {\n  source  = \"terraform-aws-modules/eks/aws\"\n  version = \"20.8.5\"\n\n  cluster_name    = local.cluster_name\n  cluster_version = \"1.29\"\n\n  cluster_endpoint_public_access           = true\n  enable_cluster_creator_admin_permissions = true\n\n  cluster_addons = {\n    aws-ebs-csi-driver = {\n      service_account_role_arn = module.irsa-ebs-csi.iam_role_arn\n    }\n  }\n\n  vpc_id     = module.vpc.vpc_id\n  subnet_ids = module.vpc.private_subnets\n\n  eks_managed_node_group_defaults = {\n    ami_type = \"AL2_x86_64\"\n\n  }\n\n  eks_managed_node_groups = {\n    one = {\n      name = \"node-group-1\"\n\n      instance_types = [\"t3.small\"]\n\n      min_size     = 1\n      max_size     = 3\n      desired_size = 2\n    }\n\n    two = {\n      name = \"node-group-2\"\n\n      instance_types = [\"t3.small\"]\n\n      min_size     = 1\n      max_size     = 2\n      desired_size = 1\n    }\n  }\n}\n\n\n# https://aws.amazon.com/blogs/containers/amazon-ebs-csi-driver-is-now-generally-available-in-amazon-eks-add-ons/ \ndata \"aws_iam_policy\" \"ebs_csi_policy\" {\n  arn = \"arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy\"\n}\n\nmodule \"irsa-ebs-csi\" {\n  source  = \"terraform-aws-modules/iam/aws//modules/iam-assumable-role-with-oidc\"\n  version = \"5.39.0\"\n\n  create_role                   = true\n  role_name                     = \"AmazonEKSTFEBSCSIRole-${module.eks.cluster_name}\"\n  provider_url                  = module.eks.oidc_provider\n  role_policy_arns              = [data.aws_iam_policy.ebs_csi_policy.arn]\n  oidc_fully_qualified_subjects = [\"system:serviceaccount:kube-system:ebs-csi-controller-sa\"]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-provision-eks-cluster__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-provision-eks-cluster__main.tf", "start_line": 26}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-provision-eks-cluster__main.tf", "start_line": 51}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-provision-eks-cluster__main.tf", "start_line": 104}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \"~> 1.1\"\n  required_providers {\n    azurerm = {\n      version = \"~> 3.9.0\"\n    }\n  }\n}\n\nprovider \"azurerm\" {\n  subscription_id = \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\"\n  alias           = \"sub1\"\n  features {}\n}\n\nprovider \"azurerm\" {\n  subscription_id = \"yyyyyyyy-yyyy-yyyy-yyyy-yyyyyyyyyyyy\"\n  alias           = \"sub2\"\n  features {}\n}\n\nresource \"azurerm_resource_group\" \"rg\" {\n  provider = azurerm.sub1\n  name     = \"rg-sub1\"\n  location = \"westeurope\"\n}\n\nresource \"azurerm_resource_group\" \"rg2\" {\n  provider = azurerm.sub2\n  name     = \"rg-sub2\"\n  location = \"westeurope\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook-Second-Edition__CHAP02__alias__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"http\" \"workstation-external-ip\" {\n  url = \"http://ipv4.icanhazip.com\"\n}\n\nlocals {\n  workstation-external-cidr = \"${chomp(data.http.workstation-external-ip.body)}/32\"\n}\n\ndata \"aws_subnet_ids\" \"subnet_id\" {\n  vpc_id = var.vpc_id\n\n  tags = {\n    Name = \"pub*\"\n  }\n}\n\n\noutput \"ids\" {\n    value = data.aws_subnet_ids.subnet_id.ids\n}\n\n\n\nresource \"aws_security_group\" \"EKS_SG\" {\n  name        = \"${var.cluster_name}-sg\"\n  description = \"${var.cluster_name}-sg\"\n  vpc_id      = var.vpc_id\n  \n\n  ingress {\n    description      = \"TLS from VPC\"\n    from_port        = 0\n    to_port          = 0\n    protocol         = \"tcp\"\n    cidr_blocks      = [local.workstation-external-cidr]\n    \n  }\n\n\n  egress {\n    from_port        = 0\n    to_port          = 0\n    protocol         = \"-1\"\n    cidr_blocks      = [\"0.0.0.0/0\"]\n    \n  }\n\n  tags = {\n    Name = \"${var.cluster_name}-sg\"\n  }\n}\n\n\nresource \"aws_iam_role\" \"cluster_role\" {\n  name = \"${var.cluster_name}-eks-cluster-cluster_role\"\n\n  assume_role_policy = <<POLICY\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"eks.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nPOLICY\n}\n\nresource \"aws_iam_role_policy_attachment\" \"AmazonEKSClusterPolicy\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSClusterPolicy\"\n  role       = aws_iam_role.cluster_role.name\n}\n\nresource \"aws_eks_cluster\" \"myeks\" {\n    name = var.cluster_name\n    role_arn = aws_iam_role.cluster_role.arn\n\n    vpc_config {\n        \n        subnet_ids = data.aws_subnet_ids.subnet_id.ids\n        endpoint_private_access = true\n        endpoint_public_access = false\n        security_group_ids = [aws_security_group.EKS_SG.id]\n    \n    }\n\n}\n\n#\n\nresource \"aws_iam_role\" \"eks_node_role\" {\n  name = \"${var.cluster_name}-terraform-eks-eks_node_role\"\n\n  assume_role_policy = <<POLICY\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nPOLICY\n}\n\nresource \"aws_iam_role_policy_attachment\" \"eks_node_role-AmazonEKSWorkerNodePolicy\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy\"\n  role       = aws_iam_role.eks_node_role.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"eks_node_role-AmazonEKS_CNI_Policy\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy\"\n  role       = aws_iam_role.eks_node_role.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"eks_node_role-AmazonEC2ContainerRegistryReadOnly\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly\"\n  role       = aws_iam_role.eks_node_role.name\n}\n\n\n\nresource \"aws_eks_node_group\" \"mynode_node\" {\n    cluster_name = aws_eks_cluster.myeks.name\n    node_group_name = \"${var.cluster_name}-node\"\n    node_role_arn = aws_iam_role.eks_node_role.arn\n    subnet_ids = data.aws_subnet_ids.subnet_id.ids\n\n    scaling_config {\n        desired_size = 1\n        max_size = 1\n        min_size = 1\n    }\n\n    instance_types = [var.node_instance_type]\n}\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shubhamm45__Terraform__eks-creation__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shubhamm45__Terraform__eks-creation__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shubhamm45__Terraform__eks-creation__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_AWS_37", "severity": "HIGH", "message": "Ensure Amazon EKS control plane logging is enabled for all log types", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shubhamm45__Terraform__eks-creation__main.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_AWS_58", "severity": "HIGH", "message": "Ensure EKS Cluster has Secrets Encryption Enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/shubhamm45__Terraform__eks-creation__main.tf", "start_line": 78}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"terraform_state_backend\" {\n  source     = \"git::https://github.com/cloudposse/terraform-aws-tfstate-backend.git?ref=tags/0.9.0\"\n  namespace  = \".......\"\n  stage      = \"dev\"\n  name       = \"terraform\"\n  region     = \"eu-west-1\"\n  attributes = [\"state\"]\n}\n\noutput \"bucket_id\" {\n  value = module.terraform_state_backend.s3_bucket_id\n}\n\noutput \"terraform_backend_config\" {\n  value = module.terraform_state_backend.terraform_backend_config\n}\n\noutput \"bucket_region\" {\n  value = \"eu-west-1\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices-workshop__bootstrap-workshop-jsonnet__tf-bootstrap__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices-workshop__bootstrap-workshop-jsonnet__tf-bootstrap__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"sops\" {}\n\nephemeral \"sops_file\" \"demo_secret\" {\n  source_file = \"demo_secret.enc.json\"\n}\n\noutput \"root_value_password\" {\n  # Access the password variable from the map\n  value = data.sops_file.demo_secret.data[\"password\"]\n}\n\noutput \"mapped_nested_value\" {\n  # Access the password variable that is under db via the terraform map of data\n  value = data.sops_file.demo_secret.data[\"db.password\"]\n}\n\noutput \"nested_json_value\" {\n  # Access the password variable that is under db via the terraform object\n  value = jsondecode(data.sops_file.demo_secret.raw).db.password\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/carlpett__terraform-provider-sops__examples__ephemeral-resources__sops_file__ephemeral-resources.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Define the AWS provider configuration.\nprovider \"aws\" {\n  region = \"us-east-1\"  # Replace with your desired AWS region.\n}\n\nvariable \"cidr\" {\n  default = \"10.0.0.0/16\"\n}\n\nresource \"aws_key_pair\" \"example\" {\n  key_name   = \"terraform-demo-abhi\"  # Replace with your desired key name\n  public_key = file(\"~/.ssh/id_rsa.pub\")  # Replace with the path to your public key file\n}\n\nresource \"aws_vpc\" \"myvpc\" {\n  cidr_block = var.cidr\n}\n\nresource \"aws_subnet\" \"sub1\" {\n  vpc_id                  = aws_vpc.myvpc.id\n  cidr_block              = \"10.0.0.0/24\"\n  availability_zone       = \"us-east-1a\"\n  map_public_ip_on_launch = true\n}\n\nresource \"aws_internet_gateway\" \"igw\" {\n  vpc_id = aws_vpc.myvpc.id\n}\n\nresource \"aws_route_table\" \"RT\" {\n  vpc_id = aws_vpc.myvpc.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.igw.id\n  }\n}\n\nresource \"aws_route_table_association\" \"rta1\" {\n  subnet_id      = aws_subnet.sub1.id\n  route_table_id = aws_route_table.RT.id\n}\n\nresource \"aws_security_group\" \"webSg\" {\n  name   = \"web\"\n  vpc_id = aws_vpc.myvpc.id\n\n  ingress {\n    description = \"HTTP from VPC\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  ingress {\n    description = \"SSH\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"Web-sg\"\n  }\n}\n\nresource \"aws_instance\" \"server\" {\n  ami                    = \"ami-0261755bbcb8c4a84\"\n  instance_type          = \"t2.micro\"\n  key_name      = aws_key_pair.example.key_name\n  vpc_security_group_ids = [aws_security_group.webSg.id]\n  subnet_id              = aws_subnet.sub1.id\n\n  connection {\n    type        = \"ssh\"\n    user        = \"ubuntu\"  # Replace with the appropriate username for your EC2 instance\n    private_key = file(\"~/.ssh/id_rsa\")  # Replace with the path to your private key\n    host        = self.public_ip\n  }\n\n  # File provisioner to copy a file from local to the remote EC2 instance\n  provisioner \"file\" {\n    source      = \"app.py\"  # Replace with the path to your local file\n    destination = \"/home/ubuntu/app.py\"  # Replace with the path on the remote instance\n  }\n\n  provisioner \"remote-exec\" {\n    inline = [\n      \"echo 'Hello from the remote instance'\",\n      \"sudo apt update -y\",  # Update package lists (for ubuntu)\n      \"sudo apt-get install -y python3-pip\",  # Example package installation\n      \"cd /home/ubuntu\",\n      \"sudo pip3 install flask\",\n      \"sudo python3 app.py &\",\n    ]\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-5__main.tf", "start_line": 75}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_key_pair\" \"deployer\" {\n  key_name   = \"${var.my_env}-terra-automate-key\"\n  public_key = file(\"terra-key.pub\")\n  \n}\n\nresource \"aws_default_vpc\" \"default\" {\n\n}\n\nresource \"aws_security_group\" \"allow_user_to_connect\" {\n  name        = \"${var.my_env}-allow-TLS\"\n  description = \"Allow user to connect\"\n  vpc_id      = aws_default_vpc.default.id\n  ingress {\n    description = \"port 22 allow\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    description = \" allow all outgoing traffic \"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    description = \"port 80 allow\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    description = \"port 443 allow\"\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.my_env}-mysecurity\"\n  }\n}\n\nresource \"aws_instance\" \"my_app_server\" {\n    count = 2\n    ami = var.ami\n    instance_type = var.instance_type\n    key_name        = aws_key_pair.deployer.key_name\n    security_groups = [aws_security_group.allow_user_to_connect.name]\n  root_block_device {\n    volume_size = 10 \n    volume_type = \"gp3\"\n  }\n    tags = {\n        Name = \"${var.my_env}-tws-demo-app-server\"\n    }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_148", "severity": "HIGH", "message": "Ensure no default VPC is planned to be provisioned", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_server.tf", "start_line": 52}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"fastly_ngwaf_alert_opsgenie_integration\" \"ngwaf_opsgenie_alerts\" {\n    workspace_id = fastly_ngwaf_workspace.test_redactions_workspace.id\n}\n\noutput \"ngwaf_opsgenie_alerts_all\" {\n  value = data.ngwaf_opsgenie_alerts.opsgenie_alerts\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/fastly__terraform-provider-fastly__examples__data-sources__ngwaf_alert_opsgenie_integration.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\n * variables.tf\n * Common variables to use in various Terraform files (*.tf)\n */\n\n# The AWS region to use for the bucket and registry\nvariable \"region\" {\n  default = \"us-east-1\"\n}\n\n# The AWS profile to use, this would be the same value used in AWS_PROFILE.\nvariable \"aws_profile\" {\n}\n\n# The role that will have access to the S3 bucket, this should be a role that all\n# members of the team have access to.\nvariable \"saml_role\" {\n}\n\n# Name of the application. This value should usually match the application tag below.\nvariable \"app\" {\n}\n\n# A map of the tags to apply to various resources. The required tags are:\n# `application`, name of the app;\n# `environment`, the environment being created;\n# `team`, team responsible for the application;\n# `contact-email`, contact email for the _team_;\n# and `customer`, who the application was create for.\nvariable \"tags\" {\n  type = map(string)\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/turnerlabs__terraform-ecs-fargate__base__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"elb_name\" {\n  value = \"${aws_elb.elb.name}\"\n}\n\noutput \"elb_dns_name\" {\n  value = \"${aws_elb.elb.dns_name}\"\n}\n\noutput \"security_group_id\" {\n  value = \"${aws_security_group.elb.id}\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__infrastructure-as-code-talk__terraform-configurations__elb__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\nresource \"aws_iam_role\" \"my-config\" {\n  name = \"config-example\"\n\n  assume_role_policy = <<POLICY\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"config.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nPOLICY\n}\n\nresource \"aws_iam_role_policy_attachment\" \"my-config\" {\n  role       = \"${aws_iam_role.my-config.name}\"\n  policy_arn = \"arn:aws:iam::aws:policy/service-role/AWSConfigRole\"\n}\n\nresource \"aws_s3_bucket\" \"my-config\" {\n  bucket = \"config-bucket-for-my-test-project\"\n  acl    = \"private\"\n\n  versioning {\n    enabled = true\n  }\n\n  lifecycle {\n    prevent_destroy = true\n  }\n}\n\nresource \"aws_config_configuration_recorder\" \"my-config\" {\n  name     = \"config-example\"\n  role_arn = \"${aws_iam_role.my-config.arn}\"\n\n  recording_group {\n    all_supported                 = true\n    include_global_resource_types = true\n  }\n}\n\nresource \"aws_config_delivery_channel\" \"my-config\" {\n  name           = \"config-example\"\n  s3_bucket_name = \"${aws_s3_bucket.my-config.bucket}\"\n\n  depends_on = [\"aws_config_configuration_recorder.my-config\"]\n}\n\nresource \"aws_config_configuration_recorder_status\" \"config\" {\n  name       = \"${aws_config_configuration_recorder.my-config.name}\"\n  is_enabled = true\n\n  depends_on = [\"aws_config_delivery_channel.my-config\"]\n}\n\nresource \"aws_config_config_rule\" \"instances_in_vpc\" {\n  name = \"instances_in_vpc\"\n\n  source {\n    owner             = \"AWS\"\n    source_identifier = \"INSTANCES_IN_VPC\"\n  }\n\n  depends_on = [\"aws_config_configuration_recorder.my-config\"]\n}\n\nresource \"aws_config_config_rule\" \"cloud_trail_enabled\" {\n  name = \"cloud_trail_enabled\"\n\n  source {\n    owner             = \"AWS\"\n    source_identifier = \"CLOUD_TRAIL_ENABLED\"\n  }\n\n  input_parameters = <<EOF\n{\n  \"s3BucketName\": \"cloudwatch-to-s3-logs\"\n}\nEOF\n\n  depends_on = [\"aws_config_configuration_recorder.my-config\"]\n}\n\nresource \"aws_config_config_rule\" \"s3_bucket_versioning_enabled\" {\n  name = \"s3_bucket_versioning_enabled\"\n\n  source {\n    owner             = \"AWS\"\n    source_identifier = \"S3_BUCKET_VERSIONING_ENABLED\"\n  }\n\n  depends_on = [\"aws_config_configuration_recorder.my-config\"]\n}\n\nresource \"aws_config_config_rule\" \"desired_instance_type\" {\n  name = \"desired_instance_type\"\n\n  \"source\" {\n    owner             = \"AWS\"\n    source_identifier = \"DESIRED_INSTANCE_TYPE\"\n  }\n\n  input_parameters = <<EOF\n{\n  \"alarmActionRequired\" : \"t2.micro\"\n}\nEOF\n\n  depends_on = [\"aws_config_configuration_recorder.my-config\"]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__aws_config__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__aws_config__main.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__aws_config__main.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"github\" {\n  owner = \"ministryofjustice\"\n  token = var.github_token\n}\n\nprovider \"aws\" {\n  region = \"eu-west-2\"\n}\n\nprovider \"aws\" {\n  region = \"eu-west-2\"\n  alias  = \"testing-test\"\n  assume_role {\n    role_arn = \"arn:aws:iam::${local.environment_management.account_ids[\"testing-test\"]}:role/ModernisationPlatformAccess\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ministryofjustice__modernisation-platform__terraform__github__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"kubeconfig\" {\n  value       = module.rancher.kubeconfig\n  description = <<-EOT\n    The kubeconfig for the server.\n  EOT\n  sensitive   = true\n}\noutput \"address\" {\n  value = module.rancher.address\n}\noutput \"admin_token\" {\n  value     = module.rancher.admin_token\n  sensitive = true\n}\noutput \"admin_password\" {\n  value     = module.rancher.admin_password\n  sensitive = true\n}\noutput \"cluster_data\" {\n  value     = jsonencode(data.rancher2_cluster.local)\n  sensitive = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__terraform-provider-rancher2__examples__use-cases__three__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// terraform {\n//   backend \"remote\" {\n//     organization = \"my-organization\"\n//     workspaces {\n//       name = \"random-pet-demo\"\n//     }\n//   }\n// }\n\nvariable \"stage\" {\n  default = \"production\"\n}\n\nresource \"random_pet\" \"server\" {\n  keepers = {\n    # Generate a new pet name each time we switch to a new stage\n    stage = \"${var.stage}\"\n  }\n}\n\noutput \"random_server_id\" {\n  value = random_pet.server.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__demo-terraform-101__getting-started__tfc__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    cloudflare = {\n      source = \"cloudflare/cloudflare\"\n      version = \"~> 4\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudflare__cf-terraforming__testdata__terraform__v4__cloudflare_access_identity_provider_oauth_account__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"random_password\" \"p\" {\n  length = 5\n}\n\nterraform {\n  required_providers {\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"~>3.4\"\n    }\n  }\n\n  required_version = \"~>1.3.7\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/dflook__terraform-github-actions__tests__workflows__repository_dispatch__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvariable \"group_email\" {\n  type        = string\n  description = \"Email for group to receive roles (ex. group@example.com)\"\n}\n\nvariable \"sa_email\" {\n  type        = string\n  description = \"Email for Service Account to receive roles (Ex. default-sa@example-project-id.iam.gserviceaccount.com)\"\n}\n\nvariable \"user_email\" {\n  type        = string\n  description = \"Email for group to receive roles (Ex. user@example.com)\"\n}\n\nvariable \"project_id\" {\n  type        = string\n  description = \"Project ID to create BigQuery resources in\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-iam__examples__dns_zone__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"null_resource\" \"foo\" {}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/minamijoyo__tfmigrate__test-fixtures__legacy-tfstate__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"eks\" {\n  source  = \"terraform-aws-modules/eks/aws\"\n  version = \"19.19.1\"\n\n  cluster_name    = local.cluster_name\n  cluster_version = \"1.27\"\n\n  vpc_id                         = module.vpc.vpc_id\n  subnet_ids                     = module.vpc.private_subnets\n  cluster_endpoint_public_access = true\n\n  eks_managed_node_group_defaults = {\n    ami_type = \"AL2_x86_64\"\n\n  }\n\n  eks_managed_node_groups = {\n    one = {\n      name = \"node-group-1\"\n\n      instance_types = [\"t3.small\"]\n\n      min_size     = 1\n      max_size     = 3\n      desired_size = 2\n    }\n\n    two = {\n      name = \"node-group-2\"\n\n      instance_types = [\"t3.small\"]\n\n      min_size     = 1\n      max_size     = 2\n      desired_size = 1\n    }\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hkhcoder__iac-vprofile__terraform__eks-cluster.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hkhcoder__iac-vprofile__terraform__eks-cluster.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"quickstart_node_win\" {\n  depends_on = [\n    aws_route_table_association.rancher_route_table_association\n  ]\n  count         = var.add_windows_node ? 1 : 0\n  ami           = data.aws_ami.windows.id\n  instance_type = var.windows_instance_type\n\n  key_name                    = aws_key_pair.quickstart_key_pair.key_name\n  vpc_security_group_ids      = [aws_security_group.rancher_sg_allowall.id]\n  subnet_id                   = aws_subnet.rancher_subnet.id\n  associate_public_ip_address = true\n  get_password_data           = true\n\n  user_data = templatefile(\n    \"${path.module}/files/userdata_quickstart_windows.template\",\n    {\n      register_command = module.rancher_common.custom_cluster_windows_command\n    }\n  )\n\n  root_block_device {\n    volume_size = 50\n  }\n\n  tags = {\n    Name    = \"${var.prefix}-quickstart-win\"\n    Creator = \"rancher-quickstart\"\n  }\n\n}\n\noutput \"windows_password\" {\n  description = \"Returns the decrypted AWS generated windows password\"\n  sensitive   = true\n  value = [\n    for instance in aws_instance.quickstart_node_win :\n    rsadecrypt(instance.password_data, tls_private_key.global_key.private_key_pem)\n  ]\n}\n\noutput \"windows-workload-ips\" {\n  value = aws_instance.quickstart_node_win[*].public_ip\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__quickstart__rancher__aws__windows.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__quickstart__rancher__aws__windows.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__quickstart__rancher__aws__windows.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__quickstart__rancher__aws__windows.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__quickstart__rancher__aws__windows.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__quickstart__rancher__aws__windows.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-eks__examples__eks-auto-mode__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"auth0\" {}\n\nresource \"auth0_global_client\" \"global\" {\n    // Auth0 Universal Login - Custom Login Page\n    custom_login_page_on = true\n    custom_login_page = <<PAGE\n<html>\n    <head><title>My Custom Login Page</title></head>\n    <body>\n        I should probably have a login form here\n    </body>\n</html>\nPAGE\n    callbacks = [ \"http://somehostname.com/a/callback\" ]\n}\n\n// Generally should never be used as it is non-expiring access token to every part of your auth0 tenant\noutput \"auth0_global_client_id\" {\n    value = auth0_global_client.global.client_id\n}\n\noutput \"auth0_global_client_secret\" {\n    value = auth0_global_client.global.client_secret\n    sensitive = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alexkappa__terraform-provider-auth0__example__global_client__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"null_resource\" \"previous\" {}\n\nresource \"time_sleep\" \"wait_30_seconds\" {\n  depends_on = [null_resource.previous]\n\n  create_duration = \"30s\"\n}\n\nresource \"null_resource\" \"next\" {\n  depends_on = [time_sleep.wait_30_seconds]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__setup-terraform__.github__workflows__data__delay__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"private_key_path\" {\n  description = \"Enter the path to the SSH Private Key to run provisioner.\"\n  default = \"~/.ssh/id_rsa\"\n}\n\nvariable \"aws_amis\" {\n  default = {\n    eu-central-1 = \"ami-060cde69\"\n  }\n}\n\nvariable \"disk_size\" {\n  default = 8\n}\n\nvariable \"count\" {\n  default = 1\n}\n\nvariable \"group_name\" {\n  description = \"Group name becomes the base of the hostname of the instance\"\n}\n\nvariable \"aws_region\" {\n  description = \"AWS region to launch servers.\"\n  default     = \"eu-central-1\"\n}\n\nvariable \"instance_type\" {\n  description = \"AWS region to launch servers.\"\n  default     = \"t2.small\"\n}\n\nvariable \"subnet_id\" {\n  description = \"ID of the AWS VPC subnet to use\"\n}\n\nvariable \"key_pair_id\" {\n  description = \"ID of the keypair to use for SSH\"\n}\n\nvariable \"security_group_id\" {\n  description = \"ID of the VPC security group to use for network\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/fredsted__terraform__instance__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  module_version = \"v6.0.0\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform-azurerm-caf-enterprise-scale__locals.version.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Terraform Block\nterraform {\n  required_version = \"~> 0.14\" # which means any version equal & above 0.14 like 0.15, 0.16 etc and < 1.xx\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 3.0\"\n    }\n  }\n}\n\n# Provider Block\nprovider \"aws\" {\n  region  = var.aws_region\n}\n/*\nNote-1:  AWS Credentials Profile (profile = \"default\") configured on your local desktop terminal  \n$HOME/.aws/credentials\n*/\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-cloud-demo1__c1-versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"name\" {\n  description = \"Name to be used on all the resources as identifier\"\n  default     = \"\"\n}\n\nvariable \"cidr\" {\n  description = \"The CIDR block for the VPC\"\n  default     = \"\"\n}\n\nvariable \"instance_tenancy\" {\n  description = \"A tenancy option for instances launched into the VPC\"\n  default     = \"default\"\n}\n\nvariable \"public_subnets\" {\n  description = \"A list of public subnets inside the VPC.\"\n  default     = []\n}\n\nvariable \"private_subnets\" {\n  description = \"A list of private subnets inside the VPC.\"\n  default     = []\n}\n\nvariable \"database_subnets\" {\n  type        = \"list\"\n  description = \"A list of database subnets\"\n  default     = []\n}\n\nvariable \"create_database_subnet_group\" {\n  description = \"Controls, if should database subnet group be created.\"\n  default     = true\n}\n\nvariable \"elasticache_subnets\" {\n  type        = \"list\"\n  description = \"A list of elasticache subnets\"\n  default     = []\n}\n\nvariable \"azs\" {\n  description = \"A list of Availability zones in the region\"\n  default     = []\n}\n\nvariable \"enable_dns_hostnames\" {\n  description = \"should be true if you want to use private DNS within the VPC\"\n  default     = false\n}\n\nvariable \"enable_dns_support\" {\n  description = \"should be true if you want to use private DNS within the VPC\"\n  default     = false\n}\n\nvariable \"enable_classiclink\" {\n  description = \"should be true if you want to use ClassicLink within the VPC\"\n  default     = false\n}\n\nvariable \"enable_classiclink_dns_support\" {\n  description = \"should be true if you want to use private DNS within the classiclinks\"\n  default     = false\n}\n\nvariable \"enable_nat_gateway\" {\n  description = \"should be true if you want to provision NAT Gateways for each of your private networks\"\n  default     = false\n}\n\nvariable \"single_nat_gateway\" {\n  description = \"should be true if you want to provision a single shared NAT Gateway across all of your private networks\"\n  default     = false\n}\n\nvariable \"enable_s3_endpoint\" {\n  description = \"should be true if you want to provision an S3 endpoint to the VPC\"\n  default     = false\n}\n\nvariable \"enable_dynamodb_endpoint\" {\n  description = \"should be true if you want to provision an DynamoDB endpoint to the VPC\"\n  default     = false\n}\n\nvariable \"map_public_ip_on_launch\" {\n  description = \"should be false if you do not want to auto-assign public IP on launch\"\n  default     = true\n}\n\nvariable \"private_propagating_vgws\" {\n  description = \"A list of VGWs the private route table should propagate.\"\n  default     = []\n}\n\nvariable \"public_propagating_vgws\" {\n  description = \"A list of VGWs the public route table should propagate.\"\n  default     = []\n}\n\nvariable \"tags\" {\n  description = \"A map of tags to add to all resources\"\n  default     = {}\n}\n\nvariable \"public_subnet_tags\" {\n  description = \"Additional tags for the public subnets\"\n  default     = {}\n}\n\nvariable \"private_subnet_tags\" {\n  description = \"Additional tags for the public subnets\"\n  default     = {}\n}\n\nvariable \"database_subnet_tags\" {\n  description = \"Additional tags for the database subnets\"\n  default     = {}\n}\n\nvariable \"elasticache_subnet_tags\" {\n  description = \"Additional tags for the elasticache subnets\"\n  default     = {}\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-community-modules__tf_aws_vpc__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__terraform__copilot-course__2-code-suggestions__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"${var.region}\"\n}\n\nterraform {\n   backend \"s3\" {\n   bucket = \"rc-tf-remote-state-bucket\"\n   region = \"us-east-1\"\n  }\n}\n\nresource \"aws_s3_bucket\" \"tf-root-module-bucket\" {\n  bucket = \"${var.s3_bucket_name}\"\n  acl = \"private\"\n  region = \"${var.s3_bucket_region}\"\n  \n  versioning {\n    enabled = true\n  }\n  \n  tags = {\n    Name        = \"${var.s3_bucket_name}\"\n    Environment = \"${var.tag_env}\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_3__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_3__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_3__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_3__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_3__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_3__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jessewgibbs__terraform__exercise_3__main.tf", "start_line": 12}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_role\" \"aft_states\" {\n  name               = \"aft-account-provisioning-customizations-role\"\n  assume_role_policy = templatefile(\"${path.module}/iam/trust-policies/states.tpl\", { none = \"none\" })\n}\n\nresource \"aws_iam_role_policy\" \"aft_states\" {\n  name = \"aft-account-provisioning-customizations-policy\"\n  role = aws_iam_role.aft_states.id\n\n  policy = templatefile(\"${path.module}/iam/role-policies/iam-aft-states.tpl\", {\n    account_provisioning_customizations_sfn_arn = aws_sfn_state_machine.aft_account_provisioning_customizations.arn\n  })\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-provisioning-customizations__terraform__iam.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"bucket_domain_name\" {\n  value       = local.enabled ? join(\"\", aws_s3_bucket.default[*].bucket_domain_name) : \"\"\n  description = \"FQDN of bucket\"\n}\n\noutput \"bucket_regional_domain_name\" {\n  value       = local.enabled ? join(\"\", aws_s3_bucket.default[*].bucket_regional_domain_name) : \"\"\n  description = \"The bucket region-specific domain name\"\n}\n\noutput \"bucket_website_domain\" {\n  value       = join(\"\", aws_s3_bucket_website_configuration.default[*].website_domain, aws_s3_bucket_website_configuration.redirect[*].website_domain)\n  description = \"The bucket website domain, if website is enabled\"\n}\n\noutput \"bucket_website_endpoint\" {\n  value       = join(\"\", aws_s3_bucket_website_configuration.default[*].website_endpoint, aws_s3_bucket_website_configuration.redirect[*].website_endpoint)\n  description = \"The bucket website endpoint, if website is enabled\"\n}\n\noutput \"bucket_id\" {\n  value       = local.enabled ? local.bucket_id : \"\"\n  description = \"Bucket Name (aka ID)\"\n}\n\noutput \"bucket_arn\" {\n  value       = local.enabled ? join(\"\", aws_s3_bucket.default[*].arn) : \"\"\n  description = \"Bucket ARN\"\n}\n\noutput \"bucket_region\" {\n  value       = local.enabled ? join(\"\", aws_s3_bucket.default[*].region) : \"\"\n  description = \"Bucket region\"\n}\n\noutput \"enabled\" {\n  value       = local.enabled\n  description = \"Is module enabled\"\n}\n\noutput \"user_enabled\" {\n  value       = var.user_enabled\n  description = \"Is user creation enabled\"\n}\n\noutput \"user_name\" {\n  value       = module.s3_user.user_name\n  description = \"Normalized IAM user name\"\n}\n\noutput \"user_arn\" {\n  value       = module.s3_user.user_arn\n  description = \"The ARN assigned by AWS for the user\"\n}\n\noutput \"user_unique_id\" {\n  value       = module.s3_user.user_unique_id\n  description = \"The user unique ID assigned by AWS\"\n}\n\noutput \"replication_role_arn\" {\n  value       = local.enabled && local.replication_enabled ? join(\"\", aws_iam_role.replication[*].arn) : \"\"\n  description = \"The ARN of the replication IAM Role\"\n}\n\noutput \"access_key_id\" {\n  sensitive   = true\n  value       = module.s3_user.access_key_id\n  description = <<-EOT\n    The access key ID, if `var.user_enabled && var.access_key_enabled`.\n    While sensitive, it does not need to be kept secret, so this is output regardless of `var.store_access_key_in_ssm`.\n    EOT\n}\n\noutput \"secret_access_key\" {\n  sensitive   = true\n  value       = module.s3_user.secret_access_key\n  description = <<-EOT\n    The secret access key will be output if created and not stored in SSM. However, the secret access key, if created,\n    will be written to the Terraform state file unencrypted, regardless of any other settings.\n    See the [Terraform documentation](https://www.terraform.io/docs/state/sensitive-data.html) for more details.\n    EOT\n}\n\noutput \"access_key_id_ssm_path\" {\n  value       = module.s3_user.access_key_id_ssm_path\n  description = \"The SSM Path under which the S3 User's access key ID is stored\"\n}\n\noutput \"secret_access_key_ssm_path\" {\n  value       = module.s3_user.secret_access_key_ssm_path\n  description = \"The SSM Path under which the S3 User's secret access key is stored\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-s3-bucket__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_policy\" \"privesc-sageMakerCreateNotebookPassRole-policy\" {\n  name        = \"privesc-sageMakerCreateNotebookPassRole-policy\"\n  path        = \"/\"\n  description = \"Allows privesc via sagemakerCreateNotebook\"\n\n  # Terraform's \"jsonencode\" function converts a\n  # Terraform expression result to valid JSON syntax.\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect   = \"Allow\"\n        Action = [\n          \"sagemaker:CreateNotebookInstance\",          \n          \"sagemaker:CreatePresignedNotebookInstanceUrl\",\n          \"sagemaker:ListNotebookInstances\",\n          \"sagemaker:DescribeNotebookInstance\",\n          \"sagemaker:StopNotebookInstance\",\n          \"sagemaker:DeleteNotebookInstance\",\n          \"iam:PassRole\",\n          \"iam:ListRoles\"          \n        ]\n        Resource = \"*\"\n      },\n    ]\n  })\n}\n\n\n\nresource \"aws_iam_role\" \"privesc-sageMakerCreateNotebookPassRole-role\" {\n  name                = \"privesc-sageMakerCreateNotebookPassRole-role\"\n  assume_role_policy  = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Sid    = \"\"\n        Principal = {\n          AWS = var.aws_assume_role_arn\n        }\n      },\n    ]\n  })\n}\n\n\nresource \"aws_iam_user\" \"privesc-sageMakerCreateNotebookPassRole-user\" {\n  name = \"privesc-sageMakerCreateNotebookPassRole-user\"\n  path = \"/\"\n}\n\nresource \"aws_iam_access_key\" \"privesc-sageMakerCreateNotebookPassRole-user\" {\n  user = aws_iam_user.privesc-sageMakerCreateNotebookPassRole-user.name\n}\n\n\n\nresource \"aws_iam_user_policy_attachment\" \"privesc-sageMakerCreateNotebookPassRole-user-attach-policy\" {\n  user       = aws_iam_user.privesc-sageMakerCreateNotebookPassRole-user.name\n  policy_arn = aws_iam_policy.privesc-sageMakerCreateNotebookPassRole-policy.arn\n}\n\n\nresource \"aws_iam_role_policy_attachment\" \"privesc-sageMakerCreateNotebookPassRole-role-attach-policy\" {\n  role       = aws_iam_role.privesc-sageMakerCreateNotebookPassRole-role.name\n  policy_arn = aws_iam_policy.privesc-sageMakerCreateNotebookPassRole-policy.arn\n\n}  \n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-sageMakerCreateNotebookPassRole.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_289", "severity": "HIGH", "message": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-sageMakerCreateNotebookPassRole.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-sageMakerCreateNotebookPassRole.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-sageMakerCreateNotebookPassRole.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-sageMakerCreateNotebookPassRole.tf", "start_line": 49}, {"tool": "checkov", "rule_id": "CKV_AWS_40", "severity": "HIGH", "message": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-sageMakerCreateNotebookPassRole.tf", "start_line": 60}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__amazon-ecs-fullstack-app-terraform__Infrastructure__Modules__CodePipeline__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n\tregion = \"us-east-1\"\n}\n\nresource \"aws_instance\" \"ansible-test\" {\n\tami = \"ami-408c7f28\"\n\tinstance_type = \"t1.micro\"\n\n\tprovisioner \"ansible\" {\n\t\tconnection {\n\t\t\tuser = \"ubuntu\"\n\t\t}\n\n\t\tplaybook = \"playbook.yml\"\n\t\tplays = [\"terraform\"]\n\t\thosts = [\"all\"]\n\t\tgroups = [\"terraform\"]\n\t\textra_vars = {\n\t\t\t\"extra_var\": \"terraform\"\t\n\t\t}\n\t}\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jonmorehouse__terraform-provisioner-ansible__example__example.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jonmorehouse__terraform-provisioner-ansible__example__example.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jonmorehouse__terraform-provisioner-ansible__example__example.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jonmorehouse__terraform-provisioner-ansible__example__example.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jonmorehouse__terraform-provisioner-ansible__example__example.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jonmorehouse__terraform-provisioner-ansible__example__example.tf", "start_line": 5}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_ssm_document\" \"snow_agent_automation\" {\n  name          = \"Snowsoft_Agent_Installation_Automation\"\n  document_type = \"Automation\"\n\n  content = \"${file(\"snow_soft_agent_installation_automation.json\")}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tensult__terraform__aws__agent-install__automation-documents.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"tencentcloud_images\" \"example\" {\n  image_type = [\"PUBLIC_IMAGE\"]\n  os_name    = \"TencentOS Server 3.2 (Final)\"\n}\n\nresource \"tencentcloud_as_scaling_config\" \"example\" {\n  configuration_name = \"example-launch-configuration\"\n  image_id           = data.tencentcloud_images.example.images.0.image_id\n  instance_types     = [\"SA1.SMALL1\"]\n  project_id         = 0\n  system_disk_type   = \"CLOUD_PREMIUM\"\n  system_disk_size   = \"50\"\n\n  data_disk {\n    disk_type = \"CLOUD_PREMIUM\"\n    disk_size = 50\n  }\n\n  internet_charge_type       = \"TRAFFIC_POSTPAID_BY_HOUR\"\n  internet_max_bandwidth_out = 10\n  public_ip_assigned         = true\n  password                   = \"Test@123#\"\n  enhanced_security_service  = false\n  enhanced_monitor_service   = false\n  user_data                  = \"dGVzdA==\"\n\n  instance_tags = {\n    tag = \"example\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tencentcloudstack__terraform-provider-tencentcloud__examples__tencentcloud-as__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"auth0\" {}\n\nresource \"auth0_resource_server\" \"my_resource_server\" {\n  name = \"My Resource Server (Managed by Terraform)\"\n  identifier = \"my-resource-server-identifier\"\n  signing_alg = \"RS256\"\n  token_lifetime = 86400\n  skip_consent_for_verifiable_first_party_clients = true\n\n  enforce_policies = true\n\n  scopes {\n    value = \"read:something\"\n    description = \"read something\"\n  }\n}\n\nresource \"auth0_user\" \"my_user\" {\n  connection_name = \"Username-Password-Authentication\"\n  user_id = \"auth0|1234567890\"\n  email = \"test@test.com\"\n  password = \"passpass$12$12\"\n  nickname = \"testnick\"\n  username = \"testnick\"\n  roles = [ auth0_role.my_role.id ]\n}\n\nresource \"auth0_role\" \"my_role\" {\n  name = \"My Role - (Managed by Terraform)\"\n  description = \"Role Description...\"\n\n  permissions {\n    resource_server_identifier = auth0_resource_server.my_resource_server.identifier\n    name = \"read:something\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alexkappa__terraform-provider-auth0__example__role__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Variables for AWS infrastructure module\n\n// TODO - use null defaults\n\n# Required\nvariable \"aws_access_key\" {\n  type        = string\n  description = \"AWS access key used to create infrastructure\"\n}\n\n# Required\nvariable \"aws_secret_key\" {\n  type        = string\n  description = \"AWS secret key used to create AWS infrastructure\"\n}\n\nvariable \"aws_session_token\" {\n  type        = string\n  description = \"AWS session token used to create AWS infrastructure\"\n  default     = \"\"\n}\n\nvariable \"aws_region\" {\n  type        = string\n  description = \"AWS region used for all resources\"\n  default     = \"us-east-1\"\n}\n\nvariable \"aws_zone\" {\n  type        = string\n  description = \"AWS zone used for all resources\"\n  default     = \"us-east-1b\"\n}\n\nvariable \"prefix\" {\n  type        = string\n  description = \"Prefix added to names of all resources\"\n  default     = \"quickstart\"\n}\n\nvariable \"instance_type\" {\n  type        = string\n  description = \"Instance type used for all EC2 instances\"\n  default     = \"t3a.medium\"\n}\n\nvariable \"windows_instance_type\" {\n  type        = string\n  description = \"Instance type used for all EC2 windows instances\"\n  default     = \"t3a.large\"\n}\n\nvariable \"rancher_kubernetes_version\" {\n  type        = string\n  description = \"Kubernetes version to use for Rancher server cluster\"\n  default     = \"v1.24.14+k3s1\"\n}\n\nvariable \"workload_kubernetes_version\" {\n  type        = string\n  description = \"Kubernetes version to use for managed workload cluster\"\n  default     = \"v1.24.14+rke2r1\"\n}\n\nvariable \"cert_manager_version\" {\n  type        = string\n  description = \"Version of cert-manager to install alongside Rancher (format: 0.0.0)\"\n  default     = \"1.11.0\"\n}\n\nvariable \"rancher_version\" {\n  type        = string\n  description = \"Rancher server version (format: v0.0.0)\"\n  default     = \"2.7.9\"\n}\n\nvariable \"rancher_helm_repository\" {\n  type        = string\n  description = \"The helm repository, where the Rancher helm chart is installed from\"\n  default     = \"https://releases.rancher.com/server-charts/latest\"\n}\n\n# Required\nvariable \"rancher_server_admin_password\" {\n  type        = string\n  description = \"Admin password to use for Rancher server bootstrap, min. 12 characters\"\n}\n\n# Required\nvariable \"add_windows_node\" {\n  type        = bool\n  description = \"Add a windows node to the workload cluster\"\n  default     = false\n}\n\n# Local variables used to reduce repetition\nlocals {\n  node_username = \"ec2-user\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__quickstart__rancher__aws__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"dev_cluster\" {\n  source = \"./cluster\"\n\n  cluster_name = \"dev\"\n}\n\nmodule \"staging_cluster\" {\n  source = \"./cluster\"\n\n  cluster_name = \"staging\"\n}\n\nmodule \"production_cluster\" {\n  source = \"./cluster\"\n\n  cluster_name = \"production\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__05_terraform_env_module__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"kubernetes\" {\n  host                   = var.cluster_endpoint\n  cluster_ca_certificate = base64decode(var.cluster_ca_cert)\n  exec {\n    api_version = \"client.authentication.k8s.io/v1beta1\"\n    args        = [\"eks\", \"get-token\", \"--cluster-name\", var.cluster_name]\n    command     = \"aws\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-kubernetes__examples__example_5.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  enabled = module.this.enabled\n\n  use_ipv6 = var.kubernetes_network_ipv6_enabled\n\n  eks_cluster_id = one(aws_eks_cluster.default[*].id)\n\n  cluster_encryption_config = {\n    resources = var.cluster_encryption_config_resources\n\n    provider_key_arn = local.enabled && var.cluster_encryption_config_enabled && var.cluster_encryption_config_kms_key_id == \"\" ? (\n      one(aws_kms_key.cluster[*].arn)\n    ) : var.cluster_encryption_config_kms_key_id\n  }\n\n  cloudwatch_log_group_name = \"/aws/eks/${module.label.id}/cluster\"\n}\n\nmodule \"label\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.25.0\"\n\n  attributes = var.cluster_attributes\n\n  context = module.this.context\n}\n\ndata \"aws_partition\" \"current\" {\n  count = local.enabled ? 1 : 0\n}\n\nresource \"aws_cloudwatch_log_group\" \"default\" {\n  count             = local.enabled && length(var.enabled_cluster_log_types) > 0 ? 1 : 0\n  name              = local.cloudwatch_log_group_name\n  retention_in_days = var.cluster_log_retention_period\n  kms_key_id        = var.cloudwatch_log_group_kms_key_id\n  tags              = module.label.tags\n  log_group_class   = var.cloudwatch_log_group_class\n}\n\nresource \"aws_kms_key\" \"cluster\" {\n  count                   = local.enabled && var.cluster_encryption_config_enabled && var.cluster_encryption_config_kms_key_id == \"\" ? 1 : 0\n  description             = \"EKS Cluster ${module.label.id} Encryption Config KMS Key\"\n  enable_key_rotation     = var.cluster_encryption_config_kms_key_enable_key_rotation\n  deletion_window_in_days = var.cluster_encryption_config_kms_key_deletion_window_in_days\n  policy                  = var.cluster_encryption_config_kms_key_policy\n  tags                    = module.label.tags\n}\n\nresource \"aws_kms_alias\" \"cluster\" {\n  count         = local.enabled && var.cluster_encryption_config_enabled && var.cluster_encryption_config_kms_key_id == \"\" ? 1 : 0\n  name          = format(\"alias/%v\", module.label.id)\n  target_key_id = one(aws_kms_key.cluster[*].key_id)\n}\n\nresource \"aws_eks_cluster\" \"default\" {\n  #bridgecrew:skip=BC_AWS_KUBERNETES_1:Allow permissive security group for public access, difficult to restrict without a VPN\n  #bridgecrew:skip=BC_AWS_KUBERNETES_4:Let user decide on control plane logging, not necessary in non-production environments\n  count                         = local.enabled ? 1 : 0\n  name                          = module.label.id\n  tags                          = module.label.tags\n  role_arn                      = local.eks_service_role_arn\n  version                       = var.kubernetes_version\n  enabled_cluster_log_types     = var.enabled_cluster_log_types\n  bootstrap_self_managed_addons = var.bootstrap_self_managed_addons_enabled\n\n  access_config {\n    authentication_mode                         = var.access_config.authentication_mode\n    bootstrap_cluster_creator_admin_permissions = var.access_config.bootstrap_cluster_creator_admin_permissions\n  }\n\n  lifecycle {\n    # bootstrap_cluster_creator_admin_permissions is documented as only applying\n    # to the initial creation of the cluster, and being unreliable afterward,\n    # so we want to ignore it except at cluster creation time.\n    ignore_changes = [access_config[0].bootstrap_cluster_creator_admin_permissions]\n  }\n\n  dynamic \"encryption_config\" {\n    #bridgecrew:skip=BC_AWS_KUBERNETES_3:Let user decide secrets encryption, mainly because changing this value requires completely destroying the cluster\n    for_each = var.cluster_encryption_config_enabled ? [local.cluster_encryption_config] : []\n    content {\n      resources = encryption_config.value.resources\n      provider {\n        key_arn = encryption_config.value.provider_key_arn\n      }\n    }\n  }\n\n  vpc_config {\n    security_group_ids      = var.associated_security_group_ids\n    subnet_ids              = var.subnet_ids\n    endpoint_private_access = var.endpoint_private_access\n    #bridgecrew:skip=BC_AWS_KUBERNETES_2:Let user decide on public access\n    endpoint_public_access = var.endpoint_public_access\n    public_access_cidrs    = var.public_access_cidrs\n  }\n\n  dynamic \"kubernetes_network_config\" {\n    for_each = local.use_ipv6 ? [] : compact([var.service_ipv4_cidr])\n    content {\n      service_ipv4_cidr = kubernetes_network_config.value\n    }\n  }\n\n  dynamic \"kubernetes_network_config\" {\n    for_each = local.use_ipv6 ? [true] : []\n    content {\n      ip_family = \"ipv6\"\n    }\n  }\n\n  dynamic \"remote_network_config\" {\n    for_each = var.remote_network_config != null ? [var.remote_network_config] : []\n\n    content {\n      dynamic \"remote_node_networks\" {\n        for_each = [remote_network_config.value.remote_node_networks_cidrs]\n\n        content {\n          cidrs = remote_network_config.value.remote_node_networks_cidrs\n        }\n      }\n\n      dynamic \"remote_pod_networks\" {\n        for_each = remote_network_config.value.remote_pod_networks_cidrs != null ? [remote_network_config.value.remote_pod_networks_cidrs] : []\n\n        content {\n          cidrs = remote_network_config.value.remote_pod_networks_cidrs\n        }\n      }\n    }\n  }\n\n  dynamic \"upgrade_policy\" {\n    for_each = var.upgrade_policy != null ? [var.upgrade_policy] : []\n    content {\n      support_type = upgrade_policy.value.support_type\n    }\n  }\n\n  dynamic \"zonal_shift_config\" {\n    for_each = var.zonal_shift_config != null ? [var.zonal_shift_config] : []\n    content {\n      enabled = zonal_shift_config.value.enabled\n    }\n  }\n\n  depends_on = [\n    aws_iam_role.default,\n    aws_iam_role_policy_attachment.cluster_elb_service_role,\n    aws_iam_role_policy_attachment.amazon_eks_cluster_policy,\n    aws_iam_role_policy_attachment.amazon_eks_service_policy,\n    aws_kms_alias.cluster,\n    aws_cloudwatch_log_group.default,\n    var.associated_security_group_ids,\n    var.cluster_depends_on,\n    var.subnet_ids,\n  ]\n}\n\n# Enabling IAM Roles for Service Accounts in Kubernetes cluster\n#\n# From official docs:\n# The IAM roles for service accounts feature is available on new Amazon EKS Kubernetes version 1.14 clusters,\n# and clusters that were updated to versions 1.14 or 1.13 on or after September 3rd, 2019.\n#\n# https://docs.aws.amazon.com/eks/latest/userguide/enable-iam-roles-for-service-accounts.html\n# https://medium.com/@marcincuber/amazon-eks-with-oidc-provider-iam-roles-for-kubernetes-services-accounts-59015d15cb0c\n#\n\ndata \"tls_certificate\" \"cluster\" {\n  count = local.enabled && var.oidc_provider_enabled ? 1 : 0\n  url   = one(aws_eks_cluster.default[*].identity[0].oidc[0].issuer)\n}\n\nresource \"aws_iam_openid_connect_provider\" \"default\" {\n  count = local.enabled && var.oidc_provider_enabled ? 1 : 0\n  url   = one(aws_eks_cluster.default[*].identity[0].oidc[0].issuer)\n  tags  = module.label.tags\n\n  client_id_list  = [\"sts.amazonaws.com\"]\n  thumbprint_list = [one(data.tls_certificate.cluster[*].certificates[0].sha1_fingerprint)]\n}\n\nresource \"aws_eks_addon\" \"cluster\" {\n  for_each = local.enabled ? {\n    for addon in var.addons :\n    addon.addon_name => addon\n  } : {}\n\n  cluster_name                = one(aws_eks_cluster.default[*].name)\n  addon_name                  = each.key\n  addon_version               = lookup(each.value, \"addon_version\", null)\n  configuration_values        = lookup(each.value, \"configuration_values\", null)\n  resolve_conflicts_on_create = lookup(each.value, \"resolve_conflicts_on_create\", try(replace(each.value.resolve_conflicts, \"PRESERVE\", \"NONE\"), null))\n  resolve_conflicts_on_update = lookup(each.value, \"resolve_conflicts_on_update\", lookup(each.value, \"resolve_conflicts\", null))\n  service_account_role_arn    = lookup(each.value, \"service_account_role_arn\", null)\n\n  dynamic \"pod_identity_association\" {\n    for_each = merge({}, lookup(each.value, \"pod_identity_association\", {}))\n\n    content {\n      service_account = pod_identity_association.key\n      role_arn        = pod_identity_association.value\n    }\n  }\n\n  tags = merge(module.label.tags, each.value.additional_tags)\n\n  depends_on = [\n    var.addons_depends_on,\n    aws_eks_cluster.default,\n    # OIDC provider is prerequisite for some addons. See, for example,\n    # https://docs.aws.amazon.com/eks/latest/userguide/managing-vpc-cni.html\n    aws_iam_openid_connect_provider.default,\n  ]\n\n  timeouts {\n    create = each.value.create_timeout\n    update = each.value.update_timeout\n    delete = each.value.delete_timeout\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-eks-cluster__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-eks-cluster__main.tf", "start_line": 19}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"AWS_REGION\" {\n    default = \"us-west-2\"\n}\n\nvariable \"AMI\" {\n    type = map(string)\n\n    default = {\n        us-west-2 = \"ami-0d593311db5abb72b\"\n        us-east-1 = \"ami-0c2a1acae6667e438\"\n    }\n}\n\nvariable \"PUBLIC_KEY_PATH\" {\n    default = \"/Users/praveensingampalli/Documents/BOOTCAMP2_FINAL/Terraform_learning_demo/Terraform_learning_demo/oregon-region-key-pair.pub\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/praveen1994dec__Terraform_wc__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_s3_bucket\" \"my_bucket\" {\n    bucket = var.bucket_name\n    tags = {\n        Name = var.bucket_name\n    }\n}\n\nresource \"aws_s3_bucket\" \"my_state_bucket\" {\n    bucket = var.state_bucket_name\n    tags = {\n        Name = var.state_bucket_name\n    }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_related__s3.tf", "start_line": 8}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\n# The following configuration uses a provider which provisions [fake] resources\n# to a fictitious cloud vendor called \"Fake Web Services\". Configuration for\n# the fakewebservices provider can be found in provider.tf.\n#\n# After running the setup script (./scripts/setup.sh), feel free to change these\n# resources and 'terraform apply' as much as you'd like! These resources are\n# purely for demonstration and created in HCP Terraform, scoped to your HCP Terraform\n# user account.\n#\n# To review the provider and documentation for the available resources and\n# schemas, see: https://registry.terraform.io/providers/hashicorp/fakewebservices\n#\n# If you're looking for the configuration for the remote backend, you can find that\n# in backend.tf.\n\n\nresource \"fakewebservices_vpc\" \"primary_vpc\" {\n  name       = \"Primary VPC\"\n  cidr_block = \"0.0.0.0/1\"\n}\n\nresource \"fakewebservices_server\" \"servers\" {\n  count = 2\n\n  name = \"Server ${count.index + 1}\"\n  type = \"t2.micro\"\n  vpc  = fakewebservices_vpc.primary_vpc.name\n}\n\nresource \"fakewebservices_load_balancer\" \"primary_lb\" {\n  name    = \"Primary Load Balancer\"\n  servers = fakewebservices_server.servers[*].name\n}\n\nresource \"fakewebservices_database\" \"prod_db\" {\n  name = \"Production DB\"\n  size = 256\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__tfc-getting-started__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"appname\" {\n  type = string\n  description = \"Application name. Use only lowercase letters and numbers\"\n  default = \"starterterraform\"\n}\n\nvariable \"environment\" {\n  type    = string\n  description = \"Environment name, e.g. 'dev' or 'stage'\"\n  default = \"dev\"\n}\n\nvariable \"location\" {\n  type    = string\n  description = \"Azure region where to create resources.\"\n  default = \"North Europe\"\n}\n\nvariable \"department\" {\n  type    = string\n  description = \"A sample variable passed from the build pipeline and used to tag resources.\"\n  default = \"Engineering\"\n}\n\nvariable \"sql2password\" {\n  type    = string\n  description = \"A password for SQL Server #2\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/microsoft__terraform-azure-devops-starter__201-plan-apply-stages__terraform__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\n# The block below configures Terraform to use the 'remote' backend with HCP Terraform.\n# For more information, see https://www.terraform.io/docs/backends/types/remote.html\nterraform {\n  cloud {\n    organization = \"{{ORGANIZATION_NAME}}\"\n\n    workspaces {\n      name = \"{{WORKSPACE_NAME}}\"\n    }\n  }\n\n  required_version = \">= 1.1.2\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__tfc-getting-started__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"artifactory_item_properties\" \"my-repo-properties\" {\n  repo_key = \"my-generic-local\"\n  properties = {\n    \"key1\": [\"value1\"],\n    \"key2\": [\"value2\", \"value3\"]\n  }\n  is_recursive = true\n}\n\nresource \"artifactory_item_properties\" \"my-folder-properties\" {\n  repo_key = \"my-generic-local\"\n  item_path = \"folder/subfolder\"\n  properties = {\n    \"key1\": [\"value1\"],\n    \"key2\": [\"value2\", \"value3\"]\n  }\n  is_recursive = true\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jfrog__terraform-provider-artifactory__examples__resources__artifactory_item_properties__resource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"s3_bucket_name\" {\n  value       = aws_s3_bucket.terraform_state.id\n  description = \"The NAME of the S3 bucket\"\n}\n\noutput \"s3_bucket_arn\" {\n  value       = aws_s3_bucket.terraform_state.arn\n  description = \"The ARN of the S3 bucket\"\n}\n\noutput \"s3_bucket_region\" {\n  value       = aws_s3_bucket.terraform_state.region\n  description = \"The REGION of the S3 bucket\"\n}\n\noutput \"dynamodb_table_name\" {\n  value       = aws_dynamodb_table.terraform_lock.name\n  description = \"The ARN of the DynamoDB table\"\n}\n\noutput \"dynamodb_table_arn\" {\n  value       = aws_dynamodb_table.terraform_lock.arn\n  description = \"The ARN of the DynamoDB table\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__s3-backend__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_availability_zones\" \"available\" {}\nvariable \"aws_region\" {}\nvariable \"aws_access_key\" {}\nvariable \"aws_secret_key\" {}\nvariable \"aws_key_pair\" {}\n\nvariable \"blue_team_cidr\" {}\nvariable \"blue_team_az1_mgmt\" {}\nvariable \"blue_team_az2_mgmt\" {}\nvariable \"blue_team_az1_untrust\" {}\nvariable \"blue_team_az2_untrust\" {}\nvariable \"blue_team_az1_trust\" {}\nvariable \"blue_team_az2_trust\" {}\n\nvariable \"blue_team_server_ip\" {}\nvariable \"server_initscript_path\" {}\nvariable \"fw1_mgmt_ip\" {}\nvariable \"fw1_untrust_ip\" {}\nvariable \"fw1_trust_ip\" {}\nvariable \"content_bucket\" {}\n\nvariable \"red_team_cidr\" {}\nvariable \"red_team_ip\" {}\nvariable \"attacker_initscript_path\" {}\n\n#VMSeries 8.1 Bundle 2 Paygo \nvariable \"PANFWRegionMap\" {\n  type = \"map\"\n\n  default = {\n    \"ap-northeast-1\"  = \"ami-0c2df2ad98fa740f2\"\n    \"ap-south-1\"      = \"ami-0f03c2e41c35f4155\"\n    \"ap-southeast-1\"  = \"ami-0c18d932bcd6eb39f\"\n    \"ap-southeast-2\"  = \"ami-0b6f63cee6e82b6b1\"\n    \"ca-central-1\"    = \"ami-09ccdba2948398b45\"\n    \"eu-central-1\"    = \"ami-0cf748c2bf505e674\"\n    \"eu-west-1\"       = \"ami-02eec133b97eaa1e1\"\n    \"eu-west-2\"       = \"ami-0c06868bcef1d35ba\"\n    \"sa-east-1\"       = \"ami-08a812daea4ede4a2\"\n    \"us-east-1\"       = \"ami-07c7f3e5ce94b86cd\"\n    \"us-east-2\"       = \"ami-05025aa19e768421d\"\n    \"us-west-1\"       = \"ami-0ba71b23bb2d76fa1\"\n    \"us-west-2\"       = \"ami-074c89c1e945ede8a\"\n  }\n}\n\nvariable \"UbuntuRegionMap\" {\n  type = \"map\"\n\n  #Ubuntu Server 16.04 LTS (HVM)\n  default = {\n    \"ap-northeast-1\" = \"ami-0ad8925cfae263816\"\n    \"ap-south-1\" = \"ami-033405fef856aa050\"\n    \"ap-southeast-1\" = \"ami-090c5f444ba17b5e6\"\n    \"ap-southeast-2\" = \"ami-009dabce373407f47\"\n    \"ca-central-1\" = \"ami-0dba2e6f05a90be45\"\n    \"eu-central-1\" = \"ami-057320c356ed8a39a\"\n    \"eu-west-1\" = \"ami-00126411777531ca6\"\n    \"eu-west-2\" = \"ami-0d013c5896434b38a\"\n    \"sa-east-1\" = \"ami-0786f8c2dfa7e3230\"\n    \"us-east-1\" = \"ami-0857b0ef93a75300f\"\n    \"us-east-2\" = \"ami-0b6b93913be33d8f6\"\n    \"us-west-1\" = \"ami-0a1a02c21dbaf286d\"\n    \"us-west-2\" = \"ami-0db01fabda16f6445\"\n  }\n}\n\nvariable \"ip_blacklist\" {\n  type = \"list\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wwce__terraform__aws__Jenkins-sans-Panhandler__aws_vars.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nmodule \"child_a\" {\n  source  = \"example.com/foo/bar_a/baz\"\n  version = \">= 1.0.0\"\n}\n\nmodule \"child_b\" {\n  source = \"example.com/foo/bar_b/baz\"\n  version = \">= 1.0.0\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/camptocamp__terraboard__internal__terraform__configs__configload__testdata__already-installed__root.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/camptocamp__terraboard__internal__terraform__configs__configload__testdata__already-installed__root.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/camptocamp__terraboard__internal__terraform__configs__configload__testdata__already-installed__root.tf", "start_line": 7}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Gets all aws logs services\ndata \"datadog_aws_logs_services\" \"services\" {}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DataDog__terraform-provider-datadog__examples__data-sources__datadog_aws_logs_services__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 0.13\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \">= 4.0.0, < 5.0.0\"\n    }\n  }\n\n  backend \"s3\" {\n    region  = \"us-east-1\"\n    profile = \"\"\n    bucket  = \"\"\n    key     = \"dev.terraform.tfstate\"\n  }\n}\n\n# The AWS Profile to use\nvariable \"aws_profile\" {\n}\n\nprovider \"aws\" {\n  region  = var.region\n  profile = var.aws_profile\n}\n\n# output\n\n# Command to view the status of the Fargate service\noutput \"status\" {\n  value = \"fargate service info\"\n}\n\n# Command to deploy a new task definition to the service using Docker Compose\noutput \"deploy\" {\n  value = \"fargate service deploy -f docker-compose.yml\"\n}\n\n# Command to scale up cpu and memory\noutput \"scale_up\" {\n  value = \"fargate service update -h\"\n}\n\n# Command to scale out the number of tasks (container replicas)\noutput \"scale_out\" {\n  value = \"fargate service scale -h\"\n}\n\n# Command to set the AWS_PROFILE\noutput \"aws_profile\" {\n  value = var.aws_profile\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/turnerlabs__terraform-ecs-fargate__env__dev__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#----------------------------------------------------------\n#  Terraform - From Zero to Certified Professional\n#\n# Build WebServer during Bootstrap\n#\n# Made by Denis Astahov\n#----------------------------------------------------------\n\nprovider \"aws\" {\n  region = \"ca-central-1\"\n}\n\nresource \"aws_default_vpc\" \"default\" {} # This need to be added since AWS Provider v4.29+ to get VPC id\n\nresource \"aws_instance\" \"web\" {\n  ami                         = \"ami-0c9bfc21ac5bf10eb\" // Amazon Linux2\n  instance_type               = \"t3.micro\"\n  vpc_security_group_ids      = [aws_security_group.web.id]\n  user_data_replace_on_change = true   # This need to added!!!! \n  user_data                   = <<EOF\n#!/bin/bash\nyum -y update\nyum -y install httpd\nMYIP=`curl http://169.254.169.254/latest/meta-data/local-ipv4`\necho \"<h2>WebServer with PrivateIP: $MYIP</h2><br>Built by Terraform\" > /var/www/html/index.html\nservice httpd start\nchkconfig httpd on\nEOF\n  tags = {\n    Name  = \"WebServer Built by Terraform\"\n    Owner = \"Denis Astahov\"\n  }\n}\n\nresource \"aws_security_group\" \"web\" {\n  name        = \"WebServer-SG\"\n  description = \"Security Group for my WebServer\"\n  vpc_id      = aws_default_vpc.default.id # This need to be added since AWS Provider v4.29+ to set VPC id\n\n  ingress {\n    description = \"Allow port HTTP\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    description = \"Allow port HTTPS\"\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    description = \"Allow ALL ports\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name  = \"WebServer SG by Terraform\"\n    Owner = \"Denis Astahov\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-02__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_148", "severity": "HIGH", "message": "Ensure no default VPC is planned to be provisioned", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-02__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-02__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-02__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-02__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-02__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-02__main.tf", "start_line": 35}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-02__main.tf", "start_line": 35}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-02__main.tf", "start_line": 15}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"ec2\" {\n  ami                    = data.aws_ami.ami.image_id\n  instance_type          = \"t2.2xlarge\"\n  key_name               = var.key-name\n  subnet_id              = aws_subnet.public-subnet.id\n  vpc_security_group_ids = [aws_security_group.security-group.id]\n  iam_instance_profile   = aws_iam_instance_profile.instance-profile.name\n  root_block_device {\n    volume_size = 30\n  }\n  user_data = templatefile(\"./tools-install.sh\", {})\n\n  tags = {\n    Name = var.instance-name\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__ec2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__ec2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__ec2.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n* Copyright 2024 Google LLC\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*     http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\nvariable \"project_id\" {\n  type = string\n}\n\nvariable \"region\" {\n  description = \"Location for load balancer and Cloud Run resources\"\n  type        = string\n  default     = \"us-central1\"\n}\n\nvariable \"use_lb\" {\n  description = \"Run load balancer on HTTPS and provision managed certificate with provided `domain`.\"\n  type        = bool\n  default     = true\n}\n\nvariable \"domain\" {\n  description = \"Domain name to run the load balancer on. Used if `ssl` is `true`.\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"initial_container_image\" {\n  description = \"Container image to use for the Cloud Run service hosting Creative Studio. Because infra is deployed through Terraform this defaults to placeholder image; however, if you are applying Terraform template post initial deployment, use the latest built image to avoid reverting back to the placeholder.\"\n  type        = string\n  default     = \"us-docker.pkg.dev/cloudrun/container/placeholder\"\n}\n\nvariable \"model_id\" {\n  description = \"Veo model ID to use for video generation\"\n  type        = string\n  default     = \"gemini-2.5-flash\"\n}\n\nvariable \"veo_model_id\" {\n  description = \"Veo model ID to use for video generation\"\n  type        = string\n  default     = \"veo-3.0-generate-001\"\n}\n\nvariable \"veo_exp_model_id\" {\n  description = \"Experimental Veo model ID to use for video generation\"\n  type        = string\n  default     = \"veo-3.0-generate-preview\"\n}\n\nvariable \"lyria_model_id\" {\n  description = \"Lyria model ID to use for audio generation\"\n  type        = string\n  default     = \"lyria-002\"\n}\n\nvariable \"edit_images_enabled\" {\n  description = \"Feature flag for Edit Images feature\"\n  type        = bool\n  default     = true\n}\n\nvariable \"enable_data_deletion\" {\n  description = \"Whether to allow force destroy on storage buckets. Should be false in production.\"\n  type        = bool\n  default     = false # Default to safe\n}\n\nvariable \"initial_user\" {\n  description = \"Email address of initial user that will be granted access to Creative Studio in IAP\"\n  type        = string\n  nullable    = true\n  default     = null\n}\n\nvariable \"allow_local_domain_cors_requests\" {\n  description = \"Whether to allow local domain requests to the assets GCS bucket\"\n  type        = bool\n  default     = false\n}\n\nvariable \"sleep_time\" {\n  description = \"Amount of time to wait post service API enablement to allow for eventual consistency to trickly through GCP.\"\n  type        = number\n  default     = 45\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__vertex-ai-creative-studio__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"policy_id\" {\n  value = newrelic_alert_policy.golden_signal_policy.id\n}\n\noutput \"response_time_condition_id\" {\n  value = newrelic_nrql_alert_condition.response_time_web.id\n}\n\noutput \"throughput_condition_id\" {\n  value = newrelic_nrql_alert_condition.throughput_web.id\n}\n\noutput \"error_percentage_condition_id\" {\n  value = newrelic_nrql_alert_condition.error_percentage.id\n}\n\noutput \"cpu_condition_id\" {\n  value = newrelic_nrql_alert_condition.high_cpu.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/newrelic__terraform-provider-newrelic__examples__modules__golden-signal-alerts-new__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.5.7\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \">= 6.22\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-alb__wrappers__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n    region = \"ap-south-1\"\n}\n\nresource \"aws_instance\" \"ec2-instance\" {\n#    ami = \"ami-041d6256ed0f2061c\"    # this AMI is specific to Mumbai region\n    ami = var.ami_id    # referring to ami_id variable\n#    instance_type = \"t2.micro\"\n    instance_type = var.instance_type  # referring to instance_type variable\n    vpc_security_group_ids = [aws_security_group.mysg.id]\n}\n\nresource \"aws_security_group\" \"mysg\" {\n    name = \"allow-ssh\"\n    description = \"Allow ssh traffic\"\n#    vpc_id = \"vpc-3345b25a\"   # VPC ID of my account's default vpc\n    vpc_id = var.vpc_id   # referring to vpc_id variable\n\n    ingress {\n        description = \"Allow inbound ssh traffic\"\n#        from_port = 22\n        from_port = var.port\n#        to_port = 22\n        to_port = var.port\n        protocol = \"tcp\"\n#        cidr_blocks = \"[0.0.0.0/0]\"\n        cidr_blocks = [var.cidr_block]\n    }\n\n    tags = {\n        name = \"allow_ssh\"\n    }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__module-main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__module-main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__module-main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__module-main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__module-main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__module-main.tf", "start_line": 5}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#\n# kms\n#\ndata \"aws_iam_policy_document\" \"demo-artifacts-kms-policy\" {\n  policy_id = \"key-default-1\"\n  statement {\n    sid    = \"Enable IAM User Permissions\"\n    effect = \"Allow\"\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"]\n    }\n    actions = [\n      \"kms:*\",\n    ]\n    resources = [\n      \"*\",\n    ]\n  }\n}\n\nresource \"aws_kms_key\" \"demo-artifacts\" {\n  description = \"kms key for demo artifacts\"\n  policy      = data.aws_iam_policy_document.demo-artifacts-kms-policy.json\n}\n\nresource \"aws_kms_alias\" \"demo-artifacts\" {\n  name          = \"alias/demo-artifacts\"\n  target_key_id = aws_kms_key.demo-artifacts.key_id\n}\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__kms.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_109", "severity": "HIGH", "message": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__kms.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_111", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__kms.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_356", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__kms.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_7", "severity": "HIGH", "message": "Ensure rotation for customer created CMKs is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__kms.tf", "start_line": 22}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_security_group\" \"jenkins-agent\" {\n  name        = \"jenkins-agent\"\n  description = \"Allow SSH inbound traffic from everywhere and all outbound traffic\"\n\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\n\nresource \"aws_instance\" \"example\" {\n  count = var.instance_count\n\n  ami           = var.ami_id\n  instance_type = var.instance_type\n  key_name      = var.key_name\n  vpc_security_group_ids = [aws_security_group.jenkins-agent.id]\n\n  tags = {\n    Name = \"${var.instance_name}-${count.index + 1}\"\n  }\n\n  subnet_id = element(var.subnet_ids, count.index % length(var.subnet_ids))\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__ec2__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__ec2__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__ec2__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__ec2__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__ec2__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__ec2__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__ec2__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__ec2__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__devops-projects__01-jenkins-setup__terraform__modules__ec2__main.tf", "start_line": 21}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"region\" {\n  default = \"us-east-1\"\n}\n\nvariable \"instance_type\" {\n  default = \"t2.large\"\n}\n\nvariable \"cluster_id\" {\n  default = \"rke\"\n}\n\nvariable \"docker_install_url\" {\n  default = \"https://releases.rancher.com/install-docker/19.03.sh\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__terraform-provider-rke__examples__aws_ec2__aws__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\n# single provider block\nprovider \"vault\" {}\n\nlocals {\n  # provide namespaces as a set\n  namespaces = toset(var.namespaces)\n}\n\nresource \"vault_namespace\" \"demo\" {\n  # leverage the for_each meta-argument\n  for_each = local.namespaces\n  path     = each.key\n}\n\nresource \"vault_mount\" \"demo\" {\n  for_each  = local.namespaces\n  namespace = vault_namespace.demo[each.key].path\n  path      = \"secretsv1\"\n  type      = \"kv\"\n  options = {\n    version = \"1\"\n  }\n}\n\nresource \"vault_generic_secret\" \"demo\" {\n  for_each = local.namespaces\n  # Support namespace at the level of the resource and data source\n  namespace = vault_mount.demo[each.key].namespace\n  path      = \"${vault_mount.demo[each.key].path}/secret\"\n  data_json = jsonencode(\n    {\n      \"baz\" = \"qux\"\n    }\n  )\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-vault__eval__namespace-enhancements__examples__basic__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region     = \"us-east-1\"\n  access_key = \"AKIAWIBQPDIZ4SHKBHWF\"\n  secret_key = \"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\"\n}\n\n\nmodule \"ec2-instance\" {\n  source  = \"terraform-aws-modules/ec2-instance/aws\"\n  version = \"5.2.1\"\n  name = \"single-instance\"\n\n  instance_type          = \"t2.micro\"\n  key_name               = \"terraform\"\n  monitoring             = true\n  vpc_security_group_ids = [\"sg-0cd39b66021e09f39\"]\n  subnet_id              = \"subnet-00ad507fea4b45014\"\n\n  tags = {\n    Terraform   = \"true\"\n    Environment = \"dev\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/telugudevopsguru__terraform__Module 11 - Terraform Modules__Terraform managed modules__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\ndata \"fastly_datacenters\" \"fastly\" {}\n\noutput \"fastly_datacenters_all\" {\n  value = data.fastly_datacenters.fastly\n}\n\noutput \"fastly_datacenters_filtered\" {\n  # get the shield code of \"TYO\" POP\n  value = one([for pop in data.fastly_datacenters.fastly.pops : pop.shield if pop[\"code\"] == \"TYO\"])\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/fastly__terraform-provider-fastly__examples__data-sources__datacenters.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\nregion = \"us-east-1\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TerraWeek__day04__backend_demo__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    libvirt = {\n      source = \"dmacvicar/libvirt\"\n    }\n  }\n}\n\nprovider \"libvirt\" {\n  uri = \"qemu:///system\"\n}\n\nresource \"libvirt_domain\" \"example\" {\n  name   = \"example-vm\"\n  memory = 2048\n  memory_unit   = \"MiB\"\n  vcpu   = 2\n  type   = \"kvm\"\n\n  os = {\n    type         = \"hvm\"\n    type_arch    = \"x86_64\"\n    type_machine = \"q35\"\n  }\n\n  devices = {\n    interfaces = [\n      # Network interface connected to default network\n      {\n        model = {\n          type = \"virtio\"\n        }\n        source = {\n          network = {\n            network = \"default\"\n          }\n        }\n      },\n      # Additional network interface on a specific network\n      {\n        model = {\n          type = \"virtio\"\n        }\n        source = {\n          network = {\n            network    = \"custom-network\"\n            port_group = \"web-servers\"\n          }\n        }\n      },\n      # Bridge interface\n      {\n        source = {\n          bridge = {\n            bridge = \"br0\"\n          }\n        }\n      }\n    ]\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/dmacvicar__terraform-provider-libvirt__examples__domain_with_network.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource-1: Azure Resource Group\nresource \"azurerm_resource_group\" \"myrg\" {\n  name = local.rg_name\n  location = var.resoure_group_location\n  tags = local.common_tags\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-cloud-azure-demo1__terraform-manifests__c4-resource-group.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-eks-blueprints__docs__v4-to-v5__example__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# SYNTAX TEST reindent-unchanged \"Terraform.sublime-syntax\"\n\nprovider \"name\" {\n  attr1 = {\n    key1 = {\n      key11 = {\n        key111 = 0\n        key112 = [\n          \"0\",\n          \"1\"\n        ]\n      },\n      key12 = [\n        0,\n        1,\n      ],\n      key13 = (\n        var.member\n        + var.other\n      )\n    }\n  }\n\n  attr2 = jsondecode(\n    {\n      \"key1\": {\n        \"key11\": [\n          0,\n          1\n        ],\n        \"key12\": {\n          \"key121\": \"value\",\n          \"key122\": 0\n        }\n      }\n    }\n  )\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/SublimeText__Terraform__tests__syntax_test_reindent.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"name\" {\n  description = \"RDS instance name\"\n}\n\nvariable \"engine\" {\n  description = \"Database engine: mysql, postgres, etc.\"\n  default     = \"postgres\"\n}\n\nvariable \"engine_version\" {\n  description = \"Database version\"\n  default     = \"9.6.1\"\n}\n\nvariable \"port\" {\n  description = \"Port for database to listen on\"\n  default     = 5432\n}\n\nvariable \"database\" {\n  description = \"The database name for the RDS instance (if not specified, `var.name` will be used)\"\n  default     = \"\"\n}\n\nvariable \"username\" {\n  description = \"The username for the RDS instance (if not specified, `var.name` will be used)\"\n  default     = \"\"\n}\n\nvariable \"password\" {\n  description = \"Postgres user password\"\n}\n\nvariable \"multi_az\" {\n  description = \"If true, database will be placed in multiple AZs for HA\"\n  default     = false\n}\n\nvariable \"backup_retention_period\" {\n  description = \"Backup retention, in days\"\n  default     = 5\n}\n\nvariable \"backup_window\" {\n  description = \"Time window for backups.\"\n  default     = \"00:00-01:00\"\n}\n\nvariable \"maintenance_window\" {\n  description = \"Time window for maintenance.\"\n  default     = \"Mon:01:00-Mon:02:00\"\n}\n\nvariable \"monitoring_interval\" {\n  description = \"Seconds between enhanced monitoring metric collection. 0 disables enhanced monitoring.\"\n  default     = \"0\"\n}\n\nvariable \"monitoring_role_arn\" {\n  description = \"The ARN for the IAM role that permits RDS to send enhanced monitoring metrics to CloudWatch Logs. Required if monitoring_interval > 0.\"\n  default     = \"\"\n}\n\nvariable \"apply_immediately\" {\n  description = \"If false, apply changes during maintenance window\"\n  default     = true\n}\n\nvariable \"allow_major_version_upgrade\" {\n  description = \"If true, major version upgrades are allowed\"\n  default     = false\n}\n\nvariable \"instance_class\" {\n  description = \"Underlying instance type\"\n  default     = \"db.t2.micro\"\n}\n\nvariable \"storage_type\" {\n  description = \"Storage type: standard, gp2, or io1\"\n  default     = \"gp2\"\n}\n\nvariable \"allocated_storage\" {\n  description = \"Disk size, in GB\"\n  default     = 10\n}\n\nvariable \"publicly_accessible\" {\n  description = \"If true, the RDS instance will be open to the internet\"\n  default     = false\n}\n\nvariable \"vpc_id\" {\n  description = \"The VPC ID to use\"\n}\n\nvariable \"ingress_allow_security_groups\" {\n  description = \"A list of security group IDs to allow traffic from\"\n  type        = \"list\"\n  default     = []\n}\n\nvariable \"ingress_allow_cidr_blocks\" {\n  description = \"A list of CIDR blocks to allow traffic from\"\n  type        = \"list\"\n  default     = []\n}\n\nvariable \"subnet_ids\" {\n  description = \"A list of subnet IDs\"\n  type        = \"list\"\n}\n\nresource \"aws_security_group\" \"main\" {\n  name        = \"${var.name}-rds\"\n  description = \"Allows traffic to RDS from other security groups\"\n  vpc_id      = \"${var.vpc_id}\"\n\n  ingress {\n    from_port       = \"${var.port}\"\n    to_port         = \"${var.port}\"\n    protocol        = \"TCP\"\n    security_groups = [\"${var.ingress_allow_security_groups}\"]\n  }\n\n  ingress {\n    from_port   = \"${var.port}\"\n    to_port     = \"${var.port}\"\n    protocol    = \"TCP\"\n    cidr_blocks = [\"${var.ingress_allow_cidr_blocks}\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = -1\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags {\n    Name = \"RDS (${var.name})\"\n  }\n}\n\nresource \"aws_db_subnet_group\" \"main\" {\n  name        = \"${var.name}\"\n  description = \"RDS subnet group\"\n  subnet_ids  = [\"${var.subnet_ids}\"]\n}\n\nresource \"aws_db_instance\" \"main\" {\n  identifier = \"${var.name}\"\n\n  # Database\n  engine                      = \"${var.engine}\"\n  engine_version              = \"${var.engine_version}\"\n  allow_major_version_upgrade = \"${var.allow_major_version_upgrade}\"\n  username                    = \"${coalesce(var.username, var.name)}\"\n  password                    = \"${var.password}\"\n  multi_az                    = \"${var.multi_az}\"\n  name                        = \"${coalesce(var.database, var.name)}\"\n\n  # Backups / maintenance\n  backup_retention_period   = \"${var.backup_retention_period}\"\n  backup_window             = \"${var.backup_window}\"\n  maintenance_window        = \"${var.maintenance_window}\"\n  monitoring_interval       = \"${var.monitoring_interval}\"\n  monitoring_role_arn       = \"${var.monitoring_role_arn}\"\n  apply_immediately         = \"${var.apply_immediately}\"\n  final_snapshot_identifier = \"${var.name}-finalsnapshot\"\n\n  # Hardware\n  instance_class    = \"${var.instance_class}\"\n  storage_type      = \"${var.storage_type}\"\n  allocated_storage = \"${var.allocated_storage}\"\n\n  # Network / security\n  db_subnet_group_name   = \"${aws_db_subnet_group.main.id}\"\n  vpc_security_group_ids = [\"${aws_security_group.main.id}\"]\n  publicly_accessible    = \"${var.publicly_accessible}\"\n}\n\noutput \"addr\" {\n  value = \"${aws_db_instance.main.engine}://${aws_db_instance.main.username}:${aws_db_instance.main.password}@${aws_db_instance.main.endpoint}\"\n}\n\noutput \"url\" {\n  value = \"${aws_db_instance.main.engine}://${aws_db_instance.main.username}:${aws_db_instance.main.password}@${aws_db_instance.main.endpoint}/${aws_db_instance.main.name}\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__rds__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__rds__main.tf", "start_line": 115}, {"tool": "checkov", "rule_id": "CKV_AWS_129", "severity": "HIGH", "message": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__rds__main.tf", "start_line": 152}, {"tool": "checkov", "rule_id": "CKV_AWS_226", "severity": "HIGH", "message": "Ensure DB instance gets all minor upgrades automatically", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__rds__main.tf", "start_line": 152}, {"tool": "checkov", "rule_id": "CKV_AWS_16", "severity": "HIGH", "message": "Ensure all data stored in the RDS is securely encrypted at rest", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__rds__main.tf", "start_line": 152}, {"tool": "checkov", "rule_id": "CKV_AWS_118", "severity": "HIGH", "message": "Ensure that enhanced monitoring is enabled for Amazon RDS instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__rds__main.tf", "start_line": 152}, {"tool": "checkov", "rule_id": "CKV_AWS_293", "severity": "HIGH", "message": "Ensure that AWS database instances have deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__rds__main.tf", "start_line": 152}, {"tool": "checkov", "rule_id": "CKV_AWS_353", "severity": "HIGH", "message": "Ensure that RDS instances have performance insights enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__rds__main.tf", "start_line": 152}, {"tool": "checkov", "rule_id": "CKV_AWS_157", "severity": "HIGH", "message": "Ensure that RDS instances have Multi-AZ enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__rds__main.tf", "start_line": 152}, {"tool": "checkov", "rule_id": "CKV2_AWS_30", "severity": "CRITICAL", "message": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__rds__main.tf", "start_line": 152}, {"tool": "checkov", "rule_id": "CKV2_AWS_60", "severity": "CRITICAL", "message": "Ensure RDS instance with copy tags to snapshots is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__rds__main.tf", "start_line": 152}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n   region                   = \"eu-central-1\"\n   shared_credentials_files = [\"/Users/rahulwagh/.aws/credentials\"]\n}\n\nresource \"aws_instance\" \"ec2_example\" {\n   ami           = \"ami-0767046d1677be5a0\"\n   instance_type =  \"%{ if var.instance_type != \"\" }${var.instance_type}%{ else }t2.micro%{ endif }\"\n   tags = {\n           Name = \"Terraform EC2\"\n   }\n}\n\n\nvariable \"instance_type\" {\n   description = \"Instance type t2.micro\"\n   type        = string\n   default     = \"\"\n\n#  validation {\n#   condition     = can(regex(\"^[Tt][2-3].(nano|micro|small)\", var.instance_type))\n#   error_message = \"Invalid Instance Type name. You can only choose - t2.nano,t2.micro,t2.small\"\n# }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__terraform-aws-ec2__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__terraform-aws-ec2__main.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__terraform-aws-ec2__main.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"foo\" {\n  instance_type = \"x2.2xlarge\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-linters__tflint-ruleset-aws__integration__basic__template.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-linters__tflint-ruleset-aws__integration__basic__template.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-linters__tflint-ruleset-aws__integration__basic__template.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-linters__tflint-ruleset-aws__integration__basic__template.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-linters__tflint-ruleset-aws__integration__basic__template.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-linters__tflint-ruleset-aws__integration__basic__template.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_lambda_function\" \"test_lambda1\" {\n  depends_on = [aws_cloudwatch_log_group.example1]\n\n  function_name = \"lambda_function_name1\"\n  role          = \"aws_iam_role.iam_for_lambda.arn\"\n  handler       = \"exports.test\"\n\n  runtime = \"nodejs12.x\"\n}\n\nresource \"aws_lambda_function\" \"test_lambda2\" {\n  depends_on = [aws_cloudwatch_log_group.example2]\n\n  function_name = \"lambda_function_name2\"\n  role          = \"aws_iam_role.iam_for_lambda.arn\"\n  handler       = \"exports.test\"\n\n  runtime = \"nodejs12.x\"\n}\n\nresource \"aws_lambda_function\" \"test_lambda3\" {\n  depends_on = [aws_cloudwatch_log_group.example3]\n\n  function_name = \"lambda_function_name3\"\n  role          = \"aws_iam_role.iam_for_lambda.arn\"\n  handler       = \"exports.test\"\n\n  runtime = \"nodejs12.x\"\n}\n\nresource \"aws_lambda_function\" \"test_lambda4\" {\n  depends_on = [aws_cloudwatch_log_group.example4]\n\n  function_name = \"lambda_function_name4\"\n  role          = \"aws_iam_role.iam_for_lambda.arn\"\n  handler       = \"exports.test\"\n\n  runtime = \"nodejs12.x\"\n}\n\n# If I omit this, the log group will be created automatically, but it won't have retention_in_days set to 90\nresource \"aws_cloudwatch_log_group\" \"example1\" {\n  name              = \"/aws/lambda/lambda_function_name1\"\n  retention_in_days = 90\n}\n\nresource \"aws_iam_role\" \"iam_for_lambda1\" {\n  name = \"iam_for_lambda\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n\n\n# If I omit this, the log group will be created automatically, but it won't have retention_in_days set to 90\nresource \"aws_cloudwatch_log_group\" \"example2\" {\n  name              = \"/aws/lambda/lambda_function_name2\"\n  retention_in_days = 90\n}\n\nresource \"aws_iam_role\" \"iam_for_lambda2\" {\n  name = \"iam_for_lambda\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n\n\n# If I omit this, the log group will be created automatically, but it won't have retention_in_days set to 90\nresource \"aws_cloudwatch_log_group\" \"example3\" {\n  name              = \"/aws/lambda/lambda_function_name3\"\n  retention_in_days = 90\n}\n\nresource \"aws_iam_role\" \"iam_for_lambda3\" {\n  name = \"iam_for_lambda\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n\n\n# If I omit this, the log group will be created automatically, but it won't have retention_in_days set to 90\nresource \"aws_cloudwatch_log_group\" \"example4\" {\n  name              = \"/aws/lambda/lambda_function_name4\"\n  retention_in_days = 90\n}\n\nresource \"aws_iam_role\" \"iam_for_lambda4\" {\n  name = \"iam_for_lambda\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_363", "severity": "HIGH", "message": "Ensure Lambda Runtime is not deprecated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_363", "severity": "HIGH", "message": "Ensure Lambda Runtime is not deprecated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_363", "severity": "HIGH", "message": "Ensure Lambda Runtime is not deprecated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_363", "severity": "HIGH", "message": "Ensure Lambda Runtime is not deprecated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_158", "severity": "HIGH", "message": "Ensure that CloudWatch Log Group is encrypted by KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_AWS_338", "severity": "HIGH", "message": "Ensure CloudWatch log groups retains logs for at least 1 year", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_AWS_158", "severity": "HIGH", "message": "Ensure that CloudWatch Log Group is encrypted by KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 69}, {"tool": "checkov", "rule_id": "CKV_AWS_338", "severity": "HIGH", "message": "Ensure CloudWatch log groups retains logs for at least 1 year", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 69}, {"tool": "checkov", "rule_id": "CKV_AWS_158", "severity": "HIGH", "message": "Ensure that CloudWatch Log Group is encrypted by KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 96}, {"tool": "checkov", "rule_id": "CKV_AWS_338", "severity": "HIGH", "message": "Ensure CloudWatch log groups retains logs for at least 1 year", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 96}, {"tool": "checkov", "rule_id": "CKV_AWS_158", "severity": "HIGH", "message": "Ensure that CloudWatch Log Group is encrypted by KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 123}, {"tool": "checkov", "rule_id": "CKV_AWS_338", "severity": "HIGH", "message": "Ensure CloudWatch log groups retains logs for at least 1 year", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__test-it_must_be_in-affixes__main.tf", "start_line": 123}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# //////////////////////////////\n# VARIABLES\n# //////////////////////////////\nvariable \"aws_access_key\" {}\n\nvariable \"aws_secret_key\" {}\n\nvariable \"ssh_key_name\" {}\n\nvariable \"private_key_path\" {}\n\nvariable \"region\" {\n  default = \"us-east-2\"\n}\n\nvariable \"vpc_cidr\" {\n  default = \"172.16.0.0/16\"\n}\n\nvariable \"subnet1_cidr\" {\n  default = \"172.16.0.0/24\"\n}\n\n# //////////////////////////////\n# PROVIDERS\n# //////////////////////////////\nprovider \"aws\" {\n  access_key = var.aws_access_key\n  secret_key = var.aws_secret_key\n  region     = var.region\n}\n\n# //////////////////////////////\n# RESOURCES\n# //////////////////////////////\n\n# VPC\nresource \"aws_vpc\" \"vpc1\" {\n  cidr_block = var.vpc_cidr\n  enable_dns_hostnames = \"true\"\n}\n\n# SUBNET\nresource \"aws_subnet\" \"subnet1\" {\n  cidr_block = var.subnet1_cidr\n  vpc_id = aws_vpc.vpc1.id\n  map_public_ip_on_launch = \"true\"\n  availability_zone = data.aws_availability_zones.available.names[1]\n}\n\n# INTERNET_GATEWAY\nresource \"aws_internet_gateway\" \"gateway1\" {\n  vpc_id = aws_vpc.vpc1.id\n}\n\n# ROUTE_TABLE\nresource \"aws_route_table\" \"route_table1\" {\n  vpc_id = aws_vpc.vpc1.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.gateway1.id\n  }\n}\n\nresource \"aws_route_table_association\" \"route-subnet1\" {\n  subnet_id = aws_subnet.subnet1.id\n  route_table_id = aws_route_table.route_table1.id\n}\n\n# SECURITY_GROUP\nresource \"aws_security_group\" \"sg-nodejs-instance\" {\n  name = \"nodejs_sg\"\n  vpc_id = aws_vpc.vpc1.id\n\n  ingress {\n    from_port = 80\n    to_port = 80\n    protocol = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port = 443\n    to_port = 443\n    protocol = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port = 22\n    to_port = 22\n    protocol = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  \n  egress {\n    from_port = 0\n    to_port = 0\n    protocol = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\n# INSTANCE\nresource \"aws_instance\" \"nodejs1\" {\n  ami = data.aws_ami.aws-linux.id\n  instance_type = \"t2.micro\"\n  subnet_id = aws_subnet.subnet1.id\n  vpc_security_group_ids = [aws_security_group.sg-nodejs-instance.id]\n  key_name               = var.ssh_key_name\n\n  connection {\n    type        = \"ssh\"\n    host        = self.public_ip\n    user        = \"ec2-user\"\n    private_key = file(var.private_key_path)\n  }\n}\n\n\n# //////////////////////////////\n# DATA\n# //////////////////////////////\ndata \"aws_availability_zones\" \"available\" {\n  state = \"available\"\n}\n\ndata \"aws_ami\" \"aws-linux\" {\n  most_recent = true\n  owners      = [\"amazon\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"amzn-ami-hvm*\"]\n  }\n\n  filter {\n    name   = \"root-device-type\"\n    values = [\"ebs\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n}\n\n# //////////////////////////////\n# OUTPUT\n# //////////////////////////////\noutput \"instance-dns\" {\n  value = aws_instance.nodejs1.public_dns\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 72}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 72}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 72}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 72}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 38}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__01_05_base__main.tf", "start_line": 38}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 0.12\"\n}\n\nprovider \"aws\" {\n  region = var.aws_region\n}\n\nvariable \"aws_region\" {\n    type = string\n}\n\nvariable \"vpc_id\" {\n    type = string\n}\n\nvariable \"key_name\" {\n    type = string\n}\n\nresource \"aws_security_group\" \"jenkins_sg\" {\n  name        = \"jenkins_sg\"\n  description = \"Allow Jenkins Traffic\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    description      = \"Allow from Personal CIDR block\"\n    from_port        = 8081\n    to_port          = 8081\n    protocol         = \"tcp\"\n    cidr_blocks      = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    description      = \"Allow SSH from Personal CIDR block\"\n    from_port        = 22\n    to_port          = 22\n    protocol         = \"tcp\"\n    cidr_blocks      = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port        = 0\n    to_port          = 0\n    protocol         = \"-1\"\n    cidr_blocks      = [\"0.0.0.0/0\"]\n    ipv6_cidr_blocks = [\"::/0\"]\n  }\n\n  tags = {\n    Name = \"Jenkins SG\"\n  }\n}\n\ndata \"aws_ami\" \"amazon_linux\" {\n  most_recent = true\n\n  filter {\n    name   = \"name\"\n    values = [\"*al2023-ami-2023.*.*-kernel-6.1-x86_64*\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  filter {\n    name   = \"root-device-type\"\n    values = [\"ebs\"]\n  }\n\n  owners = [\"amazon\"] # Canonical\n}\n\nresource \"aws_iam_role\" \"test_role\" {\n  name = \"test_role\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n\nresource \"aws_iam_instance_profile\" \"test_profile\" {\n  name = \"test_profile\"\n  role = \"${aws_iam_role.test_role.name}\"\n}\n\nresource \"aws_iam_role_policy\" \"test_policy\" {\n  name = \"test_policy\"\n  role = \"${aws_iam_role.test_role.id}\"\n\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n     {\n            \"Effect\": \"Allow\",\n            \"Action\": \"*\",\n            \"Resource\": \"*\"\n     }\n  ]\n}\nEOF\n}\n\nresource \"aws_instance\" \"web\" {\n  ami             = data.aws_ami.amazon_linux.id\n  instance_type   = \"t2.xlarge\" \n  key_name        = var.key_name\n  iam_instance_profile = \"${aws_iam_instance_profile.test_profile.name}\"\n  security_groups = [aws_security_group.jenkins_sg.name]\n  user_data       = \"${file(\"install_jenkins.sh\")}\"\n  tags = {\n    Name = \"Jenkins\"\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_62", "severity": "HIGH", "message": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 101}, {"tool": "checkov", "rule_id": "CKV_AWS_287", "severity": "HIGH", "message": "Ensure IAM policies does not allow credentials exposure", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 101}, {"tool": "checkov", "rule_id": "CKV_AWS_288", "severity": "HIGH", "message": "Ensure IAM policies does not allow data exfiltration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 101}, {"tool": "checkov", "rule_id": "CKV_AWS_289", "severity": "HIGH", "message": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 101}, {"tool": "checkov", "rule_id": "CKV_AWS_286", "severity": "HIGH", "message": "Ensure IAM policies does not allow privilege escalation", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 101}, {"tool": "checkov", "rule_id": "CKV_AWS_63", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 101}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 101}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 101}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 119}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 119}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 119}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 119}, {"tool": "checkov", "rule_id": "CKV2_AWS_40", "severity": "CRITICAL", "message": "Ensure AWS IAM policy does not allow full IAM privileges", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/asecurityguru__terraform-ec2-jenkins-aws-k8s-infra-creation__main.tf", "start_line": 101}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n### Slack outputs\noutput \"slack_lamba_cw_log_group_arn\" {\n  description = \"The ARN of lambda log group for slack\"\n  value       = module.main_slack.lambda_cloudwatch_log_group_arn\n}\n\noutput \"slack_lambda_iam_role_arn\" {\n  description = \"The ARN of lambda IAM role for slack\"\n  value       = module.main_slack.lambda_iam_role_arn\n}\n\noutput \"slack_lambda_iam_role_name\" {\n  description = \"The Name of lambda IAM role for slack\"\n  value       = module.main_slack.lambda_iam_role_name\n}\n\noutput \"slack_lambda_function_name\" {\n  description = \"The name of the Lambda function for slack\"\n  value       = module.main_slack.notify_slack_lambda_function_name\n}\n\noutput \"slack_topic_arn\" {\n  description = \"The ARN of the SNS topic from which messages will be sent to Slack\"\n  value       = module.main_slack.this_slack_topic_arn\n}\n\n### OpenVPN outputs\noutput \"openvpn_private_ip\" {\n  description = \"OpenVPN private address\"\n  value       = module.openvpn.private_ip\n}\n\noutput \"openvpn_private_dns\" {\n  description = \"OpenVPN private DNS names\"\n  value       = module.openvpn.private_dns\n}\n\noutput \"openvpn_public_ip\" {\n  description = \"OpenVPN public address\"\n  value       = module.openvpn.public_ip\n}\n\noutput \"openvpn_public_dns\" {\n  description = \"OpenVPN public DNS names\"\n  value       = module.openvpn.public_dns\n}\n\noutput \"openvpn_public_eip_address\" {\n  description = \"OpenVPN public address\"\n  value       = aws_eip.openvpn.public_ip\n}\n\noutput \"openvpn_subnet_id\" {\n  description = \"OpenVPN subnet id\"\n  value       = module.openvpn.subnet_id\n}\n\noutput \"openvpn_availability_zone\" {\n  description = \"OpenVPN availability zone\"\n  value       = module.openvpn.availability_zone\n}\n\noutput \"openvpn_instance_ids\" {\n  description = \"OpenVPN instance ids\"\n  value       = module.openvpn.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/diggerhq__digger__libs__digger_config__terragrunt__tac__test_examples__no_terraform_blocks__myproject__eu-south-1__infra__apps__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"elasticsearch_xpack_user\" \"test\" {\n  username = \"johndoe\"\n  fullname = \"John DoDo\"\n  email    = \"john@do.com\"\n  password = \"secret\"\n  roles    = [\"admin\"]\n  metadata = <<-EOF\n  {\n    \"foo\": \"bar\"\n  }\n  EOF\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/phillbaker__terraform-provider-elasticsearch__examples__resources__elasticsearch_xpack_user__resource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-cloudwatch__examples__complete-log-metric-filter-and-alarm__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_policy\" \"privesc-sageMakerCreatePresignedNotebookURL-policy\" {\n  name        = \"privesc-sageMakerCreatePresignedNotebookURL-policy\"\n  path        = \"/\"\n  description = \"Allows privesc via sagemakerCreatePresignedNotebookURL\"\n\n  # Terraform's \"jsonencode\" function converts a\n  # Terraform expression result to valid JSON syntax.\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect   = \"Allow\"\n        Action = [\n          \"sagemaker:CreatePresignedNotebookInstanceUrl\",\n          \"sagemaker:ListNotebookInstances\"          \n        ]\n        Resource = \"*\"\n      },\n    ]\n  })\n}\n\n\n\nresource \"aws_iam_role\" \"privesc-sageMakerCreatePresignedNotebookURL-role\" {\n  name                = \"privesc-sageMakerCreatePresignedNotebookURL-role\"\n  assume_role_policy  = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Sid    = \"\"\n        Principal = {\n          AWS = var.aws_assume_role_arn\n        }\n      },\n    ]\n  })\n}\n\n\nresource \"aws_iam_user\" \"privesc-sageMakerCreatePresignedNotebookURL-user\" {\n  name = \"privesc-sageMakerCreatePresignedNotebookURL-user\"\n  path = \"/\"\n}\n\nresource \"aws_iam_access_key\" \"privesc-sageMakerCreatePresignedNotebookURL-user\" {\n  user = aws_iam_user.privesc-sageMakerCreatePresignedNotebookURL-user.name\n}\n\n\n\nresource \"aws_iam_user_policy_attachment\" \"privesc-sageMakerCreatePresignedNotebookURL-user-attach-policy\" {\n  user       = aws_iam_user.privesc-sageMakerCreatePresignedNotebookURL-user.name\n  policy_arn = aws_iam_policy.privesc-sageMakerCreatePresignedNotebookURL-policy.arn\n}\n\n\nresource \"aws_iam_role_policy_attachment\" \"privesc-sageMakerCreatePresignedNotebookURL-role-attach-policy\" {\n  role       = aws_iam_role.privesc-sageMakerCreatePresignedNotebookURL-role.name\n  policy_arn = aws_iam_policy.privesc-sageMakerCreatePresignedNotebookURL-policy.arn\n\n}  \n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-sageMakerCreatePresignedNotebookURL.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-sageMakerCreatePresignedNotebookURL.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-sageMakerCreatePresignedNotebookURL.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-sageMakerCreatePresignedNotebookURL.tf", "start_line": 43}, {"tool": "checkov", "rule_id": "CKV_AWS_40", "severity": "HIGH", "message": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/BishopFox__iam-vulnerable__modules__free-resources__privesc-paths__privesc-sageMakerCreatePresignedNotebookURL.tf", "start_line": 54}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_ssm_parameter\" \"eks-vpc\" {\n  name        = \"/workshop/tf-eks/eks-vpc\"\n}\n\ndata \"aws_ssm_parameter\" \"eks-cidr\" {\n  name        = \"/workshop/tf-eks/eks-cidr\"\n}\n\ndata \"aws_ssm_parameter\" \"sub-isol1\" {\n  name        = \"/workshop/tf-eks/sub-isol1\"\n}\n\ndata \"aws_ssm_parameter\" \"sub-isol2\" {\n  name        = \"/workshop/tf-eks/sub-isol2\"\n}\n\ndata \"aws_ssm_parameter\" \"sub-isol3\" {\n  name        = \"/workshop/tf-eks/sub-isol3\"\n}\n\ndata \"aws_ssm_parameter\" \"sub-p1\" {\n  name        = \"/workshop/tf-eks/sub-p1\"\n}\n\ndata \"aws_ssm_parameter\" \"sub-priv1\" {\n  name        = \"/workshop/tf-eks/sub-priv1\"\n}\n\ndata \"aws_ssm_parameter\" \"sub-priv2\" {\n  name        = \"/workshop/tf-eks/sub-priv2\"\n}\n\ndata \"aws_ssm_parameter\" \"sub-priv3\" {\n  name        = \"/workshop/tf-eks/sub-priv3\"\n}\n\ndata \"aws_ssm_parameter\" \"cicd-vpc\" {\n  name        = \"/workshop/tf-eks/cicd-vpc\"\n}\n\ndata \"aws_ssm_parameter\" \"cicd-cidr\" {\n  name        = \"/workshop/tf-eks/cicd-cidr\"\n}\n\n\ndata \"aws_ssm_parameter\" \"net-cluster-sg\" {\n  name        = \"/workshop/tf-eks/net-cluster-sg\"\n}\n\ndata \"aws_ssm_parameter\" \"allnodes-sg\" {\n  name        = \"/workshop/tf-eks/allnodes-sg\"\n}\n\n\ndata \"aws_ssm_parameter\" \"rtb-isol\" {\n  name        = \"/workshop/tf-eks/rtb-isol\"\n}\n\ndata \"aws_ssm_parameter\" \"rtb-priv1\" {\n  name        = \"/workshop/tf-eks/rtb-priv1\"\n}\n\n\ndata \"aws_ssm_parameter\" \"rtb-priv2\" {\n  name        = \"/workshop/tf-eks/rtb-priv2\"\n}\n\n\ndata \"aws_ssm_parameter\" \"rtb-priv3\" {\n  name        = \"/workshop/tf-eks/rtb-priv3\"\n}\n\n\n\n\n\n\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__terraform-eks-code__c9net__data-params-net.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ---------------------------------------------------------------------------------------------------------------------\n# ENVIRONMENT VARIABLES\n# Define these secrets as environment variables\n# ---------------------------------------------------------------------------------------------------------------------\n\n# AWS_ACCESS_KEY_ID\n# AWS_SECRET_ACCESS_KEY\n# AWS_DEFAULT_REGION\n\n# ---------------------------------------------------------------------------------------------------------------------\n# REQUIRED PARAMETERS\n# You must provide a value for each of these parameters.\n# ---------------------------------------------------------------------------------------------------------------------\n\nvariable \"ami_id\" {\n  description = \"The ID of the AMI to run in the cluster. This should be an AMI built from the Packer template under examples/vault-consul-ami/vault-consul.json.\"\n  type        = string\n}\n\nvariable \"ssh_key_name\" {\n  description = \"The name of an EC2 Key Pair that can be used to SSH to the EC2 Instances in this cluster. Set to an empty string to not associate a Key Pair.\"\n  type        = string\n}\n\nvariable \"auto_unseal_kms_key_alias\" {\n  description = \"The alias of AWS KMS key used for encryption and decryption\"\n  type        = string\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# OPTIONAL PARAMETERS\n# These parameters have reasonable defaults.\n# ---------------------------------------------------------------------------------------------------------------------\n\nvariable \"vault_cluster_name\" {\n  description = \"What to name the Vault server cluster and all of its associated resources\"\n  type        = string\n  default     = \"vault-example\"\n}\n\nvariable \"consul_cluster_name\" {\n  description = \"What to name the Consul server cluster and all of its associated resources\"\n  type        = string\n  default     = \"consul-example\"\n}\n\nvariable \"auth_server_name\" {\n  description = \"What to name the server authenticating to vault\"\n  type        = string\n  default     = \"auth-example\"\n}\n\nvariable \"vault_cluster_size\" {\n  description = \"The number of Vault server nodes to deploy. We strongly recommend using 3 or 5.\"\n  type        = number\n  default     = 3\n}\n\nvariable \"consul_cluster_size\" {\n  description = \"The number of Consul server nodes to deploy. We strongly recommend using 3 or 5.\"\n  type        = number\n  default     = 3\n}\n\nvariable \"vault_instance_type\" {\n  description = \"The type of EC2 Instance to run in the Vault ASG\"\n  type        = string\n  default     = \"t2.micro\"\n}\n\nvariable \"consul_instance_type\" {\n  description = \"The type of EC2 Instance to run in the Consul ASG\"\n  type        = string\n  default     = \"t2.nano\"\n}\n\nvariable \"consul_cluster_tag_key\" {\n  description = \"The tag the Consul EC2 Instances will look for to automatically discover each other and form a cluster.\"\n  type        = string\n  default     = \"consul-servers\"\n}\n\nvariable \"vpc_id\" {\n  description = \"The ID of the VPC to deploy into. Leave an empty string to use the Default VPC in this region.\"\n  type        = string\n  default     = null\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-aws-vault__examples__vault-auto-unseal__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nterraform {\n  backend \"gcs\" {\n    bucket = \"PROJECT_ID-tfstate\"\n    prefix = \"jenkins\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-jenkins-gitops__jenkins-gke__tf-gke__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  access_key = \"${var.accesskey}\"\n  secret_key = \"${var.secretkey}\"\n  region     = \"${var.location}\"\n}\nresource \"aws_s3_bucket\" \"smartshop-ecom\" {\n  bucket = \"smartshop-ecom\"\n  acl    = \"private\"\n}\n\nresource \"aws_iam_role\" \"satya\" {\n  name = \"satya\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"codebuild.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nEOF\n}\n\nresource \"aws_iam_role_policy\" \"satya\" {\n  role        = \"${aws_iam_role.satya.name}\"\n\n  policy = <<POLICY\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\"\n      ],\n      \"Resource\": [\n        \"${aws_s3_bucket.smartshop-ecom.arn}\",\n        \"${aws_s3_bucket.smartshop-ecom.arn}/*\"\n      ]\n    }\n  ]\n}\nPOLICY\n}\n\nresource \"aws_codebuild_project\" \"javaproject-smartshop\" {\n  name         = \"test-project\"\n  description  = \"test_codebuild_project\"\n  build_timeout      = \"5\"\n  service_role = \"${aws_iam_role.satya.arn}\"\n\n  artifacts {\n    type = \"NO_ARTIFACTS\"\n  }\n\n  cache {\n    type     = \"S3\"\n    location = \"${aws_s3_bucket.smartshop-ecom.bucket}\"\n  }\n\n  environment {\n    compute_type = \"BUILD_GENERAL1_SMALL\"\n    image        = \"aws/codebuild/smartshop:2.0\"\n    type         = \"LINUX_CONTAINER\"\n\n    environment_variable {\n      \"name\"  = \"murali\"\n      \"value\" = \"12345678\"\n    }\n  }\n\n  source {\n    type            = \"GITHUB\"\n    location        = \"${var.github}\"\n    git_clone_depth = 1\n  }\n\n  vpc_config {\n    vpc_id = \"${var.vpc}\"\n\n    subnets = [\n      \"${var.subnet1}\",\n      \"${var.subnet2}\",\n    ]\n\n    security_group_ids = [ \"${var.securitygroup}\"\n    ]\n  }\n\n  tags {\n    \"Environment\" = \"Test\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__aws codebuild__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__aws codebuild__main.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/satyamuralidhar__Terraform__aws codebuild__main.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"hcloud_image\" \"by_id\" {\n  id = \"114690387\"\n}\n\ndata \"hcloud_image\" \"by_name_x86\" {\n  name              = \"debian-12\"\n  with_architecture = \"x86\"\n}\n\ndata \"hcloud_image\" \"by_name_arm\" {\n  name              = \"debian-12\"\n  with_architecture = \"arm\"\n}\n\ndata \"hcloud_image\" \"by_label\" {\n  with_selector = \"key=value\"\n}\n\nresource \"hcloud_server\" \"main\" {\n  image = data.hcloud_image.by_name.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hetznercloud__terraform-provider-hcloud__examples__data-sources__hcloud_image__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"r100c96\" {\n  ami               = \"ami-0a9d27a9f4f5c0efc\"\n  instance_type     = \"t2.micro\"\n  availability_zone = \"ap-south-1b\"\n  key_name          = \"aws-exam-testing\"\n  tags = {\n    Name = \"Terraform-diff-linux\"\n  }\n\n  provisioner \"remote-exec\" {\n    inline = [ \"sudo hostnamectl set-hostname cloudEc2.technix.com\" ]\n    connection {\n      host        = aws_instance.r100c96.public_dns\n      type        = \"ssh\"\n      user        = \"ec2-user\"\n      private_key = file(\"./aws-exam-testing.pem\")\n    }\n  }\n\n  provisioner \"local-exec\" {\n    command = \"echo ${aws_instance.r100c96.public_dns} > inventory\"\n  }\n\n  provisioner \"local-exec\" {\n    command = \"ansible all -m shell -a 'yum -y install httpd; systemctl restart httpd'\"\n  }\n}\n\noutput \"ip\" {\n  value = aws_instance.r100c96.public_ip\n}\n\noutput \"publicName\" {\n  value = aws_instance.r100c96.public_dns\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__automation__method1__instance.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__automation__method1__instance.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__automation__method1__instance.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__automation__method1__instance.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__automation__method1__instance.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__automation__method1__instance.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"name\" {\n  description = \"The name to use for the ALB and all other resources in this module.\"\n}\n\nvariable \"subnet_ids\" {\n  description = \"The subnet IDs into which the ALB should be deployed.\"\n  type        = list(string)\n  default     = []\n}\n\nvariable \"security_groups\" {\n  description = \"The security groups into which the ALB should be applied.\"\n  type        = list(string)\n  default     = []\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/outsideris__citizen__test__integration__fixture__alb__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nmodule \"aft\" {\n  source = \"github.com/aws-ia/terraform-aws-control_tower_account_factory\"\n  ct_management_account_id    = var.ct_management_account_id\n  log_archive_account_id      = var.log_archive_account_id\n  audit_account_id            = var.audit_account_id\n  aft_management_account_id   = var.aft_management_account_id\n  ct_home_region              = var.ct_home_region\n  tf_backend_secondary_region = var.tf_backend_secondary_region\n\n  vcs_provider                                  = \"github\"\n  account_request_repo_name                     = \"${var.github_username}/learn-terraform-aft-account-request\"\n  account_provisioning_customizations_repo_name = \"${var.github_username}/learn-terraform-aft-account-provisioning-customizations\"\n  global_customizations_repo_name               = \"${var.github_username}/learn-terraform-aft-global-customizations\"\n  account_customizations_repo_name              = \"${var.github_username}/learn-terraform-aft-account-customizations\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aws-control-tower-aft__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aws-control-tower-aft__main.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aws-control-tower-aft__main.tf", "start_line": 4}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nlocals {\n  retries = var.timeout / 30\n}\nresource \"null_resource\" \"wait_for_startup\" {\n  provisioner \"local-exec\" {\n    command = \"/bin/bash ${path.module}/scripts/wait-for-startup-status.sh\"\n    environment = {\n      INSTANCE_NAME = var.instance_name\n      ZONE          = var.zone\n      PROJECT_ID    = var.project_id\n      RETRIES       = local.retries\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__cluster-toolkit__community__front-end__ofe__infrastructure_files__workbench_tf__google__wait-for-startup__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"id\" {\n  description = \"The ID of the instance\"\n  value       = local.instance_id\n}\n\noutput \"arn\" {\n  description = \"The ARN of the instance\"\n  value = try(\n    aws_instance.this[0].arn,\n    aws_instance.ignore_ami[0].arn,\n    aws_spot_instance_request.this[0].arn,\n    null,\n  )\n}\n\noutput \"capacity_reservation_specification\" {\n  description = \"Capacity reservation specification of the instance\"\n  value = try(\n    aws_instance.this[0].capacity_reservation_specification,\n    aws_instance.ignore_ami[0].capacity_reservation_specification,\n    aws_spot_instance_request.this[0].capacity_reservation_specification,\n    null,\n  )\n}\n\noutput \"instance_state\" {\n  description = \"The state of the instance\"\n  value = try(\n    aws_instance.this[0].instance_state,\n    aws_instance.ignore_ami[0].instance_state,\n    aws_spot_instance_request.this[0].instance_state,\n    null,\n  )\n}\n\noutput \"outpost_arn\" {\n  description = \"The ARN of the Outpost the instance is assigned to\"\n  value = try(\n    aws_instance.this[0].outpost_arn,\n    aws_instance.ignore_ami[0].outpost_arn,\n    aws_spot_instance_request.this[0].outpost_arn,\n    null,\n  )\n}\n\noutput \"password_data\" {\n  description = \"Base-64 encoded encrypted password data for the instance. Useful for getting the administrator password for instances running Microsoft Windows. This attribute is only exported if `get_password_data` is true\"\n  value = try(\n    aws_instance.this[0].password_data,\n    aws_instance.ignore_ami[0].password_data,\n    aws_spot_instance_request.this[0].password_data,\n    null,\n  )\n}\n\noutput \"primary_network_interface_id\" {\n  description = \"The ID of the instance's primary network interface\"\n  value = try(\n    aws_instance.this[0].primary_network_interface_id,\n    aws_instance.ignore_ami[0].primary_network_interface_id,\n    aws_spot_instance_request.this[0].primary_network_interface_id,\n    null,\n  )\n}\n\noutput \"private_dns\" {\n  description = \"The private DNS name assigned to the instance. Can only be used inside the Amazon EC2, and only available if you've enabled DNS hostnames for your VPC\"\n  value = try(\n    aws_instance.this[0].private_dns,\n    aws_instance.ignore_ami[0].private_dns,\n    aws_spot_instance_request.this[0].private_dns,\n    null,\n  )\n}\n\noutput \"public_dns\" {\n  description = \"The public DNS name assigned to the instance. For EC2-VPC, this is only available if you've enabled DNS hostnames for your VPC\"\n  value = try(\n    aws_instance.this[0].public_dns,\n    aws_instance.ignore_ami[0].public_dns,\n    aws_spot_instance_request.this[0].public_dns,\n    null,\n  )\n}\n\noutput \"public_ip\" {\n  description = \"The public IP address assigned to the instance, if applicable.\"\n  value = try(\n    aws_eip.this[0].public_ip,\n    aws_instance.this[0].public_ip,\n    aws_instance.ignore_ami[0].public_ip,\n    aws_spot_instance_request.this[0].public_ip,\n    null,\n  )\n}\n\noutput \"private_ip\" {\n  description = \"The private IP address assigned to the instance\"\n  value = try(\n    aws_instance.this[0].private_ip,\n    aws_instance.ignore_ami[0].private_ip,\n    aws_spot_instance_request.this[0].private_ip,\n    null,\n  )\n}\n\noutput \"ipv6_addresses\" {\n  description = \"The IPv6 address assigned to the instance, if applicable\"\n  value = try(\n    aws_instance.this[0].ipv6_addresses,\n    aws_instance.ignore_ami[0].ipv6_addresses,\n    aws_spot_instance_request.this[0].ipv6_addresses,\n    [],\n  )\n}\n\noutput \"tags_all\" {\n  description = \"A map of tags assigned to the resource, including those inherited from the provider default_tags configuration block\"\n  value = try(\n    aws_instance.this[0].tags_all,\n    aws_instance.ignore_ami[0].tags_all,\n    aws_spot_instance_request.this[0].tags_all,\n    {},\n  )\n}\n\noutput \"spot_bid_status\" {\n  description = \"The current bid status of the Spot Instance Request\"\n  value       = try(aws_spot_instance_request.this[0].spot_bid_status, null)\n}\n\noutput \"spot_request_state\" {\n  description = \"The current request state of the Spot Instance Request\"\n  value       = try(aws_spot_instance_request.this[0].spot_request_state, null)\n}\n\noutput \"spot_instance_id\" {\n  description = \"The Instance ID (if any) that is currently fulfilling the Spot Instance request\"\n  value       = try(aws_spot_instance_request.this[0].spot_instance_id, null)\n}\n\noutput \"ami\" {\n  description = \"AMI ID that was used to create the instance\"\n  value = try(\n    aws_instance.this[0].ami,\n    aws_instance.ignore_ami[0].ami,\n    aws_spot_instance_request.this[0].ami,\n    null,\n  )\n}\n\noutput \"availability_zone\" {\n  description = \"The availability zone of the created instance\"\n  value       = local.instance_availability_zone\n}\n\n################################################################################\n# EBS Volume(s)\n################################################################################\n\noutput \"ebs_volumes\" {\n  description = \"Map of EBS volumes created and their attributes\"\n  value       = aws_ebs_volume.this\n}\n\n################################################################################\n# IAM Role / Instance Profile\n################################################################################\n\noutput \"iam_role_name\" {\n  description = \"The name of the IAM role\"\n  value       = try(aws_iam_role.this[0].name, null)\n}\n\noutput \"iam_role_arn\" {\n  description = \"The Amazon Resource Name (ARN) specifying the IAM role\"\n  value       = try(aws_iam_role.this[0].arn, null)\n}\n\noutput \"iam_role_unique_id\" {\n  description = \"Stable and unique string identifying the IAM role\"\n  value       = try(aws_iam_role.this[0].unique_id, null)\n}\n\noutput \"iam_instance_profile_arn\" {\n  description = \"ARN assigned by AWS to the instance profile\"\n  value       = try(aws_iam_instance_profile.this[0].arn, null)\n}\n\noutput \"iam_instance_profile_id\" {\n  description = \"Instance profile's ID\"\n  value       = try(aws_iam_instance_profile.this[0].id, null)\n}\n\noutput \"iam_instance_profile_unique\" {\n  description = \"Stable and unique string identifying the IAM instance profile\"\n  value       = try(aws_iam_instance_profile.this[0].unique_id, null)\n}\n\n################################################################################\n# Block Devices\n################################################################################\n\noutput \"root_block_device\" {\n  description = \"Root block device information\"\n  value = try(\n    aws_instance.this[0].root_block_device,\n    aws_instance.ignore_ami[0].root_block_device,\n    aws_spot_instance_request.this[0].root_block_device,\n    null\n  )\n}\n\noutput \"ebs_block_device\" {\n  description = \"EBS block device information\"\n  value = try(\n    aws_instance.this[0].ebs_block_device,\n    aws_instance.ignore_ami[0].ebs_block_device,\n    aws_spot_instance_request.this[0].ebs_block_device,\n    null\n  )\n}\n\noutput \"ephemeral_block_device\" {\n  description = \"Ephemeral block device information\"\n  value = try(\n    aws_instance.this[0].ephemeral_block_device,\n    aws_instance.ignore_ami[0].ephemeral_block_device,\n    aws_spot_instance_request.this[0].ephemeral_block_device,\n    null\n  )\n}\n\n################################################################################\n# Security Group\n################################################################################\n\noutput \"security_group_arn\" {\n  description = \"Amazon Resource Name (ARN) of the security group\"\n  value       = try(aws_security_group.this[0].arn, null)\n}\n\noutput \"security_group_id\" {\n  description = \"ID of the security group\"\n  value       = try(aws_security_group.this[0].id, null)\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-ec2-instance__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright 2025 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\n## Deploy everything needed to build this app.\n# Split into three modules to allow simpler breaks between org policies, API enablement, and resources.\n\n# Deploy org policies first\nmodule \"org_policies\" {\n  count      = var.org_policies ? 1 : 0\n  source     = \"./modules/1-org-policies\"\n  project_id = var.project_id\n}\n\nmodule \"host_apis\" {\n  source     = \"./modules/2-apis\"\n  project_id = var.project_id\n  apis       = local.apis\n}\n\nmodule \"resources\" {\n  depends_on         = [module.host_apis, module.org_policies, time_sleep.delay_after_apis, time_sleep.delay_after_org_policies]\n  source             = \"./modules/3-resources\"\n  project_id         = var.project_id\n  location           = var.location\n  firestore_location = var.firestore_location\n  bucket_location    = var.bucket_location\n}\n\n# Hacks to work around org policy and api propogation\nresource \"time_sleep\" \"delay_after_org_policies\" {\n  depends_on      = [module.org_policies]\n  create_duration = \"30s\"\n}\nresource \"time_sleep\" \"delay_after_apis\" {\n  depends_on      = [module.host_apis]\n  create_duration = \"30s\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__generative-ai__gemini__autocal__terraform__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#variable \"instance_type\" {\n#  description = \"Type of EC2 instance to provision\"\n#  default     = \"t3.nano\"\n#}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__learning-terraform-3087701__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2022 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlocals {\n  peered_ip_range = var.private_worker_pool.enable_network_peering ? \"${google_compute_global_address.worker_pool_range[0].address}/${google_compute_global_address.worker_pool_range[0].prefix_length}\" : \"\"\n}\n\nmodule \"peered_network\" {\n  source  = \"terraform-google-modules/network/google\"\n  version = \"~> 10.0\"\n  count   = var.private_worker_pool.create_peered_network ? 1 : 0\n\n  project_id                             = var.project_id\n  network_name                           = local.network_name\n  delete_default_internet_gateway_routes = \"true\"\n\n  subnets = [\n    {\n      subnet_name                      = \"sb-b-cbpools-${var.private_worker_pool.region}\"\n      subnet_ip                        = var.private_worker_pool.peered_network_subnet_ip\n      subnet_region                    = var.private_worker_pool.region\n      subnet_private_access            = \"true\"\n      subnet_flow_logs                 = \"true\"\n      subnet_flow_logs_interval        = var.vpc_flow_logs.aggregation_interval\n      subnet_flow_logs_sampling        = var.vpc_flow_logs.flow_sampling\n      subnet_flow_logs_metadata        = var.vpc_flow_logs.metadata\n      subnet_flow_logs_metadata_fields = var.vpc_flow_logs.metadata_fields\n      subnet_flow_logs_filter          = var.vpc_flow_logs.filter_expr\n      description                      = \"Peered subnet for Cloud Build private pool\"\n    }\n  ]\n\n}\n\nresource \"google_dns_policy\" \"default_policy\" {\n  count = var.private_worker_pool.create_peered_network ? 1 : 0\n\n  project                   = var.project_id\n  name                      = \"dp-b-cbpools-default-policy\"\n  enable_inbound_forwarding = true\n  enable_logging            = true\n  networks {\n    network_url = module.peered_network[0].network_self_link\n  }\n}\n\nresource \"google_compute_global_address\" \"worker_pool_range\" {\n  count = var.private_worker_pool.enable_network_peering ? 1 : 0\n\n  name          = \"ga-b-cbpools-worker-pool-range\"\n  project       = var.project_id\n  purpose       = \"VPC_PEERING\"\n  address_type  = \"INTERNAL\"\n  address       = var.private_worker_pool.peering_address\n  prefix_length = var.private_worker_pool.peering_prefix_length\n  network       = local.peered_network_id\n}\n\nresource \"google_service_networking_connection\" \"worker_pool_conn\" {\n  count = var.private_worker_pool.enable_network_peering ? 1 : 0\n\n  network                 = local.peered_network_id\n  service                 = \"servicenetworking.googleapis.com\"\n  reserved_peering_ranges = [google_compute_global_address.worker_pool_range[0].name]\n}\n\nresource \"google_compute_network_peering_routes_config\" \"peering_routes\" {\n  count = var.private_worker_pool.enable_network_peering ? 1 : 0\n\n  project = var.project_id\n  peering = google_service_networking_connection.worker_pool_conn[0].peering\n  network = local.peered_network_name\n\n  import_custom_routes = true\n  export_custom_routes = true\n}\n\nmodule \"firewall_rules\" {\n  source  = \"terraform-google-modules/network/google//modules/firewall-rules\"\n  version = \"~> 10.0\"\n  count   = var.private_worker_pool.enable_network_peering ? 1 : 0\n\n  project_id   = var.project_id\n  network_name = local.peered_network_id\n\n  rules = [{\n    name                    = \"fw-b-cbpools-100-i-a-all-all-all-service-networking\"\n    description             = \"allow ingres from the IPs configured for service networking\"\n    direction               = \"INGRESS\"\n    priority                = 100\n    source_tags             = null\n    source_service_accounts = null\n    target_tags             = null\n    target_service_accounts = null\n\n    ranges = [local.peered_ip_range]\n\n    allow = [{\n      protocol = \"all\"\n      ports    = null\n    }]\n\n    deny = []\n\n    log_config = {\n      metadata = \"INCLUDE_ALL_METADATA\"\n    }\n  }]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-example-foundation__0-bootstrap__modules__cb-private-pool__network.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-example-foundation__0-bootstrap__modules__cb-private-pool__network.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-example-foundation__0-bootstrap__modules__cb-private-pool__network.tf", "start_line": 91}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"proxmox_virtual_environment_file\" \"talos_image\" {\n  content_type = \"iso\"\n  datastore_id = var.talos_image_datastore\n  node_name    = var.talos_image_node_name\n\n  source_file {\n    path      = \"https://github.com/siderolabs/talos/releases/download/${var.talos_version}/nocloud-amd64.raw.xz\"\n    file_name = \"talos-${var.talos_version}-nocloud-amd64.iso\"\n  }\n\n  connection {\n    type     = \"ssh\"\n    user     = \"root\"\n    password = var.proxmox_ssh_key_path\n    host     = var.proxmox_hostname\n  }\n\n  # Proxmox won't let you upload a xz archive as a disk image. So trick it by saving the file as *.iso.\n  # Afterwards, use a remote-exec provisioner to name it back to *.xz and, finally, extract it. \n  provisioner \"remote-exec\" {\n    inline = [\n      \"mv /var/lib/vz/template/iso/talos-${var.talos_version}-nocloud-amd64.iso /var/lib/vz/template/iso/talos-${var.talos_version}-nocloud-amd64.iso.xz\",\n      \"unxz -f /var/lib/vz/template/iso/talos-${var.talos_version}-nocloud-amd64.iso.xz\"\n    ]\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/zimmertr__TJs-Kubernetes-Service__talos_image.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.0\"\n    }\n  }\n}\n\n# Main region where the resources should be created in\n# Should be close to the location of your viewers\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\n# Provider used for creating the Lambda@Edge function which must be deployed\n# to us-east-1 region (Should not be changed)\nprovider \"aws\" {\n  alias  = \"global_region\"\n  region = \"us-east-1\"\n}\n\n###########\n# Variables\n###########\n\nvariable \"custom_domain\" {\n  description = \"Your custom domain\"\n  type        = string\n  default     = \"example.com\"\n}\n\n# Assuming that the ZONE of your domain is already available in your AWS account (Route 53)\n# https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/AboutHZWorkingWith.html\nvariable \"custom_domain_zone_name\" {\n  description = \"The Route53 zone name of the custom domain\"\n  type        = string\n  default     = \"example.com.\"\n}\n\n########\n# Locals\n########\n\nlocals {\n  # A wildcard domain(ex: *.example.com) has to be added when using atomic deployments:\n  aliases = [var.custom_domain, \"*.${var.custom_domain}\"]\n}\n\n#######################\n# Route53 Domain record\n#######################\n\n# Get the hosted zone for the custom domain\ndata \"aws_route53_zone\" \"custom_domain_zone\" {\n  name = var.custom_domain_zone_name\n}\n\n# Create a new record in Route 53 for the domain\nresource \"aws_route53_record\" \"cloudfront_alias_domain\" {\n  for_each = toset(local.aliases)\n\n  zone_id = data.aws_route53_zone.custom_domain_zone.zone_id\n  name    = each.key\n  type    = \"A\"\n\n  alias {\n    name                   = module.tf_next.cloudfront_domain_name\n    zone_id                = module.tf_next.cloudfront_hosted_zone_id\n    evaluate_target_health = false\n  }\n}\n\n##########\n# SSL Cert\n##########\n\n# Creates a free SSL certificate for CloudFront distribution\n# For more options (e.g. multiple domains) see:\n# https://registry.terraform.io/modules/terraform-aws-modules/acm/aws/\nmodule \"cloudfront_cert\" {\n  source  = \"terraform-aws-modules/acm/aws\"\n  version = \"~> 3.0\"\n\n  domain_name               = var.custom_domain\n  zone_id                   = data.aws_route53_zone.custom_domain_zone.zone_id\n  subject_alternative_names = slice(local.aliases, 1, length(local.aliases))\n\n  wait_for_validation = true\n\n  tags = {\n    Name = \"CloudFront ${var.custom_domain}\"\n  }\n\n  # CloudFront works only with certs stored in us-east-1\n  providers = {\n    aws = aws.global_region\n  }\n}\n\n##########################\n# Terraform Next.js Module\n##########################\n\nmodule \"tf_next\" {\n  source  = \"milliHQ/next-js/aws\"\n  version = \"1.0.0-canary.5\"\n\n  cloudfront_aliases             = local.aliases\n  cloudfront_acm_certificate_arn = module.cloudfront_cert.acm_certificate_arn\n\n  deployment_name = \"atomic-deployments\"\n\n  enable_multiple_deployments      = true\n  multiple_deployments_base_domain = \"*.${var.custom_domain}\"\n\n  providers = {\n    aws.global_region = aws.global_region\n  }\n\n  # Uncomment when using in the cloned monorepo for tf-next development\n  # source = \"../..\"\n  # debug_use_local_packages = true\n}\n\n#########\n# Outputs\n#########\n\noutput \"api_endpoint\" {\n  value = module.tf_next.api_endpoint\n}\n\noutput \"api_endpoint_access_policy_arn\" {\n  value = module.tf_next.api_endpoint_access_policy_arn\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/milliHQ__terraform-aws-next-js__examples__atomic-deployments__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/milliHQ__terraform-aws-next-js__examples__atomic-deployments__main.tf", "start_line": 81}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/milliHQ__terraform-aws-next-js__examples__atomic-deployments__main.tf", "start_line": 105}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"image\" {\n  type = map\n  description = \"image for container\"\n  default = {\n    dev = \"nodered/node-red:latest\"\n    prod = \"nodered/node-red:latest-minimal\"\n  }\n}\n\nvariable \"ext_port\" {\n  type = map\n\n    validation {\n      condition     = max(var.ext_port[\"dev\"]...) <= 65535 && min(var.ext_port[\"dev\"]...) >= 1980\n      error_message = \"The external port must be in the valid port range 0 - 65535.\"\n    }\n    \n        validation {\n      condition     = max(var.ext_port[\"prod\"]...) < 1980 && min(var.ext_port[\"prod\"]...) >= 1880\n      error_message = \"The external port must be in the valid port range 0 - 65535.\"\n    }\n}\n\nvariable \"int_port\" {\n  type    = number\n  default = 1880\n\n  validation {\n    condition     = var.int_port == 1880\n    error_message = \"The internal port must be 1880.\"\n  }\n}\n\nlocals {\n  container_count = length(var.ext_port[terraform.workspace])\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/troy-ingram__terraform__terraform-docker__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Configure the Azure provider\nterraform {\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"~> 2.90.0\"\n    }\n  }\n\n  required_version = \">= 0.14.9\"\n}\n\nprovider \"azurerm\" {\n  features {}\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__terraform-azure-2453108__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvariable \"project_id\" {\n  description = \"The project ID to host the network in\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-network__examples__basic_custom_mode__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"configure_kubectl\" {\n  description = \"Configure kubectl: make sure you're logged in with the correct AWS profile and run the following command to update your kubeconfig\"\n  value       = <<-EOT\n    export KUBECONFIG=\"/tmp/${module.eks.cluster_name}\"\n    aws eks --region ${local.region} update-kubeconfig --name ${module.eks.cluster_name}\n  EOT\n}\n\noutput \"configure_argocd\" {\n  description = \"Terminal Setup\"\n  value       = <<-EOT\n    export KUBECONFIG=\"/tmp/${module.eks.cluster_name}\"\n    aws eks --region ${local.region} update-kubeconfig --name ${module.eks.cluster_name}\n    export ARGOCD_OPTS=\"--port-forward --port-forward-namespace argocd --grpc-web\"\n    kubectl config set-context --current --namespace argocd\n    argocd login --port-forward --username admin --password $(argocd admin initial-password | head -1)\n    echo \"ArgoCD Username: admin\"\n    echo \"ArgoCD Password: $(kubectl get secrets argocd-initial-admin-secret -n argocd --template=\"{{index .data.password | base64decode}}\")\"\n    echo Port Forward: http://localhost:8080\n    kubectl port-forward -n argocd svc/argo-cd-argocd-server 8080:80\n    EOT\n}\n\noutput \"access_argocd\" {\n  description = \"ArgoCD Access\"\n  value       = <<-EOT\n    export KUBECONFIG=\"/tmp/${module.eks.cluster_name}\"\n    aws eks --region ${local.region} update-kubeconfig --name ${module.eks.cluster_name}\n    echo \"ArgoCD Username: admin\"\n    echo \"ArgoCD Password: $(kubectl get secrets argocd-initial-admin-secret -n argocd --template=\"{{index .data.password | base64decode}}\")\"\n    echo \"ArgoCD URL: https://$(kubectl get svc -n argocd argo-cd-argocd-server -o jsonpath='{.status.loadBalancer.ingress[0].hostname}')\"\n    EOT\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gitops-bridge-dev__gitops-bridge__argocd__iac__terraform__examples__eks__argo-workflows__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"cloudflare_account\" \"example_account\" {\n  account_id = \"023e105f4ecef8ad9ca31a8372d0c353\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudflare__terraform-provider-cloudflare__examples__data-sources__cloudflare_account__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"instance_ip\" {\n    value = aws_instance.web.*.public_ip\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__interpolacion__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n    region = \"us-east-1\"  \n}\n\nresource \"aws_instance\" \"foo\" {\n  ami           = \"ami-05fa00d4c63e32376\" # us-west-2\n  instance_type = \"t2.micro\"\n  tags = {\n      Name = \"TF-Instance\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/yeshwanthlm__Terraform-Jenkins__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/yeshwanthlm__Terraform-Jenkins__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/yeshwanthlm__Terraform-Jenkins__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/yeshwanthlm__Terraform-Jenkins__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/yeshwanthlm__Terraform-Jenkins__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/yeshwanthlm__Terraform-Jenkins__main.tf", "start_line": 5}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Lambda Function\noutput \"lambda_function_arn\" {\n  description = \"The ARN of the Lambda Function\"\n  value       = module.lambda_function.lambda_function_arn\n}\n\noutput \"lambda_function_arn_static\" {\n  description = \"The static ARN of the Lambda Function. Use this to avoid cycle errors between resources (e.g., Step Functions)\"\n  value       = module.lambda_function.lambda_function_arn_static\n}\n\noutput \"lambda_function_invoke_arn\" {\n  description = \"The Invoke ARN of the Lambda Function\"\n  value       = module.lambda_function.lambda_function_invoke_arn\n}\n\noutput \"lambda_function_name\" {\n  description = \"The name of the Lambda Function\"\n  value       = module.lambda_function.lambda_function_name\n}\n\noutput \"lambda_function_qualified_arn\" {\n  description = \"The ARN identifying your Lambda Function Version\"\n  value       = module.lambda_function.lambda_function_qualified_arn\n}\n\noutput \"lambda_function_version\" {\n  description = \"Latest published version of Lambda Function\"\n  value       = module.lambda_function.lambda_function_version\n}\n\noutput \"lambda_function_last_modified\" {\n  description = \"The date Lambda Function resource was last modified\"\n  value       = module.lambda_function.lambda_function_last_modified\n}\n\noutput \"lambda_function_kms_key_arn\" {\n  description = \"The ARN for the KMS encryption key of Lambda Function\"\n  value       = module.lambda_function.lambda_function_kms_key_arn\n}\n\noutput \"lambda_function_source_code_hash\" {\n  description = \"Base64-encoded representation of raw SHA-256 sum of the zip file\"\n  value       = module.lambda_function.lambda_function_source_code_hash\n}\n\noutput \"lambda_function_source_code_size\" {\n  description = \"The size in bytes of the function .zip file\"\n  value       = module.lambda_function.lambda_function_source_code_size\n}\n\n# Lambda Layer\noutput \"lambda_layer_arn\" {\n  description = \"The ARN of the Lambda Layer with version\"\n  value       = module.lambda_function.lambda_layer_arn\n}\n\noutput \"lambda_layer_layer_arn\" {\n  description = \"The ARN of the Lambda Layer without version\"\n  value       = module.lambda_function.lambda_layer_layer_arn\n}\n\noutput \"lambda_layer_created_date\" {\n  description = \"The date Lambda Layer resource was created\"\n  value       = module.lambda_function.lambda_layer_created_date\n}\n\noutput \"lambda_layer_source_code_size\" {\n  description = \"The size in bytes of the Lambda Layer .zip file\"\n  value       = module.lambda_function.lambda_layer_source_code_size\n}\n\noutput \"lambda_layer_version\" {\n  description = \"The Lambda Layer version\"\n  value       = module.lambda_function.lambda_layer_version\n}\n\n# IAM Role\noutput \"lambda_role_arn\" {\n  description = \"The ARN of the IAM role created for the Lambda Function\"\n  value       = module.lambda_function.lambda_role_arn\n}\n\noutput \"lambda_role_name\" {\n  description = \"The name of the IAM role created for the Lambda Function\"\n  value       = module.lambda_function.lambda_role_name\n}\n\n# Deployment package\noutput \"local_filename\" {\n  description = \"The filename of zip archive deployed (if deployment was from local)\"\n  value       = module.lambda_function.local_filename\n}\n\noutput \"s3_object\" {\n  description = \"The map with S3 object data of zip archive deployed (if deployment was from S3)\"\n  value       = module.lambda_function.s3_object\n}\n\n###############\n# Lambda Alias\n###############\noutput \"lambda_alias_name\" {\n  description = \"The name of the Lambda Function Alias\"\n  value       = module.alias_refresh.lambda_alias_name\n}\n\noutput \"lambda_alias_arn\" {\n  description = \"The ARN of the Lambda Function Alias\"\n  value       = module.alias_refresh.lambda_alias_arn\n}\n\noutput \"lambda_alias_invoke_arn\" {\n  description = \"The ARN to be used for invoking Lambda Function from API Gateway\"\n  value       = module.alias_refresh.lambda_alias_invoke_arn\n}\n\noutput \"lambda_alias_description\" {\n  description = \"Description of alias\"\n  value       = module.alias_refresh.lambda_alias_description\n}\n\noutput \"lambda_alias_function_version\" {\n  description = \"Lambda function version which the alias uses\"\n  value       = module.alias_refresh.lambda_alias_function_version\n}\n\noutput \"lambda_alias_event_source_mapping_function_arn\" {\n  description = \"The the ARN of the Lambda function the event source mapping is sending events to\"\n  value       = module.alias_no_refresh.lambda_alias_event_source_mapping_function_arn\n}\n\noutput \"lambda_alias_event_source_mapping_state\" {\n  description = \"The state of the event source mapping\"\n  value       = module.alias_no_refresh.lambda_alias_event_source_mapping_state\n}\n\noutput \"lambda_alias_event_source_mapping_state_transition_reason\" {\n  description = \"The reason the event source mapping is in its current state\"\n  value       = module.alias_no_refresh.lambda_alias_event_source_mapping_state_transition_reason\n}\n\noutput \"lambda_alias_event_source_mapping_uuid\" {\n  description = \"The UUID of the created event source mapping\"\n  value       = module.alias_no_refresh.lambda_alias_event_source_mapping_uuid\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-lambda__examples__alias__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_role\" \"iam-role\" {\n  name               = var.iam-role\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nEOF\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__iam-role.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  alias   = \"east\"\n  region  = \"us-east-1\"\n}\n\nprovider \"aws\" {\n  alias   = \"west\"\n  region  = \"us-west-1\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/starhawking__python-terrascript__docs__tutorials__provider1.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# The following example shows how to generate a unique name for an AWS EC2\n# instance that changes each time a new AMI id is selected.\n\nresource \"random_id\" \"server\" {\n  keepers = {\n    # Generate a new id each time we switch to a new AMI id\n    ami_id = var.ami_id\n  }\n\n  byte_length = 8\n}\n\nresource \"aws_instance\" \"server\" {\n  tags = {\n    Name = \"web-server ${random_id.server.hex}\"\n  }\n\n  # Read the AMI id \"through\" the random_id resource to ensure that\n  # both will change together.\n  ami = random_id.server.keepers.ami_id\n\n  # ... (other aws_instance arguments) ...\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_id__resource.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_id__resource.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_id__resource.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_id__resource.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_id__resource.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_id__resource.tf", "start_line": 13}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"random_shuffle\" \"az\" {\n  input        = [\"us-west-1a\", \"us-west-1c\", \"us-west-1d\", \"us-west-1e\"]\n  result_count = 2\n}\n\nresource \"aws_elb\" \"example\" {\n  # Place the ELB in any two of the given availability zones, selected\n  # at random.\n  availability_zones = random_shuffle.az.result\n\n  # ... and other aws_elb arguments ...\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_shuffle__resource.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_92", "severity": "HIGH", "message": "Ensure the ELB has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_shuffle__resource.tf", "start_line": 6}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// from ENV\n\n\n\nvariable \"availability_zone\" {\n  description = \"availability zone to create subnet\"\n  default = \"us-east-2a\"\n}\nvariable \"public_key_path\" {\n  description = \"Public key path\"\n  default = \"~/.ssh/id_rsa.pub\"\n}\nvariable \"instance_ami\" {\n  description = \"AMI for aws EC2 instance\"\n  default = \"ami-0cf31d971a3ca20d6\"\n}\nvariable \"instance_type\" {\n  description = \"type for aws EC2 instance\"\n  default = \"t2.micro\"\n}\nvariable \"environment_tag\" {\n  description = \"Environment tag\"\n  default = \"Production\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/codeaprendiz__learn_devops__home__infrastructure_as_code__terraform__aws__taskset_aws_terraform_infrastructure_as_code__task_002_defaultVPC_sbnt_sg_kp_ec2__00-var.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Provider\nprovider \"aws\" {\n  region = \"us-east-2\"\n}\n# VPC\nresource \"aws_vpc\" \"vpc\" {\n  cidr_block = var.vpc_cidr\n  enable_dns_hostnames = true\n  tags = {\n    Name = \"demo_vpc\"\n  }\n}\n# IGW for demo_vpc\nresource \"aws_internet_gateway\" \"vpc_igw\" {\n  vpc_id = aws_vpc.vpc.id\n  tags = {\n    Name = \"demo_vpc_igw\"\n  }\n}\n\n# Subenets in demo_vpc\nresource \"aws_subnet\" \"subnets\" {\n  count                   = length(var.subnets_cidr)\n  vpc_id                  = aws_vpc.vpc.id\n  cidr_block              = element(var.subnets_cidr, count.index)\n  availability_zone       = element(var.availability_zones, count.index)\n  map_public_ip_on_launch = true\n  tags = {\n    Name = \"demo_vpc_subnet_${count.index + 1}\"\n  }\n}\n# Route table for demo_vpc\nresource \"aws_route_table\" \"public_rt\" {\n  vpc_id = aws_vpc.vpc.id\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.vpc_igw.id\n  }\n  tags = {\n    Name = \"demo_vpc_public_rt\"\n  }\n}\n\n# Route table and subnets assocation\nresource \"aws_route_table_association\" \"rt_sub_association\" {\n  count          = length(var.subnets_cidr)\n  subnet_id      = element(aws_subnet.subnets.*.id, count.index)\n  route_table_id = aws_route_table.public_rt.id\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__vpc.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__vpc.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__vpc.tf", "start_line": 6}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource-1: Azure Resource Group\nresource \"azurerm_resource_group\" \"myrg1\" {\n  name = \"myrg-1\"\n  location = \"East US\"\n}\n\n# Resource-2: Random String \nresource \"random_string\" \"myrandom\" {\n  length = 16\n  upper = false \n  special = false\n}\n\n# Resource-3: Azure Storage Account \nresource \"azurerm_storage_account\" \"mysa\" {\n  name                     = \"mysa${random_string.myrandom.id}\"\n  resource_group_name      = azurerm_resource_group.myrg1.name\n  location                 = azurerm_resource_group.myrg1.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"GRS\"\n  account_encryption_source = \"Microsoft.Storage\"\n\n  tags = {\n    environment = \"staging\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c2-resource-group-storage-container.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_59", "severity": "HIGH", "message": "Ensure that Storage accounts disallow public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c2-resource-group-storage-container.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AZURE_33", "severity": "HIGH", "message": "Ensure Storage logging is enabled for Queue service for read, write and delete requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c2-resource-group-storage-container.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AZURE_44", "severity": "HIGH", "message": "Ensure Storage Account is using the latest version of TLS encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c2-resource-group-storage-container.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AZURE_190", "severity": "HIGH", "message": "Ensure that Storage blobs restrict public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c2-resource-group-storage-container.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AZURE_40", "severity": "CRITICAL", "message": "Ensure storage account is not configured with Shared Key authorization", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c2-resource-group-storage-container.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AZURE_47", "severity": "CRITICAL", "message": "Ensure storage account is configured without blob anonymous access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c2-resource-group-storage-container.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AZURE_33", "severity": "CRITICAL", "message": "Ensure storage account is configured with private endpoint", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c2-resource-group-storage-container.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AZURE_41", "severity": "CRITICAL", "message": "Ensure storage account is configured with SAS expiration policy", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c2-resource-group-storage-container.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AZURE_38", "severity": "CRITICAL", "message": "Ensure soft-delete is enabled on Azure storage account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c2-resource-group-storage-container.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AZURE_1", "severity": "CRITICAL", "message": "Ensure storage for critical data are encrypted with Customer Managed Key", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c2-resource-group-storage-container.tf", "start_line": 15}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\n * Deploy VPC and network resources\n */\n## VPC\nmodule \"vpc\" {\n  source  = \"terraform-google-modules/network/google\"\n  version = \"~> 9.0\"\n\n  network_name   = var.vpc_name\n  project_id     = var.project_id\n  routing_mode   = \"GLOBAL\"\n  subnets        = local.kasm_subnets\n  routes         = local.kasm_routes\n  firewall_rules = local.firewall_rules\n  mtu            = \"1500\"\n}\n\n## NAT Gateway\nmodule \"cloud_nat\" {\n  source   = \"terraform-google-modules/cloud-nat/google\"\n  version  = \"~> 5.0\"\n  for_each = toset(var.kasm_deployment_regions)\n\n  name                                = \"${each.key}-nat-gateway\"\n  network                             = module.vpc.network_self_link\n  project_id                          = var.project_id\n  region                              = each.key\n  create_router                       = true\n  router                              = \"${each.key}-router\"\n  enable_dynamic_port_allocation      = true\n  enable_endpoint_independent_mapping = false\n}\n\n/*\n * Deploy Kasm WebApps\n */\n## Create Kasm Webapp Instance Groups\nmodule \"webapp_instance_template\" {\n  source   = \"terraform-google-modules/vm/google//modules/instance_template\"\n  version  = \"~> 11.0\"\n  for_each = toset(var.kasm_deployment_regions)\n\n  project_id           = var.project_id\n  network              = local.vpc_network_self_link\n  subnetwork           = \"${each.key}-webapp-subnet\"\n  region               = each.key\n  service_account      = var.compute_service_account\n  name_prefix          = substr(\"${each.key}-${var.webapp_hostname_prefix}-template\", 0, 37)\n  source_image_project = var.kasm_source_image.project\n  source_image_family  = var.kasm_source_image.family\n  machine_type         = var.webapp_vm_instance_config.machine_type\n  disk_size_gb         = var.webapp_vm_instance_config.disk_size_gb\n  disk_type            = var.webapp_vm_instance_config.disk_type\n  tags                 = var.kasm_firewall_security_tags.webapp\n  startup_script       = local.webapp_startup_scripts[each.key]\n  labels               = local.resource_labels\n}\n\n## Create Kasm Webapp Instance groups\nmodule \"webapp_instance_group\" {\n  source   = \"terraform-google-modules/vm/google//modules/mig\"\n  version  = \"~> 11.0\"\n  for_each = toset(var.kasm_deployment_regions)\n\n  project_id                   = var.project_id\n  mig_name                     = \"${each.key}-${var.webapp_hostname_prefix}-group\"\n  instance_template            = local.webapp_instance_template_self_link[each.key]\n  region                       = each.key\n  hostname                     = \"${each.key}-${var.webapp_hostname_prefix}\"\n  named_ports                  = var.webapp_named_ports\n  health_check_name            = \"${each.key}-${var.webapp_health_check_name}\"\n  health_check                 = var.webapp_health_check\n  autoscaling_enabled          = true\n  max_replicas                 = var.webapp_autoscale_max_instances\n  min_replicas                 = var.webapp_autoscale_min_instances\n  cooldown_period              = var.webapp_autoscale_cool_down_period\n  autoscaling_cpu              = var.webapp_autoscale_scale_out_cpu\n  autoscaling_scale_in_control = var.webapp_autoscale_scale_in_settings\n}\n\n/*\n * Deploy WebApp public and private load balancers\n */\n## Internal (private) Load balancers for Agent auth\nmodule \"webapp_private_load_balancer\" {\n  source   = \"./modules/private_load_balancer\"\n  for_each = toset(var.kasm_deployment_regions)\n\n  project      = var.project_id\n  region       = each.key\n  network      = module.vpc.network_name\n  subnetwork   = one([for subnet in module.vpc.subnets_names : subnet if can(regex(\"${each.key}.webapp\", subnet))])\n  name         = \"${each.key}-webapp-private-load-balancer\"\n  port_range   = var.webapp_named_ports[0].port\n  ip_protocol  = \"TCP\"\n  named_port   = var.webapp_named_ports[0].name\n  health_check = var.webapp_health_check\n  backends     = local.private_load_balancer_backends[each.key]\n\n  depends_on = [module.vpc]\n}\n\n## Public access Load balancer for client Kasm access\nmodule \"public_load_balancer\" {\n  source  = \"GoogleCloudPlatform/lb-http/google\"\n  version = \"~> 10.0\"\n\n  name                            = var.public_load_balancer_name\n  project                         = var.project_id\n  https_redirect                  = true\n  ssl                             = local.use_lb_ssl\n  managed_ssl_certificate_domains = local.managed_ssl_domains\n  certificate_map                 = local.cert_manager_map_name\n  firewall_networks               = []\n  firewall_projects               = []\n  backends                        = local.public_load_balancer_backends\n}\n\n/*\n * Deploy Kasm Database\n */\n## Database Instance\nmodule \"database_instance\" {\n  source               = \"./modules/compute_instance\"\n  instance_details     = var.database_vm_instance_config\n  instance_network     = local.vpc_network_self_link\n  instance_subnetwork  = \"${var.kasm_deployment_regions[0]}-database-subnet\"\n  source_image         = [var.kasm_source_image]\n  service_account      = [var.compute_service_account]\n  cloud_init_script    = local.database_startup_config\n  security_tags        = var.kasm_firewall_security_tags.database\n  resource_labels      = local.resource_labels\n  public_access_config = []\n  kasm_region          = var.kasm_deployment_regions[0]\n\n  depends_on = [module.vpc]\n}\n\n/*\n * Deploy Kasm Agents\n */\n## Agent Instances\nmodule \"agent_instances\" {\n  source   = \"./modules/compute_instance\"\n  for_each = toset(var.kasm_deployment_regions)\n\n  number_of_instances  = var.number_of_agents_per_region\n  instance_details     = var.agent_vm_instance_config\n  instance_network     = local.vpc_network_self_link\n  instance_subnetwork  = \"${each.key}-agent-subnet\"\n  source_image         = [var.kasm_source_image]\n  service_account      = [var.compute_service_account]\n  cloud_init_script    = local.agent_startup_configs[each.key]\n  security_tags        = var.kasm_firewall_security_tags.agent\n  resource_labels      = local.resource_labels\n  public_access_config = local.agent_public_ip\n  kasm_region          = each.key\n\n  depends_on = [module.vpc]\n}\n\n/*\n * Deploy Kasm Connection Proxy (CPX/Guac)\n */\n## Create Kasm CPX Instance templates\nmodule \"cpx_instance_template\" {\n  source   = \"terraform-google-modules/vm/google//modules/instance_template\"\n  version  = \"~> 11.0\"\n  for_each = var.deploy_connection_proxy ? toset(var.kasm_deployment_regions) : []\n\n  project_id           = var.project_id\n  network              = local.vpc_network_self_link\n  subnetwork           = \"${each.key}-cpx-subnet\"\n  region               = each.key\n  service_account      = var.compute_service_account\n  name_prefix          = substr(\"${each.key}-${var.cpx_hostname_prefix}-template\", 0, 63)\n  source_image_project = var.kasm_source_image.project\n  source_image_family  = var.kasm_source_image.family\n  machine_type         = var.cpx_vm_instance_config.machine_type\n  disk_size_gb         = var.cpx_vm_instance_config.disk_size_gb\n  disk_type            = var.cpx_vm_instance_config.disk_type\n  tags                 = var.kasm_firewall_security_tags.webapp\n  startup_script       = local.cpx_startup_configs[each.key]\n  labels               = local.resource_labels\n\n  depends_on = [module.vpc]\n}\n\n## Create Kasm Webapp Instance groups\nmodule \"cpx_instance_group\" {\n  source   = \"terraform-google-modules/vm/google//modules/mig\"\n  version  = \"~> 11.0\"\n  for_each = var.deploy_connection_proxy ? toset(var.kasm_deployment_regions) : []\n\n  project_id                   = var.project_id\n  mig_name                     = \"${each.key}-cpx-instance-group\"\n  instance_template            = local.cpx_instance_template_self_link[each.key]\n  region                       = each.key\n  hostname                     = \"${each.key}-${var.cpx_hostname_prefix}-group\"\n  named_ports                  = var.cpx_named_ports\n  autoscaling_enabled          = true\n  max_replicas                 = var.cpx_autoscale_max_instances\n  min_replicas                 = var.cpx_autoscale_min_instances\n  cooldown_period              = var.cpx_autoscale_cool_down_period\n  autoscaling_cpu              = var.cpx_autoscale_scale_out_cpu\n  autoscaling_scale_in_control = var.cpx_autoscale_scale_in_settings\n}\n\n/*\n * Deploy DNS\n */\n## Public DNS Zone\nmodule \"dns_public_zone\" {\n  source  = \"terraform-google-modules/cloud-dns/google\"\n  version = \"~> 5.0\"\n  count   = var.create_public_dns_zone ? 1 : 0\n\n  type       = \"public\"\n  project_id = var.project_id\n  name       = var.public_dns_friendly_name\n  domain     = \"${var.kasm_domain_name}.\"\n  recordsets = local.public_dns_records\n}\n\n## Add records to existing public DNS zone (e.g. this TF didn't create the public zone)\nmodule \"dns_public_records\" {\n  source = \"./modules/dns_records\"\n  count  = var.create_public_dns_zone ? 0 : 1\n\n  project_id = var.project_id\n  name       = var.public_dns_friendly_name\n  domain     = var.kasm_domain_name\n  recordsets = local.public_dns_records\n}\n\n## Private DNS Zone\nmodule \"dns_private_zone\" {\n  source  = \"terraform-google-modules/cloud-dns/google\"\n  version = \"~> 5.0\"\n\n  type                               = \"private\"\n  project_id                         = var.project_id\n  name                               = var.private_dns_friendly_name\n  domain                             = \"private.${var.kasm_domain_name}.\"\n  private_visibility_config_networks = [local.vpc_network_self_link]\n  recordsets                         = local.private_dns_records\n}\n\n/*\n * Create Kasm Autoscale service IAM account\n */\nmodule \"kasm_autoscale_service_account\" {\n  source = \"./modules/service_account_iam\"\n  count  = var.create_kasm_autoscale_service_account ? 1 : 0\n\n  project_id = var.project_id\n  account_id = var.service_account_name\n}\n\n/*\n * Create passwords (always run, but not alwayse used). Refer\n * to locals.tf for conditional usage.\n */\nmodule \"passwords\" {\n  source       = \"./modules/random\"\n  count        = 6\n  kasm_version = var.kasm_version\n}\n\n/*\n * Create Public GCP-managed SSL cert in Cert Manager\n *\n * Using Certificate manager only works with this Terraform if you deploy it independently,\n * then reference the created certificate map ID directly. There is a concurrency issue\n * with Terraform that causes problems, so, this and the referenced module serve as an\n * example deployment method until this issue is resolved.\n */\n# module \"certificate_manager\" {\n#   source = \"./modules/certificate_manager\"\n#   count  = var.use_gcp_certificate_manager ? 1 : 0\n\n#   domain_name                        = var.kasm_domain_name\n#   dns_managed_zone_name              = local.public_dns_name\n#   certificate_name                   = local.tls_certificate_name\n#   certificate_dns_authorization_name = local.tls_certificate_dns_auth_name\n#   certificate_map_name               = local.tls_certificate_map_name\n#   resource_labels                    = var.resource_labels\n# }\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__gcp__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__gcp__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__gcp__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__gcp__main.tf", "start_line": 38}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__gcp__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__gcp__main.tf", "start_line": 104}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__gcp__main.tf", "start_line": 166}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__gcp__main.tf", "start_line": 190}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__gcp__main.tf", "start_line": 213}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__gcp__main.tf", "start_line": 237}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"runners\" {\n  value = {\n    lambda_syncer_name = module.runners.binaries_syncer.lambda.function_name\n  }\n}\n\noutput \"webhook_endpoint\" {\n  value = module.runners.webhook.endpoint\n}\n\noutput \"webhook_secret\" {\n  sensitive = true\n  value     = random_id.random.hex\n}\n\noutput \"deprecated_variables_warning\" {\n  value = join(\"\", [\n    module.runners.deprecated_variables_warning,\n  ])\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/github-aws-runners__terraform-aws-github-runner__examples__default__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"region\" {\n  default = \"cn-beijing\"\n}\n\nvariable \"vpc_cidr\" {\n  default = \"10.1.0.0/21\"\n}\n\nvariable \"vswitch_cidr\" {\n  default = \"10.1.1.0/24\"\n}\n\nvariable \"ecs_password\" {\n  default = \"Test1234567*\"\n}\n\nvariable \"disk_category\" {\n  default = \"cloud_efficiency\"\n}\n\nvariable \"db_name\" {\n  default = \"lnmp\"\n}\n\nvariable \"db_user\" {\n  default = \"alier\"\n}\n\nvariable \"db_password\" {\n  default = \"123456\"\n}\n\nvariable \"db_root_password\" {\n  default = \"123456\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alibaba__terraform-provider__examples__build-lnmp__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Author: Roxana Kovaci\n# Twitter: @RoxanaKovaci\n\n#############################################################################\n# VARIABLES\n#############################################################################\n\nvariable \"domain\" {\n  type          = string\n  description   = \"Domain name (for example: contoso.onmicrosoft.com)\"\n}\n\nvariable \"user_name1\" {\n  type          = string\n  default       = \"chris.green\"\n  description   = \"User name\"\n}\n\nvariable \"user_name2\" {\n  type          = string\n  default       = \"peter.williams\"\n  description   = \"User name\"\n}\n\nvariable \"user_name3\" {\n  type          = string\n  default       = \"sqladmin\"\n  description   = \"User name\"\n}\n\nvariable \"user_password1\" {\n  type          = string\n  description   = \"Password\"\n}\n\nvariable \"user_password2\" {\n  type          = string\n  description   = \"Password\"\n}\n\nvariable \"user_password3\" {\n  type          = string\n  description   = \"Password\"\n}\n\nvariable \"resource_group_name\" {\n  type          = string\n  default       = \"Innovation\"\n  description   = \"The name of the Resource Group\"\n}\n\nvariable \"application_name\" {\n  type          = string\n  default       = \"InnovationApp\"\n  description   = \"The name of the App Register\"\n}\n\nvariable \"key_vault_name\" {\n  type          = string\n  default       = \"InnovationTeamKeyVault\"\n  description   = \"The name of the Key Vault\"\n}\n\nvariable \"automation_account_name\" {\n  type          = string\n  default       = \"InnovationAutomation\"\n  description   = \"The name of the Automation Account\"\n}\n\nvariable \"sql_server_name\" {\n  type          = string\n  default       = \"svrcustomerdb\"\n  description   = \"The name of the SQL Server\"\n}\n\nvariable \"sql_db_name\" {\n  type          = string\n  default       = \"CustomerPIIDB\"\n  description   = \"The name of the SQL DB\"\n}\n\n\n#############################################################################\n# DATA\n#############################################################################\n\ndata \"azurerm_subscription\" \"current\" {}\n\ndata \"azurerm_client_config\" \"current\" {}\n\n#############################################################################\n# PROVIDERS\n#############################################################################\n\nterraform {\n  required_providers {\n    azuread = {\n      source = \"hashicorp/azuread\"\n      version = \"2.22.0\"\n    }\n  }\n}\n\nprovider \"azuread\" {\n}\n\nprovider \"azurerm\" {\n  features {\n    key_vault {\n      purge_soft_delete_on_destroy = true\n    }\n  }\n}\n\n#############################################################################\n# RESOURCES\n#############################################################################\n\n## Resource Group ##\n\nresource \"azurerm_resource_group\" \"innovation\" {\n  name     = var.resource_group_name\n  location = \"East US\"\n}\n\n## AZURE AD USER ##\n\nresource \"azuread_user\" \"user1\" {\n  user_principal_name         = \"${var.user_name1}@${var.domain}\"\n  display_name                = var.user_name1\n  password                    = var.user_password1\n  disable_password_expiration = true\n}\n\nresource \"azuread_user\" \"user2\" {\n  user_principal_name         = \"${var.user_name2}@${var.domain}\"\n  display_name                = var.user_name2\n  password                    = var.user_password2\n  disable_password_expiration = true\n  department                  = \"Linux user\"\n}\n\nresource \"azuread_user\" \"user3\" {\n  user_principal_name         = \"${var.user_name3}@${var.domain}\"\n  display_name                = var.user_name3\n  password                    = var.user_password3\n  disable_password_expiration = true\n}\n\n\n## APP / SPN ##\nresource \"azuread_application\" \"InnovationApp\" {\n  display_name    = var.application_name\n}\n\nresource \"azuread_service_principal\" \"InnovationAppSPN\" {\n  application_id               = azuread_application.InnovationApp.application_id\n}\n\n## Key Vault ##\nresource \"azurerm_key_vault\" \"InnovationDeptKeyVault\" {\n  name                        = var.key_vault_name\n  location                    = azurerm_resource_group.innovation.location\n  resource_group_name         = azurerm_resource_group.innovation.name\n  enabled_for_disk_encryption = true\n  tenant_id                   = data.azurerm_client_config.current.tenant_id\n  soft_delete_retention_days  = 7\n  purge_protection_enabled    = false\n  sku_name                    = \"standard\"\n\n  access_policy {\n    tenant_id = data.azurerm_client_config.current.tenant_id\n    object_id = data.azurerm_client_config.current.object_id\n\n    key_permissions = [\n      \"Get\", \"Backup\", \"Delete\", \"List\", \"Purge\", \"Recover\", \"Restore\", \"Create\",\n    ]\n\n    secret_permissions = [\n      \"Backup\", \"Delete\", \"Get\", \"List\", \"Purge\", \"Recover\", \"Restore\", \"Set\",\n    ]\n\n    storage_permissions = [\n      \"Backup\", \"Delete\", \"Get\", \"List\", \"Update\", \"Recover\", \"Restore\",\n    ]\n  }\n\n  access_policy {\n    tenant_id = data.azurerm_client_config.current.tenant_id\n    object_id = azuread_service_principal.InnovationAppSPN.object_id\n    key_permissions = [\n      \"Get\", \"List\",\n    ]\n    secret_permissions = [\n      \"Get\", \"List\",\n    ]\n  }\n}\n\nresource \"azurerm_key_vault_secret\" \"ForPW\" {\n  name          = \"ForPW\"\n  value         = \"${var.user_password2}\"\n  key_vault_id  = azurerm_key_vault.InnovationDeptKeyVault.id\n  depends_on    = [azurerm_key_vault.InnovationDeptKeyVault]\n}\n\n## Automation Account ##\nresource \"azurerm_automation_account\" \"InnovationAutomationAccount\" {\n  name                = var.automation_account_name\n  location            = azurerm_resource_group.innovation.location\n  resource_group_name = azurerm_resource_group.innovation.name\n\n  sku_name = \"Basic\"\n}\n\nresource \"azurerm_automation_credential\" \"sa\" {\n  name                    = \"sa\"\n  resource_group_name     = azurerm_resource_group.innovation.name\n  automation_account_name = azurerm_automation_account.InnovationAutomationAccount.name\n  username                = \"sa@softwaresolutionsdons.com\"\n  password                = \"gROzIH&L2Zu4Ya\"\n}\n\nresource \"azurerm_automation_credential\" \"sqladmin\" {\n  name                    = \"sqladmin\"\n  resource_group_name     = azurerm_resource_group.innovation.name\n  automation_account_name = azurerm_automation_account.InnovationAutomationAccount.name\n  username                = \"${var.user_name3}@${var.domain}\"\n  password                = \"${var.user_password3}\"\n}\n\n## SQL DB ##\nresource \"azurerm_mssql_server\" \"AzureSQLServer\" {\n  name                         = var.sql_server_name\n  resource_group_name          = azurerm_resource_group.innovation.name\n  location                     = \"East US\"\n  version                      = \"12.0\"\n  administrator_login          = \"${var.user_name3}@${var.domain}\"\n  administrator_login_password = \"${var.user_password3}\"\n\n  azuread_administrator {\n    login_username = \"${var.user_name3}\"\n    object_id      = azuread_user.user3.id\n    azuread_authentication_only = true\n  }\n}\n\nresource \"azurerm_mssql_firewall_rule\" \"SQLFirewallRule\" {\n  name                = \"AlllowAzureServices\"\n  server_id           = azurerm_mssql_server.AzureSQLServer.id\n  start_ip_address    = \"X.X.X.X\"\n  end_ip_address      = \"X.X.X.X\"\n}\n\nresource \"azurerm_mssql_database\" \"AzureSQLDB\" {\n  name                = var.sql_db_name\n  server_id           = azurerm_mssql_server.AzureSQLServer.id\n  collation           = \"SQL_Latin1_General_CP1_CI_AS\"\n  max_size_gb         = 1\n  sku_name            = \"Basic\"\n  sample_name         = \"AdventureWorksLT\"\n}\n\n### AZURE ROLE AND ROLE ASSIGNMENT ###\n\n## Directory Roles\nresource \"azuread_directory_role\" \"appAdmin\" {\n  display_name = \"Application administrator\"\n}\n\nresource \"azuread_directory_role_member\" \"appAdminMembers\" {\n  role_object_id   = azuread_directory_role.appAdmin.object_id\n  member_object_id = azuread_user.user1.id\n}\n\n## RBAC Roles\nresource \"azurerm_role_assignment\" \"ACKeyVault1\" {\n  scope                = azurerm_key_vault.InnovationDeptKeyVault.id\n  role_definition_name = \"Key Vault Reader\"\n  principal_id         = azuread_service_principal.InnovationAppSPN.object_id\n}\n\nresource \"azurerm_role_assignment\" \"ACKeyVault2\" {\n  scope                = azurerm_key_vault.InnovationDeptKeyVault.id\n  role_definition_name = \"Key Vault Secrets User\"\n  principal_id         = azuread_service_principal.InnovationAppSPN.object_id\n}\n\nresource \"azurerm_role_assignment\" \"ACAutomationAccount\" {\n  scope                = azurerm_automation_account.InnovationAutomationAccount.id\n  role_definition_name = \"Contributor\"\n  principal_id         = azuread_user.user2.id\n}\n\nresource \"azurerm_role_assignment\" \"ACSQLServer\" {\n  scope                = azurerm_mssql_server.AzureSQLServer.id\n  role_definition_name = \"Reader\"\n  principal_id         = azuread_user.user3.id\n}\n\n## Conditional Access rules\nresource \"azuread_conditional_access_policy\" \"Linux\" {\n  display_name = \"Linux Users\"\n  state        = \"enabled\"\n\n  conditions {\n    client_app_types    = [\"all\"]\n\n    applications {\n      included_applications = [\"All\"]\n    }\n\n    locations {\n      included_locations = [\"All\"]\n    }\n\n    platforms {\n      included_platforms = [\"android\", \"iOS\", \"macOS\", \"windows\", \"windowsPhone\"]\n      excluded_platforms = [\"linux\"]\n    }\n\n    users {\n      included_users = [azuread_user.user2.id]\n    }\n  }\n\n  grant_controls {\n    operator          = \"AND\"\n    built_in_controls = [\"block\"]\n  }\n}\n\n## Output\noutput \"username\" {\n  value = \"${var.user_name1}@${var.domain}\"\n}\noutput \"password\" {\n  value = var.user_password1\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_189", "severity": "HIGH", "message": "Ensure that Azure Key Vault disables public network access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 161}, {"tool": "checkov", "rule_id": "CKV_AZURE_109", "severity": "HIGH", "message": "Ensure that key vault allows firewall rules settings", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 161}, {"tool": "checkov", "rule_id": "CKV_AZURE_110", "severity": "HIGH", "message": "Ensure that key vault enables purge protection", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 161}, {"tool": "checkov", "rule_id": "CKV_AZURE_42", "severity": "HIGH", "message": "Ensure the key vault is recoverable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 161}, {"tool": "checkov", "rule_id": "CKV_AZURE_114", "severity": "HIGH", "message": "Ensure that key vault secrets have \"content_type\" set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 200}, {"tool": "checkov", "rule_id": "CKV_AZURE_41", "severity": "HIGH", "message": "Ensure that the expiration date is set on all secrets", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 200}, {"tool": "checkov", "rule_id": "CKV_AZURE_52", "severity": "HIGH", "message": "Ensure MSSQL is using the latest version of TLS encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 233}, {"tool": "checkov", "rule_id": "CKV_AZURE_113", "severity": "HIGH", "message": "Ensure that SQL server disables public network access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 233}, {"tool": "checkov", "rule_id": "CKV_AZURE_224", "severity": "HIGH", "message": "Ensure that the Ledger feature is enabled on database that requires cryptographic proof and nonrepudiation of data integrity", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 255}, {"tool": "checkov", "rule_id": "CKV_AZURE_229", "severity": "HIGH", "message": "Ensure the Azure SQL Database Namespace is zone redundant", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 255}, {"tool": "checkov", "rule_id": "CKV2_AZURE_36", "severity": "CRITICAL", "message": "Ensure Azure automation account is configured with managed identity", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV2_AZURE_32", "severity": "CRITICAL", "message": "Ensure private endpoint is configured to key vault", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 161}, {"tool": "checkov", "rule_id": "CKV2_AZURE_45", "severity": "CRITICAL", "message": "Ensure Microsoft SQL server is configured with private endpoint", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 233}, {"tool": "checkov", "rule_id": "CKV2_AZURE_24", "severity": "CRITICAL", "message": "Ensure Azure automation account does NOT have overly permissive network access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV2_AZURE_2", "severity": "CRITICAL", "message": "Ensure that Vulnerability Assessment (VA) is enabled on a SQL server by setting a Storage Account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 233}, {"tool": "checkov", "rule_id": "CKV_AZURE_23", "severity": "HIGH", "message": "Ensure that 'Auditing' is set to 'On' for SQL servers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 233}, {"tool": "checkov", "rule_id": "CKV_AZURE_24", "severity": "HIGH", "message": "Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc1__kc1.tf", "start_line": 233}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// https://www.terraform.io/docs/providers/aws/r/default_subnet.html\n\nresource \"aws_default_subnet\" \"default_az1\" {\n  availability_zone = var.availability_zone\n\n  tags = {\n    Name = \"Default subnet for us-east-2a\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/codeaprendiz__learn_devops__home__infrastructure_as_code__terraform__aws__taskset_aws_terraform_infrastructure_as_code__task_002_defaultVPC_sbnt_sg_kp_ec2__15-subnet.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"kubernetes_deployment\" \"tf-efs-provisioner\" {\n\n  depends_on = [\n  kubernetes_storage_class.tf_efs_sc,\n  kubernetes_namespace.tf-ns\n  ]\n\n  metadata {\n    name = \"tf-efs-provisioner\"\n    namespace = \"terraform-prom-graf-namespace\"\n  }\n\n  spec {\n    replicas = 1\n    strategy {\n      type = \"Recreate\"\n    }\n    selector {\n      match_labels = {\n        app = \"tf-efs\"\n      }\n    }\n\n    template {\n      metadata {\n        labels = {\n          app = \"tf-efs\"\n        }\n      }\n\n      spec {\n        automount_service_account_token = true\n        container {\n          image = \"quay.io/external_storage/efs-provisioner:v0.1.0\"\n          name  = \"tf-efs-provision\"\n          env {\n            name  = \"FILE_SYSTEM_ID\"\n            value = data.aws_efs_file_system.tf-efs-fs.file_system_id\n          }\n          env {\n            name  = \"AWS_REGION\"\n            value = \"ap-south-1\"\n          }\n          env {\n            name  = \"PROVISIONER_NAME\"\n            value = kubernetes_storage_class.tf_efs_sc.storage_provisioner\n          }\n          volume_mount {\n            name       = \"pv-volume\"\n            mount_path = \"/persistentvolumes\"\n          }\n        }\n        volume {\n          name = \"pv-volume\"\n          nfs {\n            server = data.aws_efs_file_system.tf-efs-fs.dns_name\n            path   = \"/\"\n          }\n        }\n      }\n    }\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_K8S_30", "severity": "HIGH", "message": "Apply security context to your pods and containers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_11", "severity": "HIGH", "message": "CPU Limits should be set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_10", "severity": "HIGH", "message": "CPU requests should be set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_28", "severity": "HIGH", "message": "Minimize the admission of containers with the NET_RAW capability", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_43", "severity": "HIGH", "message": "Image should use digest", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_15", "severity": "HIGH", "message": "Image Pull Policy should be Always", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_8", "severity": "HIGH", "message": "Liveness Probe Should be Configured", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_12", "severity": "HIGH", "message": "Memory Limits should be set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_13", "severity": "HIGH", "message": "Memory requests should be set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_29", "severity": "HIGH", "message": "Apply security context to your pods, deployments and daemon_sets", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_K8S_9", "severity": "HIGH", "message": "Readiness Probe Should be Configured", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 4 - Terraform_EKS_Project__EFS setup__efs_provision.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"endpoint\" {\n  description = \"RDS endpoint hostname\"\n  value       = aws_db_instance.this.endpoint\n}\n\noutput \"port\" {\n  description = \"RDS port\"\n  value       = aws_db_instance.this.port\n}\n\noutput \"db_name\" {\n  description = \"Database name\"\n  value       = aws_db_instance.this.db_name\n}\n\noutput \"username\" {\n  description = \"Master username\"\n  value       = aws_db_instance.this.username\n  sensitive   = true\n}\n\noutput \"dbi_resource_id\" {\n  description = \"DB instance resource ID used for IAM auth resource ARNs\"\n  value       = aws_db_instance.this.resource_id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/onyx-dot-app__onyx__deployment__terraform__modules__aws__postgres__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2025 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n# tfdoc:file:description FAST context locals\n\nlocals {\n  # extract the map of all subnet ids and their networks\n  _subnet_ids = {\n    for k, v in local._all_instances : v.subnet_id => v.network_id...\n  }\n  # extract attributes from subnet ids\n  _subnet_attrs = {\n    for k, v in local._subnet_ids : k => merge(\n      {\n        id           = k\n        network_id   = v[0]\n        region       = split(\"/\", k)[0]\n        region_alias = lookup(var.regions, split(\"/\", k)[0], split(\"/\", k)[0])\n      },\n      !startswith(k, \"projects/\") ? {} : {\n        region = split(\"/\", k)[3]\n      }\n    )\n  }\n  # recompose subnet ids checking for context substitutions\n  _subnets = {\n    for k, v in local._subnet_attrs : k => merge(v, v.region_alias == null ? {} : {\n      id     = try(replace(v.id, v.region, v.region_alias))\n      region = coalesce(v.region_alias, v.region)\n    })\n  }\n  # derive product of instances and zones and expand instance contexts\n  instances = flatten([\n    for k, v in local._all_instances : [\n      for z in v.zones : merge(v, {\n        name       = \"${var.name}-${k}-${z}\"\n        network_id = lookup(var.vpc_self_links, v.network_id, v.network_id)\n        project_id = lookup(var.host_project_ids, v.project_id, v.project_id)\n        subnet_id = try(\n          var.subnet_self_links[v.network_id][local._subnets[v.subnet_id].id],\n          v.subnet_id\n        )\n        zone = \"${local._subnets[v.subnet_id].region_alias}-${z}\"\n      })\n    ]\n  ])\n  # extract service account emails for easy reference\n  service_account_emails = {\n    for k, v in module.service-accounts : k => v.email\n  }\n  # expand service account projects\n  service_accounts = {\n    for k, v in local._all_service_accounts : k => merge(v, {\n      project_id = lookup(var.host_project_ids, v.project_id, v.project_id)\n    })\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__cloud-foundation-fabric__fast__addons__2-networking-test__context.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"example_landing_zone_organization\" {\n  source    = \"../../modules/landing_zone\"\n  root_path = path.module\n\n  landing_zone_providers = {\n    default = {\n      account_id = \"123456789012\"\n      region     = \"us-east-1\"\n    }\n  }\n\n  landing_zone_components = {\n    landing_zone_organization = \"s3://terraform-aws-landing-zone/components/landing_zone_organization/default.tfvars\"\n  }\n\n  terraform_backend = {\n    backend = \"local\"\n    path    = \"/tmp/.terrahub/landing_zone\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/MitocGroup__terraform-aws-landing-zone__examples__example_landing_zone_organization__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# This tests reproduces an issue for the following error message.\n# ```\n# terraform.tfstate\n# \n#  Error: could not execute revoke query: pq: tuple concurrently updated\n# \n#    with postgresql_grant.public_revoke_database[\"test3\"],\n#    on test.tf line 40, in resource \"postgresql_grant\" \"public_revoke_database\":\n#    40: resource \"postgresql_grant\" \"public_revoke_database\" {\n# \n# \n# ```\n\nterraform {\n  required_version = \">= 1.0\"\n\n  required_providers {\n    postgresql = {\n      source  = \"cyrilgdn/postgresql\"\n      version = \">=1.14\"\n    }\n  }\n}\n\nlocals {\n  databases = toset([for idx in range(4) : format(\"test%d\", idx)])\n}\n\nprovider \"postgresql\" {\n  superuser = false\n}\n\nresource \"postgresql_database\" \"db\" {\n  for_each = local.databases\n  name     = each.key\n\n  # Use template1 instead of template0 (see https://www.postgresql.org/docs/current/manage-ag-templatedbs.html)\n  template = \"template1\"\n}\n\nresource \"postgresql_role\" \"demo\" {\n  name     = \"demo\"\n  login    = true\n  password = \"Happy-Holidays!\"\n}\n\nlocals {\n  # Create a local that is depends on postgresql_database to ensure it's created\n  dbs = { for database in local.databases : database => postgresql_database.db[database].name }\n}\n\n# Revoke default accesses for PUBLIC role to the databases\nresource \"postgresql_grant\" \"public_revoke_database\" {\n  for_each    = local.dbs\n  database    = each.value\n  role        = \"public\"\n  object_type = \"database\"\n  privileges  = []\n\n  with_grant_option = true\n}\n\n# Revoke default accesses for PUBLIC role to the public schema\nresource \"postgresql_grant\" \"public_revoke_schema\" {\n  for_each    = local.dbs\n  database    = each.value\n  role        = \"public\"\n  schema      = \"public\"\n  object_type = \"schema\"\n  privileges  = []\n\n  with_grant_option = true\n}\n\nresource \"postgresql_grant\" \"demo_db_connect\" {\n  for_each    = local.dbs\n  database    = each.value\n  role        = postgresql_role.demo.name\n  schema      = \"public\"\n  object_type = \"database\"\n  privileges  = [\"CONNECT\"]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cyrilgdn__terraform-provider-postgresql__examples__issues__169__test.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nmodule \"confidential-computing-org-policy\" {\n  source  = \"terraform-google-modules/org-policy/google\"\n  version = \"~> 7.0\"\n\n  project_id       = var.project_id\n  policy_for       = \"project\"\n  constraint       = \"constraints/compute.restrictNonConfidentialComputing\"\n  policy_type      = \"list\"\n  deny             = [\"compute.googleapis.com\"]\n  deny_list_length = 1\n}\n\nmodule \"enforce-cmek-org-policy\" {\n  source  = \"terraform-google-modules/org-policy/google\"\n  version = \"~> 7.0\"\n\n  project_id       = var.project_id\n  policy_for       = \"project\"\n  constraint       = \"constraints/gcp.restrictNonCmekServices\"\n  policy_type      = \"list\"\n  deny             = [\"compute.googleapis.com\"]\n  deny_list_length = 1\n}\n\nmodule \"restrict-cmek-cryptokey-projects-policy\" {\n  source  = \"terraform-google-modules/org-policy/google\"\n  version = \"~> 7.0\"\n\n  project_id        = var.project_id\n  policy_for        = \"project\"\n  constraint        = \"constraints/gcp.restrictCmekCryptoKeyProjects\"\n  policy_type       = \"list\"\n  allow             = [\"projects/${var.project_id}\"]\n  allow_list_length = 1\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__confidential_computing_intel__org_policies.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__confidential_computing_intel__org_policies.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__confidential_computing_intel__org_policies.tf", "start_line": 29}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__confidential_computing_intel__org_policies.tf", "start_line": 41}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"ap-south-1\"\n}\n\n#Create security group with firewall rules\nresource \"aws_security_group\" \"batch17_security_grp\" {\n  name        = \"Batch-17 Security Group\"\n  description = \"security group for allowing SSH and HTTP traffic to EC2 instances\"\n  vpc_id = \"vpc-0f751f1df4ef1c711\"\n\n ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n    ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n # outbound from Ec\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = -1\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags= {\n    Name = \"Batch-17 Security Group\"\n  }\n}\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__securitygroup__sg.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__securitygroup__sg.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__securitygroup__sg.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__securitygroup__sg.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__securitygroup__sg.tf", "start_line": 6}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"test_instance\" \"foo\" {\n    ami = \"bar\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/koding__terraform__backend__local__test-fixtures__apply__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"wrapper\" {\n  description = \"Map of outputs of a wrapper.\"\n  value       = module.wrapper\n  # sensitive = false # No sensitive module output found\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-security-group__wrappers__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  access_key = \"\"\n  secret_key = \"\"\n  region     = \"us-east-1\"\n}\n\n## Create VPC ##\nresource \"aws_vpc\" \"terraform-vpc\" {\n  cidr_block           = \"172.16.0.0/16\"\n  enable_dns_hostnames = true\n  tags = {\n    Name = \"terraform-demo-vpc\"\n  }\n}\n\noutput \"aws_vpc_id\" {\n  value = aws_vpc.terraform-vpc.id\n}\n\n## Security Group##\nresource \"aws_security_group\" \"terraform_private_sg\" {\n  description = \"Allow limited inbound external traffic\"\n  vpc_id      = aws_vpc.terraform-vpc.id\n  name        = \"terraform_ec2_private_sg\"\n\n  ingress {\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n    from_port   = 22\n    to_port     = 22\n  }\n\n  ingress {\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n    from_port   = 8080\n    to_port     = 8080\n  }\n\n  ingress {\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n    from_port   = 443\n    to_port     = 443\n  }\n\n  egress {\n    protocol    = -1\n    cidr_blocks = [\"0.0.0.0/0\"]\n    from_port   = 0\n    to_port     = 0\n  }\n\n  tags = {\n    Name = \"ec2-private-sg\"\n  }\n}\n\noutput \"aws_security_gr_id\" {\n  value = aws_security_group.terraform_private_sg.id\n}\n\n## Create Subnets ##\nresource \"aws_subnet\" \"terraform-subnet_1\" {\n  vpc_id            = aws_vpc.terraform-vpc.id\n  cidr_block        = \"172.16.10.0/24\"\n  availability_zone = \"us-east-1a\"\n\n  tags = {\n    Name = \"terraform-subnet_1\"\n  }\n}\n\noutput \"aws_subnet_subnet_1\" {\n  value = aws_subnet.terraform-subnet_1.id\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-3__demo-subnets.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-3__demo-subnets.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-3__demo-subnets.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-3__demo-subnets.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-3__demo-subnets.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-3__demo-subnets.tf", "start_line": 8}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_security_group\" \"default\" {\n  name = \"sgswarmcluster\"\n\n  # Allow all inbound\n  ingress {\n    from_port   = 0\n    to_port     = 65535\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 65535\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  # Enable ICMP\n  ingress {\n    from_port = -1\n    to_port = -1\n    protocol = \"icmp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__docker-swarm-cluster__security_groups.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__docker-swarm-cluster__security_groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__docker-swarm-cluster__security_groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_25", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__docker-swarm-cluster__security_groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__docker-swarm-cluster__security_groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_277", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__docker-swarm-cluster__security_groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__docker-swarm-cluster__security_groups.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    coderd = {\n      source = \"coder/coderd\"\n    }\n  }\n  backend \"gcs\" {\n    bucket = \"coder-dogfood-tf-state\"\n  }\n}\n\nimport {\n  to = coderd_template.envbuilder_dogfood\n  id = \"e75f1212-834c-4183-8bed-d6817cac60a5\"\n}\n\ndata \"coderd_organization\" \"default\" {\n  is_default = true\n}\n\ndata \"coderd_user\" \"machine\" {\n  username = \"machine\"\n}\n\nvariable \"CODER_TEMPLATE_NAME\" {\n  type = string\n}\n\nvariable \"CODER_TEMPLATE_VERSION\" {\n  type = string\n}\n\nvariable \"CODER_TEMPLATE_DIR\" {\n  type = string\n}\n\nvariable \"CODER_TEMPLATE_MESSAGE\" {\n  type = string\n}\n\nvariable \"CODER_DOGFOOD_ANTHROPIC_API_KEY\" {\n  type        = string\n  description = \"The API key that workspaces will use to authenticate with the Anthropic API.\"\n  default     = \"\"\n  sensitive   = true\n}\n\nresource \"coderd_template\" \"dogfood\" {\n  name            = var.CODER_TEMPLATE_NAME\n  display_name    = \"Write Coder on Coder\"\n  description     = \"The template to use when developing Coder on Coder!\"\n  icon            = \"/emojis/1f3c5.png\"\n  organization_id = data.coderd_organization.default.id\n  versions = [\n    {\n      name      = var.CODER_TEMPLATE_VERSION\n      message   = var.CODER_TEMPLATE_MESSAGE\n      directory = var.CODER_TEMPLATE_DIR\n      active    = true\n      tf_vars = [\n        {\n          name  = \"anthropic_api_key\"\n          value = var.CODER_DOGFOOD_ANTHROPIC_API_KEY\n        }\n      ]\n    }\n  ]\n  acl = {\n    groups = [{\n      id   = data.coderd_organization.default.id\n      role = \"use\"\n    }]\n    users = [{\n      id   = data.coderd_user.machine.id\n      role = \"admin\"\n    }]\n  }\n  activity_bump_ms                  = 10800000\n  allow_user_auto_start             = true\n  allow_user_auto_stop              = true\n  allow_user_cancel_workspace_jobs  = false\n  auto_start_permitted_days_of_week = [\"friday\", \"monday\", \"saturday\", \"sunday\", \"thursday\", \"tuesday\", \"wednesday\"]\n  auto_stop_requirement = {\n    days_of_week = [\"sunday\"]\n    weeks        = 1\n  }\n  default_ttl_ms                 = 28800000\n  deprecation_message            = null\n  failure_ttl_ms                 = 604800000\n  require_active_version         = true\n  time_til_dormant_autodelete_ms = 7776000000\n  time_til_dormant_ms            = 8640000000\n}\n\n\nresource \"coderd_template\" \"envbuilder_dogfood\" {\n  name            = \"coder-envbuilder\"\n  display_name    = \"Write Coder on Coder using Envbuilder\"\n  description     = \"Write Coder on Coder using a workspace built by Envbuilder.\"\n  icon            = \"/emojis/1f3d7.png\" # \n  organization_id = data.coderd_organization.default.id\n  versions = [\n    {\n      name      = var.CODER_TEMPLATE_VERSION\n      message   = var.CODER_TEMPLATE_MESSAGE\n      directory = \"./coder-envbuilder\"\n      active    = true\n      tf_vars = [{\n        # clusters/dogfood-v2/coder/provisioner/configs/values.yaml#L191-L194\n        name  = \"envbuilder_cache_dockerconfigjson_path\"\n        value = \"/home/coder/envbuilder-cache-dockerconfig.json\"\n      }]\n    }\n  ]\n  acl = {\n    groups = [{\n      id   = data.coderd_organization.default.id\n      role = \"use\"\n    }]\n    users = [{\n      id   = data.coderd_user.machine.id\n      role = \"admin\"\n    }]\n  }\n  activity_bump_ms                  = 10800000\n  allow_user_auto_start             = true\n  allow_user_auto_stop              = true\n  allow_user_cancel_workspace_jobs  = false\n  auto_start_permitted_days_of_week = [\"friday\", \"monday\", \"saturday\", \"sunday\", \"thursday\", \"tuesday\", \"wednesday\"]\n  auto_stop_requirement = {\n    days_of_week = [\"sunday\"]\n    weeks        = 1\n  }\n  default_ttl_ms                 = 28800000\n  deprecation_message            = null\n  failure_ttl_ms                 = 604800000\n  require_active_version         = true\n  time_til_dormant_autodelete_ms = 7776000000\n  time_til_dormant_ms            = 8640000000\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/coder__coder__dogfood__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"tls_private_key\" \"node-key\" {\n  algorithm = \"RSA\"\n}\n\nresource \"digitalocean_ssh_key\" \"key\" {\n  name       = \"rke-node-key\"\n  public_key = tls_private_key.node-key.public_key_openssh\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__terraform-provider-rke__examples__digitalocean__do__keys.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ---------------------------------------------------------------------------------------------------------------------\n# PIN TERRAFORM VERSION TO >= 0.12\n# The examples have been upgraded to 0.12 syntax\n# ---------------------------------------------------------------------------------------------------------------------\n\nterraform {\n  # This module is now only being tested with Terraform 0.13.x. However, to make upgrading easier, we are setting\n  # 0.12.26 as the minimum version, as that version added support for required_providers with source URLs, making it\n  # forwards compatible with 0.13.x code.\n  required_version = \">= 0.12.26\"\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# DEPLOY AN EC2 INSTANCE RUNNING UBUNTU\n# See test/terraform_aws_example_test.go for how to write automated tests for this code.\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_instance\" \"example\" {\n  ami           = data.aws_ami.ubuntu.id\n  instance_type = var.instance_type\n\n  tags = {\n    Name = var.instance_name\n  }\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# LOOK UP THE LATEST UBUNTU AMI\n# ---------------------------------------------------------------------------------------------------------------------\n\ndata \"aws_ami\" \"ubuntu\" {\n  most_recent = true\n  owners      = [\"099720109477\"] # Canonical\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  filter {\n    name   = \"architecture\"\n    values = [\"x86_64\"]\n  }\n\n  filter {\n    name   = \"image-type\"\n    values = [\"machine\"]\n  }\n\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-jammy-22.04-amd64-server-*\"]\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terratest__examples__terraform-aws-example__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terratest__examples__terraform-aws-example__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terratest__examples__terraform-aws-example__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terratest__examples__terraform-aws-example__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terratest__examples__terraform-aws-example__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terratest__examples__terraform-aws-example__main.tf", "start_line": 18}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"amiId-us-east-1\" {\n  value = data.aws_ssm_parameter.linuxAmi.value\n}\n\noutput \"amiId-us-west-2\" {\n  value = data.aws_ssm_parameter.linuxAmiOregon.value\n}\noutput \"Jenkins-Main-Node-Public-IP\" {\n  value = aws_instance.jenkins-master.public_ip\n}\noutput \"Jenkins-Main-Node-Private-IP\" {\n  value = aws_instance.jenkins-master.private_ip\n}\noutput \"Jenkins-Worker-Public-IPs\" {\n  value = {\n    for instance in aws_instance.jenkins-worker-oregon :\n    instance.id => instance.public_ip\n  }\n}\noutput \"Jenkins-Worker-Private-IPs\" {\n  value = {\n    for instance in aws_instance.jenkins-worker-oregon :\n    instance.id => instance.private_ip\n  }\n}\n\noutput \"url\" {\n  value = aws_route53_record.jenkins.fqdn\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_caller_identity\" \"current\" {}\ndata \"aws_partition\" \"current\" {}\ndata \"aws_region\" \"current\" {}\n\nlocals {\n  create = var.create && var.putin_khuylo\n\n  sns_topic_arn = try(\n    aws_sns_topic.this[0].arn,\n    \"arn:${data.aws_partition.current.id}:sns:${data.aws_region.current.region}:${data.aws_caller_identity.current.account_id}:${var.sns_topic_name}\",\n    \"\"\n  )\n\n  sns_feedback_role = local.create_sns_feedback_role ? aws_iam_role.sns_feedback_role[0].arn : var.sns_topic_lambda_feedback_role_arn\n  lambda_policy_document = {\n    sid       = \"AllowWriteToCloudwatchLogs\"\n    effect    = \"Allow\"\n    actions   = [\"logs:CreateLogStream\", \"logs:PutLogEvents\"]\n    resources = [replace(\"${try(aws_cloudwatch_log_group.lambda[0].arn, \"\")}:*\", \":*:*\", \":*\")]\n  }\n\n  lambda_policy_document_kms = {\n    sid       = \"AllowKMSDecrypt\"\n    effect    = \"Allow\"\n    actions   = [\"kms:Decrypt\"]\n    resources = [var.kms_key_arn]\n  }\n\n  lambda_policy_document_securityhub = {\n    sid       = \"AllowSecurityHub\"\n    effect    = \"Allow\"\n    actions   = [\"securityhub:BatchUpdateFindings\"]\n    resources = [\"*\"]\n  }\n\n  lambda_handler = try(split(\".\", basename(var.lambda_source_path))[0], \"notify_slack\")\n}\n\ndata \"aws_iam_policy_document\" \"lambda\" {\n  count = var.create ? 1 : 0\n\n  dynamic \"statement\" {\n    for_each = concat([local.lambda_policy_document,\n    local.lambda_policy_document_securityhub], var.kms_key_arn != \"\" ? [local.lambda_policy_document_kms] : [])\n    content {\n      sid       = statement.value.sid\n      effect    = statement.value.effect\n      actions   = statement.value.actions\n      resources = statement.value.resources\n    }\n  }\n}\n\nresource \"aws_cloudwatch_log_group\" \"lambda\" {\n  count = var.create ? 1 : 0\n\n  name              = \"/aws/lambda/${var.lambda_function_name}\"\n  retention_in_days = var.cloudwatch_log_group_retention_in_days\n  kms_key_id        = var.cloudwatch_log_group_kms_key_id\n\n  tags = merge(var.tags, var.cloudwatch_log_group_tags)\n}\n\nresource \"aws_sns_topic\" \"this\" {\n  count = var.create_sns_topic && var.create ? 1 : 0\n\n  name = var.sns_topic_name\n\n  kms_master_key_id = var.sns_topic_kms_key_id\n\n  lambda_failure_feedback_role_arn    = var.enable_sns_topic_delivery_status_logs ? local.sns_feedback_role : null\n  lambda_success_feedback_role_arn    = var.enable_sns_topic_delivery_status_logs ? local.sns_feedback_role : null\n  lambda_success_feedback_sample_rate = var.enable_sns_topic_delivery_status_logs ? var.sns_topic_lambda_feedback_sample_rate : null\n\n  tags = merge(var.tags, var.sns_topic_tags)\n}\n\n\nresource \"aws_sns_topic_subscription\" \"sns_notify_slack\" {\n  count = var.create ? 1 : 0\n\n  topic_arn           = local.sns_topic_arn\n  protocol            = \"lambda\"\n  endpoint            = module.lambda.lambda_function_arn\n  filter_policy       = var.subscription_filter_policy\n  filter_policy_scope = var.subscription_filter_policy_scope\n}\n\nmodule \"lambda\" {\n  source  = \"terraform-aws-modules/lambda/aws\"\n  version = \"8.0.1\"\n\n  create = var.create\n\n  function_name = var.lambda_function_name\n  description   = var.lambda_description\n\n  hash_extra                     = var.hash_extra\n  handler                        = \"${local.lambda_handler}.lambda_handler\"\n  source_path                    = var.lambda_source_path != null ? \"${path.root}/${var.lambda_source_path}\" : \"${path.module}/functions/notify_slack.py\"\n  recreate_missing_package       = var.recreate_missing_package\n  runtime                        = var.runtime\n  architectures                  = var.architectures\n  timeout                        = 30\n  kms_key_arn                    = var.kms_key_arn\n  reserved_concurrent_executions = var.reserved_concurrent_executions\n  ephemeral_storage_size         = var.lambda_function_ephemeral_storage_size\n  trigger_on_package_timestamp   = var.trigger_on_package_timestamp\n\n  # If publish is disabled, there will be \"Error adding new Lambda Permission for notify_slack:\n  # InvalidParameterValueException: We currently do not support adding policies for $LATEST.\"\n  publish = true\n\n  environment_variables = {\n    SLACK_WEBHOOK_URL = var.slack_webhook_url\n    SLACK_CHANNEL     = var.slack_channel\n    SLACK_USERNAME    = var.slack_username\n    SLACK_EMOJI       = var.slack_emoji\n    LOG_EVENTS        = var.log_events ? \"True\" : \"False\"\n    LOG_LEVEL         = var.log_level\n  }\n\n  create_role               = var.lambda_role == \"\"\n  lambda_role               = var.lambda_role\n  role_name                 = \"${var.iam_role_name_prefix}-${var.lambda_function_name}\"\n  role_permissions_boundary = var.iam_role_boundary_policy_arn\n  role_tags                 = var.iam_role_tags\n  role_path                 = var.iam_role_path\n\n  # Do not use Lambda's policy for cloudwatch logs, because we have to add a policy\n  # for KMS conditionally. This way attach_policy_json is always true independenty of\n  # the value of presense of KMS. Famous \"computed values in count\" bug...\n  attach_cloudwatch_logs_policy = false\n  attach_policy_json            = true\n  policy_json                   = try(data.aws_iam_policy_document.lambda[0].json, \"\")\n\n  use_existing_cloudwatch_log_group = true\n  attach_network_policy             = var.lambda_function_vpc_subnet_ids != null\n\n  dead_letter_target_arn    = var.lambda_dead_letter_target_arn\n  attach_dead_letter_policy = var.lambda_attach_dead_letter_policy\n\n  allowed_triggers = {\n    AllowExecutionFromSNS = {\n      principal  = \"sns.amazonaws.com\"\n      source_arn = local.sns_topic_arn\n    }\n  }\n\n  store_on_s3 = var.lambda_function_store_on_s3\n  s3_bucket   = var.lambda_function_s3_bucket\n\n  vpc_subnet_ids         = var.lambda_function_vpc_subnet_ids\n  vpc_security_group_ids = var.lambda_function_vpc_security_group_ids\n\n  tags = merge(var.tags, var.lambda_function_tags)\n\n  depends_on = [aws_cloudwatch_log_group.lambda]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-notify-slack__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-notify-slack__main.tf", "start_line": 89}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.5.7\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \">= 6.0\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-ec2-instance__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"aws_region\" {\n  description = \"AWS region for all resources\"\n  type        = string\n  default     = \"us-east-1\"\n}\n\nvariable \"lambda_runtime\" {\n  description = \"Lambda function runtime\"\n  type        = string\n  default     = \"nodejs22.x\"\n}\n\nvariable \"lambda_handler\" {\n  description = \"Lambda function handler\"\n  type        = string\n  default     = \"index.handler\"\n}\n\nvariable \"lambda_timeout\" {\n  description = \"Lambda function timeout in seconds\"\n  type        = number\n  default     = 30\n}\n\nvariable \"lambda_memory_size\" {\n  description = \"Lambda function memory size in MB\"\n  type        = number\n  default     = 128\n}\n\nvariable \"lambda_architectures\" {\n  description = \"Lambda function architectures\"\n  type        = list(string)\n  default     = [\"arm64\"]\n}\n\nvariable \"force_destroy\" {\n  description = \"Force destroy S3 buckets (only set to true for testing or cleanup of demo environments)\"\n  type        = bool\n  default     = false\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__terragrunt__docs-starlight__src__fixtures__terralith-to-terragrunt__walkthrough__step-1-starting-the-terralith__live__vars-optional.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: BUSL-1.1\n\nlocals {\n  ami_prefix        = \"nomad-e2e-v3\"\n  ubuntu_image_name = \"ubuntu-jammy-${var.instance_arch}\"\n}\n\nresource \"aws_instance\" \"server\" {\n  ami                    = data.aws_ami.ubuntu_jammy.image_id\n  instance_type          = var.instance_type\n  key_name               = module.keys.key_name\n  vpc_security_group_ids = [aws_security_group.servers.id] # see also the secondary ENI\n  count                  = var.server_count\n  iam_instance_profile   = data.aws_iam_instance_profile.nomad_e2e_cluster.name\n  availability_zone      = var.availability_zone\n  metadata_options {\n    http_endpoint = \"enabled\"\n    http_tokens   = \"required\"\n  }\n\n  # Instance tags\n  tags = {\n    Name           = \"${local.random_name}-server-${count.index}\"\n    ConsulAutoJoin = \"auto-join-${local.random_name}\"\n    User           = data.aws_caller_identity.current.arn\n  }\n}\n\nresource \"aws_instance\" \"client_ubuntu_jammy\" {\n  ami                    = data.aws_ami.ubuntu_jammy.image_id\n  instance_type          = var.instance_type\n  key_name               = module.keys.key_name\n  vpc_security_group_ids = [aws_security_group.clients.id] # see also the secondary ENI\n  count                  = var.client_count_linux\n  iam_instance_profile   = data.aws_iam_instance_profile.nomad_e2e_cluster.name\n  availability_zone      = var.availability_zone\n  metadata_options {\n    http_endpoint = \"enabled\"\n    http_tokens   = \"required\"\n  }\n\n  # Instance tags\n  tags = {\n    Name           = \"${local.random_name}-client-ubuntu-jammy-${count.index}\"\n    ConsulAutoJoin = \"auto-join-${local.random_name}\"\n    User           = data.aws_caller_identity.current.arn\n    OS             = \"linux\"\n  }\n}\n\n\n\nresource \"aws_instance\" \"client_windows_2022\" {\n  ami                    = data.aws_ami.windows_2022[0].image_id\n  instance_type          = var.instance_type\n  key_name               = module.keys.key_name\n  vpc_security_group_ids = [aws_security_group.clients.id]\n  count                  = var.client_count_windows_2022\n  iam_instance_profile   = data.aws_iam_instance_profile.nomad_e2e_cluster.name\n  availability_zone      = var.availability_zone\n  metadata_options {\n    http_endpoint = \"enabled\"\n    http_tokens   = \"required\"\n  }\n\n  user_data = file(\"${path.module}/userdata/windows-2022.ps1\")\n\n  # Instance tags\n  tags = {\n    Name           = \"${local.random_name}-client-windows-2022-${count.index}\"\n    ConsulAutoJoin = \"auto-join-${local.random_name}\"\n    User           = data.aws_caller_identity.current.arn\n    OS             = \"windows\"\n  }\n}\n\nresource \"aws_instance\" \"consul_server\" {\n  ami                    = data.aws_ami.ubuntu_jammy_consul_server.image_id\n  instance_type          = var.instance_type\n  key_name               = module.keys.key_name\n  vpc_security_group_ids = [aws_security_group.consul_server.id]\n  iam_instance_profile   = data.aws_iam_instance_profile.nomad_e2e_cluster.name\n  availability_zone      = var.availability_zone\n  metadata_options {\n    http_endpoint = \"enabled\"\n    http_tokens   = \"required\"\n  }\n\n  # Instance tags\n  tags = {\n    Name           = \"${local.random_name}-consul-server-ubuntu-jammy-amd64\"\n    ConsulAutoJoin = \"auto-join-${local.random_name}\"\n    User           = data.aws_caller_identity.current.arn\n  }\n}\n\n\n# We build the AMI only as needed. The AMI is tagged with the SHA of the commit\n# that forced the build, which may not be the commit that's spawning this test\n# run.\ndata \"external\" \"packer_sha\" {\n  program = [\"/bin/sh\", \"-c\", <<EOT\nset -e\nREPO_ROOT=$(git rev-parse --show-toplevel)\nsha=$(git log -n 1 --pretty=format:%H \"$${REPO_ROOT}/e2e/terraform/packer\")\necho \"{\\\"sha\\\":\\\"$${sha}\\\"}\"\nEOT\n  ]\n\n}\n\n# The Consul server's architecture isn't important for the E2E/Enos matrix, so\n# we have a separate data source for that even though in practice it's currently\n# always the same SHA as the linux_amd64 hosts for Nomad\ndata \"aws_ami\" \"ubuntu_jammy_consul_server\" {\n  most_recent = true\n  owners      = [\"self\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"${local.ami_prefix}-ubuntu-jammy-amd64-*\"]\n  }\n\n  filter {\n    name   = \"tag:OS\"\n    values = [\"Ubuntu\"]\n  }\n\n  filter {\n    name   = \"tag:BuilderSha\"\n    values = [data.external.packer_sha.result[\"sha\"]]\n  }\n}\n\ndata \"aws_ami\" \"ubuntu_jammy\" {\n  most_recent = true\n  owners      = [\"self\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"${local.ami_prefix}-${local.ubuntu_image_name}-*\"]\n  }\n\n  filter {\n    name   = \"tag:OS\"\n    values = [\"Ubuntu\"]\n  }\n\n  filter {\n    name   = \"tag:BuilderSha\"\n    values = [data.external.packer_sha.result[\"sha\"]]\n  }\n}\n\ndata \"aws_ami\" \"windows_2022\" {\n  count = var.client_count_windows_2022 > 0 ? 1 : 0\n\n  most_recent = true\n  owners      = [\"amazon\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"Windows_Server-2022-English-Full-ECS_Optimized-2025.*\"]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 9}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__provision-infra__compute.tf", "start_line": 78}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"eks_al2023\" {\n  source  = \"terraform-aws-modules/eks/aws\"\n  version = \"~> 21.0\"\n\n  name               = \"${local.name}-al2023\"\n  kubernetes_version = \"1.33\"\n\n  # EKS Addons\n  addons = {\n    coredns = {}\n    eks-pod-identity-agent = {\n      before_compute = true\n    }\n    kube-proxy = {}\n    vpc-cni = {\n      before_compute = true\n    }\n  }\n\n  vpc_id     = module.vpc.vpc_id\n  subnet_ids = module.vpc.private_subnets\n\n  eks_managed_node_groups = {\n    example = {\n      # Starting on 1.30, AL2023 is the default AMI type for EKS managed node groups\n      instance_types = [\"m6i.large\"]\n      ami_type       = \"AL2023_x86_64_STANDARD\"\n\n      min_size = 2\n      max_size = 5\n      # This value is ignored after the initial creation\n      # https://github.com/bryantbiggs/eks-desired-size-hack\n      desired_size = 2\n\n      # This is not required - demonstrates how to pass additional configuration to nodeadm\n      # Ref https://awslabs.github.io/amazon-eks-ami/nodeadm/doc/api/\n      cloudinit_pre_nodeadm = [\n        {\n          content_type = \"application/node.eks.aws\"\n          content      = <<-EOT\n            ---\n            apiVersion: node.eks.aws/v1alpha1\n            kind: NodeConfig\n            spec:\n              kubelet:\n                config:\n                  shutdownGracePeriod: 30s\n          EOT\n        }\n      ]\n    }\n  }\n\n  tags = local.tags\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-eks__examples__eks-managed-node-group__eks-al2023.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-eks__examples__eks-managed-node-group__eks-al2023.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"server_port\" {\n  description = \"The port the server will use for HTTP requests\"\n  default     = 8080\n  type        = number\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_02__03_alb_and_asg__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#lvm\nterraform {\n  backend \"local\" {\n    path = \"/etc/.azure/azure.lvm.terraform.tfstate\"\n  }\n  required_providers {\n    azurerm = {\n      source = \"hashicorp/azurerm\"\n      version = \"3.61.0\"\n    }\n  }\n}\n\ndata \"template_file\" \"prefix\" {\n  template = file(\"/etc/.azure/prefix\")\n}\n\ndata \"template_file\" \"client_id\" {\n  template = file(\"/etc/.azure/client_id\")\n}\n\ndata \"template_file\" \"tenant_id\" {\n  template = file(\"/etc/.azure/tenant_id\")\n}\n\ndata \"template_file\" \"sub_id\" {\n  template = file(\"/etc/.azure/sub_id\")\n}\n\nprovider \"azurerm\" {\n  features {}\n  client_certificate_path = \"/etc/.azure/mycert.pfx\"\n  subscription_id = \"${trimspace(data.template_file.sub_id.rendered)}\"\n  client_id = \"${trimspace(data.template_file.client_id.rendered)}\"\n  tenant_id = \"${trimspace(data.template_file.tenant_id.rendered)}\"\n}\n\nresource \"azurerm_resource_group\" \"main\" {\n  name     = \"${trimspace(data.template_file.prefix.rendered)}-lvm-rg\"\n  location = var.location\n}\n\nresource \"azurerm_virtual_network\" \"main\" {\n  name                = \"${trimspace(data.template_file.prefix.rendered)}-lvm-vnet\"\n  address_space       = [\"10.0.0.0/16\"]\n  location            = azurerm_resource_group.main.location\n  resource_group_name = azurerm_resource_group.main.name\n}\n\nresource \"azurerm_subnet\" \"main\" {\n  name                 = \"${trimspace(data.template_file.prefix.rendered)}-lvm-sn\"\n  resource_group_name  = azurerm_resource_group.main.name\n  virtual_network_name = azurerm_virtual_network.main.name\n  address_prefixes     = [\"10.0.2.0/24\"]\n}\n\nresource \"azurerm_public_ip\" \"main\" {\n  name                = \"${trimspace(data.template_file.prefix.rendered)}-lvm-pip\"\n  resource_group_name = azurerm_resource_group.main.name\n  location            = azurerm_resource_group.main.location\n  allocation_method   = \"Static\"\n}\n\nresource \"azurerm_network_interface\" \"main\" {\n  name                = \"${trimspace(data.template_file.prefix.rendered)}-lvm-nic\"\n  resource_group_name = azurerm_resource_group.main.name\n  location            = azurerm_resource_group.main.location\n\n  ip_configuration {\n    name                          = \"internal\"\n    subnet_id                     = azurerm_subnet.main.id\n    private_ip_address_allocation = \"Dynamic\"\n    public_ip_address_id          = azurerm_public_ip.main.id\n  }\n}\n\nresource \"azurerm_linux_virtual_machine\" \"main\" {\n  name                            = \"${trimspace(data.template_file.prefix.rendered)}-lvm-vm\"\n  resource_group_name             = azurerm_resource_group.main.name\n  location                        = azurerm_resource_group.main.location\n  size                            = \"Standard_F2\"\n  admin_username                  = \"adminuser\"\n  admin_password                  = \"P@ssw0rd1234!\"\n  disable_password_authentication = false\n  network_interface_ids = [\n    azurerm_network_interface.main.id,\n  ]\n\n  source_image_reference {\n    publisher = \"Canonical\"\n    offer     = \"UbuntuServer\"\n    sku       = \"18.04-LTS\"\n    version   = \"latest\"\n  }\n\n  os_disk {\n    storage_account_type = \"Standard_LRS\"\n    caching              = \"ReadWrite\"\n  }\n\n  patch_mode = \"AutomaticByPlatform\"\n  provision_vm_agent = true\n}\n\nresource \"null_resource\" \"mypatch\" {\n  provisioner \"remote-exec\" {\n    inline = [\n      \"sudo apt-get update -y\",\n      \"sudo hostname\",\n    ]\n    connection {\n      user = \"adminuser\"\n      password = \"P@ssw0rd1234!\"\n      type = \"ssh\"\n      host = azurerm_linux_virtual_machine.main.public_ip_address\n    }\n  }\n}\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sagarhere4u__terraform__azure_linux_vm_patch__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_50", "severity": "HIGH", "message": "Ensure Virtual Machine Extensions are not Installed", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sagarhere4u__terraform__azure_linux_vm_patch__main.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV_AZURE_1", "severity": "HIGH", "message": "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sagarhere4u__terraform__azure_linux_vm_patch__main.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV_AZURE_178", "severity": "HIGH", "message": "Ensure linux VM enables SSH with keys for secure communication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sagarhere4u__terraform__azure_linux_vm_patch__main.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV_AZURE_149", "severity": "HIGH", "message": "Ensure that Virtual machine does not enable password authentication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sagarhere4u__terraform__azure_linux_vm_patch__main.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV_AZURE_119", "severity": "HIGH", "message": "Ensure that Network Interfaces don't use public IPs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sagarhere4u__terraform__azure_linux_vm_patch__main.tf", "start_line": 64}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// uncomment the following lines to enable CodeCommit\n//resource \"aws_codecommit_repository\" \"demo\" {\n//  repository_name = \"demo\"\n//  description     = \"This is the demo repository\"\n//}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/wardviaene__terraform-course__codepipeline-demo__codecommit.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">=1.2\"\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"~> 4.0\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"3.3.2\"\n    }\n  }\n}\n\nprovider \"azurerm\" {\n  features {\n    resource_group {\n      prevent_deletion_if_contains_resources = false\n    }\n  }\n}\n\nprovider \"random\" {}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform-azurerm-vnet__examples__all_default__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"env\" {\n  type = string\n}\n\nvariable \"region\" {\n  type = string\n}\n\nvariable \"vpc_id\" {\n  type = string\n}\n\nvariable \"public_subnets\" {\n  type = list(string)\n}\n\nvariable \"sg_ssh_global_id\" {\n  type = string\n}\n\nvariable \"sg_vpc_local_id\" {\n  type = string\n}\n\nvariable \"sg_web_global_id\" {\n  type = string\n}\n\nvariable \"sg_openvpn_global_id\" {\n  type = string\n}\n\nvariable \"dns_zone_id\" {\n  type = map(any)\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/diggerhq__digger__libs__digger_config__terragrunt__tac__test_examples__no_terraform_blocks__myproject__eu-south-1__infra__apps__base_variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_availability_zones\" \"available\" {}\n\n# Create a VPC to launch our instances into\nresource \"aws_vpc\" \"km_vpc\" {\n  cidr_block           = \"10.0.0.0/16\"\n  enable_dns_support   = true\n  enable_dns_hostnames = true\n\n  tags = merge(var.default_tags, {\n    Name = \"km_vpc_${var.environment}\"\n  })\n}\n\n# Create an internet gateway to give our subnet access to the outside world\nresource \"aws_internet_gateway\" \"km_ig\" {\n  vpc_id = aws_vpc.km_vpc.id\n\n  tags = merge(var.default_tags, {\n    Name = \"km_ig_${var.environment}\"\n  })\n}\n\n# Grant the VPC internet access on its main route table\nresource \"aws_route\" \"km_route\" {\n  route_table_id         = aws_vpc.km_vpc.main_route_table_id\n  destination_cidr_block = \"0.0.0.0/0\"\n  gateway_id             = aws_internet_gateway.km_ig.id\n}\n\nresource \"aws_subnet\" \"km_private_subnet\" {\n  count             = var.az_count\n  cidr_block        = cidrsubnet(aws_vpc.km_vpc.cidr_block, 8, count.index)\n  availability_zone = data.aws_availability_zones.available.names[count.index]\n  vpc_id            = aws_vpc.km_vpc.id\n\n  tags = merge(var.default_tags, {\n    Name = \"km_private_subnet_${var.environment}\"\n  })\n}\n\n# Create var.az_count public subnets, each in a different AZ\nresource \"aws_subnet\" \"km_public_subnet\" {\n  count                   = var.az_count\n  cidr_block              = cidrsubnet(aws_vpc.km_vpc.cidr_block, 8, var.az_count + count.index)\n  availability_zone       = data.aws_availability_zones.available.names[count.index]\n  vpc_id                  = aws_vpc.km_vpc.id\n  map_public_ip_on_launch = true\n\n  tags = merge(var.default_tags, {\n    Name = \"km_public_subnet_${var.environment}\"\n  })\n}\n\n# Create a NAT gateway with an EIP for each private subnet to get internet connectivity\nresource \"aws_eip\" \"km_eip\" {\n  count      = var.az_count\n  vpc        = true\n  depends_on = [aws_internet_gateway.km_ig]\n\n  tags = merge(var.default_tags, {\n    Name = \"km_eip_${var.environment}\"\n  })\n}\n\nresource \"aws_nat_gateway\" \"km_nat_gateway\" {\n  count         = var.az_count\n  subnet_id     = element(aws_subnet.km_public_subnet.*.id, count.index)\n  allocation_id = element(aws_eip.km_eip.*.id, count.index)\n\n  tags = merge(var.default_tags, {\n    Name = \"km_nat_gateway_${var.environment}\"\n  })\n}\n\n# Create a new route table for the private subnets\n# And make it route non-local traffic through the NAT gateway to the internet\nresource \"aws_route_table\" \"km_route_table\" {\n  count  = var.az_count\n  vpc_id = aws_vpc.km_vpc.id\n\n  route {\n    cidr_block     = \"0.0.0.0/0\"\n    nat_gateway_id = element(aws_nat_gateway.km_nat_gateway.*.id, count.index)\n  }\n\n  tags = merge(var.default_tags, {\n    Name = \"km_route_table_${var.environment}\"\n  })\n}\n\n# Explicitely associate the newly created route tables to the private subnets (so they don't default to the main route table)\nresource \"aws_route_table_association\" \"km_private_route_table_association\" {\n  count          = var.az_count\n  subnet_id      = element(aws_subnet.km_private_subnet.*.id, count.index)\n  route_table_id = element(aws_route_table.km_route_table.*.id, count.index)\n}\n\n### Security\n\n# ALB Security group\n# This is the group you need to edit if you want to restrict access to your application\nresource \"aws_security_group\" \"km_alb_sg\" {\n  name        = \"km_alb_sg_${var.environment}\"\n  description = \"controls access to the ALB\"\n  vpc_id      = aws_vpc.km_vpc.id\n\n  ingress {\n    protocol    = \"tcp\"\n    from_port   = 443\n    to_port     = 443\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    protocol    = \"tcp\"\n    from_port   = 80\n    to_port     = 80\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(var.default_tags, {})\n}\n\n# Traffic to the ECS Cluster should only come from the ALB\nresource \"aws_security_group\" \"km_ecs_sg\" {\n  name        = \"km_ecs_sg\"\n  description = \"allow inbound access from the ALB only\"\n  vpc_id      = aws_vpc.km_vpc.id\n\n  ingress {\n    protocol        = \"tcp\"\n    from_port       = \"80\"\n    to_port         = \"80\"\n    security_groups = [aws_security_group.km_alb_sg.id]\n  }\n\n  egress {\n    protocol    = \"-1\"\n    from_port   = 0\n    to_port     = 0\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(var.default_tags, {\n    Name = \"km_ecs_sg_${var.environment}\"\n  })\n}\n\nresource \"aws_lb\" \"km_lb\" {\n  name            = \"km-lb-${var.environment}\"\n  subnets         = aws_subnet.km_public_subnet.*.id\n  security_groups = [aws_security_group.km_alb_sg.id]\n}\n\nresource \"aws_lb_target_group\" \"km_lb_target\" {\n  name        = \"km-lb-target-group-${var.environment}\"\n  port        = 80\n  protocol    = \"HTTP\"\n  vpc_id      = aws_vpc.km_vpc.id\n  target_type = \"ip\"\n  depends_on = [ aws_lb.km_lb ]\n}\n\n# Redirect all traffic from the ALB to the target group\nresource \"aws_lb_listener\" \"km_frontend_listener\" {\n  load_balancer_arn = aws_lb.km_lb.arn\n  port              = \"80\"\n  protocol          = \"HTTP\"\n  default_action {\n    target_group_arn = aws_lb_target_group.km_lb_target.arn\n    type             = \"forward\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 102}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 102}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 102}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 132}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 132}, {"tool": "checkov", "rule_id": "CKV_AWS_131", "severity": "HIGH", "message": "Ensure that ALB drops HTTP headers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 156}, {"tool": "checkov", "rule_id": "CKV_AWS_91", "severity": "HIGH", "message": "Ensure the ELBv2 (Application/Network) has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 156}, {"tool": "checkov", "rule_id": "CKV_AWS_150", "severity": "HIGH", "message": "Ensure that Load Balancer has deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 156}, {"tool": "checkov", "rule_id": "CKV_AWS_261", "severity": "HIGH", "message": "Ensure HTTP HTTPS Target group defines Healthcheck", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 162}, {"tool": "checkov", "rule_id": "CKV_AWS_2", "severity": "HIGH", "message": "Ensure ALB protocol is HTTPS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 172}, {"tool": "checkov", "rule_id": "CKV2_AWS_20", "severity": "CRITICAL", "message": "Ensure that ALB redirects HTTP requests into HTTPS ones", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 156}, {"tool": "checkov", "rule_id": "CKV2_AWS_28", "severity": "CRITICAL", "message": "Ensure public facing ALB are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 156}, {"tool": "checkov", "rule_id": "CKV_AWS_103", "severity": "HIGH", "message": "Ensure that load balancer is using at least TLS 1.2", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 172}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 132}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_378", "severity": "HIGH", "message": "Ensure AWS Load Balancer doesn't use HTTP protocol", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__network__main.tf", "start_line": 162}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# First setup your authentication\n#  https://www.terraform.io/docs/providers/azurerm/index.html\n#  example: create sp with secret\n#   az ad sp create-for-rbac --role=\"Contributor\" --scopes=\"/subscriptions/SUBSCRIPTION_ID\"\n\n# PROVIDER\n# https://www.terraform.io/docs/providers/azurerm/index.html\n# Configure the Azure Provider\nprovider \"azurerm\" {\n  # whilst the `version` attribute is optional, we recommend pinning to a given version of the Provider\n  #version = \"=1.28.0\"\n    ARM_CLIENT_ID=\"<Secret Stuff>\"\n    ARM_CLIENT_SECRET=\"<Secret Stuff>\"\n    ARM_SUBSCRIPTION_ID=\"<Secret Stuff>\"\n    ARM_TENANT_ID=\"<Secret Stuff>\"\n}\n\n# RESOURCES\n# Create a resource group\nresource \"azurerm_resource_group\" \"demofx\" {\n  name     = \"demofx\"\n  location = \"westus2\"\n  tags = {\n    env   = \"demo\"\n    build = \"demo1\"\n  }\n}\n\n# create a virtual network in the RG\nresource \"azurerm_virtual_network\" \"demofx_network\" {\n  name                = \"demo01_network\"\n  address_space       = [\"10.0.0.0/16\"]\n  location            = azurerm_resource_group.demofx.location\n  resource_group_name = azurerm_resource_group.demofx.name\n\n  subnet {\n    name           = \"demo01_public_subnet\"\n    address_prefix = \"10.0.1.0/24\"\n  }\n\n  subnet {\n    name           = \"demo01_private_subnet\"\n    address_prefix = \"10.0.2.0/24\"\n  }\n  tags = {\n    env   = \"demo\"\n    build = \"demo1\"\n    gnia = \"demo1\"\n  }\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__101__101-002-rg_and_network_with_auth__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# CREATE ALL THE RESOURCES TO DEPLOY AN APP IN AN AUTO SCALING GROUP WITH AN ELB\n# This template runs a simple \"Hello, World\" web server in Auto Scaling Group (ASG) with an Elastic Load Balancer\n# (ELB) in front of it to distribute traffic across the EC2 Instances in the ASG.\n# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\nterraform {\n  # This module is now only being tested with Terraform 1.1.x. However, to make upgrading easier, we are setting 1.0.0 as the minimum version.\n  required_version = \">= 1.0.0\"\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"< 4.0\"\n    }\n  }\n}\n\n# ------------------------------------------------------------------------------\n# CONFIGURE OUR AWS CONNECTION\n# ------------------------------------------------------------------------------\n\nprovider \"aws\" {\n  region = \"us-east-2\"\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# GET THE LIST OF AVAILABILITY ZONES IN THE CURRENT REGION\n# Every AWS accout has slightly different availability zones in each region. For example, one account might have\n# us-east-1a, us-east-1b, and us-east-1c, while another will have us-east-1a, us-east-1b, and us-east-1d. This resource\n# queries AWS to fetch the list for the current account and region.\n# ---------------------------------------------------------------------------------------------------------------------\n\ndata \"aws_availability_zones\" \"all\" {}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE THE AUTO SCALING GROUP\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_autoscaling_group\" \"example\" {\n  launch_configuration = aws_launch_configuration.example.id\n  availability_zones   = data.aws_availability_zones.all.names\n\n  min_size = 2\n  max_size = 10\n\n  load_balancers    = [aws_elb.example.name]\n  health_check_type = \"ELB\"\n\n  tag {\n    key                 = \"Name\"\n    value               = \"terraform-asg-example\"\n    propagate_at_launch = true\n  }\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE A LAUNCH CONFIGURATION THAT DEFINES EACH EC2 INSTANCE IN THE ASG\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_launch_configuration\" \"example\" {\n  # Ubuntu Server 18.04 LTS (HVM), SSD Volume Type in us-east-2\n  image_id        = \"ami-0c55b159cbfafe1f0\"\n  instance_type   = \"t2.micro\"\n  security_groups = [aws_security_group.instance.id]\n\n  user_data = <<-EOF\n              #!/bin/bash\n              echo \"Hello, World\" > index.html\n              nohup busybox httpd -f -p \"${var.server_port}\" &\n              EOF\n\n  # Whenever using a launch configuration with an auto scaling group, you must set create_before_destroy = true.\n  # https://www.terraform.io/docs/providers/aws/r/launch_configuration.html\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE THE SECURITY GROUP THAT'S APPLIED TO EACH EC2 INSTANCE IN THE ASG\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_security_group\" \"instance\" {\n  name = \"terraform-example-instance\"\n\n  # Inbound HTTP from anywhere\n  ingress {\n    from_port   = var.server_port\n    to_port     = var.server_port\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE AN ELB TO ROUTE TRAFFIC ACROSS THE AUTO SCALING GROUP\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_elb\" \"example\" {\n  name               = \"terraform-asg-example\"\n  security_groups    = [aws_security_group.elb.id]\n  availability_zones = data.aws_availability_zones.all.names\n\n  health_check {\n    target              = \"HTTP:${var.server_port}/\"\n    interval            = 30\n    timeout             = 3\n    healthy_threshold   = 2\n    unhealthy_threshold = 2\n  }\n\n  # This adds a listener for incoming HTTP requests.\n  listener {\n    lb_port           = var.elb_port\n    lb_protocol       = \"http\"\n    instance_port     = var.server_port\n    instance_protocol = \"http\"\n  }\n}\n\n# ---------------------------------------------------------------------------------------------------------------------\n# CREATE A SECURITY GROUP THAT CONTROLS WHAT TRAFFIC AN GO IN AND OUT OF THE ELB\n# ---------------------------------------------------------------------------------------------------------------------\n\nresource \"aws_security_group\" \"elb\" {\n  name = \"terraform-example-elb\"\n\n  # Allow all outbound\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  # Inbound HTTP from anywhere\n  ingress {\n    from_port   = var.elb_port\n    to_port     = var.elb_port\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__cluster-of-web-servers__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_315", "severity": "HIGH", "message": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__cluster-of-web-servers__main.tf", "start_line": 40}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__cluster-of-web-servers__main.tf", "start_line": 61}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__cluster-of-web-servers__main.tf", "start_line": 61}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__cluster-of-web-servers__main.tf", "start_line": 84}, {"tool": "checkov", "rule_id": "CKV_AWS_92", "severity": "HIGH", "message": "Ensure the ELB has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__cluster-of-web-servers__main.tf", "start_line": 100}, {"tool": "checkov", "rule_id": "CKV_AWS_127", "severity": "HIGH", "message": "Ensure that Elastic Load Balancer(s) uses SSL certificates provided by AWS Certificate Manager", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__cluster-of-web-servers__main.tf", "start_line": 100}, {"tool": "checkov", "rule_id": "CKV_AWS_376", "severity": "HIGH", "message": "Ensure AWS Elastic Load Balancer listener uses TLS/SSL", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__cluster-of-web-servers__main.tf", "start_line": 100}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__cluster-of-web-servers__main.tf", "start_line": 126}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gruntwork-io__intro-to-terraform__cluster-of-web-servers__main.tf", "start_line": 126}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Variables definitions for authorization\nvariable \"region_name\" {\n  description = \"The region where the scaling configuration is located\"\n  type        = string\n}\n\nvariable \"access_key\" {\n  description = \"The access key of the IAM user\"\n  type        = string\n  sensitive   = true\n}\n\nvariable \"secret_key\" {\n  description = \"The secret key of the IAM user\"\n  type        = string\n  sensitive   = true\n}\n\n# Variables definitions for resource/data source\nvariable \"availability_zone\" {\n  description = \"The availability zone to which the scaling configuration belongs\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"configuration_flavor_id\" {\n  description = \"The flavor ID of the scaling configuration\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"configuration_flavor_performance_type\" {\n  description = \"The performance type of the scaling configuration\"\n  type        = string\n  default     = \"normal\"\n}\n\nvariable \"configuration_flavor_cpu_core_count\" {\n  description = \"The CPU core count of the scaling configuration\"\n  type        = number\n  default     = 2\n}\n\nvariable \"configuration_flavor_memory_size\" {\n  description = \"The memory size of the scaling configuration\"\n  type        = number\n  default     = 4\n}\n\nvariable \"configuration_image_id\" {\n  description = \"The image ID of the scaling configuration\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"configuration_image_visibility\" {\n  description = \"The visibility of the image\"\n  type        = string\n  default     = \"public\"\n}\n\nvariable \"configuration_image_os\" {\n  description = \"The OS of the image\"\n  type        = string\n  default     = \"Ubuntu\"\n}\n\nvariable \"security_group_name\" {\n  description = \"The name of the security group\"\n  type        = string\n}\n\nvariable \"keypair_name\" {\n  description = \"The name of the key pair\"\n  type        = string\n}\n\nvariable \"keypair_public_key\" {\n  description = \"The public key for SSH access\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"configuration_name\" {\n  description = \"The name of the scaling configuration\"\n  type        = string\n}\n\nvariable \"configuration_metadata\" {\n  description = \"The metadata for the scaling configuration instances\"\n  type        = map(string)\n}\n\nvariable \"configuration_user_data\" {\n  description = \"The user data script for scaling configuration instances initialization\"\n  type        = string\n}\n\nvariable \"configuration_disks\" {\n  description = \"The disk configurations for the scaling configuration instances\"\n  type        = list(object({\n    size        = number\n    volume_type = string\n    disk_type   = string\n  }))\n\n  nullable = false\n}\n\nvariable \"configuration_public_eip_settings\" {\n  description = \"The public IP settings for the scaling configuration instances\"\n  type        = list(object({\n    ip_type   = string\n    bandwidth = object({\n      size          = number\n      share_type    = string\n      charging_mode = string\n    })\n  }))\n\n  nullable = false\n  default  = []\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/huaweicloud__terraform-provider-huaweicloud__examples__as__scaling-configuration__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_vpc\" \"main\" {\n  cidr_block           = var.vpc_cidr_block\n  enable_dns_hostnames = true\n\n  tags = {\n    Name = \"iaasweek\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iaasweek__terraform__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iaasweek__terraform__vpc.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iaasweek__terraform__vpc.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"region\" {\n  default = \"us-west1\"\n}\n\nvariable \"zone\" {\n  default = \"us-west1-b\"\n}\n\nvariable \"network_name\" {\n  default = \"tf-gke-helm\"\n}\n\nprovider \"google\" {\n  region = \"${var.region}\"\n}\n\ndata \"google_client_config\" \"current\" {}\n\nresource \"google_compute_network\" \"default\" {\n  name                    = \"${var.network_name}\"\n  auto_create_subnetworks = false\n}\n\nresource \"google_compute_subnetwork\" \"default\" {\n  name                     = \"${var.network_name}\"\n  ip_cidr_range            = \"10.127.0.0/20\"\n  network                  = \"${google_compute_network.default.self_link}\"\n  region                   = \"${var.region}\"\n  private_ip_google_access = true\n}\n\ndata \"google_container_engine_versions\" \"default\" {\n  zone = \"${var.zone}\"\n}\n\nresource \"google_container_cluster\" \"default\" {\n  name               = \"tf-gke-helm\"\n  zone               = \"${var.zone}\"\n  initial_node_count = 3\n  min_master_version = \"${data.google_container_engine_versions.default.latest_master_version}\"\n  network            = \"${google_compute_subnetwork.default.name}\"\n  subnetwork         = \"${google_compute_subnetwork.default.name}\"\n\n  // Use legacy ABAC until these issues are resolved: \n  //   https://github.com/mcuadros/terraform-provider-helm/issues/56\n  //   https://github.com/terraform-providers/terraform-provider-kubernetes/pull/73\n  enable_legacy_abac = true\n\n  // Wait for the GCE LB controller to cleanup the resources.\n  provisioner \"local-exec\" {\n    when    = \"destroy\"\n    command = \"sleep 90\"\n  }\n}\n\noutput \"network\" {\n  value = \"${google_compute_subnetwork.default.network}\"\n}\n\noutput \"subnetwork_name\" {\n  value = \"${google_compute_subnetwork.default.name}\"\n}\n\noutput \"cluster_name\" {\n  value = \"${google_container_cluster.default.name}\"\n}\n\noutput \"cluster_region\" {\n  value = \"${var.region}\"\n}\n\noutput \"cluster_zone\" {\n  value = \"${google_container_cluster.default.zone}\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_26", "severity": "HIGH", "message": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_GCP_23", "severity": "HIGH", "message": "Ensure Kubernetes Cluster is created with Alias IP ranges enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_66", "severity": "HIGH", "message": "Ensure use of Binary Authorization", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_13", "severity": "HIGH", "message": "Ensure client certificate authentication to Kubernetes Engine Clusters is disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_7", "severity": "HIGH", "message": "Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_61", "severity": "HIGH", "message": "Enable VPC Flow Logs and Intranode Visibility", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_21", "severity": "HIGH", "message": "Ensure Kubernetes Clusters are configured with Labels", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_65", "severity": "HIGH", "message": "Manage Kubernetes RBAC users with Google Groups for GKE", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_20", "severity": "HIGH", "message": "Ensure master authorized networks is set to enabled in GKE clusters", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_69", "severity": "HIGH", "message": "Ensure the GKE Metadata Server is Enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_12", "severity": "HIGH", "message": "Ensure Network Policy is enabled on Kubernetes Engine Clusters", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_25", "severity": "HIGH", "message": "Ensure Kubernetes Cluster is created with Private cluster enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_64", "severity": "HIGH", "message": "Ensure clusters are created with Private Nodes", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_GCP_70", "severity": "HIGH", "message": "Ensure the GKE Release Channel is set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV2_GCP_18", "severity": "CRITICAL", "message": "Ensure GCP network defines a firewall and does not use the default firewall", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-gke-k8s-helm__main.tf", "start_line": 19}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) 2017, 2023 Oracle Corporation and/or its affiliates.\n# Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl\n\n// Used to retrieve available bastion images when enabled\ndata \"oci_core_images\" \"bastion\" {\n  count                    = var.create_bastion ? 1 : 0\n  compartment_id           = local.compartment_id\n  operating_system         = var.bastion_image_os\n  operating_system_version = var.bastion_image_os_version\n  shape                    = lookup(var.bastion_shape, \"shape\", \"VM.Standard.E4.Flex\")\n  state                    = \"AVAILABLE\"\n  sort_by                  = \"TIMECREATED\"\n  sort_order               = \"DESC\"\n\n  filter {\n    name   = \"launch_mode\"\n    values = [\"NATIVE\"]\n  }\n}\n\nlocals {\n  bastion_public_ip = (var.create_bastion && length(module.bastion) > 0\n    ? lookup(element(module.bastion, 0), \"public_ip\", var.bastion_public_ip)\n    : var.bastion_public_ip\n  )\n\n  bastion_images    = try(data.oci_core_images.bastion[0].images, tolist([])) # Data source result or empty\n  bastion_image_ids = local.bastion_images[*].id                              # Image OCIDs from data source\n  bastion_image_id = (var.bastion_image_type == \"custom\"\n    ? var.bastion_image_id : element(coalescelist(local.bastion_image_ids, [\"none\"]), 0)\n  )\n\n  # Bastion SSH ProxyCommand argument used in e.g. ssh_to_operator command output if created/provided\n  bastion_ssh_user_ip = join(\"@\", compact([var.bastion_user, local.bastion_public_ip]))\n  bastion_ssh_args    = compact([local.ssh_key_arg, local.bastion_ssh_user_ip])\n  bastion_ssh_command = join(\" \", concat([\"ssh\"], local.bastion_ssh_args))\n  bastion_proxy_command = try((local.bastion_public_ip == null ? []\n    : [\"-o\", format(\"ProxyCommand='ssh -W %%h:%%p %v'\", join(\" \", local.bastion_ssh_args))]\n  ), [])\n}\n\nmodule \"bastion\" {\n  count          = var.create_bastion ? 1 : 0\n  source         = \"./modules/bastion\"\n  state_id       = local.state_id\n  compartment_id = local.compartment_id\n\n  # Bastion\n  await_cloudinit          = var.bastion_await_cloudinit\n  assign_dns               = var.assign_dns\n  availability_domain      = coalesce(var.bastion_availability_domain, lookup(local.ad_numbers_to_names, local.ad_numbers[0]))\n  bastion_image_os_version = var.bastion_image_os_version\n  image_id                 = local.bastion_image_id\n  nsg_ids                  = try(compact(flatten([var.bastion_nsg_ids, [try(module.network.bastion_nsg_id, null)]])), [])\n  is_public                = var.bastion_is_public\n  shape                    = var.bastion_shape\n  ssh_private_key          = sensitive(local.ssh_private_key) # to await cloud-init completion\n  ssh_public_key           = local.ssh_public_key\n  subnet_id                = try(module.network.bastion_subnet_id, \"\") # safe destroy; validated in submodule\n  timezone                 = var.timezone\n  upgrade                  = var.bastion_upgrade\n  user                     = var.bastion_user\n  volume_kms_key_id        = var.bastion_volume_kms_key_id\n\n  # Standard tags as defined if enabled for use, or freeform\n  # User-provided tags are merged last and take precedence\n  use_defined_tags = var.use_defined_tags\n  tag_namespace    = var.tag_namespace\n  defined_tags = merge(var.use_defined_tags ? {\n    \"${var.tag_namespace}.state_id\" = local.state_id,\n    \"${var.tag_namespace}.role\"     = \"bastion\",\n  } : {}, local.bastion_defined_tags)\n  freeform_tags = merge(var.use_defined_tags ? {} : {\n    \"state_id\" = local.state_id,\n    \"role\"     = \"bastion\",\n  }, local.bastion_freeform_tags)\n}\n\noutput \"bastion_id\" {\n  description = \"ID of bastion instance\"\n  value       = one(module.bastion[*].id)\n}\n\noutput \"bastion_public_ip\" {\n  description = \"Public IP address of bastion host\"\n  value       = local.bastion_public_ip\n}\n\noutput \"ssh_to_bastion\" {\n  description = \"SSH command for bastion host\"\n  value       = local.bastion_ssh_command\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/oracle-terraform-modules__terraform-oci-oke__module-bastion.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# These lambda functions return dictionaries of instances. \n# Use them with other functions to take action on tagged, untagged\n# or running instances.\n\nresource \"aws_lambda_function\" \"getUntaggedASGs\" {\n  filename         = \"./files/getUntaggedASGs.zip\"\n  function_name    = \"getUntaggedASGs\"\n  role             = \"${aws_iam_role.lambda_read_instances.arn}\"\n  handler          = \"getUntaggedASGs.lambda_handler\"\n  source_code_hash = \"${base64sha256(file(\"./files/getUntaggedASGs.zip\"))}\"\n  runtime          = \"python3.6\"\n  timeout          = \"120\"\n  description      = \"Gathers a list of untagged or improperly tagged instances.\"\n\n  environment {\n    variables = {\n      \"REQTAGS\" = \"${var.mandatory_tags}\"\n    }\n  }\n}\n\nresource \"aws_lambda_function\" \"getTaggedASGs\" {\n  filename         = \"./files/getTaggedASGs.zip\"\n  function_name    = \"getTaggedASGs\"\n  role             = \"${aws_iam_role.lambda_read_instances.arn}\"\n  handler          = \"getTaggedASGs.lambda_handler\"\n  source_code_hash = \"${base64sha256(file(\"./files/getTaggedASGs.zip\"))}\"\n  runtime          = \"python3.6\"\n  timeout          = \"120\"\n  description      = \"Gathers a list of correctly tagged instances.\"\n\n  environment {\n    variables = {\n      \"REQTAGS\" = \"${var.mandatory_tags}\"\n    }\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_363", "severity": "HIGH", "message": "Ensure Lambda Runtime is not deprecated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_173", "severity": "HIGH", "message": "Check encryption settings for Lambda environmental variable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_363", "severity": "HIGH", "message": "Ensure Lambda Runtime is not deprecated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_AWS_173", "severity": "HIGH", "message": "Check encryption settings for Lambda environmental variable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__asg_data_collectors.tf", "start_line": 22}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"ProjectName\" {\n  value = \"${alicloud_datahub_project.example.name}\"\n}\n\noutput \"ProjectCreateTime\" {\n  value = \"${alicloud_datahub_project.example.create_time}\"\n}\n\noutput \"TopicName\" {\n  value = \"${alicloud_datahub_topic.example.name}\"\n}\n\noutput \"TopicCreateTime\" {\n  value = \"${alicloud_datahub_topic.example.create_time}\"\n}\n\noutput \"ShardCount\" {\n  value = \"${alicloud_datahub_topic.example.shard_count}\"\n}\n\noutput \"SubscriptionId\" {\n  value = \"${alicloud_datahub_subscription.example.sub_id}\"\n}\n\noutput \"SubscriptionCreateTime\" {\n  value = \"${alicloud_datahub_subscription.example.create_time}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alibaba__terraform-provider__examples__datahub__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_role\" \"ecr_pusher\" {\n  name = \"tooling-ecr-pusher\"\n\n  assume_role_policy = <<-EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"AWS\": [\n          \"arn:aws:iam::${local.aws_account_id}:user/${local.username}\"\n        ]\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n\nresource \"aws_iam_role_policy\" \"ecrs\" {\n  for_each = var.ecr_tooling_repos\n  name     = \"tooling-ecr-pusher-${each.key}\"\n  role     = aws_iam_role.ecr_pusher.id\n\n  policy = <<EOF\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n      {\n        \"Sid\": \"ToolingECRReadWritePolicy\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"ecr:GetDownloadUrlForLayer\",\n            \"ecr:BatchGetImage\",\n            \"ecr:BatchCheckLayerAvailability\",\n            \"ecr:PutImage\",\n            \"ecr:InitiateLayerUpload\",\n            \"ecr:UploadLayerPart\",\n            \"ecr:CompleteLayerUpload\"\n        ],\n        \"Resource\": [\n          \"arn:aws:ecr:${var.region}:${local.aws_account_id}:repository/${each.key}\"\n        ]\n    }, {\n        \"Sid\": \"GithubDeployECRAuthTokenPolicy\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"ecr:GetAuthorizationToken\"\n        ],\n        \"Resource\": [\"*\"]\n    }\n  ]\n}\nEOF\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\nresource \"aws_iam_role\" \"ecr_pushers\" {\n  for_each = var.ecr_tooling_repos\n  name     = \"tooling-ecr-pusher-${each.key}\"\n\n  assume_role_policy = <<-EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"AWS\": [\n          \"arn:aws:iam::${local.aws_account_id}:user/${local.username}\"\n        ]\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n\nresource \"aws_iam_role_policy\" \"ecr_pushers\" {\n  for_each = var.ecr_tooling_repos\n  name     = \"tooling-ecr-pusher-${each.key}\"\n  role     = aws_iam_role.ecr_pushers[each.key].id\n\n  policy = <<EOF\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n      {\n        \"Sid\": \"ToolingECRReadWritePolicy\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"ecr:GetDownloadUrlForLayer\",\n            \"ecr:BatchGetImage\",\n            \"ecr:BatchCheckLayerAvailability\",\n            \"ecr:PutImage\",\n            \"ecr:InitiateLayerUpload\",\n            \"ecr:UploadLayerPart\",\n            \"ecr:CompleteLayerUpload\"\n        ],\n        \"Resource\": [\n          \"arn:aws:ecr:${var.region}:${local.aws_account_id}:repository/${each.key}\"\n        ]\n    }, {\n        \"Sid\": \"GithubDeployECRAuthTokenPolicy\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"ecr:GetAuthorizationToken\"\n        ],\n        \"Resource\": [\"*\"]\n    }\n  ]\n}\nEOF\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__bk__role_ecrs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Terraform Version\n\nterraform {\n  required_version = \">= 1.0\"\n  required_providers {\n    local = {\n      source  = \"hashicorp/aws\"\n      version = \"3.74.0\"\n    }\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/TheAutomationRules__terraform__Video_03_Load_Balancer__terraform.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n//\n// Get information about existing ALB Target Group\n//\ndata \"yandex_alb_target_group\" \"foo\" {\n  target_group_id = \"my-target-group-id\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/yandex-cloud__terraform-provider-yandex__examples__alb_target_group__d_alb_target_group_1.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/integrations__terraform-provider-github__examples__app_authentication__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"users\" {\n  default = {\n    ravs : { country : \"Netherlands\", department : \"ABC\" },\n    tom : { country : \"US\", department : \"DEF\" },\n    jane : { country : \"India\", department : \"XYZ\" }\n  }\n}\n\nprovider \"aws\" {\n  region  = \"us-east-1\"\n  //version = \"~> 2.46\" (No longer necessary)\n}\n\nresource \"aws_iam_user\" \"my_iam_users\" {\n  for_each = var.users\n  name     = each.key\n  tags = {\n    #country: each.value\n    country : each.value.country\n    department : each.value.department\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__terraform__backup__04-maps__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__terraform__backup__04-maps__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__terraform__backup__04-maps__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__terraform__backup__04-maps__main.tf", "start_line": 14}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"cluster_name\" {\n  value = module.doks-cluster.cluster_name\n}\n\noutput \"kubeconfig_path\" {\n  value = var.write_kubeconfig ? abspath(\"${path.root}/kubeconfig\") : \"none\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/digitalocean__terraform-provider-digitalocean__examples__kubernetes__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"kubeconfig\" {\n  value       = module.rancher.kubeconfig\n  description = <<-EOT\n    The kubeconfig for the server.\n  EOT\n  sensitive   = true\n}\noutput \"address\" {\n  value = module.rancher.address\n}\noutput \"admin_token\" {\n  value     = module.rancher.admin_token\n  sensitive = true\n}\noutput \"admin_password\" {\n  value     = module.rancher.admin_password\n  sensitive = true\n}\noutput \"cluster_data\" {\n  value     = jsonencode(data.rancher2_cluster.local)\n  sensitive = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rancher__terraform-provider-rancher2__examples__use-cases__production__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nterraform {\n  required_version = \">= 0.13\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/WesleyCharlesBlake__terraform-aws-eks__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"s3\" {\n    bucket = \"platzi-terraform2\"\n    key    = \"dev\"\n    region = \"us-east-2\"    \n\tencrypt = true\n\tkms_key_id = \"arn:aws:kms:us-east-2:204749385567:key/b52cf66a-72db-45ef-87d9-fcf05e83aabe\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__demo-backend2__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"A\" {\n  description = \"The A variable OVERRIDDEN\"\n}\n\nvariable \"C\" {\n  description = \"An entirely new variable C\"\n}\n\noutput \"A\" {\n  description = \"I am an overridden output!\"\n  value       = \"${var.A}\"\n}\n\nmodule \"foo\" {\n  version = \"1.0.2_override\"\n\n  unused = 2\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-config-inspect__tfconfig__testdata__overrides__overrides_override.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-config-inspect__tfconfig__testdata__overrides__overrides_override.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-config-inspect__tfconfig__testdata__overrides__overrides_override.tf", "start_line": 14}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Kustomize application\nresource \"argocd_application\" \"kustomize\" {\n  metadata {\n    name      = \"kustomize-app\"\n    namespace = \"argocd\"\n    labels = {\n      test = \"true\"\n    }\n  }\n\n  cascade = false # disable cascading deletion\n  wait    = true\n\n  spec {\n    project = \"myproject\"\n\n    destination {\n      server    = \"https://kubernetes.default.svc\"\n      namespace = \"foo\"\n    }\n\n    source {\n      repo_url        = \"https://github.com/kubernetes-sigs/kustomize\"\n      path            = \"examples/helloWorld\"\n      target_revision = \"master\"\n      kustomize {\n        name_prefix = \"foo-\"\n        name_suffix = \"-bar\"\n        images      = [\"hashicorp/terraform:light\"]\n        common_labels = {\n          \"this.is.a.common\" = \"la-bel\"\n          \"another.io/one\"   = \"true\"\n        }\n      }\n    }\n\n    sync_policy {\n      automated {\n        prune       = true\n        self_heal   = true\n        allow_empty = true\n      }\n      # Only available from ArgoCD 1.5.0 onwards\n      sync_options = [\"Validate=false\"]\n      retry {\n        limit = \"5\"\n        backoff {\n          duration     = \"30s\"\n          max_duration = \"2m\"\n          factor       = \"2\"\n        }\n      }\n    }\n\n    ignore_difference {\n      group         = \"apps\"\n      kind          = \"Deployment\"\n      json_pointers = [\"/spec/replicas\"]\n    }\n\n    ignore_difference {\n      group = \"apps\"\n      kind  = \"StatefulSet\"\n      name  = \"someStatefulSet\"\n      json_pointers = [\n        \"/spec/replicas\",\n        \"/spec/template/spec/metadata/labels/bar\",\n      ]\n      # Only available from ArgoCD 2.1.0 onwards\n      jq_path_expressions = [\n        \".spec.replicas\",\n        \".spec.template.spec.metadata.labels.bar\",\n      ]\n    }\n  }\n}\n\n# Helm application\nresource \"argocd_application\" \"helm\" {\n  metadata {\n    name      = \"helm-app\"\n    namespace = \"argocd\"\n    labels = {\n      test = \"true\"\n    }\n  }\n\n  spec {\n    destination {\n      server    = \"https://kubernetes.default.svc\"\n      namespace = \"default\"\n    }\n\n    source {\n      repo_url        = \"https://some.chart.repo.io\"\n      chart           = \"mychart\"\n      target_revision = \"1.2.3\"\n      helm {\n        release_name = \"testing\"\n        parameter {\n          name  = \"image.tag\"\n          value = \"1.2.3\"\n        }\n        parameter {\n          name  = \"someotherparameter\"\n          value = \"true\"\n        }\n        value_files = [\"values-test.yml\"]\n        values = yamlencode({\n          someparameter = {\n            enabled   = true\n            someArray = [\"foo\", \"bar\"]\n          }\n        })\n      }\n    }\n  }\n}\n\n# Multiple Application Sources with Helm value files from external Git repository\nresource \"argocd_application\" \"multiple_sources\" {\n  metadata {\n    name      = \"helm-app-with-external-values\"\n    namespace = \"argocd\"\n  }\n\n  spec {\n    project = \"default\"\n\n    source {\n      repo_url        = \"https://charts.helm.sh/stable\"\n      chart           = \"wordpress\"\n      target_revision = \"9.0.3\"\n      helm {\n        value_files = [\"$values/helm-dependency/values.yaml\"]\n      }\n    }\n\n    source {\n      repo_url        = \"https://github.com/argoproj/argocd-example-apps.git\"\n      target_revision = \"HEAD\"\n      ref             = \"values\"\n    }\n\n    destination {\n      server    = \"https://kubernetes.default.svc\"\n      namespace = \"default\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/argoproj-labs__terraform-provider-argocd__examples__resources__argocd_application__resource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Exposed ArgoCD API - authenticated using authentication token.\nprovider \"argocd\" {\n  server_addr = \"argocd.local:443\"\n  auth_token  = \"1234...\"\n}\n\n# Exposed ArgoCD API - authenticated using `username`/`password`\nprovider \"argocd\" {\n  server_addr = \"argocd.local:443\"\n  username    = \"foo\"\n  password    = local.password\n}\n\n# Exposed ArgoCD API - (pre)authenticated using local ArgoCD config (e.g. when\n# you have previously logged in using SSO).\nprovider \"argocd\" {\n  use_local_config = true\n  # context = \"foo\" # Use explicit context from ArgoCD config instead of `current-context`.\n}\n\n# Unexposed ArgoCD API - using the current Kubernetes context and\n# port-forwarding to temporarily expose ArgoCD API and authenticating using\n# `auth_token`.\nprovider \"argocd\" {\n  auth_token   = \"1234...\"\n  port_forward = true\n}\n\n# Unexposed ArgoCD API - using port-forwarding to temporarily expose ArgoCD API\n# whilst overriding the current context in kubeconfig.\nprovider \"argocd\" {\n  auth_token                  = \"1234...\"\n  port_forward_with_namespace = \"custom-argocd-namespace\"\n  kubernetes {\n    config_context = \"kind-argocd\"\n  }\n}\n\n# Unexposed ArgoCD API - using `core` to run ArgoCD server locally and\n# communicate directly with the Kubernetes API.\nprovider \"argocd\" {\n  core = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/argoproj-labs__terraform-provider-argocd__examples__provider__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2022 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nresource \"random_pet\" \"vpc_name\" {\n  length    = 2\n  separator = \"-\"\n  keepers   = {}\n}\n\nlocals {\n  vpc_key = random_pet.vpc_name.id\n}\n\n# VPC Creation\nresource \"google_compute_network\" \"network\" {\n  name                    = \"${local.vpc_key}-network\"\n  project                 = var.project\n  auto_create_subnetworks = false\n}\n\n\nresource \"google_compute_router\" \"network_router\" {\n  name    = \"${local.vpc_key}-compute-router\"\n  region  = var.region\n  project = var.project\n  network = google_compute_network.network.name\n}\n\nresource \"google_compute_router_nat\" \"network_nat\" {\n  name                               = \"${local.vpc_key}-nat\"\n  project                            = var.project\n  router                             = google_compute_router.network_router.name\n  region                             = google_compute_router.network_router.region\n  nat_ip_allocate_option             = \"AUTO_ONLY\"\n  source_subnetwork_ip_ranges_to_nat = \"ALL_SUBNETWORKS_ALL_IP_RANGES\"\n  log_config {\n    enable = true\n    filter = \"ERRORS_ONLY\"\n  }\n}\n\n\n\n# Firewalls - allow all internal, allow ssh from external\n\nresource \"google_compute_firewall\" \"firewall_allow_ssh\" {\n  name          = \"${local.vpc_key}-firewall-ssh\"\n  network       = google_compute_network.network.name\n  project       = var.project\n  source_ranges = [\"0.0.0.0/0\"]\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n}\n\n\nresource \"google_compute_firewall\" \"firewall_internal\" {\n  name          = \"${local.vpc_key}-firewall-internal\"\n  network       = google_compute_network.network.name\n  project       = var.project\n  source_ranges = [\"10.0.0.0/8\", \"172.16.0.0/12\", \"192.168.0.0/16\"]\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"0-65535\"]\n  }\n  allow {\n    protocol = \"udp\"\n    ports    = [\"0-65535\"]\n  }\n  allow { protocol = \"icmp\" }\n}\n\nlocals {\n  # This label allows for billing report tracking based on module.\n  labels = {\n    created_by = \"ofe\"\n  }\n}\n\nresource \"random_id\" \"resource_name_suffix\" {\n  byte_length = 4\n}\n\nresource \"google_compute_global_address\" \"private_ip_alloc\" {\n  provider      = google-beta\n  project       = var.project\n  name          = \"global-psconnect-ip-${random_id.resource_name_suffix.hex}\"\n  purpose       = \"VPC_PEERING\"\n  address_type  = \"INTERNAL\"\n  network       = google_compute_network.network.self_link\n  prefix_length = 16\n  labels        = local.labels\n}\n\nresource \"google_service_networking_connection\" \"private_vpc_connection\" {\n  network                 = google_compute_network.network.self_link\n  service                 = \"servicenetworking.googleapis.com\"\n  reserved_peering_ranges = [google_compute_global_address.private_ip_alloc.name]\n}\n\noutput \"vpc_id\" {\n  value       = google_compute_network.network.name\n  description = \"Name of the created VPC\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__cluster-toolkit__community__front-end__ofe__infrastructure_files__vpc_tf__GCP__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_2", "severity": "HIGH", "message": "Ensure Google compute firewall ingress does not allow unrestricted ssh access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__cluster-toolkit__community__front-end__ofe__infrastructure_files__vpc_tf__GCP__main.tf", "start_line": 60}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_subnet_ids\" \"example\" {\n  vpc_id = var.vpc_id\n}\ndata \"aws_availability_zones\" \"available\" {\n  state = \"available\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ViktorUJ__cks__terraform__modules__eks__data.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Why we need ECS instance policies http://docs.aws.amazon.com/AmazonECS/latest/developerguide/instance_IAM_role.html\n# ECS roles explained here http://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs_managed_policies.html\n# Some other ECS policy examples http://docs.aws.amazon.com/AmazonECS/latest/developerguide/IAMPolicyExamples.html \n\nresource \"aws_iam_role\" \"ecs_instance_role\" {\n  name = \"${var.environment}_ecs_instance_role\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2008-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": [\"ec2.amazonaws.com\"]\n      },\n      \"Effect\": \"Allow\"\n    }\n  ]\n}\nEOF\n}\n\nresource \"aws_iam_instance_profile\" \"ecs\" {\n  name = \"${var.environment}_ecs_instance_profile\"\n  path = \"/\"\n  role = aws_iam_role.ecs_instance_role.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"ecs_ec2_role\" {\n  role       = aws_iam_role.ecs_instance_role.id\n  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role\"\n}\n\nresource \"aws_iam_role_policy_attachment\" \"ecs_ec2_cloudwatch_role\" {\n  role       = aws_iam_role.ecs_instance_role.id\n  policy_arn = \"arn:aws:iam::aws:policy/CloudWatchLogsFullAccess\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/arminc__terraform-ecs__modules__ecs__instance_policy.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  common_tags = {\n    Company     = var.company_name\n    Project     = var.project\n    Environment = var.environment\n    BillingCode = var.billing_code\n  }\n  naming_prefix = \"${var.project}-${var.environment}\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Getting-Started-Terraform__m6_solution__locals.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Telemetry is collected by creating an empty ARM deployment with a specific name\n# If you want to disable telemetry, you can set the disable_telemetry variable to true\n\n# This file contains telemetry for the core module\n\n# The following locals are used to create the bitfield data, dependent on the module configuration\nlocals {\n  # Bitfield bit 1 (LSB): Is deploy core LZs enabled?\n  telem_core_deploy_core_landing_zones = local.deploy_core_landing_zones ? 1 : 0\n\n  # Bitfield bit 2: Is deploy corp LZ set?\n  telem_core_deploy_corp_landing_zones = local.deploy_corp_landing_zones ? 2 : 0\n\n  # Bitfield bit 3: Is deploy online LZ set?\n  telem_core_deploy_online_landing_zones = local.deploy_online_landing_zones ? 4 : 0\n\n  # Bitfield bit 4: Is deploy SAP LZ set?\n  telem_core_deploy_sap_landing_zones = local.deploy_online_landing_zones ? 8 : 0\n\n  # Bitfield bit 5: Are there any custom LZs configured?\n  telem_core_custom_lzs_configured = length(local.custom_landing_zones) > 0 ? 16 : 0\n\n  # Bitfield bit 6: Is a custom library path set?\n  telem_core_custom_lib_configured = local.library_path != \"\" ? 32 : 0\n}\n\n# The following locals calculate the telemetry bit field by summiung the above locals and then representing as hexadecimal\n# Hex number is represented as four digits wide and is zero padded\nlocals {\n  telem_core_bitfield_denery = (\n    local.telem_core_deploy_core_landing_zones +\n    local.telem_core_deploy_corp_landing_zones +\n    local.telem_core_deploy_online_landing_zones +\n    local.telem_core_deploy_sap_landing_zones +\n    local.telem_core_custom_lzs_configured +\n    local.telem_core_custom_lib_configured\n  )\n  telem_core_bitfield_hex = format(\"%04x\", local.telem_core_bitfield_denery)\n}\n\n# This construicts the ARM deployment name that is used for the telemetry.\n# We shouldn't ever hit the 64 character limit but use substr just in case\nlocals {\n  telem_core_arm_deployment_name = substr(\n    format(\n      \"pid-%s_%s_%s_%s\",\n      local.telem_core_puid,\n      local.module_version,\n      local.telem_core_bitfield_hex,\n      local.telem_random_hex,\n    ),\n    0,\n    64\n  )\n}\n\n# Condition to determine whether we create the core telemetry deployment\nlocals {\n  telem_core_deployment_enabled = !local.disable_telemetry\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform-azurerm-caf-enterprise-scale__locals.telemetry.core.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.3\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \">= 5.34, < 6.0\"\n    }\n    helm = {\n      source  = \"hashicorp/helm\"\n      version = \">= 2.9, < 3.0\"\n    }\n  }\n\n  # ##  Used for end-to-end testing on project; update to suit your needs\n  # backend \"s3\" {\n  #   bucket = \"terraform-ssp-github-actions-state\"\n  #   region = \"us-west-2\"\n  #   key    = \"e2e/aws-neuron-efa/terraform.tfstate\"\n  # }\n}\n\nprovider \"aws\" {\n  region = local.region\n}\n\n# This provider is required for Public ECR. Public ECR is only available in us-east-1\n# If your region is same as us-east-1 then you can just use one aws provider\nprovider \"aws\" {\n  alias  = \"ecr\"\n  region = \"us-east-1\"\n}\n\nprovider \"helm\" {\n  kubernetes {\n    host                   = module.eks.cluster_endpoint\n    cluster_ca_certificate = base64decode(module.eks.cluster_certificate_authority_data)\n\n    exec {\n      api_version = \"client.authentication.k8s.io/v1beta1\"\n      command     = \"aws\"\n      # This requires the awscli to be installed locally where Terraform is executed\n      args = [\"eks\", \"get-token\", \"--cluster-name\", module.eks.cluster_name]\n    }\n  }\n}\n\n################################################################################\n# Common data/locals\n################################################################################\n\ndata \"aws_availability_zones\" \"available\" {\n  # Do not include local zones\n  filter {\n    name   = \"opt-in-status\"\n    values = [\"opt-in-not-required\"]\n  }\n}\n\nlocals {\n  name   = basename(path.cwd)\n  region = \"us-east-2\"\n\n  vpc_cidr = \"10.0.0.0/16\"\n  azs      = slice(data.aws_availability_zones.available.names, 0, 3)\n\n  tags = {\n    Blueprint  = local.name\n    GithubRepo = \"github.com/aws-ia/terraform-aws-eks-blueprints\"\n  }\n}\n\n################################################################################\n# Output\n################################################################################\n\noutput \"configure_kubectl\" {\n  description = \"Configure kubectl: make sure you're logged in with the correct AWS profile and run the following command to update your kubeconfig\"\n  value       = \"aws eks --region ${local.region} update-kubeconfig --name ${module.eks.cluster_name}\"\n}\n\n################################################################################\n# Supporting Resources\n################################################################################\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"~> 5.0\"\n\n  name = local.name\n  cidr = local.vpc_cidr\n\n  azs             = local.azs\n  private_subnets = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 4, k)]\n  public_subnets  = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 8, k + 48)]\n\n  enable_nat_gateway = true\n  single_nat_gateway = true\n\n  public_subnet_tags = {\n    \"kubernetes.io/role/elb\" = 1\n  }\n\n  private_subnet_tags = {\n    \"kubernetes.io/role/internal-elb\" = 1\n  }\n\n  tags = local.tags\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-eks-blueprints__patterns__aws-neuron-efa__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-eks-blueprints__patterns__aws-neuron-efa__main.tf", "start_line": 86}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"hello_world\" {\n  value = \"Hello, World!\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/im2nguyen__rover__example__simple-test__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"argocd_project\" \"myproject\" {\n  metadata {\n    name      = \"myproject\"\n    namespace = \"argocd\"\n    labels = {\n      acceptance = \"true\"\n    }\n    annotations = {\n      \"this.is.a.really.long.nested.key\" = \"yes, really!\"\n    }\n  }\n\n  spec {\n    description = \"simple project\"\n\n    source_namespaces = [\"argocd\"]\n    source_repos      = [\"*\"]\n\n    destination {\n      server    = \"https://kubernetes.default.svc\"\n      namespace = \"default\"\n    }\n    destination {\n      server    = \"https://kubernetes.default.svc\"\n      namespace = \"foo\"\n    }\n    destination {\n      name      = \"anothercluster\"\n      namespace = \"bar\"\n    }\n\n    cluster_resource_blacklist {\n      group = \"*\"\n      kind  = \"*\"\n    }\n    cluster_resource_whitelist {\n      group = \"rbac.authorization.k8s.io\"\n      kind  = \"ClusterRoleBinding\"\n    }\n    cluster_resource_whitelist {\n      group = \"rbac.authorization.k8s.io\"\n      kind  = \"ClusterRole\"\n    }\n\n    namespace_resource_blacklist {\n      group = \"networking.k8s.io\"\n      kind  = \"Ingress\"\n    }\n    namespace_resource_whitelist {\n      group = \"*\"\n      kind  = \"*\"\n    }\n\n    orphaned_resources {\n      warn = true\n\n      ignore {\n        group = \"apps/v1\"\n        kind  = \"Deployment\"\n        name  = \"ignored1\"\n      }\n\n      ignore {\n        group = \"apps/v1\"\n        kind  = \"Deployment\"\n        name  = \"ignored2\"\n      }\n    }\n\n    role {\n      name = \"testrole\"\n      policies = [\n        \"p, proj:myproject:testrole, applications, override, myproject/*, allow\",\n        \"p, proj:myproject:testrole, applications, sync, myproject/*, allow\",\n        \"p, proj:myproject:testrole, clusters, get, myproject/*, allow\",\n        \"p, proj:myproject:testrole, repositories, create, myproject/*, allow\",\n        \"p, proj:myproject:testrole, repositories, delete, myproject/*, allow\",\n        \"p, proj:myproject:testrole, repositories, update, myproject/*, allow\",\n        \"p, proj:myproject:testrole, logs, get, myproject/*, allow\",\n        \"p, proj:myproject:testrole, exec, create, myproject/*, allow\",\n      ]\n    }\n    role {\n      name = \"anotherrole\"\n      policies = [\n        \"p, proj:myproject:testrole, applications, get, myproject/*, allow\",\n        \"p, proj:myproject:testrole, applications, sync, myproject/*, deny\",\n      ]\n    }\n\n    sync_window {\n      kind         = \"allow\"\n      applications = [\"api-*\"]\n      clusters     = [\"*\"]\n      namespaces   = [\"*\"]\n      duration     = \"3600s\"\n      schedule     = \"10 1 * * *\"\n      manual_sync  = true\n    }\n    sync_window {\n      kind         = \"deny\"\n      applications = [\"foo\"]\n      clusters     = [\"in-cluster\"]\n      namespaces   = [\"default\"]\n      duration     = \"12h\"\n      schedule     = \"22 1 5 * *\"\n      manual_sync  = false\n      timezone     = \"Europe/London\"\n    }\n\n    signature_keys = [\n      \"4AEE18F83AFDEB23\",\n      \"07E34825A909B250\"\n    ]\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/argoproj-labs__terraform-provider-argocd__examples__resources__argocd_project__resource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\nresource \"aws_instance\" \"test-instance\" {\n  ami = \"${var.centos_ami}\"\n  instance_type = \"${var.instance_type}\"\n  key_name = \"${var.key_name}\"\n\n  connection {\n    user = \"centos\"\n    private_key = \"${file(var.key_path)}\"\n  }\n\n  provisioner \"remote-exec\" {\n    inline = [\n    \"sudo yum -y install httpd\",\n    \"sudo service httpd start\"\n    ]\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__advanced_terraform__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__advanced_terraform__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__advanced_terraform__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__advanced_terraform__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__advanced_terraform__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__advanced_terraform__main.tf", "start_line": 5}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"unifi_port_profile\" \"disabled\" {\n  # look up the built-in disabled port profile\n  name = \"Disabled\"\n}\n\nresource \"unifi_port_profile\" \"poe\" {\n  name    = \"poe\"\n  forward = \"customize\"\n\n  native_networkconf_id = var.native_network_id\n  tagged_networkconf_ids = [\n    var.some_vlan_network_id,\n  ]\n\n  poe_mode = \"auto\"\n}\n\nresource \"unifi_device\" \"us_24_poe\" {\n  # optionally specify MAC address to skip manually importing\n  # manual import is the safest way to add a device\n  mac = \"01:23:45:67:89:AB\"\n\n  name = \"Switch with POE\"\n\n  port_override {\n    number          = 1\n    name            = \"port w/ poe\"\n    port_profile_id = unifi_port_profile.poe.id\n  }\n\n  port_override {\n    number          = 2\n    name            = \"disabled\"\n    port_profile_id = data.unifi_port_profile.disabled.id\n  }\n\n  # port aggregation for ports 11 and 12\n  port_override {\n    number              = 11\n    op_mode             = \"aggregate\"\n    aggregate_num_ports = 2\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/paultyng__terraform-provider-unifi__examples__resources__unifi_device__resource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region                   = \"eu-central-1\"\n  shared_credentials_files = [\"/Users/rahulwagh/.aws/credentials\"]\n}\n\nresource \"aws_ecr_repository\" \"docker_ecr_repo\" {\n  name                 = \"docker_ecr_repo\"\n  image_tag_mutability = \"IMMUTABLE\"\n}\n\nresource \"aws_ecr_repository_policy\" \"demo-repo-policy\" {\n  repository = aws_ecr_repository.docker_ecr_repo.name\n  policy     = <<EOF\n  {\n    \"Version\": \"2008-10-17\",\n    \"Statement\": [\n      {\n        \"Sid\": \"Set the permission for ECR\",\n        \"Effect\": \"Allow\",\n        \"Principal\": \"*\",\n        \"Action\": [\n          \"ecr:BatchCheckLayerAvailability\",\n          \"ecr:BatchGetImage\",\n          \"ecr:CompleteLayerUpload\",\n          \"ecr:GetDownloadUrlForLayer\",\n          \"ecr:GetLifecyclePolicy\",\n          \"ecr:InitiateLayerUpload\",\n          \"ecr:PutImage\",\n          \"ecr:UploadLayerPart\"\n        ]\n      }\n    ]\n  }\n  EOF\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__terraform-aws-ecr__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_163", "severity": "HIGH", "message": "Ensure ECR image scanning on push is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__terraform-aws-ecr__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_136", "severity": "HIGH", "message": "Ensure that ECR repositories are encrypted using KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__terraform-aws-ecr__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_32", "severity": "HIGH", "message": "Ensure ECR policy is not set to public", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rahulwagh__Terraform-Topics__terraform-aws-ecr__main.tf", "start_line": 11}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"http\" \"example\" {\n  url = \"https://checkpoint-api.hashicorp.com/v1/check/terraform\"\n\n  # Optional request headers\n  request_headers = {\n    Accept = \"application/json\"\n  }\n\n  lifecycle {\n    postcondition {\n      condition     = contains([201, 204], self.status_code)\n      error_message = \"Status code invalid\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-http__examples__data-sources__http__postcondition.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"helm\" {\n  kubernetes = {\n    config_paths = [\n      \"/path/to/config_a.yaml\",\n      \"/path/to/config_b.yaml\"\n    ]\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-helm__examples__example_3.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# IAM roles to allow Lambda functions to access different AWS resources.\n\n# Fetch our own account id and region. Used in our IAM policy templates.\ndata \"aws_caller_identity\" \"current\" {}\n\n# Template for our 'notify' lambda IAM policy\ndata \"template_file\" \"iam_lambda_notify\" {\n  template = \"${file(\"./files/iam_lambda_notify.tpl\")}\"\n\n  vars {\n    account_id = \"${data.aws_caller_identity.current.account_id}\"\n    region = \"${var.region}\"\n  }\n}\n\n# Template for our 'read_instances' lambda IAM policy\ndata \"template_file\" \"iam_lambda_read_instances\" {\n  template = \"${file(\"./files/iam_lambda_read_instances.tpl\")}\"\n\n  vars {\n    account_id = \"${data.aws_caller_identity.current.account_id}\"\n    region = \"${var.region}\"\n  }\n}\n\n# Template for our 'stop_and_terminate_instances' lambda IAM policy\ndata \"template_file\" \"iam_lambda_stop_and_terminate_instances\" {\n  template = \"${file(\"./files/iam_lambda_stop_and_terminate_instances.tpl\")}\"\n\n  vars {\n    account_id = \"${data.aws_caller_identity.current.account_id}\"\n    region = \"${var.region}\"\n  }\n}\n\n# Template for our 'terminate_asgs' lambda IAM policy\ndata \"template_file\" \"iam_lambda_terminate_asgs\" {\n  template = \"${file(\"./files/iam_lambda_terminate_asgs.tpl\")}\"\n\n  vars {\n    account_id = \"${data.aws_caller_identity.current.account_id}\"\n    region = \"${var.region}\"\n  }\n}\n\n# Role for our 'notify' lambda to assume\n# This role is allowed to use the data collector lambda functions.\nresource \"aws_iam_role\" \"lambda_notify\" {\n  name = \"lambda_notify\"\n\tassume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}\nEOF\n}\n\n# Role for our 'read_instances' lambda to assume\n# Used by data collectors to gather ec2 instance data.\nresource \"aws_iam_role\" \"lambda_read_instances\" {\n  name = \"lambda_read_instances\"\n\tassume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}\nEOF\n}\n\n# Role for our 'stop_and_terminate_instances' lambda to assume.\n# This is used by lambdas that manage instance lifecycles.\nresource \"aws_iam_role\" \"lambda_stop_and_terminate_instances\" {\n  name = \"lambda_stop_and_terminate_instances\"\n\tassume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}\nEOF\n}\n\n# Role for our 'terminate_asgs' lambda to assume.\nresource \"aws_iam_role\" \"lambda_terminate_asgs\" {\n  name = \"lambda_terminate_asgs\"\n\tassume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}\nEOF\n}\n\n# Here we ingest the template and create the role policies\nresource \"aws_iam_role_policy\" \"lambda_notify_policy\" {\n\tname = \"lambda_notify_policy\"\n\tpolicy = \"${data.template_file.iam_lambda_notify.rendered}\"\n  role = \"${aws_iam_role.lambda_notify.id}\"\n}\n\nresource \"aws_iam_role_policy\" \"lambda_read_instances_policy\" {\n\tname = \"lambda_read_instances_policy\"\n\tpolicy = \"${data.template_file.iam_lambda_read_instances.rendered}\"\n  role = \"${aws_iam_role.lambda_read_instances.id}\"\n}\n\nresource \"aws_iam_role_policy\" \"lambda_stop_and_terminate_instances\" {\n\tname = \"lambda_stop_and_terminate_instances\"\n\tpolicy = \"${data.template_file.iam_lambda_stop_and_terminate_instances.rendered}\"\n  role = \"${aws_iam_role.lambda_stop_and_terminate_instances.id}\"\n}\n\nresource \"aws_iam_role_policy\" \"lambda_terminate_asgs\" {\n\tname = \"lambda_terminate_asgs\"\n\tpolicy = \"${data.template_file.iam_lambda_terminate_asgs.rendered}\"\n  role = \"${aws_iam_role.lambda_terminate_asgs.id}\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-guides__infrastructure-as-code__aws-lambda-ec2-lifecycles__iam_roles.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"local_file\" hello{\n  filename = \"./hello.txt\"\n  content  = var.say_hello\n  file_permission = \"0700\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Pradumnasaraf__DevOps__docs__terraform__files__interactive-mode__hello.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright 2019 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     https://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\n\noutput \"network\" {\n  value = \"${module.vpc.network}\"\n}\n\noutput \"subnet\" {\n  value = \"${module.vpc.subnet}\"\n}\n\noutput \"firewall_rule\" {\n  value = \"${module.firewall.firewall_rule}\"\n}\n\noutput \"instance_name\" {\n  value = \"${module.http_server.instance_name}\"\n}\n\noutput \"external_ip\" {\n  value = \"${module.http_server.external_ip}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-cloudbuild-gitops__environments__prod__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"aad_users\" {\n  description = \"A list of AAD user emails that will be granted access to the provisioned project. These are assumed to be part of an AAD group linked to the AzDO org. eg  [\\\"shanw_cicoria@microsoft.com\\\"]\"\n  type        = list(string)\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/microsoft__terraform-provider-azuredevops__examples__azdo-based-cicd__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"region\" {\n  description = \"Region of AWS Account.\"\n  default     = \"ap-south-1\"\n}\n\nvariable \"ami\" {\n  description = \"AMI for AWS Instance.\"\n  default     = \"ami-03d3eec31be6ef6f9\"\n}\n\nvariable \"instance_type\" {\n  description = \"Default Instance Type\"\n  default = \"t2.micro\"\n}\n\nvariable \"name\" {\n  description = \"The name for the EC2 Instance and all other resources in this module.\"\n  default     = \"web\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sagarhere4u__terraform__aws_webserver__vars.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"defaults\" {\n  description = \"Map of default values which will be used for each item.\"\n  type        = any\n  default     = {}\n}\n\nvariable \"items\" {\n  description = \"Maps of items to create a wrapper from. Values are passed through to the module.\"\n  type        = any\n  default     = {}\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-s3-bucket__wrappers__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"local\" {\n    path    = \"example_app/terraform_state\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/starhawking__python-terrascript__docs__tutorials__backend1.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \"0.14.4\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"3.23.0\"\n    }\n  }\n}\n\n# https://registry.terraform.io/providers/hashicorp/aws/latest/docs\nprovider \"aws\" {\n  region  = \"eu-central-1\" # Brasil -> us-east-1\n  profile = \"tf014\"\n}\n\n# https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#private-bucket-w-tags\nresource \"aws_s3_bucket\" \"my-test-bucket\" {\n  bucket = \"my-tf-test-bucket-123123455745642342342\"\n  acl    = \"private\"\n\n  tags = {\n    Name        = \"My bucket\"\n    Environment = \"Dev\"\n    Managedby   = \"Terraform\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__01-terraform-basico__01-primeiro-script__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__01-terraform-basico__01-primeiro-script__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__01-terraform-basico__01-primeiro-script__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__01-terraform-basico__01-primeiro-script__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__01-terraform-basico__01-primeiro-script__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__01-terraform-basico__01-primeiro-script__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__01-terraform-basico__01-primeiro-script__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__01-terraform-basico__01-primeiro-script__main.tf", "start_line": 19}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_s3_bucket\" \"for_web\" {\n  bucket = \"${local.prefix}-${lookup(each.value, \"name\")}-web\"\n  acl    = \"private\"\n\n  tags = {\n    Name = \"${local.prefix}-${lookup(each.value, \"name\")}-web\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__with_config_overrides__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__with_config_overrides__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__with_config_overrides__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__with_config_overrides__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__with_config_overrides__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__with_config_overrides__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__with_config_overrides__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aquasecurity__tfsec__test__testdata__with_config_overrides__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvariable \"container\" {\n  // This is necessary to work around a limitation in Terraform 0.12. If this is set to `map`, as intended, Terraform expects all values within the map to have the same type, which is not the case here.\n  type        = any\n  description = \"A description of the container to deploy\"\n  default = {\n    image   = \"gcr.io/google-containers/busybox\"\n    command = \"ls\"\n  }\n}\n\nvariable \"volumes\" {\n  // This is necessary to work around a limitation in Terraform 0.12. If this is set to `map`, as intended, Terraform expects all values within the map to have the same type, which is not the case here.\n  type        = any\n  description = \"A set of Docker Volumes to configure\"\n  default     = []\n}\n\nvariable \"restart_policy\" {\n  description = \"The restart policy for a Docker container. Defaults to `OnFailure`\"\n  type        = string\n  default     = \"OnFailure\"\n}\n\nvariable \"cos_image_family\" {\n  description = \"The COS image family to use (eg: stable, beta, or dev)\"\n  type        = string\n  default     = \"stable\"\n}\n\nvariable \"cos_image_name\" {\n  description = \"Name of a specific COS image to use instead of the latest cos family image\"\n  type        = string\n  default     = null\n}\n\nvariable \"cos_project\" {\n  description = \"COS project where the image is located\"\n  type        = string\n  default     = \"cos-cloud\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"azurerm_databricks_workspace\" \"this\" {\n  name                        = \"${local.prefix}-workspace\"\n  resource_group_name         = azurerm_resource_group.example.name\n  location                    = azurerm_resource_group.example.location\n  sku                         = \"premium\"\n  managed_resource_group_name = \"${local.prefix}-workspace-rg\"\n\n  custom_parameters {\n    no_public_ip        = false\n    virtual_network_id  = azurerm_virtual_network.example.id\n    public_subnet_name  = azurerm_subnet.public.name\n    private_subnet_name = azurerm_subnet.private.name\n  }\n\n  tags = local.tags\n}\n\noutput \"databricks_azure_workspace_resource_id\" {\n  // The ID of the Databricks Workspace in the Azure management plane.\n  value = azurerm_databricks_workspace.this.id\n}\n\noutput \"workspace_url\" {\n  // The workspace URL which is of the format 'adb-{workspaceId}.{random}.azuredatabricks.net'\n  // this is not named as DATABRICKS_HOST, because it affect authentication\n  value = \"https://${azurerm_databricks_workspace.this.workspace_url}/\"\n}\n\noutput \"cloud_env\" {\n  value = \"azure\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_158", "severity": "HIGH", "message": "Ensure Databricks Workspace data plane to control plane communication happens over private link", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AZURE_48", "severity": "CRITICAL", "message": "Ensure that Databricks Workspaces enables customer-managed key for root DBFS encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/databricks__terraform-provider-databricks__scripts__azvnet-integration__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"azurerm_resource_group\" \"example\" {\n  name     = \"testingtfc-rg\"\n  location = \"northeurope\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                         = \"tfcpostgresql1111\"\n  location                     = azurerm_resource_group.example.location\n  resource_group_name          = azurerm_resource_group.example.name\n  sku_name                     = \"B_Gen5_2\"\n  storage_mb                   = 5120\n  backup_retention_days        = 7\n  geo_redundant_backup_enabled = false\n  auto_grow_enabled            = true\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n  version                      = \"9.5\"\n  ssl_enforcement_enabled      = true\n}\n\nresource \"azurerm_postgresql_configuration\" \"log_checkpoints\" {\n  name                = \"log_checkpoints\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}\n\nresource \"azurerm_postgresql_configuration\" \"log_connections\" {\n  name                = \"log_connections\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}\n\nresource \"azurerm_postgresql_configuration\" \"log_disconnections\" {\n  name                = \"log_disconnections\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}\n\nresource \"azurerm_postgresql_configuration\" \"log_duration\" {\n  name                = \"log_duration\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}\n\nresource \"azurerm_postgresql_configuration\" \"connection_throttling\" {\n  name                = \"connection_throttling\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}\n\nresource \"azurerm_postgresql_configuration\" \"log_retention_days\" {\n  name                = \"log_retention_days\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"4\"\n}\n\nprovider \"azurerm\" {\n\tfeatures {}\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__noskip_multiline_fail__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_130", "severity": "HIGH", "message": "Ensure that PostgreSQL server enables infrastructure encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__noskip_multiline_fail__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_147", "severity": "HIGH", "message": "Ensure PostgreSQL is using the latest version of TLS encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__noskip_multiline_fail__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_68", "severity": "HIGH", "message": "Ensure that PostgreSQL server disables public network access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__noskip_multiline_fail__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_128", "severity": "HIGH", "message": "Ensure that PostgreSQL server enables Threat detection policy", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__noskip_multiline_fail__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_102", "severity": "HIGH", "message": "Ensure that PostgreSQL server enables geo-redundant backups", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__noskip_multiline_fail__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AZURE_42", "severity": "CRITICAL", "message": "Ensure Azure PostgreSQL server is configured with private endpoint", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__noskip_multiline_fail__main.tf", "start_line": 6}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Generate ssh_key\nresource \"tls_private_key\" \"ansible\" {\n  algorithm = \"RSA\"\n  rsa_bits  = 4096\n}\n# Get ssh_key\nresource \"aws_key_pair\" \"ansiblesshkey\" {\n  public_key = tls_private_key.ansible.public_key_openssh\n}\n\nresource \"aws_instance\" \"kubernetes_Servers\" {\n  count                  = 1\n  ami                    = var.kubernetes_ami\n  instance_type          = var.master_instance_type\n  vpc_security_group_ids = [aws_security_group.kubernetes_sg.id]\n  subnet_id              = element(aws_subnet.kubernetes_subnets.*.id, count.index)\n  key_name               = var.key_name\n#  user_data              = \"${file(\"terafrom_scripts/create_ansible_user.sh\")}\"\n\n  tags = {\n    Name = \"Kubernetes_Servers\"\n    Type = \"Kubernetes_Master\"\n  }\n\n  # Copies the ssh_key file to new ec2.\n  provisioner \"file\" {\n    # Read ssh_key and copy to ansible\n    content     = aws_key_pair.ansiblesshkey.public_key\n    destination = \"/home/ansible/.ssh/authorized_keys\"\n  }\n\n}\n\nresource \"aws_instance\" \"kubernetes_Workers\" {\n  count                  = 2\n  ami                    = var.kubernetes_ami\n  instance_type          = var.worker_instance_type\n  vpc_security_group_ids = [aws_security_group.kubernetes_sg.id]\n  subnet_id              = element(aws_subnet.kubernetes_subnets.*.id, count.index)\n  key_name               = var.key_name\n#  user_data              = \"${file(\"terafrom_scripts/create_ansible_user.sh\")}\"\n\n  tags = {\n    Name = \"Kubernetes_Servers\"\n    Type = \"Kubernetes_Worker\"\n  }\n\n  # Copies the ssh_key file to new ec2.\n  provisioner \"file\" {\n    # Read ssh_key and copy to ansible\n    content     = aws_key_pair.ansiblesshkey.public_key\n    destination = \"/home/ansible/.ssh/authorized_keys\"\n  }\n\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__instances.tf", "start_line": 34}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"lesson_05\" {\n  ami           = \"ami-097a2df4ac947655f\"\n  instance_type = \"t2.micro\"\n  key_name      = \"aws_key\"\n  vpc_security_group_ids = [\n    aws_security_group.sg_ssh.id,\n    aws_security_group.sg_https.id,\n    aws_security_group.sg_http.id\n  ]\n  \n  tags = {\n    Name                  = \"Lesson_05\"\n    Vanquisher_of_Gothmog = \"Ecthelion\"\n    Vanquisher_of_Ecthelion = \"Gothmog\"\n  }\n}\n\nresource \"aws_key_pair\" \"deployer\" {\n  key_name   = \"aws_key\"\n  public_key = \"ssh-ed25519 AAAA-etc...\"\n}\n\nresource \"aws_security_group\" \"sg_ssh\" {\n  ingress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n    protocol    = \"tcp\"\n    from_port   = 22\n    to_port     = 22\n  }\n\n  egress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n    protocol    = \"-1\"\n    from_port   = 0\n    to_port     = 0\n  }\n}\n\nresource \"aws_security_group\" \"sg_https\" {\n  ingress {\n    cidr_blocks = [\"192.168.0.0/16\"]\n    protocol    = \"tcp\"\n    from_port   = 443\n    to_port     = 443\n  }\n\n  egress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n    protocol    = \"-1\"\n    from_port   = 0\n    to_port     = 0\n  }\n}\n\nresource \"aws_security_group\" \"sg_http\" {\n  ingress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n    protocol    = \"tcp\"\n    from_port   = 80\n    to_port     = 80\n  }\n\n  egress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n    protocol    = \"-1\"\n    from_port   = 0\n    to_port     = 0\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 55}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 55}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 55}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__lesson-05__solution__instances__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"aws_access_key\" {}\nvariable \"aws_secret_key\" {}\nvariable \"aws_region\" {}\nvariable \"amis\" {\n    description = \"AMIs by region\"\n    default = {\n        us-east-1 = \"ami-97785bed\" # ubuntu 14.04 LTS\n\t\tus-east-2 = \"ami-f63b1193\" # ubuntu 14.04 LTS\n\t\tus-west-1 = \"ami-824c4ee2\" # ubuntu 14.04 LTS\n\t\tus-west-2 = \"ami-f2d3638a\" # ubuntu 14.04 LTS\n    }\n}\nvariable \"vpc_cidr\" {}\nvariable \"vpc_name\" {}\nvariable \"IGW_name\" {}\nvariable \"key_name\" {}\nvariable \"public_subnet1_cidr\" {}\nvariable \"public_subnet2_cidr\" {}\nvariable \"public_subnet3_cidr\" {}\nvariable \"private_subnet_cidr\" {}\nvariable \"public_subnet1_name\" {}\nvariable \"public_subnet2_name\" {}\nvariable \"public_subnet3_name\" {}\nvariable \"private_subnet_name\" {}\nvariable Main_Routing_Table {}\nvariable \"azs\" {\n  description = \"Run the EC2 Instances in these Availability Zones\"\n  default = [\"us-east-1a\", \"us-east-1b\", \"us-east-1c\"]\n}\nvariable \"environment\" { default = \"dev\" }\nvariable \"instance_type\" {\n  default = {\n    dev = \"t2.nano\"\n    test = \"t2.micro\"\n    prod = \"t2.medium\"\n    }\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mavrick202__terraformsingleinstance__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n### PROVIDER\nprovider \"google\" {\n  project = \"advancedterraform\" #replace this with your project-id\n  region  = \"us-central1\"\n  zone    = \"us-central1-a\"\n}\n\n### NETWORK\ndata \"google_compute_network\" \"default\" {\n  name                    = \"default\"\n}\n\n## SUBNET\nresource \"google_compute_subnetwork\" \"subnet-1\" {\n  name                     = \"subnet1\"\n  ip_cidr_range            = \"10.127.0.0/20\"\n  network                  = data.google_compute_network.default.self_link\n  region                   = \"us-central1\"\n  private_ip_google_access = true\n}\n\nresource \"google_compute_firewall\" \"default\" {\n  name    = \"test-firewall\"\n  network = data.google_compute_network.default.self_link\n\n  allow {\n    protocol = \"icmp\"\n  }\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"80\", \"8080\", \"1000-2000\", \"22\"]\n  }\n\n  source_tags = [\"web\"]\n}\n\n### COMPUTE\n## NGINX PROXY\nresource \"google_compute_instance\" \"nginx_instance\" {\n  name         = \"nginx-proxy\"\n  machine_type = \"f1-micro\"\n  tags = [\"web\"]\n  \n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-11\"\n    }\n  }\n\n  network_interface {\n    network = data.google_compute_network.default.self_link\n    subnetwork = google_compute_subnetwork.subnet-1.self_link\n    access_config {\n      \n    }\n  }\n}\n\n## WEB1\nresource \"google_compute_instance\" \"web1\" {\n  name         = \"web1\"\n  machine_type = \"f1-micro\"\n  \n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-11\"\n    }\n  }\n\n  network_interface {\n    # A default network is created for all GCP projects\n    network = data.google_compute_network.default.self_link\n    subnetwork = google_compute_subnetwork.subnet-1.self_link\n  }\n}\n## WEB2\nresource \"google_compute_instance\" \"web2\" {\n  name         = \"web2\"\n  machine_type = \"f1-micro\"\n  \n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-11\"\n    }\n  }\n\n  network_interface {\n    network = data.google_compute_network.default.self_link\n    subnetwork = google_compute_subnetwork.subnet-1.self_link\n  }\n}\n## WEB3\nresource \"google_compute_instance\" \"web3\" {\n  name         = \"web3\"\n  machine_type = \"f1-micro\"\n  \n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-11\"\n    }\n  }\n\n  network_interface {\n    network = data.google_compute_network.default.self_link\n    subnetwork = google_compute_subnetwork.subnet-1.self_link\n  }  \n}\n\n## DB\nresource \"google_compute_instance\" \"mysqldb\" {\n  name         = \"mysqldb\"\n  machine_type = \"f1-micro\"\n  \n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-11\"\n    }\n  }\n\n  network_interface {\n    network = data.google_compute_network.default.self_link\n    subnetwork = google_compute_subnetwork.subnet-1.self_link\n  }  \n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_26", "severity": "HIGH", "message": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 40}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 40}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 40}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 40}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 61}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 61}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 61}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 78}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 94}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 94}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 94}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 111}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 111}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-3099246__main.tf", "start_line": 111}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"vpc\"{\n\nsource = \"../../modules/vpc\"\n\nvpccidr = var.dev_vpccidr\nvpcname = var.dev_vpcname\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/telugudevopsguru__terraform__dev__vpc__vpc.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"region\" {\n  description = \"The AWS region\"\n  default     = \"us-east-2\"\n}\n\nvariable \"internal\" {\n  description = \"Set to true if the ALB should be internal\"\n  default     = false\n}\n\nvariable \"load_balancer_name\" {\n  description = \"The name of the load balancer\"\n  default     = \"frontend-alb\"\n}\n\n\nvariable \"subnets\" {\n  description = \"The subnet ID(s) for the ALB\"\n  type        = list(string)\n  default     = [\"subnet-02b7cd509493d4509\", \"subnet-01a4eb19143e0a787\", \"subnet-0222086e138ca3852\"]\n}\n\nvariable \"enable_deletion_protection\" {\n  description = \"Set to true if you want deletion protection\"\n  default     = false\n}\n\nvariable \"listener_port\" {\n  description = \"The port for the ALB listener\"\n  default     = 443\n}\n\nvariable \"listener_protocol\" {\n  description = \"The protocol for the ALB listener\"\n  default     = \"HTTPS\"\n}\n\n\nvariable \"vpc_id\" {\n  description = \"The VPC ID\"\n  default     = \"vpc-08f32cb147bf6df43\"\n}\n\nvariable \"listener_rule_path_pattern\" {\n  description = \"The path pattern for the listener rule\"\n  default     = [\"/\"]\n}\n\n\n\n# variable \"health_check_path\" {\n#   description = \"The health check path\"\n#   default     = \"/\"\n# }\n\n\n# variable \"target_group_name\" {\n#   description = \"The name of the target group\"\n#   default     = \"my-target-group\"\n# }\n\n# variable \"target_group_port\" {\n#   description = \"The port for the target group\"\n#   default     = 80\n# }\n\n# variable \"target_group_protocol\" {\n#   description = \"The protocol for the target group\"\n#   default     = \"HTTP\"\n# }", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__tf-alb__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n    required_version = \">= 0.14.7\"\n}\n\nprovider \"azurerm\" {\n    version = \"= 1.44.0\"\n    features {\n    }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/andyt530__py-az2tf__stub__azure.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"kubectl\" {\n  apply_retry_count = 5\n}\n\nresource \"kubectl_manifest\" \"test\" {\n  depends_on = [\"kubectl_manifest.definecrd\"]\n\n    yaml_body = <<YAML\napiVersion: couchbase.com/v1\nkind: CouchbaseCluster\nmetadata:\n  name: name-here-cluster\nspec:\n  baseImage: name-here-image\n  version: 6.0.0-1\n  authSecret: name-here-operator-secret-name\n  exposeAdminConsole: true\n  adminConsoleServices:\n    - data\n  cluster:\n    dataServiceMemoryQuota: 256\n    indexServiceMemoryQuota: 256\n    searchServiceMemoryQuota: 256\n    eventingServiceMemoryQuota: 256\n    analyticsServiceMemoryQuota: 1024\n    indexStorageSetting: memory_optimized\n    autoFailoverTimeout: 120\n    autoFailoverMaxCount: 3\n    autoFailoverOnDataDiskIssues: true\n    autoFailoverOnDataDiskIssuesTimePeriod: 120\n    autoFailoverServerGroup: false\n  buckets:\n    - name: default\n      type: couchbase\n      memoryQuota: 128\n      replicas: 1\n      ioPriority: high\n      evictionPolicy: fullEviction\n      conflictResolution: seqno\n      enableFlush: true\n      enableIndexReplica: false\n    - name: test\n      type: couchbase\n      memoryQuota: 128\n      replicas: 1\n      ioPriority: high\n      evictionPolicy: fullEviction\n      conflictResolution: seqno\n      enableFlush: true\n      enableIndexReplica: false\n  servers:\n    - size: 3\n      name: all_services\n      services:\n        - data\n        - index\n        - query\n        - search\n        - eventing\n        - analytics\n\n    YAML\n}\n\n\nresource \"kubectl_manifest\" \"definecrd\" {\n    yaml_body = <<YAML\napiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  name: couchbaseclusters.couchbase.com\nspec:\n  conversion:\n    strategy: None\n  group: couchbase.com\n  names:\n    kind: CouchbaseCluster\n    listKind: CouchbaseClusterList\n    plural: couchbaseclusters\n    shortNames:\n    - couchbase\n    - cbc\n    singular: couchbasecluster\n  scope: Namespaced\n  versions:\n  - name: v1\n    served: true\n    storage: true\n    schema:\n      openAPIV3Schema:\n        type: object\n        properties:\n          spec:\n            type: object\n            properties:\n              adminConsoleServices:\n                items:\n                  enum:\n                  - data\n                  - index\n                  - query\n                  - search\n                  - eventing\n                  - analytics\n                  type: string\n                type: array\n              antiAffinity:\n                type: boolean\n              authSecret:\n                minLength: 1\n                type: string\n              baseImage:\n                type: string\n              buckets:\n                items:\n                  properties:\n                    conflictResolution:\n                      enum:\n                      - seqno\n                      - lww\n                      type: string\n                    enableFlush:\n                      type: boolean\n                    enableIndexReplica:\n                      type: boolean\n                    evictionPolicy:\n                      enum:\n                      - valueOnly\n                      - fullEviction\n                      - noEviction\n                      - nruEviction\n                      type: string\n                    ioPriority:\n                      enum:\n                      - high\n                      - low\n                      type: string\n                    memoryQuota:\n                      minimum: 100\n                      type: integer\n                    name:\n                      pattern: ^[a-zA-Z0-9._\\-%]*$\n                      type: string\n                    replicas:\n                      maximum: 3\n                      minimum: 0\n                      type: integer\n                    type:\n                      enum:\n                      - couchbase\n                      - ephemeral\n                      - memcached\n                      type: string\n                  required:\n                  - name\n                  - type\n                  - memoryQuota\n                  type: object\n                type: array\n              cluster:\n                properties:\n                  analyticsServiceMemoryQuota:\n                    minimum: 1024\n                    type: integer\n                  autoFailoverMaxCount:\n                    maximum: 3\n                    minimum: 1\n                    type: integer\n                  autoFailoverOnDataDiskIssues:\n                    type: boolean\n                  autoFailoverOnDataDiskIssuesTimePeriod:\n                    maximum: 3600\n                    minimum: 5\n                    type: integer\n                  autoFailoverServerGroup:\n                    type: boolean\n                  autoFailoverTimeout:\n                    maximum: 3600\n                    minimum: 5\n                    type: integer\n                  clusterName:\n                    type: string\n                  dataServiceMemoryQuota:\n                    minimum: 256\n                    type: integer\n                  eventingServiceMemoryQuota:\n                    minimum: 256\n                    type: integer\n                  indexServiceMemoryQuota:\n                    minimum: 256\n                    type: integer\n                  indexStorageSetting:\n                    enum:\n                    - plasma\n                    - memory_optimized\n                    type: string\n                  searchServiceMemoryQuota:\n                    minimum: 256\n                    type: integer\n                required:\n                - dataServiceMemoryQuota\n                - indexServiceMemoryQuota\n                - searchServiceMemoryQuota\n                - eventingServiceMemoryQuota\n                - analyticsServiceMemoryQuota\n                - indexStorageSetting\n                - autoFailoverTimeout\n                - autoFailoverMaxCount\n                type: object\n              disableBucketManagement:\n                type: boolean\n              exposeAdminConsole:\n                type: boolean\n              exposedFeatures:\n                items:\n                  enum:\n                  - admin\n                  - xdcr\n                  - client\n                  type: string\n                type: array\n              logRetentionCount:\n                minimum: 0\n                type: integer\n              logRetentionTime:\n                pattern: ^\\d+(ns|us|ms|s|m|h)$\n                type: string\n              paused:\n                type: boolean\n              serverGroups:\n                items:\n                  type: string\n                type: array\n              servers:\n                items:\n                  properties:\n                    name:\n                      minLength: 1\n                      pattern: ^[-_a-zA-Z0-9]+$\n                      type: string\n                    pod:\n                      properties:\n                        automountServiceAccountToken:\n                          type: boolean\n                        couchbaseEnv:\n                          items:\n                            properties:\n                              name:\n                                type: string\n                              value:\n                                type: string\n                            type: object\n                          type: array\n                        labels:\n                          type: object\n                        nodeSelector:\n                          type: object\n                        resources:\n                          properties:\n                            limits:\n                              properties:\n                                cpu:\n                                  type: string\n                                memory:\n                                  type: string\n                                storage:\n                                  type: string\n                              type: object\n                            requests:\n                              properties:\n                                cpu:\n                                  type: string\n                                memory:\n                                  type: string\n                                storage:\n                                  type: string\n                              type: object\n                          type: object\n                        tolerations:\n                          items:\n                            properties:\n                              effect:\n                                type: string\n                              key:\n                                type: string\n                              operator:\n                                type: string\n                              tolerationSeconds:\n                                type: integer\n                              value:\n                                type: string\n                            required:\n                            - key\n                            - operator\n                            - value\n                            - effect\n                            type: object\n                          type: array\n                        volumeMounts:\n                          properties:\n                            analytics:\n                              items:\n                                type: string\n                              type: array\n                            data:\n                              type: string\n                            default:\n                              type: string\n                            index:\n                              type: string\n                            logs:\n                              type: string\n                          type: object\n                      type: object\n                    serverGroups:\n                      items:\n                        type: string\n                      type: array\n                    services:\n                      items:\n                        enum:\n                        - data\n                        - index\n                        - query\n                        - search\n                        - eventing\n                        - analytics\n                        type: string\n                      minLength: 1\n                      type: array\n                    size:\n                      minimum: 1\n                      type: integer\n                  required:\n                  - size\n                  - name\n                  - services\n                  type: object\n                minLength: 1\n                type: array\n              softwareUpdateNotifications:\n                type: boolean\n              tls:\n                properties:\n                  static:\n                    properties:\n                      member:\n                        properties:\n                          serverSecret:\n                            type: string\n                        type: object\n                      operatorSecret:\n                        type: string\n                    type: object\n                type: object\n              version:\n                pattern: ^([\\w\\d]+-)?\\d+\\.\\d+.\\d+(-[\\w\\d]+)?$\n                type: string\n              volumeClaimTemplates:\n                items:\n                  properties:\n                    metadata:\n                      properties:\n                        name:\n                          type: string\n                      required:\n                      - name\n                      type: object\n                    spec:\n                      properties:\n                        resources:\n                          properties:\n                            limits:\n                              properties:\n                                storage:\n                                  type: string\n                              required:\n                              - storage\n                              type: object\n                            requests:\n                              properties:\n                                storage:\n                                  type: string\n                              required:\n                              - storage\n                              type: object\n                          type: object\n                        storageClassName:\n                          type: string\n                      required:\n                      - resources\n                      - storageClassName\n                      type: object\n                  required:\n                  - metadata\n                  - spec\n                  type: object\n                type: array\n            required:\n            - baseImage\n            - version\n            - authSecret\n            - cluster\n            - servers\n    YAML\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gavinbunney__terraform-provider-kubectl__test__e2e__crds__couchbase.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\n# Make sure to set the following environment variables:\n#   AZDO_PERSONAL_ACCESS_TOKEN\n#   AZDO_ORG_SERVICE_URL\n#   AZDO_GITHUB_SERVICE_CONNECTION_PAT\nterraform {\n  required_providers {\n    azuredevops = {\n      source = \"microsoft/azuredevops\"\n      version = \">=0.1.0\"\n    }\n  }\n}\n\nresource \"azuredevops_project\" \"project\" {\n  name       = \"Sample Project\"\n  visibility         = \"private\"\n  version_control    = \"Git\"\n  work_item_template = \"Agile\"\n}\n\nresource \"azuredevops_serviceendpoint_github\" \"github_serviceendpoint\" {\n  project_id            = azuredevops_project.project.id\n  service_endpoint_name = \"GitHub Service Connection\"\n  auth_oauth {\n    oauth_configuration_id = \"00000000-0000-0000-0000-000000000000\"\n  }\n}\n\nresource \"azuredevops_build_definition\" \"nightly_build\" {\n  project_id      = azuredevops_project.project.id\n  agent_pool_name = \"Azure Pipelines\"\n  name            = \"Nightly Build\"\n  path            = \"\\\\\"\n\n  repository {\n    repo_type             = \"GitHub\"\n    repo_id               = \"microsoft/terraform-provider-azuredevops\"\n    branch_name           = \"master\"\n    yml_path              = \".azdo/azure-pipeline-nightly.yml\"\n    service_connection_id = azuredevops_serviceendpoint_github.github_serviceendpoint.id\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/microsoft__terraform-provider-azuredevops__examples__github-based-cicd-simple__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Retrieve a project\ndata \"sentry_project\" \"default\" {\n  organization = \"my-organization\"\n\n  slug = \"my-project\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jianyuan__terraform-provider-sentry__examples__data-sources__sentry_project__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"ip\" {\n  value = vultr_instance.my_instance.main_ip\n}\n\noutput \"fwg_id\" {\n  value = vultr_firewall_group.fwg.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vultr__terraform-provider-vultr__example__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"solution\" {\n  source  = \"aztfmod/caf/azurerm\"\n  version = \"5.7.11\"\n  # source = \"git::https://github.com/aztfmod/terraform-azurerm-caf.git?ref=main\"\n\n  providers = {\n    azurerm.vhub = azurerm.vhub\n  }\n\n  aadb2c                                = var.aadb2c\n  apim                                  = local.apim\n  azuread                               = local.azuread\n  cloud                                 = local.cloud\n  cognitive_services                    = local.cognitive_services\n  communication                         = local.communication\n  compute                               = local.compute\n  current_landingzone_key               = try(var.landingzone.key, var.landingzone[var.backend_type].key)\n  custom_role_definitions               = var.custom_role_definitions\n  data_factory                          = local.data_factory\n  data_protection                       = local.data_protection\n  data_sources                          = var.data_sources\n  database                              = local.database\n  diagnostic_storage_accounts           = var.diagnostic_storage_accounts\n  diagnostics_definition                = var.diagnostics_definition\n  diagnostics_destinations              = var.diagnostics_destinations\n  event_hub_auth_rules                  = var.event_hub_auth_rules\n  event_hub_consumer_groups             = var.event_hub_consumer_groups\n  event_hub_namespace_auth_rules        = var.event_hub_namespace_auth_rules\n  event_hub_namespaces                  = var.event_hub_namespaces\n  event_hubs                            = var.event_hubs\n  global_settings                       = local.global_settings\n  identity                              = local.identity\n  iot                                   = local.iot\n  keyvault_access_policies              = var.keyvault_access_policies\n  keyvault_access_policies_azuread_apps = var.keyvault_access_policies_azuread_apps\n  keyvault_certificate_issuers          = var.keyvault_certificate_issuers\n  keyvaults                             = var.keyvaults\n  log_analytics                         = var.log_analytics\n  logged_aad_app_objectId               = var.logged_aad_app_objectId\n  logged_user_objectId                  = var.logged_user_objectId\n  logic_app                             = local.logic_app\n  managed_identities                    = var.managed_identities\n  messaging                             = local.messaging\n  networking                            = local.networking\n  purview                               = local.purview\n  random_strings                        = var.random_strings\n  remote_objects                        = local.remote\n  resource_groups                       = var.resource_groups\n  role_mapping                          = var.role_mapping\n  security                              = local.security\n  shared_services                       = local.shared_services\n  storage                               = local.storage\n  storage_accounts                      = var.storage_accounts\n  subscription_billing_role_assignments = var.subscription_billing_role_assignments\n  subscriptions                         = var.subscriptions\n  tags                                  = local.tags\n  tenant_id                             = var.tenant_id\n  tfstates                              = var.tfstates\n  user_type                             = var.user_type\n  var_folder_path                       = var.var_folder_path\n  webapp                                = local.webapp\n  maps                                  = local.maps\n\n  diagnostics = {\n    diagnostic_event_hub_namespaces = try(local.diagnostics.diagnostic_event_hub_namespaces, var.diagnostic_event_hub_namespaces)\n    diagnostic_log_analytics        = try(local.diagnostics.diagnostic_log_analytics, var.diagnostic_log_analytics)\n    diagnostic_storage_accounts     = try(local.diagnostics.diagnostic_storage_accounts, var.diagnostic_storage_accounts)\n    diagnostics_definition          = local.diagnostics.diagnostics_definition\n    diagnostics_destinations        = local.diagnostics.diagnostics_destinations\n    event_hub_namespaces            = local.diagnostics.event_hub_namespaces\n    log_analytics                   = local.diagnostics.log_analytics\n    storage_accounts                = local.diagnostics.storage_accounts\n  }\n\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__caf-terraform-landingzones__caf_solution__landingzone.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__caf-terraform-landingzones__caf_solution__landingzone.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Get the context so we can read properties (enabled) from it\ndata \"context_config\" \"this\" {}\n\n# Create a label based on the context\ndata \"context_label\" \"this\" {\n}\n\n# Create tags based on the context. Add the value of the name label to the tags\ndata \"context_tags\" \"this\" {\n    values = {\n    \"type\" = var.pet\n  }\n}\n\nmodule \"pet_set\" {\n  source = \"./modules/instance\"\n  for_each = {for i in range(var.size) : i => var.pet}\n\n  pet = each.value\n  instance = each.key + 1\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__atmos__examples__demo-context__components__terraform__petset__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ----------------------------------------------------------------------------------------------------------------------\n# TERRAFORM OUTPUT\n# ----------------------------------------------------------------------------------------------------------------------\n# SALIDA CON ENLACE DE HTTP A PUERTO 80\noutput \"http_80\" {\n  value       = \"http://${aws_lb.load_balancer.dns_name}\"\n  description = \"HTTP Link Port 80\"\n}\n# SALIDA CON ENLACE DE HTTP A PUERTO 8080\noutput \"http_8080\" {\n  value       = \"http://${aws_lb.load_balancer.dns_name}:8080\"\n  description = \"HTTP Link Port 8080\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/TheAutomationRules__terraform__Video_03_Load_Balancer__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n\tregion=\"us-east-2\"\n}\n\nresource \"aws_s3_bucket\" \"platzi-backend\" {\n\tbucket = var.bucket_name\n\tacl = var.acl \n\ttags = var.tags\n\t\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__demo-backend1__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__demo-backend1__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__demo-backend1__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__demo-backend1__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__demo-backend1__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__demo-backend1__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__demo-backend1__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/muchikon__terraform__demo-backend1__main.tf", "start_line": 5}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// a full variable\nvariable \"string_var\" {\n    type = \"string\"\n    description = \"a test string var\"\n    default = \"foo\"\n}\n\n# another one\nvariable \"number_var\" {\n    description = \"a test number var\"\n    type = number\n    default = 42\n}\n\n/*\n * A multi line comment\n */\nvariable \"bool_var\" {\n    default = false\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gaia-app__gaia__src__test__resources__hcl__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"instance_type\" {\n\ttype = string\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__000_getting_started__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"nginx_url\" {\n  value = \"${element(alicloud_eip.default.*.ip_address, 1)}:80/test.php\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alibaba__terraform-provider__examples__build-lnmp__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"aws_region\" {\n  type    = string\n  default = \"us-east-1\"\n}\n\nvariable \"vpc_name\" {\n  type    = string\n  default = \"demo_vpc\"\n}\n\nvariable \"vpc_cidr\" {\n  type    = string\n  default = \"10.0.0.0/16\"\n}\n\nvariable \"private_subnets\" {\n  default = {\n    \"private_subnet_1\" = 1\n    \"private_subnet_2\" = 2\n    \"private_subnet_3\" = 3\n  }\n}\n\nvariable \"public_subnets\" {\n  default = {\n    \"public_subnet_1\" = 1\n    \"public_subnet_2\" = 2\n    \"public_subnet_3\" = 3\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/btkrausen__hashicorp__terraform__Lab Prerequisites__Section 03 - Understand The Purpose of Terraform__Benefits of State__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.16\"\n    }\n  }\n\n  required_version = \">= 1.2.0\"\n}\n\nprovider \"aws\" {\n\tregion = \"eu-central-1\"\n}\n\nresource \"aws_instance\" \"instance\" {\n\tami           = \"ami-0d1ddd83282187d18\" # Ubuntu 22.04 eu-central-1 Frankfurt\n\tinstance_type = \"t2.nano\"\n\n\ttags = {\n\t\tName = \"Basic Instance\"\n\t}\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__basic-resource-ec2-ubuntu__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__basic-resource-ec2-ubuntu__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__basic-resource-ec2-ubuntu__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__basic-resource-ec2-ubuntu__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__basic-resource-ec2-ubuntu__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/omerbsezer__Fast-Terraform__labs__basic-resource-ec2-ubuntu__main.tf", "start_line": 16}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Below is the variables blocks\nvariable \"ec2_name_tag\" {\n  default = [\"name1\", \"name2\",\"name3\"]\n}\n\nvariable \"instance_type\" {\n            #   0          1          2\n  default = [\"t2.micro\", \"t2.medium\",\"t2.nano\"]\n}\n\nvariable \"ami_ids\" {\n  default = {\n    0 = \"ami-00f7e5c52c0f43726\",\n    1 = \"ami-0892d3c7ee96c0bf7\",\n    2 = \"ami-0892d3c7ee96c0bf7\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/JJTechInc__Terraform__14-Variables with foreach__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/*****************************************\n  Activate Services in Jenkins Project\n *****************************************/\nmodule \"enables-google-apis\" {\n  source  = \"terraform-google-modules/project-factory/google//modules/project_services\"\n  version = \"11.0.0\"\n\n  project_id = var.project_id\n\n  activate_apis = [\n    \"iam.googleapis.com\",\n    \"cloudresourcemanager.googleapis.com\",\n    \"compute.googleapis.com\",\n    \"containerregistry.googleapis.com\",\n    \"container.googleapis.com\",\n    \"storage-component.googleapis.com\",\n    \"logging.googleapis.com\",\n    \"monitoring.googleapis.com\",\n  ]\n}\n\n/*****************************************\n  Jenkins VPC\n *****************************************/\nmodule \"jenkins-vpc\" {\n  source  = \"terraform-google-modules/network/google\"\n  version = \"~> 3.0\"\n\n  project_id   = module.enables-google-apis.project_id\n  network_name = var.network_name\n\n  subnets = [\n    {\n      subnet_name   = var.subnet_name\n      subnet_ip     = \"10.0.0.0/17\"\n      subnet_region = var.region\n    },\n  ]\n\n  secondary_ranges = {\n    \"${var.subnet_name}\" = [\n      {\n        range_name    = var.ip_range_pods_name\n        ip_cidr_range = \"192.168.0.0/18\"\n      },\n      {\n        range_name    = var.ip_range_services_name\n        ip_cidr_range = \"192.168.64.0/18\"\n      },\n    ]\n  }\n}\n\n/*****************************************\n  Jenkins GKE\n *****************************************/\nmodule \"jenkins-gke\" {\n  source                   = \"terraform-google-modules/kubernetes-engine/google//modules/beta-public-cluster/\"\n  version                  = \"~> 15.0\"\n  project_id               = module.enables-google-apis.project_id\n  name                     = \"jenkins\"\n  regional                 = false\n  region                   = var.region\n  zones                    = var.zones\n  network                  = module.jenkins-vpc.network_name\n  subnetwork               = module.jenkins-vpc.subnets_names[0]\n  ip_range_pods            = var.ip_range_pods_name\n  ip_range_services        = var.ip_range_services_name\n  logging_service          = \"logging.googleapis.com/kubernetes\"\n  monitoring_service       = \"monitoring.googleapis.com/kubernetes\"\n  remove_default_node_pool = true\n  service_account          = \"create\"\n  identity_namespace       = \"${module.enables-google-apis.project_id}.svc.id.goog\"\n  node_metadata            = \"GKE_METADATA_SERVER\"\n  node_pools = [\n    {\n      name         = \"butler-pool\"\n      min_count    = 3\n      max_count    = 6\n      auto_upgrade = true\n    }\n  ]\n}\n\n/*****************************************\n  IAM Bindings GKE SVC\n *****************************************/\n# allow GKE to pull images from GCR\nresource \"google_project_iam_member\" \"gke\" {\n  project = module.enables-google-apis.project_id\n  role    = \"roles/storage.objectViewer\"\n\n  member = \"serviceAccount:${module.jenkins-gke.service_account}\"\n}\n\n/*****************************************\n  Jenkins Workload Identity\n *****************************************/\nmodule \"workload_identity\" {\n  source              = \"terraform-google-modules/kubernetes-engine/google//modules/workload-identity\"\n  version             = \"~> 15.0\"\n  project_id          = module.enables-google-apis.project_id\n  name                = \"jenkins-wi-${module.jenkins-gke.name}\"\n  namespace           = \"default\"\n  use_existing_k8s_sa = false\n}\n\n# enable GSA to add and delete pods for jenkins builders\nresource \"google_project_iam_member\" \"cluster-dev\" {\n  project = module.enables-google-apis.project_id\n  role    = \"roles/container.developer\"\n  member  = module.workload_identity.gcp_service_account_fqn\n}\n\n/*****************************************\n  K8S secrets for configuring K8S executers\n *****************************************/\nresource \"kubernetes_secret\" \"jenkins-secrets\" {\n  metadata {\n    name = var.jenkins_k8s_config\n  }\n  data = {\n    project_id          = module.enables-google-apis.project_id\n    kubernetes_endpoint = \"https://${module.jenkins-gke.endpoint}\"\n    ca_certificate      = module.jenkins-gke.ca_certificate\n    jenkins_tf_ksa      = module.workload_identity.k8s_service_account_name\n  }\n}\n\n/*****************************************\n  K8S secrets for GH\n *****************************************/\nresource \"kubernetes_secret\" \"gh-secrets\" {\n  metadata {\n    name = \"github-secrets\"\n  }\n  data = {\n    github_username = var.github_username\n    github_repo     = var.github_repo\n    github_token    = var.github_token\n  }\n}\n\n/*****************************************\n  Grant Jenkins SA Permissions to store\n  TF state for Jenkins Pipelines\n *****************************************/\nresource \"google_storage_bucket_iam_member\" \"tf-state-writer\" {\n  bucket = var.tfstate_gcs_backend\n  role   = \"roles/storage.admin\"\n  member = module.workload_identity.gcp_service_account_fqn\n}\n\n/*****************************************\n  Grant Jenkins SA Permissions project editor\n *****************************************/\nresource \"google_project_iam_member\" \"jenkins-project\" {\n  project = module.enables-google-apis.project_id\n  role    = \"roles/editor\"\n\n  member = module.workload_identity.gcp_service_account_fqn\n\n}\n\ndata \"local_file\" \"helm_chart_values\" {\n  filename = \"${path.module}/values.yaml\"\n}\n\nresource \"helm_release\" \"jenkins\" {\n  name       = \"jenkins\"\n  repository = \"https://charts.helm.sh/stable\"\n  chart      = \"jenkins\"\n  version    = \"1.9.18\"\n  timeout    = 1200\n\n  values = [data.local_file.helm_chart_values.content]\n\n  depends_on = [\n    kubernetes_secret.gh-secrets,\n  ]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-jenkins-gitops__jenkins-gke__tf-gke__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_K8S_21", "severity": "HIGH", "message": "The default namespace should not be used", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-jenkins-gitops__jenkins-gke__tf-gke__main.tf", "start_line": 135}, {"tool": "checkov", "rule_id": "CKV_K8S_21", "severity": "HIGH", "message": "The default namespace should not be used", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-jenkins-gitops__jenkins-gke__tf-gke__main.tf", "start_line": 150}, {"tool": "checkov", "rule_id": "CKV_GCP_117", "severity": "HIGH", "message": "Ensure basic roles are not used at project level.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-jenkins-gitops__jenkins-gke__tf-gke__main.tf", "start_line": 174}, {"tool": "checkov", "rule_id": "CKV_GCP_49", "severity": "HIGH", "message": "Ensure roles do not impersonate or manage Service Accounts used at project level", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-jenkins-gitops__jenkins-gke__tf-gke__main.tf", "start_line": 174}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-jenkins-gitops__jenkins-gke__tf-gke__main.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-jenkins-gitops__jenkins-gke__tf-gke__main.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-jenkins-gitops__jenkins-gke__tf-gke__main.tf", "start_line": 74}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-jenkins-gitops__jenkins-gke__tf-gke__main.tf", "start_line": 116}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n# [START vpc_auto_create]\nresource \"google_compute_network\" \"vpc_network\" {\n  project                 = var.project_id # Replace this with your project ID in quotes\n  name                    = \"my-auto-mode-network\"\n  auto_create_subnetworks = true\n  mtu                     = 1460\n}\n# [END vpc_auto_create]\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-network__examples__basic_auto_mode__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_GCP_18", "severity": "CRITICAL", "message": "Ensure GCP network defines a firewall and does not use the default firewall", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-network__examples__basic_auto_mode__main.tf", "start_line": 18}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"instance_type\" {}\n\nvariable \"region\" {}\n\nvariable \"ami_id\" {}\n\nvariable \"name\" {\n\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/avinashmamidi__terraform__vars.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"location\" {\n  default = \"westeurope\"\n}\nvariable \"admin_username\" {\n  default = \"testadmin\"\n} \nvariable \"rg_keyvault\" {\n  default = \"Keyvault\"\n}\nvariable \"keyvault_name\" {\n  default = \"FLOAPP-Keyvault\"\n}\nvariable \"computer_name_Windows\" {\n  default = \"WS01\"\n}\nvariable \"rg_network\" {\n  default = \"Network-CloudyJourney-RG\"\n}\n\nvariable \"vmsize\" {\n  description = \"VM Size for the Production Environment\"\n  type        = \"map\"\n\n      default = {\n        small         =   \"Standard_DS1_v2\"\n        medium        =   \"Standard_D2s_v3\"\n        large         =   \"Standard_D4s_v3\"\n        extralarge    =   \"Standard_D8s_v3\"\n      }\n}\n\nvariable \"os_ms\" {\n  description = \"Operating System for Database (MSSQL) on the Production Environment\"\n  type        = \"map\"\n\n      default = {\n        publisher   =   \"MicrosoftWindowsServer\"\n        offer       =   \"WindowsServer\"\n        sku         =   \"2019-Datacenter\"\n        version     =   \"latest\"\n      }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Flodu31__Terraform__Deploy_New_Environment_Provisioners__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"oci\" {\n#   version = \"6.21.0\"\n}\n\nvariable \"tenancy_ocid\" {\n  default = \"\"\n}\n\nvariable \"region\" {\n  default = \"us-phoenix-1\"\n}\n\nvariable \"model_model_version\" {\n  default = \"V1.0\"\n}\n\nvariable \"compartment_id\" { default = \"\" }\n\nvariable defined_tag_namespace_name { default = \"\" }\n\n\nresource \"oci_ai_document_project\" \"test_project\" {\n  compartment_id = var.compartment_id\n}\n\nresource \"oci_ai_document_model\" \"test_model\" {\n  #Required\n  compartment_id = var.compartment_id\n  model_type = \"KEY_VALUE_EXTRACTION\"\n  project_id = oci_ai_document_project.test_project.id\n  inference_units = 1\n  language = \"ENG\"\n\n  training_dataset {\n    bucket = \"canary_test\"\n    dataset_type = \"OBJECT_STORAGE\"\n    namespace = \"axylfvgphoea\"\n    object = \"canary-aadhar-dataset_1686632830312.jsonl\"\n  }\n\n  #Optional\n  display_name = \"test_tf_model\"\n  is_quick_mode = \"false\"\n  model_version              = var.model_model_version\n}\n\nvariable \"object_locations\" {\n  type = list(map(string))\n  default = [\n    {\n      bucket    = \"canary_test\"\n      namespace = \"axylfvgphoea\"\n      object    = \"dus_test.pdf\"\n    }\n  ]\n}\n\n\nvariable \"features\" {\n  type = list(map(string))\n  default = [\n    {\n      feature_type = \"KEY_VALUE_EXTRACTION\"\n      selection_mark_detection = false\n    }\n  ]\n}\n\nresource \"oci_ai_document_processor_job\" \"test_processor_job\" {\n  compartment_id = var.compartment_id\n  display_name = \"test_tf_processor_job\"\n  input_location {\n\n    dynamic \"object_locations\" {\n      for_each = var.object_locations\n      content {\n        bucket    = object_locations.value[\"bucket\"]\n        namespace = object_locations.value[\"namespace\"]\n        object    = object_locations.value[\"object\"]\n      }\n    }\n\n    source_type = \"OBJECT_STORAGE_LOCATIONS\"\n  }\n  output_location {\n    bucket = \"canary_test\"\n    namespace = \"axylfvgphoea\"\n    prefix = \"test\"\n  }\n  processor_config {\n\n    dynamic \"features\" {\n      for_each = var.features\n      content {\n        feature_type    = features.value[\"feature_type\"]\n        selection_mark_detection = features.value[\"selection_mark_detection\"]\n      }\n    }\n\n    processor_type = \"GENERAL\"\n    document_type = \"INVOICE\"\n    language = \"ENG\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/oracle__terraform-provider-oci__examples__aiDocument__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"cert_domain_name\" {\n  description = \"The valid domain name associated with the SSL/TLS certificate.\"\n  value       = module.acm.cert_domain_name\n}\n\noutput \"cert_expiry_date\" {\n  description = \"The expiration date of the SSL/TLS certificate.\"\n  value       = module.acm.cert_expiry_date\n}\n\noutput \"cert_renewal_eligibility\" {\n  description = \"Indicates if the SSL/TLS certificate is eligible for renewal.\"\n  value       = module.acm.cert_renewal_eligibility\n}\n\noutput \"cert_source\" {\n  description = \"The source or type of the SSL/TLS certificate (e.g., 'AMAZON_ISSUED', 'IMPORTED').\"\n  value       = module.acm.cert_source\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techiescamp__terraform-aws__infra__acm__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# The following example shows how to issue an HTTP GET request supplying\n# an optional request header.\ndata \"http\" \"example\" {\n  url = \"https://checkpoint-api.hashicorp.com/v1/check/terraform\"\n\n  # Optional request headers\n  request_headers = {\n    Accept = \"application/json\"\n  }\n}\n\n# The following example shows how to issue an HTTP HEAD request.\ndata \"http\" \"example_head\" {\n  url    = \"https://checkpoint-api.hashicorp.com/v1/check/terraform\"\n  method = \"HEAD\"\n}\n\n# The following example shows how to issue an HTTP POST request\n# supplying an optional request body.\ndata \"http\" \"example_post\" {\n  url    = \"https://checkpoint-api.hashicorp.com/v1/check/terraform\"\n  method = \"POST\"\n\n  # Optional request body\n  request_body = \"request body\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-http__examples__data-sources__http__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_s3_bucket\" \"my_app_bucket\" {\n    bucket = \"${var.my_env}-tws-demo-app-bucket\"\n    tags = {\n        Name = \"${var.my_env}-tws-demo-app-bucket\"\n    }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_bucket.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_bucket.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_bucket.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_bucket.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_bucket.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_bucket.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_bucket.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-for-devops__aws_module_project__my_app_infra_module__my_bucket.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nmodule \"gcp-network\" {\n  source  = \"terraform-google-modules/network/google\"\n  version = \">= 9.0.0\"\n\n  project_id   = var.project_id\n  network_name = local.network_name\n\n  subnets = [\n    {\n      subnet_name           = local.subnet_name\n      subnet_ip             = \"10.0.0.0/17\"\n      subnet_region         = var.region\n      subnet_private_access = true\n    },\n    {\n      subnet_name   = local.master_auth_subnetwork\n      subnet_ip     = \"10.60.0.0/17\"\n      subnet_region = var.region\n    },\n  ]\n\n  secondary_ranges = {\n    (local.subnet_name) = [\n      {\n        range_name    = local.pods_range_name\n        ip_cidr_range = \"192.168.0.0/18\"\n      },\n      {\n        range_name    = local.svc_range_name\n        ip_cidr_range = \"192.168.64.0/18\"\n      },\n    ]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-kubernetes-engine__examples__autopilot_private_firewalls__network.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-kubernetes-engine__examples__autopilot_private_firewalls__network.tf", "start_line": 17}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# network.tf\n\nresource \"aws_vpc\" \"test-vpc\" {\n  cidr_block = \"172.16.0.0/16\"\n}\n\n# Fetch AZs in the current region\ndata \"aws_availability_zones\" \"available\" {\n}\n\n\n# Create var.az_count private subnets, each in a different AZ\nresource \"aws_subnet\" \"private\" {\n  count             = var.az_count\n  cidr_block        = cidrsubnet(aws_vpc.test-vpc.cidr_block, 8, count.index)\n  availability_zone = data.aws_availability_zones.available.names[count.index]\n  vpc_id            = aws_vpc.test-vpc.id\n}\n\n# Create var.az_count public subnets, each in a different AZ\nresource \"aws_subnet\" \"public\" {\n  count                   = var.az_count\n  cidr_block              = cidrsubnet(aws_vpc.test-vpc.cidr_block, 8, var.az_count + count.index)\n  availability_zone       = data.aws_availability_zones.available.names[count.index]\n  vpc_id                  = aws_vpc.test-vpc.id\n  map_public_ip_on_launch = true\n}\n\n# Internet Gateway for the public subnet\nresource \"aws_internet_gateway\" \"test-igw\" {\n  vpc_id = aws_vpc.test-vpc.id\n}\n\n# Route the public subnet traffic through the IGW\nresource \"aws_route\" \"internet_access\" {\n  route_table_id         = aws_vpc.test-vpc.main_route_table_id\n  destination_cidr_block = \"0.0.0.0/0\"\n  gateway_id             = aws_internet_gateway.test-igw.id\n}\n\n# Create a NAT gateway with an Elastic IP for each private subnet to get internet connectivity\nresource \"aws_eip\" \"test-eip\" {\n  count      = var.az_count\n  vpc        = true\n  depends_on = [aws_internet_gateway.test-igw]\n}\n\nresource \"aws_nat_gateway\" \"test-natgw\" {\n  count         = var.az_count\n  subnet_id     = element(aws_subnet.public.*.id, count.index)\n  allocation_id = element(aws_eip.test-eip.*.id, count.index)\n}\n\n# Create a new route table for the private subnets, make it route non-local traffic through the NAT gateway to the internet\nresource \"aws_route_table\" \"private\" {\n  count  = var.az_count\n  vpc_id = aws_vpc.test-vpc.id\n\n  route {\n    cidr_block     = \"0.0.0.0/0\"\n    nat_gateway_id = element(aws_nat_gateway.test-natgw.*.id, count.index)\n  }\n}\n\n# Explicitly associate the newly created route tables to the private subnets (so they don't default to the main route table)\nresource \"aws_route_table_association\" \"private\" {\n  count          = var.az_count\n  subnet_id      = element(aws_subnet.private.*.id, count.index)\n  route_table_id = element(aws_route_table.private.*.id, count.index)\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__vpc.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__vpc.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jayachandrareddym__terraform__ecs__vpc.tf", "start_line": 3}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_s3_bucket\" \"mybucket\" {\n  bucket = \"mybucket\"\n  acl = \"public\"\n\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n      }\n    }\n  }\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"example\" {\n  bucket = aws_s3_bucket.example.id\n\n  block_public_acls   = true\n  block_public_policy = true\n}\n\nresource \"aws_s3_bucket_policy\" \"b\" {\n  bucket = aws_s3_bucket.b.id\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Id      = \"MYBUCKETPOLICY\"\n    Statement = [\n      {\n        Sid       = \"IPAllow\"\n        Effect    = \"Deny\"\n        Principal = \"*\"\n        Action    = \"s3:*\"\n        Resource = [\n          aws_s3_bucket.b.arn,\n          \"${aws_s3_bucket.b.arn}/*\",\n        ]\n        Condition = {\n          IpAddress = {\n            \"aws:SourceIp\" = \"8.8.8.8/32\"\n          }\n        }\n      },\n    ]\n  })\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__cft__misc__s3-bucket__test.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_55", "severity": "HIGH", "message": "Ensure S3 bucket has ignore public ACLs enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__cft__misc__s3-bucket__test.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_56", "severity": "HIGH", "message": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__cft__misc__s3-bucket__test.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__cft__misc__s3-bucket__test.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__cft__misc__s3-bucket__test.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__cft__misc__s3-bucket__test.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__cft__misc__s3-bucket__test.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__cft__misc__s3-bucket__test.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__cft__misc__s3-bucket__test.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__cft__misc__s3-bucket__test.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# AWS ASG (AutoScaling Group)\n\nprovider \"aws\" {\n  region = \"eu-central-1\"\n}\n\nresource \"aws_launch_template\" \"asg-template-t2micro\" {\n  name_prefix   = \"asg-template-t2micro\"\n  image_id      = data.aws_ami.ubuntu.id\n  instance_type = \"t2.micro\"\n  key_name = \"rockemsockem\"\n  user_data = filebase64(\"${path.module}/user-data/bootstrap.sh\")\n}\n\nresource \"aws_autoscaling_group\" \"as-ubuntu\" {\n  availability_zones = [\"eu-central-1a\"]\n  desired_capacity   = 3\n  max_size           = 3\n  min_size           = 2\n\n  launch_template {\n    id      = aws_launch_template.asg-template-t2micro.id\n    version = aws_launch_template.asg-template-t2micro.latest_version\n  }\n\n  tag {\n    key                 = \"Name\"\n    value               = \"NODO-ASG\"\n    propagate_at_launch = true\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/TheAutomationRules__terraform__Video_02__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/TheAutomationRules__terraform__Video_02__main.tf", "start_line": 7}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region                      = \"us-east-1\" # <<<<< Try changing this to eu-west-1 to compare the costs\n  skip_credentials_validation = true\n  skip_requesting_account_id  = true\n  access_key                  = \"mock_access_key\"\n  secret_key                  = \"mock_secret_key\"\n\n  default_tags {\n    tags = {\n      DefaultNotOverride = \"defaultnotoverride\"\n      DefaultOverride    = \"defaultoverride\"\n    }\n  }\n}\n\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 3.0\"\n    }\n  }\n}\n\nresource \"aws_sns_topic_subscription\" \"sns_topic_noTags\" {\n  endpoint  = \"some-dummy-endpoint\"\n  protocol  = \"http\"\n  topic_arn = \"arn:aws:sns:us-east-1:123456789123:sns-topic-arn\"\n}\n\nresource \"aws_sns_topic_subscription\" \"sns_topic_withTags\" {\n  endpoint  = \"some-dummy-endpoint\"\n  protocol  = \"http\"\n  topic_arn = \"arn:aws:sns:us-east-1:123456789123:sns-topic-arn\"\n  tags = {\n    DefaultOverride = \"sns-def\"\n    ResourceTag     = \"sns-ghi\"\n  }\n}\n\nresource \"aws_sqs_queue\" \"sqs_noTags\" {\n  name = \"sqs_noTags\"\n}\n\nresource \"aws_sqs_queue\" \"sqs_withTags\" {\n  name = \"sqs_withTags\"\n\n  tags = {\n    DefaultOverride = \"sqs-def\"\n    ResourceTag     = \"sqs-hi\"\n  }\n}\n\nresource \"aws_autoscaling_group\" \"bar\" {\n  name                      = \"foobar3-terraform-test\"\n  max_size                  = 5\n  min_size                  = 2\n  health_check_grace_period = 300\n  health_check_type         = \"ELB\"\n  desired_capacity          = 4\n  force_delete              = true\n\n  tag {\n    key                 = \"foo\"\n    value               = \"bar\"\n    propagate_at_launch = true\n  }\n\n  tag {\n    key                 = \"lorem\"\n    value               = \"ipsum\"\n    propagate_at_launch = false\n  }\n}\n\nresource \"aws_instance\" \"web_app\" {\n  ami           = \"ami-674cbc1e\"\n  instance_type = \"m5.4xlarge\"\n  volume_tags = {\n    \"baz\"           = \"bat\"\n    DefaultOverride = \"volume_tag_overwritten\"\n  }\n\n  root_block_device {\n    volume_size = 50\n  }\n\n  ebs_block_device {\n    device_name = \"my_data\"\n    volume_type = \"io1\"\n    volume_size = 1000\n    iops        = 800\n  }\n\n  tags = {\n    \"foo\" = \"bar\"\n  }\n}\n\nresource \"aws_instance\" \"launch_instance\" {\n  volume_tags = {\n    \"flip\" = \"flop\"\n  }\n  launch_template {\n    id = aws_launch_template.example.id\n  }\n\n  tags = {\n    \"bat\"  = \"ball\"\n    \"fizz\" = \"buzz\"\n  }\n}\n\nresource \"aws_launch_template\" \"example\" {\n  name = \"example-lt\"\n\n  image_id      = \"fake_ami\"\n  instance_type = \"t3.medium\"\n  ebs_optimized = true\n\n  monitoring {\n    enabled = true\n  }\n\n  credit_specification {\n    cpu_credits = \"unlimited\"\n  }\n\n  placement {\n    tenancy = \"dedicated\"\n  }\n\n  block_device_mappings {\n    device_name = \"xvdc\"\n\n    ebs {\n      volume_type = \"io1\"\n      volume_size = 10\n      iops        = 100\n    }\n  }\n\n  tag_specifications {\n    resource_type = \"instance\"\n    tags = {\n      \"fizz\" = \"buzz\"\n    }\n  }\n\n  tag_specifications {\n    resource_type = \"volume\"\n    tags = {\n      \"flip\" = \"flop\"\n    }\n  }\n\n  tag_specifications {\n    resource_type = \"capacity-reservation\"\n    tags = {\n      \"no\" = \"cap\"\n    }\n  }\n}\n\nresource \"aws_autoscaling_group\" \"launch_template\" {\n  name                      = \"foobar3-terraform-test\"\n  max_size                  = 5\n  min_size                  = 2\n  health_check_grace_period = 300\n  health_check_type         = \"ELB\"\n  desired_capacity          = 4\n  force_delete              = true\n\n  launch_template {\n    id = aws_launch_template.example.id\n  }\n\n  tag {\n    key                 = \"foo\"\n    value               = \"bar\"\n    propagate_at_launch = true\n  }\n\n  tag {\n    key                 = \"lorem\"\n    value               = \"ipsum\"\n    propagate_at_launch = false\n  }\n}\n\nresource \"aws_instance\" \"web_app_block_tags\" {\n  ami           = \"ami-674cbc1e\"\n  instance_type = \"m5.4xlarge\"\n\n  root_block_device {\n    volume_size = 50\n    tags = {\n      \"foo\" = \"rbd\"\n    }\n  }\n\n  ebs_block_device {\n    device_name = \"my_data\"\n    volume_type = \"io1\"\n    volume_size = 1000\n    iops        = 800\n\n    tags = {\n      \"foo\" = \"ebd\"\n    }\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_27", "severity": "HIGH", "message": "Ensure all data stored in the SQS queue is encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 41}, {"tool": "checkov", "rule_id": "CKV_AWS_27", "severity": "HIGH", "message": "Ensure all data stored in the SQS queue is encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_315", "severity": "HIGH", "message": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 76}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 76}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 76}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 100}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 100}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 100}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 100}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 114}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 191}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 191}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 191}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 76}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 100}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/infracost__infracost__cmd__infracost__testdata__breakdown_format_json_with_tags_version_less_than5point39__main.tf", "start_line": 191}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_ecs_cluster\" \"demo\" {\n  name = \"demo\"\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__ecs.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_65", "severity": "HIGH", "message": "Ensure container insights are enabled on ECS cluster", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kenken64__NUSISS-DevSecOpsEng__terraform__src__codepipeline-demo__ecs.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-west-1\"\n}\n\nmodule \"application\" {\n  source = \"../\"\n\n  content = \"test\"\n  key     = \"test.txt\"\n}\n\noutput \"s3_file\" {\n  value = module.application.file_url\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices-workshop__modules__application__example__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"location\" {\n  description = \"Location where to deploy resources\"\n}\nvariable \"rg_network\" {\n  description = \"Name of the Resource Group where resources will be deployed\"\n}\nvariable \"computer_name_Windows\" {\n  description = \"Name of the computer\"\n}\nvariable \"subnet_id\" {\n  description = \"Subnet Id where to join the VM\"\n}\n\nvariable \"admin_username\" {\n  description = \"The username associated with the local administrator account on the virtual machine\"\n}\n\nvariable \"admin_password\" {\n  description = \"The password associated with the local administrator account on the virtual machine\"\n}\n\nvariable \"vmsize\" {\n  description = \"VM Size for the Production Environment\"\n  type        = \"map\"\n\n    default = {\n      small         =   \"Standard_DS1_v2\"\n      medium        =   \"Standard_D2s_v3\"\n      large         =   \"Standard_D4s_v3\"\n      extralarge    =   \"Standard_D8s_v3\"\n    }\n}\n\nvariable \"os_ms\" {\n  description = \"Operating System for Database (MSSQL) on the Production Environment\"\n  type        = \"map\"\n\n    default = {\n      publisher   =   \"MicrosoftWindowsServer\"\n      offer       =   \"WindowsServer\"\n      sku         =   \"2019-Datacenter\"\n      version     =   \"latest\"\n    }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Flodu31__Terraform__Deploy_New_Environment__modules__2-windows_vm__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Dashboards\noutput \"datadog_dashboard--ordered_dashboard_example\" {\n  value = datadog_dashboard.ordered_dashboard_example.id\n}\n\noutput \"datadog_dashboard--free_dashboard_example\" {\n  value = datadog_dashboard.free_dashboard_example.id\n}\n\n# Downtimes\noutput \"datadog_downtime--downtime_example\" {\n  value = datadog_downtime.downtime_example.id\n}\n\n# Monitors\noutput \"datadog_monitor--monitor_example\" {\n  value = datadog_monitor.monitor_example.id\n}\n\n# Synthetics\noutput \"datadog_synthetics_test--test_api_example\" {\n  value = datadog_synthetics_test.test_api_example.id\n}\n\n# Users\noutput \"datadog_user--user_example\" {\n  value = datadog_user.user_example.id\n}\n\noutput \"datadog_user--user_example_two\" {\n  value = datadog_user.user_example_two.id\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraformer__tests__datadog__resources__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# We will define \n# 1. Terraform Settings Block\n# 1. Required Version Terraform\n# 2. Required Terraform Providers\n# 3. Terraform Remote State Storage with Azure Storage Account (last step of this section)\n# 2. Terraform Provider Block for AzureRM\n# 3. Terraform Resource Block: Define a Random Pet Resource\n\n# 1. Terraform Settings Block\nterraform {\n  # 1. Required Version Terraform\n  required_version = \">= 1.0\"\n  # 2. Required Terraform Providers  \n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"~> 4.0\"\n    }\n    azuread = {\n      source  = \"hashicorp/azuread\"\n      version = \"~> 3.0\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"~> 3.0\"\n    }\n  }\n\n# Terraform State Storage to Azure Storage Container\n  backend \"azurerm\" {\n    resource_group_name   = \"terraform-storage-rg\"\n    storage_account_name  = \"terraformstateazureaks\"\n    container_name        = \"tfstatefiles\"\n    key                   = \"terraform.tfstate\"\n  }  \n}\n\n\n# 2. Terraform Provider Block for AzureRM\nprovider \"azurerm\" {\n  subscription_id = \"XXXXXXXX\"\n  features {\n  }\n}\n\n# 3. Terraform Resource Block: Define a Random Pet Resource\nresource \"random_pet\" \"aksrandom\" {\n\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__azure-aks-kubernetes-masterclass__24-Azure-AKS-Terraform__24-02-Terraform-Language-Basics__terraform-manifests-aks__01-main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  default_envs = [\n    {\n      name  = \"GCP_PROJECT\"\n      value = var.project\n    },\n    {\n      name  = \"SERVER_TO_RUN\"\n      value = var.protocol\n    }\n  ]\n}\n\ndata \"google_container_registry_image\" \"image\" {\n  name = var.name\n}\n\nresource \"google_cloud_run_service\" \"service\" {\n  name     = \"${var.name}-${var.protocol}\"\n  location = var.location\n\n  template {\n    spec {\n      containers {\n        image = data.google_container_registry_image.image.image_url\n\n        dynamic \"env\" {\n          for_each = concat(local.default_envs, var.envs)\n          content {\n            name  = env.value.name\n            value = env.value.value\n          }\n        }\n      }\n    }\n\n    metadata {\n      annotations = {\n        \"autoscaling.knative.dev/maxScale\" = \"3\"\n      }\n    }\n  }\n\n  autogenerate_revision_name = true\n\n  depends_on = [var.dependency]\n}\n\ndata \"google_iam_policy\" \"noauth\" {\n  binding {\n    role = \"roles/run.invoker\"\n    members = [\n      \"allUsers\",\n    ]\n  }\n}\n\nresource \"google_cloud_run_service_iam_policy\" \"noauth_policy\" {\n  count = var.auth ? 0 : 1\n\n  location = google_cloud_run_service.service.location\n  service  = google_cloud_run_service.service.name\n\n  policy_data = data.google_iam_policy.noauth.policy_data\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ThreeDotsLabs__wild-workouts-go-ddd-example__terraform__service__service.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_113", "severity": "HIGH", "message": "Ensure IAM policy should not define public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ThreeDotsLabs__wild-workouts-go-ddd-example__terraform__service__service.tf", "start_line": 49}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#Set the terraform backend\nterraform {\n  required_version = \">= 0.12.6\"\n\n  backend \"azurerm\" {\n    storage_account_name = \"infrasdbx1vpcjdld1\"\n    container_name       = \"tfstate\"\n    key                  = \"BestPractice-2.tfstate\"\n    resource_group_name  = \"infr-jdld-noprd-rg1\"\n  }\n}\n\n#Set the Provider\nprovider \"azurerm\" {\n  version         = \">= 1.31.0\" #Use the last version tested through an Azure DevOps pipeline here : https://dev.azure.com/jamesdld23/vpc_lab/_build\n  subscription_id = var.subscription_id\n  client_id       = var.client_id\n  client_secret   = var.client_secret\n  tenant_id       = var.tenant_id\n  version         = \"~> 2.0\"\n  features {}\n}\n\n#Call module/resource\n#Get components\ndata \"azurerm_resource_group\" \"bp2\" {\n  name = \"infr-jdld-noprd-rg1\"\n}\n\n#Action\nmodule \"Az-VirtualNetwork-demo\" {\n  source                      = \"JamesDLD/Az-VirtualNetwork/azurerm\"\n  version                     = \"0.1.4\"\n  net_prefix                  = \"demo\"\n  network_resource_group_name = data.azurerm_resource_group.bp2.name\n  virtual_networks = {\n    vnet1 = {\n      id            = \"1\"\n      prefix        = \"bp2\"\n      address_space = [\"198.18.1.0/24\", \"198.18.2.0/24\"]\n    }\n  }\n  subnets                 = var.subnets\n  route_tables            = {}\n  network_security_groups = {}\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/JamesDLD__terraform__Best-Practice__BestPractice-2__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/JamesDLD__terraform__Best-Practice__BestPractice-2__main.tf", "start_line": 31}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"aws_region\" {\n  type        = string\n  description = \"\"\n  default     = \"eu-central-1\"\n}\n\nvariable \"aws_profile\" {\n  type        = string\n  description = \"\"\n  default     = \"tf014\"\n}\n\nvariable \"aws_account_id\" {\n  type        = number\n  description = \"\"\n  default     = 968339500772\n}\n\nvariable \"service_name\" {\n  type        = string\n  description = \"\"\n  default     = \"autoscaling-app\"\n}\n\nvariable \"instance_type\" {\n  type        = string\n  description = \"\"\n  default     = \"t3.micro\"\n}\n\nvariable \"instance_key_name\" {\n  type        = string\n  description = \"\"\n  default     = \"cleber_kp\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright 2019 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     https://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\n\nvariable \"project\" {}\nvariable \"subnet\" {}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-cloudbuild-gitops__modules__firewall__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region     = \"us-west-2\"\n  access_key = \"****\"\n  secret_key = \"****\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__isolation__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"4.17.1\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\nresource \"aws_instance\" \"app_server\" {\n  ami           = var.ami_id\n  instance_type = var.instance_type\n  tags = var.tags\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__12-workspaces__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__12-workspaces__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__12-workspaces__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__12-workspaces__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__12-workspaces__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__12-workspaces__main.tf", "start_line": 14}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#-----------------------------------------------------------\n# ArgoCD project token\n#-----------------------------------------------------------\n\n# https://registry.terraform.io/providers/oboukili/argocd/latest/docs/resources/project_token", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/SebastianUA__terraform__argocd__modules__project__project_token.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#### Class wide variables ####\nvariable ami   { default = \"\" }\nvariable owner { default = \"\" }\n\n\n#### Demo Nodes ####\nvariable demo_node_instance_type  { default = \"t2.micro\" }\nvariable demo_node_instance_count { default = \"1\" }\nvariable demo_node_ssh_key_name   { default = \"\" }\nvariable demo_node_subnet_id      {}\nvariable demo_node_vpc_id         {}\n\nmodule \"demo-node\" {\n  source = \"../../../modules/compute/nodes/demo_node\"\n\n  # instance configuration\n  ami           = \"${var.ami}\"\n  instance_type = \"${var.demo_node_instance_type}\"\n  count         = \"${var.demo_node_instance_count}\"\n  key_name      = \"${var.demo_node_ssh_key_name}\"\n  subnet_id     = \"${var.demo_node_subnet_id}\"\n  vpc_id        = \"${var.demo_node_vpc_id}\"\n\n  owner         = \"${var.owner}\"\n  dependencies    = [\"${module.demo-node-dependency.demo_node_dependency_instance_id}\"]\n}\n#####################\n\n\n#### Demo Node Dependency ####\nvariable demo_node_dependency_instance_type  { default = \"t2.micro\" }\nvariable demo_node_dependency_instance_count { default = \"1\" }\nvariable demo_node_dependency_ssh_key_name   { default = \"\" }\nvariable demo_node_dependency_subnet_id      {}\nvariable demo_node_dependency_vpc_id         {}\n\nmodule \"demo-node-dependency\" {\n  source = \"../../../modules/compute/nodes/demo_node_dependency\"\n\n  ami           = \"${var.ami}\"\n  instance_type = \"${var.demo_node_dependency_instance_type}\"\n  count         = \"${var.demo_node_dependency_instance_count}\"\n  key_name      = \"${var.demo_node_dependency_ssh_key_name}\"\n  subnet_id     = \"${var.demo_node_dependency_subnet_id}\"\n  vpc_id        = \"${var.demo_node_dependency_vpc_id}\"\n\n  owner         = \"${var.owner}\"\n}\n##############################\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/contino__terraform-learn__aws__environments__preprod__compute__demo_nodes.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"active_directory_domain_service\" {\n  source   = \"./modules/identity/active_directory_domain_service\"\n  for_each = local.identity.active_directory_domain_service\n\n  # to destroy azuread_group at last\n  depends_on = [module.azuread_groups, module.azuread_service_principals]\n\n  global_settings = local.global_settings\n  client_config   = local.client_config\n  settings        = each.value\n  base_tags       = local.global_settings.inherit_tags\n\n  resource_group      = local.combined_objects_resource_groups[try(each.value.resource_group.lz_key, local.client_config.landingzone_key)][try(each.value.resource_group_key, each.value.resource_group.key)]\n  resource_group_name = can(each.value.resource_group.name) || can(each.value.resource_group_name) ? try(each.value.resource_group.name, each.value.resource_group_name) : null\n  location            = try(local.global_settings.regions[each.value.region], null)\n  vnets               = try(local.combined_objects_networking, null)\n}\noutput \"active_directory_domain_service\" {\n  value = module.active_directory_domain_service\n}\n\n\nmodule \"active_directory_domain_service_replica_set\" {\n  source   = \"./modules/identity/active_directory_domain_service_replica_set\"\n  for_each = local.identity.active_directory_domain_service_replica_set\n\n  depends_on = [azurerm_virtual_network_peering.peering]\n\n  settings      = each.value\n  client_config = local.client_config\n  location      = try(local.global_settings.regions[each.value.region], null)\n\n\n  remote_objects = {\n    vnets                           = try(local.combined_objects_networking, null)\n    active_directory_domain_service = try(module.active_directory_domain_service, null)\n  }\n\n}\noutput \"active_directory_domain_service_replica_set\" {\n  value = module.active_directory_domain_service_replica_set\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aztfmod__terraform-azurerm-caf__active_directory_domain_service.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\n\nresource \"aws_instance\" \"example\" {\n  ami                    = \"ami-01ed306a12b7d1c96)\"\n  instance_type          = \"t2.micro\"\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/100daysofdevops__100daysofdevops__main.tf", "start_line": 6}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\nOutput Variables\n*/\noutput \"Ansible VM IP Address\" {\n  value = \"${var.vsphere_ipv4_address}\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/anthonyspiteri__terraform__deploy_ansible_CentOS__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  zone_id   = try(aws_route53_zone.this[0].id, aws_route53_zone.ignore_vpc[0].id, data.aws_route53_zone.this[0].id, null)\n  zone_name = try(aws_route53_zone.this[0].name, aws_route53_zone.ignore_vpc[0].name, data.aws_route53_zone.this[0].name, null)\n}\n\n################################################################################\n# Zone\n################################################################################\n\ndata \"aws_route53_zone\" \"this\" {\n  count = var.create && !var.create_zone ? 1 : 0\n\n  name         = var.name\n  private_zone = var.private_zone\n  vpc_id       = var.vpc_id\n}\n\nresource \"aws_route53_zone\" \"this\" {\n  count = var.create && var.create_zone && !var.ignore_vpc ? 1 : 0\n\n  comment           = var.comment\n  delegation_set_id = var.vpc == null ? var.delegation_set_id : null\n  force_destroy     = var.force_destroy\n  name              = var.name\n  tags              = var.tags\n\n  dynamic \"vpc\" {\n    for_each = var.vpc != null ? var.vpc : {}\n\n    content {\n      vpc_id     = vpc.value.vpc_id\n      vpc_region = vpc.value.vpc_region\n    }\n  }\n\n  dynamic \"timeouts\" {\n    for_each = var.timeouts != null ? [var.timeouts] : []\n\n    content {\n      create = timeouts.value.create\n      update = timeouts.value.update\n      delete = timeouts.value.delete\n    }\n  }\n}\n\nresource \"aws_route53_zone\" \"ignore_vpc\" {\n  count = var.create && var.create_zone && var.ignore_vpc ? 1 : 0\n\n  comment           = var.comment\n  delegation_set_id = var.vpc == null ? var.delegation_set_id : null\n  force_destroy     = var.force_destroy\n  name              = var.name\n  tags              = var.tags\n\n  dynamic \"vpc\" {\n    for_each = var.vpc != null ? var.vpc : {}\n\n    content {\n      vpc_id     = vpc.value.vpc_id\n      vpc_region = vpc.value.vpc_region\n    }\n  }\n\n  dynamic \"timeouts\" {\n    for_each = var.timeouts != null ? [var.timeouts] : []\n\n    content {\n      create = timeouts.value.create\n      update = timeouts.value.update\n      delete = timeouts.value.delete\n    }\n  }\n\n  # Prevent the deletion of associated VPCs after the initial creation.\n  # See documentation on aws_route53_zone_association for details\n  lifecycle {\n    ignore_changes = [vpc]\n  }\n}\n\n################################################################################\n# VPC Association Authorization\n################################################################################\n\nresource \"aws_route53_vpc_association_authorization\" \"this\" {\n  for_each = var.create && var.vpc_association_authorizations != null ? var.vpc_association_authorizations : {}\n\n  zone_id    = local.zone_id\n  vpc_id     = each.value.vpc_id\n  vpc_region = each.value.vpc_region\n}\n\n################################################################################\n# DNSSEC\n################################################################################\n\nresource \"aws_route53_key_signing_key\" \"this\" {\n  count = var.create && var.enable_dnssec ? 1 : 0\n\n  name                       = local.zone_name\n  hosted_zone_id             = local.zone_id\n  key_management_service_arn = var.create_dnssec_kms_key ? module.route53_dnssec_kms.key_arn : var.dnssec_kms_key_arn\n}\n\nresource \"aws_route53_hosted_zone_dnssec\" \"this\" {\n  count = var.create && var.enable_dnssec ? 1 : 0\n\n  hosted_zone_id = aws_route53_key_signing_key.this[0].hosted_zone_id\n}\n\nmodule \"route53_dnssec_kms\" {\n  source  = \"terraform-aws-modules/kms/aws\"\n  version = \"4.0.0\"\n\n  create = var.create && var.enable_dnssec && var.create_dnssec_kms_key\n\n  # This key must be in the us-east-1 Region per AWS API\n  region = \"us-east-1\"\n\n  description = var.dnssec_kms_key_description\n\n  key_usage                = \"SIGN_VERIFY\"\n  customer_master_key_spec = \"ECC_NIST_P256\"\n  enable_key_rotation      = false\n  enable_route53_dnssec    = true\n\n  # Aliases\n  aliases = var.dnssec_kms_key_aliases\n\n  tags = merge(\n    var.tags,\n    var.dnssec_kms_key_tags\n  )\n}\n\n################################################################################\n# Records\n################################################################################\n\nresource \"aws_route53_record\" \"this\" {\n  for_each = { for k, v in var.records : k => v if var.create }\n\n  dynamic \"alias\" {\n    for_each = each.value.alias != null ? [each.value.alias] : []\n\n    content {\n      evaluate_target_health = each.value.alias.evaluate_target_health\n      name                   = each.value.alias.name\n      zone_id                = each.value.alias.zone_id\n    }\n  }\n\n  allow_overwrite = each.value.allow_overwrite\n\n  dynamic \"cidr_routing_policy\" {\n    for_each = each.value.cidr_routing_policy != null ? [each.value.cidr_routing_policy] : []\n\n    content {\n      collection_id = cidr_routing_policy.value.collection_id\n      location_name = cidr_routing_policy.value.location_name\n    }\n  }\n\n  dynamic \"failover_routing_policy\" {\n    for_each = each.value.failover_routing_policy != null ? [each.value.failover_routing_policy] : []\n\n    content {\n      type = each.value.failover_routing_policy.type\n    }\n  }\n\n  dynamic \"geolocation_routing_policy\" {\n    for_each = each.value.geolocation_routing_policy != null ? [each.value.geolocation_routing_policy] : []\n\n    content {\n      continent   = each.value.geolocation_routing_policy.continent\n      country     = each.value.geolocation_routing_policy.country\n      subdivision = each.value.geolocation_routing_policy.subdivision\n    }\n  }\n\n  dynamic \"geoproximity_routing_policy\" {\n    for_each = each.value.geoproximity_routing_policy != null ? [each.value.geoproximity_routing_policy] : []\n\n    content {\n      aws_region = each.value.geoproximity_routing_policy.aws_region\n      bias       = each.value.geoproximity_routing_policy.bias\n\n      dynamic \"coordinates\" {\n        for_each = each.value.geoproximity_routing_policy.coordinates != null ? each.value.geoproximity_routing_policy.coordinates : []\n\n        content {\n          latitude  = coordinates.value.latitude\n          longitude = coordinates.value.longitude\n        }\n      }\n\n      local_zone_group = each.value.geoproximity_routing_policy.local_zone_group\n    }\n  }\n\n  health_check_id = each.value.health_check_id\n\n  dynamic \"latency_routing_policy\" {\n    for_each = each.value.latency_routing_policy != null ? [each.value.latency_routing_policy] : []\n\n    content {\n      region = each.value.latency_routing_policy.region\n    }\n  }\n\n  multivalue_answer_routing_policy = each.value.multivalue_answer_routing_policy\n  name                             = coalesce(each.value.full_name, try(\"${each.value.name}.${local.zone_name}\", \"${each.key}.${local.zone_name}\"))\n  records                          = each.value.records\n  set_identifier                   = each.value.set_identifier\n  ttl                              = each.value.ttl\n  type                             = each.value.type\n\n  dynamic \"weighted_routing_policy\" {\n    for_each = each.value.weighted_routing_policy != null ? [each.value.weighted_routing_policy] : []\n\n    content {\n      weight = each.value.weighted_routing_policy.weight\n    }\n  }\n\n  zone_id = local.zone_id\n\n  dynamic \"timeouts\" {\n    for_each = each.value.timeouts != null ? [each.value.timeouts] : []\n\n    content {\n      create = timeouts.value.create\n      update = timeouts.value.update\n      delete = timeouts.value.delete\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-route53__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"google_compute_forwarding_rule\" \"test-1\" {\n  all_ports             = true\n  allow_global_access   = false\n  description           = \"test description\"\n  ip_address            = \"10.128.0.62\"\n  ip_protocol           = \"TCP\"\n  load_balancing_scheme = \"INTERNAL_MANAGED\"\n  name                  = \"test-1\"\n  network_tier          = \"PREMIUM\"\n  port_range            = \"80-82\"\n  region                = \"us-central1\"\n  subnetwork            = \"projects/myproj/regions/us-central1/subnetworks/default\"\n  target                = \"projects/myproj/regions/us-central1/targetHttpProxies/test1-target-proxy\"\n}\n\nresource \"google_compute_forwarding_rule\" \"test-2\" {\n  backend_service       = \"projects/myproj/regions/us-central1/backendServices/test-bs-1\"\n  ip_address            = \"projects/myproj/regions/us-central1/addresses/test-ip-1\"\n  ip_protocol           = \"TCP\"\n  ip_version            = \"IPV6\"\n  load_balancing_scheme = \"EXTERNAL\"\n  name                  = \"test-2\"\n  ports                 = [\"80\", \"81\"]\n  region                = \"us-central1\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__magic-modules__mmv1__third_party__cai2hcl__services__compute__testdata__compute_forwarding_rule.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  enabled = module.this.enabled\n\n  bucket_enabled        = local.enabled && var.bucket_enabled\n  s3_state_lock_enabled = local.enabled && var.s3_state_lock_enabled\n  dynamodb_enabled      = local.enabled && var.dynamodb_enabled\n\n  dynamodb_table_name = local.dynamodb_enabled ? coalesce(var.dynamodb_table_name, module.dynamodb_table_label.id) : \"\"\n\n  prevent_unencrypted_uploads = local.enabled && var.prevent_unencrypted_uploads\n\n  policy = one(data.aws_iam_policy_document.aggregated_policy[*].json)\n\n  terraform_backend_config_file = format(\n    \"%s/%s\",\n    var.terraform_backend_config_file_path,\n    var.terraform_backend_config_file_name\n  )\n\n  terraform_version_minimum              = local.s3_state_lock_enabled ? \"1.11.0\" : \"1.0.0\"\n  terraform_version_requested            = var.terraform_version != null ? var.terraform_version : local.terraform_version_minimum\n  terraform_backend_config_template_file = var.terraform_backend_config_template_file != \"\" ? var.terraform_backend_config_template_file : \"${path.module}/templates/terraform.tf.tpl\"\n\n  terraform_backend_config_content = templatefile(local.terraform_backend_config_template_file, {\n    region = data.aws_region.current.name\n    # Template file inputs cannot be null, so we use empty string if the variable is null\n    bucket = try(aws_s3_bucket.default[0].id, \"\")\n\n    dynamodb_table = try(aws_dynamodb_table.with_server_side_encryption[0].name, \"\")\n    use_lockfile   = local.s3_state_lock_enabled\n\n    encrypt              = \"true\"\n    role_arn             = var.role_arn == null ? \"\" : var.role_arn\n    profile              = var.profile == null ? \"\" : var.profile\n    terraform_version    = local.terraform_version_requested\n    terraform_state_file = var.terraform_state_file == null ? \"\" : var.terraform_state_file\n    namespace            = var.namespace == null ? \"\" : var.namespace\n    stage                = var.stage == null ? \"\" : var.stage\n    environment          = var.environment == null ? \"\" : var.environment\n    name                 = var.name == null ? \"\" : var.name\n  })\n\n  labels_enabled = local.enabled && (var.s3_bucket_name == \"\" || var.s3_bucket_name == null)\n\n  bucket_name = local.labels_enabled ? module.bucket_label.id : var.s3_bucket_name\n}\n\nmodule \"bucket_label\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.25.0\"\n\n  enabled         = local.labels_enabled\n  id_length_limit = 63\n\n  context = module.this.context\n}\n\ndata \"aws_region\" \"current\" {}\n\ndata \"aws_iam_policy_document\" \"aggregated_policy\" {\n  count = local.enabled ? 1 : 0\n\n  source_policy_documents   = [one(data.aws_iam_policy_document.bucket_policy[*].json)]\n  override_policy_documents = var.source_policy_documents\n}\n\ndata \"aws_iam_policy_document\" \"bucket_policy\" {\n  count = local.enabled ? 1 : 0\n\n  dynamic \"statement\" {\n    for_each = local.prevent_unencrypted_uploads ? [\"true\"] : []\n\n    content {\n      sid = \"DenyIncorrectEncryptionHeader\"\n\n      effect = \"Deny\"\n\n      principals {\n        identifiers = [\"*\"]\n        type        = \"AWS\"\n      }\n\n      actions = [\n        \"s3:PutObject\"\n      ]\n\n      resources = [\n        \"${var.arn_format}:s3:::${local.bucket_name}/*\",\n      ]\n\n      condition {\n        test     = \"StringNotEquals\"\n        variable = \"s3:x-amz-server-side-encryption\"\n\n        values = [\n          \"AES256\",\n          \"aws:kms\"\n        ]\n      }\n    }\n  }\n\n  dynamic \"statement\" {\n    for_each = local.prevent_unencrypted_uploads ? [\"true\"] : []\n\n    content {\n      sid = \"DenyUnEncryptedObjectUploads\"\n\n      effect = \"Deny\"\n\n      principals {\n        identifiers = [\"*\"]\n        type        = \"AWS\"\n      }\n\n      actions = [\n        \"s3:PutObject\"\n      ]\n\n      resources = [\n        \"${var.arn_format}:s3:::${local.bucket_name}/*\",\n      ]\n\n      condition {\n        test     = \"Null\"\n        variable = \"s3:x-amz-server-side-encryption\"\n\n        values = [\n          \"true\"\n        ]\n      }\n    }\n  }\n\n  statement {\n    sid = \"EnforceTlsRequestsOnly\"\n\n    effect = \"Deny\"\n\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"*\"]\n    }\n\n    actions = [\"s3:*\"]\n\n    resources = [\n      \"${var.arn_format}:s3:::${local.bucket_name}\",\n      \"${var.arn_format}:s3:::${local.bucket_name}/*\",\n    ]\n\n    condition {\n      test     = \"Bool\"\n      variable = \"aws:SecureTransport\"\n      values   = [\"false\"]\n    }\n  }\n}\n\n#S3 access controls, policies and logging are defined as seperate terraform resources below\n#tfsec:ignore:aws-s3-block-public-acls tfsec:ignore:aws-s3-block-public-policy tfsec:ignore:aws-s3-enable-bucket-encryption tfsec:ignore:aws-s3-encryption-customer-key tfsec:ignore:aws-s3-ignore-public-acls tfsec:ignore:aws-s3-no-public-buckets tfsec:ignore:aws-s3-enable-bucket-logging tfsec:ignore:aws-s3-enable-versioning tfsec:ignore:aws-s3-specify-public-access-block\nresource \"aws_s3_bucket\" \"default\" {\n  count = local.bucket_enabled ? 1 : 0\n\n  #bridgecrew:skip=BC_AWS_S3_13:Skipping `Enable S3 Bucket Logging` check until Bridgecrew will support dynamic blocks (https://github.com/bridgecrewio/checkov/issues/776).\n  #bridgecrew:skip=CKV_AWS_52:Skipping `Ensure S3 bucket has MFA delete enabled` check due to issues operating with `mfa_delete` in terraform\n  bucket        = substr(local.bucket_name, 0, 63)\n  force_destroy = var.force_destroy\n\n  tags = module.this.tags\n}\n\nresource \"aws_s3_bucket_object_lock_configuration\" \"default\" {\n  count = local.s3_state_lock_enabled ? 1 : 0\n\n  bucket = one(aws_s3_bucket.default[*].id)\n\n  rule {\n    default_retention {\n      mode = \"GOVERNANCE\"\n      days = 7\n    }\n  }\n  depends_on = [aws_s3_bucket_versioning.default]\n}\n\nresource \"aws_s3_bucket_policy\" \"default\" {\n  count = local.bucket_enabled ? 1 : 0\n\n  bucket     = one(aws_s3_bucket.default[*].id)\n  policy     = local.policy\n  depends_on = [aws_s3_bucket_public_access_block.default]\n}\n\nresource \"aws_s3_bucket_acl\" \"default\" {\n  count = local.bucket_enabled && !var.bucket_ownership_enforced_enabled ? 1 : 0\n\n  bucket = one(aws_s3_bucket.default[*].id)\n  acl    = var.acl\n\n  # Default \"bucket ownership controls\" for new S3 buckets is \"BucketOwnerEnforced\", which disables ACLs.\n  # So, we need to wait until we change bucket ownership to \"BucketOwnerPreferred\" before we can set ACLs.\n  depends_on = [aws_s3_bucket_ownership_controls.default]\n}\n\nresource \"aws_s3_bucket_versioning\" \"default\" {\n  count = local.bucket_enabled ? 1 : 0\n\n  bucket = one(aws_s3_bucket.default[*].id)\n\n  versioning_configuration {\n    status     = \"Enabled\"\n    mfa_delete = var.mfa_delete ? \"Enabled\" : \"Disabled\"\n  }\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"default\" {\n  count = local.bucket_enabled ? 1 : 0\n\n  bucket = one(aws_s3_bucket.default[*].id)\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm     = var.sse_encryption\n      kms_master_key_id = var.kms_master_key_id\n    }\n  }\n}\n\nresource \"aws_s3_bucket_logging\" \"default\" {\n  count = local.bucket_enabled && length(var.logging) > 0 ? 1 : 0\n\n  bucket = one(aws_s3_bucket.default[*].id)\n\n  target_bucket = var.logging[0].target_bucket\n  target_prefix = var.logging[0].target_prefix\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"default\" {\n  count = local.bucket_enabled && var.enable_public_access_block ? 1 : 0\n\n  bucket                  = one(aws_s3_bucket.default[*].id)\n  block_public_acls       = var.block_public_acls\n  ignore_public_acls      = var.ignore_public_acls\n  block_public_policy     = var.block_public_policy\n  restrict_public_buckets = var.restrict_public_buckets\n}\n\n# After you apply the bucket owner enforced setting for Object Ownership, ACLs are disabled for the bucket.\n# See https://docs.aws.amazon.com/AmazonS3/latest/userguide/about-object-ownership.html\nresource \"aws_s3_bucket_ownership_controls\" \"default\" {\n  count  = local.bucket_enabled ? 1 : 0\n  bucket = one(aws_s3_bucket.default[*].id)\n\n  rule {\n    object_ownership = var.bucket_ownership_enforced_enabled ? \"BucketOwnerEnforced\" : \"BucketOwnerPreferred\"\n  }\n  depends_on = [time_sleep.wait_for_aws_s3_bucket_settings]\n}\n\n# Workaround S3 eventual consistency for settings objects\nresource \"time_sleep\" \"wait_for_aws_s3_bucket_settings\" {\n  count = local.enabled ? 1 : 0\n\n  depends_on       = [aws_s3_bucket_public_access_block.default, aws_s3_bucket_policy.default]\n  create_duration  = \"30s\"\n  destroy_duration = \"30s\"\n}\n\nmodule \"dynamodb_table_label\" {\n  source     = \"cloudposse/label/null\"\n  version    = \"0.25.0\"\n  attributes = [\"lock\"]\n  context    = module.this.context\n  enabled    = local.dynamodb_enabled\n}\n\nresource \"aws_dynamodb_table\" \"with_server_side_encryption\" {\n  count                       = local.dynamodb_enabled ? 1 : 0\n  name                        = local.dynamodb_table_name\n  billing_mode                = var.billing_mode\n  read_capacity               = var.billing_mode == \"PROVISIONED\" ? var.read_capacity : null\n  write_capacity              = var.billing_mode == \"PROVISIONED\" ? var.write_capacity : null\n  deletion_protection_enabled = var.deletion_protection_enabled\n\n  # https://www.terraform.io/docs/backends/types/s3.html#dynamodb_table\n  hash_key = \"LockID\"\n\n  server_side_encryption { #tfsec:ignore:aws-dynamodb-table-customer-key\n    enabled = true\n  }\n\n  point_in_time_recovery {\n    enabled = var.enable_point_in_time_recovery\n  }\n\n  attribute {\n    name = \"LockID\"\n    type = \"S\"\n  }\n\n  tags = module.dynamodb_table_label.tags\n}\n\nresource \"local_file\" \"terraform_backend_config\" {\n  count           = local.enabled && var.terraform_backend_config_file_path != \"\" ? 1 : 0\n  content         = local.terraform_backend_config_content\n  filename        = local.terraform_backend_config_file\n  file_permission = \"0644\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__main.tf", "start_line": 278}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__main.tf", "start_line": 270}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__main.tf", "start_line": 162}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__main.tf", "start_line": 162}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-tfstate-backend__main.tf", "start_line": 162}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"=3.0.0\"\n    }\n  }\n}\n\n# Configure the Microsoft Azure Provider\nprovider \"azurerm\" {\n  features {}\n}\n\nresource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources1\"\n  location = \"EAST US\"\n}\n\nresource \"azurerm_virtual_network\" \"example\" {\n  name                = \"example-network\"\n  address_space       = [\"10.0.0.0/16\"]\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n}\n\nresource \"azurerm_subnet\" \"example\" {\n  name                 = \"internal\"\n  resource_group_name  = azurerm_resource_group.example.name\n  virtual_network_name = azurerm_virtual_network.example.name\n  address_prefixes     = [\"10.0.2.0/24\"]\n}\n\nresource \"azurerm_public_ip\" \"example\" {\n  name                     = \"example_pip\"\n  resource_group_name = azurerm_resource_group.example.name\n  location                 = azurerm_resource_group.example.location\n  allocation_method        = \"Dynamic\"\n}\n\nresource \"azurerm_network_interface\" \"example\" {\n  name                = \"example-nic\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  ip_configuration {\n    name                          = \"internal\"\n    subnet_id                     = azurerm_subnet.example.id\n    private_ip_address_allocation = \"Dynamic\"\n    public_ip_address_id          = azurerm_public_ip.example.id\n  }\n}\n\nresource \"azurerm_linux_virtual_machine\" \"example\" {\n  name                = \"example-machine\"\n  resource_group_name = azurerm_resource_group.example.name\n  location            = azurerm_resource_group.example.location\n  size                = \"Standard_F2\"\n  admin_username      = \"adminuser\"\n  network_interface_ids = [\n    azurerm_network_interface.example.id,\n  ]\n\n  admin_ssh_key {\n    username   = \"adminuser\"\n    public_key = file(\"~/.ssh/id_rsa.pub\")\n  }\n\n  os_disk {\n    caching              = \"ReadWrite\"\n    storage_account_type = \"Standard_LRS\"\n  }\n\n  source_image_reference {\n    publisher = \"Canonical\"\n    offer     = \"0001-com-ubuntu-server-jammy\"\n    sku       = \"22_04-lts\"\n    version   = \"latest\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__Azure-zero-to-hero__Day-23__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_50", "severity": "HIGH", "message": "Ensure Virtual Machine Extensions are not Installed", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__Azure-zero-to-hero__Day-23__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AZURE_119", "severity": "HIGH", "message": "Ensure that Network Interfaces don't use public IPs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__Azure-zero-to-hero__Day-23__main.tf", "start_line": 41}, {"tool": "checkov", "rule_id": "CKV2_AZURE_31", "severity": "CRITICAL", "message": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__Azure-zero-to-hero__Day-23__main.tf", "start_line": 27}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nCreate a VPC from UI in awscloud: Mandatory value : IPv4 CIDR\nCreate a EC2 instance , install terraform and export access key and secret key over the machine.\nmkdir test\ncd test\ncat main.tf \nprovider \"aws\" {\n  region = \"us-east-2\"\n}\nresource \"aws_vpc\" \"vpc\" {\n  cidr_block           = \"10.0.0.0/16\"\n}\n\nterraform init\nterraform import aws_vpc.vpc vpc-0082b3c1a3f75caa3\nterraform tfstate file will be created ,now we can manage VPC from terraform code itself .\nChanging the param enable_dns_hostnames to true,previously it was false .\n\nprovider \"aws\" {\n  region = \"us-east-2\"\n}\nresource \"aws_vpc\" \"vpc\" {\n  cidr_block           = \"10.0.0.0/16\"\n  enable_dns_hostnames = true\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Devops-Techstack__Terraform__terraform-import.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Devops-Techstack__Terraform__terraform-import.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Devops-Techstack__Terraform__terraform-import.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#Create VPC in us-east-1\nresource \"aws_vpc\" \"vpc_master\" {\n  provider             = aws.region-master\n  cidr_block           = \"10.0.0.0/16\"\n  enable_dns_support   = true\n  enable_dns_hostnames = true\n  tags = {\n    Name = \"master-vpc-jenkins\"\n  }\n\n}\n\n#Create VPC in us-west-2\nresource \"aws_vpc\" \"vpc_master_oregon\" {\n  provider             = aws.region-worker\n  cidr_block           = \"192.168.0.0/16\"\n  enable_dns_support   = true\n  enable_dns_hostnames = true\n  tags = {\n    Name = \"worker-vpc-jenkins\"\n  }\n\n}\n\n#Initiate Peering connection request from us-east-1\nresource \"aws_vpc_peering_connection\" \"uswest1-uswest2\" {\n  provider    = aws.region-master\n  peer_vpc_id = aws_vpc.vpc_master_oregon.id\n  vpc_id      = aws_vpc.vpc_master.id\n  #auto_accept = true\n  peer_region = var.region-worker\n\n}\n\n#Create IGW in us-east-1\nresource \"aws_internet_gateway\" \"igw\" {\n  provider = aws.region-master\n  vpc_id   = aws_vpc.vpc_master.id\n}\n\n#Create IGW in us-west-2\nresource \"aws_internet_gateway\" \"igw-oregon\" {\n  provider = aws.region-worker\n  vpc_id   = aws_vpc.vpc_master_oregon.id\n}\n\n#Accept VPC peering request in us-west-2 from us-east-1\nresource \"aws_vpc_peering_connection_accepter\" \"accept_peering\" {\n  provider                  = aws.region-worker\n  vpc_peering_connection_id = aws_vpc_peering_connection.uswest1-uswest2.id\n  auto_accept               = true\n}\n\n#Create route table in us-east-1\nresource \"aws_route_table\" \"internet_route\" {\n  provider = aws.region-master\n  vpc_id   = aws_vpc.vpc_master.id\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.igw.id\n  }\n  route {\n    cidr_block                = \"192.168.1.0/24\"\n    vpc_peering_connection_id = aws_vpc_peering_connection.uswest1-uswest2.id\n  }\n  lifecycle {\n    ignore_changes = all\n  }\n  tags = {\n    Name = \"Master-Region-RT\"\n  }\n}\n\n#Overwrite default route table of VPC(Master) with our route table entries\nresource \"aws_main_route_table_association\" \"set-master-default-rt-assoc\" {\n  provider       = aws.region-master\n  vpc_id         = aws_vpc.vpc_master.id\n  route_table_id = aws_route_table.internet_route.id\n}\n#Get all available AZ's in VPC for master region\ndata \"aws_availability_zones\" \"azs\" {\n  provider = aws.region-master\n  state    = \"available\"\n}\n\n#Create subnet # 1 in us-east-1\nresource \"aws_subnet\" \"subnet_1\" {\n  provider          = aws.region-master\n  availability_zone = element(data.aws_availability_zones.azs.names, 0)\n  vpc_id            = aws_vpc.vpc_master.id\n  cidr_block        = \"10.0.1.0/24\"\n}\n\n#Create subnet #2  in us-east-1\nresource \"aws_subnet\" \"subnet_2\" {\n  provider          = aws.region-master\n  vpc_id            = aws_vpc.vpc_master.id\n  availability_zone = element(data.aws_availability_zones.azs.names, 1)\n  cidr_block        = \"10.0.2.0/24\"\n}\n\n\n#Create subnet in us-west-2\nresource \"aws_subnet\" \"subnet_1_oregon\" {\n  provider   = aws.region-worker\n  vpc_id     = aws_vpc.vpc_master_oregon.id\n  cidr_block = \"192.168.1.0/24\"\n}\n\n#Create route table in us-west-2\nresource \"aws_route_table\" \"internet_route_oregon\" {\n  provider = aws.region-worker\n  vpc_id   = aws_vpc.vpc_master_oregon.id\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.igw-oregon.id\n  }\n  route {\n    cidr_block                = \"10.0.1.0/24\"\n    vpc_peering_connection_id = aws_vpc_peering_connection.uswest1-uswest2.id\n  }\n  lifecycle {\n    ignore_changes = all\n  }\n  tags = {\n    Name = \"Worker-Region-RT\"\n  }\n}\n\n#Overwrite default route table of VPC(Worker) with our route table entries\nresource \"aws_main_route_table_association\" \"set-worker-default-rt-assoc\" {\n  provider       = aws.region-worker\n  vpc_id         = aws_vpc.vpc_master_oregon.id\n  route_table_id = aws_route_table.internet_route_oregon.id\n}\n\n\n#Create SG for allowing TCP/8080 from * and TCP/22 from your IP in us-east-1\nresource \"aws_security_group\" \"jenkins-sg\" {\n  provider    = aws.region-master\n  name        = \"jenkins-sg\"\n  description = \"Allow TCP/8080 & TCP/22\"\n  vpc_id      = aws_vpc.vpc_master.id\n  ingress {\n    description = \"Allow 22 from our public IP\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [var.external_ip]\n  }\n  ingress {\n    description     = \"allow traffic from LB on port 8080\"\n    from_port       = 8080\n    to_port         = 8080\n    protocol        = \"tcp\"\n    security_groups = [aws_security_group.lb-sg.id]\n  }\n  ingress {\n    description = \"allow traffic from us-west-2\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"192.168.1.0/24\"]\n  }\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\n#Create SG for LB, only TCP/80,TCP/443 and outgoing access\nresource \"aws_security_group\" \"lb-sg\" {\n  provider    = aws.region-master\n  name        = \"lb-sg\"\n  description = \"Allow 443 and traffic to Jenkins SG\"\n  vpc_id      = aws_vpc.vpc_master.id\n  ingress {\n    description = \"Allow 443 from anywhere\"\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  ingress {\n    description = \"Allow 80 from anywhere for redirection\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\n#Create SG for allowing TCP/22 from your IP in us-west-2\nresource \"aws_security_group\" \"jenkins-sg-oregon\" {\n  provider = aws.region-worker\n\n  name        = \"jenkins-sg-oregon\"\n  description = \"Allow TCP/8080 & TCP/22\"\n  vpc_id      = aws_vpc.vpc_master_oregon.id\n  ingress {\n    description = \"Allow 22 from our public IP\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [var.external_ip]\n  }\n  ingress {\n    description = \"Allow traffic from us-east-1\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"10.0.1.0/24\"]\n  }\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 139}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 139}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 174}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 174}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 174}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 202}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 202}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 139}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 174}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 202}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV2_AWS_44", "severity": "CRITICAL", "message": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 55}, {"tool": "checkov", "rule_id": "CKV2_AWS_44", "severity": "CRITICAL", "message": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linuxacademy__content-deploying-to-aws-ansible-terraform__aws_la_cloudplayground_multiple_workers_version__network_setup.tf", "start_line": 111}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_cloudformation_stack\" \"network\" {\n  capabilities = [\"CAPABILITY_IAM\"]\n  disable_rollback = true\n  name = \"foobarbaz\"\n  parameters = {\n    foo = \"bar\"\n    bar = \"baz\"\n    baz = \"qux\"\n  }\n  tags = {\n    foo = \"bar\"\n    baz = \"qux\"\n    \"foo:bar\" = \"baz\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/humanmade__cf-to-tf__tests__fixtures__example-clean.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_124", "severity": "HIGH", "message": "Ensure that CloudFormation stacks are sending event notifications to an SNS topic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/humanmade__cf-to-tf__tests__fixtures__example-clean.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__modules__storage__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Note: all resources are created inside a NSX-T VDC\n\ndata \"vcd_nsxt_edgegateway\" \"existing\" {\n  org  = \"datacloud\"\n  vdc  = \"nsxt-vdc-datacloud\"\n  name = \"nsxt-gw-datacloud\"\n}\n\nresource \"vcd_network_routed_v2\" \"net_r_v2\" {\n  name            = \"net_r_v2\"\n  org             = \"datacloud\"\n  vdc             = \"nsxt-vdc-datacloud\"\n  edge_gateway_id = data.vcd_nsxt_edgegateway.existing.id\n  gateway         = \"10.10.102.1\"\n  prefix_length   = 24\n\n  static_ip_pool {\n    start_address = \"10.10.102.2\"\n    end_address   = \"10.10.102.200\"\n  }\n}\n\nresource \"vcd_network_isolated_v2\" \"net_i_v2\" {\n  name = \"net_i_v2\"\n  org  = \"datacloud\"\n  vdc  = \"nsxt-vdc-datacloud\"\n\n  gateway       = \"110.10.102.1\"\n  prefix_length = 26\n\n  static_ip_pool {\n    start_address = \"110.10.102.2\"\n    end_address   = \"110.10.102.20\"\n  }\n}\n\nresource \"vcd_nsxt_network_dhcp\" \"net_r_dhcp\" {\n  org = \"datacloud\"\n  vdc = \"nsxt-vdc-datacloud\"\n\n  org_network_id = vcd_network_routed_v2.net_r_v2.id\n\n  pool {\n    start_address = \"10.10.102.210\"\n    end_address   = \"10.10.102.220\"\n  }\n\n  pool {\n    start_address = \"10.10.102.230\"\n    end_address   = \"10.10.102.240\"\n  }\n}\n\nresource \"vcd_nsxt_network_imported\" \"imported-test\" {\n  name          = \"imported-test\"\n  org           = \"datacloud\"\n  vdc           = \"nsxt-vdc-datacloud\"\n  gateway       = \"12.12.2.1\"\n  prefix_length = 24\n\n  nsxt_logical_switch_name = \"segment-datacloud\"\n\n  static_ip_pool {\n    start_address = \"12.12.2.10\"\n    end_address   = \"12.12.2.15\"\n  }\n}\n\nresource \"vcd_vm\" \"standaloneVm\" {\n  org           = \"datacloud\"\n  vdc           = \"nsxt-vdc-datacloud\"\n  name          = \"standaloneVm\"\n  computer_name = \"standaloneVm-unique\"\n  catalog_name  = \"cat-datacloud\"\n  template_name = \"photon-hw11\"\n  description   = \"test standalone VM\"\n  memory        = 1024\n  cpus          = 2\n  cpu_cores     = 1\n\n  network_dhcp_wait_seconds = 10\n\n  network {\n    type               = \"org\"\n    name               = vcd_network_routed_v2.net_r_v2.name\n    ip_allocation_mode = \"MANUAL\"\n    ip                 = \"10.10.102.161\"\n  }\n\n  network {\n    type               = \"org\"\n    name               = vcd_network_routed_v2.net_r_v2.name\n    ip_allocation_mode = \"DHCP\"\n  }\n\n  network {\n    type               = \"org\"\n    name               = vcd_network_routed_v2.net_r_v2.name\n    ip_allocation_mode = \"POOL\"\n  }\n\n  network {\n    type               = \"org\"\n    name               = vcd_network_isolated_v2.net_i_v2.name\n    ip_allocation_mode = \"POOL\"\n  }\n\n  network {\n    type               = \"org\"\n    name               = vcd_nsxt_network_imported.imported-test.name\n    ip_allocation_mode = \"POOL\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vmware__terraform-provider-vcd__examples__nsxt-resources__3.2-sample.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"netbox_interface\" \"myvm_eth0\" {\n  name_regex = \"eth0\"\n  filter {\n    name  = \"name\"\n    value = \"myvm\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/e-breuninger__terraform-provider-netbox__examples__data-sources__netbox_interfaces__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"remote\" {\n    organization = \"glich-stream\"\n\n    workspaces {\n      name = \"ci-cd-production\"\n    }\n  }\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 3.48\"\n    }\n  }\n\n  required_version = \">= 0.15.0\"\n}\n\nprovider \"aws\" {\n  profile = \"default\"\n  region  = \"eu-west-1\"\n}\n\nvariable \"production_public_key\" {\n  description = \"Production environment public key value\"\n  type        = string\n}\n\nvariable \"base_ami_id\" {\n  description = \"Base AMI ID\"\n  type        = string\n}\n\nresource \"aws_key_pair\" \"production_key\" {\n  key_name   = \"production-key\"\n  public_key = var.production_public_key\n\n  tags = {\n    \"Name\" = \"production_public_key\"\n  }\n}\n\nresource \"aws_instance\" \"production_cicd_demo\" {\n  ami                    = var.base_ami_id\n  instance_type          = \"t2.micro\"\n  vpc_security_group_ids = [\"sg-0d2411db69a112a30\"]\n  key_name               = aws_key_pair.production_key.key_name\n\n  tags = {\n    \"Name\" = \"production_cicd_demo\"\n  }\n}\n\noutput \"production_dns\" {\n  value = aws_instance.production_cicd_demo.public_dns\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__production__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__production__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__production__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__production__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__production__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__production__main.tf", "start_line": 44}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AdminTurnedDevOps__Terraform-The-Hard-Way__Modules__s3-bucket__terraform.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"virtualbox_vm\" \"node\" {\n  count     = 2\n  name      = format(\"node-%02d\", count.index + 1)\n  image     = \"https://app.vagrantup.com/ubuntu/boxes/bionic64/versions/20180903.0.0/providers/virtualbox.box\"\n  cpus      = 2\n  memory    = \"512 mib\"\n\n  network_adapter {\n    type           = \"hostonly\"\n    host_interface = \"vboxnet1\"\n  }\n}\n\noutput \"IPAddr\" {\n  value = element(virtualbox_vm.node.*.network_adapter.0.ipv4_address, 1)\n}\n\noutput \"IPAddr_2\" {\n  value = element(virtualbox_vm.node.*.network_adapter.0.ipv4_address, 2)\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terra-farm__terraform-provider-virtualbox__examples__example.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2022 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nterraform {\n  required_version = \">= 0.13\"\n  required_providers {\n\n    google = {\n      source  = \"hashicorp/google\"\n      version = \">= 4.3.0\"\n    }\n\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__vertex-pipelines-end-to-end-samples__terraform__modules__cloudfunction__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"google\" {\n  region = \"${var.region}\"\n}\n\ndata \"google_project\" \"current\" {}\n\ndata \"google_compute_default_service_account\" \"default\" {}\n\nresource \"google_compute_network\" \"default\" {\n  name                    = \"${var.network_name}\"\n  auto_create_subnetworks = false\n}\n\nresource \"google_compute_subnetwork\" \"default\" {\n  name                     = \"${var.network_name}\"\n  ip_cidr_range            = \"${var.network_cidr}\"\n  network                  = \"${google_compute_network.default.self_link}\"\n  region                   = \"${var.region}\"\n  private_ip_google_access = true\n}\n\nresource \"google_compute_instance\" \"default\" {\n  count                     = \"${var.num_nodes}\"\n  name                      = \"${var.name}-${count.index + 1}\"\n  zone                      = \"${var.zone}\"\n  tags                      = [\"${concat(list(\"${var.name}-ssh\", \"${var.name}\"), var.node_tags)}\"]\n  machine_type              = \"${var.machine_type}\"\n  min_cpu_platform          = \"${var.min_cpu_platform}\"\n  allow_stopping_for_update = true\n\n  boot_disk {\n    auto_delete = \"${var.disk_auto_delete}\"\n\n    initialize_params {\n      image = \"${var.image_project}/${var.image_family}\"\n      size  = \"${var.disk_size_gb}\"\n      type  = \"${var.disk_type}\"\n    }\n  }\n\n  network_interface {\n    subnetwork    = \"${google_compute_subnetwork.default.name}\"\n    access_config = [\"${var.access_config}\"]\n    address       = \"${var.network_ip}\"\n  }\n\n  metadata = \"${merge(\n    map(\"startup-script\", \"${var.startup_script}\", \"tf_depends_id\", \"${var.depends_id}\"),\n    var.metadata\n  )}\"\n\n  service_account {\n    email  = \"${var.service_account_email == \"\" ? data.google_compute_default_service_account.default.email : var.service_account_email }\"\n    scopes = [\"${var.service_account_scopes}\"]\n  }\n}\n\nresource \"google_compute_firewall\" \"ssh\" {\n  name    = \"${var.name}-ssh\"\n  network = \"${google_compute_subnetwork.default.name}\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  source_tags = [\"${var.name}-bastion\"]\n  target_tags = [\"${var.name}-ssh\"]\n}\n\n// Bastion host\ndata \"google_compute_image\" \"bastion\" {\n  family  = \"${var.bastion_image_family}\"\n  project = \"${var.bastion_image_project == \"\" ? data.google_project.current.project_id : var.bastion_image_project}\"\n}\n\nmodule \"bastion\" {\n  source             = \"GoogleCloudPlatform/managed-instance-group/google\"\n  version            = \"1.1.14\"\n  region             = \"${var.region}\"\n  zone               = \"${var.zone}\"\n  network            = \"${google_compute_subnetwork.default.name}\"\n  subnetwork         = \"${google_compute_subnetwork.default.name}\"\n  target_tags        = [\"${var.name}-bastion\"]\n  machine_type       = \"${var.bastion_machine_type}\"\n  name               = \"${var.name}-bastion\"\n  compute_image      = \"${data.google_compute_image.bastion.self_link}\"\n  http_health_check  = false\n  service_port       = \"80\"\n  service_port_name  = \"http\"\n  wait_for_instances = true\n}\n\n// NAT gateway\nmodule \"nat-gateway\" {\n  source     = \"GoogleCloudPlatform/nat-gateway/google\"\n  version    = \"1.2.0\"\n  region     = \"${var.region}\"\n  zone       = \"${var.zone}\"\n  network    = \"${google_compute_subnetwork.default.name}\"\n  subnetwork = \"${google_compute_subnetwork.default.name}\"\n  tags       = [\"${var.name}\"]\n}\n\noutput \"bastion_instance\" {\n  value = \"${element(module.bastion.instances[0], 0)}\"\n}\n\noutput \"bastion\" {\n  value = \"gcloud compute ssh --ssh-flag=\\\"-A\\\" $(terraform output bastion_instance)\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-custom-machine-types__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-custom-machine-types__main.tf", "start_line": 77}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-custom-machine-types__main.tf", "start_line": 95}, {"tool": "checkov", "rule_id": "CKV_GCP_26", "severity": "HIGH", "message": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-custom-machine-types__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-custom-machine-types__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-custom-machine-types__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-custom-machine-types__main.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV2_GCP_18", "severity": "CRITICAL", "message": "Ensure GCP network defines a firewall and does not use the default firewall", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraform-google-examples__example-custom-machine-types__main.tf", "start_line": 9}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"test_instance\" \"foo\" {\n    ami = \"bar\"\n}\n\nprovider \"test\" {\n    value = \"foo\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform__internal__backend__local__testdata__refresh-provider-config__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Terraform Block\nterraform {\n  required_version = \">= 0.15\"\n  required_providers {\n    azurerm = {\n      source = \"hashicorp/azurerm\"\n      version = \"1.44.0\"\n      #version = \">= 2.0\" \n    }\n    random = {\n      source = \"hashicorp/random\"\n      version = \">= 3.0\"\n    }\n  }\n}\n\n# Provider Block\nprovider \"azurerm\" {\n# features {}          \n}\n\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__08-Providers-Dependency-Lock-File__terraform-manifests__c1-versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"google\" {\n    credentials = \"${file(\"account.json\")}\"\n    project     = \"myproject\"\n    region      = \"us-central1\"\n}\n\ndata \"google_compute_image\" \"debian9\" {\n    family  = \"debian-9\"\n    project = \"debian-cloud\"\n}\n\nresource \"google_compute_instance\" \"myinstance\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {\n        initialize_params {\n            image = data.google_compute_image.debian9.self_link\n        }\n    }\n    network_interface {\n        network = \"default\"\n        access_config {\n            // Ephemeral IP\n        }\n    }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/starhawking__python-terrascript__docs__tutorials__data1.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/starhawking__python-terrascript__docs__tutorials__data1.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/starhawking__python-terrascript__docs__tutorials__data1.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/starhawking__python-terrascript__docs__tutorials__data1.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/starhawking__python-terrascript__docs__tutorials__data1.tf", "start_line": 12}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"deployment\" {\n  type        = string\n  description = \"Deployment name used to label the resources created.\"\n}\n\nvariable \"project_id\" {\n  type        = string\n  description = \"Project id used to create resources in that project.\"\n}\n\nprovider \"google\" {\n  project = var.project_id\n  region  = \"us-central1\"\n  zone    = \"us-central1-c\"\n}\n\nresource \"google_compute_firewall\" \"default\" {\n  name    = \"address-${var.deployment}\"\n  network = \"https://www.googleapis.com/compute/v1/projects/${var.project_id}/global/networks/default\"\n  source_ranges = [\"0.0.0.0/0\"]\n  deny {\n    protocol = \"tcp\"\n    ports    = [\"11234\", \"16180\"]\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__deploymentmanager-samples__google__resource-snippets__compute-v1__alternatives-firewall__tf__firewall.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region  = \"us-east-1\"\n  profile = \"cloudskiff\"\n}\n\nresource \"aws_cloudformation_stack\" \"foo\" {\n  name = \"foo-stack\"\n\n  parameters = {\n    VPCCidr = \"10.0.0.0/16\"\n  }\n\n  template_body = <<STACK\n{\n  \"Parameters\" : {\n    \"VPCCidr\" : {\n      \"Type\" : \"String\",\n      \"Default\" : \"10.0.0.0/16\",\n      \"Description\" : \"Enter the CIDR block for the VPC. Default is 10.0.0.0/16.\"\n    }\n  },\n  \"Resources\" : {\n    \"myVpc\": {\n      \"Type\" : \"AWS::EC2::VPC\",\n      \"Properties\" : {\n        \"CidrBlock\" : { \"Ref\" : \"VPCCidr\" },\n        \"Tags\" : [\n          {\"Key\": \"Name\", \"Value\": \"Primary_CF_VPC\"}\n        ]\n      }\n    }\n  }\n}\nSTACK\n}\n\nresource \"aws_cloudformation_stack\" \"bar\" {\n  name = \"bar-stack\"\n\n  capabilities = [ \"CAPABILITY_NAMED_IAM\" ]\n\n  template_body = file(\"./iam.yml\")\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_cloudformation_stack_multiple__terraform.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_124", "severity": "HIGH", "message": "Ensure that CloudFormation stacks are sending event notifications to an SNS topic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_cloudformation_stack_multiple__terraform.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_124", "severity": "HIGH", "message": "Ensure that CloudFormation stacks are sending event notifications to an SNS topic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_cloudformation_stack_multiple__terraform.tf", "start_line": 37}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"azurerm_key_vault\" \"k8s\" {\n  name                = var.key_vault_name\n  resource_group_name = var.key_vault_resource_group_name\n}\n\ndata \"azurerm_key_vault_secret\" \"ssh\" {\n  name      = \"sshpublic\"\n  key_vault_id = data.azurerm_key_vault.k8s.id\n}\n\ndata \"azurerm_key_vault_secret\" \"spid\" {\n  name      = \"aksspid\"\n  key_vault_id = data.azurerm_key_vault.k8s.id\n}\n\ndata \"azurerm_key_vault_secret\" \"spsecret\" {\n  name      = \"aksspsecret\"\n  key_vault_id = data.azurerm_key_vault.k8s.id\n}\n\ndata \"azurerm_key_vault_secret\" \"aadclient\" {\n  name      = \"aadClientAppId\"\n  key_vault_id = data.azurerm_key_vault.k8s.id\n}\n\ndata \"azurerm_key_vault_secret\" \"aadserver\" {\n  name      = \"aadServerAppId\"\n  key_vault_id = data.azurerm_key_vault.k8s.id\n}\n\ndata \"azurerm_key_vault_secret\" \"aadserversecret\" {\n  name      = \"aadServerAppSecret\"\n  key_vault_id = data.azurerm_key_vault.k8s.id\n}\n\ndata \"azurerm_key_vault_secret\" \"aadtenant\" {\n  name      = \"aadTenantId\"\n  key_vault_id = data.azurerm_key_vault.k8s.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/neumanndaniel__terraform__azure__aks-aad-custom-vnet__datasource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform{\nbackend \"s3\" {\nbucket = \"s3bucketName\" // s3 bucket name created from AWS console\nkey = \"terraform.tfstate\" // terraform state file\nregion = \"\" // provide s3 bucket region\n}\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/collabnix__terraform__beginners__aws__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nvariable \"region\" {\n  description = \"AWS region\"\n  type        = string\n  default     = \"us-east-2\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-provision-eks-cluster__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n##############################################################################\n# Terraform and Ansible - Better Together\n\nresource \"azurerm_resource_group\" \"terraform_ansible\" {\n  name     = \"${var.resource_group}\"\n  location = \"${var.location}\"\n}\n\nresource \"azurerm_virtual_network\" \"vnet\" {\n  name                = \"${var.virtual_network_name}\"\n  location            = \"${azurerm_resource_group.terraform_ansible.location}\"\n  address_space       = [\"${var.address_space}\"]\n  resource_group_name = \"${azurerm_resource_group.terraform_ansible.name}\"\n}\n\nresource \"azurerm_subnet\" \"subnet\" {\n  name                 = \"${var.prefix}subnet\"\n  virtual_network_name = \"${azurerm_virtual_network.vnet.name}\"\n  resource_group_name  = \"${azurerm_resource_group.terraform_ansible.name}\"\n  address_prefix       = \"${var.subnet_prefix}\"\n}\n\nresource \"azurerm_network_security_group\" \"tf-ansible-sg\" {\n  name                = \"${var.prefix}-sg\"\n  location            = \"${var.location}\"\n  resource_group_name = \"${azurerm_resource_group.terraform_ansible.name}\"\n\n  security_rule {\n    name                       = \"HTTP\"\n    priority                   = 100\n    direction                  = \"Inbound\"\n    access                     = \"Allow\"\n    protocol                   = \"Tcp\"\n    source_port_range          = \"*\"\n    destination_port_range     = \"80\"\n    source_address_prefix      = \"*\"\n    destination_address_prefix = \"*\"\n  }\n\n  security_rule {\n    name                       = \"SSH\"\n    priority                   = 101\n    direction                  = \"Inbound\"\n    access                     = \"Allow\"\n    protocol                   = \"Tcp\"\n    source_port_range          = \"*\"\n    destination_port_range     = \"22\"\n    source_address_prefix      = \"*\"\n    destination_address_prefix = \"*\"\n  }\n}\n\nresource \"azurerm_network_interface\" \"tf-ansible-nic\" {\n  name                      = \"${var.prefix}tf-ansible-nic\"\n  location                  = \"${var.location}\"\n  resource_group_name       = \"${azurerm_resource_group.terraform_ansible.name}\"\n  network_security_group_id = \"${azurerm_network_security_group.tf-ansible-sg.id}\"\n\n  ip_configuration {\n    name                          = \"${var.prefix}ipconfig\"\n    subnet_id                     = \"${azurerm_subnet.subnet.id}\"\n    private_ip_address_allocation = \"Dynamic\"\n    public_ip_address_id          = \"${azurerm_public_ip.tf-ansible-pip.id}\"\n  }\n}\n\nresource \"azurerm_public_ip\" \"tf-ansible-pip\" {\n  name                         = \"${var.prefix}-ip\"\n  location                     = \"${var.location}\"\n  resource_group_name          = \"${azurerm_resource_group.terraform_ansible.name}\"\n  public_ip_address_allocation = \"Dynamic\"\n  domain_name_label            = \"${var.hostname}\"\n}\n\nresource \"azurerm_virtual_machine\" \"site\" {\n  name                = \"${var.hostname}-site\"\n  location            = \"${var.location}\"\n  resource_group_name = \"${azurerm_resource_group.terraform_ansible.name}\"\n  vm_size             = \"${var.vm_size}\"\n\n  network_interface_ids         = [\"${azurerm_network_interface.tf-ansible-nic.id}\"]\n  delete_os_disk_on_termination = \"true\"\n\n  storage_image_reference {\n    publisher = \"${var.image_publisher}\"\n    offer     = \"${var.image_offer}\"\n    sku       = \"${var.image_sku}\"\n    version   = \"${var.image_version}\"\n  }\n\n  storage_os_disk {\n    name              = \"${var.hostname}-osdisk\"\n    managed_disk_type = \"Standard_LRS\"\n    caching           = \"ReadWrite\"\n    create_option     = \"FromImage\"\n  }\n\n  os_profile {\n    computer_name  = \"${var.hostname}\"\n    admin_username = \"${var.admin_username}\"\n    admin_password = \"${var.admin_password}\"\n  }\n\n  os_profile_linux_config {\n      disable_password_authentication = true\n      ssh_keys {\n          path     = \"/home/${var.admin_username}/.ssh/authorized_keys\"\n          key_data = \"${var.ssh_pubkey}\"\n      }\n  }\n\n  # This is to ensure SSH comes up before we run the local exec.\n  provisioner \"remote-exec\" { \n    inline = [\"echo 'Hello World'\"]\n\n    connection {\n      type = \"ssh\"\n      host = \"${azurerm_public_ip.tf-ansible-pip.fqdn}\"\n      user = \"${var.admin_username}\"\n      private_key = \"${var.ssh_key}\"\n    }\n  }\n\n  provisioner \"local-exec\" {\n    command = \"ansible-playbook -i ../ansible/inventory.yaml --private-key ${var.ssh_key_path} ../ansible/httpd.yml\"\n  }\n\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/scarolan__ansible-terraform__terraform_azure__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_160", "severity": "HIGH", "message": "Ensure that HTTP (port 80) access is restricted from the internet", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/scarolan__ansible-terraform__terraform_azure__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AZURE_10", "severity": "HIGH", "message": "Ensure that SSH access is restricted from the internet", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/scarolan__ansible-terraform__terraform_azure__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV2_AZURE_10", "severity": "CRITICAL", "message": "Ensure that Microsoft Antimalware is configured to automatically updates for Virtual Machines", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/scarolan__ansible-terraform__terraform_azure__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_AZURE_119", "severity": "HIGH", "message": "Ensure that Network Interfaces don't use public IPs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/scarolan__ansible-terraform__terraform_azure__main.tf", "start_line": 53}, {"tool": "checkov", "rule_id": "CKV2_AZURE_12", "severity": "CRITICAL", "message": "Ensure that virtual machines are backed up using Azure Backup", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/scarolan__ansible-terraform__terraform_azure__main.tf", "start_line": 75}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource Block\n# Create a resource group\nresource \"azurerm_resource_group\" \"myrg\" {\n  name = \"myrg-1\"\n  location = \"East US\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate-on-azure__06-Azure-Terraform-VsCode-Plugin__terraform-manifests__c2-resource-group.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#deployment\nresource \"kubernetes_deployment\" \"wp_deploy\" {\n    depends_on = [\n    aws_db_instance.rds_wp\n    ]\n  metadata {\n    name = \"wordpress\"\n    labels = {\n      app = \"wordpress\"\n    }\n  }\n  spec {\n    selector {\n      match_labels = {\n        app = \"wordpress\"\n      }\n    }\n    template {\n      metadata {\n        labels = {\n          app = \"wordpress\"\n        }\n      }\n      spec {\n        container {\n          image = \"wordpress\"\n          name  = \"wordpress-pod\"\n          env {\n            name = \"WORDPRESS_DB_HOST\"\n            value = aws_db_instance.rds_wp.endpoint\n            }\n          env {\n            name = \"WORDPRESS_DB_DATABASE\"\n            value = aws_db_instance.rds_wp.name \n            }\n          env {\n            name = \"WORDPRESS_DB_USER\"\n            value = aws_db_instance.rds_wp.username\n            }\n          env {\n            name = \"WORDPRESS_DB_PASSWORD\"\n            value = aws_db_instance.rds_wp.password\n          }\n          port {\n        container_port = 80\n          }\n        }\n      }\n    }\n  }\n}\n\n#service \nresource \"kubernetes_service\" \"wp_service\" {\n    depends_on = [\n    kubernetes_deployment.wp_deploy,\n  ]\n  metadata {\n    name = \"wp-service\"\n  }\n  spec {\n    selector = {\n      app = \"wordpress\"\n    }\n    port {\n      port = 80\n      target_port = 80\n      node_port = 31002\n    }\n\n    type = \"NodePort\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_K8S_30", "severity": "HIGH", "message": "Apply security context to your pods and containers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_11", "severity": "HIGH", "message": "CPU Limits should be set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_10", "severity": "HIGH", "message": "CPU requests should be set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_21", "severity": "HIGH", "message": "The default namespace should not be used", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_28", "severity": "HIGH", "message": "Minimize the admission of containers with the NET_RAW capability", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_43", "severity": "HIGH", "message": "Image should use digest", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_15", "severity": "HIGH", "message": "Image Pull Policy should be Always", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_14", "severity": "HIGH", "message": "Image Tag should be fixed - not latest or blank", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_8", "severity": "HIGH", "message": "Liveness Probe Should be Configured", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_12", "severity": "HIGH", "message": "Memory Limits should be set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_13", "severity": "HIGH", "message": "Memory requests should be set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_29", "severity": "HIGH", "message": "Apply security context to your pods, deployments and daemon_sets", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_9", "severity": "HIGH", "message": "Readiness Probe Should be Configured", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_K8S_21", "severity": "HIGH", "message": "The default namespace should not be used", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__wordpress.tf", "start_line": 54}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"eu-west-1\"\n\n  allowed_account_ids = var.allowed_account_ids\n}\n\nterraform {\n  backend \"s3\" {\n    key = \"medium-terraform/prod/terraform.tfstate\"\n    # ...\n  }\n}\n\nmodule \"network\" {\n  source = \"../modules/network\"\n\n  name = var.name\n\n  cidr = var.cidr\n  azs  = var.azs\n\n  public_subnets = var.public_subnets\n}\n\nmodule \"alb\" {\n  source = \"terraform-aws-modules/alb/aws\"\n  version = \"~> 6.0\"\n\n  #...\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices__examples__medium-terraform__prod__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices__examples__medium-terraform__prod__main.tf", "start_line": 25}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"ami_id\" {\n}\n\nvariable \"instance_type\" {\n}\n\nvariable \"subnet_id\" {\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/telugudevopsguru__terraform__Module 10 - Terraform Workspace__terraform workspace__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"ecs_cluster\" {\n  source = \"../modules/ecs/cluster\"\n\n  aws_region             = var.region\n  aws_vpc_id             = module.vpc.vpc_id\n  environment            = terraform.workspace\n  aws_private_subnet_ids = module.vpc.private_subnets\n  aws_public_subnet_ids  = module.vpc.public_subnets\n  log_retention          = var.log_retention\n  whitelist              = var.whitelist\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nerves-hub__terraform__app__ecs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nterraform {\n  required_version = \">= 0.12\"\n}\n\nprovider \"azurerm\" {\n   features {}\n}\n\nlocals {\n  common_app_settings = {\n    \"INSTRUMENTATIONKEY\" = azurerm_application_insights.appinsight-app.instrumentation_key\n  }\n}\n\nresource \"azurerm_resource_group\" \"rg-app\" {\n  name     = \"${var.resource_group_name}-${var.environment}\"\n  location = var.location\n  tags = {\n    ENV = var.environment\n  }\n}\n\n\ndata \"azurerm_app_service_plan\" \"myplan\" {\n  name                = \"app-service-plan\"\n  resource_group_name = \"rg-service_plan\"\n}\n\nresource \"azurerm_app_service\" \"app\" {\n  name                = \"${var.app_name}-${var.environment}\"\n  location            = azurerm_resource_group.rg-app.location\n  resource_group_name = azurerm_resource_group.rg-app.name\n  app_service_plan_id = data.azurerm_app_service_plan.myplan.id\n}\n\nresource \"azurerm_application_insights\" \"appinsight-app\" {\n  name                = \"${var.app_name}-${var.environment}\"\n  location            = azurerm_resource_group.rg-app.location\n  resource_group_name = azurerm_resource_group.rg-app.name\n  application_type    = \"web\"\n\n  tags = {\n    ENV = var.environment\n    CreatedBy = var.createdby\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_13", "severity": "HIGH", "message": "Ensure App Service Authentication is set on Azure App Service", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_17", "severity": "HIGH", "message": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_65", "severity": "HIGH", "message": "Ensure that App service enables detailed error messages", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_66", "severity": "HIGH", "message": "Ensure that App service enables failed request tracing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_78", "severity": "HIGH", "message": "Ensure FTP deployments are disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_63", "severity": "HIGH", "message": "Ensure that App service enables HTTP logging", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_18", "severity": "HIGH", "message": "Ensure that 'HTTP Version' is the latest if used to run the web app", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_14", "severity": "HIGH", "message": "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_16", "severity": "HIGH", "message": "Ensure that Register with Azure Active Directory is enabled on App Service", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_71", "severity": "HIGH", "message": "Ensure that Managed identity provider is enabled for app services", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_213", "severity": "HIGH", "message": "Ensure that App Service configures health check", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AZURE_88", "severity": "HIGH", "message": "Ensure that app services use Azure Files", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/PacktPublishing__Terraform-Cookbook__CHAP02__data__main.tf", "start_line": 30}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"cluster_id\" {\n  description = \"EKS cluster ID.\"\n  value       = module.eks.cluster_id\n}\n\noutput \"cluster_endpoint\" {\n  description = \"Endpoint for EKS control plane.\"\n  value       = module.eks.cluster_endpoint\n}\n\noutput \"cluster_security_group_id\" {\n  description = \"Security group ids attached to the cluster control plane.\"\n  value       = module.eks.cluster_security_group_id\n}\n\noutput \"region\" {\n  description = \"AWS region\"\n  value       = var.aws_region\n}\n\noutput \"oidc_provider_arn\" {\n  value = module.eks.oidc_provider_arn\n}\n\n#output \"zz_update_kubeconfig_command\" {\n  # value = \"aws eks update-kubeconfig --name \" + module.eks.cluster_id\n#  value = format(\"%s %s %s %s\", \"aws eks update-kubeconfig --name\", module.eks.cluster_id, \"--region\", var.aws_region)\n#}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-eks__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-2\"\n  alias  = \"useast2\"\n}\n\nprovider \"aws\" {\n  region = \"us-east-1\"\n  alias  = \"useast1\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techlanders__terraform__aws__multiple-providers__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    keycloak = {\n      source  = \"terraform.local/keycloak/keycloak\"\n      version = \">= 5.0.0\"\n    }\n  }\n}\n\nprovider \"keycloak\" {\n  client_id     = \"terraform\"\n  client_secret = \"884e0f95-0f42-4a63-9b1f-94274655669e\"\n  url           = \"http://localhost:8080\"\n  additional_headers = {\n    foo = \"bar\"\n  }\n}\n\nresource \"keycloak_realm\" \"test\" {\n  realm             = \"test\"\n  enabled           = true\n  display_name      = \"foo\"\n  display_name_html = \"<b>foo</b>\"\n\n  smtp_server {\n    host                  = \"mysmtphost.com\"\n    port                  = 25\n    from_display_name     = \"Tom\"\n    from                  = \"tom@myhost.com\"\n    reply_to_display_name = \"Tom\"\n    reply_to              = \"tom@myhost.com\"\n    ssl                   = true\n    starttls              = true\n    envelope_from         = \"nottom@myhost.com\"\n\n    auth {\n      username = \"tom\"\n      password = \"tom\"\n    }\n  }\n\n  account_theme        = \"base\"\n  access_code_lifespan = \"30m\"\n\n  internationalization {\n    supported_locales = [\n      \"en\",\n      \"de\",\n      \"es\",\n    ]\n\n    default_locale = \"en\"\n  }\n\n  security_defenses {\n    headers {\n      x_frame_options                     = \"DENY\"\n      content_security_policy             = \"frame-src 'self'; frame-ancestors 'self'; object-src 'none';\"\n      content_security_policy_report_only = \"\"\n      x_content_type_options              = \"nosniff\"\n      x_robots_tag                        = \"none\"\n      x_xss_protection                    = \"1; mode=block\"\n      strict_transport_security           = \"max-age=31536000; includeSubDomains\"\n    }\n\n    brute_force_detection {\n      permanent_lockout                = false\n      max_login_failures               = 31\n      wait_increment_seconds           = 61\n      quick_login_check_milli_seconds  = 1000\n      minimum_quick_login_wait_seconds = 120\n      max_failure_wait_seconds         = 900\n      failure_reset_time_seconds       = 43200\n    }\n  }\n\n  ssl_required    = \"external\"\n  password_policy = \"upperCase(1) and length(8) and forceExpiredPasswordChange(365) and notUsername\"\n\n  attributes = {\n    mycustomAttribute  = \"myCustomValue\"\n    userProfileEnabled = true\n  }\n\n  web_authn_policy {\n    relying_party_entity_name = \"Example\"\n    relying_party_id          = \"keycloak.example.com\"\n    signature_algorithms = [\n      \"ES256\",\n      \"RS256\"\n    ]\n  }\n\n  web_authn_passwordless_policy {\n    relying_party_entity_name = \"Example\"\n    relying_party_id          = \"keycloak.example.com\"\n    signature_algorithms = [\n      \"ES256\",\n      \"RS256\"\n    ]\n  }\n}\n\nresource \"keycloak_realm_localization\" \"test_translation\" {\n  realm_id = keycloak_realm.test.id\n  locale   = \"en\"\n  texts = {\n    \"test\" : \"translation\"\n  }\n}\n\nresource \"keycloak_required_action\" \"custom-terms-and-conditions\" {\n  realm_id       = keycloak_realm.test.realm\n  alias          = \"TERMS_AND_CONDITIONS\"\n  default_action = true\n  enabled        = true\n  name           = \"Custom Terms and Conditions\"\n}\n\nresource \"keycloak_required_action\" \"update-password\" {\n  realm_id       = keycloak_realm.test.realm\n  alias          = \"UPDATE_PASSWORD\"\n  default_action = true\n  enabled        = true\n  name           = \"Update Password\"\n\n  config = {\n    max_auth_age = \"600\"\n  }\n}\n\nresource \"keycloak_required_action\" \"custom-configured_totp\" {\n  realm_id       = keycloak_realm.test.realm\n  alias          = \"CONFIGURE_TOTP\"\n  default_action = true\n  enabled        = true\n  name           = \"Custom configure totp\"\n  priority       = keycloak_required_action.custom-terms-and-conditions.priority + 15\n}\n\nresource \"keycloak_required_action\" \"required_action\" {\n  realm_id = keycloak_realm.test.realm\n  alias    = \"webauthn-register\"\n  enabled  = true\n  name     = \"Webauthn Register\"\n}\n\nresource \"keycloak_group\" \"foo\" {\n  realm_id = keycloak_realm.test.id\n  name     = \"foo\"\n}\n\nresource \"keycloak_group\" \"nested_foo\" {\n  realm_id  = keycloak_realm.test.id\n  parent_id = keycloak_group.foo.id\n  name      = \"nested/\\\\-foo\"\n}\n\nresource \"keycloak_group\" \"bar\" {\n  realm_id = keycloak_realm.test.id\n  name     = \"bar\"\n}\n\nresource \"keycloak_user\" \"user\" {\n  realm_id = keycloak_realm.test.id\n  username = \"test-user\"\n\n  email      = \"test-user@fakedomain.com\"\n  first_name = \"Testy\"\n  last_name  = \"Tester\"\n}\n\nresource \"keycloak_user\" \"another_user\" {\n  realm_id = keycloak_realm.test.id\n  username = \"another-test-user\"\n\n  email      = \"another-test-user@fakedomain.com\"\n  first_name = \"Testy\"\n  last_name  = \"Tester\"\n}\n\nresource \"keycloak_user\" \"user_with_password\" {\n  realm_id = keycloak_realm.test.id\n  username = \"user-with-password\"\n\n  email      = \"user-with-password@fakedomain.com\"\n  first_name = \"Testy\"\n  last_name  = \"Tester\"\n\n  initial_password {\n    value     = \"My password\"\n    temporary = false\n  }\n}\n\nresource \"keycloak_group_memberships\" \"foo_members\" {\n  realm_id = keycloak_realm.test.id\n  group_id = keycloak_group.foo.id\n\n  members = [\n    keycloak_user.user.username,\n    keycloak_user.another_user.username,\n  ]\n}\n\nresource \"keycloak_group\" \"baz\" {\n  realm_id = keycloak_realm.test.id\n  name     = \"baz\"\n}\n\nresource \"keycloak_default_groups\" \"default\" {\n  realm_id = keycloak_realm.test.id\n  group_ids = [\n    keycloak_group.baz.id\n  ]\n}\n\nresource \"keycloak_openid_client\" \"test_client\" {\n  client_id   = \"test-openid-client\"\n  name        = \"test-openid-client\"\n  realm_id    = keycloak_realm.test.id\n  description = \"a test openid client\"\n\n  standard_flow_enabled    = true\n  service_accounts_enabled = true\n\n  access_type = \"CONFIDENTIAL\"\n\n  valid_redirect_uris = [\n    \"http://localhost:5555/callback\",\n  ]\n  valid_post_logout_redirect_uris = [\n    \"http://localhost:5555/post-logout\",\n    \"http://localhost:5555/post-logout3\",\n  ]\n\n  client_secret = \"secret\"\n\n  pkce_code_challenge_method = \"plain\"\n\n  login_theme = \"keycloak\"\n\n  backchannel_logout_url                     = \"http://localhost:3333/backchannel\"\n  backchannel_logout_session_required        = true\n  backchannel_logout_revoke_offline_sessions = true\n\n  extra_config = {\n    customAttribute = \"a test custom value\"\n  }\n}\n\nresource \"keycloak_openid_client_scope\" \"test_default_client_scope\" {\n  name     = \"test-default-client-scope\"\n  realm_id = keycloak_realm.test.id\n\n  description         = \"test\"\n  consent_screen_text = \"hello\"\n}\n\nresource \"keycloak_openid_client_scope\" \"test_optional_client_scope\" {\n  name     = \"test-optional-client-scope\"\n  realm_id = keycloak_realm.test.id\n\n  description         = \"test\"\n  consent_screen_text = \"hello\"\n}\n\nresource \"keycloak_openid_client_default_scopes\" \"default_client_scopes\" {\n  realm_id  = keycloak_realm.test.id\n  client_id = keycloak_openid_client.test_client.id\n\n  default_scopes = [\n    \"profile\",\n    \"email\",\n    \"roles\",\n    \"web-origins\",\n    keycloak_openid_client_scope.test_default_client_scope.name,\n  ]\n}\n\nresource \"keycloak_openid_client_optional_scopes\" \"optional_client_scopes\" {\n  realm_id  = keycloak_realm.test.id\n  client_id = keycloak_openid_client.test_client.id\n\n  optional_scopes = [\n    \"address\",\n    \"phone\",\n    \"offline_access\",\n    \"microprofile-jwt\",\n    keycloak_openid_client_scope.test_optional_client_scope.name,\n  ]\n}\n\nresource \"keycloak_ldap_user_federation\" \"openldap\" {\n  name     = \"openldap\"\n  realm_id = keycloak_realm.test.id\n\n  enabled        = true\n  import_enabled = false\n\n  username_ldap_attribute = \"cn\"\n  rdn_ldap_attribute      = \"cn\"\n  uuid_ldap_attribute     = \"entryDN\"\n\n  user_object_classes = [\n    \"simpleSecurityObject\",\n    \"organizationalRole\",\n  ]\n\n  connection_url  = \"ldap://openldap\"\n  users_dn        = \"dc=example,dc=org\"\n  bind_dn         = \"cn=admin,dc=example,dc=org\"\n  bind_credential = \"adminpassword\"\n\n  connection_timeout = \"5s\"\n  read_timeout       = \"10s\"\n\n  kerberos {\n    server_principal                         = \"HTTP/keycloak.local@FOO.LOCAL\"\n    use_kerberos_for_password_authentication = false\n    key_tab                                  = \"/etc/keycloak.keytab\"\n    kerberos_realm                           = \"FOO.LOCAL\"\n  }\n\n  cache {\n    policy = \"NO_CACHE\"\n  }\n}\n\n\nresource \"keycloak_ldap_user_federation\" \"openldap_no_default_mappers\" {\n  name     = \"openldap-no-default-mappers\"\n  realm_id = keycloak_realm.test.id\n\n  enabled        = true\n  import_enabled = false\n\n  username_ldap_attribute = \"cn\"\n  rdn_ldap_attribute      = \"cn\"\n  uuid_ldap_attribute     = \"entryDN\"\n\n  user_object_classes = [\n    \"simpleSecurityObject\",\n    \"organizationalRole\",\n  ]\n\n  connection_url  = \"ldap://openldap\"\n  users_dn        = \"dc=example,dc=org\"\n  bind_dn         = \"cn=admin,dc=example,dc=org\"\n  bind_credential = \"adminpassword\"\n\n  connection_timeout = \"5s\"\n  read_timeout       = \"10s\"\n\n  kerberos {\n    server_principal                         = \"HTTP/keycloak.local@FOO.LOCAL\"\n    use_kerberos_for_password_authentication = false\n    key_tab                                  = \"/etc/keycloak.keytab\"\n    kerberos_realm                           = \"FOO.LOCAL\"\n  }\n\n  cache {\n    policy = \"NO_CACHE\"\n  }\n\n  delete_default_mappers = true\n}\n\nresource \"keycloak_ldap_role_mapper\" \"ldap_role_mapper\" {\n  realm_id                = keycloak_realm.test.id\n  ldap_user_federation_id = keycloak_ldap_user_federation.openldap.id\n  name                    = \"role-mapper\"\n\n  ldap_roles_dn            = \"dc=example,dc=org\"\n  role_name_ldap_attribute = \"cn\"\n  role_object_classes = [\n    \"groupOfNames\"\n  ]\n  membership_attribute_type      = \"DN\"\n  membership_ldap_attribute      = \"member\"\n  membership_user_ldap_attribute = \"cn\"\n  user_roles_retrieve_strategy   = \"GET_ROLES_FROM_USER_MEMBEROF_ATTRIBUTE\"\n  memberof_ldap_attribute        = \"memberOf\"\n}\n\nresource \"keycloak_ldap_user_attribute_mapper\" \"description_attr_mapper\" {\n  name                    = \"description-mapper\"\n  realm_id                = keycloak_ldap_user_federation.openldap.realm_id\n  ldap_user_federation_id = keycloak_ldap_user_federation.openldap.id\n\n  user_model_attribute = \"description\"\n  ldap_attribute       = \"description\"\n\n  always_read_value_from_ldap = false\n}\n\nresource \"keycloak_ldap_user_attribute_mapper\" \"default_attr_mapper\" {\n  name                    = \"defaultval-mapper\"\n  realm_id                = keycloak_ldap_user_federation.openldap.realm_id\n  ldap_user_federation_id = keycloak_ldap_user_federation.openldap.id\n\n  user_model_attribute = \"defaultval\"\n  ldap_attribute       = \"defaultval\"\n\n  always_read_value_from_ldap = false\n  is_mandatory_in_ldap        = true\n  attribute_default_value     = \"testing\"\n}\n\nresource \"keycloak_ldap_group_mapper\" \"group_mapper\" {\n  name                    = \"group mapper\"\n  realm_id                = keycloak_ldap_user_federation.openldap.realm_id\n  ldap_user_federation_id = keycloak_ldap_user_federation.openldap.id\n\n  ldap_groups_dn            = \"dc=example,dc=org\"\n  group_name_ldap_attribute = \"cn\"\n\n  group_object_classes = [\n    \"groupOfNames\",\n  ]\n\n  membership_attribute_type      = \"DN\"\n  membership_ldap_attribute      = \"member\"\n  membership_user_ldap_attribute = \"cn\"\n  memberof_ldap_attribute        = \"memberOf\"\n}\n\nresource \"keycloak_ldap_msad_user_account_control_mapper\" \"msad_uac_mapper\" {\n  name                    = \"uac-mapper1\"\n  realm_id                = keycloak_ldap_user_federation.openldap.realm_id\n  ldap_user_federation_id = keycloak_ldap_user_federation.openldap.id\n}\n\nresource \"keycloak_ldap_msad_lds_user_account_control_mapper\" \"msad_lds_uac_mapper\" {\n  name                    = \"msad-lds-uac-mapper\"\n  realm_id                = keycloak_ldap_user_federation.openldap.realm_id\n  ldap_user_federation_id = keycloak_ldap_user_federation.openldap.id\n}\n\nresource \"keycloak_ldap_full_name_mapper\" \"full_name_mapper\" {\n  name                    = \"full-name-mapper\"\n  realm_id                = keycloak_ldap_user_federation.openldap.realm_id\n  ldap_user_federation_id = keycloak_ldap_user_federation.openldap.id\n\n  ldap_full_name_attribute = \"cn\"\n  read_only                = true\n}\n\nresource \"keycloak_ldap_custom_mapper\" \"custom_mapper\" {\n  name                    = \"custom-mapper\"\n  realm_id                = keycloak_ldap_user_federation.openldap.realm_id\n  ldap_user_federation_id = keycloak_ldap_user_federation.openldap.id\n\n  provider_id   = \"msad-user-account-control-mapper\"\n  provider_type = \"org.keycloak.storage.ldap.mappers.LDAPStorageMapper\"\n}\n\nresource \"keycloak_ldap_custom_mapper\" \"custom_mapper_with_config\" {\n  name                    = \"custom-mapper-with-config\"\n  realm_id                = keycloak_ldap_user_federation.openldap.realm_id\n  ldap_user_federation_id = keycloak_ldap_user_federation.openldap.id\n\n  provider_id   = \"user-attribute-ldap-mapper\"\n  provider_type = \"org.keycloak.storage.ldap.mappers.LDAPStorageMapper\"\n  config = {\n    \"user.model.attribute\" = \"username\"\n    \"ldap.attribute\"       = \"cn\"\n  }\n}\n\n\nresource \"keycloak_custom_user_federation\" \"custom\" {\n  name        = \"custom1\"\n  realm_id    = \"master\"\n  provider_id = \"custom\"\n\n  enabled = true\n}\n\nresource \"keycloak_openid_user_attribute_protocol_mapper\" \"map_user_attributes_client\" {\n  name           = \"tf-test-open-id-user-attribute-protocol-mapper-client\"\n  realm_id       = keycloak_realm.test.id\n  client_id      = keycloak_openid_client.test_client.id\n  user_attribute = \"description\"\n  claim_name     = \"description\"\n}\n\nresource \"keycloak_openid_user_attribute_protocol_mapper\" \"map_user_permissions_attributes_client\" {\n  name           = \"tf-test-open-id-user-multivalue-attribute-protocol-mapper-client\"\n  realm_id       = keycloak_realm.test.id\n  client_id      = keycloak_openid_client.test_client.id\n  user_attribute = \"permissions\"\n  claim_name     = \"permissions\"\n  multivalued    = true\n}\n\n\nresource \"keycloak_openid_user_attribute_protocol_mapper\" \"map_user_attributes_client_scope\" {\n  name            = \"tf-test-open-id-user-attribute-protocol-mapper-client-scope\"\n  realm_id        = keycloak_realm.test.id\n  client_scope_id = keycloak_openid_client_scope.test_default_client_scope.id\n  user_attribute  = \"foo2\"\n  claim_name      = \"bar2\"\n}\n\nresource \"keycloak_openid_group_membership_protocol_mapper\" \"map_group_memberships_client\" {\n  name       = \"tf-test-open-id-group-membership-protocol-mapper-client\"\n  realm_id   = keycloak_realm.test.id\n  client_id  = keycloak_openid_client.test_client.id\n  claim_name = \"bar\"\n}\n\nresource \"keycloak_openid_group_membership_protocol_mapper\" \"map_group_memberships_client_scope\" {\n  name            = \"tf-test-open-id-group-membership-protocol-mapper-client-scope\"\n  realm_id        = keycloak_realm.test.id\n  client_scope_id = keycloak_openid_client_scope.test_optional_client_scope.id\n  claim_name      = \"bar2\"\n}\n\nresource \"keycloak_openid_full_name_protocol_mapper\" \"map_full_names_client\" {\n  name      = \"tf-test-open-id-full-name-protocol-mapper-client\"\n  realm_id  = keycloak_realm.test.id\n  client_id = keycloak_openid_client.test_client.id\n}\n\nresource \"keycloak_openid_full_name_protocol_mapper\" \"map_full_names_client_scope\" {\n  name            = \"tf-test-open-id-full-name-protocol-mapper-client-scope\"\n  realm_id        = keycloak_realm.test.id\n  client_scope_id = keycloak_openid_client_scope.test_default_client_scope.id\n}\n\nresource \"keycloak_openid_user_property_protocol_mapper\" \"map_user_properties_client\" {\n  name          = \"tf-test-open-id-user-property-protocol-mapper-client\"\n  realm_id      = keycloak_realm.test.id\n  client_id     = keycloak_openid_client.test_client.id\n  user_property = \"foo\"\n  claim_name    = \"bar\"\n}\n\nresource \"keycloak_openid_user_property_protocol_mapper\" \"map_user_properties_client_scope\" {\n  name            = \"tf-test-open-id-user-property-protocol-mapper-client-scope\"\n  realm_id        = keycloak_realm.test.id\n  client_scope_id = keycloak_openid_client_scope.test_optional_client_scope.id\n  user_property   = \"foo2\"\n  claim_name      = \"bar2\"\n}\n\nresource \"keycloak_openid_hardcoded_claim_protocol_mapper\" \"hardcoded_claim_client\" {\n  name      = \"tf-test-open-id-hardcoded-claim-protocol-mapper-client\"\n  realm_id  = keycloak_realm.test.id\n  client_id = keycloak_openid_client.test_client.id\n\n  claim_name  = \"foo\"\n  claim_value = \"bar\"\n}\n\nresource \"keycloak_openid_hardcoded_claim_protocol_mapper\" \"hardcoded_claim_client_scope\" {\n  name            = \"tf-test-open-id-hardcoded-claim-protocol-mapper-client-scope\"\n  realm_id        = keycloak_realm.test.id\n  client_scope_id = keycloak_openid_client_scope.test_default_client_scope.id\n\n  claim_name  = \"foo\"\n  claim_value = \"bar\"\n}\n\nresource \"keycloak_openid_user_realm_role_protocol_mapper\" \"user_realm_role_client\" {\n  name      = \"tf-test-open-id-user-realm-role-claim-protocol-mapper-client\"\n  realm_id  = keycloak_realm.test.id\n  client_id = keycloak_openid_client.test_client.id\n\n  claim_name = \"foo\"\n}\n\nresource \"keycloak_openid_user_realm_role_protocol_mapper\" \"user_realm_role_client_scope\" {\n  name            = \"tf-test-open-id-user-realm-role-protocol-mapper-client-scope\"\n  realm_id        = keycloak_realm.test.id\n  client_scope_id = keycloak_openid_client_scope.test_default_client_scope.id\n\n  claim_name = \"foo\"\n}\n\nresource \"keycloak_openid_user_client_role_protocol_mapper\" \"user_client_role_client\" {\n  name      = \"tf-test-open-id-user-client-role-claim-protocol-mapper-client\"\n  realm_id  = keycloak_realm.test.id\n  client_id = keycloak_openid_client.test_client.id\n\n  claim_name  = \"foo\"\n  multivalued = false\n\n  client_id_for_role_mappings = keycloak_openid_client.bearer_only_client.client_id\n  client_role_prefix          = \"prefixValue\"\n\n  add_to_id_token     = true\n  add_to_access_token = false\n  add_to_userinfo     = false\n}\n\nresource \"keycloak_openid_user_client_role_protocol_mapper\" \"user_client_role_client_scope\" {\n  name            = \"tf-test-open-id-user-client-role-protocol-mapper-client-scope\"\n  realm_id        = keycloak_realm.test.id\n  client_scope_id = keycloak_openid_client_scope.test_default_client_scope.id\n\n  claim_name  = \"foo\"\n  multivalued = false\n\n  client_id_for_role_mappings = keycloak_openid_client.bearer_only_client.client_id\n  client_role_prefix          = \"prefixValue\"\n\n  add_to_id_token     = true\n  add_to_access_token = false\n  add_to_userinfo     = false\n}\n\nresource \"keycloak_openid_user_session_note_protocol_mapper\" \"user_session_note_client\" {\n  name      = \"tf-test-open-id-user-session-note-protocol-mapper-client\"\n  realm_id  = keycloak_realm.test.id\n  client_id = keycloak_openid_client.test_client.id\n\n  claim_name       = \"foo\"\n  claim_value_type = \"String\"\n  session_note     = \"bar\"\n\n  add_to_id_token     = true\n  add_to_access_token = false\n}\n\nresource \"keycloak_openid_user_session_note_protocol_mapper\" \"user_session_note_client_scope\" {\n  name            = \"tf-test-open-id-user-session-note-protocol-mapper-client-scope\"\n  realm_id        = keycloak_realm.test.id\n  client_scope_id = keycloak_openid_client_scope.test_default_client_scope.id\n\n  claim_name       = \"foo2\"\n  claim_value_type = \"String\"\n  session_note     = \"bar2\"\n\n  add_to_id_token     = true\n  add_to_access_token = false\n}\n\nresource \"keycloak_openid_client\" \"bearer_only_client\" {\n  client_id   = \"test-bearer-only-client\"\n  name        = \"test-bearer-only-client\"\n  realm_id    = keycloak_realm.test.id\n  description = \"a test openid client using bearer-only\"\n\n  access_type = \"BEARER-ONLY\"\n}\n\nresource \"keycloak_openid_audience_protocol_mapper\" \"audience_client_scope\" {\n  name            = \"tf-test-openid-audience-protocol-mapper-client-scope\"\n  realm_id        = keycloak_realm.test.id\n  client_scope_id = keycloak_openid_client_scope.test_default_client_scope.id\n\n  add_to_id_token     = true\n  add_to_access_token = false\n\n  included_client_audience = keycloak_openid_client.bearer_only_client.client_id\n}\n\nresource \"keycloak_openid_audience_protocol_mapper\" \"audience_client\" {\n  name      = \"tf-test-openid-audience-protocol-mapper-client\"\n  realm_id  = keycloak_realm.test.id\n  client_id = keycloak_openid_client.test_client.id\n\n  add_to_id_token     = false\n  add_to_access_token = true\n\n  included_custom_audience = \"foo\"\n}\n\nresource \"keycloak_saml_client\" \"saml_client\" {\n  realm_id  = keycloak_realm.test.id\n  client_id = \"test-saml-client\"\n  name      = \"test-saml-client\"\n\n  sign_documents          = false\n  sign_assertions         = true\n  include_authn_statement = true\n\n  signing_certificate = file(\"../provider/misc/saml-cert.pem\")\n  signing_private_key = file(\"../provider/misc/saml-key.pem\")\n}\n\nresource \"keycloak_saml_user_attribute_protocol_mapper\" \"saml_user_attribute_mapper\" {\n  realm_id  = keycloak_realm.test.id\n  client_id = keycloak_saml_client.saml_client.id\n  name      = \"test-saml-user-attribute-mapper\"\n\n  user_attribute             = \"user-attribute\"\n  friendly_name              = \"friendly-name\"\n  saml_attribute_name        = \"saml-attribute-name\"\n  saml_attribute_name_format = \"Unspecified\"\n}\n\nresource \"keycloak_saml_user_property_protocol_mapper\" \"saml_user_property_mapper\" {\n  realm_id  = keycloak_realm.test.id\n  client_id = keycloak_saml_client.saml_client.id\n  name      = \"test-saml-user-property-mapper\"\n\n  user_property              = \"email\"\n  saml_attribute_name        = \"email\"\n  saml_attribute_name_format = \"Unspecified\"\n}\n\nresource \"keycloak_oidc_identity_provider\" \"oidc\" {\n  realm             = keycloak_realm.test.id\n  alias             = \"oidc\"\n  authorization_url = \"https://example.com/auth\"\n  token_url         = \"https://example.com/token\"\n  client_id         = \"example_id\"\n  client_secret     = \"example_token\"\n  default_scopes    = \"openid random profile\"\n  sync_mode         = \"FORCE\"\n  gui_order         = 1\n}\n\nresource \"keycloak_oidc_google_identity_provider\" \"google\" {\n  realm                                   = keycloak_realm.test.id\n  client_id                               = \"myclientid.apps.googleusercontent.com\"\n  client_secret                           = \"myclientsecret\"\n  hosted_domain                           = \"mycompany.com\"\n  request_refresh_token                   = true\n  default_scopes                          = \"openid random profile\"\n  accepts_prompt_none_forward_from_client = false\n  sync_mode                               = \"FORCE\"\n  gui_order                               = 2\n}\n\n//This example does not work in keycloak 10, because the interfaces that our customIdp implements, have changed in the keycloak latest version.\n//We need to make decide which keycloak version we going to support and test for the customIdp\n//resource keycloak_oidc_identity_provider custom_oidc_idp {\n//  realm             = \"${keycloak_realm.test.id}\"\n//  provider_id       = \"customIdp\"\n//  alias             = \"custom\"\n//  authorization_url = \"https://example.com/auth\"\n//  token_url         = \"https://example.com/token\"\n//  client_id         = \"example_id\"\n//  client_secret     = \"example_token\"\n//\n//  extra_config = {\n//    dummyConfig = \"dummyValue\"\n//  }\n//}\n\nresource \"keycloak_attribute_importer_identity_provider_mapper\" \"oidc\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"attributeImporter\"\n  claim_name              = \"upn\"\n  identity_provider_alias = keycloak_oidc_identity_provider.oidc.alias\n  user_attribute          = \"email\"\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_attribute_to_role_identity_provider_mapper\" \"oidc\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"attributeToRole\"\n  claim_name              = \"upn\"\n  identity_provider_alias = keycloak_oidc_identity_provider.oidc.alias\n  claim_value             = \"value\"\n  role                    = \"testRole\"\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_user_template_importer_identity_provider_mapper\" \"oidc\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"userTemplate\"\n  identity_provider_alias = keycloak_oidc_identity_provider.oidc.alias\n  template                = \"$${ALIAS}/$${CLAIM.upn}\"\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_hardcoded_role_identity_provider_mapper\" \"oidc\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"hardcodedRole\"\n  identity_provider_alias = keycloak_oidc_identity_provider.oidc.alias\n  role                    = \"testrole\"\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_hardcoded_group_identity_provider_mapper\" \"oidc\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"hardcodedGroup\"\n  identity_provider_alias = keycloak_oidc_identity_provider.oidc.alias\n  group                   = \"testgroup\"\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_hardcoded_attribute_identity_provider_mapper\" \"oidc\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"hardcodedUserSessionAttribute\"\n  identity_provider_alias = keycloak_oidc_identity_provider.oidc.alias\n  attribute_name          = \"attribute\"\n  attribute_value         = \"value\"\n  user_session            = true\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_saml_identity_provider\" \"saml\" {\n  realm                      = keycloak_realm.test.id\n  alias                      = \"saml\"\n  entity_id                  = \"https://example.com/entity_id\"\n  single_sign_on_service_url = \"https://example.com/auth\"\n  sync_mode                  = \"FORCE\"\n  gui_order                  = 3\n}\n\nresource \"keycloak_attribute_importer_identity_provider_mapper\" \"saml\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"Attribute: email\"\n  attribute_name          = \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\"\n  identity_provider_alias = keycloak_saml_identity_provider.saml.alias\n  user_attribute          = \"email\"\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_attribute_to_role_identity_provider_mapper\" \"saml\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"attributeToRole\"\n  attribute_name          = \"upn\"\n  identity_provider_alias = keycloak_saml_identity_provider.saml.alias\n  attribute_value         = \"value\"\n  role                    = \"testRole\"\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_user_template_importer_identity_provider_mapper\" \"saml\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"userTemplate\"\n  identity_provider_alias = keycloak_saml_identity_provider.saml.alias\n  template                = \"$${ALIAS}/$${NAMEID}\"\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_hardcoded_role_identity_provider_mapper\" \"saml\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"hardcodedRole\"\n  identity_provider_alias = keycloak_saml_identity_provider.saml.alias\n  role                    = \"testrole\"\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_hardcoded_group_identity_provider_mapper\" \"saml\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"hardcodedGroup\"\n  identity_provider_alias = keycloak_saml_identity_provider.saml.alias\n  group                   = \"testgroup\"\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_hardcoded_attribute_identity_provider_mapper\" \"saml\" {\n  realm                   = keycloak_realm.test.id\n  name                    = \"hardcodedAttribute\"\n  identity_provider_alias = keycloak_saml_identity_provider.saml.alias\n  attribute_name          = \"attribute\"\n  attribute_value         = \"value\"\n  user_session            = false\n\n  #KC10 support\n  extra_config = {\n    syncMode = \"INHERIT\"\n  }\n}\n\nresource \"keycloak_saml_identity_provider\" \"saml_custom\" {\n  realm                      = keycloak_realm.test.id\n  alias                      = \"custom_saml\"\n  provider_id                = \"saml\"\n  entity_id                  = \"https://example.com/entity_id\"\n  single_sign_on_service_url = \"https://example.com/auth\"\n  sync_mode                  = \"FORCE\"\n  gui_order                  = 4\n  extra_config = {\n    mycustomAttribute = \"aValue\"\n  }\n}\n\ndata \"keycloak_openid_client\" \"broker\" {\n  realm_id  = keycloak_realm.test.id\n  client_id = \"broker\"\n}\n\ndata \"keycloak_openid_client_authorization_policy\" \"default\" {\n  realm_id           = keycloak_realm.test.id\n  resource_server_id = keycloak_openid_client.test_client_auth.resource_server_id\n  name               = \"default\"\n}\n\nresource \"keycloak_openid_client\" \"test_client_auth\" {\n  client_id   = \"test-client-auth\"\n  name        = \"test-client-auth\"\n  realm_id    = keycloak_realm.test.id\n  description = \"a test openid client\"\n\n  access_type                  = \"CONFIDENTIAL\"\n  direct_access_grants_enabled = true\n  implicit_flow_enabled        = true\n  service_accounts_enabled     = true\n\n  valid_redirect_uris = [\n    \"http://localhost:5555/callback\",\n  ]\n\n  authorization {\n    policy_enforcement_mode = \"ENFORCING\"\n  }\n\n  client_secret = \"secret\"\n}\n\nresource \"keycloak_openid_client\" \"test_open_id_client_with_consent_text\" {\n  client_id   = \"test_open_id_client_with_consent_text\"\n  name        = \"test_open_id_client_with_consent_text\"\n  realm_id    = keycloak_realm.test.id\n  description = \"a test openid client that has consent text\"\n\n  standard_flow_enabled    = true\n  service_accounts_enabled = true\n\n  access_type = \"CONFIDENTIAL\"\n\n  valid_redirect_uris = [\n    \"http://localhost:5555/callback\",\n  ]\n\n  client_secret = \"secret\"\n\n  pkce_code_challenge_method = \"plain\"\n\n  login_theme = \"keycloak\"\n\n  backchannel_logout_url                     = \"http://localhost:3333/backchannel\"\n  backchannel_logout_session_required        = true\n  backchannel_logout_revoke_offline_sessions = true\n\n  extra_config = {\n    customAttribute = \"a test custom value\"\n  }\n\n  consent_required          = true\n  display_on_consent_screen = true\n  consent_screen_text       = \"some consent screen text\"\n}\n\n\nresource \"keycloak_openid_client_authorization_permission\" \"resource\" {\n  resource_server_id = keycloak_openid_client.test_client_auth.resource_server_id\n  realm_id           = keycloak_realm.test.id\n  name               = \"test\"\n\n  policies = [\n    data.keycloak_openid_client_authorization_policy.default.id,\n  ]\n\n  resources = [\n    keycloak_openid_client_authorization_resource.resource.id,\n  ]\n\n  scopes = [\n    keycloak_openid_client_authorization_scope.resource.id\n  ]\n}\n\nresource \"keycloak_openid_client_authorization_resource\" \"resource\" {\n  resource_server_id = keycloak_openid_client.test_client_auth.resource_server_id\n  name               = \"test-openid-client1\"\n  realm_id           = keycloak_realm.test.id\n\n  uris = [\n    \"/endpoint/*\",\n  ]\n\n  attributes = {\n    \"asdads\" = \"asdasd\"\n  }\n}\n\nresource \"keycloak_openid_client_authorization_scope\" \"resource\" {\n  resource_server_id = keycloak_openid_client.test_client_auth.resource_server_id\n  name               = \"test-openid-client1\"\n  realm_id           = keycloak_realm.test.id\n}\n\nresource \"keycloak_user\" \"user_with_multivalueattributes\" {\n  realm_id = keycloak_realm.test.id\n  username = \"user-with-mutivalueattributes\"\n\n  attributes = {\n    \"permissions\" = \"permission1##permission2\"\n  }\n  initial_password {\n    value     = \"My password\"\n    temporary = false\n  }\n}\n\nresource \"keycloak_user\" \"resource\" {\n  realm_id = keycloak_realm.test.id\n  username = \"test\"\n\n  attributes = {\n    \"key\" = \"value\"\n  }\n}\n\nresource \"keycloak_openid_client_service_account_role\" \"read_token\" {\n  realm_id                = keycloak_realm.test.id\n  client_id               = data.keycloak_openid_client.broker.id\n  service_account_user_id = keycloak_openid_client.test_client_auth.service_account_user_id\n  role                    = \"read-token\"\n}\n\nresource \"keycloak_authentication_flow\" \"browser-copy-flow\" {\n  alias       = \"browserCopyFlow\"\n  realm_id    = keycloak_realm.test.id\n  description = \"browser based authentication\"\n}\n\nresource \"keycloak_authentication_execution\" \"browser-copy-cookie\" {\n  realm_id          = keycloak_realm.test.id\n  parent_flow_alias = keycloak_authentication_flow.browser-copy-flow.alias\n  authenticator     = \"auth-cookie\"\n  requirement       = \"ALTERNATIVE\"\n  priority          = 20\n}\n\nresource \"keycloak_authentication_execution\" \"browser-copy-kerberos\" {\n  realm_id          = keycloak_realm.test.id\n  parent_flow_alias = keycloak_authentication_flow.browser-copy-flow.alias\n  authenticator     = \"auth-spnego\"\n  requirement       = \"DISABLED\"\n  priority          = 10\n}\n\nresource \"keycloak_authentication_execution\" \"browser-copy-idp-redirect\" {\n  realm_id          = keycloak_realm.test.id\n  parent_flow_alias = keycloak_authentication_flow.browser-copy-flow.alias\n  authenticator     = \"identity-provider-redirector\"\n  requirement       = \"ALTERNATIVE\"\n  priority          = 30\n}\n\nresource \"keycloak_authentication_subflow\" \"browser-copy-flow-forms\" {\n  realm_id          = keycloak_realm.test.id\n  parent_flow_alias = keycloak_authentication_flow.browser-copy-flow.alias\n  alias             = \"browser-copy-flow-forms\"\n  requirement       = \"ALTERNATIVE\"\n  priority          = 40\n}\n\nresource \"keycloak_authentication_execution\" \"browser-copy-auth-username-password-form\" {\n  realm_id          = keycloak_realm.test.id\n  parent_flow_alias = keycloak_authentication_subflow.browser-copy-flow-forms.alias\n  authenticator     = \"auth-username-password-form\"\n  requirement       = \"REQUIRED\"\n  priority          = 50\n}\n\nresource \"keycloak_authentication_execution\" \"browser-copy-otp\" {\n  realm_id          = keycloak_realm.test.id\n  parent_flow_alias = keycloak_authentication_subflow.browser-copy-flow-forms.alias\n  authenticator     = \"auth-otp-form\"\n  requirement       = \"REQUIRED\"\n  priority          = 60\n}\n\nresource \"keycloak_authentication_execution_config\" \"config\" {\n  realm_id     = keycloak_realm.test.id\n  execution_id = keycloak_authentication_execution.browser-copy-idp-redirect.id\n  alias        = \"idp-XXX-config\"\n  config = {\n    defaultProvider = \"idp-XXX\"\n  }\n}\n\nresource \"keycloak_authentication_bindings\" \"test_bindings\" {\n  realm_id     = keycloak_realm.test.id\n  browser_flow = keycloak_authentication_flow.browser-copy-flow.alias\n}\n\nresource \"keycloak_openid_client\" \"client\" {\n  client_id   = \"my-override-flow-binding-client\"\n  realm_id    = keycloak_realm.test.id\n  access_type = \"PUBLIC\"\n  authentication_flow_binding_overrides {\n    browser_id = keycloak_authentication_flow.browser-copy-flow.id\n  }\n}\n\nresource \"keycloak_realm_user_profile\" \"userprofile\" {\n  realm_id = keycloak_realm.test.id\n\n  attribute {\n    name = \"username\"\n  }\n\n  attribute {\n    name = \"email\"\n  }\n\n  attribute {\n    name         = \"field1\"\n    display_name = \"Field 1\"\n    group        = \"group1\"\n\n    enabled_when_scope = [\"offline_access\"]\n\n    required_for_roles  = [\"user\"]\n    required_for_scopes = [\"offline_access\"]\n\n    permissions {\n      view = [\"admin\", \"user\"]\n      edit = [\"admin\", \"user\"]\n    }\n\n    validator {\n      name = \"person-name-prohibited-characters\"\n    }\n\n    validator {\n      name = \"pattern\"\n      config = {\n        pattern       = \"^[a-z]+$\"\n        error_message = \"Nope\"\n      }\n    }\n\n    annotations = {\n      foo = \"bar\"\n    }\n  }\n\n  attribute {\n    name = \"field2\"\n  }\n\n  group {\n    name                = \"group1\"\n    display_header      = \"Group 1\"\n    display_description = \"A first group\"\n\n    annotations = {\n      foo = \"bar\"\n    }\n  }\n\n  group {\n    name = \"group2\"\n  }\n}\n\nresource \"keycloak_realm_client_policy_profile\" \"profile\" {\n  name     = \"my-profile\"\n  realm_id = keycloak_realm.test.id\n  executor {\n    name = \"intent-client-bind-checker\"\n    configuration = {\n      auto-configure = true\n    }\n  }\n  executor {\n    name = \"secure-session\"\n  }\n}\n\nresource \"keycloak_realm_client_policy_profile_policy\" \"policy\" {\n  name        = \"my-profile-policy\"\n  realm_id    = keycloak_realm.test.id\n  description = \"Some desc\"\n  profiles = [\n    keycloak_realm_client_policy_profile.profile.name\n  ]\n\n  condition {\n    name = \"client-type\"\n    configuration = {\n      \"protocol\" = \"openid-connect\"\n    }\n  }\n\n  condition {\n    name = \"client-attributes\"\n    configuration = {\n      \"is-negative-logic\" = false\n      \"attributes\"        = jsonencode([{ \"key\" : \"something\", \"value\" : \"other3\" }])\n    }\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keycloak__terraform-provider-keycloak__example__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_SECRET_6", "severity": "CRITICAL", "message": "Base64 High Entropy String", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keycloak__terraform-provider-keycloak__example__main.tf", "start_line": 720}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"gsuite_user\" \"developer\" {\n\n  aliases = [\n    \"chase@sillevis.net\"\n  ]\n\n  name {\n    family_name = \"Sillevis\"\n    given_name  = \"Chase\"\n  }\n\n  # Note the following behaviors regarding passwords:\n  #\n  #   - When running `terraform import` on a user resource:\n  #     - The `password` and `hash_function` fields are ignored.\n  #   - When running `terraform apply` with a new user resource in your terraform state:\n  #     - If the user does not exist in GSuite the following applies:\n  #       - The `password` field should be set or a secured password will be automatically generated.\n  #       - The `hash_function` field must be set only if the `password` field contains a hashed value.\n  #       - The GSuite account will be configured to require password change on next login.\n  #     - If the user exists in GSuite the following applies:\n  #       - The `password` and `hash_function` fields will be ignored.\n  #   - When running `terraform apply` with an existing user resource:\n  #     - Empty `password` and `hash_function` fields will be ignored.\n  password = \"testtest123!\"\n\n  primary_email = \"developer@sillevis.net\"\n\n  ssh_public_keys {\n    key                  = \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDUYJKI2gGdZr5Brd1IaT8OQSSt81mBBXQnAfmmjw5hOK9VaJ1MmDB5qY7V1nuXftmLBLvaA7L6k21FDJeWxwD8vKuYwbuJyh1DKB6PMXAQxnX7uLSSi9a/ZOzh3gIHXdil0fSWFpFBmImznqbzaEb7nya+tnK4RONoEjJcRe8Tl+8hET/29XBd3oxlfwwjQA9A84iKhAMLdJIQ28z2GA/2mRJ8RkHLrkQL8kMCj4GJYxy3PR9JU0aFAtWh2mXGfOzaBTh/IhpMW53d8puxihBbIN87MoGngYLt4eBEdE0SiHb0Zdqp5ZDCkwNmAKiWOOrDQxtWvUOThHV5eLMMObqA06XFiwNlojl9ZTH0Y2w/LZmvgb98T/1lBY6mb1iRERGKqYNBeSNwh1Afvu1miDau2f5AYqcf7yxvuD8d0O4cb1xfl7WJwWPJraYaN1X+WmCGTIA+Vve+Kp9TaGoE5n5EGz2a7RNzWj0L0hkf8923iEEtTrsfWewnTnq7XzFoaW53xjWcN7jQplisjWr6AWYApyinw0qGD3dzKgPLyOOcdC3YLhYFpGJcMbegrNdmhbxqIXCB3vBpEFV6o4GqdEy2OVFOM6kSydEQUsMHl5WU8l4gYW28ekZZtbrE52v1dMNzKwfrpVPpUfwn4jbeaqYoIWEwFNVnvbJaFu1vjfrshw== chase\"\n    expiration_time_usec = \"1549735670773\"\n  }\n\n  #\n  # WARN: it is possible on-creation of a new account that the POSIX data is\n  # found to not be unique, and a 503 backend error is returned indefinitely.\n  # In that case, the account is created, but without the POSIX data. Simply\n  # update the POSIX data and terraform apply to update until it works.\n  #\n  # best to fill out all of these fields or face the consequences\n  # might get 503 backend errors if you try to change this too often/fast\n  posix_accounts {\n    home_directory = \"/home/chase\"\n    primary        = true\n    gid            = 1001\n    uid            = 1001\n    shell          = \"/bin/bash\"\n    system_id      = \"uid\"\n    username       = \"chase\"\n  }\n\n  external_ids {\n    type  = \"organization\"\n    value = \"1234\"\n  }\n\n  # If omitted or `true` existing GSuite users defined as Terraform resources will be imported by `terraform apply`.\n  update_existing = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeviaVir__terraform-provider-gsuite__examples__user__devteam.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Define Local Values in Terraform\nlocals {\n  owners = var.business_divsion\n  environment = var.environment\n  name = \"${var.business_divsion}-${var.environment}\"\n  #name = \"${local.owners}-${local.environment}\"\n  common_tags = {\n    owners = local.owners\n    environment = local.environment\n  }\n\n  asg_tags = [\n    {\n      key                 = \"Project\"\n      value               = \"megasecret\"\n      propagate_at_launch = true\n    },\n    {\n      key                 = \"foo\"\n      value               = \"\"\n      propagate_at_launch = true\n    },\n  ]\n\n} ", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-iacdevops-with-aws-codepipeline__terraform-manifests__c3-local-values.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"this\" {\n  ami           = var.ami\n  instance_type = var.instance_type\n  subnet_id     = var.subnet_id\n\n  tags = {\n    Name = var.instance_name\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ReyazShaik__terraform__modulesproject__modules__ec2-instances__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ReyazShaik__terraform__modulesproject__modules__ec2-instances__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ReyazShaik__terraform__modulesproject__modules__ec2-instances__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ReyazShaik__terraform__modulesproject__modules__ec2-instances__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ReyazShaik__terraform__modulesproject__modules__ec2-instances__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ReyazShaik__terraform__modulesproject__modules__ec2-instances__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"project\" {\n  description = \"Your GCP Project ID\"\n  type        = string\n}\n\nvariable \"region\" {\n  description = \"Your project region\"\n  default     = \"us-central1\"\n  type        = string\n}\n\nvariable \"zone\" {\n  description = \"Your project zone\"\n  default     = \"us-central1-a\"\n  type        = string\n}\n\nvariable \"storage_class\" {\n  description = \"Storage class type for your bucket\"\n  default     = \"STANDARD\"\n  type        = string\n}\n\nvariable \"vm_image\" {\n  description = \"Image for you VM\"\n  default     = \"ubuntu-os-cloud/ubuntu-2004-lts\"\n  type        = string\n}\n\nvariable \"network\" {\n  description = \"Network for your instance/cluster\"\n  default     = \"default\"\n  type        = string\n}\n\nvariable \"stg_bq_dataset\" {\n  description = \"Storage class type for your bucket. Check official docs for more info.\"\n  default     = \"streamify_stg\"\n  type        = string\n}\n\nvariable \"prod_bq_dataset\" {\n  description = \"Storage class type for your bucket. Check official docs for more info.\"\n  default     = \"streamify_prod\"\n  type        = string\n}\n\nvariable \"bucket\" {\n  description = \"The name of your bucket. This should be unique across GCP\"\n  type        = string\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ankurchavda__streamify__terraform__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ------------------------------------------------------------------------------------------------------------\n# CSE 4.1 TKGm cluster creation:\n#\n# * Please read the guide at https://registry.terraform.io/providers/vmware/vcd/latest/docs/guides/container_service_extension_4_x_cluster_management\n#   before applying this configuration.\n#\n# * Please make sure to have CSE v4.1 installed in your VCD appliance and the CSE Server is correctly running.\n#\n# * Please review this HCL configuration before applying, to change the settings to the ones that fit best with your organization.\n#\n# * Rename \"terraform.tfvars.example\" to \"terraform.tfvars\" and adapt the values to your needs.\n#   You can check the comments on each resource/data source for more help and context.\n# ------------------------------------------------------------------------------------------------------------\n\n# VCD Provider configuration. It must be at least v3.11.0.\nterraform {\n  required_providers {\n    vcd = {\n      source  = \"vmware/vcd\"\n      version = \">= 3.11\"\n    }\n  }\n}\n\n// Login as the CSE Cluster Author user created during installation.\nprovider \"vcd\" {\n  url                  = \"${var.vcd_url}/api\"\n  user                 = var.cluster_author_user\n  password             = var.cluster_author_password\n  auth_type            = \"integrated\"\n  org                  = var.cluster_organization\n  allow_unverified_ssl = var.insecure_login\n  logging              = true\n  logging_file         = \"cse_cluster_creation.log\"\n}\n\n# Creates an API Token for the CSE Cluster Author that will be used for cluster management.\nresource \"vcd_api_token\" \"cluster_author_token\" {\n  name             = \"CSE ${var.k8s_cluster_name} API Token\"\n  file_name        = var.cluster_author_token_file\n  allow_token_file = true\n}\ndata \"local_file\" \"cluster_author_token_file\" {\n  filename = vcd_api_token.cluster_author_token.file_name\n}\nlocals {\n  cluster_author_api_token = jsondecode(data.local_file.cluster_author_token_file.content)[\"refresh_token\"]\n}\n\n# Fetch the CSE Server configuration RDE Type to be able to fetch the RDE just below.\ndata \"vcd_rde_type\" \"vcdkeconfig_type\" {\n  vendor  = \"vmware\"\n  nss     = \"VCDKEConfig\"\n  version = \"1.1.0\"\n}\n\n# Fetch the CSE Server configuration to retrieve some required values during cluster creation, such as the\n# Machine Health Check values and the container registry URL.\ndata \"vcd_rde\" \"vcdkeconfig_instance\" {\n  org         = \"System\"\n  rde_type_id = data.vcd_rde_type.vcdkeconfig_type.id\n  name        = \"vcdKeConfig\"\n}\nlocals {\n  machine_health_check   = jsondecode(data.vcd_rde.vcdkeconfig_instance.entity)[\"profiles\"][0][\"K8Config\"][\"mhc\"]\n  container_registry_url = jsondecode(data.vcd_rde.vcdkeconfig_instance.entity)[\"profiles\"][0][\"containerRegistryUrl\"]\n}\n\n# Fetch the RDE Type corresponding to the CAPVCD clusters. This was created during CSE installation process.\ndata \"vcd_rde_type\" \"capvcdcluster_type\" {\n  vendor  = \"vmware\"\n  nss     = \"capvcdCluster\"\n  version = \"1.2.0\"\n}\n\n# This local corresponds to a completely rendered YAML template that can be used inside the RDE resource below.\nlocals {\n  capvcd_yaml_rendered = templatefile(\"./cluster-template-v1.25.7.yaml\", {\n    CLUSTER_NAME     = var.k8s_cluster_name\n    TARGET_NAMESPACE = \"${var.k8s_cluster_name}-ns\"\n\n    VCD_SITE                     = var.vcd_url\n    VCD_ORGANIZATION             = var.cluster_organization\n    VCD_ORGANIZATION_VDC         = var.cluster_vdc\n    VCD_ORGANIZATION_VDC_NETWORK = var.cluster_routed_network\n\n    VCD_USERNAME_B64      = base64encode(var.cluster_author_user)\n    VCD_PASSWORD_B64      = \"\" # We use an API token instead, which is highly recommended\n    VCD_REFRESH_TOKEN_B64 = base64encode(local.cluster_author_api_token)\n    SSH_PUBLIC_KEY        = var.ssh_public_key\n\n    CONTROL_PLANE_MACHINE_COUNT        = var.control_plane_machine_count\n    VCD_CONTROL_PLANE_SIZING_POLICY    = var.control_plane_sizing_policy\n    VCD_CONTROL_PLANE_PLACEMENT_POLICY = var.control_plane_placement_policy\n    VCD_CONTROL_PLANE_STORAGE_PROFILE  = var.control_plane_storage_profile\n\n    WORKER_MACHINE_COUNT        = var.worker_machine_count\n    VCD_WORKER_SIZING_POLICY    = var.worker_sizing_policy\n    VCD_WORKER_PLACEMENT_POLICY = var.worker_placement_policy\n    VCD_WORKER_STORAGE_PROFILE  = var.worker_storage_profile\n\n    DISK_SIZE         = var.disk_size\n    VCD_CATALOG       = var.tkgm_catalog\n    VCD_TEMPLATE_NAME = var.tkgm_ova_name\n\n    POD_CIDR     = var.pod_cidr\n    SERVICE_CIDR = var.service_cidr\n\n    # Extra required information. Please read the guide at\n    # https://registry.terraform.io/providers/vmware/vcd/latest/docs/guides/container_service_extension_4_x_cluster_management\n    # to know how to obtain these required parameters.\n    TKR_VERSION = var.tkr_version\n    TKGVERSION  = var.tkg_version\n\n    # These are picked from the VCDKEConfig RDE, so they should not be changed\n    MAX_UNHEALTHY_NODE_PERCENTAGE = local.machine_health_check[\"maxUnhealthyNodes\"]\n    NODE_STARTUP_TIMEOUT          = local.machine_health_check[\"nodeStartupTimeout\"]\n    NODE_NOT_READY_TIMEOUT        = local.machine_health_check[\"nodeNotReadyTimeout\"]\n    NODE_UNKNOWN_TIMEOUT          = local.machine_health_check[\"nodeUnknownTimeout\"]\n    CONTAINER_REGISTRY_URL        = local.container_registry_url\n  })\n}\n\n# This is the RDE that manages the TKGm cluster.\nresource \"vcd_rde\" \"k8s_cluster_instance\" {\n  name               = var.k8s_cluster_name\n  rde_type_id        = data.vcd_rde_type.capvcdcluster_type.id # This must reference the CAPVCD RDE Type\n  resolve            = false                                   # MUST be false as it is resolved by CSE Server\n  resolve_on_removal = true                                    # MUST be true as it won't be resolved by Terraform\n\n  # Read the RDE template present in this repository\n  input_entity = templatefile(\"../entities/tkgmcluster.json.template\", {\n    vcd_url = var.vcd_url\n    name    = var.k8s_cluster_name\n    org     = var.cluster_organization\n    vdc     = var.cluster_vdc\n\n    api_token = local.cluster_author_api_token\n\n    # Configures a default Storage class for the TKGm cluster. If you don't want this,\n    # you can remove the variables below. Don't forget to delete the 'defaultStorageClassOptions' block from\n    # ../entities/tkgmcluster-template.json\n    default_storage_class_filesystem            = var.default_storage_class_filesystem\n    default_storage_class_name                  = var.default_storage_class_name\n    default_storage_class_storage_profile       = var.default_storage_class_storage_profile\n    default_storage_class_delete_reclaim_policy = var.default_storage_class_delete_reclaim_policy\n\n    # Insert the rendered CAPVCD YAML here. Notice that we need to encode it to JSON.\n    capi_yaml = jsonencode(local.capvcd_yaml_rendered)\n\n    delete                = false # Make this true to delete the cluster\n    force_delete          = false # Make this true to forcefully delete the cluster\n    auto_repair_on_errors = var.auto_repair_on_errors\n  })\n\n  # Be careful, as updating \"input_entity\" will make the cluster unstable if not done correctly.\n  # CSE requires sending back the cluster status that is saved into the \"computed_entity\" attribute once it is created.\n  # Read more: https://registry.terraform.io/providers/vmware/vcd/latest/docs/guides/container_service_extension_4_x_cluster_management#updating-a-kubernetes-cluster\n  # You can remove this lifecycle constraint once the \"input_entity\" JSON contains the cluster status and other generated attributes that were not present\n  # in the initial payload.\n  lifecycle {\n    ignore_changes = [ input_entity ]\n  }\n}\n\n# Some useful outputs to monitor TKGm cluster creation process.\nlocals {\n  k8s_cluster_computed       = jsondecode(vcd_rde.k8s_cluster_instance.computed_entity)\n  being_deleted              = tobool(jsondecode(vcd_rde.k8s_cluster_instance.input_entity)[\"spec\"][\"vcdKe\"][\"markForDelete\"]) || tobool(jsondecode(vcd_rde.k8s_cluster_instance.input_entity)[\"spec\"][\"vcdKe\"][\"forceDelete\"])\n  has_status                 = lookup(local.k8s_cluster_computed, \"status\", null) != null\n}\n\noutput \"computed_k8s_cluster_status\" {\n  value = local.has_status && !local.being_deleted ? local.k8s_cluster_computed[\"status\"][\"vcdKe\"][\"state\"] : null\n}\n\noutput \"computed_k8s_cluster_events\" {\n  value = local.has_status && !local.being_deleted ? local.k8s_cluster_computed[\"status\"][\"vcdKe\"][\"eventSet\"] : null\n}\n\n# After the output \"computed_k8s_cluster_status\" is \"provisioned\" and the RDE is resolved, you can retrieve\n# the cluster's Kubeconfig with the following snippet. It is commented as the invocation of the Behavior that\n# retrieves the Kubeconfig requires the cluster to be created (the RDE to be resolved).\n/*\ndata \"vcd_rde_behavior_invocation\" \"get_kubeconfig\" {\n  rde_id      = vcd_rde.k8s_cluster_instance.id\n  behavior_id = \"urn:vcloud:behavior-interface:getFullEntity:cse:capvcd:1.0.0\"\n}\n\noutput \"kubeconfig\" {\n  value = jsondecode(data.vcd_rde_behavior_invocation.get_kubeconfig.result)[\"entity\"][\"status\"][\"capvcd\"][\"private\"][\"kubeConfig\"]\n}*/\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vmware__terraform-provider-vcd__examples__container-service-extension__v4.1__cluster__3.11-cluster-creation.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Define Local Values in Terraform\nlocals {\n  owners = var.business_divsion\n  environment = var.environment\n  resource_name_prefix = \"${var.business_divsion}-${var.environment}\"\n  #name = \"${local.owners}-${local.environment}\"\n  common_tags = {\n    owners = local.owners\n    environment = local.environment\n  }\n} ", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-azure-with-azure-devops__terraform-manifests__c3-locals.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_ami\" \"ubuntu\" {\n  most_recent = true\n  owners      = [\"099720109477\"] # Owner is Canonical\n\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-*-22.04-amd64-server-*\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n}\n\ndata \"aws_caller_identity\" \"current\" {}\n\ndata \"aws_region\" \"current\" {}\n\ndata \"aws_vpc\" \"prod_vpc\" {\n  tags = {\n    Env = \"Prod\"\n  }\n}\n\ndata \"aws_availability_zones\" \"available\" {\n  state = \"available\"\n}\n\ndata \"aws_iam_policy_document\" \"static_website\" {\n  statement {\n    sid = \"PublicReadGetObject\"\n\n    principals {\n      type        = \"*\"\n      identifiers = [\"*\"]\n    }\n\n    actions = [\"s3:GetObject\"]\n\n    resources = [\"arn:aws:s3:::*/*\"]\n  }\n}\n\nresource \"aws_s3_bucket\" \"public_read_bucket\" {\n  bucket = \"my-public-read-bucket\"\n}\n\noutput \"iam_policy\" {\n  value = data.aws_iam_policy_document.static_website.json\n}\n\noutput \"azs\" {\n  value = data.aws_availability_zones.available\n}\n\noutput \"prod_vpc_id\" {\n  value = data.aws_vpc.prod_vpc.id\n}\n\noutput \"ubuntu_ami_data\" {\n  value = data.aws_ami.ubuntu.id\n}\n\noutput \"aws_caller_identity\" {\n  value = data.aws_caller_identity.current\n}\n\noutput \"aws_region\" {\n  value = data.aws_region.current\n}\n\nresource \"aws_instance\" \"web\" {\n  # AMI ID NGINX  = ami-0dfee6e7eb44d480b\n  ami                         = data.aws_ami.ubuntu.id\n  associate_public_ip_address = true\n  instance_type               = \"t2.micro\"\n\n  root_block_device {\n    delete_on_termination = true\n    volume_size           = 10\n    volume_type           = \"gp3\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 73}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 73}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 73}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 73}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 73}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lm-academy__terraform-course__07-data-sources__compute.tf", "start_line": 45}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"linode_token\" {\n  description = \"Linode APIv4 Personal Access Token\"\n}\n\nvariable \"region\" {\n  description = \"The region to provision the resources in.\"\n  default = \"us-southeast\"\n}\n\nvariable \"public_ssh_key\" {\n  description = \"SSH Public Key Fingerprint\"\n  default     = \"~/.ssh/id_rsa.pub\"\n}\n\nvariable \"private_ssh_key\" {\n  description = \"SSH Public Key Fingerprint\"\n  default     = \"~/.ssh/id_rsa\"\n}\n\nvariable \"mysql_db\" {\n  description = \"The name of the default database to be created in the MySQL server.\"\n  default = \"cool-db\"\n  type = string\n}\n\nvariable \"mysql_user\" {\n  description = \"The name of the default user to be created in the MySQL server.\"\n  default = \"testuser\"\n  type = string\n}\n\nvariable \"mysql_password\" {\n  description = \"The password of the default user to be created in the MySQL server.\"\n  default = \"reallysecure!!\"\n  type = string\n  sensitive = true\n}\n\nvariable \"adminer_port\" {\n  description = \"The port to expose the adminer panel on.\"\n  default = 8080\n  type = number\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linode__terraform-provider-linode__examples__mysql_adminer__variable.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\nCopyright 2022 The Kubernetes Authors.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n/*\nThis file defines:\n- Required Terraform version\n*/\n\nterraform {\n  required_version = \"~> 1.3.0\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubernetes__k8s.io__infra__aws__terraform__audit-account__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Deploy Cross-Account Role for PHD access\n\n# Parameters\nprovider \"aws\" {\n    region  = var.aha_primary_region\n    default_tags {\n      tags = \"${var.default_tags}\"\n    }\n}\n\nvariable \"aha_primary_region\" {\n    description = \"Primary region where AHA solution will be deployed\"\n    type        = string\n    default     = \"us-east-1\"\n}\n\nvariable \"default_tags\" {\n    description = \"Tags used for the AWS resources created by this template\"\n    type        = map\n    default     = {\n      Application      = \"AHA-Solution\"\n    }\n}\n\nvariable \"OrgMemberAccountId\" {\n  type = string \n  description = \"AWS Account ID of the AWS Organizations Member Account that will run AWS Health Aware\"\n\n  validation {\n    condition     = length(var.OrgMemberAccountId) == 12\n    error_message = \"The OrgMemberAccountId must be a valid AWS Account ID.\"\n  }\n}\n\n# Random id generator\nresource \"random_string\" \"resource_code\" {\n  length  = 8\n  special = false\n  upper   = false\n}\n\n# aws_iam_role.AWSHealthAwareRoleForPHDEvents:\nresource \"aws_iam_role\" \"AWSHealthAwareRoleForPHDEvents\" {\n    assume_role_policy    = jsonencode(\n        {\n            Statement = [\n                {\n                    Action    = \"sts:AssumeRole\"\n                    Effect    = \"Allow\"\n                    Principal = {\n                        AWS = \"arn:aws:iam::${var.OrgMemberAccountId}:root\"\n                    }\n                },\n            ]\n            Version   = \"2012-10-17\"\n        }\n    )\n    name                  = \"AWSHealthAwareRoleForPHDEvents-${random_string.resource_code.result}\"\n    description           = \"Grants access to PHD event\"\n    path                  = \"/\"\n\n    inline_policy {\n        name   = \"AllowHealthCalls\"\n        policy = jsonencode(\n            {\n                Statement = [\n                    {\n                        Action   = [\n                            \"health:DescribeAffectedAccountsForOrganization\",\n                            \"health:DescribeAffectedEntitiesForOrganization\",\n                            \"health:DescribeEventDetailsForOrganization\",\n                            \"health:DescribeEventsForOrganization\",\n                            \"health:DescribeEventDetails\",\n                            \"health:DescribeEvents\",\n                            \"health:DescribeEventTypes\",\n                            \"health:DescribeAffectedEntities\",\n                        ]\n                        Effect   = \"Allow\"\n                        Resource = \"*\"\n                    },\n                ]\n            }\n        )\n    }\n    inline_policy {\n        name   = \"AllowsDescribeOrg\"\n        policy = jsonencode(\n            {\n                Statement = [\n                    {\n                        Action   = [\n                            \"organizations:ListAccounts\",\n                            \"organizations:ListAWSServiceAccessForOrganization\",\n                            \"organizations:DescribeAccount\",\n                        ]\n                        Effect   = \"Allow\"\n                        Resource = \"*\"\n                    },\n                ]\n            }\n        )\n    }\n}\n\n\noutput \"AWSHealthAwareRoleForPHDEventsArn\" {\n  value       = aws_iam_role.AWSHealthAwareRoleForPHDEvents.arn\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__aws-health-aware__terraform__Terraform_MGMT_ROLE__Terraform_MGMT_ROLE.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource-1: Create WebTier Subnet\nresource \"azurerm_subnet\" \"websubnet\" {\n  name                 = \"${azurerm_virtual_network.vnet.name}-${var.web_subnet_name}\"\n  resource_group_name  = azurerm_resource_group.rg.name\n  virtual_network_name = azurerm_virtual_network.vnet.name\n  address_prefixes     = var.web_subnet_address  \n}\n\n# Resource-2: Create Network Security Group (NSG)\nresource \"azurerm_network_security_group\" \"web_subnet_nsg\" {\n  name                = \"${azurerm_subnet.websubnet.name}-nsg\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n}\n\n# Resource-3: Associate NSG and Subnet\nresource \"azurerm_subnet_network_security_group_association\" \"web_subnet_nsg_associate\" {\n  depends_on = [ azurerm_network_security_rule.web_nsg_rule_inbound] # Every NSG Rule Association will disassociate NSG from Subnet and Associate it, so we associate it only after NSG is completely created - Azure Provider Bug https://github.com/terraform-providers/terraform-provider-azurerm/issues/354  \n  subnet_id                 = azurerm_subnet.websubnet.id\n  network_security_group_id = azurerm_network_security_group.web_subnet_nsg.id\n}\n\n# Resource-4: Create NSG Rules\n## Locals Block for Security Rules\nlocals {\n  web_inbound_ports_map = {\n    \"100\" : \"80\", # If the key starts with a number, you must use the colon syntax \":\" instead of \"=\"\n    \"110\" : \"443\",\n    \"120\" : \"22\"\n  } \n}\n## NSG Inbound Rule for WebTier Subnets\nresource \"azurerm_network_security_rule\" \"web_nsg_rule_inbound\" {\n  for_each = local.web_inbound_ports_map\n  name                        = \"Rule-Port-${each.value}\"\n  priority                    = each.key\n  direction                   = \"Inbound\"\n  access                      = \"Allow\"\n  protocol                    = \"Tcp\"\n  source_port_range           = \"*\"\n  destination_port_range      = each.value \n  source_address_prefix       = \"*\"\n  destination_address_prefix  = \"*\"\n  resource_group_name         = azurerm_resource_group.rg.name\n  network_security_group_name = azurerm_network_security_group.web_subnet_nsg.name\n}\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-azure-with-azure-devops__terraform-manifests__c6-03-web-subnet-and-nsg.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_160", "severity": "HIGH", "message": "Ensure that HTTP (port 80) access is restricted from the internet", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-azure-with-azure-devops__terraform-manifests__c6-03-web-subnet-and-nsg.tf", "start_line": 33}, {"tool": "checkov", "rule_id": "CKV_AZURE_10", "severity": "HIGH", "message": "Ensure that SSH access is restricted from the internet", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-azure-with-azure-devops__terraform-manifests__c6-03-web-subnet-and-nsg.tf", "start_line": 33}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n####\n# these tests ensure that new versions of null-label remain compatible and\n# interoperable with old versions of null-label.\n#\n# However, there is a known incompatibility we are not going to do anything about:\n#\n# The input regex_replace_chars specifies a regular expression, and characters matching it are removed\n# from labels/id elements. Prior to this release, if the delimiter itself matched the regular expression,\n# then the delimiter would be removed from the attributes portion of the id. This was not a problem\n# for most users, since the default delimiter was - (dash) and the default regex allowed dashes, but\n# if you customized the delimiter and/or regex, it mattered. So these\n# compatibility tests are required to allow the delimiter in the labels.\n\nmodule \"source_v22_full\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.22.1\"\n\n  enabled     = true\n  namespace   = \"CloudPosse\"\n  environment = \"UAT\"\n  stage       = \"build\"\n  name        = \"Winston Churchroom\"\n  delimiter   = \"+\"\n  attributes  = [\"fire\", \"water\"]\n\n  tags = {\n    City        = \"Dublin\"\n    Environment = \"Private\"\n  }\n  additional_tag_map = {\n    propagate = true\n  }\n  label_order         = [\"name\", \"environment\", \"stage\", \"attributes\"]\n  regex_replace_chars = \"/[^a-tv-zA-Z0-9+]/\" # Eliminate \"u\" just to verify this is taking effect\n  id_length_limit     = 28\n}\n\nmodule \"source_v22_empty\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.22.1\"\n\n  stage = \"STAGE\"\n}\n\nmodule \"source_v24_full\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.24.1\"\n\n  enabled     = true\n  namespace   = \"CloudPosse\"\n  environment = \"UAT\"\n  stage       = \"build\"\n  name        = \"Winston Churchroom\"\n  delimiter   = \"+\"\n  attributes  = [\"fire\", \"water\"]\n\n  tags = {\n    City        = \"Dublin\"\n    Environment = \"Private\"\n  }\n  additional_tag_map = {\n    propagate = true\n  }\n  label_order         = [\"name\", \"environment\", \"stage\", \"attributes\"]\n  regex_replace_chars = \"/[^a-tv-zA-Z0-9+]/\" # Eliminate \"u\" just to verify this is taking effect\n  id_length_limit     = 28\n\n  label_key_case   = \"upper\"\n  label_value_case = \"lower\"\n}\n\nmodule \"source_v24_empty\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.24.1\"\n\n  stage = \"STAGE\"\n}\n\n# When testing the backward compatibility of supplying a new\n# context to an old module, it is not fair to use\n# the new features in the new module.\nmodule \"source_v25_22_full\" {\n  source = \"../..\"\n\n  enabled     = true\n  namespace   = \"CloudPosse\"\n  environment = \"UAT\"\n  stage       = \"build\"\n  name        = \"Winston Churchroom\"\n  delimiter   = \"+\"\n  attributes  = [\"fire\", \"water\"]\n\n  tags = {\n    City        = \"Dublin\"\n    Environment = \"Private\"\n  }\n  additional_tag_map = {\n    propagate = true\n  }\n  label_order = [\"name\", \"environment\", \"stage\", \"attributes\"]\n  # Need to add \"+\" to the regex in v0.22.1 due to a known issue:\n  # the attributes string will have the delimiter stripped out\n  # if the delimiter is selected by `regex_replace_chars`.\n  # This was fixed in v0.24.1\n  regex_replace_chars = \"/[^a-tv-zA-Z0-9+]/\" # Eliminate \"u\" just to verify this is taking effect\n  id_length_limit     = 28\n}\n\nmodule \"source_v25_24_full\" {\n  source              = \"../..\"\n  regex_replace_chars = \"/[^a-tv-zA-Z0-9]/\" # Eliminate \"u\" just to verify this is taking effect\n\n  label_key_case   = \"lower\"\n  label_value_case = \"upper\"\n\n  context = module.source_v25_22_full.context\n}\n\nmodule \"source_v25_empty\" {\n  source = \"../..\"\n\n  stage = \"STAGE\"\n}\n\nmodule \"compat_22_25_full\" {\n  source  = \"../..\"\n  context = module.source_v22_full.context\n}\n\nmodule \"compat_24_25_full\" {\n  source  = \"../..\"\n  context = module.source_v24_full.context\n}\n\nmodule \"compat_22_25_empty\" {\n  source  = \"../..\"\n  context = module.source_v22_empty.context\n}\n\nmodule \"compat_24_25_empty\" {\n  source  = \"../..\"\n  context = module.source_v24_empty.context\n}\n\nmodule \"compat_25_22_full\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.22.1\"\n\n  # Known issue, additional_tag_map not taken from context\n  additional_tag_map = module.source_v25_22_full.context.additional_tag_map\n\n  context = module.source_v25_22_full.context\n}\n\nmodule \"compat_25_24_full\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.24.1\"\n\n  # Known issue, additional_tag_map not taken from context\n  additional_tag_map = module.source_v25_22_full.context.additional_tag_map\n\n  context = module.source_v25_24_full.context\n}\n\nmodule \"compat_25_22_empty\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.22.1\"\n\n  context = module.source_v25_empty.context\n}\n\nmodule \"compat_25_24_empty\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.24.1\"\n\n  context = module.source_v25_empty.context\n}\n\nmodule \"compare_22_25_full\" {\n  source = \"./module/compare\"\n  a      = module.source_v22_full\n  b      = module.compat_22_25_full\n}\n\noutput \"compare_22_25_full\" {\n  value = module.compare_22_25_full\n}\n\n/* Uncomment this code to see how the fields differ\noutput \"source_22_full_id_full\" {\n  value = module.source_v22_full.id_full\n}\noutput \"compat_22_25_full_id_full\" {\n  value = module.compat_22_25_full.id_full\n}\noutput \"source_22_full_talm\" {\n  value = module.source_v22_full.tags_as_list_of_maps\n}\noutput \"compat_22_25_full_talm\" {\n  value = module.compat_22_25_full.tags_as_list_of_maps\n}\n*/\n\nmodule \"compare_24_25_full\" {\n  source = \"./module/compare\"\n  a      = module.source_v24_full\n  b      = module.compat_24_25_full\n}\n\noutput \"compare_24_25_full\" {\n  value = module.compare_24_25_full\n}\n\nmodule \"compare_22_25_empty\" {\n  source = \"./module/compare\"\n  a      = module.source_v22_empty\n  b      = module.compat_22_25_empty\n}\n\noutput \"compare_22_25_empty\" {\n  value = module.compare_22_25_empty\n}\n\nmodule \"compare_24_25_empty\" {\n  source = \"./module/compare\"\n  a      = module.source_v24_empty\n  b      = module.compat_24_25_empty\n}\n\noutput \"compare_24_25_empty\" {\n  value = module.compare_24_25_empty\n}\n\nmodule \"compare_25_22_full\" {\n  source = \"./module/compare\"\n  a      = module.source_v25_22_full\n  b      = module.compat_25_22_full\n}\n\noutput \"compare_25_22_full\" {\n  value = module.compare_25_22_full\n}\n\nmodule \"compare_25_24_full\" {\n  source = \"./module/compare\"\n  a      = module.source_v25_24_full\n  b      = module.compat_25_24_full\n}\n\noutput \"compare_25_24_full\" {\n  value = module.compare_25_24_full\n}\n\nmodule \"compare_25_22_empty\" {\n  source = \"./module/compare\"\n  a      = module.source_v25_empty\n  b      = module.compat_25_22_empty\n}\n\noutput \"compare_25_22_empty\" {\n  value = module.compare_25_22_empty\n}\n\nmodule \"compare_25_24_empty\" {\n  source = \"./module/compare\"\n  a      = module.source_v25_empty\n  b      = module.compat_25_24_empty\n}\n\noutput \"compare_25_24_empty\" {\n  value = module.compare_25_24_empty\n}\n\n\noutput \"compatible\" {\n  value = (\n    module.compare_22_25_full.equal &&\n    module.compare_24_25_full.equal &&\n    module.compare_25_22_full.equal &&\n    module.compare_25_24_full.equal &&\n    module.compare_22_25_empty.equal &&\n    module.compare_24_25_empty.equal &&\n    module.compare_25_22_empty.equal &&\n    module.compare_25_24_empty.equal\n  )\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-null-label__examples__complete__compatibility.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-null-label__examples__complete__compatibility.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-null-label__examples__complete__compatibility.tf", "start_line": 38}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-null-label__examples__complete__compatibility.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-null-label__examples__complete__compatibility.tf", "start_line": 72}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-null-label__examples__complete__compatibility.tf", "start_line": 145}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-null-label__examples__complete__compatibility.tf", "start_line": 155}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-null-label__examples__complete__compatibility.tf", "start_line": 165}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-null-label__examples__complete__compatibility.tf", "start_line": 172}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# EC2 Instance\n# https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance\nresource \"aws_instance\" \"green\" {\n  count = var.enable_green_env ? var.green_instance_count : 0\n\n  ami                    = local.ubuntu_ami\n  instance_type          = \"t2.micro\"\n  subnet_id              = local.private_a_subnet_id\n  vpc_security_group_ids = [aws_security_group.web.id]\n\n  user_data = templatefile(\"./init-script.sh\", {\n    file_content = \"green version 1.1 - ${count.index}\"\n  })\n\n  tags = {\n    Name = \"green version 1.1 - ${count.index}\"\n  }\n}\n\n# Load Balancer Target Group\n# https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_target_group\nresource \"aws_lb_target_group\" \"green\" {\n  name     = \"green-tg-green-lb\"\n  port     = 80\n  protocol = \"HTTP\"\n  vpc_id   = local.vpc_id\n\n  health_check {\n    port     = 80\n    protocol = \"HTTP\"\n    timeout  = 5\n    interval = 10\n  }\n}\n\n# Load Balancer Target Group Attachment\n# https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_target_group_attachment\nresource \"aws_lb_target_group_attachment\" \"green\" {\n  count            = length(aws_instance.green)\n  target_group_arn = aws_lb_target_group.green.arn\n  target_id        = aws_instance.green[count.index].id\n  port             = 80\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__green.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__green.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__green.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__green.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__green.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_261", "severity": "HIGH", "message": "Ensure HTTP HTTPS Target group defines Healthcheck", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__green.tf", "start_line": 22}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__green.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_378", "severity": "HIGH", "message": "Ensure AWS Load Balancer doesn't use HTTP protocol", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonputra__tutorials__lessons__063__green.tf", "start_line": 22}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_ebs_volume\" \"ebs_volume\" {\n  availability_zone = \"us-east-1a\"\n  size              = var.ebs_size\n  type              = \"gp2\"\n\n  tags = {\n    Name = \"ebs-volume-terraform-demo\"\n  }\n}\n\nresource \"aws_volume_attachment\" \"ebc_volume_attachment\" {\n  device_name = var.device_name\n  volume_id   = aws_ebs_volume.ebs_volume.id\n  instance_id = aws_instance.ebs_instance_example.id\n}\n\ndata \"template_file\" \"init\" {\n  template = \"${file(\"volume.sh\")}\"\n\n  vars = {\n    device_name = var.device_name\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__ebs-with-userdata__ebs_volume.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_3", "severity": "HIGH", "message": "Ensure all data stored in the EBS is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__ebs-with-userdata__ebs_volume.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_189", "severity": "HIGH", "message": "Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__ebs-with-userdata__ebs_volume.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_2", "severity": "CRITICAL", "message": "Ensure that only encrypted EBS volumes are attached to EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/easyawslearn__Terraform-Tutorial__ebs-with-userdata__ebs_volume.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"tencentcloud_audit_cos_regions\" \"example\" {\n}\n\ndata \"tencentcloud_audits\" \"example\" {\n}\n\ndata \"tencentcloud_audit_key_alias\" \"example\" {\n  region = \"ap-hongkong\"\n}\n\nresource \"tencentcloud_audit\" \"example_kms\" {\n  name                 = \"example_kms\"\n  cos_bucket           = \"test\"\n  cos_region           = \"ap-hongkong\"\n  enable_kms_encry     = true\n  log_file_prefix      = \"exampleprefix\"\n  key_id               = data.tencentcloud_audit_key_alias.example.audit_key_alias_list.0.key_id\n  audit_switch         = true\n  read_write_attribute = 3\n}\n\ndata \"tencentcloud_audits\" \"name_example\" {\n  name = \"example_kms\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tencentcloudstack__terraform-provider-tencentcloud__examples__tencentcloud-audit__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.0\"\n    }\n  }\n}\n\n# Main region where the resources should be created in\n# Should be close to the location of your viewers\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\n# Provider used for creating the Lambda@Edge function which must be deployed\n# to us-east-1 region (Should not be changed)\nprovider \"aws\" {\n  alias  = \"global_region\"\n  region = \"us-east-1\"\n}\n\nmodule \"tf_next\" {\n  source  = \"milliHQ/next-js/aws\"\n  version = \"1.0.0-canary.5\"\n\n  deployment_name = \"tf-next-example-complete\"\n\n  providers = {\n    aws.global_region = aws.global_region\n  }\n\n  # Uncomment when using in the cloned monorepo for tf-next development\n  # source = \"../..\"\n  # debug_use_local_packages = true\n}\n\noutput \"cloudfront_domain_name\" {\n  value = module.tf_next.cloudfront_domain_name\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/milliHQ__terraform-aws-next-js__examples__complete__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/milliHQ__terraform-aws-next-js__examples__complete__main.tf", "start_line": 23}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = local.region\n\n  # Make it faster by skipping something\n  skip_metadata_api_check     = true\n  skip_region_validation      = true\n  skip_credentials_validation = true\n}\n\nlocals {\n  region = \"eu-west-1\"\n}\n\nmodule \"account_public_access\" {\n  source = \"../../modules/account-public-access\"\n\n  block_public_acls       = true\n  block_public_policy     = true\n  ignore_public_acls      = true\n  restrict_public_buckets = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-s3-bucket__examples__account-public-access__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# //////////////////////////////\n# VARIABLES\n# //////////////////////////////\nvariable \"aws_access_key\" {}\n\nvariable \"aws_secret_key\" {}\n\nvariable \"region\" {\n  default = \"us-east-2\"\n}\n\nvariable \"vpc_cidr\" {\n  default = \"172.16.0.0/16\"\n}\n\nvariable \"subnet1_cidr\" {\n  default = \"172.16.0.0/24\"\n}\n\nvariable \"environment_list\" {\n  type = list(string)\n  default = [\"DEV\",\"QA\",\"STAGE\",\"PROD\"]\n}\n\nvariable \"environment_map\" {\n  type = map(string)\n  default = {\n    \"DEV\" = \"DEV\",\n    \"QA\" = \"QA\",\n    \"STAGE\" = \"STAGE\",\n    \"PROD\" = \"PROD\"\n  }\n}\n\nvariable \"environment_instance_type\" {\n  type = map(string)\n  default = {\n    \"DEV\" = \"t2.micro\",\n    \"QA\" = \"t2.micro\",\n    \"STAGE\" = \"t2.micro\",\n    \"PROD\" = \"t2.micro\"\n  }\n}\n\nvariable \"environment_instance_settings\" {\n  type = map(object({instance_type=string, monitoring=bool}))\n  default = {\n    \"DEV\" = {\n      instance_type = \"t2.micro\", \n      monitoring = false\n    },\n   \"QA\" = {\n      instance_type = \"t2.micro\", \n      monitoring = false\n    },\n    \"STAGE\" = {\n      instance_type = \"t2.micro\", \n      monitoring = false\n    },\n    \"PROD\" = {\n      instance_type = \"t2.micro\", \n      monitoring = true\n    }\n  }\n}\n\n# //////////////////////////////\n# PROVIDERS\n# //////////////////////////////\nprovider \"aws\" {\n  access_key = var.aws_access_key\n  secret_key = var.aws_secret_key\n  region     = var.region\n}\n\n# //////////////////////////////\n# RESOURCES\n# //////////////////////////////\n\n# VPC\nresource \"aws_vpc\" \"vpc1\" {\n  cidr_block = var.vpc_cidr\n  enable_dns_hostnames = \"true\"\n}\n\n# SUBNET\nresource \"aws_subnet\" \"subnet1\" {\n  cidr_block = var.subnet1_cidr\n  vpc_id = aws_vpc.vpc1.id\n  map_public_ip_on_launch = \"true\"\n  availability_zone = data.aws_availability_zones.available.names[1]\n}\n\n# INTERNET_GATEWAY\nresource \"aws_internet_gateway\" \"gateway1\" {\n  vpc_id = aws_vpc.vpc1.id\n}\n\n# ROUTE_TABLE\nresource \"aws_route_table\" \"route_table1\" {\n  vpc_id = aws_vpc.vpc1.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.gateway1.id\n  }\n}\n\nresource \"aws_route_table_association\" \"route-subnet1\" {\n  subnet_id = aws_subnet.subnet1.id\n  route_table_id = aws_route_table.route_table1.id\n}\n\n# SECURITY_GROUP\nresource \"aws_security_group\" \"sg-nodejs-instance\" {\n  name = \"nodejs_sg\"\n  vpc_id = aws_vpc.vpc1.id\n\n  ingress {\n    from_port = 80\n    to_port = 80\n    protocol = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port = 22\n    to_port = 22\n    protocol = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  \n  egress {\n    from_port = 0\n    to_port = 0\n    protocol = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\n# INSTANCE\nresource \"aws_instance\" \"nodejs1\" {\n  ami = data.aws_ami.aws-linux.id\n  instance_type = var.environment_instance_type[\"DEV\"]\n  //instance_type = var.environment_instance_settings[\"PROD\"].instance_type\n  subnet_id = aws_subnet.subnet1.id\n  vpc_security_group_ids = [aws_security_group.sg-nodejs-instance.id]\n\n  monitoring = var.environment_instance_settings[\"PROD\"].monitoring\n\n  tags = {Environment = var.environment_list[0]}\n\n}\n\n# //////////////////////////////\n# DATA\n# //////////////////////////////\ndata \"aws_availability_zones\" \"available\" {}\n\ndata \"aws_ami\" \"aws-linux\" {\n  most_recent = true\n  owners      = [\"amazon\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"amzn-ami-hvm*\"]\n  }\n\n  filter {\n    name   = \"root-device-type\"\n    values = [\"ebs\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n}\n\n# //////////////////////////////\n# OUTPUT\n# //////////////////////////////\noutput \"instance-dns\" {\n  value = aws_instance.nodejs1.public_dns\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "start_line": 87}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "start_line": 115}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "start_line": 115}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "start_line": 115}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "start_line": 115}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "start_line": 142}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "start_line": 142}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "start_line": 142}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "start_line": 142}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "start_line": 81}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__02_02-07_variables__main.tf", "start_line": 81}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n###########################\n# CONFIGURATION\n###########################\n\nterraform {\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"~> 2.0\"\n\n    }\n  }\n}\n\n###########################\n# VARIABLES\n###########################\n\nvariable \"region\" {\n  type        = string\n  description = \"Region in Azure\"\n  default     = \"eastus\"\n}\n\nvariable \"tacos\" {\n  type        = string\n  description = \"prefix for naming\"\n  default     = \"tacos\"\n}\n\nvariable \"burritos\" {\n  type        = string\n  description = \"prefix for naming\"\n  default     = \"burritos\"\n}\n\n###########################\n# PROVIDERS\n###########################\n\nprovider \"azurerm\" {\n  features {}\n}\n\n###########################\n# DATA SOURCES\n###########################\n\nlocals {\n  tacos = \"${var.tacos}-demo\"\n  burritos = \"${var.burritos}-demo\"\n}\n\n###########################\n# RESOURCES\n###########################\n\nresource \"azurerm_resource_group\" \"tacos\" {\n  name     = local.tacos\n  location = var.region\n}\n\nresource \"azurerm_resource_group\" \"enchilada\" {\n  name     = local.burritos\n  location = var.region\n}\n\n#module \"tacos\" {\n#    source = \"./tacos\"\n#    name = local.tacos\n#    region = var.region\n#}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__terraform-tuesdays__2020-11-10-MovingStateResources__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nresource \"aws_ecs_cluster\" \"default\" {\n  name = \"centos-ecs-cluster\"\n}\n\nresource \"aws_ecs_task_definition\" \"service\" {\n  family = \"service\"\n  container_definitions = jsonencode([\n    {\n      name      = \"first\"\n      image     = \"centos\"\n      cpu       = 10\n      memory    = 512\n      essential = true\n      portMappings = [\n        {\n          containerPort = 80\n          hostPort      = 80\n        }\n      ]\n    }\n  ])\n}\n\nresource \"aws_ecs_service\" \"centos\" {\n  name            = \"centos\"\n  cluster         = aws_ecs_cluster.default.arn\n  task_definition = aws_ecs_task_definition.service.arn\n  desired_count   = 1\n  # iam_role        = aws_iam_role.my_role.arn\n  # depends_on      = [aws_iam_role_policy.my_policy]\n}\n\n# resource \"aws_iam_role\" \"my_role\" {\n#   name = \"my_role\"\n\n#   # Terraform's \"jsonencode\" function converts a\n#   # Terraform expression result to valid JSON syntax.\n#   assume_role_policy = jsonencode({\n#     \"Version\" : \"2008-10-17\",\n#     \"Statement\" : [\n#       {\n#         \"Sid\" : \"\",\n#         \"Effect\" : \"Allow\",\n#         \"Principal\" : {\n#           \"Service\" : \"ec2.amazonaws.com\"\n#         },\n#         \"Action\" : \"sts:AssumeRole\"\n#       }\n#     ]\n#   })\n# }\n\n# resource \"aws_iam_role_policy\" \"my_policy\" {\n#   name = \"my_policy\"\n#   role = aws_iam_role.my_role.id\n\n#   # Terraform's \"jsonencode\" function converts a\n#   # Terraform expression result to valid JSON syntax.\n#   policy = jsonencode({\n#     \"Version\" : \"2012-10-17\",\n#     \"Statement\" : [\n#       {\n#         \"Effect\" : \"Allow\",\n#         \"Action\" : [\n#           \"ec2:DescribeTags\",\n#           \"ecs:CreateCluster\",\n#           \"ecs:DeregisterContainerInstance\",\n#           \"ecs:DiscoverPollEndpoint\",\n#           \"ecs:Poll\",\n#           \"ecs:RegisterContainerInstance\",\n#           \"ecs:StartTelemetrySession\",\n#           \"ecs:UpdateContainerInstancesState\",\n#           \"ecs:Submit*\",\n#           \"ecr:GetAuthorizationToken\",\n#           \"ecr:BatchCheckLayerAvailability\",\n#           \"ecr:GetDownloadUrlForLayer\",\n#           \"ecr:BatchGetImage\",\n#           \"logs:CreateLogStream\",\n#           \"logs:PutLogEvents\"\n#         ],\n#         \"Resource\" : \"*\"\n#       }\n#     ]\n#   })\n# }", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/troy-ingram__terraform__centos-ecs-week18-project__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_65", "severity": "HIGH", "message": "Ensure container insights are enabled on ECS cluster", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/troy-ingram__terraform__centos-ecs-week18-project__main.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_336", "severity": "HIGH", "message": "Ensure ECS containers are limited to read-only access to root filesystems", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/troy-ingram__terraform__centos-ecs-week18-project__main.tf", "start_line": 6}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n# SPDX-License-Identifier: MIT-0\n\nvariable \"name\" {\n  description = \"A name for the target group or ALB\"\n  type        = string\n}\n\nvariable \"target_group\" {\n  description = \"The ARN of the created target group\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"target_group_green\" {\n  description = \"The ANR of the created target group\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"create_alb\" {\n  description = \"Set to true to create an ALB\"\n  type        = bool\n  default     = false\n}\n\nvariable \"enable_https\" {\n  description = \"Set to true to create a HTTPS listener\"\n  type        = bool\n  default     = false\n}\n\nvariable \"create_target_group\" {\n  description = \"Set to true to create a Target Group\"\n  type        = bool\n  default     = false\n}\n\nvariable \"subnets\" {\n  description = \"Subnets IDs for ALB\"\n  type        = list(any)\n  default     = []\n}\n\nvariable \"security_group\" {\n  description = \"Security group ID for the ALB\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"port\" {\n  description = \"The port that the targer group will use\"\n  type        = number\n  default     = 80\n}\n\nvariable \"protocol\" {\n  description = \"The protocol that the target group will use\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"vpc\" {\n  description = \"VPC ID for the Target Group\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"tg_type\" {\n  description = \"Target Group Type (instance, IP, lambda)\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"health_check_path\" {\n  description = \"The path in which the ALB will send health checks\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"health_check_port\" {\n  description = \"The port to which the ALB will send health checks\"\n  type        = number\n  default     = 80\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-samples__amazon-ecs-fullstack-app-terraform__Infrastructure__Modules__ALB__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"ecs_cluster_id\" {\n  value = \"${aws_ecs_cluster.example_cluster.id}\"\n}\n\noutput \"security_group_id\" {\n  value = \"${aws_security_group.ecs_instance.id}\"\n}\n\noutput \"iam_role_id\" {\n  value = \"${aws_iam_role.ecs_instance.id}\"\n}\n\noutput \"iam_role_name\" {\n  value = \"${aws_iam_role.ecs_instance.name}\"\n}\n\noutput \"asg_name\" {\n  value = \"${aws_autoscaling_group.ecs_cluster_instances.name}\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__infrastructure-as-code-talk__terraform-configurations__ecs-cluster__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// Provider\n\nprovider \"google\" {\n  credentials = file(var.sa_token)\n  project     = var.project_id\n  region      = var.region\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Abhinav-26__DevOps-Projects__DevOps Project-5__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"feature_set\" {\n  description = \"Specify 'ALL' (default) or 'CONSOLIDATED_BILLING'.\"\n  default     = \"ALL\"\n}\n\nresource \"aws_organizations_organization\" \"this\" {\n  feature_set = var.feature_set\n}\n\noutput \"this_organizations_organization_id\" {\n  description = \"Identifier of the organization\"\n  value       = aws_organizations_organization.this.id\n}\n\noutput \"this_organizations_organization_arn\" {\n  description = \"ARN of the organization\"\n  value       = aws_organizations_organization.this.arn\n}\n\noutput \"this_organizations_organization_master_account_arn\" {\n  description = \"ARN of the master account\"\n  value       = aws_organizations_organization.this.master_account_arn\n}\n\noutput \"this_organizations_organization_master_account_email\" {\n  description = \"Email address of the master account\"\n  value       = aws_organizations_organization.this.master_account_email\n}\n\noutput \"this_organizations_organization_master_account_id\" {\n  description = \"Identifier of the master account\"\n  value       = aws_organizations_organization.this.master_account_id\n}\n\n// acme-prod\nresource \"aws_organizations_account\" \"acme_prod\" {\n  name                       = \"acme-prod\"\n  email                      = \"anton+acme-prod@antonbabenko.com\"\n  iam_user_access_to_billing = \"ALLOW\"\n  role_name                  = \"admin\"\n}\n\noutput \"acme_prod_organizations_account_id\" {\n  description = \"The AWS account id\"\n  value       = aws_organizations_account.acme_prod.id\n}\n\noutput \"acme_prod_organizations_account_arn\" {\n  description = \"The ARN for this account\"\n  value       = aws_organizations_account.acme_prod.arn\n}\n\n// acme-staging\nresource \"aws_organizations_account\" \"acme_staging\" {\n  name                       = \"acme-staging\"\n  email                      = \"anton+acme-prod@antonbabenko.com\"\n  iam_user_access_to_billing = \"ALLOW\"\n  role_name                  = \"admin\"\n}\n\noutput \"acme_staging_organizations_account_id\" {\n  description = \"The AWS account id\"\n  value       = aws_organizations_account.acme_staging.id\n}\n\noutput \"acme_staging_organizations_account_arn\" {\n  description = \"The ARN for this account\"\n  value       = aws_organizations_account.acme_staging.arn\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terragrunt-reference-architecture__modules__organizations__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  # `backend` blocks do not support variables, so the following are hard-coded here:\n  # - S3 bucket name, which is created in modernisation-platform-account/s3.tf\n  backend \"s3\" {\n    bucket       = \"modernisation-platform-terraform-state\"\n    encrypt      = true\n    key          = \"github/terraform.tfstate\"\n    region       = \"eu-west-2\"\n    use_lockfile = true\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ministryofjustice__modernisation-platform__terraform__github__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#----------------------------------------------------------\n#  Terraform - From Zero to Certified Professional\n#\n# Build EC2 Instances\n#\n# Made by Denis Astahov\n#----------------------------------------------------------\n\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\nresource \"aws_instance\" \"my_ubuntu\" {\n  ami           = \"ami-06e54d05255faf8f6\" # This is Comments\n  instance_type = \"t3.micro\"              // This is also Comments\n  key_name      = \"denis-key-oregon\"\n\n  tags = {\n    Name    = \"My-UbuntuLinux-Server\"\n    Owner   = \"Denis Astahov\"\n    project = \"Phoenix\"\n  }\n}\n\nresource \"aws_instance\" \"my_amazon\" {\n  ami           = \"ami-0528a5175983e7f28\" // This is Comments\n  instance_type = \"t3.small\"              # This is also Comments\n\n  tags = {\n    Name  = \"My-AmazonLinux-Server\"\n    Owner = \"Denis Astahov\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-01__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-01__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-01__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-01__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-01__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-01__main.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-01__main.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-01__main.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-01__main.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-01__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-01__main.tf", "start_line": 25}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nvariable \"aws_region\" {\n  description = \"AWS region\"\n  default     = \"us-west-2\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-aws__examples__api-gateway-websocket-chat-app__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"github_security_managers_team\" {\n  description = \"The organization security managers team\"\n  value       = github_organization_security_manager.security_managers\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/integrations__terraform-provider-github__examples__organization_security_manager__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n# [START vpc_custom_create]\nresource \"google_compute_network\" \"vpc_network\" {\n  project                 = var.project_id # Replace this with your project ID in quotes\n  name                    = \"my-custom-mode-network\"\n  auto_create_subnetworks = false\n  mtu                     = 1460\n}\n# [END vpc_custom_create]\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-network__examples__basic_custom_mode__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_GCP_18", "severity": "CRITICAL", "message": "Ensure GCP network defines a firewall and does not use the default firewall", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-network__examples__basic_custom_mode__main.tf", "start_line": 18}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__atmos__examples__demo-auth__components__terraform__whoami__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"azurerm_resource_group\" \"rg\" {\n  name     = \"tamopslocalrg\"\n  location = \"uksouth\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/thomast1906__terraform-on-azure__3-terraform-state__local-state-example__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"ami-id\" {}\nvariable \"depends-id\" {}\nvariable \"instance-profile-name\" {}\nvariable \"instance-type\" {}\nvariable \"internal-tld\" {}\nvariable \"key-name\" {}\nvariable \"name\" {}\nvariable \"s3-bucket\" {}\nvariable \"s3-bucket-arn\" {}\nvariable \"security-group-id\" {}\nvariable \"subnet-id\" {}\nvariable \"vpc-id\" {}\n\noutput \"depends-id\" { value = \"${ null_resource.dummy_dependency.id }\" }\noutput \"ip\" { value = \"${ aws_instance.bastion.public_ip }\" }\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kz8s__tack__modules__bastion__io.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"wrapper\" {\n  source = \"../\"\n\n  for_each = var.items\n\n  amazon_side_asn                        = try(each.value.amazon_side_asn, var.defaults.amazon_side_asn, \"64512\")\n  azs                                    = try(each.value.azs, var.defaults.azs, [])\n  cidr                                   = try(each.value.cidr, var.defaults.cidr, \"10.0.0.0/16\")\n  create_database_internet_gateway_route = try(each.value.create_database_internet_gateway_route, var.defaults.create_database_internet_gateway_route, false)\n  create_database_nat_gateway_route      = try(each.value.create_database_nat_gateway_route, var.defaults.create_database_nat_gateway_route, false)\n  create_database_subnet_group           = try(each.value.create_database_subnet_group, var.defaults.create_database_subnet_group, true)\n  create_database_subnet_route_table     = try(each.value.create_database_subnet_route_table, var.defaults.create_database_subnet_route_table, false)\n  create_egress_only_igw                 = try(each.value.create_egress_only_igw, var.defaults.create_egress_only_igw, true)\n  create_elasticache_subnet_group        = try(each.value.create_elasticache_subnet_group, var.defaults.create_elasticache_subnet_group, true)\n  create_elasticache_subnet_route_table  = try(each.value.create_elasticache_subnet_route_table, var.defaults.create_elasticache_subnet_route_table, false)\n  create_flow_log_cloudwatch_iam_role    = try(each.value.create_flow_log_cloudwatch_iam_role, var.defaults.create_flow_log_cloudwatch_iam_role, false)\n  create_flow_log_cloudwatch_log_group   = try(each.value.create_flow_log_cloudwatch_log_group, var.defaults.create_flow_log_cloudwatch_log_group, false)\n  create_igw                             = try(each.value.create_igw, var.defaults.create_igw, true)\n  create_multiple_intra_route_tables     = try(each.value.create_multiple_intra_route_tables, var.defaults.create_multiple_intra_route_tables, false)\n  create_multiple_public_route_tables    = try(each.value.create_multiple_public_route_tables, var.defaults.create_multiple_public_route_tables, false)\n  create_private_nat_gateway_route       = try(each.value.create_private_nat_gateway_route, var.defaults.create_private_nat_gateway_route, true)\n  create_redshift_subnet_group           = try(each.value.create_redshift_subnet_group, var.defaults.create_redshift_subnet_group, true)\n  create_redshift_subnet_route_table     = try(each.value.create_redshift_subnet_route_table, var.defaults.create_redshift_subnet_route_table, false)\n  create_vpc                             = try(each.value.create_vpc, var.defaults.create_vpc, true)\n  customer_gateway_tags                  = try(each.value.customer_gateway_tags, var.defaults.customer_gateway_tags, {})\n  customer_gateways                      = try(each.value.customer_gateways, var.defaults.customer_gateways, {})\n  customer_owned_ipv4_pool               = try(each.value.customer_owned_ipv4_pool, var.defaults.customer_owned_ipv4_pool, null)\n  database_acl_tags                      = try(each.value.database_acl_tags, var.defaults.database_acl_tags, {})\n  database_dedicated_network_acl         = try(each.value.database_dedicated_network_acl, var.defaults.database_dedicated_network_acl, false)\n  database_inbound_acl_rules = try(each.value.database_inbound_acl_rules, var.defaults.database_inbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  database_outbound_acl_rules = try(each.value.database_outbound_acl_rules, var.defaults.database_outbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  database_route_table_tags                                      = try(each.value.database_route_table_tags, var.defaults.database_route_table_tags, {})\n  database_subnet_assign_ipv6_address_on_creation                = try(each.value.database_subnet_assign_ipv6_address_on_creation, var.defaults.database_subnet_assign_ipv6_address_on_creation, false)\n  database_subnet_enable_dns64                                   = try(each.value.database_subnet_enable_dns64, var.defaults.database_subnet_enable_dns64, true)\n  database_subnet_enable_resource_name_dns_a_record_on_launch    = try(each.value.database_subnet_enable_resource_name_dns_a_record_on_launch, var.defaults.database_subnet_enable_resource_name_dns_a_record_on_launch, false)\n  database_subnet_enable_resource_name_dns_aaaa_record_on_launch = try(each.value.database_subnet_enable_resource_name_dns_aaaa_record_on_launch, var.defaults.database_subnet_enable_resource_name_dns_aaaa_record_on_launch, true)\n  database_subnet_group_name                                     = try(each.value.database_subnet_group_name, var.defaults.database_subnet_group_name, null)\n  database_subnet_group_tags                                     = try(each.value.database_subnet_group_tags, var.defaults.database_subnet_group_tags, {})\n  database_subnet_ipv6_native                                    = try(each.value.database_subnet_ipv6_native, var.defaults.database_subnet_ipv6_native, false)\n  database_subnet_ipv6_prefixes                                  = try(each.value.database_subnet_ipv6_prefixes, var.defaults.database_subnet_ipv6_prefixes, [])\n  database_subnet_names                                          = try(each.value.database_subnet_names, var.defaults.database_subnet_names, [])\n  database_subnet_private_dns_hostname_type_on_launch            = try(each.value.database_subnet_private_dns_hostname_type_on_launch, var.defaults.database_subnet_private_dns_hostname_type_on_launch, null)\n  database_subnet_suffix                                         = try(each.value.database_subnet_suffix, var.defaults.database_subnet_suffix, \"db\")\n  database_subnet_tags                                           = try(each.value.database_subnet_tags, var.defaults.database_subnet_tags, {})\n  database_subnets                                               = try(each.value.database_subnets, var.defaults.database_subnets, [])\n  default_network_acl_egress = try(each.value.default_network_acl_egress, var.defaults.default_network_acl_egress, [\n    {\n      rule_no    = 100\n      action     = \"allow\"\n      from_port  = 0\n      to_port    = 0\n      protocol   = \"-1\"\n      cidr_block = \"0.0.0.0/0\"\n    },\n    {\n      rule_no         = 101\n      action          = \"allow\"\n      from_port       = 0\n      to_port         = 0\n      protocol        = \"-1\"\n      ipv6_cidr_block = \"::/0\"\n    },\n  ])\n  default_network_acl_ingress = try(each.value.default_network_acl_ingress, var.defaults.default_network_acl_ingress, [\n    {\n      rule_no    = 100\n      action     = \"allow\"\n      from_port  = 0\n      to_port    = 0\n      protocol   = \"-1\"\n      cidr_block = \"0.0.0.0/0\"\n    },\n    {\n      rule_no         = 101\n      action          = \"allow\"\n      from_port       = 0\n      to_port         = 0\n      protocol        = \"-1\"\n      ipv6_cidr_block = \"::/0\"\n    },\n  ])\n  default_network_acl_name                       = try(each.value.default_network_acl_name, var.defaults.default_network_acl_name, null)\n  default_network_acl_tags                       = try(each.value.default_network_acl_tags, var.defaults.default_network_acl_tags, {})\n  default_route_table_name                       = try(each.value.default_route_table_name, var.defaults.default_route_table_name, null)\n  default_route_table_propagating_vgws           = try(each.value.default_route_table_propagating_vgws, var.defaults.default_route_table_propagating_vgws, [])\n  default_route_table_routes                     = try(each.value.default_route_table_routes, var.defaults.default_route_table_routes, [])\n  default_route_table_tags                       = try(each.value.default_route_table_tags, var.defaults.default_route_table_tags, {})\n  default_security_group_egress                  = try(each.value.default_security_group_egress, var.defaults.default_security_group_egress, [])\n  default_security_group_ingress                 = try(each.value.default_security_group_ingress, var.defaults.default_security_group_ingress, [])\n  default_security_group_name                    = try(each.value.default_security_group_name, var.defaults.default_security_group_name, null)\n  default_security_group_tags                    = try(each.value.default_security_group_tags, var.defaults.default_security_group_tags, {})\n  default_vpc_enable_dns_hostnames               = try(each.value.default_vpc_enable_dns_hostnames, var.defaults.default_vpc_enable_dns_hostnames, true)\n  default_vpc_enable_dns_support                 = try(each.value.default_vpc_enable_dns_support, var.defaults.default_vpc_enable_dns_support, true)\n  default_vpc_name                               = try(each.value.default_vpc_name, var.defaults.default_vpc_name, null)\n  default_vpc_tags                               = try(each.value.default_vpc_tags, var.defaults.default_vpc_tags, {})\n  dhcp_options_domain_name                       = try(each.value.dhcp_options_domain_name, var.defaults.dhcp_options_domain_name, \"\")\n  dhcp_options_domain_name_servers               = try(each.value.dhcp_options_domain_name_servers, var.defaults.dhcp_options_domain_name_servers, [\"AmazonProvidedDNS\"])\n  dhcp_options_ipv6_address_preferred_lease_time = try(each.value.dhcp_options_ipv6_address_preferred_lease_time, var.defaults.dhcp_options_ipv6_address_preferred_lease_time, null)\n  dhcp_options_netbios_name_servers              = try(each.value.dhcp_options_netbios_name_servers, var.defaults.dhcp_options_netbios_name_servers, [])\n  dhcp_options_netbios_node_type                 = try(each.value.dhcp_options_netbios_node_type, var.defaults.dhcp_options_netbios_node_type, \"\")\n  dhcp_options_ntp_servers                       = try(each.value.dhcp_options_ntp_servers, var.defaults.dhcp_options_ntp_servers, [])\n  dhcp_options_tags                              = try(each.value.dhcp_options_tags, var.defaults.dhcp_options_tags, {})\n  elasticache_acl_tags                           = try(each.value.elasticache_acl_tags, var.defaults.elasticache_acl_tags, {})\n  elasticache_dedicated_network_acl              = try(each.value.elasticache_dedicated_network_acl, var.defaults.elasticache_dedicated_network_acl, false)\n  elasticache_inbound_acl_rules = try(each.value.elasticache_inbound_acl_rules, var.defaults.elasticache_inbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  elasticache_outbound_acl_rules = try(each.value.elasticache_outbound_acl_rules, var.defaults.elasticache_outbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  elasticache_route_table_tags                                      = try(each.value.elasticache_route_table_tags, var.defaults.elasticache_route_table_tags, {})\n  elasticache_subnet_assign_ipv6_address_on_creation                = try(each.value.elasticache_subnet_assign_ipv6_address_on_creation, var.defaults.elasticache_subnet_assign_ipv6_address_on_creation, false)\n  elasticache_subnet_enable_dns64                                   = try(each.value.elasticache_subnet_enable_dns64, var.defaults.elasticache_subnet_enable_dns64, true)\n  elasticache_subnet_enable_resource_name_dns_a_record_on_launch    = try(each.value.elasticache_subnet_enable_resource_name_dns_a_record_on_launch, var.defaults.elasticache_subnet_enable_resource_name_dns_a_record_on_launch, false)\n  elasticache_subnet_enable_resource_name_dns_aaaa_record_on_launch = try(each.value.elasticache_subnet_enable_resource_name_dns_aaaa_record_on_launch, var.defaults.elasticache_subnet_enable_resource_name_dns_aaaa_record_on_launch, true)\n  elasticache_subnet_group_name                                     = try(each.value.elasticache_subnet_group_name, var.defaults.elasticache_subnet_group_name, null)\n  elasticache_subnet_group_tags                                     = try(each.value.elasticache_subnet_group_tags, var.defaults.elasticache_subnet_group_tags, {})\n  elasticache_subnet_ipv6_native                                    = try(each.value.elasticache_subnet_ipv6_native, var.defaults.elasticache_subnet_ipv6_native, false)\n  elasticache_subnet_ipv6_prefixes                                  = try(each.value.elasticache_subnet_ipv6_prefixes, var.defaults.elasticache_subnet_ipv6_prefixes, [])\n  elasticache_subnet_names                                          = try(each.value.elasticache_subnet_names, var.defaults.elasticache_subnet_names, [])\n  elasticache_subnet_private_dns_hostname_type_on_launch            = try(each.value.elasticache_subnet_private_dns_hostname_type_on_launch, var.defaults.elasticache_subnet_private_dns_hostname_type_on_launch, null)\n  elasticache_subnet_suffix                                         = try(each.value.elasticache_subnet_suffix, var.defaults.elasticache_subnet_suffix, \"elasticache\")\n  elasticache_subnet_tags                                           = try(each.value.elasticache_subnet_tags, var.defaults.elasticache_subnet_tags, {})\n  elasticache_subnets                                               = try(each.value.elasticache_subnets, var.defaults.elasticache_subnets, [])\n  enable_dhcp_options                                               = try(each.value.enable_dhcp_options, var.defaults.enable_dhcp_options, false)\n  enable_dns_hostnames                                              = try(each.value.enable_dns_hostnames, var.defaults.enable_dns_hostnames, true)\n  enable_dns_support                                                = try(each.value.enable_dns_support, var.defaults.enable_dns_support, true)\n  enable_flow_log                                                   = try(each.value.enable_flow_log, var.defaults.enable_flow_log, false)\n  enable_ipv6                                                       = try(each.value.enable_ipv6, var.defaults.enable_ipv6, false)\n  enable_nat_gateway                                                = try(each.value.enable_nat_gateway, var.defaults.enable_nat_gateway, false)\n  enable_network_address_usage_metrics                              = try(each.value.enable_network_address_usage_metrics, var.defaults.enable_network_address_usage_metrics, null)\n  enable_public_redshift                                            = try(each.value.enable_public_redshift, var.defaults.enable_public_redshift, false)\n  enable_vpn_gateway                                                = try(each.value.enable_vpn_gateway, var.defaults.enable_vpn_gateway, false)\n  external_nat_ip_ids                                               = try(each.value.external_nat_ip_ids, var.defaults.external_nat_ip_ids, [])\n  external_nat_ips                                                  = try(each.value.external_nat_ips, var.defaults.external_nat_ips, [])\n  flow_log_cloudwatch_iam_role_arn                                  = try(each.value.flow_log_cloudwatch_iam_role_arn, var.defaults.flow_log_cloudwatch_iam_role_arn, \"\")\n  flow_log_cloudwatch_iam_role_conditions                           = try(each.value.flow_log_cloudwatch_iam_role_conditions, var.defaults.flow_log_cloudwatch_iam_role_conditions, [])\n  flow_log_cloudwatch_log_group_class                               = try(each.value.flow_log_cloudwatch_log_group_class, var.defaults.flow_log_cloudwatch_log_group_class, null)\n  flow_log_cloudwatch_log_group_kms_key_id                          = try(each.value.flow_log_cloudwatch_log_group_kms_key_id, var.defaults.flow_log_cloudwatch_log_group_kms_key_id, null)\n  flow_log_cloudwatch_log_group_name_prefix                         = try(each.value.flow_log_cloudwatch_log_group_name_prefix, var.defaults.flow_log_cloudwatch_log_group_name_prefix, \"/aws/vpc-flow-log/\")\n  flow_log_cloudwatch_log_group_name_suffix                         = try(each.value.flow_log_cloudwatch_log_group_name_suffix, var.defaults.flow_log_cloudwatch_log_group_name_suffix, \"\")\n  flow_log_cloudwatch_log_group_retention_in_days                   = try(each.value.flow_log_cloudwatch_log_group_retention_in_days, var.defaults.flow_log_cloudwatch_log_group_retention_in_days, null)\n  flow_log_cloudwatch_log_group_skip_destroy                        = try(each.value.flow_log_cloudwatch_log_group_skip_destroy, var.defaults.flow_log_cloudwatch_log_group_skip_destroy, false)\n  flow_log_deliver_cross_account_role                               = try(each.value.flow_log_deliver_cross_account_role, var.defaults.flow_log_deliver_cross_account_role, null)\n  flow_log_destination_arn                                          = try(each.value.flow_log_destination_arn, var.defaults.flow_log_destination_arn, \"\")\n  flow_log_destination_type                                         = try(each.value.flow_log_destination_type, var.defaults.flow_log_destination_type, \"cloud-watch-logs\")\n  flow_log_file_format                                              = try(each.value.flow_log_file_format, var.defaults.flow_log_file_format, null)\n  flow_log_hive_compatible_partitions                               = try(each.value.flow_log_hive_compatible_partitions, var.defaults.flow_log_hive_compatible_partitions, false)\n  flow_log_log_format                                               = try(each.value.flow_log_log_format, var.defaults.flow_log_log_format, null)\n  flow_log_max_aggregation_interval                                 = try(each.value.flow_log_max_aggregation_interval, var.defaults.flow_log_max_aggregation_interval, 600)\n  flow_log_per_hour_partition                                       = try(each.value.flow_log_per_hour_partition, var.defaults.flow_log_per_hour_partition, false)\n  flow_log_traffic_type                                             = try(each.value.flow_log_traffic_type, var.defaults.flow_log_traffic_type, \"ALL\")\n  igw_tags                                                          = try(each.value.igw_tags, var.defaults.igw_tags, {})\n  instance_tenancy                                                  = try(each.value.instance_tenancy, var.defaults.instance_tenancy, \"default\")\n  intra_acl_tags                                                    = try(each.value.intra_acl_tags, var.defaults.intra_acl_tags, {})\n  intra_dedicated_network_acl                                       = try(each.value.intra_dedicated_network_acl, var.defaults.intra_dedicated_network_acl, false)\n  intra_inbound_acl_rules = try(each.value.intra_inbound_acl_rules, var.defaults.intra_inbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  intra_outbound_acl_rules = try(each.value.intra_outbound_acl_rules, var.defaults.intra_outbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  intra_route_table_tags                                      = try(each.value.intra_route_table_tags, var.defaults.intra_route_table_tags, {})\n  intra_subnet_assign_ipv6_address_on_creation                = try(each.value.intra_subnet_assign_ipv6_address_on_creation, var.defaults.intra_subnet_assign_ipv6_address_on_creation, false)\n  intra_subnet_enable_dns64                                   = try(each.value.intra_subnet_enable_dns64, var.defaults.intra_subnet_enable_dns64, true)\n  intra_subnet_enable_resource_name_dns_a_record_on_launch    = try(each.value.intra_subnet_enable_resource_name_dns_a_record_on_launch, var.defaults.intra_subnet_enable_resource_name_dns_a_record_on_launch, false)\n  intra_subnet_enable_resource_name_dns_aaaa_record_on_launch = try(each.value.intra_subnet_enable_resource_name_dns_aaaa_record_on_launch, var.defaults.intra_subnet_enable_resource_name_dns_aaaa_record_on_launch, true)\n  intra_subnet_ipv6_native                                    = try(each.value.intra_subnet_ipv6_native, var.defaults.intra_subnet_ipv6_native, false)\n  intra_subnet_ipv6_prefixes                                  = try(each.value.intra_subnet_ipv6_prefixes, var.defaults.intra_subnet_ipv6_prefixes, [])\n  intra_subnet_names                                          = try(each.value.intra_subnet_names, var.defaults.intra_subnet_names, [])\n  intra_subnet_private_dns_hostname_type_on_launch            = try(each.value.intra_subnet_private_dns_hostname_type_on_launch, var.defaults.intra_subnet_private_dns_hostname_type_on_launch, null)\n  intra_subnet_suffix                                         = try(each.value.intra_subnet_suffix, var.defaults.intra_subnet_suffix, \"intra\")\n  intra_subnet_tags                                           = try(each.value.intra_subnet_tags, var.defaults.intra_subnet_tags, {})\n  intra_subnets                                               = try(each.value.intra_subnets, var.defaults.intra_subnets, [])\n  ipv4_ipam_pool_id                                           = try(each.value.ipv4_ipam_pool_id, var.defaults.ipv4_ipam_pool_id, null)\n  ipv4_netmask_length                                         = try(each.value.ipv4_netmask_length, var.defaults.ipv4_netmask_length, null)\n  ipv6_cidr                                                   = try(each.value.ipv6_cidr, var.defaults.ipv6_cidr, null)\n  ipv6_cidr_block_network_border_group                        = try(each.value.ipv6_cidr_block_network_border_group, var.defaults.ipv6_cidr_block_network_border_group, null)\n  ipv6_ipam_pool_id                                           = try(each.value.ipv6_ipam_pool_id, var.defaults.ipv6_ipam_pool_id, null)\n  ipv6_netmask_length                                         = try(each.value.ipv6_netmask_length, var.defaults.ipv6_netmask_length, null)\n  manage_default_network_acl                                  = try(each.value.manage_default_network_acl, var.defaults.manage_default_network_acl, true)\n  manage_default_route_table                                  = try(each.value.manage_default_route_table, var.defaults.manage_default_route_table, true)\n  manage_default_security_group                               = try(each.value.manage_default_security_group, var.defaults.manage_default_security_group, true)\n  manage_default_vpc                                          = try(each.value.manage_default_vpc, var.defaults.manage_default_vpc, false)\n  map_customer_owned_ip_on_launch                             = try(each.value.map_customer_owned_ip_on_launch, var.defaults.map_customer_owned_ip_on_launch, false)\n  map_public_ip_on_launch                                     = try(each.value.map_public_ip_on_launch, var.defaults.map_public_ip_on_launch, false)\n  name                                                        = try(each.value.name, var.defaults.name, \"\")\n  nat_eip_tags                                                = try(each.value.nat_eip_tags, var.defaults.nat_eip_tags, {})\n  nat_gateway_destination_cidr_block                          = try(each.value.nat_gateway_destination_cidr_block, var.defaults.nat_gateway_destination_cidr_block, \"0.0.0.0/0\")\n  nat_gateway_tags                                            = try(each.value.nat_gateway_tags, var.defaults.nat_gateway_tags, {})\n  one_nat_gateway_per_az                                      = try(each.value.one_nat_gateway_per_az, var.defaults.one_nat_gateway_per_az, false)\n  outpost_acl_tags                                            = try(each.value.outpost_acl_tags, var.defaults.outpost_acl_tags, {})\n  outpost_arn                                                 = try(each.value.outpost_arn, var.defaults.outpost_arn, null)\n  outpost_az                                                  = try(each.value.outpost_az, var.defaults.outpost_az, null)\n  outpost_dedicated_network_acl                               = try(each.value.outpost_dedicated_network_acl, var.defaults.outpost_dedicated_network_acl, false)\n  outpost_inbound_acl_rules = try(each.value.outpost_inbound_acl_rules, var.defaults.outpost_inbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  outpost_outbound_acl_rules = try(each.value.outpost_outbound_acl_rules, var.defaults.outpost_outbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  outpost_subnet_assign_ipv6_address_on_creation                = try(each.value.outpost_subnet_assign_ipv6_address_on_creation, var.defaults.outpost_subnet_assign_ipv6_address_on_creation, false)\n  outpost_subnet_enable_dns64                                   = try(each.value.outpost_subnet_enable_dns64, var.defaults.outpost_subnet_enable_dns64, true)\n  outpost_subnet_enable_resource_name_dns_a_record_on_launch    = try(each.value.outpost_subnet_enable_resource_name_dns_a_record_on_launch, var.defaults.outpost_subnet_enable_resource_name_dns_a_record_on_launch, false)\n  outpost_subnet_enable_resource_name_dns_aaaa_record_on_launch = try(each.value.outpost_subnet_enable_resource_name_dns_aaaa_record_on_launch, var.defaults.outpost_subnet_enable_resource_name_dns_aaaa_record_on_launch, true)\n  outpost_subnet_ipv6_native                                    = try(each.value.outpost_subnet_ipv6_native, var.defaults.outpost_subnet_ipv6_native, false)\n  outpost_subnet_ipv6_prefixes                                  = try(each.value.outpost_subnet_ipv6_prefixes, var.defaults.outpost_subnet_ipv6_prefixes, [])\n  outpost_subnet_names                                          = try(each.value.outpost_subnet_names, var.defaults.outpost_subnet_names, [])\n  outpost_subnet_private_dns_hostname_type_on_launch            = try(each.value.outpost_subnet_private_dns_hostname_type_on_launch, var.defaults.outpost_subnet_private_dns_hostname_type_on_launch, null)\n  outpost_subnet_suffix                                         = try(each.value.outpost_subnet_suffix, var.defaults.outpost_subnet_suffix, \"outpost\")\n  outpost_subnet_tags                                           = try(each.value.outpost_subnet_tags, var.defaults.outpost_subnet_tags, {})\n  outpost_subnets                                               = try(each.value.outpost_subnets, var.defaults.outpost_subnets, [])\n  private_acl_tags                                              = try(each.value.private_acl_tags, var.defaults.private_acl_tags, {})\n  private_dedicated_network_acl                                 = try(each.value.private_dedicated_network_acl, var.defaults.private_dedicated_network_acl, false)\n  private_inbound_acl_rules = try(each.value.private_inbound_acl_rules, var.defaults.private_inbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  private_outbound_acl_rules = try(each.value.private_outbound_acl_rules, var.defaults.private_outbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  private_route_table_tags                                      = try(each.value.private_route_table_tags, var.defaults.private_route_table_tags, {})\n  private_subnet_assign_ipv6_address_on_creation                = try(each.value.private_subnet_assign_ipv6_address_on_creation, var.defaults.private_subnet_assign_ipv6_address_on_creation, false)\n  private_subnet_enable_dns64                                   = try(each.value.private_subnet_enable_dns64, var.defaults.private_subnet_enable_dns64, true)\n  private_subnet_enable_resource_name_dns_a_record_on_launch    = try(each.value.private_subnet_enable_resource_name_dns_a_record_on_launch, var.defaults.private_subnet_enable_resource_name_dns_a_record_on_launch, false)\n  private_subnet_enable_resource_name_dns_aaaa_record_on_launch = try(each.value.private_subnet_enable_resource_name_dns_aaaa_record_on_launch, var.defaults.private_subnet_enable_resource_name_dns_aaaa_record_on_launch, true)\n  private_subnet_ipv6_native                                    = try(each.value.private_subnet_ipv6_native, var.defaults.private_subnet_ipv6_native, false)\n  private_subnet_ipv6_prefixes                                  = try(each.value.private_subnet_ipv6_prefixes, var.defaults.private_subnet_ipv6_prefixes, [])\n  private_subnet_names                                          = try(each.value.private_subnet_names, var.defaults.private_subnet_names, [])\n  private_subnet_private_dns_hostname_type_on_launch            = try(each.value.private_subnet_private_dns_hostname_type_on_launch, var.defaults.private_subnet_private_dns_hostname_type_on_launch, null)\n  private_subnet_suffix                                         = try(each.value.private_subnet_suffix, var.defaults.private_subnet_suffix, \"private\")\n  private_subnet_tags                                           = try(each.value.private_subnet_tags, var.defaults.private_subnet_tags, {})\n  private_subnet_tags_per_az                                    = try(each.value.private_subnet_tags_per_az, var.defaults.private_subnet_tags_per_az, {})\n  private_subnets                                               = try(each.value.private_subnets, var.defaults.private_subnets, [])\n  propagate_intra_route_tables_vgw                              = try(each.value.propagate_intra_route_tables_vgw, var.defaults.propagate_intra_route_tables_vgw, false)\n  propagate_private_route_tables_vgw                            = try(each.value.propagate_private_route_tables_vgw, var.defaults.propagate_private_route_tables_vgw, false)\n  propagate_public_route_tables_vgw                             = try(each.value.propagate_public_route_tables_vgw, var.defaults.propagate_public_route_tables_vgw, false)\n  public_acl_tags                                               = try(each.value.public_acl_tags, var.defaults.public_acl_tags, {})\n  public_dedicated_network_acl                                  = try(each.value.public_dedicated_network_acl, var.defaults.public_dedicated_network_acl, false)\n  public_inbound_acl_rules = try(each.value.public_inbound_acl_rules, var.defaults.public_inbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  public_outbound_acl_rules = try(each.value.public_outbound_acl_rules, var.defaults.public_outbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  public_route_table_tags                                      = try(each.value.public_route_table_tags, var.defaults.public_route_table_tags, {})\n  public_subnet_assign_ipv6_address_on_creation                = try(each.value.public_subnet_assign_ipv6_address_on_creation, var.defaults.public_subnet_assign_ipv6_address_on_creation, false)\n  public_subnet_enable_dns64                                   = try(each.value.public_subnet_enable_dns64, var.defaults.public_subnet_enable_dns64, true)\n  public_subnet_enable_resource_name_dns_a_record_on_launch    = try(each.value.public_subnet_enable_resource_name_dns_a_record_on_launch, var.defaults.public_subnet_enable_resource_name_dns_a_record_on_launch, false)\n  public_subnet_enable_resource_name_dns_aaaa_record_on_launch = try(each.value.public_subnet_enable_resource_name_dns_aaaa_record_on_launch, var.defaults.public_subnet_enable_resource_name_dns_aaaa_record_on_launch, true)\n  public_subnet_ipv6_native                                    = try(each.value.public_subnet_ipv6_native, var.defaults.public_subnet_ipv6_native, false)\n  public_subnet_ipv6_prefixes                                  = try(each.value.public_subnet_ipv6_prefixes, var.defaults.public_subnet_ipv6_prefixes, [])\n  public_subnet_names                                          = try(each.value.public_subnet_names, var.defaults.public_subnet_names, [])\n  public_subnet_private_dns_hostname_type_on_launch            = try(each.value.public_subnet_private_dns_hostname_type_on_launch, var.defaults.public_subnet_private_dns_hostname_type_on_launch, null)\n  public_subnet_suffix                                         = try(each.value.public_subnet_suffix, var.defaults.public_subnet_suffix, \"public\")\n  public_subnet_tags                                           = try(each.value.public_subnet_tags, var.defaults.public_subnet_tags, {})\n  public_subnet_tags_per_az                                    = try(each.value.public_subnet_tags_per_az, var.defaults.public_subnet_tags_per_az, {})\n  public_subnets                                               = try(each.value.public_subnets, var.defaults.public_subnets, [])\n  putin_khuylo                                                 = try(each.value.putin_khuylo, var.defaults.putin_khuylo, true)\n  redshift_acl_tags                                            = try(each.value.redshift_acl_tags, var.defaults.redshift_acl_tags, {})\n  redshift_dedicated_network_acl                               = try(each.value.redshift_dedicated_network_acl, var.defaults.redshift_dedicated_network_acl, false)\n  redshift_inbound_acl_rules = try(each.value.redshift_inbound_acl_rules, var.defaults.redshift_inbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  redshift_outbound_acl_rules = try(each.value.redshift_outbound_acl_rules, var.defaults.redshift_outbound_acl_rules, [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ])\n  redshift_route_table_tags                                      = try(each.value.redshift_route_table_tags, var.defaults.redshift_route_table_tags, {})\n  redshift_subnet_assign_ipv6_address_on_creation                = try(each.value.redshift_subnet_assign_ipv6_address_on_creation, var.defaults.redshift_subnet_assign_ipv6_address_on_creation, false)\n  redshift_subnet_enable_dns64                                   = try(each.value.redshift_subnet_enable_dns64, var.defaults.redshift_subnet_enable_dns64, true)\n  redshift_subnet_enable_resource_name_dns_a_record_on_launch    = try(each.value.redshift_subnet_enable_resource_name_dns_a_record_on_launch, var.defaults.redshift_subnet_enable_resource_name_dns_a_record_on_launch, false)\n  redshift_subnet_enable_resource_name_dns_aaaa_record_on_launch = try(each.value.redshift_subnet_enable_resource_name_dns_aaaa_record_on_launch, var.defaults.redshift_subnet_enable_resource_name_dns_aaaa_record_on_launch, true)\n  redshift_subnet_group_name                                     = try(each.value.redshift_subnet_group_name, var.defaults.redshift_subnet_group_name, null)\n  redshift_subnet_group_tags                                     = try(each.value.redshift_subnet_group_tags, var.defaults.redshift_subnet_group_tags, {})\n  redshift_subnet_ipv6_native                                    = try(each.value.redshift_subnet_ipv6_native, var.defaults.redshift_subnet_ipv6_native, false)\n  redshift_subnet_ipv6_prefixes                                  = try(each.value.redshift_subnet_ipv6_prefixes, var.defaults.redshift_subnet_ipv6_prefixes, [])\n  redshift_subnet_names                                          = try(each.value.redshift_subnet_names, var.defaults.redshift_subnet_names, [])\n  redshift_subnet_private_dns_hostname_type_on_launch            = try(each.value.redshift_subnet_private_dns_hostname_type_on_launch, var.defaults.redshift_subnet_private_dns_hostname_type_on_launch, null)\n  redshift_subnet_suffix                                         = try(each.value.redshift_subnet_suffix, var.defaults.redshift_subnet_suffix, \"redshift\")\n  redshift_subnet_tags                                           = try(each.value.redshift_subnet_tags, var.defaults.redshift_subnet_tags, {})\n  redshift_subnets                                               = try(each.value.redshift_subnets, var.defaults.redshift_subnets, [])\n  region                                                         = try(each.value.region, var.defaults.region, null)\n  reuse_nat_ips                                                  = try(each.value.reuse_nat_ips, var.defaults.reuse_nat_ips, false)\n  secondary_cidr_blocks                                          = try(each.value.secondary_cidr_blocks, var.defaults.secondary_cidr_blocks, [])\n  single_nat_gateway                                             = try(each.value.single_nat_gateway, var.defaults.single_nat_gateway, false)\n  tags                                                           = try(each.value.tags, var.defaults.tags, {})\n  use_ipam_pool                                                  = try(each.value.use_ipam_pool, var.defaults.use_ipam_pool, false)\n  vpc_block_public_access_exclusions                             = try(each.value.vpc_block_public_access_exclusions, var.defaults.vpc_block_public_access_exclusions, {})\n  vpc_block_public_access_options                                = try(each.value.vpc_block_public_access_options, var.defaults.vpc_block_public_access_options, {})\n  vpc_flow_log_iam_policy_name                                   = try(each.value.vpc_flow_log_iam_policy_name, var.defaults.vpc_flow_log_iam_policy_name, \"vpc-flow-log-to-cloudwatch\")\n  vpc_flow_log_iam_policy_use_name_prefix                        = try(each.value.vpc_flow_log_iam_policy_use_name_prefix, var.defaults.vpc_flow_log_iam_policy_use_name_prefix, true)\n  vpc_flow_log_iam_role_name                                     = try(each.value.vpc_flow_log_iam_role_name, var.defaults.vpc_flow_log_iam_role_name, \"vpc-flow-log-role\")\n  vpc_flow_log_iam_role_path                                     = try(each.value.vpc_flow_log_iam_role_path, var.defaults.vpc_flow_log_iam_role_path, null)\n  vpc_flow_log_iam_role_use_name_prefix                          = try(each.value.vpc_flow_log_iam_role_use_name_prefix, var.defaults.vpc_flow_log_iam_role_use_name_prefix, true)\n  vpc_flow_log_permissions_boundary                              = try(each.value.vpc_flow_log_permissions_boundary, var.defaults.vpc_flow_log_permissions_boundary, null)\n  vpc_flow_log_tags                                              = try(each.value.vpc_flow_log_tags, var.defaults.vpc_flow_log_tags, {})\n  vpc_tags                                                       = try(each.value.vpc_tags, var.defaults.vpc_tags, {})\n  vpn_gateway_az                                                 = try(each.value.vpn_gateway_az, var.defaults.vpn_gateway_az, null)\n  vpn_gateway_id                                                 = try(each.value.vpn_gateway_id, var.defaults.vpn_gateway_id, \"\")\n  vpn_gateway_tags                                               = try(each.value.vpn_gateway_tags, var.defaults.vpn_gateway_tags, {})\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-vpc__wrappers__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"vmss_public_ip\" {\n  value = \"${azurerm_public_ip.vmss.fqdn}\"\n}\n\noutput \"jumpbox_public_ip\" {\n  value = \"${azurerm_public_ip.jumpbox.fqdn}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__awesome-terraform__codelab-vmss__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source = \"hashicorp/aws\"\n      version = \"5.48.0\"\n    }\n  }\n}\n\n#provide authentication here\nprovider \"aws\" {\n  region = \"us-east-1\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daws-78s__terraform__count__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.0.0\"\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.1.0\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# create ci/cd user with access keys (for build system)\nresource \"aws_iam_user\" \"cicd\" {\n  name = \"srv_${var.app}_${var.environment}_cicd\"\n}\n\nresource \"aws_iam_access_key\" \"cicd_keys\" {\n  user = aws_iam_user.cicd.name\n}\n\n# grant required permissions to deploy\ndata \"aws_iam_policy_document\" \"cicd_policy\" {\n  # allows user to push/pull to the registry\n  statement {\n    sid = \"ecr\"\n\n    actions = [\n      \"ecr:GetDownloadUrlForLayer\",\n      \"ecr:BatchGetImage\",\n      \"ecr:BatchCheckLayerAvailability\",\n      \"ecr:PutImage\",\n      \"ecr:InitiateLayerUpload\",\n      \"ecr:UploadLayerPart\",\n      \"ecr:CompleteLayerUpload\",\n    ]\n\n    resources = [\n      data.aws_ecr_repository.ecr.arn,\n    ]\n  }\n\n  # allows user to deploy to ecs\n  statement {\n    sid = \"ecs\"\n\n    actions = [\n      \"ecr:GetAuthorizationToken\",\n      \"ecs:DescribeServices\",\n      \"ecs:DescribeTaskDefinition\",\n      \"ecs:UpdateService\",\n      \"ecs:RegisterTaskDefinition\",\n    ]\n\n    resources = [\n      \"*\",\n    ]\n  }\n\n  # allows user to run ecs task using task execution and app roles\n  statement {\n    sid = \"approle\"\n\n    actions = [\n      \"iam:PassRole\",\n    ]\n\n    resources = [\n      aws_iam_role.app_role.arn,\n      aws_iam_role.ecsTaskExecutionRole.arn,\n    ]\n  }\n}\n\nresource \"aws_iam_user_policy\" \"cicd_user_policy\" {\n  name   = \"${var.app}_${var.environment}_cicd\"\n  user   = aws_iam_user.cicd.name\n  policy = data.aws_iam_policy_document.cicd_policy.json\n}\n\ndata \"aws_ecr_repository\" \"ecr\" {\n  name = var.app\n}\n\n# The AWS keys for the CICD user to use in a build system\noutput \"cicd_keys\" {\n  value = \"terraform show -json | jq '.values.root_module.resources | .[] | select ( .address == \\\"aws_iam_access_key.cicd_keys\\\") | { AWS_ACCESS_KEY_ID: .values.id, AWS_SECRET_ACCESS_KEY: .values.secret }'\"\n}\n\n# The URL for the docker image repo in ECR\noutput \"docker_registry\" {\n  value = data.aws_ecr_repository.ecr.repository_url\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/turnerlabs__terraform-ecs-fargate__env__dev__cicd.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_111", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/turnerlabs__terraform-ecs-fargate__env__dev__cicd.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_356", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/turnerlabs__terraform-ecs-fargate__env__dev__cicd.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/turnerlabs__terraform-ecs-fargate__env__dev__cicd.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_acm_certificate\" \"cert\" {\n  domain_name               = var.domain_name #\"example.com\"\n  subject_alternative_names = var.additional_domain_names\n  validation_method         = var.validation_method #\"DNS\"\n\n  tags = merge(\n    { \"resourcename\" = \"${var.name}-cert\" }, var.tags\n  )\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/e2eSolutionArchitect__terraform__providers__aws__modules__e2esa-module-aws-acm__acm.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"application_gateway_waf_policies\" {\n  source   = \"./modules/networking/application_gateway_waf_policies\"\n  for_each = local.networking.application_gateway_waf_policies\n\n  global_settings     = local.global_settings\n  settings            = each.value\n  base_tags           = local.global_settings.inherit_tags\n  resource_group      = local.combined_objects_resource_groups[try(each.value.resource_group.lz_key, local.client_config.landingzone_key)][try(each.value.resource_group_key, each.value.resource_group.key)]\n  resource_group_name = can(each.value.resource_group.name) || can(each.value.resource_group_name) ? try(each.value.resource_group.name, each.value.resource_group_name) : null\n  location            = try(local.global_settings.regions[each.value.region], null)\n}\n\noutput \"application_gateway_waf_policies\" {\n  value = module.application_gateway_waf_policies\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aztfmod__terraform-azurerm-caf__application_gateway_waf_policies.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"ap-south-1\"  # Update with your preferred region\n}\n\nresource \"aws_eks_cluster\" \"ekscluster\" {\n  name     = \"batch17\"\n  role_arn = aws_iam_role.EksClusterRole.arn\n  vpc_config {\n    subnet_ids = [\"subnet-06d716c8e955c6113\", \"subnet-0dac379e2dcccd0ab\", \"subnet-06cc9a093404f7375\"]\n  }\n\n  # Ensure that IAM Role permissions are created before and deleted after EKS Cluster handling.\n  # Otherwise, EKS will not be able to properly delete EKS managed EC2 infrastructure such as Security Groups.\n}\n\noutput \"endpoint\" {\n  value = aws_eks_cluster.ekscluster.endpoint\n}\n\noutput \"kubeconfig-certificate-authority-data\" {\n  value = aws_eks_cluster.ekscluster.certificate_authority[0].data\n}\n\ndata \"aws_iam_policy_document\" \"assume_role\" {\n  statement {\n    effect = \"Allow\"\n\n    principals {\n      type        = \"Service\"\n      identifiers = [\"eks.amazonaws.com\"]\n    }\n\n    actions = [\"sts:AssumeRole\"]\n  }\n}\n\nresource \"aws_iam_role\" \"EksClusterRole\" {\n  name               = \"eks-cluster-role\"\n  assume_role_policy = data.aws_iam_policy_document.assume_role.json\n  managed_policy_arns = [\"arn:aws:iam::aws:policy/AmazonEKSClusterPolicy\"]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__eks__controlplane.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_37", "severity": "HIGH", "message": "Ensure Amazon EKS control plane logging is enabled for all log types", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__eks__controlplane.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_39", "severity": "HIGH", "message": "Ensure Amazon EKS public endpoint disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__eks__controlplane.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_38", "severity": "HIGH", "message": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__eks__controlplane.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_58", "severity": "HIGH", "message": "Ensure EKS Cluster has Secrets Encryption Enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__eks__controlplane.tf", "start_line": 5}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"application_security_groups\" {\n  source = \"./modules/networking/application_security_group\"\n\n  for_each = local.networking.application_security_groups\n\n  settings        = each.value\n  global_settings = local.global_settings\n\n  base_tags           = local.global_settings.inherit_tags\n  resource_group      = local.combined_objects_resource_groups[try(each.value.resource_group.lz_key, local.client_config.landingzone_key)][try(each.value.resource_group_key, each.value.resource_group.key)]\n  resource_group_name = can(each.value.resource_group.name) || can(each.value.resource_group_name) ? try(each.value.resource_group.name, each.value.resource_group_name) : null\n  location            = try(local.global_settings.regions[each.value.region], null)\n\n}\n\noutput \"application_security_groups\" {\n  value = module.application_security_groups\n\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aztfmod__terraform-azurerm-caf__application_security_groups.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Generate self-signed TLS certificates. Unlike @kelseyhightower's original\n# demo, this does not use cfssl and uses Terraform's internals instead.\nresource \"tls_private_key\" \"vault-ca\" {\n  algorithm = \"RSA\"\n  rsa_bits  = \"2048\"\n}\n\nresource \"tls_self_signed_cert\" \"vault-ca\" {\n  key_algorithm   = tls_private_key.vault-ca.algorithm\n  private_key_pem = tls_private_key.vault-ca.private_key_pem\n\n  subject {\n    common_name  = \"vault-ca.local\"\n    organization = \"HashiCorp Vault\"\n  }\n\n  validity_period_hours = 8760\n  is_ca_certificate     = true\n\n  allowed_uses = [\n    \"cert_signing\",\n    \"digital_signature\",\n    \"key_encipherment\",\n  ]\n\n  provisioner \"local-exec\" {\n    command = \"echo '${self.cert_pem}' > ../tls/ca.pem && chmod 0600 ../tls/ca.pem\"\n  }\n}\n\n# Create the Vault server certificates\nresource \"tls_private_key\" \"vault\" {\n  algorithm = \"RSA\"\n  rsa_bits  = \"2048\"\n}\n\n# Create the request to sign the cert with our CA\nresource \"tls_cert_request\" \"vault\" {\n  key_algorithm   = tls_private_key.vault.algorithm\n  private_key_pem = tls_private_key.vault.private_key_pem\n\n  dns_names = [\n    \"vault\",\n    \"vault.local\",\n    \"vault.default.svc.cluster.local\",\n  ]\n\n  ip_addresses = [\n    google_compute_address.vault.address,\n  ]\n\n  subject {\n    common_name  = \"vault.local\"\n    organization = \"HashiCorp Vault\"\n  }\n}\n\n# Now sign the cert\nresource \"tls_locally_signed_cert\" \"vault\" {\n  cert_request_pem = tls_cert_request.vault.cert_request_pem\n\n  ca_key_algorithm   = tls_private_key.vault-ca.algorithm\n  ca_private_key_pem = tls_private_key.vault-ca.private_key_pem\n  ca_cert_pem        = tls_self_signed_cert.vault-ca.cert_pem\n\n  validity_period_hours = 8760\n\n  allowed_uses = [\n    \"cert_signing\",\n    \"client_auth\",\n    \"digital_signature\",\n    \"key_encipherment\",\n    \"server_auth\",\n  ]\n\n  provisioner \"local-exec\" {\n    command = \"echo '${self.cert_pem}' > ../tls/vault.pem && echo '${tls_self_signed_cert.vault-ca.cert_pem}' >> ../tls/vault.pem && chmod 0600 ../tls/vault.pem\"\n  }\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sethvargo__vault-on-gke__terraform__tls.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# dev \n\nmodule \"dev-app\" {\n    source = \"./my_app_infra_module\"\n    my_env = \"dev\"\n    instance_type = \"t2.micro\"\n    ami = \"ami-007855ac798b5175e\" \n}\n\n#prd\nmodule \"prd-app\" {\n    source = \"./my_app_infra_module\"\n    my_env = \"prd\"\n    instance_type = \"t2.medium\"\n    ami = \"ami-007855ac798b5175e\" \n}\n\n#stg\nmodule \"stg-app\" {\n    source = \"./my_app_infra_module\"\n    my_env = \"stg\"\n    instance_type = \"t2.small\"\n    ami = \"ami-007855ac798b5175e\" \n  \n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__terraform-advanced__aws_module_project__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nterraform {\n  backend \"azurerm\" {\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__7-azure-devops-workspaces__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"logger_interfaces\" {\n  value = esxi_guest.logger.network_interfaces\n}\n\noutput \"logger_ips\" {\n  value = esxi_guest.logger.ip_address\n}\n\noutput \"dc_interfaces\" {\n  value = esxi_guest.dc.network_interfaces\n}\n\noutput \"dc_ips\" {\n  value = esxi_guest.dc.ip_address\n}\n\noutput \"wef_interfaces\" {\n  value = esxi_guest.wef.network_interfaces\n}\n\noutput \"wef_ips\" {\n  value = esxi_guest.wef.ip_address\n}\n\noutput \"win10_interfaces\" {\n  value = esxi_guest.win10.network_interfaces\n}\n\noutput \"win10_ips\" {\n  value = esxi_guest.win10.ip_address\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/clong__DetectionLab__ESXi__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_security_group\" \"web\" {\n  name        = \"Web\"\n  description = \"Allow public inbound traffic\"\n  vpc_id      = aws_vpc.this.id\n\n  ingress {\n    from_port   = 80 # http\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443 # https\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = -1\n    to_port     = -1\n    protocol    = \"icmp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 3306\n    to_port     = 3306\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_subnet.this[\"pvt_a\"].cidr_block]\n  }\n\n  tags = merge(local.common_tags, { Name = \"Web Server\" })\n}\n\nresource \"aws_security_group\" \"db\" {\n  name        = \"DB\"\n  description = \"Allow incoming database connections\"\n  vpc_id      = aws_vpc.this.id\n\n  ingress {\n    from_port       = 3306\n    to_port         = 3306\n    protocol        = \"tcp\"\n    security_groups = [aws_security_group.web.id]\n  }\n\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.this.cidr_block]\n  }\n\n  ingress {\n    from_port   = -1\n    to_port     = -1\n    protocol    = \"icmp\"\n    cidr_blocks = [aws_vpc.this.cidr_block]\n  }\n\n  egress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(local.common_tags, { Name = \"Database MySQL\" })\n}\n\nresource \"aws_security_group\" \"alb\" {\n  name        = \"ALB-SG\"\n  description = \"Load Balancer SG\"\n  vpc_id      = aws_vpc.this.id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(local.common_tags, { Name = \"Load Balancer\" })\n}\n\nresource \"aws_security_group\" \"autoscaling\" {\n  name        = \"autoscaling\"\n  description = \"Security group that allows ssh/http and all egress traffic\"\n  vpc_id      = aws_vpc.this.id\n\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port       = 80\n    to_port         = 80\n    protocol        = \"tcp\"\n    security_groups = [aws_security_group.alb.id]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(local.common_tags, { Name = \"Auto Scaling\" })\n}\n\nresource \"aws_security_group\" \"jenkins\" {\n  name        = \"Jenkins\"\n  description = \"Allow incoming connections to Jenkins machine\"\n  vpc_id      = aws_vpc.this.id\n\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.this.cidr_block]\n  }\n\n  ingress {\n    from_port   = -1\n    to_port     = -1\n    protocol    = \"icmp\"\n    cidr_blocks = [aws_vpc.this.cidr_block]\n  }\n\n  egress {\n    from_port       = 22\n    to_port         = 22\n    protocol        = \"tcp\"\n    security_groups = [aws_security_group.web.id]\n  }\n\n  tags = merge(local.common_tags, { Name = \"Jenkins Machine\" })\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_277", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 80}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 80}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 80}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 102}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 102}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 102}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 131}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 37}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 80}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 102}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/chgasparoto__curso-aws-com-terraform__05-autoscaling-app__security_group.tf", "start_line": 131}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n#  access_key = \"${var.aws_access_key}\"\n#  secret_key = \"${var.aws_secret_key}\"\n  region     = \"us-east-1\"\n  version = \"~> 1.25\"\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vivekyad4v__terraform__terraform-l2-interpolation__aws-provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"6.16.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = var.allowed_locations[0]\n\n  default_tags {\n    tags = {\n      Project     = \"Terraform-Full-Course-AWS\"\n      Day         = \"07\"\n      Topic       = \"Type-Constraints\"\n      ManagedBy   = \"Terraform\"\n      Environment = var.environment\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/piyushsachdeva__Terraform-Full-Course-Aws__lessons__day07__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_lb\" \"alb\" {\n  name = \"${var.orgname}-${var.environ}-alb\"\n  internal           = false\n  load_balancer_type = \"application\"\n  security_groups    = [\"${aws_security_group.sg_alb.id}\"]\n  subnets            = [\"${data.aws_subnet.public.*.id}\"]\n  enable_deletion_protection = false\n\n  tags = \"${merge(map(\"Name\", format(\"%s-%s-alb\", var.orgname, var.environ)), var.tags)}\"\n}\n\nresource \"aws_lb_target_group\" \"alb_tg\" {\n  name = \"${var.orgname}-${var.environ}-alb-tg\"\n  port      = \"80\"\n  protocol  = \"HTTP\"\n  vpc_id    = \"${aws_vpc.myvpc.id}\"\n  deregistration_delay = 60\n  health_check {\n    healthy_threshold   = 2\n    interval            = 15\n    path                = \"/\"\n    timeout             = 10\n    unhealthy_threshold = 2\n    matcher             = \"200-499\"\n    }\n\n  tags = \"${merge(map(\"Name\", format(\"%s-%s-alb-tg\", var.orgname, var.environ)), var.tags)}\"\n}\n\nresource \"aws_lb_listener\" \"alb_lis\" {\n  load_balancer_arn = \"${aws_lb.alb.arn}\"\n  port              = \"80\"\n  protocol          = \"HTTP\"\n  default_action {\n    target_group_arn = \"${aws_lb_target_group.alb_tg.arn}\"\n    type             = \"forward\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vivekyad4v__terraform__terraform-l2-interpolation__alb.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_131", "severity": "HIGH", "message": "Ensure that ALB drops HTTP headers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vivekyad4v__terraform__terraform-l2-interpolation__alb.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_91", "severity": "HIGH", "message": "Ensure the ELBv2 (Application/Network) has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vivekyad4v__terraform__terraform-l2-interpolation__alb.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_150", "severity": "HIGH", "message": "Ensure that Load Balancer has deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vivekyad4v__terraform__terraform-l2-interpolation__alb.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_2", "severity": "HIGH", "message": "Ensure ALB protocol is HTTPS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vivekyad4v__terraform__terraform-l2-interpolation__alb.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV2_AWS_20", "severity": "CRITICAL", "message": "Ensure that ALB redirects HTTP requests into HTTPS ones", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vivekyad4v__terraform__terraform-l2-interpolation__alb.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_28", "severity": "CRITICAL", "message": "Ensure public facing ALB are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vivekyad4v__terraform__terraform-l2-interpolation__alb.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_103", "severity": "HIGH", "message": "Ensure that load balancer is using at least TLS 1.2", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vivekyad4v__terraform__terraform-l2-interpolation__alb.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AWS_378", "severity": "HIGH", "message": "Ensure AWS Load Balancer doesn't use HTTP protocol", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/vivekyad4v__terraform__terraform-l2-interpolation__alb.tf", "start_line": 12}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_availability_zones\" \"azs\" {}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/gauri17-pro__terraform-jenkins-eks__EKS__data.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region     = \"ap-south-1\"\n}\n\n#security group\nresource \"aws_security_group\" \"webserver_access\" {\n        name = \"webserver_access\"\n        description = \"allow ssh and http\"\n\n        ingress {\n                from_port = 80\n                to_port = 80\n                protocol = \"tcp\"\n                cidr_blocks = [\"0.0.0.0/0\"]\n        }\n\n        ingress {\n                from_port = 22\n                to_port = 22\n                protocol = \"tcp\"\n                cidr_blocks = [\"0.0.0.0/0\"]\n        }\n\n        egress {\n                from_port = 0\n                to_port = 0\n                protocol = \"-1\"\n                cidr_blocks = [\"0.0.0.0/0\"]\n        }\n\n\n}\n#security group end here\n\n#create block storage\nresource \"aws_ebs_volume\" \"data_vol\" {\n        availability_zone = \"ap-south-1a\"\n        size = 5\n}\n\nresource \"aws_volume_attachment\" \"ourfirst-vol\" {\n        device_name = \"/dev/sdc\"\n        volume_id = \"${aws_ebs_volume.data_vol.id}\"\n        instance_id = \"${aws_instance.ourfirst.id}\"\n}\n\n#block storage end here\nresource \"aws_instance\" \"ourfirst\" {\n  ami           = \"ami-0447a12f28fddb066\"\n  availability_zone = \"ap-south-1a\"\n  instance_type = \"t2.micro\"\n  security_groups = [\"${aws_security_group.webserver_access.name}\"]\n  key_name = \"zoomkey\"\n  tags = {\n    Name  = \"hello-terraform\"\n    Stage = \"testing\"\n    Location = \"USA\"\n  }\n\n}\n\n/*\nnow run\nterraform validate\nterraform plan\nterraform apply\nThen...\nssh into the instance and check the block device\nusing \"lsblk\" command\nWhen done ... destroy using\nterraform destroy\n*/\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_3", "severity": "HIGH", "message": "Ensure all data stored in the EBS is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_AWS_189", "severity": "HIGH", "message": "Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 36}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV2_AWS_2", "severity": "CRITICAL", "message": "Ensure that only encrypted EBS volumes are attached to EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__ec2-instance-with-ebs-volume.tf", "start_line": 36}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n##################\n# Lambda Function\n##################\noutput \"this_lambda_function_arn\" {\n  description = \"The ARN of the Lambda Function\"\n  value       = module.lambda.this_lambda_function_arn\n}\n\noutput \"this_lambda_function_invoke_arn\" {\n  description = \"The Invoke ARN of the Lambda Function\"\n  value       = module.lambda.this_lambda_function_invoke_arn\n}\n\noutput \"this_lambda_function_name\" {\n  description = \"The name of the Lambda Function\"\n  value       = module.lambda.this_lambda_function_name\n}\n\noutput \"this_lambda_function_qualified_arn\" {\n  description = \"The ARN identifying your Lambda Function Version\"\n  value       = module.lambda.this_lambda_function_qualified_arn\n}\n\noutput \"this_lambda_function_version\" {\n  description = \"Latest published version of Lambda Function\"\n  value       = module.lambda.this_lambda_function_version\n}\n\noutput \"this_lambda_function_last_modified\" {\n  description = \"The date Lambda Function resource was last modified\"\n  value       = module.lambda.this_lambda_function_last_modified\n}\n\noutput \"this_lambda_function_kms_key_arn\" {\n  description = \"The ARN for the KMS encryption key of Lambda Function\"\n  value       = module.lambda.this_lambda_function_kms_key_arn\n}\n\noutput \"this_lambda_function_source_code_hash\" {\n  description = \"Base64-encoded representation of raw SHA-256 sum of the zip file\"\n  value       = module.lambda.this_lambda_function_source_code_hash\n}\n\noutput \"this_lambda_function_source_code_size\" {\n  description = \"The size in bytes of the function .zip file\"\n  value       = module.lambda.this_lambda_function_source_code_size\n}\n\n# Lambda Layer\noutput \"this_lambda_layer_arn\" {\n  description = \"The ARN of the Lambda Layer with version\"\n  value       = module.lambda.this_lambda_layer_arn\n}\n\noutput \"this_lambda_layer_layer_arn\" {\n  description = \"The ARN of the Lambda Layer without version\"\n  value       = module.lambda.this_lambda_layer_layer_arn\n}\n\noutput \"this_lambda_layer_created_date\" {\n  description = \"The date Lambda Layer resource was created\"\n  value       = module.lambda.this_lambda_layer_created_date\n}\n\noutput \"this_lambda_layer_source_code_size\" {\n  description = \"The size in bytes of the Lambda Layer .zip file\"\n  value       = module.lambda.this_lambda_layer_source_code_size\n}\n\noutput \"this_lambda_layer_version\" {\n  description = \"The Lambda Layer version\"\n  value       = module.lambda.this_lambda_layer_version\n}\n\n# IAM Role\noutput \"lambda_role_arn\" {\n  description = \"The ARN of the IAM role created for the Lambda Function\"\n  value       = module.lambda.lambda_role_arn\n}\n\noutput \"lambda_role_name\" {\n  description = \"The name of the IAM role created for the Lambda Function\"\n  value       = module.lambda.lambda_role_name\n}\n\n# Deployment package\noutput \"local_filename\" {\n  description = \"The filename of zip archive deployed (if deployment was from local)\"\n  value       = module.lambda.local_filename\n}\n\noutput \"s3_object\" {\n  description = \"The map with S3 object data of zip archive deployed (if deployment was from S3)\"\n  value       = module.lambda.s3_object\n}\n\n###############\n# API Gateway\n###############\noutput \"this_apigatewayv2_api_id\" {\n  description = \"The API identifier\"\n  value       = module.api_gateway.this_apigatewayv2_api_id\n}\n\noutput \"this_apigatewayv2_api_api_endpoint\" {\n  description = \"The URI of the API\"\n  value       = module.api_gateway.this_apigatewayv2_api_api_endpoint\n}\n\noutput \"this_apigatewayv2_api_arn\" {\n  description = \"The ARN of the API\"\n  value       = module.api_gateway.this_apigatewayv2_api_arn\n}\n\noutput \"this_apigatewayv2_api_execution_arn\" {\n  description = \"The ARN prefix to be used in an aws_lambda_permission's source_arn attribute or in an aws_iam_policy to authorize access to the @connections API.\"\n  value       = module.api_gateway.this_apigatewayv2_api_execution_arn\n}\n\noutput \"default_apigatewayv2_stage_execution_arn\" {\n  description = \"The ARN prefix to be used in an aws_lambda_permission's source_arn attribute or in an aws_iam_policy to authorize access to the @connections API.\"\n  value       = module.api_gateway.default_apigatewayv2_stage_execution_arn\n}\n\n\n\n###############\n# Lambda Alias\n###############\noutput \"this_lambda_alias_name\" {\n  description = \"The name of the Lambda Function Alias\"\n  value       = module.lambda_alias.this_lambda_alias_name\n}\n\noutput \"this_lambda_alias_arn\" {\n  description = \"The ARN of the Lambda Function Alias\"\n  value       = module.lambda_alias.this_lambda_alias_arn\n}\n\noutput \"this_lambda_alias_invoke_arn\" {\n  description = \"The ARN to be used for invoking Lambda Function from API Gateway\"\n  value       = module.lambda_alias.this_lambda_alias_invoke_arn\n}\n\noutput \"this_lambda_alias_description\" {\n  description = \"Description of alias\"\n  value       = module.lambda_alias.this_lambda_alias_description\n}\n\noutput \"this_lambda_alias_function_version\" {\n  description = \"Lambda function version which the alias uses\"\n  value       = module.lambda_alias.this_lambda_alias_function_version\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terragrunt-reference-architecture__acme-serverless__tmp__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"random_pet\" \"pet\" {}\n\noutput \"pet\" {\n  value = random_pet.pet.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__setup-terraform__.github__workflows__data__local__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = local.region\n}\n\ndata \"aws_availability_zones\" \"available\" {}\n\nlocals {\n  name   = \"ex-${basename(path.cwd)}\"\n  region = \"eu-west-1\"\n\n  vpc_cidr = \"10.0.0.0/16\"\n  azs      = slice(data.aws_availability_zones.available.names, 0, 3)\n\n  tags = {\n    Name       = local.name\n    Example    = local.name\n    Repository = \"https://github.com/terraform-aws-modules/terraform-aws-ec2-instance\"\n  }\n}\n\n################################################################################\n# EC2 Module\n################################################################################\n\nmodule \"ec2\" {\n  source = \"../../\"\n\n  name = local.name\n\n  subnet_id = element(module.vpc.intra_subnets, 0)\n  security_group_egress_rules = {\n    vpc-endpoints = {\n      description = \"Allow outbound traffic to VPC endpoints\"\n      cidr_ipv4   = module.vpc.vpc_cidr_block\n      from_port   = 443\n    }\n  }\n\n  create_iam_instance_profile = true\n  iam_role_description        = \"IAM role for EC2 instance\"\n  iam_role_policies = {\n    AmazonSSMManagedInstanceCore = \"arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore\"\n  }\n\n  tags = local.tags\n}\n\n################################################################################\n# Supporting Resources\n################################################################################\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"~> 6.0\"\n\n  name = local.name\n  cidr = local.vpc_cidr\n\n  azs           = local.azs\n  intra_subnets = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 8, k)]\n\n  tags = local.tags\n}\n\nmodule \"vpc_endpoints\" {\n  source  = \"terraform-aws-modules/vpc/aws//modules/vpc-endpoints\"\n  version = \"~> 6.0\"\n\n  vpc_id = module.vpc.vpc_id\n\n  endpoints = { for service in toset([\"ssm\", \"ssmmessages\", \"ec2messages\"]) :\n    replace(service, \".\", \"_\") =>\n    {\n      service             = service\n      subnet_ids          = module.vpc.intra_subnets\n      private_dns_enabled = true\n      tags                = { Name = \"${local.name}-${service}\" }\n    }\n  }\n\n  create_security_group      = true\n  security_group_name_prefix = \"${local.name}-vpc-endpoints-\"\n  security_group_description = \"VPC endpoint security group\"\n  security_group_rules = {\n    ingress_https = {\n      description = \"HTTPS from subnets\"\n      cidr_blocks = module.vpc.intra_subnets_cidr_blocks\n    }\n  }\n\n  tags = local.tags\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-ec2-instance__examples__session-manager__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-ec2-instance__examples__session-manager__main.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-ec2-instance__examples__session-manager__main.tf", "start_line": 65}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// Adding a repository, create triggers for cloud build, build the image, deploy to GKE cluster.\nlocals {\n    github_repo_name = replace(lower(basename(var.github_repo_url)), \".git$\", \"\")\n}\n\nresource \"google_cloudbuild_trigger\" \"github_trigger\" {\n  name     = var.cloud_build_trigger_name\n  project  = var.project_id\n  \n  trigger_template {\n    branch_name = \"main\"\n    repo_name   = var.github_repo_url\n  }\n\n  substitutions = {\n    _GKE_CLUSTER_NAME       = var.gke_cluster_name\n    _REGION                 = var.region\n    _DOCKERFILE_PATH        = var.dockerfile_path\n    _K8S_MANIFESTS_DIRECTORY = var.k8s_manifests_directory\n    _IMAGE_REPO_NAME        = local.github_repo_name\n  }\n  \n  build {\n    step {\n        name = \"gcr.io/cloud-builders/docker\"\n        args = [\"build\", \"-t\", \"gcr.io/${var.project_id}/${local.github_repo_name}:latest\", var.dockerfile_path]      \n    }\n\n    step {\n        name = \"gcr.io/cloud-builders/gcloud\"\n        args = [\n        \"container\",\n        \"clusters\",\n        \"get-credentials\",\n        var.gke_cluster_name,\n        \"--region\",\n        var.region,\n        ]\n\n        env = [\n            \"CLOUDSDK_COMPUTE_REGION=${var.region}\",\n            \"CLOUDSDK_CONTAINER_CLUSTER=${var.gke_cluster_name}\",\n        ]\n    }\n\n    step {\n        name = \"gcr.io/cloud-builders/gke-deploy\"\n        args = [\"apply\", \"--filename\", var.k8s_manifests_directory, \"--cluster\", var.gke_cluster_name, \"--location\", var.region]\n    }\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Abhinav-26__DevOps-Projects__DevOps Project-5__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# //////////////////////////////\n# VARIABLES\n# //////////////////////////////\nvariable \"aws_access_key\" {}\n\nvariable \"aws_secret_key\" {}\n\nvariable \"region\" {\n  default = \"us-east-2\"\n}\n\n\n# //////////////////////////////\n# PROVIDERS\n# //////////////////////////////\nprovider \"aws\" {\n  access_key = var.aws_access_key\n  secret_key = var.aws_secret_key\n  region     = var.region\n}\n\n# //////////////////////////////\n# SECURITY GROUP\n# //////////////////////////////\nresource \"aws_security_group\" \"sg_frontend\" {\n  name   = \"sg_frontend\"\n  vpc_id = module.vpc.vpc_id\n\n  ingress {\n    from_port = 80\n    to_port = 80\n    protocol = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port = 443\n    to_port = 443\n    protocol = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port = 22\n    to_port = 22\n    protocol = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port = 0\n    to_port = 0\n    protocol = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n}\n\n# //////////////////////////////\n# MODULES\n# //////////////////////////////\nmodule \"vpc\" {\n  source = \"terraform-aws-modules/vpc/aws\"\n  name = \"frontend-vpc\"\n  cidr = \"10.0.0.0/16\"\n\n  azs             = [\"us-east-2a\", \"us-east-2b\", \"us-east-2c\"]\n  private_subnets = [\"10.0.1.0/24\", \"10.0.2.0/24\", \"10.0.3.0/24\"]\n  public_subnets  = [\"10.0.101.0/24\", \"10.0.102.0/24\", \"10.0.103.0/24\"]\n\n  enable_nat_gateway = true\n  single_nat_gateway = true\n  # one_nat_gateway_per_az = true\n}\n\n\n# //////////////////////////////\n# DATA\n# //////////////////////////////\ndata \"aws_ami\" \"aws-linux\" {\n  most_recent = true\n  owners      = [\"amazon\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"amzn-ami-hvm*\"]\n  }\n\n  filter {\n    name   = \"root-device-type\"\n    values = [\"ebs\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rajakumarguptatechie__terraform__02_05_modules__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rajakumarguptatechie__terraform__02_05_modules__main.tf", "start_line": 62}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rajakumarguptatechie__terraform__02_05_modules__main.tf", "start_line": 62}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rajakumarguptatechie__terraform__02_05_modules__main.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rajakumarguptatechie__terraform__02_05_modules__main.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rajakumarguptatechie__terraform__02_05_modules__main.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rajakumarguptatechie__terraform__02_05_modules__main.tf", "start_line": 25}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rajakumarguptatechie__terraform__02_05_modules__main.tf", "start_line": 25}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"azurerm_resource_group\" \"example\" {\n  name     = \"testingtfc-rg\"\n  location = \"northeurope\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                         = \"tfcpostgresql1111\"\n  location                     = azurerm_resource_group.example.location\n  resource_group_name          = azurerm_resource_group.example.name\n  sku_name                     = \"B_Gen5_2\"\n  storage_mb                   = 5120\n  backup_retention_days        = 7\n  geo_redundant_backup_enabled = false\n  auto_grow_enabled            = true\n  administrator_login          = \"admin\"\n  administrator_login_password = \"password\"\n  version                      = \"9.5\"\n  ssl_enforcement_enabled      = true\n}\n\nresource \"azurerm_postgresql_configuration\" \"log_checkpoints\" {\n  name                = \"log_checkpoints\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}\n\nresource \"azurerm_postgresql_configuration\" \"log_connections\" {\n  name                = \"log_connections\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}\n\nresource \"azurerm_postgresql_configuration\" \"log_disconnections\" {\n  name                = \"log_disconnections\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}\n\nresource \"azurerm_postgresql_configuration\" \"log_duration\" {\n  name                = \"log_duration\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}\n\nresource \"azurerm_postgresql_configuration\" \"connection_throttling\" {\n  name                = \"connection_throttling\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}\n\nresource \"azurerm_postgresql_configuration\" \"log_retention_days\" {\n  name                = \"log_retention_days\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"4\"\n}\n\nprovider \"azurerm\" {\n\tfeatures {}\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__case_sensitivity__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_130", "severity": "HIGH", "message": "Ensure that PostgreSQL server enables infrastructure encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__case_sensitivity__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_147", "severity": "HIGH", "message": "Ensure PostgreSQL is using the latest version of TLS encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__case_sensitivity__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_68", "severity": "HIGH", "message": "Ensure that PostgreSQL server disables public network access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__case_sensitivity__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_128", "severity": "HIGH", "message": "Ensure that PostgreSQL server enables Threat detection policy", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__case_sensitivity__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AZURE_102", "severity": "HIGH", "message": "Ensure that PostgreSQL server enables geo-redundant backups", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__case_sensitivity__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AZURE_42", "severity": "CRITICAL", "message": "Ensure Azure PostgreSQL server is configured with private endpoint", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-compliance__cli__tests__functional__case_sensitivity__main.tf", "start_line": 6}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = local.region\n}\n\nprovider \"helm\" {\n  kubernetes = {\n    host                   = module.eks.cluster_endpoint\n    cluster_ca_certificate = base64decode(module.eks.cluster_certificate_authority_data)\n\n    exec = {\n      api_version = \"client.authentication.k8s.io/v1beta1\"\n      command     = \"aws\"\n      # This requires the awscli to be installed locally where Terraform is executed\n      args = [\"eks\", \"get-token\", \"--cluster-name\", module.eks.cluster_name]\n    }\n  }\n}\n\nlocals {\n  name   = \"ex-${basename(path.cwd)}\"\n  region = \"us-west-2\"\n\n  kubernetes_version = \"1.33\"\n\n  tags = {\n    Test       = local.name\n    GithubRepo = \"terraform-aws-eks\"\n    GithubOrg  = \"terraform-aws-modules\"\n  }\n}\n\n################################################################################\n# EKS Cluster\n################################################################################\n\nmodule \"eks\" {\n  source = \"../..\"\n\n  name               = local.name\n  kubernetes_version = local.kubernetes_version\n\n  endpoint_public_access                   = true\n  enable_cluster_creator_admin_permissions = true\n\n  addons = {\n    coredns                = {}\n    eks-pod-identity-agent = {}\n    kube-proxy             = {}\n  }\n\n  create_node_security_group = false\n  security_group_additional_rules = {\n    hybrid-all = {\n      cidr_blocks = [local.remote_network_cidr]\n      description = \"Allow all traffic from remote node/pod network\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"all\"\n      type        = \"ingress\"\n    }\n  }\n\n  compute_config = {\n    enabled    = true\n    node_pools = [\"system\"]\n  }\n\n  access_entries = {\n    hybrid-node-role = {\n      principal_arn = module.eks_hybrid_node_role.arn\n      type          = \"HYBRID_LINUX\"\n    }\n  }\n\n  vpc_id     = module.vpc.vpc_id\n  subnet_ids = module.vpc.private_subnets\n\n  remote_network_config = {\n    remote_node_networks = {\n      cidrs = [local.remote_node_cidr]\n    }\n    remote_pod_networks = {\n      cidrs = [local.remote_pod_cidr]\n    }\n  }\n\n  tags = local.tags\n}\n\n################################################################################\n# VPC\n################################################################################\n\nlocals {\n  vpc_cidr = \"10.0.0.0/16\"\n  azs      = slice(data.aws_availability_zones.available.names, 0, 3)\n}\n\ndata \"aws_availability_zones\" \"available\" {\n  # Exclude local zones\n  filter {\n    name   = \"opt-in-status\"\n    values = [\"opt-in-not-required\"]\n  }\n}\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"~> 6.0\"\n\n  name = local.name\n  cidr = local.vpc_cidr\n\n  azs             = local.azs\n  private_subnets = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 4, k)]\n  public_subnets  = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 8, k + 48)]\n  intra_subnets   = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 8, k + 52)]\n\n  enable_nat_gateway = true\n  single_nat_gateway = true\n\n  public_subnet_tags = {\n    \"kubernetes.io/role/elb\" = 1\n  }\n\n  private_subnet_tags = {\n    \"kubernetes.io/role/internal-elb\" = 1\n  }\n\n  tags = local.tags\n}\n\n################################################################################\n# VPC Peering Connection\n################################################################################\n\nresource \"aws_vpc_peering_connection_accepter\" \"peer\" {\n  vpc_peering_connection_id = aws_vpc_peering_connection.remote_node.id\n  auto_accept               = true\n\n  tags = local.tags\n}\n\nresource \"aws_route\" \"peer\" {\n  route_table_id            = one(module.vpc.private_route_table_ids)\n  destination_cidr_block    = local.remote_network_cidr\n  vpc_peering_connection_id = aws_vpc_peering_connection.remote_node.id\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-eks__examples__eks-hybrid-nodes__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-eks__examples__eks-hybrid-nodes__main.tf", "start_line": 107}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright 2019 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     https://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\n\nvariable \"project\" {}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-cloudbuild-gitops__environments__dev__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"release\" {\n  type        = string\n  default     = \"latest\"\n  description = \"The NixOS version to use. For example, 18.09\"\n}\n\nvariable \"region\" {\n  type        = string\n  default     = \"\"\n  description = \"The region to use. If not provided, current provider's region will be used.\"\n}\n\nvariable \"type\" {\n  type        = string\n  default     = \"hvm-ebs\"\n  description = \"The type of the AMI to use -- hvm-ebs, pv-ebs, or pv-s3.\"\n}\n\n# ---\n\ndata \"aws_region\" \"current\" {}\n\nlocals {\n  key = \"${var.release}.${coalesce(var.region, data.aws_region.current.name)}.${var.type}\"\n  ami = var.url_map[local.key]\n}\n\n# ---\n\noutput \"ami\" {\n  description = \"NixOS AMI on AWS\"\n  value       = local.ami\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nix-community__terraform-nixos__aws_image_nixos__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# The following example shows how to generate a unique name for an Azure Resource Group.\n\nresource \"random_uuid\" \"test\" {\n}\n\nresource \"azurerm_resource_group\" \"test\" {\n  name     = \"${random_uuid.test.result}-rg\"\n  location = \"Central US\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-random__examples__resources__random_uuid__resource.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.16\"\n    }\n  }\n\n  required_version = \">= 1.2.0\"\n}\n\nprovider \"aws\" {\n  region = var.region\n}\n\nresource \"aws_instance\" \"opt_03\" {\n  ami           = var.ami\n  instance_type = \"t2.micro\"\n\n  tags = {\n    Name = var.name\n    Category = var.category\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__opt-03-variables__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__opt-03-variables__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__opt-03-variables__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__opt-03-variables__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__opt-03-variables__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/daveprowse__tac-course__opt-03-variables__main.tf", "start_line": 16}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Author: Roxana Kovaci\n# Twitter: @RoxanaKovaci\n\n#############################################################################\n# VARIABLES\n#############################################################################\n\nvariable \"domain\" {\n  type          = string\n  description   = \"Domain name (for example: contoso.onmicrosoft.com)\"\n}\n\nvariable \"user_name1\" {\n  type          = string\n  default       = \"katie.parkson\"\n  description   = \"User name\"\n}\n\nvariable \"user_password1\" {\n  type          = string\n  description   = \"Password\"\n}\n\nvariable \"resource_group_name\" {\n  type          = string\n  default       = \"engineering\"\n  description   = \"The name of the Resource Group\"\n}\n\nvariable \"linuxvm_name\" {\n  type          = string\n  default       = \"LinuxVM\"\n  description   = \"The name of the Linux VM\"\n}\n\nvariable \"windowsvm_name\" {\n  type          = string\n  default       = \"WindowsVM\"\n  description   = \"The name of the Windows VM\"\n}\n\nvariable \"virtual_network_name\" {\n  type          = string\n  default       = \"vNetwork\"\n  description   = \"The name of the virtual network\"\n}\n\nvariable \"linuxvm_user\" {\n  type          = string\n  default       = \"azureuser\"\n  description   = \"The name of the sudo user on Linux VM\"\n}\n\nvariable \"windowsvm_user\" {\n  type          = string\n  default       = \"helen\"\n  description   = \"The name of the local admin on the Windows VM\"\n}\n\nvariable \"windowsvm_password\" {\n  type          = string\n  description   = \"The password of the local admin on the Windows VM\"\n}\n\nvariable \"storage_account_name\" {\n  type          = string\n  default       = \"datamining01\"\n  description   = \"The name of the Storage Account\"\n}\n\nvariable \"container_name\" {\n  type          = string\n  default       = \"investment\"\n  description   = \"The name of the Storage Container\"\n}\n\nvariable \"share_name\" {\n  type          = string\n  default       = \"engineering-data\"\n  description   = \"The name of the Storage File Share\"\n}\n\n\n#############################################################################\n# DATA\n#############################################################################\n\ndata \"azurerm_subscription\" \"current\" {}\n\ndata \"azurerm_client_config\" \"current\" {}\n\n#############################################################################\n# PROVIDERS\n#############################################################################\n\nprovider \"azurerm\" {\n  features {}\n}\n\nprovider \"azuread\" {\n}\n\n\n#############################################################################\n# RESOURCES\n#############################################################################\n\n## Resource Group ##\n\nresource \"azurerm_resource_group\" \"innovation\" {\n  name     = var.resource_group_name\n  location = \"East US\"\n}\n\n## AZURE AD USER ##\n\nresource \"azuread_user\" \"user1\" {\n  user_principal_name         = \"${var.user_name1}@${var.domain}\"\n  display_name                = var.user_name1\n  password                    = var.user_password1\n  disable_password_expiration = true\n}\n\n## AZURE STORAGE ACCOUNT ##\nresource \"azurerm_storage_account\" \"storage\" {\n  name                     = var.storage_account_name\n  resource_group_name      = azurerm_resource_group.innovation.name\n  location                 = azurerm_resource_group.innovation.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"LRS\"\n}\n\nresource \"azurerm_storage_container\" \"container\" {\n  name                  = var.container_name\n  storage_account_name  = azurerm_storage_account.storage.name\n  container_access_type = \"private\"\n}\n\nresource \"azurerm_storage_blob\" \"container-file\" {\n  name                   = \"secret.txt\"\n  storage_account_name   = azurerm_storage_account.storage.name\n  storage_container_name = azurerm_storage_container.container.name\n  type                   = \"Block\"\n  source                 = \"./secret.txt\"\n}\n\nresource \"azurerm_storage_share\" \"share\" {\n  name                 = var.share_name\n  storage_account_name = azurerm_storage_account.storage.name\n  quota                = 50\n}\n\nresource \"azurerm_storage_share_file\" \"share-file\" {\n  name             = \"super-secret-file.txt\"\n  storage_share_id = azurerm_storage_share.share.id\n  source           = \"./super-secret-file.txt\"\n}\n\n## AZURE LINUX VIRTUAL MACHINE ##\nresource \"azurerm_virtual_network\" \"vNet\" {\n  name                = var.virtual_network_name\n  address_space       = [\"10.0.0.0/16\"]\n  location            = azurerm_resource_group.innovation.location\n  resource_group_name = azurerm_resource_group.innovation.name\n}\n\nresource \"azurerm_subnet\" \"internal\" {\n  name                 = \"internal\"\n  resource_group_name  = azurerm_resource_group.innovation.name\n  virtual_network_name = azurerm_virtual_network.vNet.name\n  address_prefixes     = [\"10.0.2.0/24\"]\n}\n\nresource \"azurerm_public_ip\" \"LinuxVMPublicIP\" {\n  name                = \"myPublicIP\"\n  location            = azurerm_resource_group.innovation.location\n  resource_group_name = azurerm_resource_group.innovation.name\n  allocation_method   = \"Dynamic\"\n  sku                 = \"Basic\"       \n}\n\nresource \"azurerm_network_interface\" \"External\" {\n  name                = \"ExternalNIC\"\n  location            = azurerm_resource_group.innovation.location\n  resource_group_name = azurerm_resource_group.innovation.name\n\n  ip_configuration {\n    name                          = \"external\"\n    subnet_id                     = azurerm_subnet.internal.id\n    private_ip_address_allocation = \"Dynamic\"\n    public_ip_address_id          = azurerm_public_ip.LinuxVMPublicIP.id\n  }\n}\n\nresource \"azurerm_network_security_group\" \"NSG\" {\n    name                = \"LinuxVMNSG\"\n    location            = azurerm_resource_group.innovation.location\n    resource_group_name = azurerm_resource_group.innovation.name\n}\n\nresource \"azurerm_network_interface_security_group_association\" \"NSGAssociation\" {\n    network_interface_id      = azurerm_network_interface.External.id\n    network_security_group_id = azurerm_network_security_group.NSG.id\n}\n\n## AZURE Linux VM ##\nresource \"azurerm_linux_virtual_machine\" \"LinuxVM\" {\n  name                            = var.linuxvm_name\n  resource_group_name             = azurerm_resource_group.innovation.name\n  location                        = azurerm_resource_group.innovation.location\n  size                            = \"Standard_B2s\"\n  admin_username                  = var.linuxvm_user\n  network_interface_ids           = [azurerm_network_interface.External.id]\n\n  admin_ssh_key {\n    username   = \"azureuser\"\n    public_key = file(\"./id_rsa.pub\")\n  }\n\n  os_disk {\n    caching              = \"ReadWrite\"\n    storage_account_type = \"Standard_LRS\"\n  }\n\n  source_image_reference {\n    publisher = \"Canonical\"\n    offer     = \"0001-com-ubuntu-server-focal\"\n    sku       = \"20_04-lts-gen2\"\n    version   = \"latest\"\n  }\n\n  identity {\n    type         = \"SystemAssigned\"\n  }\n}\n\nresource \"azurerm_virtual_machine_extension\" \"CommandLinux\" {\n  name                 = \"customscript\"\n  virtual_machine_id   = azurerm_linux_virtual_machine.LinuxVM.id\n  publisher            = \"Microsoft.Azure.Extensions\"\n  type                 = \"CustomScript\"\n  type_handler_version = \"2.0\"\n\n  settings = <<SETTINGS\n    {\n      \"commandToExecute\": \"sudo apt-get update && sudo apt-get upgrade && curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash\"\n    }\n  SETTINGS\n}\n\n## AZURE Windows VM ##\nresource \"azurerm_network_interface\" \"Internal1\" {\n  name                = \"InternalNIC1\"\n  resource_group_name = azurerm_resource_group.innovation.name\n  location            = azurerm_resource_group.innovation.location\n\n  ip_configuration {\n    name                          = \"internal1\"\n    subnet_id                     = azurerm_subnet.internal.id\n    private_ip_address_allocation = \"Dynamic\"\n  }\n}\n\nresource \"azurerm_windows_virtual_machine\" \"WindowsVM\" {\n  name                  = var.windowsvm_name\n  resource_group_name   = azurerm_resource_group.innovation.name\n  location              = azurerm_resource_group.innovation.location\n  size                  = \"Standard_B2s\"\n  admin_username        = var.windowsvm_user\n  admin_password        = var.windowsvm_password\n  network_interface_ids = [azurerm_network_interface.Internal1.id]\n\n  os_disk {\n    caching              = \"ReadWrite\"\n    storage_account_type = \"Standard_LRS\"\n  }\n\n  source_image_reference {\n    publisher = \"MicrosoftWindowsDesktop\"\n    offer     = \"Windows-10\"\n    sku       = \"21h1-pro\"\n    version   = \"latest\"\n  }\n\n  identity {\n    type      = \"SystemAssigned\"\n  }\n}\n\nresource \"azurerm_virtual_machine_extension\" \"CommandWindows\" {\n  virtual_machine_id   = azurerm_windows_virtual_machine.WindowsVM.id\n  name                 = \"installscript\"\n  publisher            = \"Microsoft.Compute\"\n  type                 = \"CustomScriptExtension\"\n  type_handler_version = \"1.10\"\n\n  # NOTE: Script is executed from a cmd-shell, therefore escape \" as \\\".\n  #       Second, since value is json-encoded, escape \\\" as \\\\\\\".\n  settings = <<SETTINGS\n    {\n      \"commandToExecute\": \"powershell -Command Invoke-WebRequest -Uri https://aka.ms/installazurecliwindows -OutFile .\\\\AzureCLI.msi; Start-Process msiexec.exe -Wait -ArgumentList '/I AzureCLI.msi /quiet'; rm .\\\\AzureCLI.msi\"\n    }\nSETTINGS\n}\n\n## AZURE ROLES AND ROLES ASSIGNMENT ##\nresource \"azurerm_role_assignment\" \"ACBlob\" {\n  scope                = azurerm_storage_account.storage.id\n  role_definition_name = \"Storage Blob Data Reader\"\n  principal_id         = azuread_user.user1.id\n}\n\nresource \"azurerm_role_assignment\" \"ACStorage\" {\n  scope                = azurerm_storage_account.storage.id\n  role_definition_name = \"Reader\"\n  principal_id         = azuread_user.user1.id\n}\n\nresource \"azurerm_role_assignment\" \"ACPublicIP\" {\n  scope                = azurerm_public_ip.LinuxVMPublicIP.id\n  role_definition_name = \"Reader\"\n  principal_id         = azuread_user.user1.id\n}\n\nresource \"azurerm_role_assignment\" \"ACLinuxNSG\" {\n  scope                = azurerm_network_security_group.NSG.id\n  role_definition_name = \"Owner\"\n  principal_id         = azuread_user.user1.id\n}\n\nresource \"azurerm_role_assignment\" \"ACShare1\" {\n  scope                = azurerm_storage_account.storage.id\n  role_definition_name = \"Storage Account Contributor\"\n  principal_id         = azurerm_windows_virtual_machine.WindowsVM.identity.0.principal_id\n}\n\nresource \"azurerm_role_assignment\" \"ACWindowsVM\" {\n  scope                = azurerm_windows_virtual_machine.WindowsVM.id\n  role_definition_name = \"Contributor\"\n  principal_id         = azurerm_linux_virtual_machine.LinuxVM.identity.0.principal_id\n}\n\n## Output\noutput \"username\" {\n  value = \"${var.user_name1}@${var.domain}\"\n}\noutput \"password\" {\n  value = var.user_password1\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_59", "severity": "HIGH", "message": "Ensure that Storage accounts disallow public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV_AZURE_33", "severity": "HIGH", "message": "Ensure Storage logging is enabled for Queue service for read, write and delete requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV_AZURE_44", "severity": "HIGH", "message": "Ensure Storage Account is using the latest version of TLS encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV_AZURE_206", "severity": "HIGH", "message": "Ensure that Storage Accounts use replication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV_AZURE_190", "severity": "HIGH", "message": "Ensure that Storage blobs restrict public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV_AZURE_50", "severity": "HIGH", "message": "Ensure Virtual Machine Extensions are not Installed", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 207}, {"tool": "checkov", "rule_id": "CKV_AZURE_50", "severity": "HIGH", "message": "Ensure Virtual Machine Extensions are not Installed", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 264}, {"tool": "checkov", "rule_id": "CKV_AZURE_151", "severity": "HIGH", "message": "Ensure Windows VM enables encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 264}, {"tool": "checkov", "rule_id": "CKV_AZURE_119", "severity": "HIGH", "message": "Ensure that Network Interfaces don't use public IPs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 182}, {"tool": "checkov", "rule_id": "CKV2_AZURE_40", "severity": "CRITICAL", "message": "Ensure storage account is not configured with Shared Key authorization", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV2_AZURE_47", "severity": "CRITICAL", "message": "Ensure storage account is configured without blob anonymous access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV2_AZURE_33", "severity": "CRITICAL", "message": "Ensure storage account is configured with private endpoint", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV2_AZURE_41", "severity": "CRITICAL", "message": "Ensure storage account is configured with SAS expiration policy", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV2_AZURE_38", "severity": "CRITICAL", "message": "Ensure soft-delete is enabled on Azure storage account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV2_AZURE_1", "severity": "CRITICAL", "message": "Ensure storage for critical data are encrypted with Customer Managed Key", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 125}, {"tool": "checkov", "rule_id": "CKV2_AZURE_21", "severity": "CRITICAL", "message": "Ensure Storage logging is enabled for Blob service for read requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 133}, {"tool": "checkov", "rule_id": "CKV2_AZURE_31", "severity": "CRITICAL", "message": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mandiant__Azure_Workshop__kc2__kc2.tf", "start_line": 167}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.24.0\"\n    }\n  }\n}\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\ndata \"aws_caller_identity\" \"current\" {}\n\n\ndata \"archive_file\" \"lambda_zip\" {\n  type        = \"zip\"\n  source_dir  = \"resources/lambda/react\"\n  output_path = \"resources/lambda/out/reactapp.zip\"\n  depends_on  = [aws_s3_object.upload_folder_prod]\n}\n\nresource \"aws_lambda_function\" \"react_lambda_app\" {\n  filename      = \"resources/lambda/out/reactapp.zip\"\n  function_name = \"blog-application\"\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  role          = aws_iam_role.blog_app_lambda.arn\n  depends_on    = [data.archive_file.lambda_zip, null_resource.file_replacement_lambda_react]\n}\n\n\n/* Lambda iam Role */\n\nresource \"aws_iam_role\" \"blog_app_lambda\" {\n  name = \"blog_app_lambda\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n\n\nresource \"aws_iam_role_policy_attachment\" \"ba_lambda_attach_2\" {\n  role       = aws_iam_role.blog_app_lambda.name\n  policy_arn = \"arn:aws:iam::aws:policy/CloudWatchFullAccess\"\n}\nresource \"aws_iam_role_policy_attachment\" \"ba_lambda_attach_3\" {\n  role       = aws_iam_role.blog_app_lambda.name\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonAPIGatewayInvokeFullAccess\"\n}\n\n\nresource \"aws_api_gateway_rest_api\" \"api\" {\n  name = \"blog-application\"\n  endpoint_configuration {\n    types = [\n      \"REGIONAL\"\n    ]\n  }\n}\n\n\nresource \"aws_api_gateway_resource\" \"endpoint\" {\n  rest_api_id = aws_api_gateway_rest_api.api.id\n  parent_id   = aws_api_gateway_rest_api.api.root_resource_id\n  path_part   = \"react\"\n}\n\nresource \"aws_api_gateway_method\" \"endpoint\" {\n  rest_api_id   = aws_api_gateway_rest_api.api.id\n  resource_id   = aws_api_gateway_resource.endpoint.id\n  http_method   = \"GET\"\n  authorization = \"NONE\"\n}\n\nresource \"aws_api_gateway_method_response\" \"endpoint\" {\n  rest_api_id = aws_api_gateway_rest_api.api.id\n  resource_id = aws_api_gateway_resource.endpoint.id\n  http_method = aws_api_gateway_method.endpoint.http_method\n  status_code = \"200\"\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n\n}\n\nresource \"aws_api_gateway_integration\" \"endpoint\" {\n  depends_on = [aws_api_gateway_method.endpoint, aws_api_gateway_method_response.endpoint]\n\n  rest_api_id             = aws_api_gateway_rest_api.api.id\n  resource_id             = aws_api_gateway_method.endpoint.resource_id\n  http_method             = aws_api_gateway_method.endpoint.http_method\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.react_lambda_app.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\n\nresource \"aws_api_gateway_integration_response\" \"endpoint\" {\n  depends_on = [aws_api_gateway_integration.endpoint]\n\n  rest_api_id = aws_api_gateway_rest_api.api.id\n  resource_id = aws_api_gateway_resource.endpoint.id\n  http_method = aws_api_gateway_method.endpoint.http_method\n  status_code = aws_api_gateway_method_response.endpoint.status_code\n\n  response_templates = {\n    \"text/html\" = \"\"\n  }\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n  }\n}\n\nresource \"aws_lambda_permission\" \"apigw_ba\" {\n  statement_id  = \"AllowAPIGatewayInvoke\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.react_lambda_app.function_name\n  principal     = \"apigateway.amazonaws.com\"\n  source_arn    = \"${aws_api_gateway_rest_api.api.execution_arn}/*/*\"\n}\n\n\n\n\nresource \"aws_api_gateway_deployment\" \"api\" {\n  rest_api_id = aws_api_gateway_rest_api.api.id\n  description = \"Deployed endpoint at ${timestamp()}\"\n  depends_on  = [aws_api_gateway_integration_response.endpoint]\n}\n\nresource \"aws_api_gateway_stage\" \"api\" {\n  stage_name    = \"prod\"\n  rest_api_id   = aws_api_gateway_rest_api.api.id\n  deployment_id = aws_api_gateway_deployment.api.id\n}\n\n\n\n\n/* API Gateway -- REST API lambda_ba */\n\n\nresource \"aws_api_gateway_rest_api\" \"apiLambda_ba\" {\n  name           = \"blog-application-api\"\n  api_key_source = \"HEADER\"\n  endpoint_configuration {\n    types = [\n      \"REGIONAL\"\n    ]\n  }\n}\n\n\n/* API ENDPOINTS */\n\n# XSS\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"xss_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"xss\"\n}\nresource \"aws_api_gateway_method\" \"proxy_xss_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.xss_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n}\nresource \"aws_api_gateway_method_response\" \"proxy_xss_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.xss_root.id\n  http_method = aws_api_gateway_method.proxy_xss_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"xss_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.xss_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"xss_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.xss_root.id\n  http_method = aws_api_gateway_method.xss_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_xss_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.xss_root.id\n  http_method = aws_api_gateway_method.proxy_xss_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\n\nresource \"aws_api_gateway_integration_response\" \"lambda_xss_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.xss_root.id\n  http_method = aws_api_gateway_method.proxy_xss_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_xss_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n  depends_on = [aws_api_gateway_integration.lambda_xss_root_post, aws_api_gateway_method_response.proxy_xss_root_post_response_200]\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_xss_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.xss_root.id\n  http_method = aws_api_gateway_method.xss_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_xss_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.xss_root.id\n  http_method = aws_api_gateway_method.xss_root_options.http_method\n  status_code = aws_api_gateway_method_response.xss_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n  depends_on = [aws_api_gateway_integration.lambda_xss_root_options]\n\n}\n#########################################################################################################################\n\n\n\n\n\n\n# BAN-USER\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"ban_user_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"ban-user\"\n}\nresource \"aws_api_gateway_method\" \"proxy_ban_user_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.ban_user_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_ban_user_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.ban_user_root.id\n  http_method = aws_api_gateway_method.proxy_ban_user_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"ban_user_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.ban_user_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"ban_user_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.ban_user_root.id\n  http_method = aws_api_gateway_method.ban_user_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\n#ban-user\nresource \"aws_api_gateway_integration\" \"lambda_ban_user_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.ban_user_root.id\n  http_method = aws_api_gateway_method.proxy_ban_user_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_ban_user_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.ban_user_root.id\n  http_method = aws_api_gateway_method.proxy_ban_user_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_ban_user_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_ban_user_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_ban_user_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.ban_user_root.id\n  http_method = aws_api_gateway_method.ban_user_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_ban_user_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.ban_user_root.id\n  http_method = aws_api_gateway_method.ban_user_root_options.http_method\n  status_code = aws_api_gateway_method_response.ban_user_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_ban_user_root_options]\n\n}\n\n\n#########################################################################################################################\n\n\n\n\n# Change-password\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"change_password_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"change-password\"\n}\n\n# change-password api methods\nresource \"aws_api_gateway_method\" \"proxy_change_password_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.change_password_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_change_password_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_password_root.id\n  http_method = aws_api_gateway_method.proxy_change_password_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"change_password_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.change_password_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"change_password_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_password_root.id\n  http_method = aws_api_gateway_method.change_password_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\n\n# change-password\nresource \"aws_api_gateway_integration\" \"lambda_change_password_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_password_root.id\n  http_method = aws_api_gateway_method.proxy_change_password_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_change_password_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_password_root.id\n  http_method = aws_api_gateway_method.proxy_change_password_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_change_password_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_change_password_root_post]\n\n}\n\n\nresource \"aws_api_gateway_integration\" \"lambda_change_password_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_password_root.id\n  http_method = aws_api_gateway_method.change_password_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_change_password_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_password_root.id\n  http_method = aws_api_gateway_method.change_password_root_options.http_method\n  status_code = aws_api_gateway_method_response.change_password_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_change_password_root_options]\n\n}\n\n\n\n#########################################################################################################################\n\n\n\n\n\n\n# DUMP-ROOT\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"dump_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"dump\"\n}\n\nresource \"aws_api_gateway_method\" \"proxy_dump_root_get\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.dump_root.id\n  http_method   = \"GET\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_dump_root_get_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.dump_root.id\n  http_method = aws_api_gateway_method.proxy_dump_root_get.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_method\" \"dump_root_options\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.dump_root.id\n  http_method   = \"OPTIONS\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"dump_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.dump_root.id\n  http_method = aws_api_gateway_method.dump_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\n# dump\nresource \"aws_api_gateway_integration\" \"lambda_dump_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.dump_root.id\n  http_method = aws_api_gateway_method.proxy_dump_root_get.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_dump_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.dump_root.id\n  http_method = aws_api_gateway_method.proxy_dump_root_get.http_method\n  status_code = aws_api_gateway_method_response.dump_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_dump_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_dump_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.dump_root.id\n  http_method = aws_api_gateway_method.dump_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_dump_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.dump_root.id\n  http_method = aws_api_gateway_method.dump_root_options.http_method\n  status_code = aws_api_gateway_method_response.dump_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n  depends_on = [aws_api_gateway_integration.lambda_dump_root_options]\n\n}\n#########################################################################################################################\n\n\n\n\n\n\n\n\n\n# LIST-POSTS\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"list_posts_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"list-posts\"\n}\n\n\n\n# list_posts methods\n\nresource \"aws_api_gateway_method\" \"proxy_list_posts_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.list_posts_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_list_posts_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.list_posts_root.id\n  http_method = aws_api_gateway_method.proxy_list_posts_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_method\" \"list_posts_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.list_posts_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"list_posts_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.list_posts_root.id\n  http_method = aws_api_gateway_method.list_posts_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\n# list-posts\nresource \"aws_api_gateway_integration\" \"lambda_list_posts_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.list_posts_root.id\n  http_method = aws_api_gateway_method.proxy_list_posts_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_list_posts_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.list_posts_root.id\n  http_method = aws_api_gateway_method.proxy_list_posts_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_list_posts_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n  depends_on = [aws_api_gateway_integration.lambda_list_posts_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_list_posts_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.list_posts_root.id\n  http_method = aws_api_gateway_method.list_posts_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_list_posts_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.list_posts_root.id\n  http_method = aws_api_gateway_method.list_posts_root_options.http_method\n  status_code = aws_api_gateway_method_response.list_posts_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n  depends_on = [aws_api_gateway_integration.lambda_list_posts_root_options]\n\n}\n\n\n#########################################################################################################################\n\n\n#LOGIN-ROOT\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"login_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"login\"\n}\n\n# login methods\n\nresource \"aws_api_gateway_method\" \"proxy_login_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.login_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_login_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.login_root.id\n  http_method = aws_api_gateway_method.proxy_login_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"login_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.login_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"login_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.login_root.id\n  http_method = aws_api_gateway_method.login_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\n\n# login\nresource \"aws_api_gateway_integration\" \"lambda_login_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.login_root.id\n  http_method = aws_api_gateway_method.proxy_login_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_login_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.login_root.id\n  http_method = aws_api_gateway_method.proxy_login_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_login_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_login_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_login_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.login_root.id\n  http_method = aws_api_gateway_method.login_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_login_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.login_root.id\n  http_method = aws_api_gateway_method.login_root_options.http_method\n  status_code = aws_api_gateway_method_response.login_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n  depends_on = [aws_api_gateway_integration.lambda_login_root_options]\n\n}\n\n#########################################################################################################################\n\n\n\n\n\n# Register-root\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"register_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"register\"\n}\n\n\n# register methods\n\nresource \"aws_api_gateway_method\" \"proxy_register_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.register_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_register_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.register_root.id\n  http_method = aws_api_gateway_method.proxy_register_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"register_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.register_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n}\nresource \"aws_api_gateway_method_response\" \"register_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.register_root.id\n  http_method = aws_api_gateway_method.register_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\n# register\nresource \"aws_api_gateway_integration\" \"lambda_register_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.register_root.id\n  http_method = aws_api_gateway_method.proxy_register_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_register_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.register_root.id\n  http_method = aws_api_gateway_method.proxy_register_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_register_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_register_root_post]\n\n}\n\n\nresource \"aws_api_gateway_integration\" \"lambda_register_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.register_root.id\n  http_method = aws_api_gateway_method.register_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_register_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.register_root.id\n  http_method = aws_api_gateway_method.register_root_options.http_method\n  status_code = aws_api_gateway_method_response.register_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n  depends_on = [aws_api_gateway_integration.lambda_register_root_options]\n\n}\n\n#########################################################################################################################\n\n\n\n# SAVE-POST\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"save_post_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"save-post\"\n}\n\n# save-post methods\nresource \"aws_api_gateway_method\" \"proxy_save_post_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.save_post_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_save_post_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_post_root.id\n  http_method = aws_api_gateway_method.proxy_save_post_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"save_post_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.save_post_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"save_post_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_post_root.id\n  http_method = aws_api_gateway_method.save_post_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n# save-post\nresource \"aws_api_gateway_integration\" \"lambda_save_post_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_post_root.id\n  http_method = aws_api_gateway_method.proxy_save_post_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_save_post_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_post_root.id\n  http_method = aws_api_gateway_method.proxy_save_post_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_save_post_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_save_post_root_post]\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_save_post_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_post_root.id\n  http_method = aws_api_gateway_method.save_post_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_save_post_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_post_root.id\n  http_method = aws_api_gateway_method.save_post_root_options.http_method\n  status_code = aws_api_gateway_method_response.save_post_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_save_post_root_options]\n}\n\n#########################################################################################################################\n\n\n\n# Verify root\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"verify_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"verify\"\n}\n\n\n\n# verify methods\n\nresource \"aws_api_gateway_method\" \"proxy_verify_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.verify_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_verify_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.verify_root.id\n  http_method = aws_api_gateway_method.proxy_verify_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"verify_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.verify_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"verify_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.verify_root.id\n  http_method = aws_api_gateway_method.verify_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\n\n# verify\nresource \"aws_api_gateway_integration\" \"lambda_verify_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.verify_root.id\n  http_method = aws_api_gateway_method.proxy_verify_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_verify_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.verify_root.id\n  http_method = aws_api_gateway_method.proxy_verify_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_verify_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_verify_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_verify_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.verify_root.id\n  http_method = aws_api_gateway_method.verify_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_verify_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.verify_root.id\n  http_method = aws_api_gateway_method.verify_root_options.http_method\n  status_code = aws_api_gateway_method_response.verify_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_verify_root_options]\n}\n\n#########################################################################################################################\n\n\n\n\n# save-content\n#########################################################################################################################\n\nresource \"aws_api_gateway_resource\" \"save_content_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"save-content\"\n}\n\n\n# save-content method\nresource \"aws_api_gateway_method\" \"proxy_save_content_root_get\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.save_content_root.id\n  http_method   = \"GET\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_save_content_root_get_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_content_root.id\n  http_method = aws_api_gateway_method.proxy_save_content_root_get.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"save_content_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.save_content_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"save_content_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_content_root.id\n  http_method = aws_api_gateway_method.save_content_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_integration\" \"save_content_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_content_root.id\n  http_method = aws_api_gateway_method.save_content_options.http_method\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"save_content_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_content_root.id\n  http_method = aws_api_gateway_method.save_content_options.http_method\n  status_code = aws_api_gateway_method_response.save_content_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.save_content_root_options]\n}\n\nresource \"aws_api_gateway_method\" \"proxy_save_content_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.save_content_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_save_content_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_content_root.id\n  http_method = aws_api_gateway_method.proxy_save_content_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\n# save-content\nresource \"aws_api_gateway_integration\" \"lambda_save_content_root_get\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_content_root.id\n  http_method = aws_api_gateway_method.proxy_save_content_root_get.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_save_content_root_get_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_content_root.id\n  http_method = aws_api_gateway_method.proxy_save_content_root_get.http_method\n  status_code = aws_api_gateway_method_response.proxy_save_content_root_get_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_save_content_root_get]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_save_content_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_content_root.id\n  http_method = aws_api_gateway_method.proxy_save_content_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_save_content_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.save_content_root.id\n  http_method = aws_api_gateway_method.proxy_save_content_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_save_content_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_save_content_root_post]\n\n}\n#########################################################################################################################\n\n\n# search-author\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"search_author_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"search-author\"\n}\n\n#search-author method\nresource \"aws_api_gateway_method\" \"proxy_search_author_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.search_author_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_search_author_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.search_author_root.id\n  http_method = aws_api_gateway_method.proxy_search_author_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"search_author_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.search_author_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"search_author_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.search_author_root.id\n  http_method = aws_api_gateway_method.search_author_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_integration\" \"search_author_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.search_author_root.id\n  http_method = aws_api_gateway_method.search_author_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"search_author_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.search_author_root.id\n  http_method = aws_api_gateway_method.search_author_options.http_method\n  status_code = aws_api_gateway_method_response.search_author_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n  depends_on = [aws_api_gateway_integration.search_author_root_options]\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_search_author_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.search_author_root.id\n  http_method = aws_api_gateway_method.proxy_search_author_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_search_author_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.search_author_root.id\n  http_method = aws_api_gateway_method.proxy_search_author_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_search_author_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n  depends_on = [aws_api_gateway_integration.lambda_search_author_root_post]\n\n}\n\n#########################################################################################################################\n\n\n\n# reset-password-ROOT\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"reset_password_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"reset-password\"\n}\n\nresource \"aws_api_gateway_method\" \"proxy_reset_password_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.reset_password_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_reset_password_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.reset_password_root.id\n  http_method = aws_api_gateway_method.proxy_reset_password_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_method\" \"reset_password_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.reset_password_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"reset_password_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.reset_password_root.id\n  http_method = aws_api_gateway_method.reset_password_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_integration\" \"lambda_reset_password_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.reset_password_root.id\n  http_method = aws_api_gateway_method.proxy_reset_password_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_reset_password_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.reset_password_root.id\n  http_method = aws_api_gateway_method.proxy_reset_password_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_reset_password_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_reset_password_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_reset_password_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.reset_password_root.id\n  http_method = aws_api_gateway_method.reset_password_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_reset_password_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.reset_password_root.id\n  http_method = aws_api_gateway_method.reset_password_root_options.http_method\n  status_code = aws_api_gateway_method_response.reset_password_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n  depends_on = [aws_api_gateway_integration.lambda_reset_password_root_options]\n\n}\n#########################################################################################################################\n\n\n\n# get-users-ROOT\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"get_users_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"get-users\"\n}\n\nresource \"aws_api_gateway_method\" \"proxy_get_users_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.get_users_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_get_users_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_users_root.id\n  http_method = aws_api_gateway_method.proxy_get_users_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_method\" \"get_users_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.get_users_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"get_users_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_users_root.id\n  http_method = aws_api_gateway_method.get_users_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_integration\" \"lambda_get_users_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_users_root.id\n  http_method = aws_api_gateway_method.proxy_get_users_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_get_users_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_users_root.id\n  http_method = aws_api_gateway_method.proxy_get_users_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_get_users_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_get_users_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_get_users_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_users_root.id\n  http_method = aws_api_gateway_method.get_users_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_get_users_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_users_root.id\n  http_method = aws_api_gateway_method.get_users_root_options.http_method\n  status_code = aws_api_gateway_method_response.get_users_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n  depends_on = [aws_api_gateway_integration.lambda_get_users_root_options]\n\n}\n#########################################################################################################################\n\n\n\n\n#  UNBAN-USER\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"unban_user_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"unban-user\"\n}\nresource \"aws_api_gateway_method\" \"proxy_unban_user_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.unban_user_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_unban_user_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.unban_user_root.id\n  http_method = aws_api_gateway_method.proxy_unban_user_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"unban_user_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.unban_user_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"unban_user_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.unban_user_root.id\n  http_method = aws_api_gateway_method.unban_user_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_integration\" \"lambda_unban_user_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.unban_user_root.id\n  http_method = aws_api_gateway_method.proxy_unban_user_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_unban_user_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.unban_user_root.id\n  http_method = aws_api_gateway_method.proxy_unban_user_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_unban_user_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_unban_user_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_unban_user_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.unban_user_root.id\n  http_method = aws_api_gateway_method.unban_user_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_unban_user_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.unban_user_root.id\n  http_method = aws_api_gateway_method.unban_user_root_options.http_method\n  status_code = aws_api_gateway_method_response.unban_user_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_unban_user_root_options]\n\n}\n\n\n#########################################################################################################################\n\n\n\n#  USER-DETAILS-MODAL\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"user_details_modal_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"user-details-modal\"\n}\nresource \"aws_api_gateway_method\" \"proxy_user_details_modal_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.user_details_modal_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_user_details_modal_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.user_details_modal_root.id\n  http_method = aws_api_gateway_method.proxy_user_details_modal_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"user_details_modal_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.user_details_modal_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\n\nresource \"aws_api_gateway_method_response\" \"user_details_modal_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.user_details_modal_root.id\n  http_method = aws_api_gateway_method.user_details_modal_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_integration\" \"lambda_user_details_modal_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.user_details_modal_root.id\n  http_method = aws_api_gateway_method.proxy_user_details_modal_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_user_details_modal_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.user_details_modal_root.id\n  http_method = aws_api_gateway_method.proxy_user_details_modal_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_user_details_modal_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_user_details_modal_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_user_details_modal_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.user_details_modal_root.id\n  http_method = aws_api_gateway_method.user_details_modal_root_options.http_method\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_user_details_modal_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.user_details_modal_root.id\n  http_method = aws_api_gateway_method.user_details_modal_root_options.http_method\n  status_code = aws_api_gateway_method_response.user_details_modal_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_user_details_modal_root_options]\n\n}\n\n\n#########################################################################################################################\n\n\n\n#  DELETE-USER\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"delete_user_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"delete-user\"\n}\nresource \"aws_api_gateway_method\" \"proxy_delete_user_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.delete_user_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_delete_user_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.delete_user_root.id\n  http_method = aws_api_gateway_method.proxy_delete_user_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"delete_user_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.delete_user_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"delete_user_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.delete_user_root.id\n  http_method = aws_api_gateway_method.delete_user_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_integration\" \"lambda_delete_user_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.delete_user_root.id\n  http_method = aws_api_gateway_method.proxy_delete_user_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_delete_user_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.delete_user_root.id\n  http_method = aws_api_gateway_method.proxy_delete_user_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_delete_user_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_delete_user_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_delete_user_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.delete_user_root.id\n  http_method = aws_api_gateway_method.delete_user_root_options.http_method\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_delete_user_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.delete_user_root.id\n  http_method = aws_api_gateway_method.delete_user_root_options.http_method\n  status_code = aws_api_gateway_method_response.delete_user_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_delete_user_root_options]\n\n}\n\n\n#########################################################################################################################\n\n\n\n#  CHANGE-AUTH\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"change_auth_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"change-auth\"\n}\nresource \"aws_api_gateway_method\" \"proxy_change_auth_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.change_auth_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_change_auth_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_auth_root.id\n  http_method = aws_api_gateway_method.proxy_change_auth_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"change_auth_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.change_auth_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"change_auth_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_auth_root.id\n  http_method = aws_api_gateway_method.change_auth_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_integration\" \"lambda_change_auth_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_auth_root.id\n  http_method = aws_api_gateway_method.proxy_change_auth_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_change_auth_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_auth_root.id\n  http_method = aws_api_gateway_method.proxy_change_auth_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_change_auth_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_change_auth_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_change_auth_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_auth_root.id\n  http_method = aws_api_gateway_method.change_auth_root_options.http_method\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_change_auth_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_auth_root.id\n  http_method = aws_api_gateway_method.change_auth_root_options.http_method\n  status_code = aws_api_gateway_method_response.change_auth_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_change_auth_root_options]\n\n}\n\n\n#########################################################################################################################\n\n\n\n#  MODIFY-POST-STATUS\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"modify_post_status_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"modify-post-status\"\n}\nresource \"aws_api_gateway_method\" \"proxy_modify_post_status_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.modify_post_status_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_modify_post_status_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.modify_post_status_root.id\n  http_method = aws_api_gateway_method.proxy_modify_post_status_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"modify_post_status_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.modify_post_status_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"modify_post_status_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.modify_post_status_root.id\n  http_method = aws_api_gateway_method.modify_post_status_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_integration\" \"lambda_modify_post_status_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.modify_post_status_root.id\n  http_method = aws_api_gateway_method.proxy_modify_post_status_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_modify_post_status_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.modify_post_status_root.id\n  http_method = aws_api_gateway_method.proxy_modify_post_status_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_modify_post_status_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_modify_post_status_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_modify_post_status_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.modify_post_status_root.id\n  http_method = aws_api_gateway_method.modify_post_status_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_modify_post_status_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.modify_post_status_root.id\n  http_method = aws_api_gateway_method.modify_post_status_root_options.http_method\n  status_code = aws_api_gateway_method_response.modify_post_status_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_modify_post_status_root_options]\n\n}\n\n#########################################################################################################################\n\n\n# GET-DASHBOARD\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"get_dashboard_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"get-dashboard\"\n}\nresource \"aws_api_gateway_method\" \"proxy_get_dashboard_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.get_dashboard_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_get_dashboard_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_dashboard_root.id\n  http_method = aws_api_gateway_method.proxy_get_dashboard_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"get_dashboard_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.get_dashboard_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"get_dashboard_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_dashboard_root.id\n  http_method = aws_api_gateway_method.get_dashboard_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_integration\" \"lambda_get_dashboard_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_dashboard_root.id\n  http_method = aws_api_gateway_method.proxy_get_dashboard_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_get_dashboard_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_dashboard_root.id\n  http_method = aws_api_gateway_method.proxy_get_dashboard_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_get_dashboard_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_get_dashboard_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_get_dashboard_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_dashboard_root.id\n  http_method = aws_api_gateway_method.get_dashboard_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_get_dashboard_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.get_dashboard_root.id\n  http_method = aws_api_gateway_method.get_dashboard_root_options.http_method\n  status_code = aws_api_gateway_method_response.get_dashboard_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_get_dashboard_root_options]\n\n}\n\n#########################################################################################################################\n\n\n\n# CHANGE-PROFILE\n#########################################################################################################################\nresource \"aws_api_gateway_resource\" \"change_profile_root\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  parent_id   = aws_api_gateway_rest_api.apiLambda_ba.root_resource_id\n  path_part   = \"change-profile\"\n}\nresource \"aws_api_gateway_method\" \"proxy_change_profile_root_post\" {\n  rest_api_id   = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id   = aws_api_gateway_resource.change_profile_root.id\n  http_method   = \"POST\"\n  authorization = \"NONE\"\n\n}\nresource \"aws_api_gateway_method_response\" \"proxy_change_profile_root_post_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_profile_root.id\n  http_method = aws_api_gateway_method.proxy_change_profile_root_post.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\nresource \"aws_api_gateway_method\" \"change_profile_root_options\" {\n  rest_api_id        = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id        = aws_api_gateway_resource.change_profile_root.id\n  http_method        = \"OPTIONS\"\n  authorization      = \"NONE\"\n  request_parameters = { \"method.request.header.JWT_TOKEN\" = false }\n\n}\nresource \"aws_api_gateway_method_response\" \"change_profile_root_options_response_200\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_profile_root.id\n  http_method = aws_api_gateway_method.change_profile_root_options.http_method\n  status_code = 200\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\"     = true,\n    \"method.response.header.Access-Control-Allow-Methods\"     = true,\n    \"method.response.header.Access-Control-Allow-Origin\"      = true,\n    \"method.response.header.Access-Control-Allow-Credentials\" = true\n  }\n  response_models = {\n    \"application/json\" = \"Empty\"\n  }\n}\n\n\nresource \"aws_api_gateway_integration\" \"lambda_change_profile_root_post\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_profile_root.id\n  http_method = aws_api_gateway_method.proxy_change_profile_root_post.http_method\n\n  integration_http_method = \"POST\"\n  type                    = \"AWS_PROXY\"\n  uri                     = aws_lambda_function.lambda_ba_data.invoke_arn\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_change_profile_root_post_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_profile_root.id\n  http_method = aws_api_gateway_method.proxy_change_profile_root_post.http_method\n  status_code = aws_api_gateway_method_response.proxy_change_profile_root_post_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n  depends_on = [aws_api_gateway_integration.lambda_change_profile_root_post]\n\n}\n\nresource \"aws_api_gateway_integration\" \"lambda_change_profile_root_options\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_profile_root.id\n  http_method = aws_api_gateway_method.change_profile_root_options.http_method\n\n\n  type                 = \"MOCK\"\n  passthrough_behavior = \"WHEN_NO_MATCH\"\n\n  request_templates = {\n    \"application/json\" = jsonencode(\n      {\n        statusCode = 200\n      }\n    )\n  }\n}\nresource \"aws_api_gateway_integration_response\" \"lambda_change_profile_root_options_integration_response\" {\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  resource_id = aws_api_gateway_resource.change_profile_root.id\n  http_method = aws_api_gateway_method.change_profile_root_options.http_method\n  status_code = aws_api_gateway_method_response.change_profile_root_options_response_200.status_code\n\n\n  response_parameters = {\n    \"method.response.header.Access-Control-Allow-Headers\" = \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,JWT_TOKEN'\",\n    \"method.response.header.Access-Control-Allow-Methods\" = \"'DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT'\",\n    \"method.response.header.Access-Control-Allow-Origin\"  = \"'*'\",\n\n  }\n\n\n\n  depends_on = [aws_api_gateway_integration.lambda_change_profile_root_options]\n\n}\n\n#########################################################################################################################\n\n\n/* Deploying the API with stage name i.e data */\n\nresource \"aws_api_gateway_deployment\" \"apideploy_ba\" {\n  depends_on = [\n    aws_api_gateway_integration_response.save_content_root_options_integration_response,\n    aws_api_gateway_integration_response.search_author_root_options_integration_response,\n\n\n    aws_api_gateway_integration_response.lambda_xss_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_xss_root_post_response_200,\n    aws_api_gateway_integration.lambda_xss_root_post,\n\n    aws_api_gateway_integration_response.lambda_ban_user_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_ban_user_root_post_response_200,\n    aws_api_gateway_integration.lambda_ban_user_root_post,\n\n    aws_api_gateway_integration_response.lambda_change_password_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_change_password_root_post_response_200,\n    aws_api_gateway_integration.lambda_change_password_root_post,\n\n    aws_api_gateway_integration_response.lambda_dump_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_dump_root_get_response_200,\n    aws_api_gateway_integration.lambda_dump_root_post,\n\n    aws_api_gateway_integration_response.lambda_list_posts_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_list_posts_root_post_response_200,\n    aws_api_gateway_integration.lambda_list_posts_root_post,\n\n    aws_api_gateway_integration_response.lambda_login_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_login_root_post_response_200,\n    aws_api_gateway_integration.lambda_login_root_post,\n\n    aws_api_gateway_integration_response.lambda_register_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_register_root_post_response_200,\n    aws_api_gateway_integration.lambda_register_root_post,\n\n    aws_api_gateway_integration_response.lambda_save_post_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_save_post_root_post_response_200,\n    aws_api_gateway_integration.lambda_save_post_root_post,\n\n    aws_api_gateway_integration_response.lambda_verify_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_verify_root_post_response_200,\n    aws_api_gateway_integration.lambda_verify_root_post,\n\n    aws_api_gateway_integration_response.lambda_xss_root_options_integration_response,\n    aws_api_gateway_method_response.xss_root_options_response_200,\n    aws_api_gateway_integration.lambda_xss_root_options,\n\n    aws_api_gateway_integration_response.lambda_ban_user_root_options_integration_response,\n    aws_api_gateway_method_response.ban_user_root_options_response_200,\n    aws_api_gateway_integration.lambda_ban_user_root_options,\n\n    aws_api_gateway_integration_response.lambda_change_password_root_options_integration_response,\n    aws_api_gateway_method_response.change_password_root_options_response_200,\n    aws_api_gateway_integration.lambda_change_password_root_options,\n\n    aws_api_gateway_integration_response.lambda_dump_root_options_integration_response,\n    aws_api_gateway_method_response.dump_root_options_response_200,\n    aws_api_gateway_integration.lambda_dump_root_options,\n\n    aws_api_gateway_integration_response.lambda_list_posts_root_options_integration_response,\n    aws_api_gateway_method_response.list_posts_root_options_response_200,\n    aws_api_gateway_integration.lambda_list_posts_root_options,\n\n    aws_api_gateway_integration_response.lambda_login_root_options_integration_response,\n    aws_api_gateway_method_response.login_root_options_response_200,\n    aws_api_gateway_integration.lambda_login_root_options,\n\n    aws_api_gateway_integration_response.lambda_register_root_options_integration_response,\n    aws_api_gateway_method_response.register_root_options_response_200,\n    aws_api_gateway_integration.lambda_register_root_options,\n\n    aws_api_gateway_integration_response.lambda_save_post_root_options_integration_response,\n    aws_api_gateway_method_response.save_post_root_options_response_200,\n    aws_api_gateway_integration.lambda_save_post_root_options,\n\n    aws_api_gateway_integration_response.lambda_verify_root_options_integration_response,\n    aws_api_gateway_method_response.verify_root_options_response_200,\n    aws_api_gateway_integration.lambda_verify_root_options,\n\n    # Moved to one api\n\n    aws_api_gateway_integration_response.lambda_save_content_root_get_integration_response,\n    aws_api_gateway_method_response.proxy_save_content_root_get_response_200,\n    aws_api_gateway_integration.lambda_save_content_root_get,\n\n    aws_api_gateway_integration_response.lambda_save_content_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_save_content_root_post_response_200,\n    aws_api_gateway_integration.lambda_save_content_root_post,\n\n    aws_api_gateway_integration_response.lambda_search_author_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_search_author_root_post_response_200,\n    aws_api_gateway_integration.lambda_search_author_root_post,\n\n\n    # New ones\n\n    aws_api_gateway_integration_response.lambda_get_users_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_get_users_root_post_response_200,\n    aws_api_gateway_integration.lambda_get_users_root_post,\n\n    aws_api_gateway_integration_response.lambda_reset_password_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_reset_password_root_post_response_200,\n    aws_api_gateway_integration.lambda_reset_password_root_post,\n\n    aws_api_gateway_integration_response.lambda_unban_user_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_unban_user_root_post_response_200,\n    aws_api_gateway_integration.lambda_unban_user_root_post,\n\n    aws_api_gateway_integration_response.lambda_delete_user_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_delete_user_root_post_response_200,\n    aws_api_gateway_integration.lambda_delete_user_root_post,\n\n    aws_api_gateway_integration_response.lambda_change_auth_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_change_auth_root_post_response_200,\n    aws_api_gateway_integration.lambda_change_auth_root_post,\n\n    aws_api_gateway_integration_response.lambda_modify_post_status_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_modify_post_status_root_post_response_200,\n    aws_api_gateway_integration.lambda_modify_post_status_root_post,\n\n    aws_api_gateway_integration_response.lambda_get_dashboard_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_get_dashboard_root_post_response_200,\n    aws_api_gateway_integration.lambda_get_dashboard_root_post,\n\n    aws_api_gateway_integration_response.lambda_change_profile_root_post_integration_response,\n    aws_api_gateway_method_response.proxy_change_profile_root_post_response_200,\n    aws_api_gateway_integration.lambda_change_profile_root_post,\n  ]\n\n  rest_api_id = aws_api_gateway_rest_api.apiLambda_ba.id\n  stage_name  = \"v1\"\n  variables = {\n    \"BLOG_KEY\" = \"655877f0f8ade541e1d21a48fe396ddb\"\n  }\n}\n\n/* Lambda Setup - blog-application-data*/\n\ndata \"archive_file\" \"lambda_zip_bap\" {\n  type        = \"zip\"\n  source_file = \"resources/lambda/data/lambda_function.py\"\n  output_path = \"resources/lambda/out/data_app.zip\"\n  depends_on = [\n    null_resource.file_replacement_lambda_data\n  ]\n}\nresource \"aws_lambda_layer_version\" \"lambda_layer\" {\n  filename                 = \"resources/lambda/layer/bcrypt-pyjwt.zip\"\n  layer_name               = \"bcrypt-pyjwt\"\n  compatible_architectures = [\"x86_64\"]\n  compatible_runtimes      = [\"python3.9\"]\n}\n\nresource \"aws_lambda_function\" \"lambda_ba_data\" {\n  filename      = \"resources/lambda/out/data_app.zip\"\n  function_name = \"blog-application-data\"\n  handler       = \"lambda_function.lambda_handler\"\n  runtime       = \"python3.9\"\n  role          = aws_iam_role.blog_app_lambda_python.arn\n  depends_on    = [data.archive_file.lambda_zip_bap]\n  layers        = [aws_lambda_layer_version.lambda_layer.arn]\n  memory_size   = \"256\"\n  environment {\n    variables = {\n      JWT_SECRET = \"T2BYL6#]zc>Byuzu\"\n    }\n  }\n}\n\n\n/* Lambda iam Role */\n\nresource \"aws_iam_role\" \"blog_app_lambda_python\" {\n  name = \"blog_app_lambda_data\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n\n\nresource \"aws_iam_role_policy_attachment\" \"blog_app_policy\" {\n  role       = aws_iam_role.blog_app_lambda_python.name\n  policy_arn = aws_iam_policy.lambda_data_policies.arn\n}\n\nresource \"aws_iam_policy\" \"lambda_data_policies\" {\n  name = \"lambda-data-policies\"\n  policy = jsonencode({\n    \"Statement\" : [\n      {\n        \"Action\" : [\n          \"s3:*\",\n          \"s3-object-lambda:*\",\n          \"autoscaling:Describe*\",\n          \"cloudwatch:*\",\n          \"logs:*\",\n          \"sns:*\",\n          \"dynamodb:*\",\n          \"dax:*\",\n          \"lambda:*\"\n        ],\n        \"Effect\" : \"Allow\",\n        \"Resource\" : \"*\",\n        \"Sid\" : \"Pol1\"\n      },\n      {\n        \"Effect\" : \"Allow\",\n        \"Action\" : [\n          \"execute-api:Invoke\",\n          \"execute-api:ManageConnections\"\n        ],\n        \"Resource\" : \"arn:aws:execute-api:*:*:*\"\n      }\n    ],\n    \"Version\" : \"2012-10-17\"\n  })\n}\n\n\nresource \"aws_lambda_permission\" \"apigw_ba_python\" {\n  statement_id  = \"AllowAPIGatewayInvoke\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.lambda_ba_data.function_name\n  principal     = \"apigateway.amazonaws.com\"\n  source_arn    = \"${aws_api_gateway_rest_api.apiLambda_ba.execution_arn}/*/*\"\n}\n\n\n\n# s3 bucket for all dev files & folder for post images\n\n\n/* Local Variable for mime_types */\n\nlocals {\n  content_type_map = {\n    html = \"text/html\",\n    js   = \"application/javascript\",\n    css  = \"text/css\",\n    svg  = \"image/svg+xml\",\n    jpg  = \"image/jpeg\",\n    ico  = \"image/x-icon\",\n    png  = \"image/png\",\n    sh   = \"application/x-sh\"\n  }\n}\n\n\n\n\n/* Creating a S3 Bucket for webfiles files upload. */\nresource \"aws_s3_bucket\" \"bucket_upload\" {\n  bucket        = \"production-blog-awsgoat-bucket-${data.aws_caller_identity.current.account_id}\"\n  force_destroy = true\n  tags = {\n    Name        = \"Production bucket\"\n    Environment = \"Prod\"\n  }\n}\n\n# ACL fixes required for AWS S3 APR 2023 updates.\nresource \"aws_s3_bucket_public_access_block\" \"bucket_upload\" {\n  bucket = aws_s3_bucket.bucket_upload.id\n\n  block_public_acls       = false\n  block_public_policy     = false\n  ignore_public_acls      = false\n  restrict_public_buckets = false\n}\n\nresource \"aws_s3_bucket_ownership_controls\" \"bucket_upload\" {\n  bucket = aws_s3_bucket.bucket_upload.id\n  rule {\n    object_ownership = \"BucketOwnerPreferred\"\n  }\n}\n\nresource \"aws_s3_bucket_acl\" \"bucket_upload\" {\n  depends_on = [\n\taws_s3_bucket_public_access_block.bucket_upload,\n\taws_s3_bucket_ownership_controls.bucket_upload,\n  ]\n\n  bucket = aws_s3_bucket.bucket_upload.id\n  acl    = \"private\"\n}\n\nresource \"aws_s3_bucket_policy\" \"allow_access_for_prod\" {\n  bucket = aws_s3_bucket.bucket_upload.id\n  policy = data.aws_iam_policy_document.allow_get_access.json\n\n  depends_on = [ aws_s3_bucket_acl.bucket_upload ]\n}\ndata \"aws_iam_policy_document\" \"allow_get_access\" {\n  statement {\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"*\"]\n    }\n    actions = [\"s3:GetObject\"]\n    resources = [\n      aws_s3_bucket.bucket_upload.arn,\n      \"${aws_s3_bucket.bucket_upload.arn}/*\",\n    ]\n  }\n}\nresource \"aws_s3_bucket_cors_configuration\" \"bucket_upload\" {\n  bucket = aws_s3_bucket.bucket_upload.bucket\n\n  cors_rule {\n    allowed_headers = [\"*\"]\n    allowed_methods = [\"PUT\", \"POST\", \"GET\"]\n    allowed_origins = [\"*\"]\n    expose_headers  = [\"ETag\"]\n    max_age_seconds = 3000\n  }\n\n  cors_rule {\n    allowed_methods = [\"GET\", \"POST\", \"PUT\"]\n    allowed_origins = [\"*\"]\n  }\n  depends_on = [aws_s3_bucket_acl.bucket_upload]\n}\n# Upload in production bucket\n\nresource \"aws_s3_object\" \"upload_folder_prod\" {\n  for_each     = fileset(\"./resources/s3/webfiles/\", \"**\")\n  bucket       = aws_s3_bucket.bucket_upload.bucket\n  key          = each.value\n  acl          = \"public-read\"\n  source       = \"./resources/s3/webfiles/${each.value}\"\n  content_type = lookup(local.content_type_map, regex(\"\\\\.(?P<extension>[A-Za-z0-9]+)$\", each.value).extension, \"application/octet-stream\")\n  depends_on   = [aws_s3_bucket.bucket_upload, null_resource.file_replacement_api_gw, aws_s3_bucket_acl.bucket_upload]\n}\n\n\n#Development bucket\nresource \"aws_s3_bucket\" \"dev\" {\n  bucket = \"dev-blog-awsgoat-bucket-${data.aws_caller_identity.current.account_id}\"\n\n  tags = {\n    Name        = \"Development bucket\"\n    Environment = \"Dev\"\n  }\n}\n\n\n# ACL fixes required for AWS S3 APR 2023 updates.\nresource \"aws_s3_bucket_public_access_block\" \"dev\" {\n  bucket = aws_s3_bucket.dev.id\n\n  block_public_acls       = false\n  block_public_policy     = false\n  ignore_public_acls      = false\n  restrict_public_buckets = false\n}\n\nresource \"aws_s3_bucket_ownership_controls\" \"dev\" {\n  bucket = aws_s3_bucket.dev.id\n  rule {\n    object_ownership = \"BucketOwnerPreferred\"\n  }\n}\n\nresource \"aws_s3_bucket_acl\" \"dev\" {\n  depends_on = [\n\taws_s3_bucket_public_access_block.dev,\n\taws_s3_bucket_ownership_controls.dev,\n  ]\n\n  bucket = aws_s3_bucket.dev.id\n  acl    = \"public-read\"\n}\n\nresource \"aws_s3_bucket_policy\" \"allow_access_for_dev\" {\n  bucket = aws_s3_bucket.dev.bucket\n  policy = data.aws_iam_policy_document.allow_get_list_access.json\n\n  depends_on = [ aws_s3_bucket_acl.dev ]\n}\ndata \"aws_iam_policy_document\" \"allow_get_list_access\" {\n  statement {\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"*\"]\n    }\n    actions = [\"s3:GetObject\", \"s3:ListBucket\"]\n    resources = [\n      aws_s3_bucket.dev.arn,\n      \"${aws_s3_bucket.dev.arn}/*\",\n    ]\n  }\n}\n# Upload in dev bucket\n\nresource \"aws_s3_object\" \"upload_folder_dev\" {\n  for_each     = fileset(\"./resources/s3/webfiles/build/\", \"**\")\n  bucket       = aws_s3_bucket.dev.bucket\n  key          = each.value\n  acl          = \"public-read\"\n  source       = \"./resources/s3/webfiles/build/${each.value}\"\n  content_type = lookup(local.content_type_map, regex(\"\\\\.(?P<extension>[A-Za-z0-9]+)$\", each.value).extension, \"application/octet-stream\")\n  depends_on   = [aws_s3_bucket.dev, null_resource.file_replacement_ec2_ip, aws_s3_bucket_acl.dev]\n}\n\nresource \"aws_s3_object\" \"upload_folder_dev_2\" {\n  for_each     = fileset(\"./resources/s3/shared/\", \"**\")\n  bucket       = aws_s3_bucket.dev.bucket\n  key          = each.value\n  acl          = \"public-read\"\n  source       = \"./resources/s3/shared/${each.value}\"\n  content_type = lookup(local.content_type_map, regex(\"\\\\.(?P<extension>[A-Za-z0-9]+)$\", each.value).extension, \"application/octet-stream\")\n  depends_on   = [aws_s3_bucket.dev, null_resource.file_replacement_ec2_ip, aws_s3_bucket_acl.dev]\n}\n\n\n/* Creating a S3 Bucket for ec2-files upload. */\nresource \"aws_s3_bucket\" \"bucket_temp\" {\n  bucket        = \"ec2-temp-bucket-${data.aws_caller_identity.current.account_id}\"\n  force_destroy = true\n\n  tags = {\n    Name        = \"Temporary bucket\"\n    Environment = \"Dev\"\n  }\n}\n\n# ACL fixes required for AWS S3 APR 2023 updates.\nresource \"aws_s3_bucket_public_access_block\" \"bucket_temp\" {\n  bucket = aws_s3_bucket.bucket_temp.id\n\n  block_public_acls       = false\n  block_public_policy     = false\n  ignore_public_acls      = false\n  restrict_public_buckets = false\n}\n\nresource \"aws_s3_bucket_ownership_controls\" \"bucket_temp\" {\n  bucket = aws_s3_bucket.bucket_temp.id\n  rule {\n    object_ownership = \"BucketOwnerPreferred\"\n  }\n}\n\nresource \"aws_s3_bucket_acl\" \"bucket_temp\" {\n  depends_on = [\n\taws_s3_bucket_public_access_block.bucket_temp,\n\taws_s3_bucket_ownership_controls.bucket_temp,\n  ]\n\n  bucket = aws_s3_bucket.bucket_temp.id\n  acl    = \"public-read\"\n}\n\n/* Uploading all files to ec2-temp-bucket-ACCOUNT_ID bucket */\n\nresource \"aws_s3_object\" \"upload_temp_object\" {\n  for_each     = fileset(\"./resources/s3/webfiles/build/\", \"**\")\n  acl          = \"public-read\"\n  bucket       = aws_s3_bucket.bucket_temp.bucket\n  key          = each.value\n  source       = \"./resources/s3/webfiles/build/${each.value}\"\n  content_type = lookup(local.content_type_map, regex(\"\\\\.(?P<extension>[A-Za-z0-9]+)$\", each.value).extension, \"application/octet-stream\")\n  depends_on   = [aws_s3_bucket.bucket_upload, null_resource.file_replacement_lambda_react, aws_s3_bucket_acl.bucket_temp]\n}\n\nresource \"aws_s3_object\" \"upload_temp_object_2\" {\n  for_each     = fileset(\"./resources/s3/shared/\", \"**\")\n  acl          = \"public-read\"\n  bucket       = aws_s3_bucket.bucket_temp.bucket\n  key          = each.value\n  source       = \"./resources/s3/shared/${each.value}\"\n  content_type = lookup(local.content_type_map, regex(\"\\\\.(?P<extension>[A-Za-z0-9]+)$\", each.value).extension, \"application/octet-stream\")\n  depends_on   = [aws_s3_bucket.bucket_upload, null_resource.file_replacement_lambda_react, aws_s3_bucket_acl.bucket_temp]\n}\n/* Creating a S3 Bucket for Terraform state file upload. */\nresource \"aws_s3_bucket\" \"bucket_tf_files\" {\n  bucket        = \"do-not-delete-awsgoat-state-files-${data.aws_caller_identity.current.account_id}\"\n  force_destroy = true\n  tags = {\n    Name        = \"Do not delete Bucket\"\n    Environment = \"Dev\"\n  }\n}\n\n\n# VPC to deploy web app\n\nresource \"aws_vpc\" \"goat_vpc\" {\n  cidr_block           = \"192.168.0.0/16\"\n  instance_tenancy     = \"default\"\n  enable_dns_hostnames = true\n  tags = {\n    Name = \"AWS_GOAT_VPC\"\n  }\n}\nresource \"aws_internet_gateway\" \"goat_gw\" {\n  vpc_id = aws_vpc.goat_vpc.id\n  tags = {\n    Name = \"app gateway\"\n  }\n}\nresource \"aws_subnet\" \"goat_subnet\" {\n  vpc_id                  = aws_vpc.goat_vpc.id\n  cidr_block              = \"192.168.0.0/24\"\n  availability_zone       = \"us-east-1a\"\n  map_public_ip_on_launch = true\n  tags = {\n    Name = \"AWS_GOAT App subnet\"\n  }\n}\n\nresource \"aws_route_table\" \"goat_rt\" {\n  vpc_id = aws_vpc.goat_vpc.id\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.goat_gw.id\n  }\n}\nresource \"aws_route_table_association\" \"goat_public_rta\" {\n  subnet_id      = aws_subnet.goat_subnet.id\n  route_table_id = aws_route_table.goat_rt.id\n}\n\nresource \"aws_security_group\" \"goat_sg\" {\n  name        = \"AWS_GOAT_sg\"\n  description = \"AWS_GOAT_sg\"\n  vpc_id      = aws_vpc.goat_vpc.id\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"AWS_GOAT_sg\"\n  }\n}\n\n\n# Instance Requirements\nresource \"aws_iam_instance_profile\" \"goat_iam_profile\" {\n  name = \"AWS_GOAT_ec2_profile\"\n  role = aws_iam_role.goat_role.name\n}\nresource \"aws_iam_role\" \"goat_role\" {\n  name               = \"AWS_GOAT_ROLE\"\n  path               = \"/\"\n  assume_role_policy = <<EOF\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Action\": \"sts:AssumeRole\",\n            \"Principal\": {\n               \"Service\": \"ec2.amazonaws.com\"\n            },\n            \"Effect\": \"Allow\",\n            \"Sid\": \"\"\n        }\n    ]\n}\nEOF\n}\nresource \"aws_iam_role_policy_attachment\" \"goat_s3_policy\" {\n  role       = aws_iam_role.goat_role.name\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonS3FullAccess\"\n}\n\n\nresource \"aws_iam_role_policy_attachment\" \"goat_policy\" {\n  role       = aws_iam_role.goat_role.name\n  policy_arn = aws_iam_policy.goat_inline_policy_2.arn\n}\n\nresource \"aws_iam_policy\" \"goat_inline_policy_2\" {\n  name = \"dev-ec2-lambda-policies\"\n  policy = jsonencode({\n    \"Statement\" : [\n      {\n        \"Action\" : [\n          \"lambda:UpdateFunctionCode\",\n          \"lambda:UpdateFunctionEventInvokeConfig\",\n          \"lambda:AddPermission\",\n          \"lambda:InvokeFunction\",\n          \"lambda:GetLayerVersion\",\n          \"lambda:ListVersionsByFunction\",\n          \"lambda:UpdateFunctionConfiguration\",\n          \"lambda:GetFunctionConfiguration\",\n          \"lambda:GetLayerVersionPolicy\",\n          \"lambda:GetPolicy\",\n          \"iam:AttachRolePolicy\"\n        ],\n        \"Effect\" : \"Allow\",\n        \"Resource\" : [\"${aws_lambda_function.lambda_ba_data.arn}\", \"${aws_iam_role.blog_app_lambda_python.arn}\"],\n        \"Sid\" : \"Pol0\"\n      },\n      {\n        \"Action\" : [\n          \"iam:ListPolicies\",\n          \"iam:GetRole\",\n          \"iam:GetPolicyVersion\",\n          \"lambda:ListFunctions\",\n          \"iam:GetInstanceProfile\",\n          \"iam:GetPolicy\",\n          \"iam:ListRoles\",\n          \"iam:ListInstanceProfileTags\",\n          \"iam:ListInstanceProfiles\",\n          \"iam:CreatePolicy\",\n          \"iam:ListInstanceProfilesForRole\",\n          \"iam:PassRole\",\n          \"iam:ListPolicyVersions\",\n          \"iam:ListAttachedRolePolicies\",\n          \"lambda:ListLayerVersions\",\n          \"iam:UpdateRole\",\n          \"iam:ListRolePolicies\",\n          \"iam:GetRolePolicy\"\n        ],\n        \"Effect\" : \"Allow\",\n        \"Resource\" : \"*\",\n        \"Sid\" : \"Pol1\"\n      }\n    ],\n    \"Version\" : \"2012-10-17\"\n  })\n}\n\ndata \"template_file\" \"goat_script\" {\n  template = file(\"resources/ec2/goat_user_data.tpl\")\n  vars = {\n    S3_BUCKET_NAME = aws_s3_bucket.bucket_temp.bucket\n  }\n  depends_on = [aws_s3_bucket.bucket_temp]\n}\n\n\ndata \"aws_ami\" \"goat_ami\" {\n  most_recent = true\n  filter {\n    name   = \"name\"\n    values = [\"amzn2-ami-hvm-*-x86_64-ebs\"]\n  }\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n  owners = [\"amazon\"]\n}\n\nresource \"aws_instance\" \"goat_instance\" {\n  ami                  = data.aws_ami.goat_ami.id\n  instance_type        = \"t2.micro\"\n  iam_instance_profile = aws_iam_instance_profile.goat_iam_profile.name\n  subnet_id            = aws_subnet.goat_subnet.id\n  security_groups      = [aws_security_group.goat_sg.id]\n  tags = {\n    Name = \"AWS_GOAT_DEV_INSTANCE\"\n  }\n  user_data = data.template_file.goat_script.rendered\n  depends_on = [\n    aws_s3_object.upload_temp_object_2\n  ]\n}\n\n\nresource \"aws_dynamodb_table\" \"users_table\" {\n  name           = \"blog-users\"\n  billing_mode   = \"PROVISIONED\"\n  read_capacity  = 2\n  write_capacity = 2\n\n  hash_key = \"email\"\n  attribute {\n    name = \"email\"\n    type = \"S\"\n  }\n}\nresource \"aws_dynamodb_table\" \"posts_table\" {\n  name           = \"blog-posts\"\n  billing_mode   = \"PROVISIONED\"\n  read_capacity  = 2\n  write_capacity = 2\n\n  hash_key = \"id\"\n  attribute {\n    name = \"id\"\n    type = \"S\"\n  }\n}\n\n\nresource \"null_resource\" \"populate_table\" {\n  provisioner \"local-exec\" {\n    command     = <<EOF\nsed -i 's/replace-bucket-name/${aws_s3_bucket.bucket_upload.bucket}/g' resources/dynamodb/blog-posts.json\npython3 resources/dynamodb/populate-table.py\nEOF\n    interpreter = [\"/bin/bash\", \"-c\"]\n  }\n  depends_on = [aws_s3_bucket.bucket_upload, aws_dynamodb_table.users_table, aws_dynamodb_table.posts_table]\n}\n\n\n# To replace with IP Address of EC2-Instance in .ssh/config\nresource \"null_resource\" \"file_replacement_ec2_ip\" {\n  provisioner \"local-exec\" {\n    command     = \"sed -i 's/EC2_IP_ADDR/${aws_instance.goat_instance.public_ip}/g' resources/s3/shared/shared/files/.ssh/config.txt\"\n    interpreter = [\"/bin/bash\", \"-c\"]\n  }\n  depends_on = [aws_instance.goat_instance]\n}\n\n\nresource \"null_resource\" \"file_replacement_lambda_react\" {\n  provisioner \"local-exec\" {\n    command     = \"sed -i 's/replace-bucket-name/${aws_s3_bucket.bucket_upload.bucket}/g' resources/lambda/react/index.js\"\n    interpreter = [\"/bin/bash\", \"-c\"]\n  }\n  depends_on = [\n    aws_s3_bucket.bucket_upload\n  ]\n}\n\nresource \"null_resource\" \"file_replacement_lambda_data\" {\n  provisioner \"local-exec\" {\n    command     = \"sed -i 's/replace-bucket-name/${aws_s3_bucket.bucket_upload.bucket}/g' resources/lambda/data/lambda_function.py\"\n    interpreter = [\"/bin/bash\", \"-c\"]\n  }\n  depends_on = [\n    aws_s3_bucket.bucket_upload\n  ]\n}\n\n\nresource \"null_resource\" \"file_replacement_api_gw\" {\n  provisioner \"local-exec\" {\n    command     = <<EOF\nsed -i \"s,API_GATEWAY_URL,${aws_api_gateway_deployment.apideploy_ba.invoke_url},g\" resources/s3/webfiles/build/static/js/main.e5839717.js\nsed -i \"s,API_GATEWAY_URL,${aws_api_gateway_deployment.apideploy_ba.invoke_url},g\" resources/s3/webfiles/build/static/js/main.e5839717.js.map\nsed -i 's/\"\\/static/\"https:\\/\\/${aws_s3_bucket.bucket_upload.bucket}\\.s3\\.amazonaws\\.com\\/build\\/static/g' resources/s3/webfiles/build/static/js/main.e5839717.js\nsed -i 's/n.p+\"static/\"https:\\/\\/${aws_s3_bucket.bucket_upload.bucket}\\.s3\\.amazonaws\\.com\\/build\\/static/g' resources/s3/webfiles/build/static/js/main.e5839717.js\nEOF\n    interpreter = [\"/bin/bash\", \"-c\"]\n  }\n  depends_on = [\n    aws_api_gateway_deployment.apideploy_ba\n  ]\n}\n\n/* Replace deployed api gateway url with API_GATEWAY_URL for local terraform reapply */\nresource \"null_resource\" \"file_replacement_api_gw_cleanup\" {\n  provisioner \"local-exec\" {\n    command     = <<EOF\nsed -i \"s,${aws_api_gateway_deployment.apideploy_ba.invoke_url},API_GATEWAY_URL,g\" resources/s3/webfiles/build/static/js/main.e5839717.js\nsed -i \"s,${aws_api_gateway_deployment.apideploy_ba.invoke_url},API_GATEWAY_URL,g\" resources/s3/webfiles/build/static/js/main.e5839717.js.map\nsed -i 's/${aws_instance.goat_instance.public_ip}/EC2_IP_ADDR/g' resources/s3/shared/shared/files/.ssh/config.txt\nEOF\n    interpreter = [\"/bin/bash\", \"-c\"]\n  }\n  depends_on = [\n    aws_s3_object.upload_temp_object, aws_s3_object.upload_temp_object_2, aws_s3_object.upload_folder_dev, aws_s3_object.upload_folder_dev_2, aws_s3_object.upload_folder_prod\n  ]\n}\n\n\noutput \"app_url\" {\n  value = \"${aws_api_gateway_stage.api.invoke_url}/react\"\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_283", "severity": "HIGH", "message": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3236}, {"tool": "checkov", "rule_id": "CKV_AWS_283", "severity": "HIGH", "message": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3323}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_237", "severity": "HIGH", "message": "Ensure Create before destroy for API Gateway", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 66}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 82}, {"tool": "checkov", "rule_id": "CKV_AWS_217", "severity": "HIGH", "message": "Ensure Create before destroy for API deployments", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 154}, {"tool": "checkov", "rule_id": "CKV_AWS_76", "severity": "HIGH", "message": "Ensure API Gateway has Access Logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 160}, {"tool": "checkov", "rule_id": "CKV_AWS_120", "severity": "HIGH", "message": "Ensure API Gateway caching is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 160}, {"tool": "checkov", "rule_id": "CKV_AWS_73", "severity": "HIGH", "message": "Ensure API Gateway has X-Ray Tracing enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 160}, {"tool": "checkov", "rule_id": "CKV_AWS_237", "severity": "HIGH", "message": "Ensure Create before destroy for API Gateway", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 172}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 192}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 321}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 459}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 600}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 742}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 877}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1017}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1151}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1288}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1426}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1508}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1616}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1746}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1878}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2010}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2144}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2277}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2409}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2541}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2672}, {"tool": "checkov", "rule_id": "CKV_AWS_59", "severity": "HIGH", "message": "Ensure there is no open access to back-end resources through API", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2804}, {"tool": "checkov", "rule_id": "CKV_AWS_217", "severity": "HIGH", "message": "Ensure Create before destroy for API deployments", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2931}, {"tool": "checkov", "rule_id": "CKV_AWS_363", "severity": "HIGH", "message": "Ensure Lambda Runtime is not deprecated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3083}, {"tool": "checkov", "rule_id": "CKV_AWS_272", "severity": "HIGH", "message": "Ensure AWS Lambda function is configured to validate code-signing", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3083}, {"tool": "checkov", "rule_id": "CKV_AWS_116", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3083}, {"tool": "checkov", "rule_id": "CKV_AWS_173", "severity": "HIGH", "message": "Check encryption settings for Lambda environmental variable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3083}, {"tool": "checkov", "rule_id": "CKV_AWS_115", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3083}, {"tool": "checkov", "rule_id": "CKV_AWS_117", "severity": "HIGH", "message": "Ensure that AWS Lambda function is configured inside a VPC", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3083}, {"tool": "checkov", "rule_id": "CKV_AWS_50", "severity": "HIGH", "message": "X-Ray tracing is enabled for Lambda", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3083}, {"tool": "checkov", "rule_id": "CKV_AWS_288", "severity": "HIGH", "message": "Ensure IAM policies does not allow data exfiltration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3128}, {"tool": "checkov", "rule_id": "CKV_AWS_289", "severity": "HIGH", "message": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3128}, {"tool": "checkov", "rule_id": "CKV_AWS_286", "severity": "HIGH", "message": "Ensure IAM policies does not allow privilege escalation", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3128}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3128}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3128}, {"tool": "checkov", "rule_id": "CKV_AWS_53", "severity": "HIGH", "message": "Ensure S3 bucket has block public ACLS enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3204}, {"tool": "checkov", "rule_id": "CKV_AWS_54", "severity": "HIGH", "message": "Ensure S3 bucket has block public policy enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3204}, {"tool": "checkov", "rule_id": "CKV_AWS_55", "severity": "HIGH", "message": "Ensure S3 bucket has ignore public ACLs enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3204}, {"tool": "checkov", "rule_id": "CKV_AWS_56", "severity": "HIGH", "message": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3204}, {"tool": "checkov", "rule_id": "CKV_AWS_53", "severity": "HIGH", "message": "Ensure S3 bucket has block public ACLS enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3291}, {"tool": "checkov", "rule_id": "CKV_AWS_54", "severity": "HIGH", "message": "Ensure S3 bucket has block public policy enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3291}, {"tool": "checkov", "rule_id": "CKV_AWS_55", "severity": "HIGH", "message": "Ensure S3 bucket has ignore public ACLs enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3291}, {"tool": "checkov", "rule_id": "CKV_AWS_56", "severity": "HIGH", "message": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3291}, {"tool": "checkov", "rule_id": "CKV_AWS_53", "severity": "HIGH", "message": "Ensure S3 bucket has block public ACLS enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3371}, {"tool": "checkov", "rule_id": "CKV_AWS_54", "severity": "HIGH", "message": "Ensure S3 bucket has block public policy enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3371}, {"tool": "checkov", "rule_id": "CKV_AWS_55", "severity": "HIGH", "message": "Ensure S3 bucket has ignore public ACLs enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3371}, {"tool": "checkov", "rule_id": "CKV_AWS_56", "severity": "HIGH", "message": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3371}, {"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3445}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3467}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3467}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3467}, {"tool": "checkov", "rule_id": "CKV_AWS_289", "severity": "HIGH", "message": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3525}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3525}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3599}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3599}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3599}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3599}, {"tool": "checkov", "rule_id": "CKV_AWS_28", "severity": "HIGH", "message": "Ensure DynamoDB point in time recovery (backup) is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3615}, {"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3615}, {"tool": "checkov", "rule_id": "CKV_AWS_28", "severity": "HIGH", "message": "Ensure DynamoDB point in time recovery (backup) is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3627}, {"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3627}, {"tool": "checkov", "rule_id": "CKV2_AWS_4", "severity": "CRITICAL", "message": "Ensure API Gateway stage have logging level defined as appropriate", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 160}, {"tool": "checkov", "rule_id": "CKV2_AWS_16", "severity": "CRITICAL", "message": "Ensure that Auto Scaling is enabled on your DynamoDB tables", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3615}, {"tool": "checkov", "rule_id": "CKV2_AWS_16", "severity": "CRITICAL", "message": "Ensure that Auto Scaling is enabled on your DynamoDB tables", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3627}, {"tool": "checkov", "rule_id": "CKV2_AWS_51", "severity": "CRITICAL", "message": "Ensure AWS API Gateway endpoints uses client certificate authentication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 160}, {"tool": "checkov", "rule_id": "CKV2_AWS_29", "severity": "CRITICAL", "message": "Ensure public API gateway are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 160}, {"tool": "checkov", "rule_id": "CKV2_AWS_65", "severity": "CRITICAL", "message": "Ensure access control lists for S3 buckets are disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3213}, {"tool": "checkov", "rule_id": "CKV2_AWS_65", "severity": "CRITICAL", "message": "Ensure access control lists for S3 buckets are disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3300}, {"tool": "checkov", "rule_id": "CKV2_AWS_65", "severity": "CRITICAL", "message": "Ensure access control lists for S3 buckets are disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3380}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3194}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3280}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3360}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3419}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3194}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3280}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3360}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3419}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3431}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3431}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3194}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3280}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3360}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3419}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3194}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3280}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3360}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3419}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3194}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3280}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3360}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3419}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3194}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3280}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3360}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3419}, {"tool": "checkov", "rule_id": "CKV_AWS_20", "severity": "HIGH", "message": "S3 Bucket has an ACL defined which allows public READ access.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3280}, {"tool": "checkov", "rule_id": "CKV_AWS_20", "severity": "HIGH", "message": "S3 Bucket has an ACL defined which allows public READ access.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3360}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3194}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3280}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3360}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 3419}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 82}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 192}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 215}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 321}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 345}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 459}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 483}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 600}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 625}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 742}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 767}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 877}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 901}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1017}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1041}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1151}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1175}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1288}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1312}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1426}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1450}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1508}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1616}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1640}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1746}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1771}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1878}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 1903}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2010}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2034}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2144}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2168}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2277}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2301}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2409}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2433}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2541}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2565}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2672}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2696}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2804}, {"tool": "checkov", "rule_id": "CKV2_AWS_53", "severity": "CRITICAL", "message": "Ensure AWS API gateway request is validated", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ine-labs__AWSGoat__modules__module-1__main.tf", "start_line": 2828}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Kubernetes Provider\nprovider \"kubernetes\" {}\n\n# AWS Provider\nprovider \"aws\" {\n  profile = \"root\"\n  region  = \"ap-south-1\"\n}\n\n# VPC data soruce\ndata \"aws_vpc\" \"def_vpc\" {\n  default = true\n}\n\n# Subnet data source\ndata \"aws_subnet_ids\" \"vpc_sub\" {\n  vpc_id = data.aws_vpc.def_vpc.id\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 5 - Terraform_WordPress_RDS__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"location\" {\n  description = \"The location where resources will be created\"\n}\n\nvariable \"tags\" {\n  description = \"A map of the tags to use for the resources that are deployed\"\n  type        = \"map\"\n\n  default = {\n    environment = \"codelab\"\n  }\n}\n\nvariable \"resource_group_name\" {\n  description = \"The name of the resource group in which the resources will be created\"\n  default     = \"myResourceGroup05\"\n}\n\nvariable \"application_port\" {\n  description = \"The port that you want to expose to the external load balancer\"\n  default     = 80\n}\n\nvariable \"admin_user\" {\n  description = \"User name to use as the admin account on the VMs that will be part of the VM Scale Set\"\n  default     = \"azureuser\"\n}\n\nvariable \"admin_password\" {\n  description = \"Default password for admin account\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__awesome-terraform__codelab-vmss__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"viuser\" {}\nvariable \"vipassword\" {}\nvariable \"viserver\" {}\n\n# Configure the VMware vSphere Provider\nprovider \"vsphere\" {\n  user           = var.viuser\n  password       = var.vipassword\n  vsphere_server = var.viserver\n\n  # if you have a self-signed cert\n  allow_unverified_ssl = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Terraform-VMWare-Modules__terraform-vsphere-vm__tests__smoke__connection.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// Configure the matchbox provider\nprovider \"matchbox\" {\n  endpoint    = var.matchbox_rpc_endpoint\n  client_cert = file(\"~/.matchbox/client.crt\")\n  client_key  = file(\"~/.matchbox/client.key\")\n  ca          = file(\"~/.matchbox/ca.crt\")\n}\n\nterraform {\n  required_providers {\n    ct = {\n      source  = \"poseidon/ct\"\n      version = \"0.14.0\"\n    }\n    matchbox = {\n      source  = \"poseidon/matchbox\"\n      version = \"0.5.4\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__matchbox__examples__terraform__flatcar-install__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.3\"\n\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \">= 3.0, < 4.0\"\n    }\n\n    random = {\n      source  = \"hashicorp/random\"\n      version = \">= 3.0\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform-azurerm-network__examples__startup__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"private_subnets\" {\n  value = [\"${aws_subnet.private.*.id}\"]\n}\n\noutput \"database_subnets\" {\n  value = [\"${aws_subnet.database.*.id}\"]\n}\n\noutput \"database_subnet_group\" {\n  value = \"${aws_db_subnet_group.database.id}\"\n}\n\noutput \"public_subnets\" {\n  value = [\"${aws_subnet.public.*.id}\"]\n}\n\noutput \"elasticache_subnets\" {\n  value = [\"${aws_subnet.elasticache.*.id}\"]\n}\n\noutput \"elasticache_subnet_group\" {\n  value = \"${aws_elasticache_subnet_group.elasticache.id}\"\n}\n\noutput \"vpc_id\" {\n  value = \"${aws_vpc.mod.id}\"\n}\n\noutput \"vpc_cidr_block\" {\n  value = \"${aws_vpc.mod.cidr_block}\"\n}\n\noutput \"public_route_table_ids\" {\n  value = [\"${aws_route_table.public.*.id}\"]\n}\n\noutput \"private_route_table_ids\" {\n  value = [\"${aws_route_table.private.*.id}\"]\n}\n\noutput \"default_security_group_id\" {\n  value = \"${aws_vpc.mod.default_security_group_id}\"\n}\n\noutput \"nat_eips\" {\n  value = [\"${aws_eip.nateip.*.id}\"]\n}\n\noutput \"nat_eips_public_ips\" {\n  value = [\"${aws_eip.nateip.*.public_ip}\"]\n}\n\noutput \"natgw_ids\" {\n  value = [\"${aws_nat_gateway.natgw.*.id}\"]\n}\n\noutput \"igw_id\" {\n  value = \"${aws_internet_gateway.mod.id}\"\n}\n\noutput \"default_network_acl_id\" {\n  value = \"${aws_vpc.mod.default_network_acl_id}\"\n}\n\noutput \"vpc_endpoint_s3_id\" {\n  value = \"${aws_vpc_endpoint.s3.id}\"\n}\n\noutput \"vpc_endpoint_dynamodb_id\" {\n  value = \"${aws_vpc_endpoint.dynamodb.id}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-community-modules__tf_aws_vpc__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n    region = \"us-east-1\"\n}\n\nvariable \"ami\" {\n  description = \"This is AMI for the instance\"\n}\n\nvariable \"instance_type\" {\n  description = \"This is the instance type, for example: t2.micro\"\n}\n\nresource \"aws_instance\" \"example\" {\n    ami = var.ami\n    instance_type = var.instance_type\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/prem9797__https-github.com-iam-veeramalla-terraform-zero-to-hero__Day-6__modules__ec2_instance__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"azurerm\" {\n    subscription_id = \"${var.azure_subscription_id}\"\n    client_id = \"${var.azure_client_id}\"\n    client_secret = \"${var.azure_client_secret}\"\n    tenant_id = \"${var.azure_tenant_id}\"\n}\n\nresource \"azurerm_resource_group\" \"test\" {\n  name     = \"acctestRG1\"\n  location = \"East US\"\n}\n\nresource \"azurerm_kubernetes_cluster\" \"test\" {\n  name                = \"acctestaks1\"\n  location            = \"${azurerm_resource_group.test.location}\"\n  resource_group_name = \"${azurerm_resource_group.test.name}\"\n  dns_prefix          = \"acctestagent1\"\n\n  agent_pool_profile {\n    name            = \"default\"\n    count           = 1\n    vm_size         = \"Standard_D1_v2\"\n    os_type         = \"Linux\"\n    os_disk_size_gb = 30\n  }\n\n  agent_pool_profile {\n    name            = \"pool2\"\n    count           = 1\n    vm_size         = \"Standard_D2_v2\"\n    os_type         = \"Linux\"\n    os_disk_size_gb = 30\n  }\n\n  service_principal {\n    client_id     = \"${var.k8s_client_id}\"\n    client_secret = \"${var.k8s_client_secret}\"\n  }\n\n  tags = {\n    Environment = \"Production\"\n  }\n}\n\noutput \"client_certificate\" {\n  value = \"${azurerm_kubernetes_cluster.test.kube_config.0.client_certificate}\"\n}\n\noutput \"kube_config\" {\n  value = \"${azurerm_kubernetes_cluster.test.kube_config_raw}\"\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_6", "severity": "HIGH", "message": "Ensure AKS has an API Server Authorized IP Ranges enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_115", "severity": "HIGH", "message": "Ensure that AKS enables private clusters", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_227", "severity": "HIGH", "message": "Ensure that the AKS cluster encrypt temp disks, caches, and data flows between Compute and Storage resources", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_226", "severity": "HIGH", "message": "Ensure ephemeral disks are used for OS disks", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_170", "severity": "HIGH", "message": "Ensure that AKS use the Paid Sku for its SLA", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_141", "severity": "HIGH", "message": "Ensure AKS local admin account is disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_4", "severity": "HIGH", "message": "Ensure AKS logging to Azure Monitoring is Configured", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_168", "severity": "HIGH", "message": "Ensure Azure Kubernetes Cluster (AKS) nodes should use a minimum number of 50 pods.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_7", "severity": "HIGH", "message": "Ensure AKS cluster has Network Policy configured", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_232", "severity": "HIGH", "message": "Ensure that only critical system pods run on system nodes", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_172", "severity": "HIGH", "message": "Ensure autorotation of Secrets Store CSI Driver secrets for AKS clusters", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_171", "severity": "HIGH", "message": "Ensure AKS cluster upgrade channel is chosen", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_116", "severity": "HIGH", "message": "Ensure that AKS uses Azure Policies Add-on", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AZURE_117", "severity": "HIGH", "message": "Ensure that AKS uses disk encryption set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AZURE_29", "severity": "CRITICAL", "message": "Ensure AKS cluster has Azure CNI networking enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/lazywinadmin__terraform__azure__aks__basic_cluster__main.tf", "start_line": 13}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    tfe = {\n      source  = \"hashicorp/tfe\"\n      version = \">=0.45.0\"\n    }\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Deep-Dive-Terraform__m5__terraform_cloud_config__terraform.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Below is the provider which helps in connecting with AWS Account\nprovider \"aws\" {\n  region = \"\"\n  profile = \"\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/JJTechInc__Terraform__14-Variables with foreach__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"lambda_tf_way_s3_bucket_name\" {\n  value = module.lambda_tf_way_bucket.lambda_tf_way_bucket_name\n}\n\noutput \"lambda_tf_way_s3_bucket_arn\" {\n  value = module.lambda_tf_way_bucket.lambda_tf_way_bucket_arn\n}\n\noutput \"lambda_name\" {\n  value = module.s3_object_listener_lambda.tf_way_lambda_function_name\n}\n\noutput lambda_arn {\n  value = module.s3_object_listener_lambda.tf_way_lambda_arn\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nsriram__lambda-the-terraform-way__samples__08__output.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"your-wish\" {\n    ami = \"ami-012b9156f755804f5\"\n    instance_type = \"t2.micro\"\n}\n\n/* resource \"aws_instance\" \"your-wish\" {\n    ami = \"ami-012b9156f755804f5\"\n    instance_type = \"t2.micro\"\n} */\n\nresource \"aws_eip\" \"your-wish\" {\n    \n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tf-docker-k8__terraform__session-01__ec2.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"byoip_prefix_uuid\" {\n  description = \"The UUID of your BYOIP prefix (created outside of Terraform)\"\n  type        = string\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/digitalocean__terraform-provider-digitalocean__examples__byoipprefix__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \"~> 1.0\"\n\n  required_providers {\n    template = {\n      source = \"hashicorp/template\"\n      version = \" >= 2.2\"\n    }\n\n    external = {\n      source = \"hashicorp/external\"\n      version = \" >= 2.1\"\n    }\n\n    local = {\n      source = \"hashicorp/local\"\n      version = \" >= 2.1\"\n    }\n\n    random = {\n      source = \"hashicorp/random\"\n      version = \" >= 3.1\"\n    }\n\n    null = {\n      source = \"hashicorp/null\"\n      version = \" >= 3.1\"\n    }\n\n    aws = {\n      source = \"hashicorp/aws\"\n      version = \" >= 3.51.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  profile     = var.profile  # refer to ~/.aws/credentials\n  region      = var.region\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/clusterinthecloud__terraform__aws__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"4.17.1\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\nresource \"aws_db_instance\" \"mysql\" {\n  allocated_storage    = 10\n  engine               = \"mysql\"\n  engine_version       = \"5.7\"\n  instance_class       = \"db.t3.micro\"\n  db_name              = \"mydb\"\n  username             = \"foo\"\n  password             = \"foobarbaz\"\n  parameter_group_name = \"default.mysql5.7\"\n  skip_final_snapshot  = true\n}\n\nresource \"aws_db_instance\" \"postgres\" {\n  allocated_storage    = 256\n  engine               = \"postgres\"\n  engine_version       = \"9.5.4\"\n  instance_class       = \"db.r3.large\"\n  db_name              = \"data-dump\"\n  username             = \"user1\"\n  password             = \"passwd\"\n  parameter_group_name = \"mydb\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/bmuschko__cta-crash-course__exercises__06-local-values__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"pet\" {\n  description = \"The type of instance to include in the PetSet\"\n  type        = string\n  default     = \"dog\"\n}\n\nvariable \"size\" {\n  description = \"The number of pet instances to create\"\n  type        = number\n  default     = 3\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__atmos__examples__demo-context__components__terraform__petset__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  tags = merge(var.tags, {\n    \"ghr:environment\" = var.prefix\n  })\n\n  github_app_parameters = {\n    id             = coalesce(var.github_app.id_ssm, module.ssm.parameters.github_app_id)\n    key_base64     = coalesce(var.github_app.key_base64_ssm, module.ssm.parameters.github_app_key_base64)\n    webhook_secret = coalesce(var.github_app.webhook_secret_ssm, module.ssm.parameters.github_app_webhook_secret)\n  }\n\n  default_runner_labels = distinct(concat([\"self-hosted\", var.runner_os, var.runner_architecture]))\n  runner_labels         = (var.runner_disable_default_labels == false) ? sort(concat(local.default_runner_labels, var.runner_extra_labels)) : var.runner_extra_labels\n\n  ssm_root_path = var.ssm_paths.use_prefix ? \"/${var.ssm_paths.root}/${var.prefix}\" : \"/${var.ssm_paths.root}\"\n}\n\nresource \"random_string\" \"random\" {\n  length  = 24\n  special = false\n  upper   = false\n}\n\ndata \"aws_iam_policy_document\" \"deny_unsecure_transport\" {\n  statement {\n    sid = \"DenyUnsecureTransport\"\n\n    effect = \"Deny\"\n\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"*\"]\n    }\n\n    actions = [\n      \"sqs:*\"\n    ]\n\n    resources = [\n      \"*\"\n    ]\n\n    condition {\n      test     = \"Bool\"\n      variable = \"aws:SecureTransport\"\n      values   = [\"false\"]\n    }\n  }\n}\n\nresource \"aws_sqs_queue_policy\" \"build_queue_policy\" {\n  queue_url = aws_sqs_queue.queued_builds.id\n  policy    = data.aws_iam_policy_document.deny_unsecure_transport.json\n}\n\nresource \"aws_sqs_queue\" \"queued_builds\" {\n  name                       = \"${var.prefix}-queued-builds\"\n  delay_seconds              = var.delay_webhook_event\n  visibility_timeout_seconds = var.runners_scale_up_lambda_timeout\n  message_retention_seconds  = var.job_queue_retention_in_seconds\n  receive_wait_time_seconds  = 0\n  redrive_policy = var.redrive_build_queue.enabled ? jsonencode({\n    deadLetterTargetArn = aws_sqs_queue.queued_builds_dlq[0].arn,\n    maxReceiveCount     = var.redrive_build_queue.maxReceiveCount\n  }) : null\n\n  sqs_managed_sse_enabled           = var.queue_encryption.sqs_managed_sse_enabled\n  kms_master_key_id                 = var.queue_encryption.kms_master_key_id\n  kms_data_key_reuse_period_seconds = var.queue_encryption.kms_data_key_reuse_period_seconds\n\n  tags = var.tags\n}\n\nresource \"aws_sqs_queue_policy\" \"build_queue_dlq_policy\" {\n  count     = var.redrive_build_queue.enabled ? 1 : 0\n  queue_url = aws_sqs_queue.queued_builds.id\n  policy    = data.aws_iam_policy_document.deny_unsecure_transport.json\n}\n\nresource \"aws_sqs_queue\" \"queued_builds_dlq\" {\n  count = var.redrive_build_queue.enabled ? 1 : 0\n  name  = \"${var.prefix}-queued-builds_dead_letter\"\n\n  sqs_managed_sse_enabled           = var.queue_encryption.sqs_managed_sse_enabled\n  kms_master_key_id                 = var.queue_encryption.kms_master_key_id\n  kms_data_key_reuse_period_seconds = var.queue_encryption.kms_data_key_reuse_period_seconds\n  tags                              = var.tags\n}\n\nmodule \"ssm\" {\n  source      = \"./modules/ssm\"\n  kms_key_arn = var.kms_key_arn\n  path_prefix = \"${local.ssm_root_path}/${var.ssm_paths.app}\"\n  github_app  = var.github_app\n  tags        = local.tags\n}\n\nmodule \"webhook\" {\n  source = \"./modules/webhook\"\n\n  ssm_paths = {\n    root    = local.ssm_root_path\n    webhook = var.ssm_paths.webhook\n  }\n  prefix      = var.prefix\n  tags        = local.tags\n  kms_key_arn = var.kms_key_arn\n  eventbridge = var.eventbridge\n\n  runner_matcher_config = {\n    \"${var.prefix}-queued-builds\" = {\n      id : aws_sqs_queue.queued_builds.id\n      arn : aws_sqs_queue.queued_builds.arn\n      matcherConfig : {\n        labelMatchers : [local.runner_labels]\n        exactMatch : var.enable_runner_workflow_job_labels_check_all\n      }\n    }\n  }\n  matcher_config_parameter_store_tier = var.matcher_config_parameter_store_tier\n\n  github_app_parameters = {\n    webhook_secret = local.github_app_parameters.webhook_secret\n  }\n\n  lambda_s3_bucket                              = var.lambda_s3_bucket\n  webhook_lambda_s3_key                         = var.webhook_lambda_s3_key\n  webhook_lambda_s3_object_version              = var.webhook_lambda_s3_object_version\n  webhook_lambda_apigateway_access_log_settings = var.webhook_lambda_apigateway_access_log_settings\n  lambda_runtime                                = var.lambda_runtime\n  lambda_architecture                           = var.lambda_architecture\n  lambda_zip                                    = var.webhook_lambda_zip\n  lambda_memory_size                            = var.webhook_lambda_memory_size\n  lambda_timeout                                = var.webhook_lambda_timeout\n  lambda_tags                                   = var.lambda_tags\n  tracing_config                                = var.tracing_config\n  logging_retention_in_days                     = var.logging_retention_in_days\n  logging_kms_key_id                            = var.logging_kms_key_id\n\n  role_path                 = var.role_path\n  role_permissions_boundary = var.role_permissions_boundary\n  repository_white_list     = var.repository_white_list\n\n  lambda_subnet_ids         = var.lambda_subnet_ids\n  lambda_security_group_ids = var.lambda_security_group_ids\n  aws_partition             = var.aws_partition\n\n  log_level = var.log_level\n}\n\nmodule \"runners\" {\n  source = \"./modules/runners\"\n\n  aws_region    = var.aws_region\n  aws_partition = var.aws_partition\n  vpc_id        = var.vpc_id\n  subnet_ids    = var.subnet_ids\n  prefix        = var.prefix\n  tags          = local.tags\n\n  ssm_paths = {\n    root   = local.ssm_root_path\n    tokens = \"${var.ssm_paths.runners}/tokens\"\n    config = \"${var.ssm_paths.runners}/config\"\n  }\n\n  s3_runner_binaries = var.enable_runner_binaries_syncer ? {\n    arn = module.runner_binaries[0].bucket.arn\n    id  = module.runner_binaries[0].bucket.id\n    key = module.runner_binaries[0].runner_distribution_object_key\n  } : null\n\n  runner_os                     = var.runner_os\n  instance_types                = var.instance_types\n  instance_target_capacity_type = var.instance_target_capacity_type\n  instance_allocation_strategy  = var.instance_allocation_strategy\n  instance_max_spot_price       = var.instance_max_spot_price\n  block_device_mappings         = var.block_device_mappings\n\n  runner_architecture       = var.runner_architecture\n  ami                       = var.ami\n  ami_filter                = var.ami_filter\n  ami_owners                = var.ami_owners\n  ami_id_ssm_parameter_name = var.ami_id_ssm_parameter_name\n  ami_kms_key_arn           = var.ami_kms_key_arn\n\n  sqs_build_queue                      = aws_sqs_queue.queued_builds\n  github_app_parameters                = local.github_app_parameters\n  enable_organization_runners          = var.enable_organization_runners\n  enable_ephemeral_runners             = var.enable_ephemeral_runners\n  enable_jit_config                    = var.enable_jit_config\n  enable_job_queued_check              = var.enable_job_queued_check\n  enable_on_demand_failover_for_errors = var.enable_runner_on_demand_failover_for_errors\n  disable_runner_autoupdate            = var.disable_runner_autoupdate\n  enable_managed_runner_security_group = var.enable_managed_runner_security_group\n  enable_runner_detailed_monitoring    = var.enable_runner_detailed_monitoring\n  scale_down_schedule_expression       = var.scale_down_schedule_expression\n  minimum_running_time_in_minutes      = var.minimum_running_time_in_minutes\n  runner_boot_time_in_minutes          = var.runner_boot_time_in_minutes\n  runner_disable_default_labels        = var.runner_disable_default_labels\n  runner_labels                        = local.runner_labels\n  runner_as_root                       = var.runner_as_root\n  runner_run_as                        = var.runner_run_as\n  runners_maximum_count                = var.runners_maximum_count\n  idle_config                          = var.idle_config\n  enable_ssm_on_runners                = var.enable_ssm_on_runners\n  egress_rules                         = var.runner_egress_rules\n  runner_additional_security_group_ids = var.runner_additional_security_group_ids\n  metadata_options                     = var.runner_metadata_options\n  credit_specification                 = var.runner_credit_specification\n  cpu_options                          = var.runner_cpu_options\n\n  enable_runner_binaries_syncer    = var.enable_runner_binaries_syncer\n  lambda_s3_bucket                 = var.lambda_s3_bucket\n  runners_lambda_s3_key            = var.runners_lambda_s3_key\n  runners_lambda_s3_object_version = var.runners_lambda_s3_object_version\n  lambda_runtime                   = var.lambda_runtime\n  lambda_architecture              = var.lambda_architecture\n  lambda_zip                       = var.runners_lambda_zip\n  lambda_scale_up_memory_size      = var.runners_scale_up_lambda_memory_size\n  lambda_scale_down_memory_size    = var.runners_scale_down_lambda_memory_size\n  lambda_timeout_scale_up          = var.runners_scale_up_lambda_timeout\n  lambda_timeout_scale_down        = var.runners_scale_down_lambda_timeout\n  lambda_subnet_ids                = var.lambda_subnet_ids\n  lambda_security_group_ids        = var.lambda_security_group_ids\n  lambda_tags                      = var.lambda_tags\n  tracing_config                   = var.tracing_config\n  logging_retention_in_days        = var.logging_retention_in_days\n  logging_kms_key_id               = var.logging_kms_key_id\n  enable_cloudwatch_agent          = var.enable_cloudwatch_agent\n  cloudwatch_config                = var.cloudwatch_config\n  runner_log_files                 = var.runner_log_files\n  runner_group_name                = var.runner_group_name\n  runner_name_prefix               = var.runner_name_prefix\n\n  scale_up_reserved_concurrent_executions = var.scale_up_reserved_concurrent_executions\n\n  associate_public_ipv4_address = var.associate_public_ipv4_address\n\n  instance_profile_path     = var.instance_profile_path\n  role_path                 = var.role_path\n  role_permissions_boundary = var.role_permissions_boundary\n\n  enable_userdata                = var.enable_userdata\n  enable_user_data_debug_logging = var.enable_user_data_debug_logging_runner\n  userdata_template              = var.userdata_template\n  userdata_content               = var.userdata_content\n  userdata_pre_install           = var.userdata_pre_install\n  userdata_post_install          = var.userdata_post_install\n  runner_hook_job_started        = var.runner_hook_job_started\n  runner_hook_job_completed      = var.runner_hook_job_completed\n  key_name                       = var.key_name\n  runner_ec2_tags                = var.runner_ec2_tags\n\n  create_service_linked_role_spot = var.create_service_linked_role_spot\n\n  runner_iam_role_managed_policy_arns = var.runner_iam_role_managed_policy_arns\n\n  ghes_url        = var.ghes_url\n  ghes_ssl_verify = var.ghes_ssl_verify\n  user_agent      = var.user_agent\n\n  kms_key_arn = var.kms_key_arn\n\n  log_level = var.log_level\n\n  pool_config                                = var.pool_config\n  pool_lambda_memory_size                    = var.pool_lambda_memory_size\n  pool_lambda_timeout                        = var.pool_lambda_timeout\n  pool_runner_owner                          = var.pool_runner_owner\n  pool_lambda_reserved_concurrent_executions = var.pool_lambda_reserved_concurrent_executions\n\n  ssm_housekeeper = var.runners_ssm_housekeeper\n  ebs_optimized   = var.runners_ebs_optimized\n\n  metrics = var.metrics\n\n  job_retry = var.job_retry\n}\n\nmodule \"runner_binaries\" {\n  count = var.enable_runner_binaries_syncer ? 1 : 0\n\n  source = \"./modules/runner-binaries-syncer\"\n\n  prefix = var.prefix\n  tags   = local.tags\n\n  distribution_bucket_name = lower(\"${var.prefix}-dist-${random_string.random.result}\")\n  s3_logging_bucket        = var.runner_binaries_s3_logging_bucket\n  s3_logging_bucket_prefix = var.runner_binaries_s3_logging_bucket_prefix\n\n  runner_os           = var.runner_os\n  runner_architecture = var.runner_architecture\n\n  lambda_s3_bucket                = var.lambda_s3_bucket\n  syncer_lambda_s3_key            = var.syncer_lambda_s3_key\n  syncer_lambda_s3_object_version = var.syncer_lambda_s3_object_version\n  lambda_runtime                  = var.lambda_runtime\n  lambda_architecture             = var.lambda_architecture\n  lambda_zip                      = var.runner_binaries_syncer_lambda_zip\n  lambda_memory_size              = var.runner_binaries_syncer_lambda_memory_size\n  lambda_timeout                  = var.runner_binaries_syncer_lambda_timeout\n  lambda_tags                     = var.lambda_tags\n  tracing_config                  = var.tracing_config\n  logging_retention_in_days       = var.logging_retention_in_days\n  logging_kms_key_id              = var.logging_kms_key_id\n\n  state_event_rule_binaries_syncer     = var.state_event_rule_binaries_syncer\n  server_side_encryption_configuration = var.runner_binaries_s3_sse_configuration\n  s3_tags                              = var.runner_binaries_s3_tags\n  s3_versioning                        = var.runner_binaries_s3_versioning\n\n  role_path                 = var.role_path\n  role_permissions_boundary = var.role_permissions_boundary\n\n  log_level = var.log_level\n\n  lambda_subnet_ids         = var.lambda_subnet_ids\n  lambda_security_group_ids = var.lambda_security_group_ids\n  aws_partition             = var.aws_partition\n\n  lambda_principals = var.lambda_principals\n}\n\nmodule \"ami_housekeeper\" {\n  count  = var.enable_ami_housekeeper ? 1 : 0\n  source = \"./modules/ami-housekeeper\"\n\n  prefix        = var.prefix\n  tags          = local.tags\n  aws_partition = var.aws_partition\n\n  lambda_zip               = var.ami_housekeeper_lambda_zip\n  lambda_s3_bucket         = var.lambda_s3_bucket\n  lambda_s3_key            = var.ami_housekeeper_lambda_s3_key\n  lambda_s3_object_version = var.ami_housekeeper_lambda_s3_object_version\n\n  lambda_architecture       = var.lambda_architecture\n  lambda_principals         = var.lambda_principals\n  lambda_runtime            = var.lambda_runtime\n  lambda_security_group_ids = var.lambda_security_group_ids\n  lambda_subnet_ids         = var.lambda_subnet_ids\n  lambda_timeout            = var.ami_housekeeper_lambda_timeout\n  lambda_tags               = var.lambda_tags\n  tracing_config            = var.tracing_config\n\n  logging_retention_in_days = var.logging_retention_in_days\n  logging_kms_key_id        = var.logging_kms_key_id\n  log_level                 = var.log_level\n\n  role_path                 = var.role_path\n  role_permissions_boundary = var.role_permissions_boundary\n\n  cleanup_config             = var.ami_housekeeper_cleanup_config\n  lambda_schedule_expression = var.ami_housekeeper_lambda_schedule_expression\n}\n\nlocals {\n  lambda_instance_termination_watcher = {\n    prefix                    = var.prefix\n    tags                      = local.tags\n    aws_partition             = var.aws_partition\n    architecture              = var.lambda_architecture\n    principals                = var.lambda_principals\n    runtime                   = var.lambda_runtime\n    security_group_ids        = var.lambda_security_group_ids\n    subnet_ids                = var.lambda_subnet_ids\n    lambda_tags               = var.lambda_tags\n    log_level                 = var.log_level\n    logging_kms_key_id        = var.logging_kms_key_id\n    logging_retention_in_days = var.logging_retention_in_days\n    role_path                 = var.role_path\n    role_permissions_boundary = var.role_permissions_boundary\n    s3_bucket                 = var.lambda_s3_bucket\n    tracing_config            = var.tracing_config\n    metrics                   = var.metrics\n  }\n}\n\nmodule \"instance_termination_watcher\" {\n  source = \"./modules/termination-watcher\"\n  count  = var.instance_termination_watcher.enable ? 1 : 0\n\n  config = merge(local.lambda_instance_termination_watcher, var.instance_termination_watcher)\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/github-aws-runners__terraform-aws-github-runner__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Licensed to the Apache Software Foundation (ASF) under one\n# or more contributor license agreements.  See the NOTICE file\n# distributed with this work for additional information\n# regarding copyright ownership.  The ASF licenses this file\n# to you under the Apache License, Version 2.0 (the\n# \"License\"); you may not use this file except in compliance\n# with the License.  You may obtain a copy of the License at\n#\n#   http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing,\n# software distributed under the License is distributed on an\n# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n# KIND, either express or implied.  See the License for the\n# specific language governing permissions and limitations\n# under the License.\n\nresource \"aws_security_group\" \"api\" {\n  name        = \"api\"\n  description = \"Allow incoming connections\"\n  vpc_id      = aws_vpc._.id\n  ingress {\n    from_port   = 12345\n    to_port     = 12345\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n    description = \"Allow incoming HTTP connections\"\n  }\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n    description = \"Allow incoming SSH connections (Linux)\"\n  }\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  tags = merge(var.tags, {\n    \"Name\" = \"${var.name_prefix}-sg\"\n  })\n}\n\ndata \"template_file\" \"api_user_data\" {\n  template = file(\"templates/cloud-init.yaml\")\n  vars = {\n    \"ssh_public_key\"             = aws_key_pair.key_pair.public_key\n    \"dolphinscheduler_version\"   = var.ds_version\n    \"dolphinscheduler_component\" = \"api-server\"\n    \"database_address\"           = aws_db_instance.database.address\n    \"database_port\"              = aws_db_instance.database.port\n    \"database_name\"              = aws_db_instance.database.db_name\n    \"database_username\"          = aws_db_instance.database.username\n    \"database_password\"          = aws_db_instance.database.password\n    \"zookeeper_connect_string\"   = var.zookeeper_connect_string != \"\" ? var.zookeeper_connect_string : aws_instance.zookeeper[0].private_ip\n    \"alert_server_host\"          = \"\"\n    \"s3_access_key_id\"           = aws_iam_access_key.s3.id\n    \"s3_secret_access_key\"       = aws_iam_access_key.s3.secret\n    \"s3_region\"                  = var.aws_region\n    \"s3_bucket_name\"             = module.s3_bucket.s3_bucket_id\n    \"s3_endpoint\"                = \"\"\n  }\n}\n\nresource \"aws_instance\" \"api\" {\n  count = var.ds_component_replicas.api\n\n  ami                         = data.aws_ami.dolphinscheduler.id\n  instance_type               = var.vm_instance_type.api\n  subnet_id                   = aws_subnet.public[0].id\n  vpc_security_group_ids      = [aws_security_group.api.id]\n  source_dest_check           = false\n  associate_public_ip_address = var.vm_associate_public_ip_address.api\n\n  user_data = data.template_file.api_user_data.rendered\n\n  root_block_device {\n    volume_size           = var.vm_root_volume_size.api\n    volume_type           = var.vm_root_volume_type.api\n    delete_on_termination = true\n    encrypted             = true\n    tags = merge(var.tags, {\n      \"Name\" = \"${var.name_prefix}-rdb-api-${count.index}\"\n    })\n  }\n\n  ebs_block_device {\n    device_name           = \"/dev/xvda\"\n    volume_size           = var.vm_data_volume_size.api\n    volume_type           = var.vm_data_volume_type.api\n    encrypted             = true\n    delete_on_termination = true\n    tags = merge(var.tags, {\n      \"Name\" = \"${var.name_prefix}-ebd-api-${count.index}\"\n    })\n  }\n\n  tags = merge(var.tags, {\n    \"Name\" = \"${var.name_prefix}-api-${count.index}\"\n  })\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/apache__dolphinscheduler__deploy__terraform__aws__dolphinscheduler-api.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/apache__dolphinscheduler__deploy__terraform__aws__dolphinscheduler-api.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/apache__dolphinscheduler__deploy__terraform__aws__dolphinscheduler-api.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/apache__dolphinscheduler__deploy__terraform__aws__dolphinscheduler-api.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/apache__dolphinscheduler__deploy__terraform__aws__dolphinscheduler-api.tf", "start_line": 68}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/apache__dolphinscheduler__deploy__terraform__aws__dolphinscheduler-api.tf", "start_line": 68}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/apache__dolphinscheduler__deploy__terraform__aws__dolphinscheduler-api.tf", "start_line": 68}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/apache__dolphinscheduler__deploy__terraform__aws__dolphinscheduler-api.tf", "start_line": 68}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# create vpc\n# create subnet\n# create internet gateway\n# create route table\n# associate route (0.0.0.0/0)\n\n# vpc\nresource \"aws_vpc\" \"tf_vpc\" {\n  cidr_block           = \"10.0.0.0/16\"\n  enable_dns_support   = true\n  enable_dns_hostnames = true\n  tags= {\n     Name = \"task2-tf-vpc\"\n}\n}\n\n# subnet\nresource \"aws_subnet\" \"tf_subnet\" {\n  depends_on = [\n    aws_vpc.tf_vpc\n  ]\n  count = length(data.aws_availability_zones.available.names)\n  availability_zone = data.aws_availability_zones.available.names[count.index]\n  vpc_id            = aws_vpc.tf_vpc.id\n  cidr_block        = \"10.0.${count.index}.0/24\"\n  map_public_ip_on_launch = true\n  tags= {\n     Name = \"task2-tf-subnet\"\n}\n}\n\n# internet gateway\nresource \"aws_internet_gateway\" \"tf_ig\" {\n  depends_on = [\n    aws_vpc.tf_vpc\n  ]\n  vpc_id = aws_vpc.tf_vpc.id\n  tags = {\n    Name = \"task2-tf-ig\"\n  }\n}\n\n# route table\n resource \"aws_route_table\" \"tf_route\" {\n  depends_on = [\n    aws_vpc.tf_vpc\n  ]\n  vpc_id = aws_vpc.tf_vpc.id\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.tf_ig.id\n  }\n  tags = {\n    Name = \"task2-tf-route\"\n  }\n}\n\n# route association\nresource \"aws_route_table_association\" \"tf_assoc\" {\n  depends_on = [\n    aws_subnet.tf_subnet\n  ]\n  count = length(data.aws_availability_zones.available.names)-1\n  subnet_id      = aws_subnet.tf_subnet[count.index].id\n  route_table_id = aws_route_table.tf_route.id\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 2 - Terraform_auto_deploy_efs_lb__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 2 - Terraform_auto_deploy_efs_lb__vpc.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 2 - Terraform_auto_deploy_efs_lb__vpc.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dakshjain1__Terraform__Code 2 - Terraform_auto_deploy_efs_lb__vpc.tf", "start_line": 8}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"datadog_dashboard\" \"ordered_dashboard_example\" {\n  title         = \"Ordered Layout Dashboard\"\n  description   = \"Created using the Datadog provider in Terraform\"\n  layout_type   = \"ordered\"\n  is_read_only  = true\n\n  widget {\n    alert_graph_definition {\n      alert_id = \"895605\"\n      viz_type = \"timeseries\"\n      title = \"Widget Title\"\n      time = {\n        live_span = \"1h\"\n      }\n    }\n  }\n\n  widget {\n    alert_value_definition {\n      alert_id = \"895605\"\n      precision = 3\n      unit = \"b\"\n      text_align = \"center\"\n      title = \"Widget Title\"\n    }\n  }\n\n  widget {\n    alert_value_definition {\n      alert_id = \"895605\"\n      precision = 3\n      unit = \"b\"\n      text_align = \"center\"\n      title = \"Widget Title\"\n    }\n  }\n\n  widget {\n    change_definition {\n      request {\n        q = \"avg:system.load.1{env:staging} by {account}\"\n        change_type = \"absolute\"\n        compare_to = \"week_before\"\n        increase_good = true\n        order_by = \"name\"\n        order_dir = \"desc\"\n        show_present = true\n      }\n      title = \"Widget Title\"\n      time = {\n        live_span = \"1h\"\n      }\n    }\n  }\n\n  widget {\n    distribution_definition {\n      request {\n        q = \"avg:system.load.1{env:staging} by {account}\"\n        style {\n          palette = \"warm\"\n        }\n      }\n      title = \"Widget Title\"\n      time = {\n        live_span = \"1h\"\n      }\n    }\n  }\n\n  widget {\n    check_status_definition {\n      check = \"aws.ecs.agent_connected\"\n      grouping = \"cluster\"\n      group_by = [\"account\", \"cluster\"]\n      tags = [\"account:demo\", \"cluster:awseb-ruthebdog-env-8-dn3m6u3gvk\"]\n      title = \"Widget Title\"\n      time = {\n        live_span = \"1h\"\n      }\n    }\n  }\n\n  widget {\n    heatmap_definition {\n      request {\n        q = \"avg:system.load.1{env:staging} by {account}\"\n        style {\n          palette = \"warm\"\n        }\n      }\n      yaxis {\n        min = 1\n        max = 2\n        include_zero = true\n        scale = \"sqrt\"\n      }\n      title = \"Widget Title\"\n      time = {\n        live_span = \"1h\"\n      }\n    }\n  }\n\n  widget {\n    hostmap_definition {\n      request {\n        fill {\n          q = \"avg:system.load.1{*} by {host}\"\n        }\n        size {\n          q = \"avg:memcache.uptime{*} by {host}\"\n        }\n      }\n      node_type= \"container\"\n      group = [\"host\", \"region\"]\n      no_group_hosts = true\n      no_metric_hosts = true\n      scope = [\"region:us-east-1\", \"aws_account:727006795293\"]\n      style {\n        palette = \"yellow_to_green\"\n        palette_flip = true\n        fill_min = \"10\"\n        fill_max = \"20\"\n      }\n      title = \"Widget Title\"\n    }\n  }\n\n  widget {\n    note_definition {\n      content = \"note text\"\n      background_color = \"pink\"\n      font_size = \"14\"\n      text_align = \"center\"\n      show_tick = true\n      tick_edge = \"left\"\n      tick_pos = \"50%\"\n    }\n  }\n\n  widget {\n    query_value_definition {\n      request {\n        q = \"avg:system.load.1{env:staging} by {account}\"\n        aggregator = \"sum\"\n        conditional_formats {\n          comparator = \"<\"\n          value = \"2\"\n          palette = \"white_on_green\"\n        }\n        conditional_formats {\n          comparator = \">\"\n          value = \"2.2\"\n          palette = \"white_on_red\"\n        }\n      }\n      autoscale = true\n      custom_unit = \"xx\"\n      precision = \"4\"\n      text_align = \"right\"\n      title = \"Widget Title\"\n      time = {\n        live_span = \"1h\"\n      }\n    }\n  }\n\n  widget {\n    query_table_definition {\n      request {\n        q = \"avg:system.load.1{env:staging} by {account}\"\n        aggregator = \"sum\"\n        limit = \"10\"\n        conditional_formats {\n          comparator = \"<\"\n          value = \"2\"\n          palette = \"white_on_green\"\n        }\n        conditional_formats {\n          comparator = \">\"\n          value = \"2.2\"\n          palette = \"white_on_red\"\n        }\n      }\n      title = \"Widget Title\"\n      time = {\n        live_span = \"1h\"\n      }\n    }\n  }\n\n  widget {\n    scatterplot_definition {\n      request {\n        x {\n          q = \"avg:system.cpu.user{*} by {service, account}\"\n          aggregator = \"max\"\n        }\n        y {\n          q = \"avg:system.mem.used{*} by {service, account}\"\n          aggregator = \"min\"\n        }\n      }\n      color_by_groups = [\"account\", \"apm-role-group\"]\n      xaxis {\n        include_zero = true\n        label = \"x\"\n        min = \"1\"\n        max = \"2000\"\n        scale = \"pow\"\n      }\n      yaxis {\n        include_zero = false\n        label = \"y\"\n        min = \"5\"\n        max = \"2222\"\n        scale = \"log\"\n      }\n      title = \"Widget Title\"\n      time = {\n        live_span = \"1h\"\n      }\n    }\n  }\n\n  widget {\n    servicemap_definition {\n      service = \"master-db\"\n      filters = [\"env:prod\",\"datacenter:us1.prod.dog\"]\n      title = \"env: prod, datacenter:us1.prod.dog, service: master-db\"\n      title_size = \"16\"\n      title_align = \"left\"\n    }\n    layout = {\n      height = 43\n      width = 32\n      x = 5\n      y = 5\n    }\n  }\n\n  widget {\n    timeseries_definition {\n      request {\n        q= \"avg:system.cpu.user{app:general} by {env}\"\n        display_type = \"line\"\n        style {\n          palette = \"warm\"\n          line_type = \"dashed\"\n          line_width = \"thin\"\n        }\n        metadata {\n          expression = \"avg:system.cpu.user{app:general} by {env}\"\n          alias_name = \"Alpha\"\n        }\n      }\n      request {\n        log_query {\n          index = \"mcnulty\"\n          compute = {\n            aggregation = \"avg\"\n            facet = \"@duration\"\n            interval = 5000\n          }\n          search = {\n            query = \"status:info\"\n          }\n          group_by {\n            facet = \"host\"\n            limit = 10\n            sort = {\n              aggregation = \"avg\"\n              order = \"desc\"\n              facet = \"@duration\"\n            }\n          }\n        }\n        display_type = \"area\"\n      }\n      request {\n        apm_query {\n          index = \"apm-search\"\n          compute = {\n            aggregation = \"avg\"\n            facet = \"@duration\"\n            interval = 5000\n          }\n          search = {\n            query = \"type:web\"\n          }\n          group_by {\n            facet = \"resource_name\"\n            limit = 50\n            sort = {\n              aggregation = \"avg\"\n              order = \"desc\"\n              facet = \"@string_query.interval\"\n            }\n          }\n        }\n        display_type = \"bars\"\n      }\n      request {\n        process_query {\n          metric = \"process.stat.cpu.total_pct\"\n          search_by = \"error\"\n          filter_by = [\"active\"]\n          limit = 50\n        }\n        display_type = \"area\"\n      }\n      marker {\n        display_type = \"error dashed\"\n        label = \" z=6 \"\n        value = \"y = 4\"\n      }\n      marker {\n        display_type = \"ok solid\"\n        value = \"10 < y < 999\"\n        label = \" x=8 \"\n      }\n      title = \"Widget Title\"\n      show_legend = true\n      legend_size = \"2\"\n      time = {\n        live_span = \"1h\"\n      }\n      event {\n        q = \"sources:test tags:1\"\n      }\n      event {\n        q = \"sources:test tags:2\"\n      }\n      yaxis {\n        scale = \"log\"\n        include_zero = false\n        max = 100\n      }\n    }\n  }\n\n  widget {\n    toplist_definition {\n      request {\n        q= \"avg:system.cpu.user{app:general} by {env}\"\n        conditional_formats {\n          comparator = \"<\"\n          value = \"2\"\n          palette = \"white_on_green\"\n        }\n        conditional_formats {\n          comparator = \">\"\n          value = \"2.2\"\n          palette = \"white_on_red\"\n        }\n      }\n      title = \"Widget Title\"\n    }\n  }\n\n  widget {\n    group_definition {\n      layout_type = \"ordered\"\n      title = \"Group Widget\"\n\n      widget {\n        note_definition {\n          content = \"cluster note widget\"\n          background_color = \"pink\"\n          font_size = \"14\"\n          text_align = \"center\"\n          show_tick = true\n          tick_edge = \"left\"\n          tick_pos = \"50%\"\n        }\n      }\n\n      widget {\n        alert_graph_definition {\n          alert_id = \"123\"\n          viz_type = \"toplist\"\n          title = \"Alert Graph\"\n          time = {\n            live_span = \"1h\"\n          }\n        }\n      }\n    }\n  }\n\n  widget {\n    service_level_objective_definition {\n      title = \"Widget Title\"\n      view_type = \"detail\"\n      slo_id = \"56789\"\n      show_error_budget = true\n      view_mode = \"overall\"\n      time_windows = [\"7d\", \"previous_week\"]\n    }\n  }\n\n  template_variable {\n    name   = \"var_1\"\n    prefix = \"host\"\n    default = \"aws\"\n  }\n  template_variable {\n    name   = \"var_2\"\n    prefix = \"service_name\"\n    default = \"autoscaling\"\n  }\n\n  template_variable_preset {\n    name = \"preset_1\"\n    template_variable {\n      name = \"var_1\"\n      value = \"host.dc\"\n    }\n    template_variable {\n      name = \"var_2\"\n      value = \"my_service\"\n    }\n  }\n}\n\nresource \"datadog_dashboard\" \"free_dashboard_example\" {\n  title         = \"Free Layout Dashboard\"\n  description   = \"Created using the Datadog provider in Terraform\"\n  layout_type   = \"free\"\n  is_read_only  = false\n\n  widget {\n    event_stream_definition {\n      query = \"*\"\n      event_size = \"l\"\n      title = \"Widget Title\"\n      title_size = 16\n      title_align = \"left\"\n      time = {\n        live_span = \"1h\"\n      }\n    }\n    layout = {\n      height = 43\n      width = 32\n      x = 5\n      y = 5\n    }\n  }\n\n  widget {\n    event_timeline_definition {\n      query = \"*\"\n      title = \"Widget Title\"\n      title_size = 16\n      title_align = \"left\"\n      time = {\n        live_span = \"1h\"\n      }\n    }\n    layout = {\n      height = 9\n      width = 65\n      x = 42\n      y = 73\n    }\n  }\n\n  widget {\n    free_text_definition {\n      text = \"free text content\"\n      color = \"#d00\"\n      font_size = \"88\"\n      text_align = \"left\"\n    }\n    layout = {\n      height = 20\n      width = 30\n      x = 42\n      y = 5\n    }\n  }\n\n  widget {\n    iframe_definition {\n      url = \"http://google.com\"\n    }\n    layout = {\n      height = 46\n      width = 39\n      x = 111\n      y = 8\n    }\n  }\n\n  widget {\n    image_definition {\n      url = \"https://images.pexels.com/photos/67636/rose-blue-flower-rose-blooms-67636.jpeg?auto=compress&cs=tinysrgb&h=350\"\n      sizing = \"fit\"\n      margin = \"small\"\n    }\n    layout = {\n      height = 20\n      width = 30\n      x = 77\n      y = 7\n    }\n  }\n\n  widget {\n    log_stream_definition {\n      indexes = [\"main\"]\n      query = \"error\"\n      columns = [\"core_host\", \"core_service\", \"tag_source\"]\n      show_date_column = true\n      show_message_column = true\n      message_display = \"expanded-md\"\n      sort {\n        column = \"time\"\n        order = \"desc\"\n      }\n    }\n    layout = {\n      height = 36\n      width = 32\n      x = 5\n      y = 51\n    }\n  }\n\n  widget {\n    manage_status_definition {\n      color_preference = \"text\"\n      display_format = \"countsAndList\"\n      hide_zero_counts = true\n      query = \"type:metric\"\n      show_last_triggered = false\n      sort = \"status,asc\"\n      summary_type = \"monitors\"\n      title = \"Widget Title\"\n      title_size = 16\n      title_align = \"left\"\n    }\n    layout = {\n      height = 40\n      width = 30\n      x = 112\n      y = 55\n    }\n  }\n\n  widget {\n    trace_service_definition {\n      display_format = \"three_column\"\n      env = \"datad0g.com\"\n      service = \"alerting-cassandra\"\n      show_breakdown = true\n      show_distribution = true\n      show_errors = true\n      show_hits = true\n      show_latency = false\n      show_resource_list = false\n      size_format = \"large\"\n      span_name = \"cassandra.query\"\n      title = \"alerting-cassandra #env:datad0g.com\"\n      title_align = \"center\"\n      title_size = \"13\"\n      time = {\n        live_span = \"1h\"\n      }\n    }\n    layout = {\n      height = 38\n      width = 67\n      x = 40\n      y = 28\n    }\n  }\n\n  template_variable {\n    name   = \"var_1\"\n    prefix = \"host\"\n    default = \"aws\"\n  }\n  template_variable {\n    name   = \"var_2\"\n    prefix = \"service_name\"\n    default = \"autoscaling\"\n  }\n\n  template_variable_preset {\n    name = \"preset_1\"\n    template_variable {\n      name = \"var_1\"\n      value = \"host.dc\"\n    }\n    template_variable {\n      name = \"var_2\"\n      value = \"my_service\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraformer__tests__datadog__resources__dashboard.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"region\" {}\nvariable \"secret_key\" {}\nvariable \"access_key\" {}\nvariable \"ssh_public_key\" {}\nvariable \"dns_zone_id\" {}\n\nvariable \"instance_type\" {\n  default = \"t2.medium\"\n}\n\nvariable \"amis\" {\n  type        = \"map\"\n  description = \"Amazon Linux Image\"\n\n  default = {\n    \"us-east-1\"  = \"ami-55ef662f\"\n    \"us-east-2\"  = \"ami-15e9c770\"\n    \"eu-west-2\"  = \"ami-e7d6c983\"\n    \"eu-west-1\"  = \"ami-1a962263\"\n    \"ap-south-1\" = \"ami-d5c18eba\"\n  }\n}\n\nvariable \"dns_name\" {\n  default = \"registry.slowcoder.com\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__docker-registry__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nresource \"aws_security_group\" \"all_worker_mgmt\" {\n  name_prefix = \"all_worker_management\"\n  vpc_id      = module.vpc.vpc_id\n}\n\nresource \"aws_security_group_rule\" \"all_worker_mgmt_ingress\" {\n  description       = \"allow inbound traffic from eks\"\n  from_port         = 0\n  protocol          = \"-1\"\n  to_port           = 0\n  security_group_id = aws_security_group.all_worker_mgmt.id\n  type              = \"ingress\"\n  cidr_blocks = [\n    \"10.0.0.0/8\",\n    \"172.16.0.0/12\",\n    \"192.168.0.0/16\",\n  ]\n}\n\nresource \"aws_security_group_rule\" \"all_worker_mgmt_egress\" {\n  description       = \"allow outbound traffic to anywhere\"\n  from_port         = 0\n  protocol          = \"-1\"\n  security_group_id = aws_security_group.all_worker_mgmt.id\n  to_port           = 0\n  type              = \"egress\"\n  cidr_blocks       = [\"0.0.0.0/0\"]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-eks__security-groups.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-eks__security-groups.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-eks__security-groups.tf", "start_line": 21}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-eks__security-groups.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_security_group\" \"kubernetes_sg\" {\n  name        = \"Allow_All_Ports\"\n  description = \"Allow All Ports All Protocals\"\n  vpc_id      = aws_vpc.kubernetes.id\n  ingress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__security-groups.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__security-groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__security-groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__security-groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_25", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__security-groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__security-groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_277", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__security-groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-ansible-k8s-automation__terafrom_scripts__security-groups.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"auth0_connection\" \"my_enterprise_connection\" {\n  name         = \"my-enterprise-connection\"\n  display_name = \"My Enterprise Connection\"\n  strategy     = \"okta\"\n\n  options {\n    client_id              = \"1234567\"\n    client_secret          = \"1234567\"\n    issuer                 = \"https://example.okta.com\"\n    jwks_uri               = \"https://example.okta.com/oauth2/v1/keys\"\n    token_endpoint         = \"https://example.okta.com/oauth2/v1/token\"\n    authorization_endpoint = \"https://example.okta.com/oauth2/v1/authorize\"\n  }\n}\n\nresource \"auth0_connection_scim_configuration\" \"my_conn_scim_configuration\" {\n  connection_id = auth0_connection.my_enterprise_connection.id\n}\n\n# A data source for an Auth0 Connection SCIM Configuration.\ndata \"auth0_connection_scim_configuration\" \"my_conn_scim_configuration_data\" {\n  connection_id = auth0_connection_scim_configuration.my_conn_scim_configuration.id\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/auth0__terraform-provider-auth0__examples__data-sources__auth0_connection_scim_configuration__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# CREATE AN S3 BUCKET AND DYNAMODB TABLE TO USE AS A TERRAFORM BACKEND\n# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n# ----------------------------------------------------------------------------------------------------------------------\n# REQUIRE A SPECIFIC TERRAFORM VERSION OR HIGHER\n# This module has been updated with 0.12 syntax, which means it is no longer compatible with any versions below 0.12.\n# This module is forked from https://github.com/gruntwork-io/intro-to-terraform/tree/master/s3-backend\n# ----------------------------------------------------------------------------------------------------------------------\n\nterraform {\n  required_version = \">= 0.12\"\n}\n\n# ------------------------------------------------------------------------------\n# CONFIGURE OUR AWS CONNECTION\n# ------------------------------------------------------------------------------\n\nprovider \"aws\" {}\n\n# ------------------------------------------------------------------------------\n# CREATE THE S3 BUCKET\n# ------------------------------------------------------------------------------\n\ndata \"aws_caller_identity\" \"current\" {}\n\nlocals {\n  account_id    = data.aws_caller_identity.current.account_id\n}\n\nresource \"aws_s3_bucket\" \"terraform_state\" {\n  # With account id, this S3 bucket names can be *globally* unique.\n  bucket = \"${local.account_id}-terraform-states\"\n\n  # Enable versioning so we can see the full revision history of our\n  # state files\n  versioning {\n    enabled = true\n  }\n\n  # Enable server-side encryption by default\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        sse_algorithm = \"AES256\"\n      }\n    }\n  }\n}\n\n# ------------------------------------------------------------------------------\n# CREATE THE DYNAMODB TABLE\n# ------------------------------------------------------------------------------\n\nresource \"aws_dynamodb_table\" \"terraform_lock\" {\n  name         = \"terraform-lock\"\n  billing_mode = \"PAY_PER_REQUEST\"\n  hash_key     = \"LockID\"\n\n  attribute {\n    name = \"LockID\"\n    type = \"S\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__remote_state__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_28", "severity": "HIGH", "message": "Ensure DynamoDB point in time recovery (backup) is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__remote_state__main.tf", "start_line": 55}, {"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__remote_state__main.tf", "start_line": 55}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__remote_state__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__remote_state__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__remote_state__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__remote_state__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__remote_state__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__write_your_first_terraform_project__aws__remote_state__main.tf", "start_line": 31}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_vpc\" \"vpc\" {\n  cidr_block = \"10.0.0.0/16\"\n\n  tags = {\n    Name = var.vpc-name\n  }\n}\n\nresource \"aws_internet_gateway\" \"igw\" {\n  vpc_id = aws_vpc.vpc.id\n\n  tags = {\n    Name = var.igw-name\n  }\n}\n\nresource \"aws_subnet\" \"public-subnet\" {\n  vpc_id                  = aws_vpc.vpc.id\n  cidr_block              = \"10.0.1.0/24\"\n  availability_zone       = \"us-east-1a\"\n  map_public_ip_on_launch = true\n\n  tags = {\n    Name = var.subnet-name\n  }\n}\n\nresource \"aws_route_table\" \"rt\" {\n  vpc_id = aws_vpc.vpc.id\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.igw.id\n  }\n\n  tags = {\n    Name = var.rt-name\n  }\n}\n\nresource \"aws_route_table_association\" \"rt-association\" {\n  route_table_id = aws_route_table.rt.id\n  subnet_id      = aws_subnet.public-subnet.id\n}\n\nresource \"aws_security_group\" \"security-group\" {\n  vpc_id      = aws_vpc.vpc.id\n  description = \"Allowing Jenkins, Sonarqube, SSH Access\"\n\n  ingress = [\n    for port in [22, 8080, 9000, 9090, 80] : {\n      description      = \"TLS from VPC\"\n      from_port        = port\n      to_port          = port\n      protocol         = \"tcp\"\n      ipv6_cidr_blocks = [\"::/0\"]\n      self             = false\n      prefix_list_ids  = []\n      security_groups  = []\n      cidr_blocks      = [\"0.0.0.0/0\"]\n    }\n  ]\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = var.sg-name\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__vpc.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__vpc.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__vpc.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__vpc.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__vpc.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__End-to-End-Kubernetes-Three-Tier-DevSecOps-Project__Jenkins-Server-TF__vpc.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\"resource\" \"aws_cloudformation_stack\" \"network\" {\n  \"capabilities\" = [\"CAPABILITY_IAM\"]\n\n  \"disable_rollback\" = true\n\n  \"name\" = \"foobarbaz\"\n\n  \"parameters\" = {\n    \"foo\" = \"bar\"\n\n    \"bar\" = \"baz\"\n\n    \"baz\" = \"qux\"\n  }\n\n  \"tags\" = {\n    \"foo\" = \"bar\"\n\n    \"baz\" = \"qux\"\n\n    \"foo:bar\" = \"baz\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/humanmade__cf-to-tf__tests__fixtures__example.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "PARSING_ERROR", "severity": "HIGH", "message": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/humanmade__cf-to-tf__tests__fixtures__example.tf", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/humanmade__cf-to-tf__tests__fixtures__example.tf", "start_line": null}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# our requirement is to create 3 instances, web-server, app-server, db-server\n# resource \"aws_instance\" \"web\"{\n#     ami = \"ami-022d03f649d12a49d\" #AMI ID will be different every region, this is OS\n#     instance_type = \"t3.micro\"\n#     count = length(var.instances)\n#     tags = {\n#       Name = var.instances[count.index] #index always starts from 0. If size is 3 it starts from 0,1,2.\n#     }\n# }\n\n# condition is if variable of key is defined then use that, other wise use dafult key\n\n\n# resource \"aws_instance\" \"web-1\"{\n#     ami = \"ami-022d03f649d12a49d\" #AMI ID will be different every region, this is OS\n#     instance_type = \"t3.micro\"\n#     count = 0 #if count equal to zero terraform will not create the resource\n# }\n\n# resource \"aws_instance\" \"web-1\"{\n#     ami = \"ami-022d03f649d12a49d\" #AMI ID will be different every region, this is OS\n#     instance_type = var.is_test ? \"t3.micro\" : \"t3.large\"\n# }\n\n# resource \"aws_instance\" \"server\"{\n#     for_each = var.servers #here you need to give a map to iterate\n#     ami = \"ami-022d03f649d12a49d\" #AMI ID will be different every region, this is OS\n#     instance_type = each.value\n#     tags = {\n#       Name = each.key\n#     }\n# }\n\nresource \"aws_instance\" \"server\"{\n    ami = \"ami-022d03f649d12a49d\" #AMI ID will be different every region, this is OS\n    instance_type = \"t3.micro\"\n    tags = {\n      Name = local.instance_name\n    }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-05__ec2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-05__ec2.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-05__ec2.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-05__ec2.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-05__ec2.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/techworldwithsiva__terraform__Session-05__ec2.tf", "start_line": 34}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#creating s3 bucket and dynamo DB for state backend storgae and applying the lock mechanisam for statefile\n\nprovider \"aws\" { \n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"testdevnareshit\"\n  \n}\n\nresource \"aws_dynamodb_table\" \"dynamodb-terraform-state-lock\" {\n  name = \"terraform-state-lock-dynamo\"\n  hash_key = \"LockID\"\n  read_capacity = 20\n  write_capacity = 20\n \n  attribute {\n    name = \"LockID\"\n    type = \"S\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-4-resources_for_backend_s3_dynamodb__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_28", "severity": "HIGH", "message": "Ensure DynamoDB point in time recovery (backup) is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-4-resources_for_backend_s3_dynamodb__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-4-resources_for_backend_s3_dynamodb__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV2_AWS_16", "severity": "CRITICAL", "message": "Ensure that Auto Scaling is enabled on your DynamoDB tables", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-4-resources_for_backend_s3_dynamodb__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-4-resources_for_backend_s3_dynamodb__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-4-resources_for_backend_s3_dynamodb__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-4-resources_for_backend_s3_dynamodb__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-4-resources_for_backend_s3_dynamodb__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-4-resources_for_backend_s3_dynamodb__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-4-resources_for_backend_s3_dynamodb__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/rapakakarthik__Terraform__day-4-resources_for_backend_s3_dynamodb__main.tf", "start_line": 6}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Here is a simple example that instantiates the google image and spins up an\n# instance\n\nmodule \"nixos_image_1809\" {\n  source        = \"../../google_image_nixos\"\n  nixos_version = \"18.09\"\n}\n\n// This instance is not very useful since it doesn't contain any\n// configuration. This could be fixed by passing a user metadata script.\nresource \"google_compute_instance\" \"image-nixos\" {\n  name         = \"image-nixos\"\n  machine_type = \"n1-standard-1\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = module.nixos_image_1809.self_link\n    }\n  }\n\n  network_interface {\n    network = \"default\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nix-community__terraform-nixos__examples__google__image_nixos.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nix-community__terraform-nixos__examples__google__image_nixos.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nix-community__terraform-nixos__examples__google__image_nixos.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nix-community__terraform-nixos__examples__google__image_nixos.tf", "start_line": 11}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\n  Web Servers\n*/\nresource \"aws_security_group\" \"web\" {\n    name = \"vpc_web\"\n    description = \"Allow incoming HTTP connections.\"\n\n    ingress {\n        from_port = 80\n        to_port = 80\n        protocol = \"tcp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    ingress {\n        from_port = 443\n        to_port = 443\n        protocol = \"tcp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    ingress {\n        from_port = -1\n        to_port = -1\n        protocol = \"icmp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n\n    egress { # SQL Server\n        from_port = 1433\n        to_port = 1433\n        protocol = \"tcp\"\n        cidr_blocks = [\"${var.private_subnet_cidr}\"]\n    }\n    egress { # MySQL\n        from_port = 3306\n        to_port = 3306\n        protocol = \"tcp\"\n        cidr_blocks = [\"${var.private_subnet_cidr}\"]\n    }\n\n    vpc_id = \"${aws_vpc.default.id}\"\n\n    tags {\n        Name = \"WebServerSG\"\n    }\n}\n\nresource \"aws_instance\" \"web-1\" {\n    ami = \"${lookup(var.amis, var.aws_region)}\"\n    availability_zone = \"eu-west-1a\"\n    instance_type = \"m1.small\"\n    key_name = \"${var.aws_key_name}\"\n    vpc_security_group_ids = [\"${aws_security_group.web.id}\"]\n    subnet_id = \"${aws_subnet.eu-west-1a-public.id}\"\n    associate_public_ip_address = true\n    source_dest_check = false\n\n    tags {\n        Name = \"Web Server 1\"\n    }\n}\n\nresource \"aws_eip\" \"web-1\" {\n    instance = \"${aws_instance.web-1.id}\"\n    vpc = true\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nickcharlton__terraform-aws-vpc__public.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nickcharlton__terraform-aws-vpc__public.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nickcharlton__terraform-aws-vpc__public.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_277", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nickcharlton__terraform-aws-vpc__public.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nickcharlton__terraform-aws-vpc__public.tf", "start_line": 47}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nickcharlton__terraform-aws-vpc__public.tf", "start_line": 47}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nickcharlton__terraform-aws-vpc__public.tf", "start_line": 47}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nickcharlton__terraform-aws-vpc__public.tf", "start_line": 47}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nickcharlton__terraform-aws-vpc__public.tf", "start_line": 47}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/nickcharlton__terraform-aws-vpc__public.tf", "start_line": 47}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"azurerm\" {\n    resource_group_name   = \"terraform-rg\"\n    storage_account_name  = \"terraformrg\"\n    container_name        = \"tfstate\"\n    key                   = \"terraform.tfstate\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HoussemDellai__terraform-course__04_TF_State__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Retrieve a team\ndata \"sentry_team\" \"default\" {\n  organization = \"my-organization\"\n\n  slug = \"my-team\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jianyuan__terraform-provider-sentry__examples__data-sources__sentry_team__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nterraform {\n  required_providers {\n    aws = \"3.19.0\"\n  }\n}\n\nresource \"aws_vpc\" \"vpc\" {\n  cidr_block = \"10.0.0.0/16\"\n}\n\nresource \"aws_internet_gateway\" \"main\" {\n  vpc_id = aws_vpc.vpc.id\n\n  tags = {\n    Name = \"main\"\n  }\n}\n\nresource \"aws_default_route_table\" \"default\" {\n  default_route_table_id = aws_vpc.vpc.default_route_table_id\n\n  route {\n    cidr_block = \"10.1.1.0/24\"\n    gateway_id = aws_internet_gateway.main.id\n  }\n\n  route {\n    cidr_block = \"10.1.2.0/24\"\n    gateway_id = aws_internet_gateway.main.id\n  }\n\n  tags = {\n    Name = \"default_table\"\n  }\n}\n\nresource \"aws_route_table\" \"table2\" {\n  vpc_id = aws_vpc.vpc.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.main.id\n  }\n\n  route {\n    ipv6_cidr_block = \"::/0\"\n    gateway_id = aws_internet_gateway.main.id\n  }\n\n  tags = {\n    Name = \"table2\"\n  }\n}\n\nresource \"aws_route_table\" \"table1\" {\n  vpc_id = aws_vpc.vpc.id\n\n  tags = {\n    Name = \"table1\"\n  }\n}\n\nresource \"aws_route\" \"route1\" {\n  route_table_id = aws_route_table.table1.id\n  gateway_id = aws_internet_gateway.main.id\n  destination_cidr_block = \"1.1.1.1/32\"\n}\n\nresource \"aws_route\" \"route_v6\" {\n  route_table_id = aws_route_table.table1.id\n  gateway_id = aws_internet_gateway.main.id\n  destination_ipv6_cidr_block = \"::/0\"\n}\n\nresource \"aws_route_table\" \"table3\" {\n  vpc_id = aws_vpc.vpc.id\n\n  tags = {\n    Name = \"table3\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_ec2_route_multiple__terraform.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_ec2_route_multiple__terraform.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_ec2_route_multiple__terraform.tf", "start_line": 11}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"vpc\" {\n  source = \"terraform-aws-modules/vpc/aws\"\n  version = \"~> 3.0\"\n\n  name = var.name\n  cidr = var.cidr\n\n  public_subnets = var.public_subnets\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices__examples__large-terraform__modules__network__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/antonbabenko__terraform-best-practices__examples__large-terraform__modules__network__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"test_instance\" \"foo\" {\n    ami = \"bar\"\n}\n\nresource \"test_instance\" \"bar\" {\n    ami = \"error\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform__internal__backend__local__testdata__apply-error__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"unifi_ap_group\" \"default\" {\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/paultyng__terraform-provider-unifi__examples__data-sources__unifi_ap_group__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nprovider \"google\" {\n  project = var.project_id\n}\n\nlocals {\n  instance_name = format(\"%s-%s\", var.instance_name, substr(md5(module.gce-container.container.image), 0, 8))\n  config_path   = \"/etc/hello-app/config.json\"\n}\n\nmodule \"gce-container\" {\n  source  = \"terraform-google-modules/container-vm/google\"\n  version = \"~> 3.0\"\n\n  cos_image_name = var.cos_image_name\n\n  container = {\n    image = \"gcr.io/google-samples/hello-app:1.0\"\n\n    volumeMounts = [\n      {\n        mountPath = \"/config.json\"\n        name      = \"config\"\n        readOnly  = true\n      },\n    ]\n  }\n\n  volumes = [\n    {\n      name = \"config\"\n      hostPath = {\n        path = local.config_path\n      }\n    },\n  ]\n\n  restart_policy = \"Always\"\n}\n\ndata \"template_file\" \"startup_script\" {\n  template = file(\"${path.module}/startup.sh.tpl\")\n  vars = {\n    instance_name = local.instance_name\n    config_path   = local.config_path\n  }\n}\n\nresource \"google_compute_instance\" \"vm\" {\n  project      = var.project_id\n  name         = local.instance_name\n  machine_type = \"n1-standard-1\"\n  zone         = var.zone\n\n  boot_disk {\n    initialize_params {\n      image = module.gce-container.source_image\n    }\n  }\n\n  network_interface {\n    subnetwork_project = var.subnetwork_project\n    subnetwork         = var.subnetwork\n    access_config {}\n  }\n\n  tags = [\"container-vm-example\"]\n\n  metadata = merge(\n    {\n      gce-container-declaration = module.gce-container.metadata_value\n      google-logging-enabled    = \"true\"\n      google-monitoring-enabled = \"true\"\n    },\n    var.additional_metadata,\n  )\n\n  labels = {\n    container-vm = module.gce-container.vm_container_label\n  }\n\n  service_account {\n    email = var.client_email\n    scopes = [\n      \"https://www.googleapis.com/auth/cloud-platform\",\n    ]\n  }\n\n  metadata_startup_script = data.template_file.startup_script.rendered\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_config_file__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_config_file__main.tf", "start_line": 26}, {"tool": "checkov", "rule_id": "CKV_GCP_32", "severity": "HIGH", "message": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_config_file__main.tf", "start_line": 64}, {"tool": "checkov", "rule_id": "CKV_GCP_38", "severity": "HIGH", "message": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_config_file__main.tf", "start_line": 64}, {"tool": "checkov", "rule_id": "CKV_GCP_40", "severity": "HIGH", "message": "Ensure that Compute instances do not have public IP addresses", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_config_file__main.tf", "start_line": 64}, {"tool": "checkov", "rule_id": "CKV_GCP_39", "severity": "HIGH", "message": "Ensure Compute instances are launched with Shielded VM enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-container-vm__examples__instance_with_config_file__main.tf", "start_line": 64}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.AWS_REGION\n}\n\ndata \"aws_region\" \"current\" {\n}\n\ndata \"aws_availability_zones\" \"available\" {\n}\n\nprovider \"http\" {\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/anshulc55__terraform__casestudy#eks__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.aws_region\n}\n\nresource \"aws_instance\" \"test_instance\" {\n  ami           = \"ami-04f7a54071e74f488\"\n  instance_type = \"t2.micro\"\n  tags = {\n    Name = \"HelloWorld-Isolation-Dev\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_03__01_state_file_isolation__dev__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_03__01_state_file_isolation__dev__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_03__01_state_file_isolation__dev__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_03__01_state_file_isolation__dev__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_03__01_state_file_isolation__dev__main.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jakefurlong__terraform__chapter_03__01_state_file_isolation__dev__main.tf", "start_line": 5}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Defining the Provider of the Terraform\n\nprovider \"aws\" {\n        access_key = \"${var.access_key}\"\n        secret_key = \"${var.secret_key}\"\n        region = \"${var.region}\"\n}\n\n# Defining the VPC\n\nresource \"aws_vpc\" \"terraform_vpc\" {\n  cidr_block = \"10.0.0.0/26\"\n  instance_tenancy = \"default\"\n  enable_dns_hostnames = true\n\n  tags = {\n    Name = \"terraform_vpc\"\n  }\n}\n\n# Defining the VPC Subnets\n\nresource \"aws_subnet\" \"pub-sub1\" {\n  cidr_block = \"10.0.0.0/28\"\n  vpc_id = \"${aws_vpc.terraform_vpc.id}\"\n  availability_zone = \"us-east-1a\"\n  map_public_ip_on_launch = true\n\n  tags = {\n    Name = \"pub-sub-A\"\n  }\n}\n\n/*\nresource \"aws_subnet\" \"pub-sub2\" {\n  cidr_block = \"10.0.0.16/28\"\n  vpc_id = \"${aws_vpc.terraform_vpc.id}\"\n  availability_zone = \"us-east-1b\"\n  map_public_ip_on_launch = true\n\n  tags = {\n    Name = \"pub-sub-B\"\n  }\n}\n\nresource \"aws_subnet\" \"pri-sub1\" {\n  cidr_block = \"10.0.0.32/28\"\n  vpc_id = \"${aws_vpc.terraform_vpc.id}\"\n  availability_zone = \"us-east-1c\"\n\n  tags = {\n    Name = \"pri-sub-A\"\n  }\n}\n\n*/\n\nresource \"aws_subnet\" \"pri-sub2\" {\n  cidr_block = \"10.0.0.48/28\"\n  vpc_id = \"${aws_vpc.terraform_vpc.id}\"\n  availability_zone = \"us-east-1d\"\n\n  tags = {\n    Name = \"pri-sub-B\"\n  }\n}\n\n# Defining the VPC Internet Gateway\n\nresource \"aws_internet_gateway\" \"igw\" {\n  vpc_id = \"${aws_vpc.terraform_vpc.id}\"\n\n  tags = {\n    Name = \"terraform_vpc_igw\"\n  }\n}\n\n# Defining the Elastic IP Address for NAT\n\nresource \"aws_eip\" \"nat\" {\nvpc      = true\n}\n\n# Defining the VPC NAT Gateway\n\nresource \"aws_nat_gateway\" \"terraform_vpc_nat\" {\n  allocation_id = \"${aws_eip.nat.id}\"\n  subnet_id     = \"${aws_subnet.pub-sub1.id}\"\n  depends_on = [\"aws_internet_gateway.igw\"]\n  tags = {\n    Name = \"terraform_vpc_nat\"\n  }\n}\n\n\n\n# Defining the route table for public subnet\n\nresource \"aws_route_table\" \"pub-route\" {\n  vpc_id = \"${aws_vpc.terraform_vpc.id}\"\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = \"${aws_internet_gateway.igw.id}\"\n  }\n\n  tags = {\n    Name = \"Public_Route\"\n  }\n}\n\n# Associating the Public subnet to the Internet exposed route table\n\nresource \"aws_route_table_association\" \"aws_rt_association\" {\n  route_table_id = \"${aws_route_table.pub-route.id}\"\n  subnet_id = \"${aws_subnet.pub-sub1.id}\"\n}\n\n# Defining the route table for private subnet\n\nresource \"aws_route_table\" \"pri-route\" {\n  vpc_id = \"${aws_vpc.terraform_vpc.id}\"\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = \"${aws_nat_gateway.terraform_vpc_nat.id}\"\n  }\n\n  tags = {\n    Name = \"Private_Route\"\n  }\n}\n\n# Associating the Private subnet to the NAT exposed route table\n\nresource \"aws_route_table_association\" \"aws_rt_association2\" {\n  route_table_id = \"${aws_route_table.pri-route.id}\"\n  subnet_id = \"${aws_subnet.pri-sub2.id}\"\n}\n\n\n\n# Defining the Public Subnet Security Group\n\nresource \"aws_security_group\" \"sg_public\" {\n  name = \"sg_public\"\n  description = \"Allowing Internet Access\"\n  vpc_id = \"${aws_vpc.terraform_vpc.id}\"\n\n  tags = {\n    Name = \"sg_public_subnet\"\n  }\n\n  ingress {\n    from_port = 80\n    to_port = 80\n    protocol = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port = 22\n    to_port = 22\n    protocol = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n    egress {\n    from_port       = 0\n    to_port         = 0\n    protocol        = \"-1\"\n    cidr_blocks     = [\"0.0.0.0/0\"]\n  }\n\n}\n\n# Defining the Private Subnet Security Group\n\nresource \"aws_security_group\" \"sg_private\" {\n  name = \"sg_private\"\n  description = \"Restricted Access\"\n  vpc_id = \"${aws_vpc.terraform_vpc.id}\"\n\n  tags = {\n    Name = \"sg_private_subnet\"\n  }\n\n  ingress {\n    from_port = 22\n    to_port = 22\n    protocol = \"tcp\"\n    cidr_blocks = [\n      aws_subnet.pub-sub1.cidr_block]\n  }\n\n  egress {\n    from_port = 0\n    to_port = 0\n    protocol = \"-1\"\n    cidr_blocks = [\n      \"0.0.0.0/0\"]\n  }\n}\n\n# Creating the aws ec2 instance in the Public Subnet\n\n\nresource \"aws_instance\" \"web-instance\" {\n        ami = \"${var.aws_ami}\"\n\t\tsubnet_id = \"${aws_subnet.pub-sub1.id}\"\n        instance_type = \"t2.micro\"\n        key_name = \"${var.key_name}\"\n        user_data = \"${file(\"httpd.sh\")}\"\n        vpc_security_group_ids = [\"${aws_security_group.sg_public.id}\"]\n  tags = {\n    Name = \"web-instance\"\n  }\n}\n\n# Creating the aws ec2 instance in the Private Subnet with SSH accessible from Public Subnet CIDR\n\nresource \"aws_instance\" \"private-instance\" {\n        ami = \"${var.aws_ami}\"\n\t\tsubnet_id = \"${aws_subnet.pri-sub2.id}\"\n        instance_type = \"t2.micro\"\n        key_name = \"${var.key_name}\"\n        vpc_security_group_ids = [\"${aws_security_group.sg_private.id}\"]\n  tags = {\n    Name = \"private-instance\"\n  }\n}\n\n\n\n\n\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 145}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 145}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 145}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 145}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 179}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 179}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 222}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 222}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 222}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 222}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 208}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dileeprithvi__Terraform__terraform-vpc-ec2__vpc.tf", "start_line": 222}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Allow Lambda to invoke our functions:\nresource \"aws_iam_role\" \"this\" {\n  name = \"${local.prefix_with_domain}\"\n  tags = \"${var.tags}\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": [\n          \"lambda.amazonaws.com\",\n          \"edgelambda.amazonaws.com\"\n        ]\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nEOF\n}\n\n# Allow API Gateway to invoke our functions:\nresource \"aws_lambda_permission\" \"this\" {\n  statement_id  = \"AllowAPIGatewayInvoke\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = \"${local.function_arn}\"\n  principal     = \"apigateway.amazonaws.com\"\n  source_arn    = \"${aws_api_gateway_stage.this.execution_arn}/*/*\" # the /*/* portion grants access from any method on any resource within the API Gateway \"REST API\"\n}\n\n# Allow writing logs to CloudWatch from our functions:\nresource \"aws_iam_policy\" \"this\" {\n  count = \"${var.lambda_logging_enabled ? 1 : 0}\"\n  name  = \"${local.prefix_with_domain}\"\n\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:*\",\n      \"Effect\": \"Allow\"\n    }\n  ]\n}\nEOF\n}\n\nresource \"aws_iam_role_policy_attachment\" \"this\" {\n  count      = \"${var.lambda_logging_enabled ? 1 : 0}\"\n  role       = \"${aws_iam_role.this.name}\"\n  policy_arn = \"${aws_iam_policy.this.arn}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/futurice__terraform-examples__aws__aws_lambda_api__permissions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"auth0_connection_profile\" \"my_profile\" {\n  name = \"My-Profile\"\n\n  organization {\n    show_as_button             = \"optional\"\n    assign_membership_on_login = \"required\"\n  }\n\n  connection_name_prefix_template = \"template1\"\n\n  enabled_features = [\n    \"scim\",\n    \"universal_logout\"\n  ]\n}\n\ndata \"auth0_connection_profile\" \"my_profile_ds\" {\n  id = auth0_connection_profile.my_profile.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/auth0__terraform-provider-auth0__examples__data-sources__auth0_connection_profile__data-source.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n### Let's play with conditional logic!\nvariable \"my_boo\" {\n    type = bool\n    default = true\n}\n\nvariable \"my_int\" {\n    type = number\n    default = 1\n}\n\nvariable \"my_string\" {\n    type = string\n    default = \"\"\n}\n\nlocals {\n    a_test = var.my_boo ? \"True!\" : \"False!\"\n    b_test = var.my_int > 0 ? \"More than 0\" : \"Less than 0\"\n    workspace_map = {\n        dev = \"This is my dev content\"\n        prod = \"This is my prod content\"\n    }\n}\n\noutput \"out_1\" {\n    value = local.a_test\n}\n\noutput \"out_2\" {\n    value = local.b_test\n}\n\n/*\n\nresource \"local_file\" \"workspace_file\" { \n  count = terraform.workspace == \"default\" ? 0 : 1\n  content = local.workspace_map[terraform.workspace]\n  #content = terraform.workspace != \"default\" ? local.workspace_map[terraform.workspace] : \"\"\n  filename = \"${path.module}/${terraform.workspace}.txt\"\n}\n\n*/\n\n/*\n\nresource \"local_file\" \"workspace_file_2\" { \n  count = contains(keys(local.workspace_map),terraform.workspace) ? 1 : 0\n  content = contains(keys(local.workspace_map),terraform.workspace) ? local.workspace_map[terraform.workspace] : \"\"\n  filename = \"${path.module}/${terraform.workspace}_2.txt\"\n}\n\n*/", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__terraform-tuesdays__2020-06-09-ConditionalLogic__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.5.7\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \">= 6.0\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \">= 2.0\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-notify-slack__examples__cloudwatch-alerts-to-slack__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# <-- BEGIN DOC -->\n#\n# This mixin is meant to be added to Terraform components in order to append a `Component` tag to all resources in the\n# configuration, specifying which component the resources belong to.\n#\n# It's important to note that all modules and resources within the component then need to use `module.introspection.context`\n# and `module.introspection.tags`, respectively, rather than `module.this.context` and `module.this.tags`.\n#\n# <-- END DOC -->\nlocals {\n  # Throw an error if lookup fails\n  check_required_tags = module.this.enabled ? [\n    for k in var.required_tags :\n    lookup(module.this.tags, k)\n  ] : []\n}\n\nvariable \"required_tags\" {\n  type        = list(string)\n  description = \"List of required tag names\"\n  default     = []\n}\n\n# `introspection` module will contain the additional tags\nmodule \"introspection\" {\n  source  = \"cloudposse/label/null\"\n  version = \"0.25.0\"\n\n  tags = merge(var.tags, {\n    \"Component\" = basename(abspath(path.module))\n  })\n\n  context = module.this.context\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-components__mixins__introspection.mixin.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-components__mixins__introspection.mixin.tf", "start_line": 25}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"cause-changes\" {\n  default = false\n}\n\nvariable \"len\" {\n  default = 5\n}\n\nresource \"random_string\" \"the_string\" {\n  count = var.cause-changes ? 1 : 0\n  length = var.len\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/dflook__terraform-github-actions__tests__workflows__test-changes-only__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"ap-south-1\"\n}\n\ndata \"aws_eks_cluster\" \"cluster\" {\n  name = module.eks.cluster_id\n}\n\ndata \"aws_eks_cluster_auth\" \"cluster\" {\n  name = module.eks.cluster_id\n}\n\ndata \"aws_availability_zones\" \"available\" {}\n\nlocals {\n  cluster_name = \"learnk8s\"\n}\n\nprovider \"kubernetes\" {\n  host                   = data.aws_eks_cluster.cluster.endpoint\n  cluster_ca_certificate = base64decode(data.aws_eks_cluster.cluster.certificate_authority.0.data)\n  token                  = data.aws_eks_cluster_auth.cluster.token\n\n}\n\nmodule \"eks-kubeconfig\" {\n  source  = \"hyperbadger/eks-kubeconfig/aws\"\n  version = \"1.0.0\"\n\n  depends_on = [module.eks]\n  cluster_id = module.eks.cluster_id\n}\n\nresource \"local_file\" \"kubeconfig\" {\n  content  = module.eks-kubeconfig.kubeconfig\n  filename = \"kubeconfig_${local.cluster_name}\"\n}\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"3.18.1\"\n\n  name                 = \"k8s-vpc\"\n  cidr                 = \"172.16.0.0/16\"\n  azs                  = data.aws_availability_zones.available.names\n  private_subnets      = [\"172.16.1.0/24\", \"172.16.2.0/24\", \"172.16.3.0/24\"]\n  public_subnets       = [\"172.16.4.0/24\", \"172.16.5.0/24\", \"172.16.6.0/24\"]\n  enable_nat_gateway   = true\n  single_nat_gateway   = true\n  enable_dns_hostnames = true\n\n  public_subnet_tags = {\n    \"kubernetes.io/cluster/${local.cluster_name}\" = \"shared\"\n    \"kubernetes.io/role/elb\"                      = \"1\"\n  }\n\n  private_subnet_tags = {\n    \"kubernetes.io/cluster/${local.cluster_name}\" = \"shared\"\n    \"kubernetes.io/role/internal-elb\"             = \"1\"\n  }\n}\n\nmodule \"eks\" {\n  source  = \"terraform-aws-modules/eks/aws\"\n  version = \"18.30.3\"\n\n  cluster_name    = local.cluster_name\n  cluster_version = \"1.24\"\n  subnet_ids      = module.vpc.private_subnets\n  vpc_id          = module.vpc.vpc_id\n\n  eks_managed_node_groups = {\n    first = {\n      desired_capacity = 1\n      max_capacity     = 10\n      min_capacity     = 1\n\n      instance_type = \"m5.large\"\n    }\n  }\n  node_security_group_additional_rules = {\n    ingress_allow_access_from_control_plane = {\n      type                          = \"ingress\"\n      protocol                      = \"tcp\"\n      from_port                     = 9443\n      to_port                       = 9443\n      source_cluster_security_group = true\n      description                   = \"Allow access from control plane to webhook port of AWS load balancer controller\"\n    }\n  }\n}\n\nresource \"aws_iam_policy\" \"worker_policy\" {\n  name        = \"worker-policy\"\n  description = \"Worker policy for the ALB Ingress\"\n\n  policy = file(\"iam-policy.json\")\n}\n\nresource \"aws_iam_role_policy_attachment\" \"additional\" {\n  for_each = module.eks.eks_managed_node_groups\n\n  policy_arn = aws_iam_policy.worker_policy.arn\n  role       = each.value.iam_role_name\n}\n\nprovider \"helm\" {\n  kubernetes {\n    host                   = data.aws_eks_cluster.cluster.endpoint\n    cluster_ca_certificate = base64decode(data.aws_eks_cluster.cluster.certificate_authority.0.data)\n    token                  = data.aws_eks_cluster_auth.cluster.token\n  }\n}\n\nresource \"helm_release\" \"ingress\" {\n  name       = \"ingress\"\n  chart      = \"aws-load-balancer-controller\"\n  repository = \"https://aws.github.io/eks-charts\"\n  version    = \"1.4.6\"\n\n  set {\n    name  = \"autoDiscoverAwsRegion\"\n    value = \"true\"\n  }\n  set {\n    name  = \"autoDiscoverAwsVpcID\"\n    value = \"true\"\n  }\n  set {\n    name  = \"clusterName\"\n    value = local.cluster_name\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__04_terraform_helm_provider__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__04_terraform_helm_provider__main.tf", "start_line": 26}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__04_terraform_helm_provider__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/k-mitevski__terraform-k8s__04_terraform_helm_provider__main.tf", "start_line": 63}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: Apache-2.0\n\nterraform {\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \">=3.41.0\"\n    }\n  }\n}\n\nprovider \"azurerm\" {\n  features {\n    resource_group {\n      prevent_deletion_if_contains_resources = false\n    }\n  }\n}\n\nresource \"azurerm_resource_group\" \"myresourcegroup\" {\n  name     = \"${var.prefix}-workshop\"\n  location = var.location\n\n  tags = {\n    environment = \"Production\"\n  }\n}\n\nresource \"azurerm_virtual_network\" \"vnet\" {\n  name                = \"${var.prefix}-vnet\"\n  location            = azurerm_resource_group.myresourcegroup.location\n  address_space       = [var.address_space]\n  resource_group_name = azurerm_resource_group.myresourcegroup.name\n}\n\nresource \"azurerm_subnet\" \"subnet\" {\n  name                 = \"${var.prefix}-subnet\"\n  virtual_network_name = azurerm_virtual_network.vnet.name\n  resource_group_name  = azurerm_resource_group.myresourcegroup.name\n  address_prefixes     = [var.subnet_prefix]\n}\n\nresource \"azurerm_network_security_group\" \"catapp-sg\" {\n  name                = \"${var.prefix}-sg\"\n  location            = var.location\n  resource_group_name = azurerm_resource_group.myresourcegroup.name\n\n  security_rule {\n    name                       = \"HTTP\"\n    priority                   = 100\n    direction                  = \"Inbound\"\n    access                     = \"Allow\"\n    protocol                   = \"Tcp\"\n    source_port_range          = \"*\"\n    destination_port_range     = \"80\"\n    source_address_prefix      = \"*\"\n    destination_address_prefix = \"*\"\n  }\n\n  security_rule {\n    name                       = \"HTTPS\"\n    priority                   = 102\n    direction                  = \"Inbound\"\n    access                     = \"Allow\"\n    protocol                   = \"Tcp\"\n    source_port_range          = \"*\"\n    destination_port_range     = \"443\"\n    source_address_prefix      = \"*\"\n    destination_address_prefix = \"*\"\n  }\n\n  security_rule {\n    name                       = \"SSH\"\n    priority                   = 101\n    direction                  = \"Inbound\"\n    access                     = \"Allow\"\n    protocol                   = \"Tcp\"\n    source_port_range          = \"*\"\n    destination_port_range     = \"22\"\n    source_address_prefix      = \"*\"\n    destination_address_prefix = \"*\"\n  }\n}\n\nresource \"azurerm_network_interface\" \"catapp-nic\" {\n  name                = \"${var.prefix}-catapp-nic\"\n  location            = azurerm_resource_group.myresourcegroup.location\n  resource_group_name = azurerm_resource_group.myresourcegroup.name\n\n  ip_configuration {\n    name                          = \"${var.prefix}ipconfig\"\n    subnet_id                     = azurerm_subnet.subnet.id\n    private_ip_address_allocation = \"Dynamic\"\n    public_ip_address_id          = azurerm_public_ip.catapp-pip.id\n  }\n}\n\nresource \"azurerm_network_interface_security_group_association\" \"catapp-nic-sg-ass\" {\n  network_interface_id      = azurerm_network_interface.catapp-nic.id\n  network_security_group_id = azurerm_network_security_group.catapp-sg.id\n}\n\nresource \"azurerm_public_ip\" \"catapp-pip\" {\n  name                = \"${var.prefix}-ip\"\n  location            = azurerm_resource_group.myresourcegroup.location\n  resource_group_name = azurerm_resource_group.myresourcegroup.name\n  allocation_method   = \"Dynamic\"\n  domain_name_label   = \"${var.prefix}-meow\"\n}\n\nresource \"azurerm_linux_virtual_machine\" \"catapp\" {\n  name                            = \"${var.prefix}-meow\"\n  location                        = azurerm_resource_group.myresourcegroup.location\n  resource_group_name             = azurerm_resource_group.myresourcegroup.name\n  size                            = var.vm_size\n  admin_username                  = var.admin_username\n  admin_password                  = var.admin_password\n  disable_password_authentication = false\n  network_interface_ids           = [azurerm_network_interface.catapp-nic.id]\n\n  source_image_reference {\n    publisher = var.image_publisher\n    offer     = var.image_offer\n    sku       = var.image_sku\n    version   = var.image_version\n  }\n\n  os_disk {\n    caching              = \"ReadWrite\"\n    storage_account_type = \"Standard_LRS\"\n    disk_size_gb         = \"60\"\n\n  }\n\n  tags = {}\n\n  # Added to allow destroy to work correctly.\n  depends_on = [azurerm_network_interface_security_group_association.catapp-nic-sg-ass]\n}\n\n# We're using a little trick here so we can run the provisioner without\n# destroying the VM. Do not do this in production.\n\n# If you need ongoing management (Day N) of your virtual machines a tool such\n# as Chef or Puppet is a better choice. These tools track the state of\n# individual files and can keep them in the correct configuration.\n\n# Here we do the following steps:\n# Sync everything in files/ to the remote VM.\n# Set up some environment variables for our script.\n# Add execute permissions to our scripts.\n# Run the deploy_app.sh script.\nresource \"null_resource\" \"configure-cat-app\" {\n  depends_on = [\n    azurerm_linux_virtual_machine.catapp,\n  ]\n\n  # Terraform 0.11\n  # triggers {\n  #   build_number = \"${timestamp()}\"\n  # }\n\n  # Terraform 0.12\n  triggers = {\n    build_number = timestamp()\n  }\n\n  provisioner \"file\" {\n    source      = \"files/\"\n    destination = \"/home/${var.admin_username}/\"\n\n    connection {\n      type     = \"ssh\"\n      user     = var.admin_username\n      password = var.admin_password\n      host     = azurerm_public_ip.catapp-pip.fqdn\n    }\n  }\n\n  provisioner \"remote-exec\" {\n    inline = [\n      \"sudo apt -y update\",\n      \"sleep 15\",\n      \"sudo apt -y update\",\n      \"sudo apt -y install apache2\",\n      \"sudo systemctl start apache2\",\n      \"sudo chown -R ${var.admin_username}:${var.admin_username} /var/www/html\",\n      \"chmod +x *.sh\",\n      \"PLACEHOLDER=${var.placeholder} WIDTH=${var.width} HEIGHT=${var.height} PREFIX=${var.prefix} ./deploy_app.sh\",\n      \"sudo apt -y install cowsay\",\n      \"cowsay Mooooooooooo!\",\n    ]\n\n    connection {\n      type     = \"ssh\"\n      user     = var.admin_username\n      password = var.admin_password\n      host     = azurerm_public_ip.catapp-pip.fqdn\n    }\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__hashicat-azure__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_160", "severity": "HIGH", "message": "Ensure that HTTP (port 80) access is restricted from the internet", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__hashicat-azure__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AZURE_10", "severity": "HIGH", "message": "Ensure that SSH access is restricted from the internet", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__hashicat-azure__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AZURE_50", "severity": "HIGH", "message": "Ensure Virtual Machine Extensions are not Installed", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__hashicat-azure__main.tf", "start_line": 112}, {"tool": "checkov", "rule_id": "CKV_AZURE_1", "severity": "HIGH", "message": "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__hashicat-azure__main.tf", "start_line": 112}, {"tool": "checkov", "rule_id": "CKV_AZURE_178", "severity": "HIGH", "message": "Ensure linux VM enables SSH with keys for secure communication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__hashicat-azure__main.tf", "start_line": 112}, {"tool": "checkov", "rule_id": "CKV_AZURE_149", "severity": "HIGH", "message": "Ensure that Virtual machine does not enable password authentication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__hashicat-azure__main.tf", "start_line": 112}, {"tool": "checkov", "rule_id": "CKV_AZURE_119", "severity": "HIGH", "message": "Ensure that Network Interfaces don't use public IPs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__hashicat-azure__main.tf", "start_line": 86}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_vpc\" \"vpc\" {\n  cidr_block = \"10.0.0.0/16\"\n\n  tags = {\n    Name = var.vpc-name\n  }\n}\n\nresource \"aws_internet_gateway\" \"igw\" {\n  vpc_id = aws_vpc.vpc.id\n\n  tags = {\n    Name = var.igw-name\n  }\n}\n\nresource \"aws_subnet\" \"public-subnet\" {\n  vpc_id                  = aws_vpc.vpc.id\n  cidr_block              = \"10.0.1.0/24\"\n  availability_zone       = \"us-east-1a\"\n  map_public_ip_on_launch = true\n\n  tags = {\n    Name = var.subnet-name\n  }\n}\n\nresource \"aws_route_table\" \"rt\" {\n  vpc_id = aws_vpc.vpc.id\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.igw.id\n  }\n\n  tags = {\n    Name = var.rt-name\n  }\n}\n\nresource \"aws_route_table_association\" \"rt-association\" {\n  route_table_id = aws_route_table.rt.id\n  subnet_id      = aws_subnet.public-subnet.id\n}\n\nresource \"aws_security_group\" \"security-group\" {\n  vpc_id      = aws_vpc.vpc.id\n  description = \"Allowing Jenkins, Sonarqube, SSH Access\"\n\n  ingress = [\n    for port in [22, 8080, 9000, 9090, 80] : {\n      description      = \"TLS from VPC\"\n      from_port        = port\n      to_port          = port\n      protocol         = \"tcp\"\n      ipv6_cidr_blocks = [\"::/0\"]\n      self             = false\n      prefix_list_ids  = []\n      security_groups  = []\n      cidr_blocks      = [\"0.0.0.0/0\"]\n    }\n  ]\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = var.sg-name\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__vpc.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__vpc.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__vpc.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__vpc.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__vpc.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LondheShubham153__TWSThreeTierAppChallenge__Jenkins-Server-TF__vpc.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/integrations__terraform-provider-github__examples__app_installation_repository__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"alicloud_instance\" \"instance\" {\n  security_groups  = alicloud_security_group.group.*.id\n  instance_type    = data.alicloud_instance_types.types_ds.instance_types.0.id\n  image_id         = \"ubuntu_18_04_64_20G_alibase_20190624.vhd\"\n  vswitch_id       = alicloud_vswitch.vswitch.id\n  system_disk_size = 20\n  instance_name    = \"huocorp_terraform_goat_instance\"\n  depends_on = [\n    alicloud_security_group.group,\n    alicloud_vswitch.vswitch\n  ]\n}\n\nresource \"alicloud_security_group\" \"group\" {\n  name   = \"huocorp_terraform_goat_security_group\"\n  vpc_id = alicloud_vpc.vpc.id\n  depends_on = [\n    alicloud_vpc.vpc\n  ]\n}\n\nresource \"alicloud_vswitch\" \"vswitch\" {\n  vpc_id       = alicloud_vpc.vpc.id\n  cidr_block   = \"172.16.0.0/24\"\n  zone_id      = \"cn-beijing-h\"\n  vswitch_name = \"huocorp_terraform_goat_vswitch\"\n  depends_on = [\n    alicloud_vpc.vpc\n  ]\n}\n\nresource \"alicloud_vpc\" \"vpc\" {\n  vpc_name   = \"huocorp_terraform_goat_vpc\"\n  cidr_block = \"172.16.0.0/16\"\n}\n\nresource \"alicloud_security_group_rule\" \"allow_21_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"21/21\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_22_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"22/22\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_23_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"23/23\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_25_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"25/25\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_137_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"137/137\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_138_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"138/138\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_445_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"445/445\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_1433_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"1433/1433\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_1434_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"1434/1434\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_1521_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"1521/1521\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_1522_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"1522/1522\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_2375_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"2375/2375\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_2376_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"2376/2376\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_3306_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"3306/3306\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_3389_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"3389/3389\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_4505_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"4505/4505\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_4506_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"4506/4506\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_5432_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"5432/5432\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_5500_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"5500/5500\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_5601_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"5601/5601\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_5900_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"5900/5900\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_6379_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"6379/6379\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_8020_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"8020/8020\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_9200_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"9200/9200\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_27017_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"27017/27017\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_50070_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"50070/50070\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\nresource \"alicloud_security_group_rule\" \"allow_50470_port\" {\n  type              = \"ingress\"\n  ip_protocol       = \"tcp\"\n  nic_type          = \"intranet\"\n  policy            = \"accept\"\n  port_range        = \"50470/50470\"\n  priority          = 1\n  security_group_id = alicloud_security_group.group.id\n  cidr_ip           = \"0.0.0.0/0\"\n  depends_on = [\n    alicloud_security_group.group\n  ]\n}\n\ndata \"alicloud_instance_types\" \"types_ds\" {\n  cpu_core_count = 1\n  memory_size    = 1\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HXSecurity__TerraformGoat__aliyun__networking__vpc_security_group_open_common_ports__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_ALI_2", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HXSecurity__TerraformGoat__aliyun__networking__vpc_security_group_open_common_ports__main.tf", "start_line": 51}, {"tool": "checkov", "rule_id": "CKV_ALI_3", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/HXSecurity__TerraformGoat__aliyun__networking__vpc_security_group_open_common_ports__main.tf", "start_line": 233}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\nCopyright 2019 The KubeOne Authors.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\nprovider \"aws\" {\n  region = var.aws_region\n}\n\nlocals {\n  kube_cluster_tag = \"kubernetes.io/cluster/${var.cluster_name}\"\n  ami              = var.ami == \"\" ? data.aws_ami.ami.id : var.ami\n  zoneA            = data.aws_availability_zones.available.names[0]\n  zoneB            = data.aws_availability_zones.available.names[1]\n  zoneC            = data.aws_availability_zones.available.names[2]\n\n  vpc_mask       = parseint(split(\"/\", data.aws_vpc.selected.cidr_block)[1], 10)\n  subnet_total   = pow(2, var.subnets_cidr - local.vpc_mask)\n  subnet_newbits = var.subnets_cidr - (32 - local.vpc_mask)\n\n  ipv6_vpc_mask       = parseint(split(\"/\", data.aws_vpc.selected.ipv6_cidr_block)[1], 10)\n  ipv6_subnet_total   = pow(2, 64 - local.ipv6_vpc_mask)\n  ipv6_subnet_newbits = 64 - local.ipv6_vpc_mask\n\n  worker_os             = var.worker_os == \"\" ? var.ami_filters[var.os].worker_os : var.worker_os\n  worker_deploy_ssh_key = var.worker_deploy_ssh_key ? [aws_key_pair.deployer.public_key] : []\n  ssh_username          = var.ssh_username == \"\" ? var.ami_filters[var.os].ssh_username : var.ssh_username\n  bastion_user          = var.bastion_user == \"\" ? var.ami_filters[var.os].ssh_username : var.bastion_user\n  kubeapi_endpoint      = var.disable_kubeapi_loadbalancer ? aws_instance.control_plane.0.private_ip : aws_elb.control_plane.0.dns_name\n  loadbalancer_count    = var.disable_kubeapi_loadbalancer ? 0 : 1\n\n  initial_machinedeployment_spotinstances = var.initial_machinedeployment_spotinstances_max_price > 0\n\n  cluster_autoscaler_min_replicas = var.cluster_autoscaler_min_replicas > 0 ? var.cluster_autoscaler_min_replicas : var.initial_machinedeployment_replicas\n  cluster_autoscaler_max_replicas = var.cluster_autoscaler_max_replicas > 0 ? var.cluster_autoscaler_max_replicas : var.initial_machinedeployment_replicas\n\n  subnets = {\n    (local.zoneA) = length(aws_subnet.public.*.id) > 0 ? aws_subnet.public[0].id : \"\"\n    (local.zoneB) = length(aws_subnet.public.*.id) > 0 ? aws_subnet.public[1].id : \"\"\n    (local.zoneC) = length(aws_subnet.public.*.id) > 0 ? aws_subnet.public[2].id : \"\"\n  }\n}\n\n################################# DATA SOURCES #################################\n\ndata \"aws_availability_zones\" \"available\" {\n  state = \"available\"\n}\n\ndata \"aws_ami\" \"ami\" {\n  most_recent = true\n  owners      = var.ami_filters[var.os].owners\n\n  filter {\n    name   = \"name\"\n    values = var.ami_filters[var.os].image_name\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  filter {\n    name   = \"architecture\"\n    values = [\"x86_64\"]\n  }\n}\n\nresource \"aws_default_vpc\" \"default\" {}\n\ndata \"aws_vpc\" \"selected\" {\n  id = var.vpc_id == \"default\" ? aws_default_vpc.default.id : var.vpc_id\n}\n\ndata \"aws_internet_gateway\" \"default\" {\n  filter {\n    name   = \"attachment.vpc-id\"\n    values = [data.aws_vpc.selected.id]\n  }\n}\n\nresource \"random_integer\" \"cidr_block\" {\n  min = 0\n  max = local.subnet_total - 1\n}\n\nresource \"random_integer\" \"ipv6_cidr_block\" {\n  min = 0\n  max = local.ipv6_subnet_total - 1\n}\n\n############################### NETWORKING SETUP ###############################\n\nresource \"aws_subnet\" \"public\" {\n  count                   = 3\n  availability_zone       = data.aws_availability_zones.available.names[count.index]\n  map_public_ip_on_launch = true\n  vpc_id                  = data.aws_vpc.selected.id\n\n  cidr_block = cidrsubnet(\n    data.aws_vpc.selected.cidr_block,\n    local.subnet_newbits,\n    (random_integer.cidr_block.result + count.index) % local.subnet_total,\n  )\n\n  ipv6_cidr_block = cidrsubnet(\n    data.aws_vpc.selected.ipv6_cidr_block,\n    local.ipv6_subnet_newbits,\n    (random_integer.ipv6_cidr_block.result + count.index) % local.ipv6_subnet_total,\n  )\n\n  assign_ipv6_address_on_creation = true\n\n  tags = tomap({\n    \"Name\"                   = \"${var.cluster_name}-${data.aws_availability_zones.available.names[count.index]}\",\n    \"Cluster\"                = var.cluster_name,\n    (local.kube_cluster_tag) = \"shared\",\n  })\n}\n\n################################### FIREWALL ###################################\n\nresource \"aws_security_group\" \"common\" {\n  name        = \"${var.cluster_name}-common\"\n  description = \"cluster common rules\"\n  vpc_id      = data.aws_vpc.selected.id\n\n  tags = tomap({\n    \"Cluster\"                = var.cluster_name,\n    (local.kube_cluster_tag) = \"shared\",\n  })\n}\n\nresource \"aws_security_group_rule\" \"ingress_self_allow_all\" {\n  type              = \"ingress\"\n  security_group_id = aws_security_group.common.id\n\n  description = \"allow all incoming traffic from members of this group\"\n  from_port   = 0\n  to_port     = 0\n  protocol    = \"-1\"\n  self        = true\n}\n\nresource \"aws_security_group_rule\" \"egress_allow_all\" {\n  type              = \"egress\"\n  security_group_id = aws_security_group.common.id\n\n  description      = \"allow all outgoing traffic\"\n  from_port        = 0\n  to_port          = 0\n  protocol         = \"-1\"\n  cidr_blocks      = [\"0.0.0.0/0\"]\n  ipv6_cidr_blocks = [\"::/0\"]\n}\n\nresource \"aws_security_group_rule\" \"nodeports\" {\n  type              = \"ingress\"\n  security_group_id = aws_security_group.common.id\n\n  description      = \"open nodeports\"\n  from_port        = 30000\n  to_port          = 32767\n  protocol         = \"tcp\"\n  cidr_blocks      = [\"0.0.0.0/0\"]\n  ipv6_cidr_blocks = [\"::/0\"]\n}\n\n\nresource \"aws_security_group\" \"elb\" {\n  name        = \"${var.cluster_name}-api-lb\"\n  description = \"kube-api firewall\"\n  vpc_id      = data.aws_vpc.selected.id\n\n  egress {\n    description      = \"allow all outgoing traffic\"\n    from_port        = 0\n    to_port          = 0\n    protocol         = \"-1\"\n    cidr_blocks      = [\"0.0.0.0/0\"]\n    ipv6_cidr_blocks = [\"::/0\"]\n  }\n\n  ingress {\n    description      = \"allow anyone to connect to tcp/6443\"\n    from_port        = 6443\n    to_port          = 6443\n    protocol         = \"tcp\"\n    cidr_blocks      = [\"0.0.0.0/0\"]\n    ipv6_cidr_blocks = [\"::/0\"]\n  }\n\n  tags = tomap({\n    \"Cluster\" = var.cluster_name,\n  })\n}\n\nresource \"aws_security_group\" \"ssh\" {\n  name        = \"${var.cluster_name}-ssh\"\n  description = \"ssh access\"\n  vpc_id      = data.aws_vpc.selected.id\n\n  ingress {\n    description      = \"allow incoming SSH\"\n    from_port        = var.ssh_port\n    to_port          = var.ssh_port\n    protocol         = \"tcp\"\n    cidr_blocks      = [\"0.0.0.0/0\"]\n    ipv6_cidr_blocks = [\"::/0\"]\n  }\n\n  tags = tomap({\n    \"Cluster\" = var.cluster_name,\n  })\n}\n\n################################## KUBE-API LB #################################\n\nresource \"aws_elb\" \"control_plane\" {\n  count = local.loadbalancer_count\n\n  name            = \"${var.cluster_name}-api-lb\"\n  internal        = var.internal_api_lb\n  subnets         = aws_subnet.public.*.id\n  security_groups = [aws_security_group.elb.id, aws_security_group.common.id]\n  instances       = aws_instance.control_plane.*.id\n  idle_timeout    = 600\n\n  listener {\n    instance_port     = 6443\n    instance_protocol = \"tcp\"\n    lb_port           = 6443\n    lb_protocol       = \"tcp\"\n  }\n\n  health_check {\n    healthy_threshold   = 2\n    unhealthy_threshold = 2\n    timeout             = 3\n    target              = \"HTTPS:6443/healthz\"\n    interval            = 30\n  }\n\n  tags = tomap({\n    \"Cluster\"                = var.cluster_name,\n    (local.kube_cluster_tag) = \"shared\",\n  })\n}\n\n#################################### SSH KEY ###################################\nresource \"aws_key_pair\" \"deployer\" {\n  key_name   = \"${var.cluster_name}-deployer-key\"\n  public_key = file(var.ssh_public_key_file)\n}\n\n##################################### IAM ######################################\nresource \"aws_iam_role\" \"role\" {\n  name = \"${var.cluster_name}-host\"\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\",\n    Statement = [\n      {\n        Effect = \"Allow\",\n        Principal = {\n          Service = \"ec2.amazonaws.com\"\n        },\n        Action = \"sts:AssumeRole\"\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_instance_profile\" \"profile\" {\n  name = \"${var.cluster_name}-host\"\n  role = aws_iam_role.role.name\n}\n\nresource \"aws_iam_role_policy\" \"policy\" {\n  name = \"${var.cluster_name}-host\"\n  role = aws_iam_role.role.id\n\n  policy = jsonencode({\n    Version = \"2012-10-17\",\n    Statement = [\n      {\n        Effect   = \"Allow\",\n        Action   = [\"ec2:*\"],\n        Resource = [\"*\"]\n      },\n      {\n        Effect   = \"Allow\",\n        Action   = [\"elasticloadbalancing:*\"],\n        Resource = [\"*\"]\n      }\n    ]\n  })\n}\n\n############################ CONTROL PLANE INSTANCES ###########################\n\nresource \"aws_instance\" \"control_plane\" {\n  count                  = var.control_plane_vm_count\n  instance_type          = var.control_plane_type\n  iam_instance_profile   = aws_iam_instance_profile.profile.name\n  ami                    = local.ami\n  key_name               = aws_key_pair.deployer.key_name\n  vpc_security_group_ids = [aws_security_group.common.id]\n  availability_zone      = data.aws_availability_zones.available.names[count.index]\n  subnet_id              = local.subnets[data.aws_availability_zones.available.names[count.index]]\n  ebs_optimized          = true\n\n  root_block_device {\n    volume_type = \"gp2\"\n    volume_size = var.control_plane_volume_size\n  }\n\n  tags = tomap({\n    \"Name\"                   = \"${var.cluster_name}-cp-${count.index + 1}\",\n    (local.kube_cluster_tag) = \"shared\",\n  })\n}\n\nresource \"aws_instance\" \"static_workers1\" {\n  count                  = var.static_workers_count\n  instance_type          = var.worker_type\n  iam_instance_profile   = aws_iam_instance_profile.profile.name\n  ami                    = local.ami\n  key_name               = aws_key_pair.deployer.key_name\n  vpc_security_group_ids = [aws_security_group.common.id]\n  availability_zone      = data.aws_availability_zones.available.names[count.index % length(data.aws_availability_zones.available.names)]\n  subnet_id              = local.subnets[data.aws_availability_zones.available.names[count.index % length(data.aws_availability_zones.available.names)]]\n  ebs_optimized          = true\n\n  root_block_device {\n    volume_type = \"gp2\"\n    volume_size = 50\n  }\n\n  tags = tomap({\n    \"Name\"                   = \"${var.cluster_name}-workers1-${count.index + 1}\",\n    (local.kube_cluster_tag) = \"shared\",\n  })\n}\n\n#################################### BASTION ###################################\n\nresource \"aws_instance\" \"bastion\" {\n  instance_type               = var.bastion_type\n  ami                         = local.ami\n  key_name                    = aws_key_pair.deployer.key_name\n  vpc_security_group_ids      = [aws_security_group.common.id, aws_security_group.ssh.id]\n  availability_zone           = data.aws_availability_zones.available.names[0]\n  subnet_id                   = local.subnets[local.zoneA]\n  associate_public_ip_address = true\n\n  root_block_device {\n    volume_type = \"gp2\"\n    volume_size = 100\n  }\n\n  tags = tomap({\n    \"Cluster\"                = var.cluster_name,\n    \"Name\"                   = \"${var.cluster_name}-bastion\",\n    (local.kube_cluster_tag) = \"shared\",\n  })\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_148", "severity": "HIGH", "message": "Ensure no default VPC is planned to be provisioned", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 81}, {"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 157}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 182}, {"tool": "checkov", "rule_id": "CKV_AWS_92", "severity": "HIGH", "message": "Ensure the ELB has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 231}, {"tool": "checkov", "rule_id": "CKV_AWS_127", "severity": "HIGH", "message": "Ensure that Elastic Load Balancer(s) uses SSL certificates provided by AWS Certificate Manager", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 231}, {"tool": "checkov", "rule_id": "CKV_AWS_376", "severity": "HIGH", "message": "Ensure AWS Elastic Load Balancer listener uses TLS/SSL", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 231}, {"tool": "checkov", "rule_id": "CKV_AWS_287", "severity": "HIGH", "message": "Ensure IAM policies does not allow credentials exposure", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 291}, {"tool": "checkov", "rule_id": "CKV_AWS_289", "severity": "HIGH", "message": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 291}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 291}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 291}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 314}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 314}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 336}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 336}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 360}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 360}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 360}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 360}, {"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 106}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__main.tf", "start_line": 360}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"project_id\" {\n  description = \"The Google Cloud project ID to deploy to.\"\n  type        = string\n}\n\nvariable \"region\" {\n  description = \"The Google Cloud region to deploy to.\"\n  type        = string\n  default     = \"us-central1\"\n}\n\nvariable \"service_name\" {\n  description = \"The name of the Cloud Run service.\"\n  type        = string\n  default     = \"promptlandia\"\n}\n\nvariable \"model_id\" {\n  description = \"The ID of the Gemini model to use.\"\n  type        = string\n  default     = \"gemini-2.5-flash\"\n}\n\nvariable \"iap_members\" {\n  description = \"A list of members to grant IAP-secured Web App User role.\"\n  type        = list(string)\n  default     = [] # e.g., [\"group:cloud-aaie@google.com\"]\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__vertex-ai-creative-studio__experiments__promptlandia__terraform__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#------------------------------------------------------------------\n#  Terraform - From Zero to Certified Professional\n#\n# Generate, Store and Retrieve Password Using SSM Parameter Store\n#\n# Made by Denis Astahov\n#------------------------------------------------------------------\nprovider \"aws\" {\n  region = \"ca-central-1\"\n}\n\nresource \"aws_db_instance\" \"prod\" {\n  identifier           = \"prod-mysql-rds\"\n  allocated_storage    = 20\n  storage_type         = \"gp2\"\n  engine               = \"mysql\"\n  engine_version       = \"5.7\"\n  instance_class       = \"db.t3.micro\"\n  parameter_group_name = \"default.mysql5.7\"\n  skip_final_snapshot  = true\n  apply_immediately    = true\n  username             = \"administrator\"\n  password             = data.aws_ssm_parameter.rds_password.value\n}\n\n// Generate Password\nresource \"random_password\" \"main\" {\n  length           = 20\n  special          = true #   Default: !@#$%&*()-_=+[]{}<>:?\n  override_special = \"#!()_\"\n}\n\n// Store Password\nresource \"aws_ssm_parameter\" \"rds_password\" {\n  name        = \"/prod/prod-mysql-rds/password\"\n  description = \"Master Password for RDS Database\"\n  type        = \"SecureString\"\n  value       = random_password.main.result\n}\n\n// Retrieve Password\ndata \"aws_ssm_parameter\" \"rds_password\" {\n  name       = \"/prod/prod-mysql-rds/password\"\n  depends_on = [aws_ssm_parameter.rds_password]\n}\n\n\n#-------\noutput \"rds_address\" {\n  value = aws_db_instance.prod.address\n}\n\noutput \"rds_port\" {\n  value = aws_db_instance.prod.port\n}\n\noutput \"rds_username\" {\n  value = aws_db_instance.prod.username\n}\n\noutput \"rds_password\" {\n  value     = data.aws_ssm_parameter.rds_password.value\n  sensitive = true\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-09__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_129", "severity": "HIGH", "message": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-09__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_226", "severity": "HIGH", "message": "Ensure DB instance gets all minor upgrades automatically", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-09__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_16", "severity": "HIGH", "message": "Ensure all data stored in the RDS is securely encrypted at rest", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-09__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_118", "severity": "HIGH", "message": "Ensure that enhanced monitoring is enabled for Amazon RDS instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-09__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_161", "severity": "HIGH", "message": "Ensure RDS database has IAM authentication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-09__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_293", "severity": "HIGH", "message": "Ensure that AWS database instances have deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-09__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_157", "severity": "HIGH", "message": "Ensure that RDS instances have Multi-AZ enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-09__main.tf", "start_line": 12}, {"tool": "checkov", "rule_id": "CKV_AWS_337", "severity": "HIGH", "message": "Ensure SSM parameters are using KMS CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-09__main.tf", "start_line": 34}, {"tool": "checkov", "rule_id": "CKV2_AWS_60", "severity": "CRITICAL", "message": "Ensure RDS instance with copy tags to snapshots is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform_certified__Lab-09__main.tf", "start_line": 12}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\n# The following variable is used to configure the provider's authentication\n# token. You don't need to provide a token on the command line to apply changes,\n# though: using the remote backend, Terraform will execute remotely in HCP Terraform\n# where your token is already securely stored in your workspace!\n\nvariable \"provider_token\" {\n  type      = string\n  sensitive = true\n}\n\nprovider \"fakewebservices\" {\n  token = var.provider_token\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__tfc-getting-started__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n    region = \"us-east-1\"\n}\n\nterraform {\n    required_providers {\n        aws = {\n            version = \"3.47.0\"\n        }\n    }\n}\n\nresource \"aws_default_vpc\" \"default\" {}\n\nresource \"aws_network_acl\" \"test\" {\n    vpc_id = aws_default_vpc.default.id\n    tags = {\n        Name = \"test\"\n    }\n}\n\nresource \"aws_network_acl_rule\" \"ingress\" {\n    network_acl_id = aws_network_acl.test.id\n    protocol       = \"tcp\"\n    rule_action    = \"allow\"\n    rule_number    = 100\n    from_port = 80\n    to_port = 80\n    cidr_block = aws_default_vpc.default.cidr_block\n}\n\nresource \"aws_network_acl_rule\" \"ingress_ipv6\" {\n    network_acl_id = aws_network_acl.test.id\n    protocol       = \"tcp\"\n    rule_action    = \"allow\"\n    rule_number    = 200\n    from_port = 80\n    to_port = 80\n    ipv6_cidr_block = \"::/0\"\n}\n\nresource \"aws_network_acl_rule\" \"egress\" {\n    network_acl_id = aws_network_acl.test.id\n    egress = true\n    protocol       = \"udp\"\n    rule_action    = \"allow\"\n    rule_number    = 100\n    from_port = 80\n    to_port = 80\n    cidr_block = aws_default_vpc.default.cidr_block\n}\n\nresource \"aws_network_acl\" \"test2\" {\n    vpc_id = aws_default_vpc.default.id\n\n    egress = [\n        {\n            protocol   = \"udp\"\n            rule_no    = 100\n            action     = \"allow\"\n            cidr_block = aws_default_vpc.default.cidr_block\n            from_port  = 80\n            to_port    = 80\n            icmp_code = 0\n            icmp_type = 0\n            ipv6_cidr_block = \"\"\n        }\n    ]\n\n\n    ingress = [\n        {\n            protocol   = \"udp\"\n            rule_no    = 100\n            action     = \"allow\"\n            cidr_block = aws_default_vpc.default.cidr_block\n            from_port  = 80\n            to_port    = 80\n            icmp_code = 0\n            icmp_type = 0\n            ipv6_cidr_block = \"\"\n        }\n    ]\n\n    tags = {\n        Name = \"test2\"\n    }\n}\n\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_ec2_network_acl_rule__terraform.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_148", "severity": "HIGH", "message": "Ensure no default VPC is planned to be provisioned", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_ec2_network_acl_rule__terraform.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_1", "severity": "CRITICAL", "message": "Ensure that all NACL are attached to subnets", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_ec2_network_acl_rule__terraform.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AWS_1", "severity": "CRITICAL", "message": "Ensure that all NACL are attached to subnets", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_ec2_network_acl_rule__terraform.tf", "start_line": 53}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_ami\" \"ubuntu\" {\n  most_recent = true\n\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  owners = [\"099720109477\"] # Canonical\n}\n\nresource \"aws_instance\" \"vpn\" {\n  ami             = data.aws_ami.ubuntu.id\n  instance_type   = \"t2.micro\"\n  key_name        = var.key_name\n  security_groups = [\"${var.security_groups}\"]\n  tags = {\n    Name = \"terraguardVPN\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__AWS__modules__ec2__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__AWS__modules__ec2__main.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__AWS__modules__ec2__main.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__AWS__modules__ec2__main.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__AWS__modules__ec2__main.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/P0ssuidao__terraguard__AWS__modules__ec2__main.tf", "start_line": 17}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"gke_zero_node_pool\" {\n  source = \"../google/cluster/node-pool\"\n\n  cluster_metadata = module.gke_zero.current_metadata\n\n  configuration = {\n    # Settings for Apps-cluster\n    apps = {\n      project_id = \"terraform-kubestack-testing\"\n\n      name = \"test1\"\n\n      machine_type   = \"e2-medium\"\n      min_node_count = 1\n      max_node_count = 1\n\n      location       = module.gke_zero.current_config[\"region\"]\n      node_locations = [\"europe-west1-c\", \"europe-west1-d\"]\n\n      taints = [\n        {\n          effect = \"NO_SCHEDULE\"\n          key    = \"nvidia.com/gpu\"\n          value  = \"present\"\n        },\n      ]\n    }\n\n    # Settings for Ops-cluster\n    ops = {}\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kbst__terraform-kubestack__tests__gke_zero_node_pools.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# CREATE AN S3 BUCKET AND DYNAMODB TABLE TO USE AS A TERRAFORM BACKEND\n# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n# ----------------------------------------------------------------------------------------------------------------------\n# REQUIRE A SPECIFIC TERRAFORM VERSION OR HIGHER\n# This module has been updated with 0.12 syntax, which means it is no longer compatible with any versions below 0.12.\n# This module is forked from https://github.com/gruntwork-io/intro-to-terraform/tree/master/s3-backend\n# ----------------------------------------------------------------------------------------------------------------------\n\nterraform {\n  required_version = \">= 0.12\"\n}\n\n# ------------------------------------------------------------------------------\n# CONFIGURE OUR AWS CONNECTION\n# ------------------------------------------------------------------------------\n\nprovider \"aws\" {}\n\n# ------------------------------------------------------------------------------\n# CREATE THE S3 BUCKET\n# ------------------------------------------------------------------------------\n\ndata \"aws_caller_identity\" \"current\" {}\n\nlocals {\n  account_id = data.aws_caller_identity.current.account_id\n}\n\nresource \"aws_s3_bucket\" \"terraform_state\" {\n  # With account id, this S3 bucket names can be *globally* unique.\n  bucket = \"${local.account_id}-terraform-states\"\n\n  # Enable versioning so we can see the full revision history of our\n  # state files\n  versioning {\n    enabled = true\n  }\n\n  # Enable server-side encryption by default\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        sse_algorithm = \"AES256\"\n      }\n    }\n  }\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"terraform_state\" {\n  bucket = aws_s3_bucket.terraform_state.id\n\n  block_public_acls       = true\n  block_public_policy     = true\n  ignore_public_acls      = true\n  restrict_public_buckets = true\n}\n\n# ------------------------------------------------------------------------------\n# CREATE THE DYNAMODB TABLE\n# ------------------------------------------------------------------------------\n\nresource \"aws_dynamodb_table\" \"terraform_lock\" {\n  name         = \"terraform-lock\"\n  billing_mode = \"PAY_PER_REQUEST\"\n  hash_key     = \"LockID\"\n\n  attribute {\n    name = \"LockID\"\n    type = \"S\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__s3-backend__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_28", "severity": "HIGH", "message": "Ensure DynamoDB point in time recovery (backup) is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__s3-backend__main.tf", "start_line": 64}, {"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__s3-backend__main.tf", "start_line": 64}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__s3-backend__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__s3-backend__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__s3-backend__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__s3-backend__main.tf", "start_line": 31}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ozbillwang__terraform-best-practices__s3-backend__main.tf", "start_line": 31}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Define the AWS provider configuration.\nprovider \"aws\" {\n  region = \"us-east-1\"  # Replace with your desired AWS region.\n}\n\nvariable \"cidr\" {\n  default = \"10.0.0.0/16\"\n}\n\nresource \"aws_key_pair\" \"example\" {\n  key_name   = \"terraform-demo-abhi\"  # Replace with your desired key name\n  public_key = file(\"~/.ssh/id_rsa.pub\")  # Replace with the path to your public key file\n}\n\nresource \"aws_vpc\" \"myvpc\" {\n  cidr_block = var.cidr\n}\n\nresource \"aws_subnet\" \"sub1\" {\n  vpc_id                  = aws_vpc.myvpc.id\n  cidr_block              = \"10.0.0.0/24\"\n  availability_zone       = \"us-east-1a\"\n  map_public_ip_on_launch = true\n}\n\nresource \"aws_internet_gateway\" \"igw\" {\n  vpc_id = aws_vpc.myvpc.id\n}\n\nresource \"aws_route_table\" \"RT\" {\n  vpc_id = aws_vpc.myvpc.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.igw.id\n  }\n}\n\nresource \"aws_route_table_association\" \"rta1\" {\n  subnet_id      = aws_subnet.sub1.id\n  route_table_id = aws_route_table.RT.id\n}\n\nresource \"aws_security_group\" \"webSg\" {\n  name   = \"web\"\n  vpc_id = aws_vpc.myvpc.id\n\n  ingress {\n    description = \"HTTP from VPC\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  ingress {\n    description = \"SSH\"\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"Web-sg\"\n  }\n}\n\nresource \"aws_instance\" \"server\" {\n  ami                    = \"ami-0261755bbcb8c4a84\"\n  instance_type          = \"t2.micro\"\n  key_name      = aws_key_pair.example.key_name\n  vpc_security_group_ids = [aws_security_group.webSg.id]\n  subnet_id              = aws_subnet.sub1.id\n\n  connection {\n    type        = \"ssh\"\n    user        = \"ubuntu\"  # Replace with the appropriate username for your EC2 instance\n    private_key = file(\"~/.ssh/id_rsa\")  # Replace with the path to your private key\n    host        = self.public_ip\n  }\n\n  # File provisioner to copy a file from local to the remote EC2 instance\n  provisioner \"file\" {\n    source      = \"app.py\"  # Replace with the path to your local file\n    destination = \"/home/ubuntu/app.py\"  # Replace with the path on the remote instance\n  }\n\n  provisioner \"remote-exec\" {\n    inline = [\n      \"echo 'Hello from the remote instance'\",\n      \"sudo apt update -y\",  # Update package lists (for ubuntu)\n      \"sudo apt-get install -y python3-pip\",  # Example package installation\n      \"cd /home/ubuntu\",\n      \"sudo pip3 install flask\",\n      \"sudo python3 app.py &\",\n    ]\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 44}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 75}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-5__main.tf", "start_line": 15}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\n# Input variable definitions\n\nvariable \"name\" {\n  description = \"Name\"\n  type        = string\n  default     = \"example-vpc\"\n}\n\nvariable \"ip_address\" {\n  description = \"IP address\"\n  type        = string\n  default     = \"127.0.0.1\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-cdk__examples__java__documentation-gradle__local_module__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.0\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"= 5.100.0\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__core-infra-external-state__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"3.58.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  profile = \"default\"\n  region  = \"us-east-1\"\n}\n\nresource \"aws_s3_bucket\" \"bucket\" {\n  bucket = \"43802482094298-depends-on\"\n}\n\nresource \"aws_instance\" \"my_server\" {\n  ami           = \"ami-087c17d1fe0178315\"\n  instance_type = \"t2.micro\"\n\tdepends_on = [\n\t\taws_s3_bucket.bucket\n\t]\n}\n\noutput \"public_ip\" {\n  value = aws_instance.my_server.public_ip\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 19}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ExamProCo__Terraform-Associate-Labs__050_resource-meta-arguements-depends-on__main.tf", "start_line": 15}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n### VPC\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"2.7.0\"\n\n  name = \"${var.cluster-name}-eks-vpc\"\n\n  cidr = var.vpc-subnet-cidr\n\n  azs              = var.availability-zones\n  private_subnets  = var.private-subnet-cidr\n  public_subnets   = var.public-subnet-cidr\n  database_subnets = var.db-subnet-cidr\n\n  create_database_subnet_group = true\n\n  enable_dns_hostnames = true\n  enable_dns_support   = true\n\n  enable_nat_gateway = true\n\n  tags = {\n    Name                                        = \"${var.cluster-name}-vpc\"\n    \"kubernetes.io/cluster/${var.cluster-name}\" = \"shared\"\n  }\n\n  public_subnet_tags = {\n    Name                                        = \"${var.cluster-name}-eks-public\"\n    \"kubernetes.io/cluster/${var.cluster-name}\" = \"shared\"\n    \"kubernetes.io/role/elb\"                    = 1\n  }\n  private_subnet_tags = {\n    Name                                        = \"${var.cluster-name}-eks-private\"\n    \"kubernetes.io/cluster/${var.cluster-name}\" = \"shared\"\n    \"kubernetes.io/role/internal-elb\"           = 1\n  }\n  database_subnet_tags = {\n    Name = \"${var.cluster-name}-eks-db\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/WesleyCharlesBlake__terraform-aws-eks__network.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/WesleyCharlesBlake__terraform-aws-eks__network.tf", "start_line": 3}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"server_count\" {\n  description = \"The number of servers and IPs to provision\"\n  type        = number\n  default     = 3\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/scaleway__terraform-provider-scaleway__examples__instance-servers__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Telemetry is collected by creating an empty ARM deployment with a specific name\n# If you want to disable telemetry, you can set the disable_telemetry variable to true\n\n# This file contains telemetry for the identity module\n\n# The following locals are used to create the bitfield data, dependent on the module configuration\nlocals {\n  # Bitfield bit 1 (LSB): Is log analytics enabled?\n  telem_identity_configure_identity_policies = local.configure_identity_resources.settings.identity.enabled ? 1 : 0\n}\n\n# The following locals calculate the telemetry bit field by summiung the above locals and then representing as hexadecimal\n# Hex number is represented as four digits wide and is zero padded\nlocals {\n  telem_identity_bitfield_denery = (\n    local.telem_identity_configure_identity_policies\n  )\n  telem_identity_bitfield_hex = format(\"%04x\", local.telem_identity_bitfield_denery)\n}\n\n# This construicts the ARM deployment name that is used for the telemetry.\n# We shouldn't ever hit the 64 character limit but use substr just in case\nlocals {\n  telem_identity_arm_deployment_name = substr(\n    format(\n      \"pid-%s_%s_%s_%s\",\n      local.telem_identity_puid,\n      local.module_version,\n      local.telem_identity_bitfield_hex,\n      local.telem_random_hex,\n    ),\n    0,\n    64\n  )\n}\n\n# Condition to determine whether we create the management telemetry deployment\n# Disabled until identity resources are added to the module\nlocals {\n  telem_identity_deployment_enabled = false # !local.disable_telemetry && local.deploy_identity_resources\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform-azurerm-caf-enterprise-scale__locals.telemetry.identity.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_dynamodb_table\" \"tooling_language_groups\" {\n  name           = \"tooling_language_groups\"\n  read_capacity  = 1\n  write_capacity = 1\n  hash_key       = \"group\"\n\n  attribute {\n    name = \"group\"\n    type = \"S\"\n  }\n}\n\nresource \"aws_dynamodb_table_item\" \"tooling_language_tr_all\" {\n  table_name = aws_dynamodb_table.tooling_language_groups.name\n  hash_key   = aws_dynamodb_table.tooling_language_groups.hash_key\n\n  item = <<ITEM\n{\n  \"group\": {\"S\": \"test-runners-all\"},\n  \"languages\": {\"S\": \"8th,abap,arm64-assembly,arturo,awk,ballerina,bash,batch,c,cairo,cfml,chapel,clojure,clojurescript,cobol,coffeescript,common-lisp,cpp,crystal,csharp,d,dart,elixir,elm,emacs-lisp,erlang,euphoria,fortran,fsharp,futhark,gdscript,gleam,go,groovy,haskell,haxe,idris,j,java,javascript,jq,julia,kotlin,lfe,lua,mips,nim,ocaml,perl5,pharo-smalltalk,phix,php,pony,powershell,prolog,purescript,pyret,python,r,racket,raku,reasonml,red,roc,ruby,rust,scala,scheme,sml,sqlite,swift,tcl,typescript,uiua,unison,vbnet,vimscript,vlang,wasm,wren,x86-64-assembly,yamlscript,zig\"}\n}\nITEM\n}\n\nresource \"aws_dynamodb_table_item\" \"tooling_language_r_all\" {\n  table_name = aws_dynamodb_table.tooling_language_groups.name\n  hash_key   = aws_dynamodb_table.tooling_language_groups.hash_key\n\n  item = <<ITEM\n{\n  \"group\": {\"S\": \"representers-all\"},\n  \"languages\": {\"S\": \"c,clojure,common-lisp,cpp,crystal,csharp,elixir,elm,fsharp,go,j,java,javascript,php,python,raku,ruby,rust,typescript,wasm,wren\"}\n}\nITEM\n}\n\nresource \"aws_dynamodb_table_item\" \"tooling_language_a_all\" {\n  table_name = aws_dynamodb_table.tooling_language_groups.name\n  hash_key   = aws_dynamodb_table.tooling_language_groups.hash_key\n\n  item = <<ITEM\n{\n  \"group\": {\"S\": \"analyzers-all\"},\n  \"languages\": {\"S\": \"bash,clojure,common-lisp,crystal,csharp,elixir,elm,erlang,go,java,javascript,nim,perl5,python,ruby,rust,scala,typescript,uiua\"}\n}\nITEM\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__terraform__dynamodb_tooling_language_groups.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_28", "severity": "HIGH", "message": "Ensure DynamoDB point in time recovery (backup) is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__terraform__dynamodb_tooling_language_groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_119", "severity": "HIGH", "message": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__terraform__dynamodb_tooling_language_groups.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_16", "severity": "CRITICAL", "message": "Ensure that Auto Scaling is enabled on your DynamoDB tables", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__terraform__dynamodb_tooling_language_groups.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#  terraform {\n#    backend \"s3\" {\n#     bucket = \"avinash-terraform-state\"\n#     key    = \"state.tfstate\"\n#     region = \"us-west-2\"\n#     profile = \"jespo\"\n# dynamodb_table= \"firstprojecttable\"\n#    }\n#  }\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/avinashmamidi__terraform__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# local.tf\nresource \"local_file\" \"pet\" {\n  for_each = var.files\n  content  = \"We love pets!\"\n  filename = each.value\n}\n\n# variables.tf\nvariable \"files\" {\n  default = {\n    pets = \"./pets.txt\"\n    dogs = \"./dogs.txt\"\n    cats = \"./cats.txt\"\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Pradumnasaraf__DevOps__docs__terraform__files__test__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"do_token\" {}\nvariable \"aws_access_key\" {}\nvariable \"aws_secret_key\" {}\nvariable \"aws_subnet_id\" {}\n\nprovider \"aws\" {\n    access_key = \"${var.aws_access_key}\"\n    secret_key = \"${var.aws_secret_key}\"\n    region = \"us-east-1\"\n}\n\nprovider \"digitalocean\" {\n  token = \"${var.do_token}\"\n}\n\nresource \"aws_instance\" \"alpha\" {\n  ami = \"ami-96a818fe\"\n  instance_type = \"t2.micro\"\n  subnet_id = \"${var.aws_subnet_id}\"\n  associate_public_ip_address = true\n  key_name = \"terraform-inventory\"\n  count = 2\n\n  root_block_device = {\n    delete_on_termination = true\n  }\n\n  tags = {\n    Role = \"Web\"\n  }\n}\n\nresource \"aws_instance\" \"beta\" {\n  ami = \"ami-96a818fe\"\n  instance_type = \"t2.micro\"\n  subnet_id = \"${var.aws_subnet_id}\"\n  associate_public_ip_address = true\n  key_name = \"terraform-inventory\"\n\n  root_block_device = {\n    delete_on_termination = true\n  }\n\n  tags = {\n    Role = \"Worker\"\n  }\n}\n\nresource \"digitalocean_droplet\" \"gamma\" {\n  image = \"centos-7-0-x64\"\n  name = \"terraform-inventory-1\"\n  region = \"nyc1\"\n  size = \"512mb\"\n  ssh_keys = [862272]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 33}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 33}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 33}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 33}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 33}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adammck__terraform-inventory__fixtures__example.tf", "start_line": 16}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"name\" {\n}\n\nvariable \"environment\" {\n}\n\nvariable \"account_id\" {\n}\n\nvariable \"logs_expiration_enabled\" {\n  default = false\n}\n\nvariable \"logs_expiration_days\" {\n  default = 30\n}\n\ndata \"template_file\" \"policy\" {\n  template = \"${file(\"${path.module}/policy.json\")}\"\n\n  vars = {\n    bucket     = \"${var.name}-${var.environment}-logs\"\n    account_id = \"${var.account_id}\"\n  }\n}\n\nresource \"aws_s3_bucket\" \"logs\" {\n  bucket = \"${var.name}-${var.environment}-logs\"\n\n  lifecycle_rule {\n    id = \"logs-expiration\"\n    prefix = \"\"\n    enabled = \"${var.logs_expiration_enabled}\"\n\n    expiration {\n      days = \"${var.logs_expiration_days}\"\n    }\n  }\n\n  tags {\n    Name        = \"${var.name}-${var.environment}-logs\"\n    Environment = \"${var.environment}\"\n  }\n\n  policy = \"${data.template_file.policy.rendered}\"\n}\n\noutput \"id\" {\n  value = \"${aws_s3_bucket.logs.id}\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__s3-logs__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__s3-logs__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__s3-logs__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__s3-logs__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__s3-logs__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__s3-logs__main.tf", "start_line": 27}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/segmentio__stack__s3-logs__main.tf", "start_line": 27}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"ssh_sensitive_resource\" \"kubeconfig\" {\n  # Note: moved from remote_file to ssh_sensitive_resource because\n  # remote_file does not support bastion hosts and ssh_sensitive_resource does.\n  # The default behaviour is to run file blocks and commands at create time\n  # You can also specify 'destroy' to run the commands at destroy time\n  when = \"create\"\n\n  bastion_host        = local.ssh_bastion.bastion_host\n  bastion_port        = local.ssh_bastion.bastion_port\n  bastion_user        = local.ssh_bastion.bastion_user\n  bastion_private_key = local.ssh_bastion.bastion_private_key\n\n  host        = can(ipv6(local.first_control_plane_ip)) ? \"[${local.first_control_plane_ip}]\" : local.first_control_plane_ip\n  port        = var.ssh_port\n  user        = \"root\"\n  private_key = var.ssh_private_key\n  agent       = var.ssh_private_key == null\n\n  # An ssh-agent with your SSH private keys should be running\n  # Use 'private_key' to set the SSH key otherwise\n\n  timeout = \"15m\"\n\n  commands = [\n    \"cat /etc/rancher/k3s/k3s.yaml\"\n  ]\n\n  depends_on = [null_resource.control_planes[0]]\n}\n\nlocals {\n  kubeconfig_server_address = var.kubeconfig_server_address != \"\" ? var.kubeconfig_server_address : (var.use_control_plane_lb ?\n    (\n      var.control_plane_lb_enable_public_interface ?\n      hcloud_load_balancer.control_plane.*.ipv4[0]\n      : hcloud_load_balancer_network.control_plane.*.ip[0]\n    )\n    :\n    (can(local.first_control_plane_ip) ? local.first_control_plane_ip : \"unknown\")\n  )\n  kubeconfig_external = replace(replace(ssh_sensitive_resource.kubeconfig.result, \"127.0.0.1\", local.kubeconfig_server_address), \"default\", var.cluster_name)\n  kubeconfig_parsed   = yamldecode(local.kubeconfig_external)\n  kubeconfig_data = {\n    host                   = local.kubeconfig_parsed[\"clusters\"][0][\"cluster\"][\"server\"]\n    client_certificate     = base64decode(local.kubeconfig_parsed[\"users\"][0][\"user\"][\"client-certificate-data\"])\n    client_key             = base64decode(local.kubeconfig_parsed[\"users\"][0][\"user\"][\"client-key-data\"])\n    cluster_ca_certificate = base64decode(local.kubeconfig_parsed[\"clusters\"][0][\"cluster\"][\"certificate-authority-data\"])\n    cluster_name           = var.cluster_name\n  }\n}\n\nresource \"local_sensitive_file\" \"kubeconfig\" {\n  count           = var.create_kubeconfig ? 1 : 0\n  content         = local.kubeconfig_external\n  filename        = \"${var.cluster_name}_kubeconfig.yaml\"\n  file_permission = \"600\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mysticaltech__terraform-hcloud-kube-hetzner__kubeconfig.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"instances_public_ips\" {\n  description = \"Public IPs assigned to the EC2 instance\"\n  value       = module.ec2.public_ip\n}\n\noutput \"ebs_volume_attachment_id\" {\n  description = \"The volume ID\"\n  value       = aws_volume_attachment.this_ec2.*.volume_id\n}\n\noutput \"ebs_volume_attachment_instance_id\" {\n  description = \"The instance ID\"\n  value       = aws_volume_attachment.this_ec2.*.instance_id\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kserge2001__terraform__examples__volume-attachment__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// Simple Linux VM deployment\nmodule \"example-server-linuxvm\" {\n  source        = \"Terraform-VMWare-Modules/vm/vsphere\"\n  version       = \"Latest X.X.X\"\n  vmtemp        = \"TemplateName\"\n  instances     = 1\n  vmname        = \"example-server-windows\"\n  vmrp          = \"esxi/Resources\"\n  network = {\n    \"Network01\" = [\"10.13.113.2\", \"10.13.113.3\"] # To use DHCP create Empty list [\"\",\"\"]\n    \"Network02\" = [\"\", \"\"]                       #Second Network will use the DHCP\n  }\n  dc        = \"Datacenter\"\n  datastore = \"Data Store name(use datastore_cluster for datastore cluster)\"\n}\n// Example of Linux VM with more Advanced Features\nmodule \"example-server-linuxvm-advanced\" {\n  source                 = \"Terraform-VMWare-Modules/vm/vsphere\"\n  vm_depends_on          = [module.example-server-linuxvm] # This force the second module to wait for first VM to be created first\n  version                = \"Latest X.X.X\"\n  dc                     = \"Datacenter\"\n  vmrp                   = \"cluster/Resources\"\n  vmfolder               = \"Cattle\"\n  datastore_cluster      = \"Datastore Cluster\"\n  vmtemp                 = \"TemplateName\"\n  instances              = 2\n  cpu_number             = 2\n  ram_size               = 2096\n  cpu_hot_add_enabled    = true\n  cpu_hot_remove_enabled = true\n  memory_hot_add_enabled = true\n  vmname                 = \"AdvancedVM\"\n  domain               = \"somedomain.com\"\n  ipv4submask            = [\"24\", \"8\"]\n  network = {\n    \"Network01\" = [\"10.13.113.2\", \"10.13.113.3\"] # To use DHCP create Empty list [\"\",\"\"]\n    \"Network02\" = [\"\", \"\"]                       #Second Network will use the DHCP\n  }\n  dns_server_list           = [\"192.168.0.2\", \"192.168.0.1\"]\n  vmgateway                 = \"192.168.0.1\"\n  network_type              = [\"vmxnet3\", \"vmxnet3\"]\n  tags = {\n    \"terraform-test-category\"    = \"terraform-test-tag\"\n    \"terraform-test-category-02\" = \"terraform-test-tag-02\"\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Terraform-VMWare-Modules__terraform-vsphere-vm__examples__example-linux-depend_on.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Terraform-VMWare-Modules__terraform-vsphere-vm__examples__example-linux-depend_on.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Terraform-VMWare-Modules__terraform-vsphere-vm__examples__example-linux-depend_on.tf", "start_line": 17}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\noutput \"role_id\" {\n  value       = module.custom-roles-org.custom_role_id\n  description = \"ID of the custom role created at organization level.\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-iam__examples__custom_role_org__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2025 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n# tfdoc:file:description NGFW Enteprise resources.\n\nlocals {\n  ngfw_associations = flatten([\n    for k, v in var.ngfw_config.network_associations : [\n      for z in coalesce(v.zones, var.ngfw_config.endpoint_zones) : merge(v, {\n        key      = \"${z}-${k}\"\n        location = z\n        vpc_id   = lookup(var.vpc_self_links, v.vpc_id, v.vpc_id)\n      })\n    ]\n  ])\n  tls_inspection_policies = {\n    for k, v in google_network_security_tls_inspection_policy.default :\n    k => v.id\n  }\n}\n\nresource \"google_network_security_firewall_endpoint\" \"default\" {\n  for_each           = toset(var.ngfw_config.endpoint_zones)\n  name               = var.ngfw_config.name\n  parent             = \"organizations/${var.organization.id}\"\n  location           = each.key\n  billing_project_id = local.project_id\n}\n\nresource \"google_network_security_firewall_endpoint_association\" \"default\" {\n  for_each = { for k in local.ngfw_associations : k.key => k }\n  name     = \"${var.ngfw_config.name}-${each.value.key}\"\n  parent   = \"projects/${regex(\"projects/([^/]+)/\", each.value.vpc_id)[0]}\"\n  location = each.value.location\n  network  = each.value.vpc_id\n  firewall_endpoint = (\n    google_network_security_firewall_endpoint.default[each.value.location].id\n  )\n  # If TLS inspection is enabled, link the regional TLS inspection policy\n  tls_inspection_policy = try(\n    local.tls_inspection_policies[each.value.tls_inspection_policy], null\n  )\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__cloud-foundation-fabric__fast__addons__2-networking-ngfw__ngfw.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    coder = {\n      source  = \"coder/coder\"\n      version = \"2.5.3\"\n    }\n  }\n}\n\nmodule \"jetbrains_gateway\" {\n  source = \"jetbrains_gateway\"\n}\n\ndata \"coder_parameter\" \"region\" {\n  name         = \"region\"\n  display_name = \"Where would you like to travel to next?\"\n  type         = \"string\"\n  form_type    = \"dropdown\"\n  mutable      = true\n  default      = \"na\"\n  order        = 1000\n\n  option {\n    name  = \"North America\"\n    value = \"na\"\n  }\n\n  option {\n    name  = \"South America\"\n    value = \"sa\"\n  }\n\n  option {\n    name  = \"Europe\"\n    value = \"eu\"\n  }\n\n  option {\n    name  = \"Africa\"\n    value = \"af\"\n  }\n\n  option {\n    name  = \"Asia\"\n    value = \"as\"\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/coder__coder__coderd__testdata__parameters__modules__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  access_key = \"${var.aws_access_key}\"\n  secret_key = \"${var.aws_secret_key}\"\n  region     = \"${var.region}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Capgemini__terraform-amazon-ecs__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"3.9.0\"\n    }\n  }\n}\n\nprovider \"azurerm\" {\n  features {}\n}\n\nmodule \"storage1\" {\n  source               = \"./modules/storage\"\n  resource_group_name  = \"rg12345\"\n  location             = \"northeurope\"\n  storage_account_name = \"azcdmdn12345\"\n  lock                 = true\n}\n\nmodule \"storage2\" {\n  source               = \"./modules/storage\"\n  resource_group       = false\n  resource_group_name  = module.storage1.resource_group_name\n  location             = \"westeurope\"\n  storage_account_name = \"azcdmdn67890\"\n  identity             = true\n}\n\noutput \"storage_account_id_1\" {\n  value = module.storage1.storage_account_id\n}\n\noutput \"storage_account_id_2\" {\n  value = module.storage2.storage_account_id\n}\n\noutput \"identity_2\" {\n  value = module.storage2.identity\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/neumanndaniel__terraform__conditions-for-each-demo__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"service\" {\n  description = \"The service to create alerts for\"\n  type = object({\n    name                       = string\n    threshold_duration         = number\n    cpu_threshold              = number\n    response_time_threshold    = number\n    error_percentage_threshold = number\n    throughput_threshold       = number\n  })\n}\n\nvariable \"notification_channel_ids\" {\n  description = \"The IDs of notification channels to add to this policy\"\n  type        = list(string)\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/newrelic__terraform-provider-newrelic__examples__modules__golden-signal-alerts-new__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"s3\" {\n    bucket         = \"my-ews-baket1\"\n    region         = \"us-east-1\"\n    key            = \"Modularized/EC2-Instance/terraform.tfstate\"\n    dynamodb_table = \"Lock-Files\"\n    encrypt        = true\n  }\n  required_version = \">=0.13.0\"\n  required_providers {\n    aws = {\n      version = \">= 2.7.0\"\n      source  = \"hashicorp/aws\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__Terraform-for-AWS__Modularized__Terraform-Modularized__EC2-Instance__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/*\nCopyright 2019 The KubeOne Authors.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\nvariable \"cluster_name\" {\n  description = \"Name of the cluster\"\n  type        = string\n\n  validation {\n    condition     = can(regex(\"^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$\", var.cluster_name))\n    error_message = \"Value of cluster_name should be lowercase and can only contain alphanumeric characters and hyphens(-).\"\n  }\n}\n\nvariable \"apiserver_alternative_names\" {\n  description = \"subject alternative names for the API Server signing cert.\"\n  default     = []\n  type        = list(string)\n}\n\nvariable \"worker_os\" {\n  description = \"OS to run on worker machines, default to var.os\"\n\n  # valid choices are:\n  # * ubuntu\n  # * centos\n  # * flatcar\n  # * rhel\n  # * rockylinux\n  default = \"\"\n  type    = string\n}\n\nvariable \"ssh_public_key_file\" {\n  description = \"SSH public key file\"\n  default     = \"~/.ssh/id_rsa.pub\"\n  type        = string\n}\n\nvariable \"ssh_port\" {\n  description = \"SSH port to be used to provision instances\"\n  default     = 22\n  type        = number\n}\n\nvariable \"ssh_username\" {\n  description = \"SSH user, used only in output\"\n  default     = \"\"\n  type        = string\n}\n\nvariable \"ssh_private_key_file\" {\n  description = \"SSH private key file used to access instances\"\n  default     = \"\"\n  type        = string\n}\n\nvariable \"ssh_agent_socket\" {\n  description = \"SSH Agent socket, default to grab from $SSH_AUTH_SOCK\"\n  default     = \"env:SSH_AUTH_SOCK\"\n  type        = string\n}\n\nvariable \"ssh_hosts_keys\" {\n  default     = null\n  description = \"A list of SSH hosts public keys to verify\"\n  type        = list(string)\n}\n\nvariable \"bastion_port\" {\n  description = \"Bastion SSH port\"\n  default     = 22\n  type        = number\n}\n\nvariable \"bastion_user\" {\n  description = \"Bastion SSH username\"\n  default     = \"\"\n  type        = string\n}\n\nvariable \"bastion_host_key\" {\n  description = \"Bastion SSH host public key\"\n  default     = null\n  type        = string\n}\n\nvariable \"control_plane_labels\" {\n  description = \"custom labels to add (and remove) to control plane\"\n  type        = map(string)\n  default = {\n    \"custom-label-to-add\" = \"custom-value\"\n    # note the minus symbol suffix\n    \"custom-label-to-remove-\" = \"\"\n  }\n}\n\nvariable \"disable_kubeapi_loadbalancer\" {\n  type        = bool\n  default     = false\n  description = \"E2E tests specific variable to disable usage of any loadbalancer in front of kubeapi-server\"\n}\n\n# Provider specific settings\n\nvariable \"aws_region\" {\n  default     = \"eu-west-3\"\n  description = \"AWS region to speak to\"\n  type        = string\n\n}\n\nvariable \"vpc_id\" {\n  default     = \"default\"\n  description = \"VPC to use ('default' for default VPC)\"\n  type        = string\n}\n\nvariable \"ip_family\" {\n  default     = \"IPv4+IPv6\"\n  description = \"IPFamily of the cluster\"\n  type        = string\n}\n\nvariable \"control_plane_type\" {\n  default     = \"t3.medium\"\n  description = \"AWS instance type\"\n}\n\nvariable \"control_plane_volume_size\" {\n  default     = 100\n  description = \"Size of the EBS volume, in Gb\"\n  type        = number\n}\n\nvariable \"worker_type\" {\n  default     = \"t3.medium\"\n  description = \"instance type for workers\"\n  type        = string\n}\n\nvariable \"bastion_type\" {\n  default     = \"t3.nano\"\n  description = \"instance type for bastion\"\n  type        = string\n}\n\nvariable \"os\" {\n  description = \"Operating System to use in AMI filtering and MachineDeployment\"\n\n  # valid choices are:\n  # * ubuntu\n  # * centos\n  # * rhel\n  # * flatcar\n  # * rockylinux\n  default = \"ubuntu\"\n  type    = string\n}\n\nvariable \"ami\" {\n  description = \"AMI ID, use it to fixate control-plane AMI in order to avoid force-recreation it at later times\"\n  default     = \"\"\n  type        = string\n}\n\nvariable \"ami_filters\" {\n  description = \"map with AMI filters\"\n  type = map(object({\n    owners       = list(string)\n    image_name   = list(string)\n    ssh_username = string\n    worker_os    = string\n  }))\n  default = {\n    ubuntu = {\n      owners       = [\"099720109477\"] # Canonical\n      image_name   = [\"ubuntu/images/hvm-ssd-gp3/ubuntu-noble-24.04-amd64-server-*\"]\n      ssh_username = \"ubuntu\"\n      worker_os    = \"ubuntu\"\n    }\n\n    centos = {\n      owners       = [\"125523088429\"]\n      image_name   = [\"CentOS 7.* x86_64\"]\n      ssh_username = \"centos\"\n      worker_os    = \"centos\"\n    }\n\n    flatcar = {\n      owners       = [\"075585003325\"] # Kinvolk\n      image_name   = [\"Flatcar-stable-*-hvm\"]\n      ssh_username = \"core\"\n      worker_os    = \"flatcar\"\n    }\n\n    rhel = {\n      owners       = [\"309956199498\"] # Red Hat\n      image_name   = [\"RHEL-8*_HVM-*-x86_64-*\"]\n      ssh_username = \"ec2-user\"\n      worker_os    = \"rhel\"\n    }\n\n    rockylinux = {\n      owners       = [\"792107900819\"] # RockyLinux\n      image_name   = [\"Rocky-8-ec2-*.x86_64\"]\n      ssh_username = \"rocky\"\n      worker_os    = \"rockylinux\"\n    }\n  }\n}\n\nvariable \"subnets_cidr\" {\n  default     = 24\n  description = \"CIDR mask bits per subnet\"\n  type        = number\n}\n\nvariable \"internal_api_lb\" {\n  default     = false\n  description = \"make kubernetes API loadbalancer internal (reachible only from inside the VPC)\"\n  type        = bool\n}\n\nvariable \"initial_machinedeployment_replicas\" {\n  default     = 1\n  description = \"number of replicas per MachineDeployment\"\n  type        = number\n\n}\n\nvariable \"cluster_autoscaler_min_replicas\" {\n  default     = 0\n  description = \"minimum number of replicas per MachineDeployment (requires cluster-autoscaler)\"\n  type        = number\n}\n\nvariable \"cluster_autoscaler_max_replicas\" {\n  default     = 0\n  description = \"maximum number of replicas per MachineDeployment (requires cluster-autoscaler)\"\n  type        = number\n}\n\nvariable \"static_workers_count\" {\n  description = \"number of static workers\"\n  default     = 0\n  type        = number\n}\n\nvariable \"initial_machinedeployment_spotinstances_max_price\" {\n  description = \"used to specify max spot instance price for initial machine-deployment\"\n  # we intentionally set minimum max price to ensure that user specifies it explicitly\n  default = 0\n  type    = number\n}\n\nvariable \"worker_deploy_ssh_key\" {\n  description = \"add provided ssh public key to MachineDeployments\"\n  default     = true\n  type        = bool\n}\n\nvariable \"control_plane_vm_count\" {\n  description = \"number of control plane instances\"\n  default     = 3\n  type        = number\n}\n\nvariable \"provisioning_utility\" {\n  description = \"provisioning utility to be used for Flatcar worker nodes\"\n  default     = \"\"\n  type        = string\n}\n\nvariable \"initial_machinedeployment_operating_system_profile\" {\n  default     = \"\"\n  type        = string\n  description = <<EOF\nName of operating system profile for MachineDeployments, only applicable if operating-system-manager addon is enabled.\nIf not specified default is used based on the OS specified for workers.\nEOF\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kubermatic__kubeone__examples__terraform__aws-dualstack__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    null = {\n      version = \"3.1.0\"\n    }\n  }\n}\n\nresource null_resource \"foo\" {\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-exec__tfexec__internal__e2etest__testdata__basic__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n    region = \"us-east-1\"\n}\n\nvariable \"ami\" {\n  description = \"This is AMI for the instance\"\n}\n\nvariable \"instance_type\" {\n  description = \"This is the instance type, for example: t2.micro\"\n}\n\nresource \"aws_instance\" \"example\" {\n    ami = var.ami\n    instance_type = var.instance_type\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-6__modules__ec2_instance__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-6__modules__ec2_instance__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-6__modules__ec2_instance__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-6__modules__ec2_instance__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-6__modules__ec2_instance__main.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/iam-veeramalla__terraform-zero-to-hero__Day-6__modules__ec2_instance__main.tf", "start_line": 13}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source = \"hashicorp/aws\"\n      version = \"5.31.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-east-1\"\n  profile = \"Helen\"\n  # Configuration options\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__cert-prep-terraform-associate-003-3330038__providers.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nresource \"awscc_accessanalyzer_analyzer\" \"this\" {\n  analyzer_name = \"example\"\n  type          = \"ACCOUNT\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-awscc__examples__resources__awscc_accessanalyzer_analyzer__account_analyzer.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"azurerm_resource_group\" \"example\" {\n  name     = \"${var.environment}-resources\"\n  location = var.allowed_locations[2]\n}\n\nresource \"azurerm_virtual_network\" \"main\" {\n  name                = \"${var.environment}-network\"\n  address_space       = [element(var.network_config,0)]\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n}\n\nresource \"azurerm_subnet\" \"internal\" {\n  name                 = \"internal\"\n  resource_group_name  = azurerm_resource_group.example.name\n  virtual_network_name = azurerm_virtual_network.main.name\n  address_prefixes     = [\"${element(var.network_config, 1)}/${element(var.network_config, 2)}\"]\n}\n\nresource \"azurerm_network_interface\" \"main\" {\n  name                = \"${var.environment}-nic\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  ip_configuration {\n    name                          = \"testconfiguration1\"\n    subnet_id                     = azurerm_subnet.internal.id\n    private_ip_address_allocation = \"Dynamic\"\n  }\n}\n\nresource \"azurerm_virtual_machine\" \"main\" {\n  name                  = \"${var.environment}-vm\"\n  location              = azurerm_resource_group.example.location\n  resource_group_name   = azurerm_resource_group.example.name\n  network_interface_ids = [azurerm_network_interface.main.id]\n  vm_size               = var.allowed_vm_sizes[0]\n\n  # Uncomment this line to delete the OS disk automatically when deleting the VM\n  delete_os_disk_on_termination = var.is_delete\n\n  # Uncomment this line to delete the data disks automatically when deleting the VM\n  # delete_data_disks_on_termination = true\n\n  storage_image_reference {\n    publisher = \"Canonical\"\n    offer     = \"0001-com-ubuntu-server-jammy\"\n    sku       = var.vm_config.sku\n    version   = var.vm_config.version\n  }\n  storage_os_disk {\n    name              = \"myosdisk1\"\n    caching           = \"ReadWrite\"\n    create_option     = \"FromImage\"\n    managed_disk_type = \"Standard_LRS\"\n    disk_size_gb = var.storage_disk\n  }\n  os_profile {\n    computer_name  = \"hostname\"\n    admin_username = \"testadmin\"\n    admin_password = \"Password1234!\"\n  }\n  os_profile_linux_config {\n    disable_password_authentication = false\n  }\n  tags = {\n    environment = var.resource_tags[\"environment\"]\n    managed_by = var.resource_tags[\"managed_by\"]\n    department = var.resource_tags[\"department\"]\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/piyushsachdeva__Terraform-Full-Course-Azure__lessons__day07__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_1", "severity": "HIGH", "message": "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/piyushsachdeva__Terraform-Full-Course-Azure__lessons__day07__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV2_AZURE_10", "severity": "CRITICAL", "message": "Ensure that Microsoft Antimalware is configured to automatically updates for Virtual Machines", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/piyushsachdeva__Terraform-Full-Course-Azure__lessons__day07__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV2_AZURE_12", "severity": "CRITICAL", "message": "Ensure that virtual machines are backed up using Azure Backup", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/piyushsachdeva__Terraform-Full-Course-Azure__lessons__day07__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV2_AZURE_31", "severity": "CRITICAL", "message": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/piyushsachdeva__Terraform-Full-Course-Azure__lessons__day07__main.tf", "start_line": 13}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource: VPC\nresource \"google_compute_network\" \"myvpc\" {\n  name = \"vpc1\"\n  auto_create_subnetworks = false   \n}\n\n# Resource: Subnet\nresource \"google_compute_subnetwork\" \"mysubnet\" {\n  name = \"${var.gcp_region1}-subnet\"\n  region = var.gcp_region1\n  ip_cidr_range = \"10.128.0.0/20\"\n  network = google_compute_network.myvpc.id \n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-google-cloud__05-Terraform-Variables-Output-Values__terraform-manifests__c3-vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_26", "severity": "HIGH", "message": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-google-cloud__05-Terraform-Variables-Output-Values__terraform-manifests__c3-vpc.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_GCP_74", "severity": "HIGH", "message": "Ensure that private_ip_google_access is enabled for Subnet", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-google-cloud__05-Terraform-Variables-Output-Values__terraform-manifests__c3-vpc.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV2_GCP_18", "severity": "CRITICAL", "message": "Ensure GCP network defines a firewall and does not use the default firewall", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-google-cloud__05-Terraform-Variables-Output-Values__terraform-manifests__c3-vpc.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nmodule \"remote_module\" {\n  source = \"git::https://github.com/im2nguyen/rover.git//example/random-test/random-name\"\n\n  max_length = \"3\"\n\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/im2nguyen__rover__example__nested-test__nested-module__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/im2nguyen__rover__example__nested-test__nested-module__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/im2nguyen__rover__example__nested-test__nested-module__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_cloudfront_distribution\" \"www_distribution\" {\n  // origin is where CloudFront gets its content from.\n  origin {\n    // We need to set up a \"custom\" origin because otherwise CloudFront won't\n    // redirect traffic from the root domain to the www domain, that is from\n    // runatlantis.io to www.runatlantis.io.\n    custom_origin_config {\n      // These are all the defaults.\n      http_port              = \"80\"\n      https_port             = \"443\"\n      origin_protocol_policy = \"http-only\"\n      origin_ssl_protocols   = [\"TLSv1\", \"TLSv1.1\", \"TLSv1.2\"]\n    }\n\n    // Here we're using our S3 bucket's URL!\n    domain_name = \"${aws_s3_bucket.www.website_endpoint}\"\n    // This can be any name to identify this origin.\n    origin_id   = \"${var.www_domain_name}\"\n  }\n\n  enabled             = true\n  default_root_object = \"index.html\"\n\n  // All values are defaults from the AWS console.\n  default_cache_behavior {\n    viewer_protocol_policy = \"redirect-to-https\"\n    compress               = true\n    allowed_methods        = [\"GET\", \"HEAD\"]\n    cached_methods         = [\"GET\", \"HEAD\"]\n    // This needs to match the `origin_id` above.\n    target_origin_id       = \"${var.www_domain_name}\"\n    min_ttl                = 0\n    default_ttl            = 86400\n    max_ttl                = 31536000\n\n    forwarded_values {\n      query_string = false\n      cookies {\n        forward = \"none\"\n      }\n    }\n  }\n\n  // Here we're ensuring we can hit this distribution using www.runatlantis.io\n  // rather than the domain name CloudFront gives us.\n  aliases = [\"${var.www_domain_name}\"]\n\n  restrictions {\n    geo_restriction {\n      restriction_type = \"none\"\n    }\n  }\n\n  // Here's where our certificate is loaded in!\n  viewer_certificate {\n    acm_certificate_arn = \"${aws_acm_certificate.certificate.arn}\"\n    ssl_support_method  = \"sni-only\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/runatlantis__atlantis__runatlantis.io__blog__2018__hosting-our-static-site__code__cloudfront.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_86", "severity": "HIGH", "message": "Ensure CloudFront distribution has Access Logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/runatlantis__atlantis__runatlantis.io__blog__2018__hosting-our-static-site__code__cloudfront.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_310", "severity": "HIGH", "message": "Ensure CloudFront distributions should have origin failover configured", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/runatlantis__atlantis__runatlantis.io__blog__2018__hosting-our-static-site__code__cloudfront.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_374", "severity": "HIGH", "message": "Ensure AWS CloudFront web distribution has geo restriction enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/runatlantis__atlantis__runatlantis.io__blog__2018__hosting-our-static-site__code__cloudfront.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_174", "severity": "HIGH", "message": "Verify CloudFront Distribution Viewer Certificate is using TLS v1.2 or higher", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/runatlantis__atlantis__runatlantis.io__blog__2018__hosting-our-static-site__code__cloudfront.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_68", "severity": "HIGH", "message": "CloudFront Distribution should have WAF enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/runatlantis__atlantis__runatlantis.io__blog__2018__hosting-our-static-site__code__cloudfront.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_32", "severity": "CRITICAL", "message": "Ensure CloudFront distribution has a response headers policy attached", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/runatlantis__atlantis__runatlantis.io__blog__2018__hosting-our-static-site__code__cloudfront.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_47", "severity": "CRITICAL", "message": "Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/runatlantis__atlantis__runatlantis.io__blog__2018__hosting-our-static-site__code__cloudfront.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"website-url\" {\n  value = \"http://${linode_object_storage_bucket.website.label}.website-${linode_object_storage_bucket.website.cluster}.linodeobjects.com/\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/linode__terraform-provider-linode__examples__obj_static_site__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"aws_region\" \"current\" {\n  count = var.create_vpc && var.enable_flow_log ? 1 : 0\n\n  region = var.region\n}\n\ndata \"aws_caller_identity\" \"current\" {\n  count = var.create_vpc && var.enable_flow_log ? 1 : 0\n}\n\ndata \"aws_partition\" \"current\" {\n  count = var.create_vpc && var.enable_flow_log ? 1 : 0\n}\n\nlocals {\n  enable_flow_log = var.create_vpc && var.enable_flow_log\n\n  create_flow_log_cloudwatch_iam_role  = local.enable_flow_log && var.flow_log_destination_type != \"s3\" && var.create_flow_log_cloudwatch_iam_role\n  create_flow_log_cloudwatch_log_group = local.enable_flow_log && var.flow_log_destination_type != \"s3\" && var.create_flow_log_cloudwatch_log_group\n\n  flow_log_destination_arn                  = local.create_flow_log_cloudwatch_log_group ? try(aws_cloudwatch_log_group.flow_log[0].arn, null) : var.flow_log_destination_arn\n  flow_log_iam_role_arn                     = var.flow_log_destination_type != \"s3\" && local.create_flow_log_cloudwatch_iam_role ? try(aws_iam_role.vpc_flow_log_cloudwatch[0].arn, null) : var.flow_log_cloudwatch_iam_role_arn\n  flow_log_cloudwatch_log_group_name_suffix = var.flow_log_cloudwatch_log_group_name_suffix == \"\" ? local.vpc_id : var.flow_log_cloudwatch_log_group_name_suffix\n  flow_log_group_arns = [\n    for log_group in aws_cloudwatch_log_group.flow_log :\n    \"arn:${data.aws_partition.current[0].partition}:logs:${data.aws_region.current[0].region}:${data.aws_caller_identity.current[0].account_id}:log-group:${log_group.name}:*\"\n  ]\n}\n\n################################################################################\n# Flow Log\n################################################################################\n\nresource \"aws_flow_log\" \"this\" {\n  count = local.enable_flow_log ? 1 : 0\n\n  region = var.region\n\n  log_destination_type       = var.flow_log_destination_type\n  log_destination            = local.flow_log_destination_arn\n  log_format                 = var.flow_log_log_format\n  iam_role_arn               = local.flow_log_iam_role_arn\n  deliver_cross_account_role = var.flow_log_deliver_cross_account_role\n  traffic_type               = var.flow_log_traffic_type\n  vpc_id                     = local.vpc_id\n  max_aggregation_interval   = var.flow_log_max_aggregation_interval\n\n  dynamic \"destination_options\" {\n    for_each = var.flow_log_destination_type == \"s3\" ? [true] : []\n\n    content {\n      file_format                = var.flow_log_file_format\n      hive_compatible_partitions = var.flow_log_hive_compatible_partitions\n      per_hour_partition         = var.flow_log_per_hour_partition\n    }\n  }\n\n  tags = merge(var.tags, var.vpc_flow_log_tags)\n}\n\n################################################################################\n# Flow Log CloudWatch\n################################################################################\n\nresource \"aws_cloudwatch_log_group\" \"flow_log\" {\n  count = local.create_flow_log_cloudwatch_log_group ? 1 : 0\n\n  region = var.region\n\n  name              = \"${var.flow_log_cloudwatch_log_group_name_prefix}${local.flow_log_cloudwatch_log_group_name_suffix}\"\n  retention_in_days = var.flow_log_cloudwatch_log_group_retention_in_days\n  kms_key_id        = var.flow_log_cloudwatch_log_group_kms_key_id\n  skip_destroy      = var.flow_log_cloudwatch_log_group_skip_destroy\n  log_group_class   = var.flow_log_cloudwatch_log_group_class\n\n  tags = merge(var.tags, var.vpc_flow_log_tags)\n}\n\nresource \"aws_iam_role\" \"vpc_flow_log_cloudwatch\" {\n  count = local.create_flow_log_cloudwatch_iam_role ? 1 : 0\n\n  name        = var.vpc_flow_log_iam_role_use_name_prefix ? null : var.vpc_flow_log_iam_role_name\n  name_prefix = var.vpc_flow_log_iam_role_use_name_prefix ? \"${var.vpc_flow_log_iam_role_name}-\" : null\n  path        = var.vpc_flow_log_iam_role_path\n\n  assume_role_policy   = data.aws_iam_policy_document.flow_log_cloudwatch_assume_role[0].json\n  permissions_boundary = var.vpc_flow_log_permissions_boundary\n\n  tags = merge(var.tags, var.vpc_flow_log_tags)\n}\n\ndata \"aws_iam_policy_document\" \"flow_log_cloudwatch_assume_role\" {\n  count = local.create_flow_log_cloudwatch_iam_role ? 1 : 0\n\n  statement {\n    sid = \"AWSVPCFlowLogsAssumeRole\"\n\n    principals {\n      type        = \"Service\"\n      identifiers = [\"vpc-flow-logs.amazonaws.com\"]\n    }\n\n    effect = \"Allow\"\n\n    actions = [\"sts:AssumeRole\"]\n\n    dynamic \"condition\" {\n      for_each = var.flow_log_cloudwatch_iam_role_conditions\n      content {\n        test     = condition.value.test\n        variable = condition.value.variable\n        values   = condition.value.values\n      }\n    }\n  }\n}\n\nresource \"aws_iam_role_policy_attachment\" \"vpc_flow_log_cloudwatch\" {\n  count = local.create_flow_log_cloudwatch_iam_role ? 1 : 0\n\n  role       = aws_iam_role.vpc_flow_log_cloudwatch[0].name\n  policy_arn = aws_iam_policy.vpc_flow_log_cloudwatch[0].arn\n}\n\nresource \"aws_iam_policy\" \"vpc_flow_log_cloudwatch\" {\n  count = local.create_flow_log_cloudwatch_iam_role ? 1 : 0\n\n  name        = var.vpc_flow_log_iam_policy_use_name_prefix ? null : var.vpc_flow_log_iam_policy_name\n  name_prefix = var.vpc_flow_log_iam_policy_use_name_prefix ? \"${var.vpc_flow_log_iam_policy_name}-\" : null\n  policy      = data.aws_iam_policy_document.vpc_flow_log_cloudwatch[0].json\n  tags        = merge(var.tags, var.vpc_flow_log_tags)\n}\n\ndata \"aws_iam_policy_document\" \"vpc_flow_log_cloudwatch\" {\n  count = local.create_flow_log_cloudwatch_iam_role ? 1 : 0\n\n  statement {\n    sid = \"AWSVPCFlowLogsPushToCloudWatch\"\n\n    effect = \"Allow\"\n\n    actions = [\n      \"logs:CreateLogStream\",\n      \"logs:PutLogEvents\",\n      \"logs:DescribeLogGroups\",\n      \"logs:DescribeLogStreams\",\n    ]\n\n    resources = local.flow_log_group_arns\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-vpc__vpc-flow-logs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"ip\" {\n    value = \"${azurerm_public_ip.tf_publicip.ip_address}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__vault-guides__identity__azure-auth__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"azurerm_resource_group\" \"resource_group\" {\n  name     = \"${var.resource_group}_${var.environment}\"\n  location = var.location\n}\n\nprovider \"azurerm\" {\n  //version = \"~>2.0.0\"\n  features {}\n}\n\nresource \"azurerm_kubernetes_cluster\" \"terraform-k8s\" {\n  name                = \"${var.cluster_name}_${var.environment}\"\n  location            = azurerm_resource_group.resource_group.location\n  resource_group_name = azurerm_resource_group.resource_group.name\n  dns_prefix          = var.dns_prefix\n\n  linux_profile {\n    admin_username = \"ubuntu\"\n\n    ssh_key {\n      key_data = file(var.ssh_public_key)\n    }\n  }\n\n  default_node_pool {\n    name            = \"agentpool\"\n    node_count      = var.node_count\n    vm_size         = \"standard_b2ms\"\n    # vm_size         = \"standard_d2as_v5\"      CHANGE IF AN ERROR ARISES \n  }\n\n  service_principal {\n    client_id     = var.client_id\n    client_secret = var.client_secret\n  }\n\n  tags = {\n    Environment = var.environment\n  }\n}\n\nterraform {\n  backend \"azurerm\" {\n    # storage_account_name=\"<<storage_account_name>>\" #OVERRIDE in TERRAFORM init\n    # access_key=\"<<storage_account_key>>\" #OVERRIDE in TERRAFORM init\n    # key=\"<<env_name.k8s.tfstate>>\" #OVERRIDE in TERRAFORM init\n    # container_name=\"<<storage_account_container_name>>\" #OVERRIDE in TERRAFORM init\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_6", "severity": "HIGH", "message": "Ensure AKS has an API Server Authorized IP Ranges enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_115", "severity": "HIGH", "message": "Ensure that AKS enables private clusters", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_227", "severity": "HIGH", "message": "Ensure that the AKS cluster encrypt temp disks, caches, and data flows between Compute and Storage resources", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_226", "severity": "HIGH", "message": "Ensure ephemeral disks are used for OS disks", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_170", "severity": "HIGH", "message": "Ensure that AKS use the Paid Sku for its SLA", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_141", "severity": "HIGH", "message": "Ensure AKS local admin account is disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_4", "severity": "HIGH", "message": "Ensure AKS logging to Azure Monitoring is Configured", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_168", "severity": "HIGH", "message": "Ensure Azure Kubernetes Cluster (AKS) nodes should use a minimum number of 50 pods.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_7", "severity": "HIGH", "message": "Ensure AKS cluster has Network Policy configured", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_232", "severity": "HIGH", "message": "Ensure that only critical system pods run on system nodes", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_172", "severity": "HIGH", "message": "Ensure autorotation of Secrets Store CSI Driver secrets for AKS clusters", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_171", "severity": "HIGH", "message": "Ensure AKS cluster upgrade channel is chosen", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_116", "severity": "HIGH", "message": "Ensure that AKS uses Azure Policies Add-on", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV_AZURE_117", "severity": "HIGH", "message": "Ensure that AKS uses disk encryption set", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV2_AZURE_29", "severity": "CRITICAL", "message": "Ensure AKS cluster has Azure CNI networking enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in28minutes__devops-master-class__projects__microservices__01-currency-exchange-microservice-basic__configuration__iaac__azure__kubernetes__main.tf", "start_line": 11}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"configure_kubectl\" {\n  description = \"Configure kubectl: make sure you're logged in with the correct AWS profile and run the following command to update your kubeconfig\"\n  value       = \"aws eks update-kubeconfig --name ${module.eks.cluster_name} --alias ${module.eks.cluster_name} --region ${local.region}\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-eks-blueprints__patterns__aws-vpc-cni-network-policy__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"ip\" {\n  value = aws_instance.r100c96.public_ip\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/akramdevopstrainer__terraform__terraformLearning-master__custom-aws-ec2-userdata__myout.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"ovh_cloud_project_database\" \"db\" {\n  service_name  = \"XXXXXX\"\n  engine        = \"YYYY\"\n  id            = \"ZZZZ\"\n}\n\noutput \"cluster_id\" {\n  value = data.ovh_cloud_project_database.db.id\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ovh__terraform-provider-ovh__examples__data-sources__cloud_project_database__example_1.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"octopusdeploy_library_variable_set\" \"foo\" {\n  name        = \"Account IDs\"\n  description = \"Ids of accounts\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__terraformer__tests__octopusdeploy__library_variable_set.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_user\" \"app2\" {\n  name          = \"app2-svc-account\"\n  force_destroy = true\n}\n\nresource \"aws_iam_user_policy\" \"app2\" {\n  user   = aws_iam_user.app2.name\n  policy = <<-EOF\n    {\n      \"Version\": \"2012-10-17\",\n      \"Statement\": [\n        {\n          \"Action\": [\n            \"s3:List*\"\n          ],\n          \"Effect\": \"Allow\",\n          \"Resource\": \"*\"\n        }\n      ]\n    }\n  EOF\n}\n\nresource \"aws_iam_access_key\" \"app2\" {\n  user = aws_iam_user.app2.name\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.2__app2.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_273", "severity": "HIGH", "message": "Ensure access is controlled through SSO and not AWS IAM defined users", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.2__app2.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_40", "severity": "HIGH", "message": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.2__app2.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-in-action__manning-code__chapter10__listing10.2__app2.tf", "start_line": 6}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# //////////////////////////////\n# VARIABLES\n# //////////////////////////////\nvariable \"aws_access_key\" {}\n\nvariable \"aws_secret_key\" {}\n\nvariable \"region\" {\n  default = \"us-east-2\"\n}\n\n# //////////////////////////////\n# OUTPUT\n# //////////////////////////////\noutput \"instance-ip\" {\n  value = module.ec2_cluster.public_ip\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LinkedInLearning__advanced-terraform-2823489__03_04_complex__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.0.0, < 2.0.0\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-east-2\"\n}\n\nresource \"aws_instance\" \"example\" {\n  ami           = \"ami-0fb653ca2d3203ac1\"\n  instance_type = \"t2.micro\"\n\n  tags = {\n    Name = \"terraform-example\"\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__02-intro-to-terraform-syntax__one-server__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__02-intro-to-terraform-syntax__one-server__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__02-intro-to-terraform-syntax__one-server__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__02-intro-to-terraform-syntax__one-server__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__02-intro-to-terraform-syntax__one-server__main.tf", "start_line": 16}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/brikis98__terraform-up-and-running-code__code__terraform__02-intro-to-terraform-syntax__one-server__main.tf", "start_line": 16}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"eu-west-1\"\n}\n\nlocals {\n  name = \"ex-${basename(path.cwd)}\"\n\n  tags = {\n    Example    = local.name\n    GithubRepo = \"terraform-aws-iam\"\n    GithubOrg  = \"terraform-aws-modules\"\n  }\n}\n\n################################################################################\n# IAM Policy\n################################################################################\n\nmodule \"iam_policy\" {\n  source = \"../../modules/iam-policy\"\n\n  name_prefix = \"example-\"\n  path        = \"/\"\n  description = \"My example policy\"\n\n  policy = <<-EOF\n    {\n      \"Version\": \"2012-10-17\",\n      \"Statement\": [\n        {\n          \"Action\": [\n            \"ec2:Describe*\"\n          ],\n          \"Effect\": \"Allow\",\n          \"Resource\": \"*\"\n        }\n      ]\n    }\n  EOF\n\n  tags = local.tags\n}\n\nmodule \"iam_policy_from_data_source\" {\n  source = \"../../modules/iam-policy\"\n\n  name        = \"example_from_data_source\"\n  path        = \"/\"\n  description = \"My example policy\"\n\n  policy = data.aws_iam_policy_document.bucket_policy.json\n\n  tags = local.tags\n}\n\nmodule \"iam_policy_disabled\" {\n  source = \"../../modules/iam-policy\"\n\n  create = false\n}\n\n################################################################################\n# Supporting resources\n################################################################################\n\ndata \"aws_iam_policy_document\" \"bucket_policy\" {\n  statement {\n    sid       = \"AllowFullS3Access\"\n    actions   = [\"s3:ListAllMyBuckets\"]\n    resources = [\"*\"]\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-aws-modules__terraform-aws-iam__examples__iam-policy__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource Block to Create VPC in us-east-1 which uses default provider\nresource \"aws_vpc\" \"vpc-us-east-1\" {\n  cidr_block = \"10.1.0.0/16\"\n  tags = {\n    \"Name\" = \"vpc-us-east-1\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-03-Multiple-Provider-Configurations__terraform-manifests__c2-vpc-us-east-1.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-03-Multiple-Provider-Configurations__terraform-manifests__c2-vpc-us-east-1.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/psriram76__stacksimplify-hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-03-Multiple-Provider-Configurations__terraform-manifests__c2-vpc-us-east-1.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nprovider \"vsphere\" {\n  user           = var.vsphere_user\n  password       = var.vsphere_password\n  vsphere_server = var.vsphere_server\n}\n\nresource \"vsphere_virtual_machine\" \"internal-vm\" {\n  name = \"terraform-test\"\n  // Here we're referencing a provider generated by the\n  // base application module that was imported via gradle\n  provider = aws.default\n}\n\n\nresource \"vsphere_virtual_machine\" \"external-vm\" {\n  name     = \"terraform-test\"\n  provider = aws.external\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-cdk__examples__java__gradle-shared-module__module-b__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\nterraform {\n  required_providers {\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"3.1.0\"\n    }\n  }\n  required_version = \">= 0.14.9\"\n}\n\nresource \"random_pet\" \"always_new\" {\n  keepers = {\n    uuid = uuid()\n  }\n  length = 5\n}\n\noutput \"pet\" {\n  value = { name_of_pet : random_pet.always_new.id }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-tfe__internal__provider__test-fixtures__basic-config__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  access_key = \"\"\n  secret_key = \"\"\n  region     = \"us-east-1\"\n}\n\nresource \"aws_appsync_graphql_api\" \"tf-test-graphql-api\" {\n  authentication_type = \"API_KEY\"\n  name                = \"terraform-test-api\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-5__app-sync.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_194", "severity": "HIGH", "message": "Ensure AppSync has Field-Level logs enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-5__app-sync.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV_AWS_193", "severity": "HIGH", "message": "Ensure AppSync has Logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-5__app-sync.tf", "start_line": 7}, {"tool": "checkov", "rule_id": "CKV2_AWS_33", "severity": "CRITICAL", "message": "Ensure AppSync is protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/VibinD__terraform__chap-5__app-sync.tf", "start_line": 7}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Demo Ubuntu Server(t2.medium)\nresource \"aws_instance\" \"Demo_Server\" {\n  count                  = 1\n  ami                    = var.ubuntuami\n  instance_type          = \"m5.large\"\n  vpc_security_group_ids = [aws_security_group.demo_sg.id]\n  subnet_id              = element(aws_subnet.subnets.*.id, count.index)\n  key_name               = var.key_name\n\n  tags = {\n    Name = \"UbuntuServer\"\n    Type = \"Docker\"\n  }\n\n}\n# 2 Instance Of Redhat Servers(t2.micro)\nresource \"aws_instance\" \"redhat_servers\" {\n  count                  = 2\n  ami                    = var.redhatami\n  instance_type          = \"t2.micro\"\n  vpc_security_group_ids = [aws_security_group.demo_sg.id]\n  subnet_id              = element(aws_subnet.subnets.*.id, count.index)\n  key_name               = var.key_name\n  user_data              = file(\"init_script.sh\")\n  tags = {\n    Name = \"Redhat_Server_${count.index + 1}\"\n  }\n\n\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/LandmakTechnology__terraform-eks__VPC__instances.tf", "start_line": 17}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nbad_block {\n}\n\nterraform {\n    bad_attribute = \"string\"\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-exec__tfexec__internal__e2etest__testdata__invalid__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"tags\" {\n  default = []\n}\n\nresource \"aws_autoscaling_group\" \"group\" {\n  tags = var.tags\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-linters__tflint-ruleset-aws__integration__cty-based-eval__template.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_315", "severity": "HIGH", "message": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-linters__tflint-ruleset-aws__integration__cty-based-eval__template.tf", "start_line": 5}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"datadog_monitor\" \"process_alert_example\" {\n  name    = \"Process Alert Monitor\"\n  type    = \"process alert\"\n  message = \"Multiple Java processes running on example-tag\"\n  query   = \"processes('java').over('example-tag').rollup('count').last('10m') > 1\"\n\n  monitor_thresholds {\n    critical = 1.0\n  }\n\n  renotify_interval = 60\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DataDog__terraform-provider-datadog__examples__guides__process_monitor.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source = \"hashicorp/aws\"\n    }\n    docker = {\n      source = \"kreuzwerker/docker\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  profile                 = \"default\"\n  region                  = \"us-east-1\"\n  shared_credentials_file = \"credentials\"\n}\n\nprovider \"docker\" {\n\n}\n\n\n// AWS Resources\nresource \"aws_s3_bucket\" \"tf_course\" {\n  bucket = \"tf-course-20210207\"\n  acl    = \"private\"\n}\n\n\n\n\ndata \"aws_ami\" \"ubuntu\" {\n  most_recent = true\n\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  owners = [\"099720109477\"] # Canonical\n}\n\nresource \"aws_instance\" \"web\" {\n  ami           = data.aws_ami.ubuntu.id\n  instance_type = \"t2.micro\"\n  provisioner \"local-exec\" {\n    command = \"echo ${aws_instance.web.public_ip} >> private_ips.txt\"\n  }\n\n  tags = {\n    Name = \"DevOps_Cohort_2020\"\n  }\n}\n/*\nresource \"aws_eip\" \"ip\" {\n  vpc      = true\n  instance = aws_instance.web.id\n}\n*/\n\n// Docker Resources\nresource \"docker_image\" \"nginx\" {\n  name         = \"nginx:latest\"\n  keep_locally = false\n} \n\nresource \"docker_container\" \"nginx\" {\n  image = docker_image.nginx.latest\n  name  = \"tutorial\"\n  ports {\n    internal = 90\n    external = 9000\n  }\n}\n// Docker Resources\nresource \"docker_image\" \"flask\" {\n  name         = \"habboubi/flaskapp:latest\"\n  keep_locally = false\n}\n\nresource \"docker_container\" \"flask\" {\n  image = docker_image.flask.latest\n  name  = \"flaskapp\"\n  ports {\n    internal = 80\n    external = 80\n  }\n}\n\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV2_AWS_62", "severity": "CRITICAL", "message": "Ensure S3 buckets should have event notifications enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV2_AWS_6", "severity": "CRITICAL", "message": "Ensure that S3 bucket has a Public Access block", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV2_AWS_61", "severity": "CRITICAL", "message": "Ensure that an S3 bucket has a lifecycle configuration", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_AWS_18", "severity": "HIGH", "message": "Ensure the S3 bucket has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_AWS_144", "severity": "HIGH", "message": "Ensure that S3 bucket has cross-region replication enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_AWS_21", "severity": "HIGH", "message": "Ensure all data stored in the S3 bucket have versioning enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 24}, {"tool": "checkov", "rule_id": "CKV_AWS_145", "severity": "HIGH", "message": "Ensure that S3 buckets are encrypted with KMS by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/jhabboubi__terraform__main.tf", "start_line": 24}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# `vpc-cni` EKS addon\n# https://docs.aws.amazon.com/eks/latest/userguide/cni-iam-role.html\n# https://docs.aws.amazon.com/eks/latest/userguide/managing-vpc-cni.html\n# https://docs.aws.amazon.com/eks/latest/userguide/cni-iam-role.html#cni-iam-role-create-role\n# https://aws.github.io/aws-eks-best-practices/networking/vpc-cni/#deploy-vpc-cni-managed-add-on\n\nlocals {\n  vpc_cni_sa_needed = local.enabled\n}\n\n# It is important to enable IPv6 support for the VPC CNI plugin\n# even if IPv6 is not in use, because the addon may need to\n# manage IPv6 addresses during a transition from IPv6 to IPv4\n# or vice versa, or while destroying the cluster.\ndata \"aws_iam_policy_document\" \"vpc_cni_ipv6\" {\n  count = local.vpc_cni_sa_needed ? 1 : 0\n\n  # See https://docs.aws.amazon.com/eks/latest/userguide/cni-iam-role.html#cni-iam-role-create-ipv6-policy\n  statement {\n    sid       = \"\"\n    effect    = \"Allow\"\n    resources = [\"*\"]\n\n    actions = [\n      \"ec2:AssignIpv6Addresses\",\n      \"ec2:DescribeInstances\",\n      \"ec2:DescribeTags\",\n      \"ec2:DescribeNetworkInterfaces\",\n      \"ec2:DescribeInstanceTypes\"\n    ]\n  }\n\n  statement {\n    sid       = \"\"\n    effect    = \"Allow\"\n    resources = [\"arn:aws:ec2:*:*:network-interface/*\"]\n    actions   = [\"ec2:CreateTags\"]\n  }\n}\n\nresource \"aws_iam_role_policy_attachment\" \"vpc_cni\" {\n  count = local.vpc_cni_sa_needed ? 1 : 0\n\n  role       = module.vpc_cni_eks_iam_role.service_account_role_name\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy\"\n}\n\nmodule \"vpc_cni_eks_iam_role\" {\n  source  = \"cloudposse/eks-iam-role/aws\"\n  version = \"2.1.1\"\n\n  enabled = local.vpc_cni_sa_needed\n\n  eks_cluster_oidc_issuer_url = module.eks_cluster.eks_cluster_identity_oidc_issuer\n\n  service_account_name      = \"aws-node\"\n  service_account_namespace = \"kube-system\"\n\n  aws_iam_policy_document = try([data.aws_iam_policy_document.vpc_cni_ipv6[0].json], [])\n\n  context = module.this.context\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-eks-cluster__examples__complete__vpc-cni.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-eks-cluster__examples__complete__vpc-cni.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_111", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-eks-cluster__examples__complete__vpc-cni.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_356", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cloudposse__terraform-aws-eks-cluster__examples__complete__vpc-cni.tf", "start_line": 15}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"website_url\" {\n  description = \"The URL of the static website\"\n  value       = \"https://${aws_cloudfront_distribution.s3_distribution.domain_name}\"\n}\n\noutput \"cloudfront_distribution_id\" {\n  description = \"The ID of the CloudFront distribution\"\n  value       = aws_cloudfront_distribution.s3_distribution.id\n}\n\noutput \"s3_bucket_name\" {\n  description = \"The name of the S3 bucket\"\n  value       = aws_s3_bucket.website.bucket\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/piyushsachdeva__Terraform-Full-Course-Aws__lessons__day14__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"deployment\" {}\nvariable \"filter\" {}\nvariable \"project_id\" {}\n\nprovider \"google\" {\n  project = var.project_id\n  region  = \"us-central1\"\n  zone    = \"us-central1-c\"\n}\n\nresource \"google_pubsub_topic\" \"my-topic\" {\n  name = var.deployment\n}\n\nresource \"google_logging_project_sink\" \"my-sink\" {\n  name = format(\"sink-%s\", var.deployment)\n  destination = format(\"pubsub.googleapis.com/projects/%s/topics/%s\", var.project_id, var.deployment)\n  filter = var.filter\n}\n\nresource \"google_logging_metric\" \"my-metric\" {\n  name   = format(\"metric-%s\", var.deployment)\n  filter = var.filter\n  metric_descriptor {\n    metric_kind = \"DELTA\"\n    value_type  = \"INT64\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__deploymentmanager-samples__google__resource-snippets__logging-v2__alternatives__tf__logging.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_83", "severity": "HIGH", "message": "Ensure PubSub Topics are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__deploymentmanager-samples__google__resource-snippets__logging-v2__alternatives__tf__logging.tf", "start_line": 11}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_dynamodb_table_item\" \"account-request\" {\n  table_name = var.account-request-table\n  hash_key   = var.account-request-table-hash\n\n  item = jsonencode({\n    id = { S = lookup(var.control_tower_parameters, \"AccountEmail\") }\n    control_tower_parameters = { M = {\n      AccountEmail              = { S = lookup(var.control_tower_parameters, \"AccountEmail\") }\n      AccountName               = { S = lookup(var.control_tower_parameters, \"AccountName\") }\n      ManagedOrganizationalUnit = { S = lookup(var.control_tower_parameters, \"ManagedOrganizationalUnit\") }\n      SSOUserEmail              = { S = lookup(var.control_tower_parameters, \"SSOUserEmail\") }\n      SSOUserFirstName          = { S = lookup(var.control_tower_parameters, \"SSOUserFirstName\") }\n      SSOUserLastName           = { S = lookup(var.control_tower_parameters, \"SSOUserLastName\") }\n      }\n    }\n    change_management_parameters = { M = {\n      change_reason       = { S = lookup(var.change_management_parameters, \"change_reason\") }\n      change_requested_by = { S = lookup(var.change_management_parameters, \"change_requested_by\") }\n      }\n    }\n    account_tags                = { S = jsonencode(var.account_tags) }\n    account_customizations_name = { S = var.account_customizations_name }\n    custom_fields               = { S = jsonencode(var.custom_fields) }\n  })\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-request__terraform__modules__aft-account-request__ddb.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n// Copyright (c) 2017, 2024, Oracle and/or its affiliates. All rights reserved.\n// Licensed under the Mozilla Public License v2.0\n\nresource \"oci_core_vcn\" \"test_vcn\" {\n  cidr_block     = \"10.0.0.0/16\"\n  compartment_id = var.compartment_ocid\n  display_name   = \"exampleVCN\"\n  dns_label      = \"tfexamplevcn\"\n}\n\nresource \"oci_core_subnet\" \"test_subnet\" {\n  cidr_block        = \"10.0.1.0/24\"\n  display_name      = \"regionalSubnet\"\n  dns_label         = \"regionalsubnet\"\n  compartment_id    = var.compartment_ocid\n  vcn_id            = oci_core_vcn.test_vcn.id\n  security_list_ids = [oci_core_vcn.test_vcn.default_security_list_id]\n  route_table_id    = oci_core_vcn.test_vcn.default_route_table_id\n  dhcp_options_id   = oci_core_vcn.test_vcn.default_dhcp_options_id\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/oracle__terraform-provider-oci__examples__analytics__subnet.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource Block to Create VPC in us-east-1 which uses default provider\nresource \"aws_vpc\" \"vpc-us-east-1\" {\n  cidr_block = \"10.1.0.0/16\"\n  tags = {\n    \"Name\" = \"vpc-us-east-1\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-03-Multiple-Provider-Configurations__terraform-manifests__c2-vpc-us-east-1.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-03-Multiple-Provider-Configurations__terraform-manifests__c2-vpc-us-east-1.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__hashicorp-certified-terraform-associate__03-Terraform-Fundamental-Blocks__03-03-Multiple-Provider-Configurations__terraform-manifests__c2-vpc-us-east-1.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n# [START bigquery_create_materialized_view]\nresource \"google_bigquery_dataset\" \"default\" {\n  dataset_id                      = \"mydataset\"\n  default_partition_expiration_ms = 2592000000  # 30 days\n  default_table_expiration_ms     = 31536000000 # 365 days\n  description                     = \"dataset description\"\n  location                        = \"US\"\n  max_time_travel_hours           = 96 # 4 days\n\n  labels = {\n    billing_group = \"accounting\",\n    pii           = \"sensitive\"\n  }\n}\n\nresource \"google_bigquery_table\" \"default\" {\n  dataset_id          = google_bigquery_dataset.default.dataset_id\n  table_id            = \"my_materialized_view\"\n  deletion_protection = false # set to \"true\" in production\n\n  materialized_view {\n    query                            = \"SELECT ID, description, date_created FROM `myproject.orders.items`\"\n    enable_refresh                   = \"true\"\n    refresh_interval_ms              = 172800000 # 2 days\n    allow_non_incremental_definition = \"false\"\n  }\n\n}\n# [END bigquery_create_materialized_view]\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-docs-samples__bigquery__bigquery_create_materialized_view__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_GCP_81", "severity": "HIGH", "message": "Ensure Big Query Datasets are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-docs-samples__bigquery__bigquery_create_materialized_view__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_GCP_121", "severity": "HIGH", "message": "Ensure BigQuery tables have deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-docs-samples__bigquery__bigquery_create_materialized_view__main.tf", "start_line": 32}, {"tool": "checkov", "rule_id": "CKV_GCP_80", "severity": "HIGH", "message": "Ensure Big Query Tables are encrypted with Customer Supplied Encryption Keys (CSEK)", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-docs-samples__bigquery__bigquery_create_materialized_view__main.tf", "start_line": 32}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Resource: EC2 Instance\nresource \"aws_instance\" \"myec2vm\" {\n  ami = \"ami-0742b4e673072066f\"\n  instance_type = \"t3.micro\"\n  user_data = file(\"${path.module}/app1-install.sh\")\n  tags = {\n    \"Name\" = \"EC2 Demo\"\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__03-Terraform-Settings-Providers-Resources__terraform-manifests__c2-ec2instance.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__03-Terraform-Settings-Providers-Resources__terraform-manifests__c2-ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__03-Terraform-Settings-Providers-Resources__terraform-manifests__c2-ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__03-Terraform-Settings-Providers-Resources__terraform-manifests__c2-ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__03-Terraform-Settings-Providers-Resources__terraform-manifests__c2-ec2instance.tf", "start_line": 2}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/stacksimplify__terraform-on-aws-eks__03-Terraform-Settings-Providers-Resources__terraform-manifests__c2-ec2instance.tf", "start_line": 2}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"${var.region}\"\n  access_key = \"${var.access_key}\"\n  secret_key = \"${var.secret_key}\"\n}\n\n// SSH KeyPair\nresource \"aws_key_pair\" \"default\" {\n  key_name   = \"registry\"\n  public_key = \"${file(\"${var.ssh_public_key}\")}\"\n}\n\n// Jenkins Master\nresource \"aws_instance\" \"ci-master\" {\n  ami = \"${lookup()}\"\n  instance_type = \"${var.instance_type}\"\n  key_name = \"${aws_key_pair.default.id}\"\n  security_groups = [\"${aws_security_group.default.name}\"]\n\n  user_data = \"${file(\"setup.sh\")}\"\n\n  tags {\n    Name = \"ci-master\"\n  }\n}\n\n// Jenkins Slave\nresource \"aws_instance\" \"ci-slave\" {\n  ami = \"${lookup()}\"\n  instance_type = \"${var.instance_type}\"\n  key_name = \"${aws_key_pair.default.id}\"\n\n  tags {\n    Name = \"ci-slave\"\n  }\n}\n\n// Deployment Environment\nresource \"aws_instance\" \"node\" {\n  count = 3\n  ami = \"${lookup()}\"\n  instance_type = \"${var.instance_type}\"\n  key_name = \"${aws_key_pair.default.id}\"\n\n  tags {\n    Name = \"node-${count.index}\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/mlabouardy__terraform-aws-labs__ci-pipeline__main.tf", "start_line": 39}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#SSH Public Key\nvariable \"ssh-public-key-for-ec2\" {\n  default = \"./demo-attack.pub\"\n}\n#SSH Private Key\nvariable \"ssh-private-key-for-ec2\" {\n  default = \"./demo-attack\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tenable__KaiMonkey__terraform__aws__scenarios__ssrf-iam-breach__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_sfn_state_machine\" \"aft_account_provisioning_customizations\" {\n  name       = \"aft-account-provisioning-customizations\"\n  role_arn   = aws_iam_role.aft_states.arn\n  definition = templatefile(\"${path.module}/states/customizations.asl.json\", {})\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-provisioning-customizations__terraform__states.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_285", "severity": "HIGH", "message": "Ensure State Machine has execution history logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-provisioning-customizations__terraform__states.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_284", "severity": "HIGH", "message": "Ensure State Machine has X-Ray tracing enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp-education__learn-terraform-aft-account-provisioning-customizations__terraform__states.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n# Building the list of disk names in the required format.\n# Usually you would build this list from the outputs of the compute_instance module\nlocals {\n  instance_disks = [for i in range(2) : \"projects/${var.project_id}/disks/instance-disk-snapshot-001-${i + 1}/zones/${data.google_compute_zones.available.names[0]}\"]\n}\n\ndata \"google_compute_zones\" \"available\" {\n  project = var.project_id\n  region  = var.region\n}\n\nmodule \"instance_template\" {\n  source  = \"terraform-google-modules/vm/google//modules/instance_template\"\n  version = \"~> 13.0\"\n\n  region          = var.region\n  project_id      = var.project_id\n  subnetwork      = var.subnetwork\n  name_prefix     = \"instance-disk-snapshot\"\n  service_account = var.service_account\n\n  additional_disks = [\n    {\n      auto_delete  = true\n      boot         = false\n      disk_size_gb = 20\n      disk_type    = \"pd-standard\"\n      disk_name    = null\n      device_name  = null\n      disk_labels  = { \"foo\" : \"bar\" }\n    },\n    {\n      auto_delete  = true\n      boot         = false\n      disk_size_gb = 30\n      disk_type    = \"pd-standard\"\n      disk_name    = null\n      device_name  = null\n      disk_labels  = {}\n    }\n  ]\n}\n\nmodule \"compute_instance\" {\n  source  = \"terraform-google-modules/vm/google//modules/compute_instance\"\n  version = \"~> 13.0\"\n\n  region            = var.region\n  subnetwork        = var.subnetwork\n  num_instances     = 1\n  hostname          = \"instance-disk-snapshot\"\n  instance_template = module.instance_template.self_link\n}\n\nmodule \"disk_snapshots\" {\n  source  = \"terraform-google-modules/vm/google//modules/compute_disk_snapshot\"\n  version = \"~> 13.0\"\n\n  name    = \"backup-policy-test\"\n  project = var.project_id\n  region  = var.region\n\n  snapshot_retention_policy = {\n    max_retention_days    = 10\n    on_source_disk_delete = \"KEEP_AUTO_SNAPSHOTS\"\n  }\n\n  snapshot_schedule = {\n    daily_schedule = {\n      days_in_cycle = 1\n      start_time    = \"08:00\"\n    }\n    hourly_schedule = null\n    weekly_schedule = null\n  }\n\n  snapshot_properties = {\n    guest_flush       = true\n    storage_locations = [\"EU\"]\n    labels            = null\n  }\n\n  module_depends_on = [module.compute_instance]\n  disks             = local.instance_disks\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__compute_instance__disk_snapshot__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__compute_instance__disk_snapshot__main.tf", "start_line": 28}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__compute_instance__disk_snapshot__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/terraform-google-modules__terraform-google-vm__examples__compute_instance__disk_snapshot__main.tf", "start_line": 71}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: BUSL-1.1\n\nprovider \"aws\" {\n  region = var.region\n}\n\nmodule \"provision-infra\" {\n  source = \"./provision-infra\"\n\n  name                                   = var.name\n  server_count                           = var.server_count\n  client_count_linux                     = var.client_count_linux\n  client_count_windows_2022              = var.client_count_windows_2022\n  nomad_local_binary_server              = var.nomad_local_binary_server\n  nomad_local_binary                     = var.nomad_local_binary\n  nomad_local_binary_client_ubuntu_jammy = var.nomad_local_binary_client_ubuntu_jammy\n  nomad_local_binary_client_windows_2022 = var.nomad_local_binary_client_windows_2022\n  nomad_license                          = var.nomad_license\n  consul_license                         = var.consul_license\n  nomad_region                           = var.nomad_region\n  instance_arch                          = var.instance_arch\n  instance_type                          = var.instance_type\n  volumes                                = var.volumes\n  availability_zone                      = var.availability_zone\n  aws_kms_alias                          = var.aws_kms_alias\n  hcp_hvn_cidr                           = var.hcp_hvn_cidr\n  hcp_vault_cluster_id                   = var.hcp_vault_cluster_id\n  hcp_vault_namespace                    = var.hcp_vault_namespace\n  region                                 = var.region\n  restrict_ingress_cidrblock             = var.restrict_ingress_cidrblock\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__nomad__e2e__terraform__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nvariable \"aws_access_key\" {\n  description = \"The AWS access key used for deployment\"\n  type        = string\n  sensitive   = true\n\n  validation {\n    condition     = can(regex(\"^([A-Z0-9]{20})\", var.aws_access_key))\n    error_message = \"The aws_access_key variable must be a valid AWS Access Key (e.g. AKIAJSIE27KKMHXI3BJQ).\"\n  }\n}\n\nvariable \"aws_secret_key\" {\n  description = \"The AWS secret key used for deployment\"\n  type        = string\n  sensitive   = true\n\n  validation {\n    condition     = can(regex(\"^([a-zA-Z0-9+\\\\/-]{40})\", var.aws_secret_key))\n    error_message = \"The aws_secret_key variable must be a valid AWS Secret Key value (e.g. wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY)\"\n  }\n}\n\nvariable \"create_aws_ssm_iam_role\" {\n  description = \"Create an AWS SSM IAM role to attach to VMs for SSH/console access to VMs.\"\n  type        = bool\n  default     = false\n\n  validation {\n    condition     = can(tobool(var.create_aws_ssm_iam_role))\n    error_message = \"The create_aws_ssm_iam_role is a boolean value and can only be either true or false.\"\n  }\n}\n\nvariable \"aws_ssm_iam_role_name\" {\n  description = \"The name of the SSM EC2 role to associate with Kasm VMs for SSH access\"\n  type        = string\n  default     = \"\"\n\n  validation {\n    condition     = can(regex(\"[a-zA-Z0-9+=,.@-]{1,64}\", var.aws_ssm_iam_role_name))\n    error_message = \"The aws_ssm_iam_role_name must be unique across the account and can only consisit of between 1 and 64 characters consisting of letters, numbers, underscores (_), plus (+), equals (=), comman (,), period (.), at symbol (@), or dash (-).\"\n  }\n}\n\nvariable \"aws_ssm_instance_profile_name\" {\n  description = \"The name of the SSM EC2 Instance Profile to associate with Kasm VMs for SSH access\"\n  type        = string\n  default     = \"\"\n\n  validation {\n    condition     = var.aws_ssm_instance_profile_name == \"\" ? true : can(regex(\"[a-zA-Z0-9+=,.@-]{1,64}\", var.aws_ssm_instance_profile_name))\n    error_message = \"The aws_ssm_instance_profile_name must be unique across the account and can only consisit of between 1 and 64 characters consisting of letters, numbers, underscores (_), plus (+), equals (=), comman (,), period (.), at symbol (@), or dash (-).\"\n  }\n}\n\nvariable \"project_name\" {\n  description = \"The name of the deployment (e.g dev, staging). A short single word\"\n  type        = string\n\n  validation {\n    condition     = can(regex(\"^[a-z]{4,15}\", var.project_name))\n    error_message = \"The project_name variable can only be one word between 4 and 15 lower-case letters since it is a seed value in multiple object names.\"\n  }\n}\n\nvariable \"aws_domain_name\" {\n  description = \"The Route53 Zone used for the dns entries. This must already exist in the AWS account. (e.g dev.kasm.contoso.com). The deployment will be accessed via this zone name via https\"\n  type        = string\n\n  validation {\n    condition     = can(regex(\"(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]\", var.aws_domain_name))\n    error_message = \"There are invalid characters in the aws_domain_name - it must be a valid domain name.\"\n  }\n}\n\nvariable \"primary_vpc_subnet_cidr\" {\n  description = \"The subnet CIDR to use for the VPC\"\n  type        = string\n  default     = \"10.0.0.0/16\"\n\n  validation {\n    condition     = can(cidrhost(var.primary_vpc_subnet_cidr, 0))\n    error_message = \"The VPC subnet must be valid IPv4 CIDR.\"\n  }\n}\n\nvariable \"num_agents\" {\n  description = \"The number of Agent Role Servers to create in the deployment\"\n  type        = number\n  default     = 2\n\n  validation {\n    condition     = var.num_agents >= 0 && var.num_agents <= 100 && floor(var.num_agents) == var.num_agents\n    error_message = \"Acceptable number of Kasm Agents range between 0-100.\"\n  }\n}\n\nvariable \"num_webapps\" {\n  description = \"The number of WebApp role servers to create in the deployment\"\n  type        = number\n  default     = 2\n\n  validation {\n    condition     = var.num_webapps >= 1 && var.num_webapps <= 3 && floor(var.num_webapps) == var.num_webapps\n    error_message = \"Acceptable number of webapps range between 1-3.\"\n  }\n}\n\nvariable \"num_cpx_nodes\" {\n  description = \"The number of RDP Conection Proxy Role Servers to create in the deployment. Set this to zero (0) and this Terraform will not deploy ANY Connection Proxy or Windows resoures like subnets, security groups, etc.\"\n  type        = number\n\n  validation {\n    condition     = var.num_cpx_nodes == 0 ? true : var.num_cpx_nodes >= 0 && var.num_cpx_nodes <= 100 && floor(var.num_cpx_nodes) == var.num_cpx_nodes\n    error_message = \"If num_cpx_nodes is set to 0, this Terraform will not deploy the Connection Proxy node. Acceptable number ranges between 0-100.\"\n  }\n}\n\nvariable \"num_proxy_nodes\" {\n  description = \"The number of Dedicated Proxy nodes to create in the deployment\"\n  type        = number\n\n  validation {\n    condition     = var.num_proxy_nodes == 1 ? true : var.num_proxy_nodes >= 1 && var.num_proxy_nodes <= 100 && floor(var.num_proxy_nodes) == var.num_proxy_nodes\n    error_message = \"The number of Dedicated Proxy nodes to deploy in remote regions. Acceptable number ranges between 1-100.\"\n  }\n}\n\nvariable \"webapp_instance_type\" {\n  description = \"The instance type for the webapps\"\n  type        = string\n  default     = \"\"\n\n  validation {\n    condition     = can(regex(\"^(([a-z-]{1,3})(\\\\d{1,2})?(\\\\w{1,4})?)\\\\.(nano|micro|small|medium|metal|large|(2|3|4|6|8|9|10|12|16|18|24|32|48|56|112)?xlarge)\", var.webapp_instance_type))\n    error_message = \"Check the webapp_instance_type variable and ensure it is a valid AWS Instance type (https://aws.amazon.com/ec2/instance-types/).\"\n  }\n}\n\nvariable \"db_instance_type\" {\n  description = \"The instance type for the Database\"\n  type        = string\n\n  validation {\n    condition     = can(regex(\"^(([a-z-]{1,3})(\\\\d{1,2})?(\\\\w{1,4})?)\\\\.(nano|micro|small|medium|metal|large|(2|3|4|6|8|9|10|12|16|18|24|32|48|56|112)?xlarge)\", var.db_instance_type))\n    error_message = \"Check the db_instance_type variable and ensure it is a valid AWS Instance type (https://aws.amazon.com/ec2/instance-types/).\"\n  }\n}\n\nvariable \"agent_instance_type\" {\n  description = \"The instance type for the Agents\"\n  type        = string\n\n  validation {\n    condition     = can(regex(\"^(([a-z-]{1,3})(\\\\d{1,2})?(\\\\w{1,4})?)\\\\.(nano|micro|small|medium|metal|large|(2|3|4|6|8|9|10|12|16|18|24|32|48|56|112)?xlarge)\", var.agent_instance_type))\n    error_message = \"Check the agent_instance_type variable and ensure it is a valid AWS Instance type (https://aws.amazon.com/ec2/instance-types/).\"\n  }\n}\n\nvariable \"cpx_instance_type\" {\n  description = \"The instance type for the Guac RDP nodes\"\n  type        = string\n\n  validation {\n    condition     = can(regex(\"^(([a-z-]{1,3})(\\\\d{1,2})?(\\\\w{1,4})?)\\\\.(nano|micro|small|medium|metal|large|(2|3|4|6|8|9|10|12|16|18|24|32|48|56|112)?xlarge)\", var.cpx_instance_type))\n    error_message = \"Check the cpx_instance_type variable and ensure it is a valid AWS Instance type (https://aws.amazon.com/ec2/instance-types/).\"\n  }\n}\n\nvariable \"proxy_instance_type\" {\n  description = \"The instance type for the dedicated proxy node\"\n  type        = string\n  default     = \"\"\n\n  validation {\n    condition     = can(regex(\"^(([a-z-]{1,3})(\\\\d{1,2})?(\\\\w{1,4})?)\\\\.(nano|micro|small|medium|metal|large|(2|3|4|6|8|9|10|12|16|18|24|32|48|56|112)?xlarge)\", var.proxy_instance_type))\n    error_message = \"Check the proxy_instance_type variable and ensure it is a valid AWS Instance type (https://aws.amazon.com/ec2/instance-types/).\"\n  }\n}\n\nvariable \"webapp_hdd_size_gb\" {\n  description = \"The HDD size in GB to configure for the Kasm WebApp instances\"\n  type        = number\n\n  validation {\n    condition     = can(var.webapp_hdd_size_gb >= 40)\n    error_message = \"Kasm Webapps should have at least a 40 GB HDD to ensure enough space for Kasm services.\"\n  }\n}\n\nvariable \"db_hdd_size_gb\" {\n  description = \"The HDD size in GB to configure for the Kasm Database instances\"\n  type        = number\n\n  validation {\n    condition     = can(var.db_hdd_size_gb >= 40)\n    error_message = \"Kasm Database should have at least a 40 GB HDD to ensure enough space for Kasm services.\"\n  }\n}\n\nvariable \"agent_hdd_size_gb\" {\n  description = \"The HDD size in GB to configure for the Kasm Agent instances\"\n  type        = number\n\n  validation {\n    condition     = can(var.agent_hdd_size_gb >= 120)\n    error_message = \"Kasm Agents should have at least a 120 GB HDD to ensure enough space for Kasm services.\"\n  }\n}\n\nvariable \"cpx_hdd_size_gb\" {\n  description = \"The HDD size in GB to configure for the Kasm Guac RDP instances\"\n  type        = number\n\n  validation {\n    condition     = can(var.cpx_hdd_size_gb >= 40)\n    error_message = \"Kasm Guac RDP nodes should have at least a 40 GB HDD to ensure enough space for Kasm services.\"\n  }\n}\n\nvariable \"proxy_hdd_size_gb\" {\n  description = \"The HDD size in GB to configure for the Kasm dedicated proxy instances\"\n  type        = number\n\n  validation {\n    condition     = can(var.proxy_hdd_size_gb >= 40)\n    error_message = \"Kasm dedicated proxy nodes should have at least a 40 GB HDD to ensure enough space for Kasm services.\"\n  }\n}\n\nvariable \"primary_region_ec2_ami_id\" {\n  description = \"AMI Id of Kasm EC2 image in the primary region. Recommended AMI OS Version is Ubuntu 20.04 LTS.\"\n  type        = string\n\n  validation {\n    condition     = can(regex(\"^(ami-[a-f0-9]{17})\", var.primary_region_ec2_ami_id))\n    error_message = \"Please verify that your AMI is in the correct format for AWS (https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/finding-an-ami.html).\"\n  }\n}\n\nvariable \"secondary_regions_settings\" {\n  description = \"Map of Kasm settings for secondary regions\"\n  type = map(object({\n    agent_region   = string\n    agent_vpc_cidr = string\n    ec2_ami_id     = string\n    })\n  )\n\n  validation {\n    condition     = alltrue([for region in var.secondary_regions_settings : can(regex(\"^([a-z]{2}-[a-z]{4,}-[\\\\d]{1})$\", region.agent_region))])\n    error_message = \"Verify the regions in the secondary_regions_settings variable and ensure they are valid AWS regions in a valid format (e.g. us-east-1).\"\n  }\n  validation {\n    condition     = alltrue([for ami_id in var.secondary_regions_settings : can(regex(\"^(ami-[a-f0-9]{17})\", ami_id.ec2_ami_id))])\n    error_message = \"Please verify that all of your Region's AMI IDs are in the correct format for AWS (https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/finding-an-ami.html).\"\n  }\n  validation {\n    condition     = alltrue([for subnet in var.secondary_regions_settings : can(cidrhost(subnet.agent_vpc_cidr, 0))])\n    error_message = \"Verify the VPC subnet in your secondary_regions_settings. They must all be valid IPv4 CIDRs.\"\n  }\n}\n\nvariable \"aws_primary_region\" {\n  description = \"The AWS Region used for deployment\"\n  type        = string\n  default     = \"us-east-1\"\n\n  validation {\n    condition     = can(regex(\"^([a-z]{2}-[a-z]{4,}-[\\\\d]{1})$\", var.aws_primary_region))\n    error_message = \"The aws_primary_region must be a valid Amazon Web Services (AWS) Region name, e.g. us-east-1\"\n  }\n}\n\nvariable \"swap_size\" {\n  description = \"The amount of swap (in GB) to configure inside the compute instances\"\n  type        = number\n\n  validation {\n    condition     = var.swap_size >= 1 && var.swap_size <= 8 && floor(var.swap_size) == var.swap_size\n    error_message = \"Swap size is the amount of disk space to use for Kasm in GB and must be an integer between 1 and 8.\"\n  }\n}\n\nvariable \"ssh_authorized_keys\" {\n  description = \"The SSH Public Keys to be installed on the OCI compute instance\"\n  type        = string\n\n  validation {\n    condition     = var.ssh_authorized_keys == \"\" ? true : can(regex(\"^(ssh-rsa|ssh-ed25519)\", var.ssh_authorized_keys))\n    error_message = \"The ssh_authorized_keys value is not in the correct format.\"\n  }\n}\n\nvariable \"database_password\" {\n  description = \"The password for the database. No special characters\"\n  type        = string\n  sensitive   = true\n\n  validation {\n    condition     = can(regex(\"^[a-zA-Z0-9]{12,30}$\", var.database_password))\n    error_message = \"The Database Password should be a string between 12 and 30 letters and numbers with no special characters.\"\n  }\n}\n\nvariable \"redis_password\" {\n  description = \"The password for the Redis server. No special characters\"\n  type        = string\n  sensitive   = true\n\n  validation {\n    condition     = can(regex(\"^[a-zA-Z0-9]{12,30}$\", var.redis_password))\n    error_message = \"The Redis Password should be a string between 12 and 30 letters and numbers with no special characters.\"\n  }\n}\n\nvariable \"user_password\" {\n  description = \"The standard (non administrator) user password. No special characters\"\n  type        = string\n  sensitive   = true\n\n  validation {\n    condition     = can(regex(\"^[a-zA-Z0-9]{12,30}$\", var.user_password))\n    error_message = \"The User Password should be a string between 12 and 30 letters and numbers with no special characters.\"\n  }\n}\n\nvariable \"admin_password\" {\n  description = \"The administrative user password. No special characters\"\n  type        = string\n  sensitive   = true\n\n  validation {\n    condition     = can(regex(\"^[a-zA-Z0-9]{12,30}$\", var.admin_password))\n    error_message = \"The Admin password should be a string between 12 and 30 letters and numbers with no special characters.\"\n  }\n}\n\nvariable \"manager_token\" {\n  description = \"The manager token value for Agents to authenticate to webapps. No special characters\"\n  type        = string\n  sensitive   = true\n\n  validation {\n    condition     = can(regex(\"^[a-zA-Z0-9]{12,30}$\", var.manager_token))\n    error_message = \"The Manager Token should be a string between 12 and 30 letters and numbers with no special characters.\"\n  }\n}\n\nvariable \"service_registration_token\" {\n  description = \"The service registration token value for cpx RDP servers to authenticate to webapps. No special characters\"\n  type        = string\n  sensitive   = true\n\n  validation {\n    condition     = can(regex(\"^[a-zA-Z0-9]{12,30}$\", var.service_registration_token))\n    error_message = \"The Service Registration Token should be a string between 12 and 30 letters or numbers with no special characters.\"\n  }\n}\n\nvariable \"ssh_access_cidrs\" {\n  description = \"CIDR notation of the bastion host allowed to SSH in to the machines\"\n  type        = list(string)\n  default     = [\"0.0.0.0/0\"]\n\n  validation {\n    condition     = alltrue([for subnet in var.ssh_access_cidrs : can(cidrhost(subnet, 0))])\n    error_message = \"One of the subnets provided in the ssh_access_cidr variable is invalid.\"\n  }\n}\n\nvariable \"web_access_cidrs\" {\n  description = \"CIDR notation of the bastion host allowed to SSH in to the machines\"\n  type        = list(string)\n  default     = [\"0.0.0.0/0\"]\n\n  validation {\n    condition     = alltrue([for subnet in var.web_access_cidrs : can(cidrhost(subnet, 0))])\n    error_message = \"One of the subnets provided in the web_access_cidrs variable is invalid.\"\n  }\n}\n\n## Non-validated variables\nvariable \"kasm_build\" {\n  description = \"Download URL for Kasm Workspaces\"\n  type        = string\n}\n\nvariable \"aws_default_tags\" {\n  description = \"Default tags to apply to all AWS resources for this deployment\"\n  type        = map(any)\n  default = {\n    Service_name = \"Kasm Workspaces\"\n    Kasm_version = \"1.14\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__aws__multi_region__variables.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_SECRET_2", "severity": "CRITICAL", "message": "AWS Access Key", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__aws__multi_region__variables.tf", "start_line": 8}, {"tool": "checkov", "rule_id": "CKV_SECRET_2", "severity": "CRITICAL", "message": "AWS Access Key", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/kasmtech__terraform__aws__multi_region__variables.tf", "start_line": 19}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\nregion = \"us-east-1\"\n}\n\n\nresource \"aws_instance\" \"web\" {\n  ami           = \"ami-04bf6dcdc9ab498ca\"\n  instance_type = \"t2.micro\"\n  key_name      = \"aws_iny_lappi\"\n  user_data     = \"${file(\"httpd.sh\")}\"\n  vpc_security_group_ids = [\"${aws_security_group.webSG.id}\"]\n  tags = {\n    Name = \"Test-file-provisioner\"\n  }\n}\n\n\nresource \"aws_security_group\" \"webSG\" {\n  name        = \"webSG\"\n  description = \"Allow ssh  inbound traffic\"\n\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port       = 0\n    to_port         = 0\n    protocol        = \"-1\"\n    cidr_blocks     = [\"0.0.0.0/0\"]\n    \n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__Provisioner__ec2-with-user-data__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__Provisioner__ec2-with-user-data__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__Provisioner__ec2-with-user-data__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__Provisioner__ec2-with-user-data__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__Provisioner__ec2-with-user-data__main.tf", "start_line": 6}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__Provisioner__ec2-with-user-data__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__Provisioner__ec2-with-user-data__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_24", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__Provisioner__ec2-with-user-data__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__Provisioner__ec2-with-user-data__main.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/DeekshithSN__Terraform__Provisioner__ec2-with-user-data__main.tf", "start_line": 6}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright 2019 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     https://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\n\nterraform {\n  required_version = \"~> 1.0.0\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__solutions-terraform-cloudbuild-gitops__modules__firewall__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n/**\n * Copyright 2022 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\noutput \"server_ip\" {\n  description = \"Webserver IP Address\"\n  value       = google_compute_instance.server_vm.network_interface[0].access_config[0].nat_ip\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/GoogleCloudPlatform__cluster-toolkit__community__front-end__ofe__tf__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"ap-south-1\" #mumbai region\n}\n\nprovider \"aws\" {\n   region = \"us-east-1\" #virginia region\n   alias = \"usa\"\n}\n\nresource \"aws_instance\" \"indiaserver\" {\n  ami = \"ami-0c1a7f89451184c8b\" #this ami is specific to mumbai region\n  instance_type = \"t2.micro\"\n  tags = {\n     Name = \"india-server\"\n   }\n}\n\nresource \"aws_instance\" \"usaserver\" {\n  ami = \"ami-02e136e904f3da870\"   #this ami is specific to virginia region\n  instance_type = \"t2.micro\"\n  provider = aws.usa\n  tags = {\n     Name = \"usa-server\"\n  }\n}\n\n \n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__multiple-instances-of-provider.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__multiple-instances-of-provider.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__multiple-instances-of-provider.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__multiple-instances-of-provider.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__multiple-instances-of-provider.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__multiple-instances-of-provider.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__multiple-instances-of-provider.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__multiple-instances-of-provider.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__multiple-instances-of-provider.tf", "start_line": 18}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__multiple-instances-of-provider.tf", "start_line": 10}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/networknuts__terraform__multiple-instances-of-provider.tf", "start_line": 18}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"auth0\" {}\n\nresource \"auth0_resource_server\" \"my_resource_server\" {\n  name        = \"Example Resource Server (Managed by Terraform)\"\n  identifier  = \"https://api.example.com\"\n  signing_alg = \"RS256\"\n\n  scopes {\n    value       = \"create:foo\"\n    description = \"Create foos\"\n  }\n\n  scopes {\n    value       = \"create:bar\"\n    description = \"Create bars\"\n  }\n\n  allow_offline_access                            = true\n  token_lifetime                                  = 8600\n  skip_consent_for_verifiable_first_party_clients = true\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alexkappa__terraform-provider-auth0__example__resource_server__main.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Container Build Images\n\n## Python 3.10 - x86\nresource \"aws_ecr_repository\" \"p310build_x86\" {\n  name                 = \"p310build\"\n  image_tag_mutability = \"MUTABLE\"\n  force_delete         = true\n\n  image_scanning_configuration {\n    scan_on_push = true\n  }\n}\n\nresource \"aws_ssm_parameter\" \"p310_build_repo\" {\n  type        = \"String\"\n  description = \"URL for p310 x86 repo\"\n  name        = \"/${var.app_name}/${local.workspace_full_name}/build/p310/x86/repo\"\n  value       = aws_ecr_repository.p310build_x86.repository_url\n  overwrite   = true\n}\n\n## Python 3.10 - arm64\nresource \"aws_ecr_repository\" \"p310build_arm64\" {\n  name                 = \"p310armbuild\"\n  image_tag_mutability = \"MUTABLE\"\n  force_delete         = true\n\n  image_scanning_configuration {\n    scan_on_push = true\n  }\n}\n\nresource \"aws_ssm_parameter\" \"p310_arm64_build_repo\" {\n  type        = \"String\"\n  description = \"URL for p310 arm64 repo\"\n  name        = \"/${var.app_name}/${local.workspace_full_name}/build/p310/arm64/repo\"\n  value       = aws_ecr_repository.p310build_arm64.repository_url\n  overwrite   = true\n}\n\n## Python 3.11 - x86\nresource \"aws_ecr_repository\" \"p311build\" {\n  name                 = \"p311build\"\n  image_tag_mutability = \"MUTABLE\"\n  force_delete         = true\n\n  image_scanning_configuration {\n    scan_on_push = true\n  }\n}\n\nresource \"aws_ssm_parameter\" \"p311_build_repo\" {\n  type        = \"String\"\n  description = \"URL for p311 arm64 repo\"\n  name        = \"/${var.app_name}/${local.workspace_full_name}/build/p311/x86/repo\"\n  value       = aws_ecr_repository.p311build.repository_url\n  overwrite   = true\n}\n\n## Python 3.11 - arm64\nresource \"aws_ecr_repository\" \"p311build_arm64\" {\n  name                 = \"p311armbuild\"\n  image_tag_mutability = \"MUTABLE\"\n  force_delete         = true\n\n  image_scanning_configuration {\n    scan_on_push = true\n  }\n}\n\nresource \"aws_ssm_parameter\" \"p311_arm64_build_repo\" {\n  type        = \"String\"\n  description = \"URL for p311 arm64 repo\"\n  name        = \"/${var.app_name}/${local.workspace_full_name}/build/p311/arm64/repo\"\n  value       = aws_ecr_repository.p311build_arm64.repository_url\n  overwrite   = true\n}\n\n\n## Python 3.12 builds\n\nmodule \"python312_x86_build\" {\n  source             = \"./container_repository\"\n  app_name           = var.app_name\n  workspace_full_name = local.workspace_full_name\n  python_version = \"p312\"\n  architecture = \"x86\"\n}\n\nmodule \"python312_arm64_build\" {\n  source             = \"./container_repository\"\n  app_name           = var.app_name\n  workspace_full_name = local.workspace_full_name\n  python_version = \"p312\"\n  architecture = \"arm64\"\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_51", "severity": "HIGH", "message": "Ensure ECR Image Tags are immutable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_136", "severity": "HIGH", "message": "Ensure that ECR repositories are encrypted using KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_AWS_51", "severity": "HIGH", "message": "Ensure ECR Image Tags are immutable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_136", "severity": "HIGH", "message": "Ensure that ECR repositories are encrypted using KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 23}, {"tool": "checkov", "rule_id": "CKV_AWS_51", "severity": "HIGH", "message": "Ensure ECR Image Tags are immutable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_AWS_136", "severity": "HIGH", "message": "Ensure that ECR repositories are encrypted using KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 42}, {"tool": "checkov", "rule_id": "CKV_AWS_51", "severity": "HIGH", "message": "Ensure ECR Image Tags are immutable", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 61}, {"tool": "checkov", "rule_id": "CKV_AWS_136", "severity": "HIGH", "message": "Ensure that ECR repositories are encrypted using KMS", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 61}, {"tool": "checkov", "rule_id": "CKV2_AWS_34", "severity": "CRITICAL", "message": "AWS SSM Parameter should be Encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV2_AWS_34", "severity": "CRITICAL", "message": "AWS SSM Parameter should be Encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 33}, {"tool": "checkov", "rule_id": "CKV2_AWS_34", "severity": "CRITICAL", "message": "AWS SSM Parameter should be Encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 52}, {"tool": "checkov", "rule_id": "CKV2_AWS_34", "severity": "CRITICAL", "message": "AWS SSM Parameter should be Encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/keithrozario__Klayers__pipeline__Terraform__container_repositories.tf", "start_line": 71}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Input variable: S3 bucket name\nvariable \"bucket_name\" {\n  description = \"The name of the S3 bucket. Must be globally unique.\"\n  default     = \"terraform-state-my-bucket\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/alfonsof__terraform-aws-examples__code__06-create-s3__vars.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  backend \"remote\" {\n    organization = \"glich-stream\"\n\n    workspaces {\n      name = \"ci-cd-staging\"\n    }\n  }\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 3.48\"\n    }\n\n    random = {\n      source = \"hashicorp/random\"\n      version = \"3.1.0\"\n    }\n  }\n\n  required_version = \">= 0.15.0\"\n}\n\nprovider \"aws\" {\n  profile = \"default\"\n  region  = \"eu-west-1\"\n}\n\nvariable \"staging_public_key\" {\n  description = \"Staging environment public key value\"\n  type        = string\n}\n\nvariable \"base_ami_id\" {\n  description = \"Base AMI ID\"\n  type        = string\n}\n\nresource \"random_id\" \"server\" {\n  keepers = {\n    # Generate a new id each time we switch to a new AMI id\n    ami_id = \"${var.base_ami_id}\"\n  }\n\n  byte_length = 8\n}\n\nresource \"aws_key_pair\" \"staging_key\" {\n  key_name   = \"staging-key\"\n  public_key = var.staging_public_key\n\n  tags = {\n    \"Name\" = \"staging_public_key\"\n  }\n}\n\n# This is the main staging environment. We will deploy to this the changes\n# to the main branch before deploying to the production environment.\nresource \"aws_instance\" \"staging_cicd_demo\" {\n  # Read the AMI id \"through\" the random_id resource to ensure that\n  # both will change together.\n  ami                    = random_id.server.keepers.ami_id\n  instance_type          = \"t2.micro\"\n  vpc_security_group_ids = [\"sg-0d2411db69a112a30\"]\n  key_name               = aws_key_pair.staging_key.key_name\n\n  tags = {\n    \"Name\" = \"staging_cicd_demo-${random_id.server.hex}\"\n  }\n}\n\noutput \"staging_dns\" {\n  value = aws_instance.staging_cicd_demo.public_dns\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__staging__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__staging__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__staging__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__staging__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__staging__main.tf", "start_line": 60}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Link-__ci-cd-intro__infra__instances__staging__main.tf", "start_line": 60}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#Variables declaration\n\nvariable \"subscription_id\" {\n  description = \"Azure subscription Id.\"\n}\n\nvariable \"tenant_id\" {\n  description = \"Azure tenant Id.\"\n}\n\nvariable \"client_id\" {\n  description = \"Azure service principal application Id\"\n}\n\nvariable \"client_secret\" {\n  description = \"Azure service principal application Secret\"\n}\n\nvariable \"lbs_public\" {\n  description = \"Load balancer properties.\"\n  type = list(object({\n    suffix_name            = string\n    sku                    = string\n    allocatedOutboundPorts = number #Number of SNAT ports, Load Balancer allocates SNAT ports in multiples of 8.\n    idleTimeoutInMinutes   = number #Outbound flow idle timeout. The parameter accepts a value from 4 to 66.\n    enableTcpReset         = bool   #Enable TCP Reset on idle timeout.\n    protocol               = string #Transport protocol of the outbound rule.\n  }))\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/JamesDLD__terraform__Best-Practice__BestPractice-4__var.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_version = \">= 1.0\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \">= 5.0\"\n    }\n\n    random = {\n      source  = \"hashicorp/random\"\n      version = \">= 3.0\"\n    }\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__ecs-blueprints__terraform__cicd-examples__lb-service-container-pipeline__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#----------------------------------------------------------\n# My Terraform\n#\n# Variables\n#\n# Made by Denis Astahov\n#----------------------------------------------------------\n\n\n\nprovider \"aws\" {\n  region = var.region\n}\n\nresource \"aws_default_vpc\" \"default\" {} # This need to be added since AWS Provider v4.29+ to get VPC id\n\ndata \"aws_ami\" \"latest_amazon_linux\" {\n  owners      = [\"amazon\"]\n  most_recent = true\n  filter {\n    name   = \"name\"\n    values = [\"amzn2-ami-hvm-*-x86_64-gp2\"]\n  }\n}\n\n\nresource \"aws_eip\" \"my_static_ip\" {\n  vpc      = true # Need to add in new AWS Provider version\n  instance = aws_instance.my_server.id\n  //tags     = var.common_tags\n  tags = merge(var.common_tags, { Name = \"${var.common_tags[\"Environment\"]} Server IP\" })\n\n  /*\n  tags = {\n    Name    = \"Server IP\"\n    Owner   = \"Denis Astahov\"\n    Project = \"Phoenix\"\n  }\n*/\n\n}\n\n\n\nresource \"aws_instance\" \"my_server\" {\n  ami                    = data.aws_ami.latest_amazon_linux.id\n  instance_type          = var.instance_type\n  vpc_security_group_ids = [aws_security_group.my_server.id]\n  monitoring             = var.enable_detailed_monitoring\n\n  tags = merge(var.common_tags, { Name = \"${var.common_tags[\"Environment\"]} Server Build by Terraform\" })\n\n}\n\n\nresource \"aws_security_group\" \"my_server\" {\n  name   = \"My Security Group\"\n  vpc_id = aws_default_vpc.default.id # This need to be added since AWS Provider v4.29+ to set VPC id\n\n  dynamic \"ingress\" {\n    for_each = var.allow_ports\n    content {\n      from_port   = ingress.value\n      to_port     = ingress.value\n      protocol    = \"tcp\"\n      cidr_blocks = [\"0.0.0.0/0\"]\n    }\n  }\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(var.common_tags, { Name = \"${var.common_tags[\"Environment\"]} Server SecurityGroup\" })\n\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-12__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_148", "severity": "HIGH", "message": "Ensure no default VPC is planned to be provisioned", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-12__main.tf", "start_line": 15}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-12__main.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-12__main.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-12__main.tf", "start_line": 45}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-12__main.tf", "start_line": 56}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-12__main.tf", "start_line": 56}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-12__main.tf", "start_line": 45}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 4.0\"\n    }\n  }\n}\n\n# Main region where the resources should be created in\n# Should be close to the location of your viewers\nprovider \"aws\" {\n  region = \"us-west-2\"\n}\n\n# Provider used for creating the Lambda@Edge function which must be deployed\n# to us-east-1 region (Should not be changed)\nprovider \"aws\" {\n  alias  = \"global_region\"\n  region = \"us-east-1\"\n}\n\nmodule \"tf_next\" {\n  source  = \"milliHQ/next-js/aws\"\n  version = \"1.0.0-canary.5\"\n\n  deployment_name = \"tf-next-example-image\"\n\n  providers = {\n    aws.global_region = aws.global_region\n  }\n\n  # Uncomment when using in the cloned monorepo for tf-next development\n  # source = \"../..\"\n  # debug_use_local_packages = true\n}\n\noutput \"cloudfront_domain_name\" {\n  value = module.tf_next.cloudfront_domain_name\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/milliHQ__terraform-aws-next-js__examples__next-image__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/milliHQ__terraform-aws-next-js__examples__next-image__main.tf", "start_line": 23}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nlocals {\n  cluster-name = var.cluster-name\n}\n\nresource \"aws_vpc\" \"vpc\" {\n  cidr_block           = var.cidr-block\n  instance_tenancy     = \"default\"\n  enable_dns_hostnames = true\n  enable_dns_support   = true\n\n  tags = {\n    Name = var.vpc-name\n    Env  = var.env\n\n  }\n}\n\nresource \"aws_internet_gateway\" \"igw\" {\n  vpc_id = aws_vpc.vpc.id\n\n  tags = {\n    Name                                          = var.igw-name\n    env                                           = var.env\n    \"kubernetes.io/cluster/${local.cluster-name}\" = \"owned\"\n  }\n\n  depends_on = [aws_vpc.vpc]\n}\n\nresource \"aws_subnet\" \"public-subnet\" {\n  count                   = var.pub-subnet-count\n  vpc_id                  = aws_vpc.vpc.id\n  cidr_block              = element(var.pub-cidr-block, count.index)\n  availability_zone       = element(var.pub-availability-zone, count.index)\n  map_public_ip_on_launch = true\n\n  tags = {\n    Name                                          = \"${var.pub-sub-name}-${count.index + 1}\"\n    Env                                           = var.env\n    \"kubernetes.io/cluster/${local.cluster-name}\" = \"owned\"\n    \"kubernetes.io/role/elb\"                      = \"1\"\n  }\n\n  depends_on = [aws_vpc.vpc,\n  ]\n}\n\nresource \"aws_subnet\" \"private-subnet\" {\n  count                   = var.pri-subnet-count\n  vpc_id                  = aws_vpc.vpc.id\n  cidr_block              = element(var.pri-cidr-block, count.index)\n  availability_zone       = element(var.pri-availability-zone, count.index)\n  map_public_ip_on_launch = false\n\n  tags = {\n    Name                                          = \"${var.pri-sub-name}-${count.index + 1}\"\n    Env                                           = var.env\n    \"kubernetes.io/cluster/${local.cluster-name}\" = \"owned\"\n    \"kubernetes.io/role/internal-elb\"             = \"1\"\n  }\n\n  depends_on = [aws_vpc.vpc,\n  ]\n}\n\n\nresource \"aws_route_table\" \"public-rt\" {\n  vpc_id = aws_vpc.vpc.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.igw.id\n  }\n\n  tags = {\n    Name = var.public-rt-name\n    env  = var.env\n  }\n\n  depends_on = [aws_vpc.vpc\n  ]\n}\n\nresource \"aws_route_table_association\" \"name\" {\n  count          = 3\n  route_table_id = aws_route_table.public-rt.id\n  subnet_id      = aws_subnet.public-subnet[count.index].id\n\n  depends_on = [aws_vpc.vpc,\n    aws_subnet.public-subnet\n  ]\n}\n\nresource \"aws_eip\" \"ngw-eip\" {\n  domain = \"vpc\"\n\n  tags = {\n    Name = var.eip-name\n  }\n\n  depends_on = [aws_vpc.vpc\n  ]\n\n}\n\nresource \"aws_nat_gateway\" \"ngw\" {\n  allocation_id = aws_eip.ngw-eip.id\n  subnet_id     = aws_subnet.public-subnet[0].id\n\n  tags = {\n    Name = var.ngw-name\n  }\n\n  depends_on = [aws_vpc.vpc,\n    aws_eip.ngw-eip\n  ]\n}\n\nresource \"aws_route_table\" \"private-rt\" {\n  vpc_id = aws_vpc.vpc.id\n\n  route {\n    cidr_block     = \"0.0.0.0/0\"\n    nat_gateway_id = aws_nat_gateway.ngw.id\n  }\n\n  tags = {\n    Name = var.private-rt-name\n    env  = var.env\n  }\n\n  depends_on = [aws_vpc.vpc,\n  ]\n}\n\nresource \"aws_route_table_association\" \"private-rt-association\" {\n  count          = 3\n  route_table_id = aws_route_table.private-rt.id\n  subnet_id      = aws_subnet.private-subnet[count.index].id\n\n  depends_on = [aws_vpc.vpc,\n    aws_subnet.private-subnet\n  ]\n}\n\nresource \"aws_security_group\" \"eks-cluster-sg\" {\n  name        = var.eks-sg\n  description = \"Allow 443 from Jump Server only\"\n\n  vpc_id = aws_vpc.vpc.id\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"] // It should be specific IP range\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = var.eks-sg\n  }\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__EKS-Terraform-GitHub-Actions__module__vpc.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_130", "severity": "HIGH", "message": "Ensure VPC subnets do not assign public IP by default", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__EKS-Terraform-GitHub-Actions__module__vpc.tf", "start_line": 30}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__EKS-Terraform-GitHub-Actions__module__vpc.tf", "start_line": 146}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__EKS-Terraform-GitHub-Actions__module__vpc.tf", "start_line": 146}, {"tool": "checkov", "rule_id": "CKV2_AWS_5", "severity": "CRITICAL", "message": "Ensure that Security Groups are attached to another resource", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__EKS-Terraform-GitHub-Actions__module__vpc.tf", "start_line": 146}, {"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__EKS-Terraform-GitHub-Actions__module__vpc.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AmanPathak-DevOps__EKS-Terraform-GitHub-Actions__module__vpc.tf", "start_line": 5}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright Amazon.com, Inc. or its affiliates. All rights reserved.\n# SPDX-License-Identifier: Apache-2.0\n#\nmodule \"aft\" {\n  source = \"github.com/aws-ia/terraform-aws-control_tower_account_factory\"\n  # Required Vars\n  ct_management_account_id    = \"111122223333\"\n  log_archive_account_id      = \"444455556666\"\n  audit_account_id            = \"123456789012\"\n  aft_management_account_id   = \"777788889999\"\n  ct_home_region              = \"us-east-1\"\n  tf_backend_secondary_region = \"us-west-2\"\n  # VCS Vars\n  vcs_provider                                  = \"gitlabselfmanaged\"\n  gitlab_selfmanaged_url                        = \"https://gitlab.example.com\"\n  account_request_repo_name                     = \"ExampleProject/example-repo-1\"\n  global_customizations_repo_name               = \"ExampleProject/example-repo-2\"\n  account_customizations_repo_name              = \"ExampleProject/example-repo-3\"\n  account_provisioning_customizations_repo_name = \"ExampleProject/example-repo-4\"\n  # TF Vars\n  terraform_distribution = \"tfc\"\n  terraform_token        = \"EXAMPLE-uoc1c1qsw7poexampleewjeno1pte3rw\"\n  terraform_org_name     = \"ExampleOrg\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-control_tower_account_factory__examples__gitlabselfmanaged+tf_cloud__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-control_tower_account_factory__examples__gitlabselfmanaged+tf_cloud__main.tf", "start_line": 4}, {"tool": "checkov", "rule_id": "CKV_TF_2", "severity": "HIGH", "message": "Ensure Terraform module sources use a tag with a version number", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/aws-ia__terraform-aws-control_tower_account_factory__examples__gitlabselfmanaged+tf_cloud__main.tf", "start_line": 4}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"random_pet\" \"rg_name\" {\n  prefix = var.resource_group_name_prefix\n}\n\nresource \"azurerm_resource_group\" \"rg\" {\n  name     = random_pet.rg_name.id\n  location = var.resource_group_location\n}\n\nresource \"random_string\" \"container_name\" {\n  length  = 25\n  lower   = true\n  upper   = false\n  special = false\n}\n\nresource \"azurerm_container_group\" \"container\" {\n  name                = \"${var.container_group_name_prefix}-${random_string.container_name.result}\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n  ip_address_type     = \"Public\"\n  os_type             = \"Linux\"\n  restart_policy      = var.restart_policy\n  zones               = var.zone != \"\" ? [ var.zone ] : null\n\n  container {\n    name   = \"${var.container_name_prefix}-${random_string.container_name.result}\"\n    image  = var.image\n    cpu    = var.cpu_cores\n    memory = var.memory_in_gb\n\n    ports {\n      port     = var.port\n      protocol = \"TCP\"\n    }\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform__quickstart__101-aci-linuxcontainer-public-ip__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_98", "severity": "HIGH", "message": "Ensure that Azure Container group is deployed into virtual network", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform__quickstart__101-aci-linuxcontainer-public-ip__main.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV_AZURE_245", "severity": "HIGH", "message": "Ensure that Azure Container group is deployed into virtual network", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform__quickstart__101-aci-linuxcontainer-public-ip__main.tf", "start_line": 17}, {"tool": "checkov", "rule_id": "CKV2_AZURE_28", "severity": "CRITICAL", "message": "Ensure Container Instance is configured with managed identity", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Azure__terraform__quickstart__101-aci-linuxcontainer-public-ip__main.tf", "start_line": 17}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_instance\" \"web_instance\" {\n  ami           = lookup(var.ami_id, var.region)\n  instance_type = var.instance_type\n  subnet_id     = aws_subnet.custom-vpc-public-subnet-one.id\n  vpc_security_group_ids = [aws_security_group.custom-vpc-security-group.id]\n  key_name      = var.key_name\n\n  tags = {\n    Name = var.ec2_tags\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__EC2_Custom_vpc__instance.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__EC2_Custom_vpc__instance.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__EC2_Custom_vpc__instance.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__EC2_Custom_vpc__instance.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__EC2_Custom_vpc__instance.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/Dgruploads__Terraform__EC2_Custom_vpc__instance.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_iam_role\" \"webservers_codepipeline\" {\n  name = \"exercism-webservers-codepipeline-role\"\n\n  assume_role_policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"codepipeline.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\nEOF\n}\n\nresource \"aws_iam_role_policy\" \"codepipeline_policy\" {\n  name = \"codepipeline_policy\"\n  role = aws_iam_role.webservers_codepipeline.id\n\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\":\"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:GetObjectVersion\",\n        \"s3:GetBucketVersioning\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"${aws_s3_bucket.webservers_codepipeline.arn}\",\n        \"${aws_s3_bucket.webservers_codepipeline.arn}/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codebuild:BatchGetBuilds\",\n        \"codebuild:StartBuild\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\nEOF\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__bk__iam_webservers_codepipeline.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_355", "severity": "HIGH", "message": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__bk__iam_webservers_codepipeline.tf", "start_line": 20}, {"tool": "checkov", "rule_id": "CKV_AWS_290", "severity": "HIGH", "message": "Ensure IAM policies does not allow write access without constraints", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/exercism__terraform__bk__iam_webservers_codepipeline.tf", "start_line": 20}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\noutput \"instance_ip_addr\" {\n  value = aws_instance.instance.private_ip\n}\n\noutput \"db_instance_addr\" {\n  value = aws_db_instance.db_instance.address\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/sidpalas__devops-directive-terraform-course__04-variables-and-outputs__examples__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#############################################################################\n# TERRAFORM CONFIG\n#############################################################################\n\nterraform {\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"~> 2.0\"\n    }\n  }\n}\n\n#############################################################################\n# VARIABLES\n#############################################################################\n\nvariable \"resource_group_name\" {\n  type = string\n}\n\nvariable \"location\" {\n  type    = string\n  default = \"eastus\"\n}\n\nvariable \"naming_prefix\" {\n  type    = string\n  default = \"itma\"\n}\n\n##################################################################################\n# PROVIDERS\n##################################################################################\n\nprovider \"azurerm\" {\n  features {}\n}\n\n##################################################################################\n# RESOURCES\n##################################################################################\nresource \"random_integer\" \"sa_num\" {\n  min = 10000\n  max = 99999\n}\n\n\nresource \"azurerm_resource_group\" \"setup\" {\n  name     = var.resource_group_name\n  location = var.location\n}\n\nresource \"azurerm_storage_account\" \"sa\" {\n  name                     = \"${lower(var.naming_prefix)}${random_integer.sa_num.result}\"\n  resource_group_name      = azurerm_resource_group.setup.name\n  location                 = var.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"LRS\"\n\n}\n\nresource \"azurerm_storage_container\" \"ct\" {\n  name                 = \"terraform-state\"\n  storage_account_name = azurerm_storage_account.sa.name\n\n}\n\ndata \"azurerm_storage_account_sas\" \"state\" {\n  connection_string = azurerm_storage_account.sa.primary_connection_string\n  https_only        = true\n\n  resource_types {\n    service   = true\n    container = true\n    object    = true\n  }\n\n  services {\n    blob  = true\n    queue = false\n    table = false\n    file  = false\n  }\n\n  start  = timestamp()\n  expiry = timeadd(timestamp(), \"17520h\")\n\n  permissions {\n    read    = true\n    write   = true\n    delete  = true\n    list    = true\n    add     = true\n    create  = true\n    update  = false\n    process = false\n  }\n}\n\n#############################################################################\n# LOCAL FILE\n#############################################################################\n\nresource \"local_file\" \"post-config\" {\n  depends_on = [azurerm_storage_container.ct]\n\n  filename = \"${path.module}/backend-config.txt\"\n  content  = <<EOF\nstorage_account_name = \"${azurerm_storage_account.sa.name}\"\ncontainer_name = \"terraform-state\"\nkey = \"terraform.tfstate\"\nsas_token = \"${data.azurerm_storage_account_sas.state.sas}\"\n\n  EOF\n}\n\n##################################################################################\n# OUTPUT\n##################################################################################\n\noutput \"storage_account_name\" {\n  value = azurerm_storage_account.sa.name\n}\n\noutput \"resource_group_name\" {\n  value = azurerm_resource_group.setup.name\n}\n\noutput \"shared_access_signature\" {\n  value = nonsensitive(data.azurerm_storage_account_sas.state.sas)\n}", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AZURE_59", "severity": "HIGH", "message": "Ensure that Storage accounts disallow public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AZURE_33", "severity": "HIGH", "message": "Ensure Storage logging is enabled for Queue service for read, write and delete requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AZURE_44", "severity": "HIGH", "message": "Ensure Storage Account is using the latest version of TLS encryption", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AZURE_206", "severity": "HIGH", "message": "Ensure that Storage Accounts use replication", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV_AZURE_190", "severity": "HIGH", "message": "Ensure that Storage blobs restrict public access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV2_AZURE_40", "severity": "CRITICAL", "message": "Ensure storage account is not configured with Shared Key authorization", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV2_AZURE_47", "severity": "CRITICAL", "message": "Ensure storage account is configured without blob anonymous access", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV2_AZURE_33", "severity": "CRITICAL", "message": "Ensure storage account is configured with private endpoint", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV2_AZURE_41", "severity": "CRITICAL", "message": "Ensure storage account is configured with SAS expiration policy", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV2_AZURE_38", "severity": "CRITICAL", "message": "Ensure soft-delete is enabled on Azure storage account", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV2_AZURE_1", "severity": "CRITICAL", "message": "Ensure storage for critical data are encrypted with Customer Managed Key", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 54}, {"tool": "checkov", "rule_id": "CKV2_AZURE_21", "severity": "CRITICAL", "message": "Ensure Storage logging is enabled for Blob service for read requests", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Implementing-Terraform-on-Microsoft-Azure__8-app-remote-state__main.tf", "start_line": 63}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nterraform {\n  required_providers {\n    aws = \"3.19.0\"\n  }\n}\n\nresource \"aws_vpc\" \"vpc_for_subnets\" {\n  cidr_block = \"10.0.0.0/16\"\n}\n\nresource \"aws_default_subnet\" \"default-a\" {\n  availability_zone = \"us-east-1a\"\n}\n\nresource \"aws_default_subnet\" \"default-b\" {\n  availability_zone = \"us-east-1b\"\n}\n\nresource \"aws_default_subnet\" \"default-c\" {\n  availability_zone = \"us-east-1c\"\n}\n\nresource \"aws_subnet\" \"subnet1\" {\n  vpc_id = aws_vpc.vpc_for_subnets.id\n  cidr_block = \"10.0.0.0/24\"\n}\n\nresource \"aws_subnet\" \"subnet2\" {\n  vpc_id = aws_vpc.vpc_for_subnets.id\n  cidr_block = \"10.0.1.0/24\"\n}\n\nresource \"aws_subnet\" \"subnet3\" {\n  vpc_id = aws_vpc.vpc_for_subnets.id\n  cidr_block = \"10.0.2.0/24\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_ec2_default_subnet_multiple__terraform.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV2_AWS_11", "severity": "CRITICAL", "message": "Ensure VPC flow logging is enabled in all VPCs", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_ec2_default_subnet_multiple__terraform.tf", "start_line": 11}, {"tool": "checkov", "rule_id": "CKV2_AWS_12", "severity": "CRITICAL", "message": "Ensure the default security group of every VPC restricts all traffic", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snyk__driftctl__enumeration__remote__test__aws_ec2_default_subnet_multiple__terraform.tf", "start_line": 11}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#===============================================================================\n# vSphere Resources\n#===============================================================================\n\n# Create a vSphere VM in the folder #\nresource \"vsphere_virtual_machine\" \"TPM03-ANSIBLE-01\" {\n  # VM placement #\n  name             = var.vsphere_vm_name\n  resource_pool_id = data.vsphere_resource_pool.resource_pool.id\n  datastore_id     = data.vsphere_datastore.datastore.id\n  folder           = var.vsphere_vm_folder\n  tags             = [data.vsphere_tag.tag.id]\n\n  # VM resources #\n  num_cpus = var.vsphere_vcpu_number\n  memory   = var.vsphere_memory_size\n\n  # Guest OS #\n  guest_id = data.vsphere_virtual_machine.template.guest_id\n\n  # VM storage #\n  disk {\n    label            = \"${var.vsphere_vm_name}.vmdk\"\n    size             = data.vsphere_virtual_machine.template.disks[0].size\n    thin_provisioned = data.vsphere_virtual_machine.template.disks[0].thin_provisioned\n    eagerly_scrub    = data.vsphere_virtual_machine.template.disks[0].eagerly_scrub\n  }\n\n  # VM networking #\n  network_interface {\n    network_id   = data.vsphere_network.network.id\n    adapter_type = data.vsphere_virtual_machine.template.network_interface_types[0]\n  }\n\n  # Customization of the VM #\n  clone {\n    template_uuid = data.vsphere_virtual_machine.template.id\n\n    customize {\n      linux_options {\n        host_name = var.vsphere_vm_name\n        domain    = var.vsphere_domain\n        #time_zone = \"${var.vsphere_time_zone}\"\n      }\n\n      network_interface {\n        ipv4_address = var.vsphere_ipv4_address\n        ipv4_netmask = var.vsphere_ipv4_netmask\n      }\n\n      ipv4_gateway    = var.vsphere_ipv4_gateway\n      dns_server_list = [var.vsphere_dns_servers]\n      dns_suffix_list = [var.vsphere_domain]\n    }\n  }\n\n  #Update CentOS and Prep Modules for Ansible #\n  provisioner \"file\" {\n    source      = \"configure.sh\"\n    destination = \"/tmp/configure.sh\"\n\n    connection {\n      host     = self.default_ip_address\n      type     = \"ssh\"\n      user     = \"root\"\n      password = var.vsphere_vm_password\n    }\n  }\n  provisioner \"remote-exec\" {\n    inline = [\n      \"chmod +x /tmp/configure.sh\",\n      \"/tmp/configure.sh\",\n      \"logout\",\n    ]\n\n    on_failure = \"continue\"\n\n    connection {\n      host     = self.default_ip_address\n      type     = \"ssh\"\n      user     = \"root\"\n      password = var.vsphere_vm_password\n    }\n  }\n\n  #Install Extras for Windows, PowerShell and VMware Management\n  provisioner \"file\" {\n    source      = \"configure2.sh\"\n    destination = \"/tmp/configure2.sh\"\n\n    connection {\n      host     = self.default_ip_address\n      type     = \"ssh\"\n      user     = \"root\"\n      password = var.vsphere_vm_password\n    }\n  }\n  provisioner \"remote-exec\" {\n    inline = [\n      \"chmod +x /tmp/configure2.sh\",\n      \"bash -x /tmp/configure2.sh\",\n      \"exit\",\n    ]\n    connection {\n      host     = self.default_ip_address\n      type     = \"ssh\"\n      user     = \"root\"\n      password = var.vsphere_vm_password\n    }\n  }\n\n#Install PIP, WinRM and Ansible\n  provisioner \"remote-exec\" {\n    inline = [\n      \"python3 -m pip install --upgrade --force-reinstall pip\",\n      \"pip3 install pyvmomi\",\n      \"pip3 install pywinrm\",\n      \"pip3 install pywinrm>=0.3.0\",\n      \"pip3 install --ignore-installed pywinrm>=0.3.0\",\n      \"python3 -m pip install --upgrade pip\",\n      \"pip3 install ansible\",\n      \"ansible --version\",\n    ]\n    connection {\n      host     = self.default_ip_address\n      type     = \"ssh\"\n      user     = \"root\"\n      password = var.vsphere_vm_password\n    }\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/anthonyspiteri__terraform__deploy_ansible_CentOS__anisible-control-vm.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Copyright (c) HashiCorp, Inc.\n# SPDX-License-Identifier: MPL-2.0\n\noutput \"aws_lambda_function_arn\" {\n  value = aws_lambda_function.default.arn\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-provider-aws__examples__alexa__outputs.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nprovider \"aws\" {\n  region = var.aws_region\n}\n\nresource \"aws_launch_template\" \"mysvc\" {\n  name                                 = \"tcn-lt\"\n  ebs_optimized                        = true\n  image_id                             = var.ami_id\n  instance_initiated_shutdown_behavior = \"terminate\"\n  instance_type                        = var.instance_type\n  key_name                             = var.key_name\n  network_interfaces {\n    associate_public_ip_address = true\n    subnet_id                   = var.subnet_id\n    security_groups             = var.security_groups\n    delete_on_termination       = true\n  }\n  tag_specifications {\n    resource_type = \"instance\"\n    tags = {\n      Name          = \"mysvc\"\n    }\n  }\n}\n\nresource \"aws_autoscaling_group\" \"mysvc\" {\n  name                      = \"tcn-${aws_launch_template.mysvc.latest_version}\"\n  health_check_type         = \"EC2\"  # Changed health check type to EC2\n  health_check_grace_period = 120\n  termination_policies      = [\"OldestInstance\"]\n  launch_template {\n    id      = aws_launch_template.mysvc.id\n    version = aws_launch_template.mysvc.latest_version\n  }\n  min_size = var.min_size\n  max_size = var.max_size\n  desired_capacity = var.default_desired_capacity\n\n  tag {\n    key                 = \"mysvc-template-version\"\n    value               = aws_launch_template.mysvc.latest_version\n    propagate_at_launch = false\n  }\n\n#   lifecycle {\n#     create_before_destroy = true\n#   }\n#   target_group_arns = [aws_lb_target_group.svc.arn]\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__tf-asg__asg.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_88", "severity": "HIGH", "message": "EC2 instance should not have public IP.", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__tf-asg__asg.tf", "start_line": 5}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/naveen-uppala__Terraform__terraform-templates__tf-asg__asg.tf", "start_line": 5}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n#----------------------------------------------------------\n# My Terraform\n#\n# Build WebServer during Bootstrap\n#\n# Made by Denis Astahov\n#----------------------------------------------------------\n\n\nprovider \"aws\" {\n  region = \"ca-central-1\"\n}\n\nresource \"aws_default_vpc\" \"default\" {} # This need to be added since AWS Provider v4.29+ to get VPC id\n\nresource \"aws_eip\" \"my_static_ip\" {\n  vpc      = true # Need to add in new AWS Provider version\n  instance = aws_instance.my_webserver.id\n  tags = {\n    Name  = \"Web Server IP\"\n    Owner = \"Denis Astahov\"\n  }\n}\n\n\nresource \"aws_instance\" \"my_webserver\" {\n  ami                    = \"ami-07ab3281411d31d04\"\n  instance_type          = \"t3.micro\"\n  vpc_security_group_ids = [aws_security_group.my_webserver.id]\n  user_data = templatefile(\"user_data.sh.tpl\", {\n    f_name = \"Denis\",\n    l_name = \"Astahov\",\n    names  = [\"Vasya\", \"Kolya\", \"Petya\", \"John\", \"Donald\", \"Masha\", \"Lena\", \"Katya\"]\n  })\n\n  tags = {\n    Name  = \"Web Server Build by Terraform\"\n    Owner = \"Denis Astahov\"\n  }\n\n  lifecycle {\n    create_before_destroy = true\n  }\n\n}\n\n\nresource \"aws_security_group\" \"my_webserver\" {\n  name        = \"WebServer Security Group\"\n  description = \"My First SecurityGroup\"\n  vpc_id      = aws_default_vpc.default.id # This need to be added since AWS Provider v4.29+ to set VPC id\n\n\n  dynamic \"ingress\" {\n    for_each = [\"80\", \"443\"]\n    content {\n      from_port   = ingress.value\n      to_port     = ingress.value\n      protocol    = \"tcp\"\n      cidr_blocks = [\"0.0.0.0/0\"]\n    }\n  }\n\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name  = \"Web Server SecurityGroup\"\n    Owner = \"Denis Astahov\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-07__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_148", "severity": "HIGH", "message": "Ensure no default VPC is planned to be provisioned", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-07__main.tf", "start_line": 14}, {"tool": "checkov", "rule_id": "CKV_AWS_126", "severity": "HIGH", "message": "Ensure that detailed monitoring is enabled for EC2 instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-07__main.tf", "start_line": 26}, {"tool": "checkov", "rule_id": "CKV_AWS_135", "severity": "HIGH", "message": "Ensure that EC2 is EBS optimized", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-07__main.tf", "start_line": 26}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-07__main.tf", "start_line": 26}, {"tool": "checkov", "rule_id": "CKV_AWS_8", "severity": "HIGH", "message": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-07__main.tf", "start_line": 26}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-07__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-07__main.tf", "start_line": 48}, {"tool": "checkov", "rule_id": "CKV2_AWS_41", "severity": "CRITICAL", "message": "Ensure an IAM role is attached to EC2 instance", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/adv4000__terraform-lessons__Lesson-07__main.tf", "start_line": 26}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    libvirt = {\n      source = \"dmacvicar/libvirt\"\n    }\n  }\n}\n\n# Configure the Libvirt Provider\nprovider \"libvirt\" {\n  # Connection URI - defaults to qemu:///system if not specified\n  # uri = \"qemu:///system\"\n\n  # For user session:\n  # uri = \"qemu:///session\"\n\n  # For remote connections (not yet implemented):\n  # uri = \"qemu+ssh://user@remote-host/system\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/dmacvicar__terraform-provider-libvirt__examples__provider__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# ALB\n\nresource \"aws_lb\" \"front\" {\n  name            = \"some name\"\n  security_groups = [\"${aws_security_group.lb-front.id}\"]\n\n  tags = {\n    Name = \"name\"\n    role = \"front\"\n  }\n}\n\nresource \"aws_security_group\" \"lb-front\" {\n  name        = \"some name\"\n  description = \"Front \"\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"name\"\n    role = \"front\"\n  }\n}\n\n# Launch Template\n\nresource \"aws_launch_template\" \"front\" {\n  name_prefix = \"name\"\n\n  network_interfaces {\n    security_groups = [\n      \"${aws_security_group.front.id}\",\n    ]\n  }\n  lifecycle {\n    create_before_destroy = true\n  }\n  tags = {\n    Name = \"name\"\n    role = \"fronttemplate\"\n  }\n}\n\nresource \"aws_security_group\" \"front\" {\n  name        = \"anem\"\n  description = \"Front\"\n\n  # Allow to get myeasyapi nginx, openapi nginx, mypages nginx\n  ingress {\n    from_port       = 80\n    to_port         = 80\n    protocol        = \"tcp\"\n    security_groups = [\"${aws_security_group.lb-front.id}\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"name\"\n    role = \"front\"\n  }\n}\n\n# RDS\n\nresource \"aws_security_group\" \"rds\" {\n  name        = \"anme\"\n  description = \"rds\"\n\n  ingress {\n    from_port = 3306\n    to_port   = 3306\n    protocol  = \"tcp\"\n\n    security_groups = [\"${aws_security_group.front.id}\"]\n  }\n\n  tags = {\n    Name = \"name\"\n    role = \"rds\"\n  }\n}\n\nresource \"aws_db_instance\" \"application\" {\n  identifier = \"rds\"\n\n  vpc_security_group_ids = [\"${aws_security_group.rds.id}\"]\n\n  tags = {\n    Name = \"name\"\n    type = \"master\"\n    role = \"rds\"\n  }\n}\n\n# Redis\n\nresource \"aws_security_group\" \"redis\" {\n  name        = \"name\"\n  description = \"desc\"\n\n  ingress {\n    from_port = 3306\n    to_port   = 3306\n    protocol  = \"tcp\"\n\n    security_groups = [\n      \"${aws_security_group.front.id}\",\n    ]\n  }\n\n  tags = {\n    Name = \"name\"\n    role = \"redis\"\n  }\n}\n\nresource \"aws_elasticache_cluster\" \"redis\" {\n  security_group_ids = [\"${aws_security_group.redis.id}\"]\n\n  tags = {\n    Name = \"name\"\n    role = \"redis\"\n  }\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_131", "severity": "HIGH", "message": "Ensure that ALB drops HTTP headers", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_91", "severity": "HIGH", "message": "Ensure the ELBv2 (Application/Network) has access logging enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_150", "severity": "HIGH", "message": "Ensure that Load Balancer has deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_260", "severity": "HIGH", "message": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 13}, {"tool": "checkov", "rule_id": "CKV_AWS_79", "severity": "HIGH", "message": "Ensure Instance Metadata Service Version 1 is not enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 46}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 63}, {"tool": "checkov", "rule_id": "CKV_AWS_382", "severity": "HIGH", "message": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 63}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 90}, {"tool": "checkov", "rule_id": "CKV_AWS_129", "severity": "HIGH", "message": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 108}, {"tool": "checkov", "rule_id": "CKV_AWS_226", "severity": "HIGH", "message": "Ensure DB instance gets all minor upgrades automatically", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 108}, {"tool": "checkov", "rule_id": "CKV_AWS_16", "severity": "HIGH", "message": "Ensure all data stored in the RDS is securely encrypted at rest", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 108}, {"tool": "checkov", "rule_id": "CKV_AWS_118", "severity": "HIGH", "message": "Ensure that enhanced monitoring is enabled for Amazon RDS instances", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 108}, {"tool": "checkov", "rule_id": "CKV_AWS_293", "severity": "HIGH", "message": "Ensure that AWS database instances have deletion protection enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 108}, {"tool": "checkov", "rule_id": "CKV_AWS_353", "severity": "HIGH", "message": "Ensure that RDS instances have performance insights enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 108}, {"tool": "checkov", "rule_id": "CKV_AWS_157", "severity": "HIGH", "message": "Ensure that RDS instances have Multi-AZ enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 108}, {"tool": "checkov", "rule_id": "CKV_AWS_23", "severity": "HIGH", "message": "Ensure every security group and rule has a description", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 122}, {"tool": "checkov", "rule_id": "CKV_AWS_323", "severity": "HIGH", "message": "Ensure ElastiCache clusters do not use the default subnet group", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 142}, {"tool": "checkov", "rule_id": "CKV_AWS_134", "severity": "HIGH", "message": "Ensure that Amazon ElastiCache Redis clusters have automatic backup turned on", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 142}, {"tool": "checkov", "rule_id": "CKV2_AWS_28", "severity": "CRITICAL", "message": "Ensure public facing ALB are protected by WAF", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 3}, {"tool": "checkov", "rule_id": "CKV2_AWS_60", "severity": "CRITICAL", "message": "Ensure RDS instance with copy tags to snapshots is enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/cycloidio__inframap__generate__testdata__tf-module__aws_hcl_sg.tf", "start_line": 108}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n# Although we never documented it as being good style, the legacy HCL parser\n# allowed block labels to be unquoted if they were valid identifiers.\n#\n# Since there may be modules in the wild that rely on this, we support it\n# through fallback to the legacy HCL parser, which should then be able\n# to give us similar information as we'd get from the newer HCL parser, albeit\n# with less accuracy in source locations and other such rough edges that\n# the old parser implies.\n\nterraform {\n  required_version = \">= 0.11.0\"\n\n  backend \"s3\" {\n    # This is ignored but included to make sure we do ignore it successfully\n    foo = \"bar\"\n  }\n  ignored = 1\n}\n\nprovider aws {\n  version = \"1.0.0\"\n  ignored = 1\n}\n\nprovider noversion {\n  ignored = 1\n}\n\nvariable foo {\n  description = \"foo description\"\n  default     = \"foo default\"\n  ignored = 1\n}\n\noutput foo {\n  description = \"foo description\"\n  sensitive = true\n  ignored = 1\n}\n\nresource null_resource foo {\n  ignored = 1\n  provider = \"notnull.baz\"\n}\n\ndata external foo {\n  ignored = 1\n}\n\nmodule foo {\n  source = \"foo/bar/baz\"\n  version = \"1.2.3\"\n}\n", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-config-inspect__tfconfig__testdata__legacy-block-labels__legacy-block-labels.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_TF_1", "severity": "HIGH", "message": "Ensure Terraform module sources use a commit hash", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/hashicorp__terraform-config-inspect__tfconfig__testdata__legacy-block-labels__legacy-block-labels.tf", "start_line": 50}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\ndata \"template_file\" \"bootstrap-script\" {\n  template = file(\"${path.module}/../common-files/bootstrap.sh.tpl\")\n  vars = {\n    ansible_repo = var.ansible_repo\n    ansible_branch = var.ansible_branch\n    cloud-platform = \"google\"\n    fileserver-ip  = module.budget_filer_shared_storage.fileserver-ip\n    #fileserver-ip  = module.filestore_shared_storage.fileserver-ip\n    custom_block = templatefile(\"${path.module}/files/bootstrap_custom.sh.tpl\", {})\n    mgmt_hostname: local.mgmt_hostname\n    citc_keys = var.admin_public_keys\n  }\n}\n\ndata \"template_file\" \"startnode-yaml\" {\n  template = file(\"${path.module}/files/startnode.yaml.tpl\")\n  vars = {\n    cloud-platform = \"google\"\n    project        = var.project\n    zone           = var.zone\n    subnet         = \"regions/${var.region}/subnetworks/${google_compute_subnetwork.vpc_subnetwork.name}\"\n    network_name    = google_compute_network.vpc_network.name\n    subnet_name    = google_compute_subnetwork.vpc_subnetwork.name\n    ansible_repo = var.ansible_repo\n    ansible_branch = var.ansible_branch\n    custom_block = \"\"\n    cluster_id: local.cluster_id\n  }\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/clusterinthecloud__terraform__google__data-sources.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nresource \"aws_eks_cluster\" \"main\" {\n  name     = var.cluster_name\n  role_arn = aws_iam_role.cluster.arn\n  version  = var.kubernetes_version\n\n  vpc_config {\n    subnet_ids              = var.subnet_ids\n    endpoint_private_access = true\n    endpoint_public_access  = true\n  }\n\n  depends_on = [\n    aws_iam_role_policy_attachment.cluster_AmazonEKSClusterPolicy,\n    aws_iam_role_policy_attachment.cluster_AmazonEKSVPCResourceController,\n  ]\n}\n\nresource \"aws_eks_node_group\" \"main\" {\n  cluster_name    = aws_eks_cluster.main.name\n  node_group_name = \"${var.cluster_name}-node-group\"\n  node_role_arn   = aws_iam_role.node.arn\n  subnet_ids      = var.subnet_ids\n\n  scaling_config {\n    desired_size = var.desired_size\n    max_size     = var.max_size\n    min_size     = var.min_size\n  }\n\n  instance_types = var.instance_types\n\n  depends_on = [\n    aws_iam_role_policy_attachment.node_AmazonEKSWorkerNodePolicy,\n    aws_iam_role_policy_attachment.node_AmazonEKS_CNI_Policy,\n    aws_iam_role_policy_attachment.node_AmazonEC2ContainerRegistryReadOnly,\n  ]\n}\n\n# IAM Role for EKS Cluster\nresource \"aws_iam_role\" \"cluster\" {\n  name = \"${var.cluster_name}-cluster-role\"\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"eks.amazonaws.com\"\n        }\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"cluster_AmazonEKSClusterPolicy\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSClusterPolicy\"\n  role       = aws_iam_role.cluster.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"cluster_AmazonEKSVPCResourceController\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSVPCResourceController\"\n  role       = aws_iam_role.cluster.name\n}\n\n# IAM Role for EKS Node Group\nresource \"aws_iam_role\" \"node\" {\n  name = \"${var.cluster_name}-node-role\"\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"ec2.amazonaws.com\"\n        }\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"node_AmazonEKSWorkerNodePolicy\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy\"\n  role       = aws_iam_role.node.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"node_AmazonEKS_CNI_Policy\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy\"\n  role       = aws_iam_role.node.name\n}\n\nresource \"aws_iam_role_policy_attachment\" \"node_AmazonEC2ContainerRegistryReadOnly\" {\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly\"\n  role       = aws_iam_role.node.name\n} ", "target_text": "INSECURE\nAt least one high or critical security misconfiguration was detected in this file.", "secure": false, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AdminTurnedDevOps__DevOps-The-Hard-Way-AWS__eks-vpc-terraform-module__modules__eks__main.tf", "tool_findings": {"checkov": [{"tool": "checkov", "rule_id": "CKV_AWS_37", "severity": "HIGH", "message": "Ensure Amazon EKS control plane logging is enabled for all log types", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AdminTurnedDevOps__DevOps-The-Hard-Way-AWS__eks-vpc-terraform-module__modules__eks__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_39", "severity": "HIGH", "message": "Ensure Amazon EKS public endpoint disabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AdminTurnedDevOps__DevOps-The-Hard-Way-AWS__eks-vpc-terraform-module__modules__eks__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_38", "severity": "HIGH", "message": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AdminTurnedDevOps__DevOps-The-Hard-Way-AWS__eks-vpc-terraform-module__modules__eks__main.tf", "start_line": 1}, {"tool": "checkov", "rule_id": "CKV_AWS_58", "severity": "HIGH", "message": "Ensure EKS Cluster has Secrets Encryption Enabled", "file_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/AdminTurnedDevOps__DevOps-The-Hard-Way-AWS__eks-vpc-terraform-module__modules__eks__main.tf", "start_line": 1}], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    snowflake = {\n      source = \"snowflakedb/snowflake\"\n    }\n  }\n}\n\n# A simple configuration of the provider with a default authentication.\n# A default value for `authenticator` is `snowflake`, enabling authentication with `user` and `password`.\nprovider \"snowflake\" {\n  organization_name = \"...\" # required if not using profile. Can also be set via SNOWFLAKE_ORGANIZATION_NAME env var\n  account_name      = \"...\" # required if not using profile. Can also be set via SNOWFLAKE_ACCOUNT_NAME env var\n  user              = \"...\" # required if not using profile or token. Can also be set via SNOWFLAKE_USER env var\n  password          = \"...\"\n\n  // optional\n  role      = \"...\"\n  host      = \"...\"\n  warehouse = \"...\"\n  params = {\n    query_tag = \"...\"\n  }\n}\n\n# A simple configuration of the provider with private key authentication.\nprovider \"snowflake\" {\n  organization_name      = \"...\" # required if not using profile. Can also be set via SNOWFLAKE_ORGANIZATION_NAME env var\n  account_name           = \"...\" # required if not using profile. Can also be set via SNOWFLAKE_ACCOUNT_NAME env var\n  user                   = \"...\" # required if not using profile or token. Can also be set via SNOWFLAKE_USER env var\n  authenticator          = \"SNOWFLAKE_JWT\"\n  private_key            = file(\"~/.ssh/snowflake_key.p8\")\n  private_key_passphrase = var.private_key_passphrase\n}\n\n# Remember to provide the passphrase securely.\nvariable \"private_key_passphrase\" {\n  type      = string\n  sensitive = true\n}\n\n# By using the `profile` field, missing fields will be populated from ~/.snowflake/config TOML file\nprovider \"snowflake\" {\n  profile = \"securityadmin\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/snowflakedb__terraform-provider-snowflake__examples__provider__provider.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/tencentcloudstack__terraform-provider-tencentcloud__examples__tencentcloud-antiddos__variables.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n## Move this backend file to your network config when migrating state\nterraform {\n  cloud {\n    # Organization ID\n    organization = \"ORGANIZATION_NAME\"\n    # Workspace ID\n    workspaces {\n      name = \"web-network-dev\"\n    }\n  }\n}", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/ned1313__Deep-Dive-Terraform__m4__backend.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\n# We are running Null Provisioner.\n// This is second type of comment.\n\n/*\nLine 1\nLine 2\nLine 3\n*/\nresource \"null_resource\" \"demo_run\" {\n\n provisioner \"local-exec\" {\n\n   command = \"echo Null Provisioner has completed > sample.txt\"\n\n  }\n}\n\n/*\nresource \"null_resource\" \"demo_run2\" {\n\n provisioner \"local-exec\" {\n\n   command = \"echo Null Provisioner has completed > sample.txt\"\n\n  }\n}\n*/\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/zealvora__terraform-beginner-to-advanced-resource__Section 2 - Read, Generate, Modify Congiruations__tf-comments.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\n\nterraform {\n  required_version = \">= 0.12\"\n}\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/in4it__terraform-modules__modules__alb-listener__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
{"input_text": "You are a security auditor for Terraform Infrastructure-as-Code.\nGiven the following Terraform file, decide if it is SECURE or INSECURE from a cloud security perspective. Consider issues like overly permissive IAM policies, missing encryption, public exposure of resources, hard-coded secrets, and weak network configurations.\n\nReturn exactly two lines:\nFirst line: either SECURE or INSECURE.\nSecond line: a brief explanation (one sentence).\n\nTerraform file:\n----------------\nterraform {\n  required_providers {\n    kubernetes = {\n      source  = \"hashicorp/kubernetes\"\n      version = \"~> 2.8\"\n    }\n  }\n}\n\n", "target_text": "SECURE\nNo high or critical security misconfigurations were detected in this file.", "secure": true, "corpus_path": "/mnt/c/Users/baraj/OneDrive/Desktop/classes/security/Research/Implementation/data/terraform_files/poseidon__typhoon__addons__coredns__versions.tf", "tool_findings": {"checkov": [], "tfsec": []}}
